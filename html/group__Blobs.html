<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Xmipp: Blobs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Blobs<div class="ingroups"><a class="el" href="group__BasisFunction.html">Basis function</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Blobs:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__Blobs.png" border="0" alt="" usemap="#group____Blobs"/>
<map name="group____Blobs" id="group____Blobs">
<area shape="rect" id="node1" href="group__BasisFunction.html" title="Basis function" alt="" coords="5,5,111,32"/>
</map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structblobtype.html">blobtype</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gaeba6cc6d681f05be51139d9d5c21a305"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#gaeba6cc6d681f05be51139d9d5c21a305">blob_val</a>(r,  blob)&#160;&#160;&#160;<a class="el" href="group__Blobs.html#ga1d25336dea0e85d705d18ebdb27f018a">kaiser_value</a>(r, blob.radius, blob.alpha, blob.order)</td></tr>
<tr class="separator:gaeba6cc6d681f05be51139d9d5c21a305"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0af420e41e9958b9c5b562c1df9a6b9e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#ga0af420e41e9958b9c5b562c1df9a6b9e">blob_proj</a>(r,  blob)&#160;&#160;&#160;<a class="el" href="group__Blobs.html#gae3586255797a1a110ba99268a050ccef">kaiser_proj</a>(r, blob.radius, blob.alpha, blob.order)</td></tr>
<tr class="separator:ga0af420e41e9958b9c5b562c1df9a6b9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8119af50e3fa095d670c01a680d9f2cc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#ga8119af50e3fa095d670c01a680d9f2cc">blob_Fourier_val</a>(<a class="el" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>,  blob)&#160;&#160;&#160;<a class="el" href="group__Blobs.html#gad2a185cd88a0d1a7e22ccbaa01624751">kaiser_Fourier_value</a>(<a class="el" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>, blob.radius, blob.alpha, blob.order)</td></tr>
<tr class="separator:ga8119af50e3fa095d670c01a680d9f2cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5a62015b2158b9644950af306dc8b856"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#ga5a62015b2158b9644950af306dc8b856">blob_mass</a>(blob)&#160;&#160;&#160;<a class="el" href="group__Blobs.html#gad30bf1a00f736d5378040c6d4f4e30a5">basvolume</a>(blob.radius, blob.alpha, blob.order,3)</td></tr>
<tr class="separator:ga5a62015b2158b9644950af306dc8b856"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad1f8107fe2e79dd5a210df9509ab6055"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#gad1f8107fe2e79dd5a210df9509ab6055">SHOW_CONVERSION</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:gad1f8107fe2e79dd5a210df9509ab6055"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae1a62943287cc2f243753d3a9d0dcd9d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#gae1a62943287cc2f243753d3a9d0dcd9d">VARTK</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:gae1a62943287cc2f243753d3a9d0dcd9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3fbce6fd195e1787971b7b93e82cbbd5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#ga3fbce6fd195e1787971b7b93e82cbbd5">VMAXARTK</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:ga3fbce6fd195e1787971b7b93e82cbbd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga1d25336dea0e85d705d18ebdb27f018a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#ga1d25336dea0e85d705d18ebdb27f018a">kaiser_value</a> (double r, double <a class="el" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, double alpha, int <a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>)</td></tr>
<tr class="separator:ga1d25336dea0e85d705d18ebdb27f018a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae3586255797a1a110ba99268a050ccef"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#gae3586255797a1a110ba99268a050ccef">kaiser_proj</a> (double r, double <a class="el" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, double alpha, int <a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>)</td></tr>
<tr class="separator:gae3586255797a1a110ba99268a050ccef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad2a185cd88a0d1a7e22ccbaa01624751"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#gad2a185cd88a0d1a7e22ccbaa01624751">kaiser_Fourier_value</a> (double <a class="el" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>, double <a class="el" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, double alpha, int <a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>)</td></tr>
<tr class="separator:gad2a185cd88a0d1a7e22ccbaa01624751"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad30bf1a00f736d5378040c6d4f4e30a5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#gad30bf1a00f736d5378040c6d4f4e30a5">basvolume</a> (double <a class="el" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, double alpha, int <a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, int <a class="el" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)</td></tr>
<tr class="separator:gad30bf1a00f736d5378040c6d4f4e30a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9ca9464825734b841e8fe3b688d4210b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#ga9ca9464825734b841e8fe3b688d4210b">in_zeroarg</a> (int <a class="el" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)</td></tr>
<tr class="separator:ga9ca9464825734b841e8fe3b688d4210b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5535ae1ec6293ae20ff93667838ab722"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#ga5535ae1ec6293ae20ff93667838ab722">inph_zeroarg</a> (int <a class="el" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)</td></tr>
<tr class="separator:ga5535ae1ec6293ae20ff93667838ab722"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1c16f98dae81ec5758de5d1de321e4a8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#ga1c16f98dae81ec5758de5d1de321e4a8">i_nph</a> (int <a class="el" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, double <a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>)</td></tr>
<tr class="separator:ga1c16f98dae81ec5758de5d1de321e4a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab1c7e82811e94d7957dc0f8891a57cfa"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#gab1c7e82811e94d7957dc0f8891a57cfa">i_n</a> (int <a class="el" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, double <a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>)</td></tr>
<tr class="separator:gab1c7e82811e94d7957dc0f8891a57cfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga87a45c6b1e8619e08888ab103c1fd7f9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#ga87a45c6b1e8619e08888ab103c1fd7f9">blob_freq_zero</a> (struct <a class="el" href="structblobtype.html">blobtype</a> <a class="el" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>)</td></tr>
<tr class="separator:ga87a45c6b1e8619e08888ab103c1fd7f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6b970e558ce2e6e3cb9b542c8f1fa058"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#ga6b970e558ce2e6e3cb9b542c8f1fa058">blob_att</a> (double <a class="el" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>, struct <a class="el" href="structblobtype.html">blobtype</a> <a class="el" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>)</td></tr>
<tr class="separator:ga6b970e558ce2e6e3cb9b542c8f1fa058"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0f7631fefa14f5ea33a34e649dad99a2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#ga0f7631fefa14f5ea33a34e649dad99a2">blob_ops</a> (double <a class="el" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>, struct <a class="el" href="structblobtype.html">blobtype</a> <a class="el" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>)</td></tr>
<tr class="separator:ga0f7631fefa14f5ea33a34e649dad99a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga65b6f10264ad108020eab832bc54e483"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#ga65b6f10264ad108020eab832bc54e483">optimal_CC_grid_relative_size</a> (struct <a class="el" href="structblobtype.html">blobtype</a> <a class="el" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>)</td></tr>
<tr class="separator:ga65b6f10264ad108020eab832bc54e483"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8e29cec73aae5e98ae56cdfe566b8493"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#ga8e29cec73aae5e98ae56cdfe566b8493">optimal_BCC_grid_relative_size</a> (struct <a class="el" href="structblobtype.html">blobtype</a> <a class="el" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>)</td></tr>
<tr class="separator:ga8e29cec73aae5e98ae56cdfe566b8493"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7316736d9a542f44eb2d81dc33e909aa"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#ga7316736d9a542f44eb2d81dc33e909aa">optimal_FCC_grid_relative_size</a> (struct <a class="el" href="structblobtype.html">blobtype</a> <a class="el" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>)</td></tr>
<tr class="separator:ga7316736d9a542f44eb2d81dc33e909aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac8e2050314c77dfb98af95f408365bb2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structblobtype.html">blobtype</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#gac8e2050314c77dfb98af95f408365bb2">best_blob</a> (double alpha_0, double alpha_F, double inc_alpha, double a_0, double a_F, double inc_a, double <a class="el" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>, double *target_att, int target_length=1)</td></tr>
<tr class="separator:gac8e2050314c77dfb98af95f408365bb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab81ecd64b721b04143708dc10aa4a4bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#gab81ecd64b721b04143708dc10aa4a4bb">footprint_blob</a> (<a class="el" href="classImageOver.html">ImageOver</a> &amp;blobprint, const struct <a class="el" href="structblobtype.html">blobtype</a> &amp;blob, int istep=50, int normalise=0)</td></tr>
<tr class="separator:gab81ecd64b721b04143708dc10aa4a4bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gade32964792892a00478421dcdba274bf"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#gade32964792892a00478421dcdba274bf">sum_blob_Grid</a> (const struct <a class="el" href="structblobtype.html">blobtype</a> &amp;blob, const <a class="el" href="classGrid.html">Grid</a> &amp;grid, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; *D=NULL)</td></tr>
<tr class="separator:gade32964792892a00478421dcdba274bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8947e150817ff61eebf5187a73985610"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#ga8947e150817ff61eebf5187a73985610">voxel_volume_shape</a> (const <a class="el" href="group__Grids.html#gae3eeb15b316a9800a7c35372dfd57460">GridVolume</a> &amp;vol_blobs, const struct <a class="el" href="structblobtype.html">blobtype</a> &amp;blob, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; *D, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; int &gt; &amp;corner1, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; int &gt; &amp;size)</td></tr>
<tr class="separator:ga8947e150817ff61eebf5187a73985610"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga769d35289332d6806a6358b748ecc0a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#ga769d35289332d6806a6358b748ecc0a9">blobs2voxels</a> (const <a class="el" href="group__Grids.html#gae3eeb15b316a9800a7c35372dfd57460">GridVolume</a> &amp;vol_blobs, const struct <a class="el" href="structblobtype.html">blobtype</a> &amp;blob, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *vol_voxels, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; *D=NULL, int threads=1, int Zdim=0, int Ydim=0, int Xdim=0)</td></tr>
<tr class="separator:ga769d35289332d6806a6358b748ecc0a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga32723dcca7f313a15c62ba3f8652282a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#ga32723dcca7f313a15c62ba3f8652282a">blobs2space_coefficients</a> (const <a class="el" href="group__Grids.html#gae3eeb15b316a9800a7c35372dfd57460">GridVolume</a> &amp;vol_blobs, const struct <a class="el" href="structblobtype.html">blobtype</a> &amp;blob, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *vol_coefs)</td></tr>
<tr class="separator:ga32723dcca7f313a15c62ba3f8652282a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaae235a7c2de134c88fe477b9d98149d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#gaae235a7c2de134c88fe477b9d98149d4">voxels2blobs</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *vol_voxels, const struct <a class="el" href="structblobtype.html">blobtype</a> &amp;blob, <a class="el" href="group__Grids.html#gae3eeb15b316a9800a7c35372dfd57460">GridVolume</a> &amp;vol_blobs, int grid_type, double grid_relative_size, double <a class="el" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *vol_mask=NULL, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; *D=NULL, double final_error_change=0.01, int tell=0, double R=-1, int threads=1)</td></tr>
<tr class="separator:gaae235a7c2de134c88fe477b9d98149d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga94823f436a57fc7e534e04d1829f47a5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Blobs.html#ga94823f436a57fc7e534e04d1829f47a5">ART_voxels2blobs_single_step</a> (<a class="el" href="group__Grids.html#gae3eeb15b316a9800a7c35372dfd57460">GridVolume</a> &amp;vol_in, <a class="el" href="group__Grids.html#gae3eeb15b316a9800a7c35372dfd57460">GridVolume</a> *vol_out, const struct <a class="el" href="structblobtype.html">blobtype</a> &amp;blob, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; *D, double <a class="el" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *theo_vol, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *<a class="el" href="lib__vio_8h.html#aa6a42a7e0a69b7da72558548e4ed4331">read_vol</a>, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *corr_vol, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *mask_vol, double &amp;mean_error, double &amp;max_error, int eq_mode=<a class="el" href="group__Blobs.html#gae1a62943287cc2f243753d3a9d0dcd9d">VARTK</a>, int threads=1)</td></tr>
<tr class="separator:ga94823f436a57fc7e534e04d1829f47a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga8119af50e3fa095d670c01a680d9f2cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define blob_Fourier_val</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">blob&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="group__Blobs.html#gad2a185cd88a0d1a7e22ccbaa01624751">kaiser_Fourier_value</a>(<a class="el" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>, blob.radius, blob.alpha, blob.order)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fourier transform of a blob. This function returns the value of the Fourier transform of the blob at a given frequency (w). This frequency must be normalized by the sampling rate. For instance, for computing the Fourier Transform of a blob at 1/Ts (Ts in Amstrongs) you must provide the frequency Tm/Ts, where Tm is the sampling rate.</p>
<p>The Fourier Transform can be computed only for blobs with m=2 or m=0. </p>

<p>Definition at line <a class="el" href="blobs_8h_source.html#l00175">175</a> of file <a class="el" href="blobs_8h_source.html">blobs.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga5a62015b2158b9644950af306dc8b856"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define blob_mass</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">blob</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="group__Blobs.html#gad30bf1a00f736d5378040c6d4f4e30a5">basvolume</a>(blob.radius, blob.alpha, blob.order,3)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Formula for a volume integral of a blob (n is the blob dimension) </p>

<p>Definition at line <a class="el" href="blobs_8h_source.html#l00182">182</a> of file <a class="el" href="blobs_8h_source.html">blobs.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga0af420e41e9958b9c5b562c1df9a6b9e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define blob_proj</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">r, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">blob&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="group__Blobs.html#gae3586255797a1a110ba99268a050ccef">kaiser_proj</a>(r, blob.radius, blob.alpha, blob.order)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classBlob.html">Blob</a> projection. This function returns the value of the blob line integral through a straight line which passes at a distance 'r' (in Universal System units) from the center of the blob. Remember that a blob is spherically symmetrycal so the only parameter to know this blob line integral is its distance to the center of the blob. It doesn't matter if this distance is larger than the real blob spatial extension, in this case the function returns 0. \ Ex: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;struct blobtype blob; blob.radius = 2; blob.order = 2; blob.alpha = 3.6;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Matrix1D&lt;double&gt; v=vectorR3(1,1,1);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;std::cout &lt;&lt; &quot;Blob line integral through (1,1,1) = &quot; &lt;&lt; blob_proj(v.mod(),blob)</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;     &lt;&lt; std::endl;</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="blobs_8h_source.html#l00162">162</a> of file <a class="el" href="blobs_8h_source.html">blobs.h</a>.</p>

</div>
</div>
<a class="anchor" id="gaeba6cc6d681f05be51139d9d5c21a305"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define blob_val</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">r, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">blob&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="group__Blobs.html#ga1d25336dea0e85d705d18ebdb27f018a">kaiser_value</a>(r, blob.radius, blob.alpha, blob.order)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classBlob.html">Blob</a> value. This function returns the value of a blob at a given distance from its center (in Universal System units). The distance must be always positive. Remember that a blob is spherically symmetrycal so the only parameter to know the blob value at a point is its distance to the center of the blob. It doesn't matter if this distance is larger than the real blob spatial extension, in this case the function returns 0 as blob value. \ Ex: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;struct blobtype blob; blob.radius = 2; blob.order = 2; blob.alpha = 3.6;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Matrix1D&lt;double&gt; v=vectorR3(1,1,1);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;std::cout &lt;&lt; &quot;Blob value at (1,1,1) = &quot; &lt;&lt; blob_val(v.mod(),blob) &lt;&lt; std::endl;</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="blobs_8h_source.html#l00140">140</a> of file <a class="el" href="blobs_8h_source.html">blobs.h</a>.</p>

</div>
</div>
<a class="anchor" id="gad1f8107fe2e79dd5a210df9509ab6055"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHOW_CONVERSION&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="blobs_8h_source.html#l00354">354</a> of file <a class="el" href="blobs_8h_source.html">blobs.h</a>.</p>

</div>
</div>
<a class="anchor" id="gae1a62943287cc2f243753d3a9d0dcd9d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VARTK&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="blobs_8h_source.html#l00379">379</a> of file <a class="el" href="blobs_8h_source.html">blobs.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga3fbce6fd195e1787971b7b93e82cbbd5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VMAXARTK&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="blobs_8h_source.html#l00380">380</a> of file <a class="el" href="blobs_8h_source.html">blobs.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga94823f436a57fc7e534e04d1829f47a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ART_voxels2blobs_single_step </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__Grids.html#gae3eeb15b316a9800a7c35372dfd57460">GridVolume</a> &amp;&#160;</td>
          <td class="paramname"><em>vol_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__Grids.html#gae3eeb15b316a9800a7c35372dfd57460">GridVolume</a> *&#160;</td>
          <td class="paramname"><em>vol_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structblobtype.html">blobtype</a> &amp;&#160;</td>
          <td class="paramname"><em>blob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>theo_vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>read_vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>corr_vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>mask_vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>mean_error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>max_error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>eq_mode</em> = <code><a class="el" href="group__Blobs.html#gae1a62943287cc2f243753d3a9d0dcd9d">VARTK</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>threads</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Voxels &mdash;&gt; Blobs, single step. This is the basic step of the voxels to blobs conversion. It applies an ART step to the blob volume and produces its output in a different (or the same) volume. You must provide the blob structure, lambda and deformation matrix (typical for crystals). The theoretical volume and correction volume are resized inside and are output volumes meaning the conversion from blobs to voxels before this step and the correction applied to the blob volume. The read volume is the one to reproduce with blobs and the mask volume is used to select only one region to adjust.</p>
<p>If the mask is NULL then it is assumed that all voxels in the input voxel volume must be adjusted by the blobs. If the input voxel volume is NULL the it is assumed that it is equal to 0 and only those corresponding to the 1 positions within the mask must be adjusted. An exception is thrown if the mask and voxels volume are both NULL.</p>
<p>Then mean and maximum error committed for each blob are returned.</p>
<p>Valid eq_modes are \VARTK: ART by blocks for volumes. \VMAXARTK: update with the maximum update. </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l01074">1074</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;{</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="comment">// Resize output volumes ................................................</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordflow">if</span> (read_vol != NULL)</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    {</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        (*theo_vol).initZeros(*read_vol);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    }</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mask_vol != NULL)</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    {</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        (*theo_vol).initZeros(*mask_vol);</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    }</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    {</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa668727aacc2dda12360b52026d980531">ERR_MATRIX_EMPTY</a>,</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                     <span class="stringliteral">&quot;ART_voxels2blobs_single_step: Mask and voxel volumes are empty&quot;</span>);</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    }</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    (*corr_vol).initZeros(*theo_vol);</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    pthread_t * th_ids = (pthread_t *)malloc( threads * <span class="keyword">sizeof</span>( pthread_t));</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <a class="code" href="structThreadBlobsToVoxels.html">ThreadBlobsToVoxels</a> * threads_d = (<a class="code" href="structThreadBlobsToVoxels.html">ThreadBlobsToVoxels</a> *) malloc ( threads * <span class="keyword">sizeof</span>( <a class="code" href="structThreadBlobsToVoxels.html">ThreadBlobsToVoxels</a> ) );</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="comment">// Translate actual blob volume to voxels ...............................</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; vol_in.<a class="code" href="classGridVolumeT.html#a8273923cc41926a2c0a65ab8dd2eadff">VolumesNo</a>(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    {</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <span class="keywordtype">int</span> min_distance = (int)ceil((2*(vol_in.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)).relative_size ) / blob.<a class="code" href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">radius</a> ) + 1;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        <a class="code" href="blobs_8cpp.html#ae5c7e526fd81559ab6bdef77d8c97c3d">slices_status</a> = (<span class="keywordtype">int</span> *)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*(int)((<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>((&amp;(vol_in.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)))-&gt;highest)-<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>((&amp;(vol_in.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)))-&gt;lowest)+1)));</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#ae6148da7d0bfbf264b8bcd89163b3b0f">memset</a>(<a class="code" href="blobs_8cpp.html#ae5c7e526fd81559ab6bdef77d8c97c3d">slices_status</a>,0,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*(<span class="keywordtype">int</span>)((<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>((&amp;(vol_in.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)))-&gt;highest)-<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>((&amp;(vol_in.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)))-&gt;lowest)+1)));</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        <a class="code" href="blobs_8cpp.html#a3bbb23972a1285645ecf5f00d7b15b08">slices_processed</a> = 0;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> = 0 ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> &lt; threads ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>++ )</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        {</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#ab053912f5462bff57ded7d83120b6720">vol_blobs</a> = &amp;(vol_in(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)());</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a1623bf3dd4e089c688beb66f44c4f857">grid</a> = &amp;(vol_in.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a5f05d8d3ef2e745d5c6e7256f2bcc430">blob</a> = &amp;blob;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a1164372307756843545e2ab15d801c4a">vol_voxels</a> = theo_vol;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#af10daae6ea83e674567d7a6757269f2c">D</a> = D;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a29521d89777591d338275f0f20b4f950">istep</a> = 50;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a7bba4e9d2eaf60e052d666a034feca5a">vol_corr</a> = corr_vol;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#ae331e2f5ce815286a2abba2bebff460f">vol_mask</a> = mask_vol;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a96e79f27723347b78dfc93337f9684fe">FORW</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#abcf704efb178713b06768e23dea8edbf">eq_mode</a> = eq_mode;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a83b1894e4fe53a976912f92d9e224be0">thread_id</a> = <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a3634025d0dab4211c460c83661f07f81">threads_num</a> = threads;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a47d16fa950ad9fc76471617c176444a0">min_separation</a> = min_distance;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            pthread_create( (th_ids+<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>), NULL, <a class="code" href="blobs_8cpp.html#a5877cb192e2327f576e577778cb5bdd9">blobs2voxels_SimpleGrid</a>, (<span class="keywordtype">void</span> *)(threads_d+<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>) );</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        }</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        <span class="comment">// Wait for threads to finish</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> = 0 ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> &lt; threads ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>++ )</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        {</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            pthread_join(*(th_ids+<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>),NULL);</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        }</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a>( <a class="code" href="blobs_8cpp.html#ae5c7e526fd81559ab6bdef77d8c97c3d">slices_status</a> );</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        <span class="comment">//        blobs2voxels_SimpleGrid(vol_in(i)(), vol_in.grid(i), blob, theo_vol, D,</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        <span class="comment">//                                50, corr_vol, mask_vol, FORWARD, eq_mode);</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Blob grid no &quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot; stats: &quot;</span>;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        vol_in(i)().printStats();</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;So far vol stats: &quot;</span>;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        (*theo_vol)().printStats();</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    }</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="comment">// Now normalise the resulting volume ..................................</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="group__VectorOperations.html#ga97e0d6313ec44af8ab21f7842d14125e">norm</a> = <a class="code" href="group__Blobs.html#gade32964792892a00478421dcdba274bf">sum_blob_Grid</a>(blob, vol_in.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(), D); <span class="comment">// Aqui tambien hay que multiplicar ****!!!!</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(*theo_vol)</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*theo_vol, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) /= norm;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <a class="code" href="classImage.html">Image&lt;double&gt;</a> save, save2;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    save() = *theo_vol;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    save.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;PPPtheovol.vol&quot;</span>);</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Theo stats:&quot;</span>;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    save().printStats();</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    save() = *corr_vol;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    save.<a class="code" href="classMultidimArray.html#a4a4e45352f73539481de04cbda5f3f3d">write</a>(<span class="stringliteral">&quot;PPPcorr2vol.vol&quot;</span>);</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    save2().resize(save());</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="comment">// Compute differences ..................................................</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    mean_error = 0;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keywordtype">double</span> read_val;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keywordflow">if</span> (read_vol != NULL)</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        read_val = <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*read_vol, 0, 0, 0);</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        read_val = 0;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    max_error = <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(read_val - <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*theo_vol, 0, 0, 0));</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="keywordtype">double</span> diff;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="keywordtype">int</span> N = 0;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(*theo_vol)</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    {</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        <span class="comment">// Compute difference volume and error</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        <span class="keywordflow">if</span> (read_vol != NULL)</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            read_val = <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*read_vol, k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;            read_val = 0;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        <span class="keywordflow">if</span> (mask_vol == NULL)</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        {</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;            diff = read_val - <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*theo_vol, k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;            N++;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        }</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*mask_vol, k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) == 1)</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;            {</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                diff = read_val - <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*theo_vol, k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                N++;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;            }</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                diff = 0;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        max_error = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(max_error, <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(diff));</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        mean_error += diff * diff;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        save(k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = diff;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        save2(k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = read_val;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        <span class="comment">// Compute the correction volume</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*corr_vol, k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)) &lt; 1e-2)</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*corr_vol, k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a>(<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*corr_vol, k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*corr_vol, k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) =</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;            <a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a> * diff / <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*corr_vol, k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    }</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    save.write(<span class="stringliteral">&quot;PPPdiffvol.vol&quot;</span>);</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Diff stats:&quot;</span>;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    save().printStats();</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    save2.write(<span class="stringliteral">&quot;PPPreadvol.vol&quot;</span>);</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Read stats:&quot;</span>;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    save2().printStats();</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    save() = *corr_vol;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    save.<a class="code" href="classMultidimArray.html#a4a4e45352f73539481de04cbda5f3f3d">write</a>(<span class="stringliteral">&quot;PPPcorrvol.vol&quot;</span>);</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Corr stats:&quot;</span>;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    save().printStats();</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    mean_error /= <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(N, 1); <span class="comment">// At worst, divided by 1</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="comment">// Backprojection of correction volume ..................................</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; vol_in.<a class="code" href="classGridVolumeT.html#a8273923cc41926a2c0a65ab8dd2eadff">VolumesNo</a>(); i++)</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    {</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <a class="code" href="blobs_8cpp.html#ae5c7e526fd81559ab6bdef77d8c97c3d">slices_status</a> = (<span class="keywordtype">int</span> *)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*(int)((<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>((&amp;(vol_out-&gt;<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(i)))-&gt;highest)-<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>((&amp;(vol_out-&gt;<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(i)))-&gt;lowest)+1)));</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#ae6148da7d0bfbf264b8bcd89163b3b0f">memset</a>(<a class="code" href="blobs_8cpp.html#ae5c7e526fd81559ab6bdef77d8c97c3d">slices_status</a>,0,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*(<span class="keywordtype">int</span>)((<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>((&amp;(vol_out-&gt;<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(i)))-&gt;highest)-<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>((&amp;(vol_out-&gt;<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(i)))-&gt;lowest)+1)));</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        <a class="code" href="blobs_8cpp.html#a3bbb23972a1285645ecf5f00d7b15b08">slices_processed</a> = 0;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> = 0 ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> &lt; threads ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>++ )</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        {</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#ab053912f5462bff57ded7d83120b6720">vol_blobs</a> = &amp;((*vol_out)(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)());</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a1623bf3dd4e089c688beb66f44c4f857">grid</a> = &amp;(vol_out-&gt;<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(i));</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a5f05d8d3ef2e745d5c6e7256f2bcc430">blob</a> = &amp;blob;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a1164372307756843545e2ab15d801c4a">vol_voxels</a> = theo_vol;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#af10daae6ea83e674567d7a6757269f2c">D</a> = D;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a29521d89777591d338275f0f20b4f950">istep</a> = 50;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a7bba4e9d2eaf60e052d666a034feca5a">vol_corr</a> = corr_vol;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#ae331e2f5ce815286a2abba2bebff460f">vol_mask</a> = mask_vol;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a96e79f27723347b78dfc93337f9684fe">FORW</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#abcf704efb178713b06768e23dea8edbf">eq_mode</a> = eq_mode;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a83b1894e4fe53a976912f92d9e224be0">thread_id</a> = <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a3634025d0dab4211c460c83661f07f81">threads_num</a> = threads;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a47d16fa950ad9fc76471617c176444a0">min_separation</a> = 1;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            pthread_create( (th_ids+<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>), NULL, <a class="code" href="blobs_8cpp.html#a5877cb192e2327f576e577778cb5bdd9">blobs2voxels_SimpleGrid</a>, (<span class="keywordtype">void</span> *)(threads_d+<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>) );</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        }</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        <span class="comment">// Wait for threads to finish</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> = 0 ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> &lt; threads ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>++ )</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        {</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;            pthread_join(*(th_ids+<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>),NULL);</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        }</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a>( <a class="code" href="blobs_8cpp.html#ae5c7e526fd81559ab6bdef77d8c97c3d">slices_status</a> );</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        <span class="comment">//        blobs2voxels_SimpleGrid((*vol_out)(i)(), (*vol_out).grid(i), blob,</span></div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        <span class="comment">//                                theo_vol, D, 50, corr_vol, mask_vol, BACKWARD, eq_mode);</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Blob grid no &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; stats: &quot;</span>;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        vol_in(i)().printStats();</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    }</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a>(threads_d);</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a>(th_ids);</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="keywordtype">char</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Press any key to continue\n&quot;</span>;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    std::cin &gt;&gt; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;}</div><div class="ttc" id="structThreadBlobsToVoxels_html"><div class="ttname"><a href="structThreadBlobsToVoxels.html">ThreadBlobsToVoxels</a></div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00051">blobs.h:51</a></div></div>
<div class="ttc" id="group__Macros_html_gae0a4180e923e3ffca3989e20e441aa3c"><div class="ttname"><a href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a></div><div class="ttdeci">#define XMIPP_MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00193">xmipp_macros.h:193</a></div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_abcf704efb178713b06768e23dea8edbf"><div class="ttname"><a href="structThreadBlobsToVoxels.html#abcf704efb178713b06768e23dea8edbf">ThreadBlobsToVoxels::eq_mode</a></div><div class="ttdeci">int eq_mode</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00061">blobs.h:61</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00279">multidim_array.h:279</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__Blobs_html_gade32964792892a00478421dcdba274bf"><div class="ttname"><a href="group__Blobs.html#gade32964792892a00478421dcdba274bf">sum_blob_Grid</a></div><div class="ttdeci">double sum_blob_Grid(const struct blobtype &amp;blob, const Grid &amp;grid, const Matrix2D&lt; double &gt; *D)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00306">blobs.cpp:306</a></div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_a7bba4e9d2eaf60e052d666a034feca5a"><div class="ttname"><a href="structThreadBlobsToVoxels.html#a7bba4e9d2eaf60e052d666a034feca5a">ThreadBlobsToVoxels::vol_corr</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * vol_corr</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00058">blobs.h:58</a></div></div>
<div class="ttc" id="classImageBase_html_ae81a8c11a832924c2bda0909882c3168"><div class="ttname"><a href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">ImageBase::write</a></div><div class="ttdeci">void write(const FileName &amp;name=&quot;&quot;, size_t select_img=ALL_IMAGES, bool isStack=false, int mode=WRITE_OVERWRITE, CastWriteMode castMode=CW_CAST, int _swapWrite=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00210">xmipp_image_base.cpp:210</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa668727aacc2dda12360b52026d980531"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa668727aacc2dda12360b52026d980531">ERR_MATRIX_EMPTY</a></div><div class="ttdoc">The matrix is empty. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00156">xmipp_error.h:156</a></div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_a1623bf3dd4e089c688beb66f44c4f857"><div class="ttname"><a href="structThreadBlobsToVoxels.html#a1623bf3dd4e089c688beb66f44c4f857">ThreadBlobsToVoxels::grid</a></div><div class="ttdeci">const SimpleGrid * grid</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00053">blobs.h:53</a></div></div>
<div class="ttc" id="classMultidimArray_html_a4a4e45352f73539481de04cbda5f3f3d"><div class="ttname"><a href="classMultidimArray.html#a4a4e45352f73539481de04cbda5f3f3d">MultidimArray::write</a></div><div class="ttdeci">void write(const FileName &amp;fn) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05329">multidim_array.h:5329</a></div></div>
<div class="ttc" id="group__VectorOperations_html_ga97e0d6313ec44af8ab21f7842d14125e"><div class="ttname"><a href="group__VectorOperations.html#ga97e0d6313ec44af8ab21f7842d14125e">norm</a></div><div class="ttdeci">T norm(const std::vector&lt; T &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="vector__ops_8h_source.html#l00397">vector_ops.h:397</a></div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_a29521d89777591d338275f0f20b4f950"><div class="ttname"><a href="structThreadBlobsToVoxels.html#a29521d89777591d338275f0f20b4f950">ThreadBlobsToVoxels::istep</a></div><div class="ttdeci">int istep</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00057">blobs.h:57</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="blobs_8cpp_html_ae5c7e526fd81559ab6bdef77d8c97c3d"><div class="ttname"><a href="blobs_8cpp.html#ae5c7e526fd81559ab6bdef77d8c97c3d">slices_status</a></div><div class="ttdeci">int * slices_status</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00037">blobs.cpp:37</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca36b09d6e71a60cfa3837d7e24c07ca"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a></div><div class="ttdeci">double * lambda</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04431">numerical_recipes.cpp:4431</a></div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_a5f05d8d3ef2e745d5c6e7256f2bcc430"><div class="ttname"><a href="structThreadBlobsToVoxels.html#a5f05d8d3ef2e745d5c6e7256f2bcc430">ThreadBlobsToVoxels::blob</a></div><div class="ttdeci">const struct blobtype * blob</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00054">blobs.h:54</a></div></div>
<div class="ttc" id="classGridVolumeT_html_a15c952085d4d666a36edd51858c90d0a"><div class="ttname"><a href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">GridVolumeT::grid</a></div><div class="ttdeci">const SimpleGrid &amp; grid(size_t n) const </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00991">grids.h:991</a></div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_a47d16fa950ad9fc76471617c176444a0"><div class="ttname"><a href="structThreadBlobsToVoxels.html#a47d16fa950ad9fc76471617c176444a0">ThreadBlobsToVoxels::min_separation</a></div><div class="ttdeci">int min_separation</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00064">blobs.h:64</a></div></div>
<div class="ttc" id="classGridVolumeT_html_a8273923cc41926a2c0a65ab8dd2eadff"><div class="ttname"><a href="classGridVolumeT.html#a8273923cc41926a2c0a65ab8dd2eadff">GridVolumeT::VolumesNo</a></div><div class="ttdeci">size_t VolumesNo() const </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l01016">grids.h:1016</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a32927ba57ddc0c409fd40fe79cad9982"><div class="ttname"><a href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a></div><div class="ttdeci">free((char *) ob)</div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_a3634025d0dab4211c460c83661f07f81"><div class="ttname"><a href="structThreadBlobsToVoxels.html#a3634025d0dab4211c460c83661f07f81">ThreadBlobsToVoxels::threads_num</a></div><div class="ttdeci">int threads_num</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00063">blobs.h:63</a></div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_a83b1894e4fe53a976912f92d9e224be0"><div class="ttname"><a href="structThreadBlobsToVoxels.html#a83b1894e4fe53a976912f92d9e224be0">ThreadBlobsToVoxels::thread_id</a></div><div class="ttdeci">int thread_id</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00062">blobs.h:62</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae6148da7d0bfbf264b8bcd89163b3b0f"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae6148da7d0bfbf264b8bcd89163b3b0f">memset</a></div><div class="ttdeci">memset(wksp+1, 0, n *sizeof(double))</div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_ab053912f5462bff57ded7d83120b6720"><div class="ttname"><a href="structThreadBlobsToVoxels.html#ab053912f5462bff57ded7d83120b6720">ThreadBlobsToVoxels::vol_blobs</a></div><div class="ttdeci">const MultidimArray&lt; double &gt; * vol_blobs</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00052">blobs.h:52</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_af10daae6ea83e674567d7a6757269f2c"><div class="ttname"><a href="structThreadBlobsToVoxels.html#af10daae6ea83e674567d7a6757269f2c">ThreadBlobsToVoxels::D</a></div><div class="ttdeci">const Matrix2D&lt; double &gt; * D</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00056">blobs.h:56</a></div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_ae331e2f5ce815286a2abba2bebff460f"><div class="ttname"><a href="structThreadBlobsToVoxels.html#ae331e2f5ce815286a2abba2bebff460f">ThreadBlobsToVoxels::vol_mask</a></div><div class="ttdeci">const MultidimArray&lt; double &gt; * vol_mask</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00059">blobs.h:59</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a3bbb23972a1285645ecf5f00d7b15b08"><div class="ttname"><a href="blobs_8cpp.html#a3bbb23972a1285645ecf5f00d7b15b08">slices_processed</a></div><div class="ttdeci">int slices_processed</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00038">blobs.cpp:38</a></div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_a96e79f27723347b78dfc93337f9684fe"><div class="ttname"><a href="structThreadBlobsToVoxels.html#a96e79f27723347b78dfc93337f9684fe">ThreadBlobsToVoxels::FORW</a></div><div class="ttdeci">bool FORW</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00060">blobs.h:60</a></div></div>
<div class="ttc" id="group__Macros_html_ga95ed41486ca0ed53262e4b8934d4afac"><div class="ttname"><a href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a></div><div class="ttdeci">#define SGN(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00155">xmipp_macros.h:155</a></div></div>
<div class="ttc" id="structblobtype_html_a292968bd7221739a3a58231353f0d0ec"><div class="ttname"><a href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">blobtype::radius</a></div><div class="ttdeci">double radius</div><div class="ttdoc">Spatial radius in Universal System units. </div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00116">blobs.h:116</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_a1164372307756843545e2ab15d801c4a"><div class="ttname"><a href="structThreadBlobsToVoxels.html#a1164372307756843545e2ab15d801c4a">ThreadBlobsToVoxels::vol_voxels</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * vol_voxels</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00055">blobs.h:55</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a5877cb192e2327f576e577778cb5bdd9"><div class="ttname"><a href="blobs_8cpp.html#a5877cb192e2327f576e577778cb5bdd9">blobs2voxels_SimpleGrid</a></div><div class="ttdeci">void * blobs2voxels_SimpleGrid(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00431">blobs.cpp:431</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gad30bf1a00f736d5378040c6d4f4e30a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double basvolume </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function actually computing the blob integral </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l00207">207</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;{</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordtype">double</span>  hn, tpi, v;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    hn = 0.5 * <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    tpi = 2.0 * <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">if</span> (alpha == 0.0)</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> / 2)*2 == <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)           <span class="comment">/* n even                               */</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            v = pow(tpi, hn) * <a class="code" href="group__Blobs.html#ga9ca9464825734b841e8fe3b688d4210b">in_zeroarg</a>(<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> / 2 + <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>) / <a class="code" href="group__Blobs.html#ga9ca9464825734b841e8fe3b688d4210b">in_zeroarg</a>(<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">else</span>                        <span class="comment">/* n odd                                */</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            v = pow(tpi, hn) * <a class="code" href="group__Blobs.html#ga5535ae1ec6293ae20ff93667838ab722">inph_zeroarg</a>(<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> / 2 + <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>) / <a class="code" href="group__Blobs.html#ga9ca9464825734b841e8fe3b688d4210b">in_zeroarg</a>(<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    }</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    {                        <span class="comment">/* alpha &gt; 0.0                          */</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> / 2)*2 == <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)           <span class="comment">/* n even                               */</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            v = pow(tpi / alpha, hn) * <a class="code" href="group__Blobs.html#gab1c7e82811e94d7957dc0f8891a57cfa">i_n</a>(<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> / 2 + <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, alpha) / <a class="code" href="group__Blobs.html#gab1c7e82811e94d7957dc0f8891a57cfa">i_n</a>(<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, alpha);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">else</span>                        <span class="comment">/* n odd                                */</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            v = pow(tpi / alpha, hn) * <a class="code" href="group__Blobs.html#ga1c16f98dae81ec5758de5d1de321e4a8">i_nph</a>(<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> / 2 + <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, alpha) / <a class="code" href="group__Blobs.html#gab1c7e82811e94d7957dc0f8891a57cfa">i_n</a>(<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, alpha);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">return</span> v * pow(<a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, (<span class="keywordtype">double</span>)<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;}</div><div class="ttc" id="group__Blobs_html_ga1c16f98dae81ec5758de5d1de321e4a8"><div class="ttname"><a href="group__Blobs.html#ga1c16f98dae81ec5758de5d1de321e4a8">i_nph</a></div><div class="ttdeci">double i_nph(int n, double x)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00258">blobs.cpp:258</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a438c75002165fed58970c95d67a268c1"><div class="ttname"><a href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a></div><div class="ttdeci">int m</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="group__Blobs_html_gab1c7e82811e94d7957dc0f8891a57cfa"><div class="ttname"><a href="group__Blobs.html#gab1c7e82811e94d7957dc0f8891a57cfa">i_n</a></div><div class="ttdeci">double i_n(int n, double x)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00234">blobs.cpp:234</a></div></div>
<div class="ttc" id="group__Blobs_html_ga9ca9464825734b841e8fe3b688d4210b"><div class="ttname"><a href="group__Blobs.html#ga9ca9464825734b841e8fe3b688d4210b">in_zeroarg</a></div><div class="ttdeci">double in_zeroarg(int n)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00280">blobs.cpp:280</a></div></div>
<div class="ttc" id="group__Blobs_html_ga5535ae1ec6293ae20ff93667838ab722"><div class="ttname"><a href="group__Blobs.html#ga5535ae1ec6293ae20ff93667838ab722">inph_zeroarg</a></div><div class="ttdeci">double inph_zeroarg(int n)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00293">blobs.cpp:293</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af2a333b1670df64a88d3a2f22210d155"><div class="ttname"><a href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a></div><div class="ttdeci">doublereal * a</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gac8e2050314c77dfb98af95f408365bb2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structblobtype.html">blobtype</a> best_blob </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha_0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha_F</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>inc_alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a_0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a_F</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>inc_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>target_att</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>target_length</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Choose the best blob within a region. You must select a resolution limit, the maximum attenuation allowed at that frequency and then the blob with less computational cost is returned. m=2 always. The resolution criterion is given by w (remind that this w=Tm*w(cont)).</p>
<p>If there is no blob meeting the specification then alpha=a=-1. </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l00349">349</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;{</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <a class="code" href="structblobtype.html">blobtype</a> retval;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    retval.<a class="code" href="structblobtype.html#a4036b7fa8f0373d57c8f500c140ada64">order</a> = 2;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordtype">int</span> alpha_size = <a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>((alpha_F - alpha_0) / inc_alpha + 1);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordtype">int</span> a_size = <a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>((a_F - a_0) / inc_a + 1);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="classImage.html">Image&lt;double&gt;</a> att, ops;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    att().resize(alpha_size, a_size);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    ops().resize(alpha_size, a_size);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, alpha, best_a = -1, best_alpha = -1;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordtype">double</span> best_ops = 1e10, best_att = 0;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">for</span> (i = 0, alpha = alpha_0; i &lt; alpha_size; alpha += inc_alpha, i++)</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="keywordflow">for</span> (j = 0, a = a_0; j &lt; a_size; a += inc_a, j++)</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        {</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            retval.<a class="code" href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">radius</a> = <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            retval.<a class="code" href="structblobtype.html#ae713f8fc66da6e18d0bc2ff381bda22f">alpha</a> = alpha;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(att(), i, j) = <a class="code" href="group__Blobs.html#ga6b970e558ce2e6e3cb9b542c8f1fa058">blob_att</a>(<a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>, retval);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(ops(), i, j) = <a class="code" href="group__Blobs.html#ga0f7631fefa14f5ea33a34e649dad99a2">blob_ops</a>(<a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>, retval);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <span class="keywordflow">if</span> (j &gt; 0)</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = target_length - 1; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> &gt;= 0; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>--)</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(att(), i, j - 1) &gt; target_att[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>] &amp;&amp;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                        <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(att(), i, j) &lt; target_att[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>])</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                    {</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                        <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(att(), i, j) = 0;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(ops(), i, j - 1) &lt; best_ops &amp;&amp;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                            <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(att(), i, j - 1) &gt;= best_att)</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                        {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                            best_alpha = alpha;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                            best_a = a - inc_a;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                            best_ops = <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(ops(), i, j - 1);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                            best_att = target_att[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>];</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                        }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                    }</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    att.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>((<a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a>)<span class="stringliteral">&quot;att&quot;</span> + <a class="code" href="matrix1d_8h.html#a8dc59a100c0e68668a8ac460336d9ef1">floatToString</a>(<a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>) + <span class="stringliteral">&quot;.xmp&quot;</span>);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    ops.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>((<a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a>)<span class="stringliteral">&quot;ops&quot;</span> + <a class="code" href="matrix1d_8h.html#a8dc59a100c0e68668a8ac460336d9ef1">floatToString</a>(<a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>) + <span class="stringliteral">&quot;.xmp&quot;</span>);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    retval.<a class="code" href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">radius</a> = best_a;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    retval.<a class="code" href="structblobtype.html#ae713f8fc66da6e18d0bc2ff381bda22f">alpha</a> = best_alpha;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">return</span> retval;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;}</div><div class="ttc" id="structblobtype_html"><div class="ttname"><a href="structblobtype.html">blobtype</a></div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00113">blobs.h:113</a></div></div>
<div class="ttc" id="structblobtype_html_ae713f8fc66da6e18d0bc2ff381bda22f"><div class="ttname"><a href="structblobtype.html#ae713f8fc66da6e18d0bc2ff381bda22f">blobtype::alpha</a></div><div class="ttdeci">double alpha</div><div class="ttdoc">Smoothness parameter. </div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00122">blobs.h:122</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00364">multidim_array.h:364</a></div></div>
<div class="ttc" id="namespacetesting_1_1internal_html_a8e8ff5b11e64078831112677156cb111"><div class="ttname"><a href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">testing::internal::string</a></div><div class="ttdeci">::std::string string</div><div class="ttdef"><b>Definition:</b> <a href="gtest_8h_source.html#l01818">gtest.h:1818</a></div></div>
<div class="ttc" id="matrix1d_8h_html_a8dc59a100c0e68668a8ac460336d9ef1"><div class="ttname"><a href="matrix1d_8h.html#a8dc59a100c0e68668a8ac460336d9ef1">floatToString</a></div><div class="ttdeci">std::string floatToString(float F, int _width, int _prec)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__strings_8cpp_source.html#l00212">xmipp_strings.cpp:212</a></div></div>
<div class="ttc" id="classImageBase_html_ae81a8c11a832924c2bda0909882c3168"><div class="ttname"><a href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">ImageBase::write</a></div><div class="ttdeci">void write(const FileName &amp;name=&quot;&quot;, size_t select_img=ALL_IMAGES, bool isStack=false, int mode=WRITE_OVERWRITE, CastWriteMode castMode=CW_CAST, int _swapWrite=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00210">xmipp_image_base.cpp:210</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a2b83edee7677c7a2b0a4e5ac99baa586"><div class="ttname"><a href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a></div><div class="ttdeci">doublereal * w</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02494">numerical_recipes.cpp:2494</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Macros_html_ga2f0eecb0f7856721f56faff8f27b0dc1"><div class="ttname"><a href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a></div><div class="ttdeci">#define FLOOR(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00240">xmipp_macros.h:240</a></div></div>
<div class="ttc" id="group__Blobs_html_ga0f7631fefa14f5ea33a34e649dad99a2"><div class="ttname"><a href="group__Blobs.html#ga0f7631fefa14f5ea33a34e649dad99a2">blob_ops</a></div><div class="ttdeci">double blob_ops(double w, struct blobtype b)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00328">blobs.cpp:328</a></div></div>
<div class="ttc" id="group__Blobs_html_ga6b970e558ce2e6e3cb9b542c8f1fa058"><div class="ttname"><a href="group__Blobs.html#ga6b970e558ce2e6e3cb9b542c8f1fa058">blob_att</a></div><div class="ttdeci">double blob_att(double w, struct blobtype b)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00322">blobs.cpp:322</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="structblobtype_html_a4036b7fa8f0373d57c8f500c140ada64"><div class="ttname"><a href="structblobtype.html#a4036b7fa8f0373d57c8f500c140ada64">blobtype::order</a></div><div class="ttdeci">int order</div><div class="ttdoc">Derivation order and Bessel function order. </div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00119">blobs.h:119</a></div></div>
<div class="ttc" id="structblobtype_html_a292968bd7221739a3a58231353f0d0ec"><div class="ttname"><a href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">blobtype::radius</a></div><div class="ttdeci">double radius</div><div class="ttdoc">Spatial radius in Universal System units. </div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00116">blobs.h:116</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af2a333b1670df64a88d3a2f22210d155"><div class="ttname"><a href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a></div><div class="ttdeci">doublereal * a</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga6b970e558ce2e6e3cb9b542c8f1fa058"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double blob_att </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structblobtype.html">blobtype</a>&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Attenuation of a blob. The Fourier transform of the blob at w is the Fourier transform at w=0 multiplied by the attenuation. This is the value returned. Remind that the frequency must be normalized by the sampling rate. Ie, Tm*w(cont) </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l00322">322</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;{</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__Blobs.html#ga8119af50e3fa095d670c01a680d9f2cc">blob_Fourier_val</a>(<a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>, b) / <a class="code" href="group__Blobs.html#ga8119af50e3fa095d670c01a680d9f2cc">blob_Fourier_val</a>(0, b);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_a2b83edee7677c7a2b0a4e5ac99baa586"><div class="ttname"><a href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a></div><div class="ttdeci">doublereal * w</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02494">numerical_recipes.cpp:2494</a></div></div>
<div class="ttc" id="group__Blobs_html_ga8119af50e3fa095d670c01a680d9f2cc"><div class="ttname"><a href="group__Blobs.html#ga8119af50e3fa095d670c01a680d9f2cc">blob_Fourier_val</a></div><div class="ttdeci">#define blob_Fourier_val(w, blob)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00175">blobs.h:175</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga87a45c6b1e8619e08888ab103c1fd7f9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double blob_freq_zero </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structblobtype.html">blobtype</a>&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classBlob.html">Blob</a> pole. This is the normalized frequency at which the blob goes to 0. </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l00316">316</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;{</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(b.<a class="code" href="structblobtype.html#ae713f8fc66da6e18d0bc2ff381bda22f">alpha</a>*b.<a class="code" href="structblobtype.html#ae713f8fc66da6e18d0bc2ff381bda22f">alpha</a> + 6.9879*6.9879) / (2*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>*b.<a class="code" href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">radius</a>);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;}</div><div class="ttc" id="structblobtype_html_ae713f8fc66da6e18d0bc2ff381bda22f"><div class="ttname"><a href="structblobtype.html#ae713f8fc66da6e18d0bc2ff381bda22f">blobtype::alpha</a></div><div class="ttdeci">double alpha</div><div class="ttdoc">Smoothness parameter. </div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00122">blobs.h:122</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="structblobtype_html_a292968bd7221739a3a58231353f0d0ec"><div class="ttname"><a href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">blobtype::radius</a></div><div class="ttdeci">double radius</div><div class="ttdoc">Spatial radius in Universal System units. </div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00116">blobs.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga0f7631fefa14f5ea33a34e649dad99a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double blob_ops </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structblobtype.html">blobtype</a>&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of operations for a blob. This is a number proportional to the number of operations that ART would need to make a reconstruction with this blob. </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l00328">328</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;{</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">return</span> pow(b.<a class="code" href="structblobtype.html#ae713f8fc66da6e18d0bc2ff381bda22f">alpha</a>*b.<a class="code" href="structblobtype.html#ae713f8fc66da6e18d0bc2ff381bda22f">alpha</a> + 6.9879*6.9879, 1.5) / b.<a class="code" href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">radius</a>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;}</div><div class="ttc" id="structblobtype_html_ae713f8fc66da6e18d0bc2ff381bda22f"><div class="ttname"><a href="structblobtype.html#ae713f8fc66da6e18d0bc2ff381bda22f">blobtype::alpha</a></div><div class="ttdeci">double alpha</div><div class="ttdoc">Smoothness parameter. </div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00122">blobs.h:122</a></div></div>
<div class="ttc" id="structblobtype_html_a292968bd7221739a3a58231353f0d0ec"><div class="ttname"><a href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">blobtype::radius</a></div><div class="ttdeci">double radius</div><div class="ttdoc">Spatial radius in Universal System units. </div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00116">blobs.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga32723dcca7f313a15c62ba3f8652282a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void blobs2space_coefficients </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__Grids.html#gae3eeb15b316a9800a7c35372dfd57460">GridVolume</a> &amp;&#160;</td>
          <td class="paramname"><em>vol_blobs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structblobtype.html">blobtype</a> &amp;&#160;</td>
          <td class="paramname"><em>blob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>vol_coefs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classBlob.html">Blob</a> coefficients as a voxel volume. This function returns a volume with the blob coefficients in their right position in space. The voxel size is g/2 </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l01011">1011</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;{</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="comment">// Compute vol_coefs shape</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a> corner1, size;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <a class="code" href="group__Blobs.html#ga8947e150817ff61eebf5187a73985610">voxel_volume_shape</a>(vol_blobs, blob, NULL, corner1, size);</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="keywordtype">double</span> g_2 = vol_blobs.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(0).<a class="code" href="classSimpleGrid.html#a2661c126b41f13e003892f364c6f5b8e">relative_size</a> / 2;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1) = (int)(<a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1)) / g_2);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(size) = (int)(<a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(size)) / g_2);</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1) = (int)(<a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1)) / g_2);</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(size) = (int)(<a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(size)) / g_2);</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner1) = (int)(<a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner1)) / g_2);</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(size) = (int)(<a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(size)) / g_2);</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    (*vol_coefs).initZeros(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(size), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(size), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(size));</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(*vol_coefs) = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1);</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(*vol_coefs) = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1);</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(*vol_coefs) = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner1);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="comment">// Set all blob coefficients at the right position</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = 0; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> &lt; vol_blobs.<a class="code" href="classGridVolumeT.html#a8273923cc41926a2c0a65ab8dd2eadff">VolumesNo</a>(); <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>++)</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    {</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        <span class="keywordtype">int</span> ZZ_lowest = (int)<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(vol_blobs.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>).<a class="code" href="classSimpleGrid.html#ac11364ea0ab16392eef9db243986bc5a">lowest</a>);</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        <span class="keywordtype">int</span> YY_lowest = (int)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(vol_blobs.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>).<a class="code" href="classSimpleGrid.html#ac11364ea0ab16392eef9db243986bc5a">lowest</a>);</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        <span class="keywordtype">int</span> XX_lowest = (int)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(vol_blobs.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>).<a class="code" href="classSimpleGrid.html#ac11364ea0ab16392eef9db243986bc5a">lowest</a>);</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        <span class="keywordtype">int</span> ZZ_highest = (int)<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(vol_blobs.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>).<a class="code" href="classSimpleGrid.html#a9b2b5818f2b06e553c3c6a2a6d2a8951">highest</a>);</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        <span class="keywordtype">int</span> YY_highest = (int)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(vol_blobs.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>).<a class="code" href="classSimpleGrid.html#a9b2b5818f2b06e553c3c6a2a6d2a8951">highest</a>);</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        <span class="keywordtype">int</span> XX_highest = (int)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(vol_blobs.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>).<a class="code" href="classSimpleGrid.html#a9b2b5818f2b06e553c3c6a2a6d2a8951">highest</a>);</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> = ZZ_lowest; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> &lt;= ZZ_highest; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>++)</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = YY_lowest; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= YY_highest; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = XX_lowest; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt;= XX_highest; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                {</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> grid_index(3), univ_position(3),</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                    coef_position(3);</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(grid_index, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>);</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                    vol_blobs.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>).<a class="code" href="classSimpleGrid.html#a1de43d3a6ae7166e119e56ff58a6c452">grid2universe</a>(grid_index, univ_position);</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                    <a class="code" href="group__Vectors.html#ga0c31197d639e9b7b7b8abe4eaebbaa5b">V3_BY_CT</a>(coef_position, univ_position, 1.0 / g_2);</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>((*vol_coefs),</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                             (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(coef_position),</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                             (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(coef_position),</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                             (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(coef_position) ) = <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(vol_blobs(<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)(), <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;Blob value at (&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                    &lt;&lt; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> &lt;&lt; <span class="stringliteral">&quot;) (&quot;</span> &lt;&lt; <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(univ_position)</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(univ_position) &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                    &lt;&lt; <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(univ_position) &lt;&lt; <span class="stringliteral">&quot;) (&quot;</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                    &lt;&lt; <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(coef_position) &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(coef_position) &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                    &lt;&lt; <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(coef_position) &lt;&lt; <span class="stringliteral">&quot;) --&gt; &quot;</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                    &lt;&lt; <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(vol_blobs(<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)(), (<span class="keywordtype">int</span>)<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, (<span class="keywordtype">int</span>)<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, (<span class="keywordtype">int</span>)<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) &lt;&lt; std::endl;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                }</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    }</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;}</div><div class="ttc" id="group__Blobs_html_ga8947e150817ff61eebf5187a73985610"><div class="ttname"><a href="group__Blobs.html#ga8947e150817ff61eebf5187a73985610">voxel_volume_shape</a></div><div class="ttdeci">void voxel_volume_shape(const GridVolume &amp;vol_blobs, const struct blobtype &amp;blob, const Matrix2D&lt; double &gt; *D, Matrix1D&lt; int &gt; &amp;corner1, Matrix1D&lt; int &gt; &amp;size)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00833">blobs.cpp:833</a></div></div>
<div class="ttc" id="classSimpleGrid_html_a9b2b5818f2b06e553c3c6a2a6d2a8951"><div class="ttname"><a href="classSimpleGrid.html#a9b2b5818f2b06e553c3c6a2a6d2a8951">SimpleGrid::highest</a></div><div class="ttdeci">Matrix1D&lt; double &gt; highest</div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00160">grids.h:160</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="classSimpleGrid_html_a1de43d3a6ae7166e119e56ff58a6c452"><div class="ttname"><a href="classSimpleGrid.html#a1de43d3a6ae7166e119e56ff58a6c452">SimpleGrid::grid2universe</a></div><div class="ttdeci">void grid2universe(const Matrix1D&lt; double &gt; &amp;gv, Matrix1D&lt; double &gt; &amp;uv) const </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00326">grids.h:326</a></div></div>
<div class="ttc" id="classSimpleGrid_html_ac11364ea0ab16392eef9db243986bc5a"><div class="ttname"><a href="classSimpleGrid.html#ac11364ea0ab16392eef9db243986bc5a">SimpleGrid::lowest</a></div><div class="ttdeci">Matrix1D&lt; double &gt; lowest</div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00157">grids.h:157</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga0c31197d639e9b7b7b8abe4eaebbaa5b"><div class="ttname"><a href="group__Vectors.html#ga0c31197d639e9b7b7b8abe4eaebbaa5b">V3_BY_CT</a></div><div class="ttdeci">#define V3_BY_CT(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00241">matrix1d.h:241</a></div></div>
<div class="ttc" id="group__Macros_html_ga2f0eecb0f7856721f56faff8f27b0dc1"><div class="ttname"><a href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a></div><div class="ttdeci">#define FLOOR(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00240">xmipp_macros.h:240</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="classGridVolumeT_html_a15c952085d4d666a36edd51858c90d0a"><div class="ttname"><a href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">GridVolumeT::grid</a></div><div class="ttdeci">const SimpleGrid &amp; grid(size_t n) const </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00991">grids.h:991</a></div></div>
<div class="ttc" id="classGridVolumeT_html_a8273923cc41926a2c0a65ab8dd2eadff"><div class="ttname"><a href="classGridVolumeT.html#a8273923cc41926a2c0a65ab8dd2eadff">GridVolumeT::VolumesNo</a></div><div class="ttdeci">size_t VolumesNo() const </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l01016">grids.h:1016</a></div></div>
<div class="ttc" id="classSimpleGrid_html_a2661c126b41f13e003892f364c6f5b8e"><div class="ttname"><a href="classSimpleGrid.html#a2661c126b41f13e003892f364c6f5b8e">SimpleGrid::relative_size</a></div><div class="ttdeci">double relative_size</div><div class="ttdoc">Measuring unit in the grid coordinate system. </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00162">grids.h:162</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; int &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_ga6c6b4d4f88daca5e1d8e171bec3b4af0"><div class="ttname"><a href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a></div><div class="ttdeci">#define VECTOR_R3(v, x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00127">matrix1d.h:127</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga769d35289332d6806a6358b748ecc0a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void blobs2voxels </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__Grids.html#gae3eeb15b316a9800a7c35372dfd57460">GridVolume</a> &amp;&#160;</td>
          <td class="paramname"><em>vol_blobs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structblobtype.html">blobtype</a> &amp;&#160;</td>
          <td class="paramname"><em>blob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>vol_voxels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>D</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>threads</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Zdim</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Blobs &mdash;&gt; Voxels. The voxel size is defined between two coordinates (Gcorner1 and Gcorner2) which accomplish </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;XX(Gcorner1)=MIN(XX(SGcorner1(i)));</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;YY(Gcorner1)=MIN(YY(SGcorner1(i)));</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;ZZ(Gcorner1)=MIN(ZZ(SGcorner1(i)));</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;XX(Gcorner2)=MAX(XX(SGcorner2(i)));</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;YY(Gcorner2)=MAX(YY(SGcorner2(i)));</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;ZZ(Gcorner2)=MAX(ZZ(SGcorner2(i)));</div></div><!-- fragment --><p> where SGcorner1(i) and SGcorner2(i) are the lowest and highest corners of each subgrid. These corners are expressed in Universal coordinates.</p>
<p>This quantity is then enlarged to be an integer voxel position and to take into account that the former computed Gcorner1 and 2 are the furthest centers of blobs, ie, there will be voxels even further affected by these blobs. </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Gcorner1 = CEILnD (Gcorner1 - blob.radius);</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Gcorner2 = FLOORnD(Gcorner2 + blob.radius);</div></div><!-- fragment --><p>However, you might give a size, usually set to 0, i.e., no external size. If no size is provided a size is produced such that all blob centers fit into the output volume.</p>
<p>D is a 3x3 matrix specifying a volume deformation. It means that the sample at logical position (i,j,k) is really placed at space position D*(i,j,k)'. </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l00907">907</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;{</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="comment">// Resize and set starting corner .......................................</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keywordflow">if</span> (Zdim == 0 || Ydim == 0 || Xdim == 0)</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    {</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a> size, corner;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <a class="code" href="group__Blobs.html#ga8947e150817ff61eebf5187a73985610">voxel_volume_shape</a>(vol_blobs, blob, D, corner, size);</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        (*vol_voxels).initZeros(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(size), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(size), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(size));</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(*vol_voxels) = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(*vol_voxels) = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner);</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(*vol_voxels) = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner);</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    }</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    {</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        (*vol_voxels).initZeros(Zdim, Ydim, Xdim);</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        (*vol_voxels).setXmippOrigin();</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    }</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    pthread_t * th_ids = <span class="keyword">new</span> pthread_t [threads];</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <a class="code" href="structThreadBlobsToVoxels.html">ThreadBlobsToVoxels</a> * threads_d = <span class="keyword">new</span> <a class="code" href="structThreadBlobsToVoxels.html">ThreadBlobsToVoxels</a> [threads];</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="comment">// Convert each subvolume ...............................................</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; vol_blobs.<a class="code" href="classGridVolumeT.html#a8273923cc41926a2c0a65ab8dd2eadff">VolumesNo</a>(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    {</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <span class="keywordtype">int</span> min_distance = (int)ceil((2*(vol_blobs.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)).relative_size ) / blob.<a class="code" href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">radius</a> ) + 1;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        <a class="code" href="blobs_8cpp.html#ae5c7e526fd81559ab6bdef77d8c97c3d">slices_status</a> = (<span class="keywordtype">int</span> *)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*(int)((<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>((&amp;(vol_blobs.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)))-&gt;highest)-<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>((&amp;(vol_blobs.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)))-&gt;lowest)+1)));</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#ae6148da7d0bfbf264b8bcd89163b3b0f">memset</a>(<a class="code" href="blobs_8cpp.html#ae5c7e526fd81559ab6bdef77d8c97c3d">slices_status</a>,0,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*(<span class="keywordtype">int</span>)((<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>((&amp;(vol_blobs.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)))-&gt;highest)-<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>((&amp;(vol_blobs.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)))-&gt;lowest)+1)));</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <a class="code" href="blobs_8cpp.html#a3bbb23972a1285645ecf5f00d7b15b08">slices_processed</a> = 0;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> = 0 ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> &lt; threads ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>++ )</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        {</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#ab053912f5462bff57ded7d83120b6720">vol_blobs</a> = &amp;(vol_blobs(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)());</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a1623bf3dd4e089c688beb66f44c4f857">grid</a> = &amp;(vol_blobs.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a5f05d8d3ef2e745d5c6e7256f2bcc430">blob</a> = &amp;blob;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a1164372307756843545e2ab15d801c4a">vol_voxels</a> = vol_voxels;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#af10daae6ea83e674567d7a6757269f2c">D</a> = D;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a29521d89777591d338275f0f20b4f950">istep</a> = 50;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a7bba4e9d2eaf60e052d666a034feca5a">vol_corr</a> = NULL;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#ae331e2f5ce815286a2abba2bebff460f">vol_mask</a> = NULL;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a96e79f27723347b78dfc93337f9684fe">FORW</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#abcf704efb178713b06768e23dea8edbf">eq_mode</a> = <a class="code" href="group__Blobs.html#gae1a62943287cc2f243753d3a9d0dcd9d">VARTK</a>;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a83b1894e4fe53a976912f92d9e224be0">thread_id</a> = <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a3634025d0dab4211c460c83661f07f81">threads_num</a> = threads;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structThreadBlobsToVoxels.html#a47d16fa950ad9fc76471617c176444a0">min_separation</a> = min_distance;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            pthread_create( (th_ids+<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>), NULL, <a class="code" href="blobs_8cpp.html#a5877cb192e2327f576e577778cb5bdd9">blobs2voxels_SimpleGrid</a>, (<span class="keywordtype">void</span> *)(threads_d+<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>) );</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        }</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        <span class="comment">// Wait for threads to finish</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> = 0 ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> &lt; threads ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>++ )</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        {</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            pthread_join(*(th_ids+<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>),NULL);</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        }</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Blob grid no &quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot; stats: &quot;</span>;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        vol_blobs(i)().printStats();</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;So far vol stats: &quot;</span>;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        (*vol_voxels).printStats();</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <a class="code" href="classImage.html">Image&lt;double&gt;</a> save;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        save() = *vol_voxels;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        save.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>((<a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a>)<span class="stringliteral">&quot;PPPvoxels&quot;</span> + <a class="code" href="group__StringUtilities.html#ga01d0008bd87a0d41a3927e28b9f44b63">integerToString</a>(i));</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a>( <a class="code" href="blobs_8cpp.html#ae5c7e526fd81559ab6bdef77d8c97c3d">slices_status</a> );</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    }</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="comment">// Now normalise the resulting volume ..................................</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keywordtype">double</span> inorm = 1.0 / <a class="code" href="group__Blobs.html#gade32964792892a00478421dcdba274bf">sum_blob_Grid</a>(blob, vol_blobs.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(), D); <span class="comment">// Aqui tambien hay que multiplicar ****!!!!</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(*vol_voxels)</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*vol_voxels, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) *= inorm;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="comment">// Set voxels outside interest region to minimum value .................</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="keywordtype">double</span> R = vol_blobs.grid(0).get_interest_radius();</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (R != -1)</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    {</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <span class="keywordtype">double</span> R2 = (R - 6) * (R - 6);</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <span class="comment">// Compute minimum value within sphere</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        <span class="keywordtype">double</span> min_val = <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*vol_voxels, 0, 0, 0);</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(*vol_voxels)</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>*<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + i*i + k*k &lt;= R2 - 4)</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            min_val = <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(min_val, <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*vol_voxels, k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <span class="comment">// Substitute minimum value</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        R2 = (R - 2) * (R - 2);</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(*vol_voxels)</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (j*j + i*i + k*k &gt;= R2)</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*vol_voxels, k, i, j) = min_val;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    }</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    delete[] th_ids;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    delete[] threads_d;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;}</div><div class="ttc" id="structThreadBlobsToVoxels_html"><div class="ttname"><a href="structThreadBlobsToVoxels.html">ThreadBlobsToVoxels</a></div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00051">blobs.h:51</a></div></div>
<div class="ttc" id="group__Blobs_html_ga8947e150817ff61eebf5187a73985610"><div class="ttname"><a href="group__Blobs.html#ga8947e150817ff61eebf5187a73985610">voxel_volume_shape</a></div><div class="ttdeci">void voxel_volume_shape(const GridVolume &amp;vol_blobs, const struct blobtype &amp;blob, const Matrix2D&lt; double &gt; *D, Matrix1D&lt; int &gt; &amp;corner1, Matrix1D&lt; int &gt; &amp;size)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00833">blobs.cpp:833</a></div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_abcf704efb178713b06768e23dea8edbf"><div class="ttname"><a href="structThreadBlobsToVoxels.html#abcf704efb178713b06768e23dea8edbf">ThreadBlobsToVoxels::eq_mode</a></div><div class="ttdeci">int eq_mode</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00061">blobs.h:61</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00279">multidim_array.h:279</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__Blobs_html_gade32964792892a00478421dcdba274bf"><div class="ttname"><a href="group__Blobs.html#gade32964792892a00478421dcdba274bf">sum_blob_Grid</a></div><div class="ttdeci">double sum_blob_Grid(const struct blobtype &amp;blob, const Grid &amp;grid, const Matrix2D&lt; double &gt; *D)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00306">blobs.cpp:306</a></div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_a7bba4e9d2eaf60e052d666a034feca5a"><div class="ttname"><a href="structThreadBlobsToVoxels.html#a7bba4e9d2eaf60e052d666a034feca5a">ThreadBlobsToVoxels::vol_corr</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * vol_corr</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00058">blobs.h:58</a></div></div>
<div class="ttc" id="namespacetesting_1_1internal_html_a8e8ff5b11e64078831112677156cb111"><div class="ttname"><a href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">testing::internal::string</a></div><div class="ttdeci">::std::string string</div><div class="ttdef"><b>Definition:</b> <a href="gtest_8h_source.html#l01818">gtest.h:1818</a></div></div>
<div class="ttc" id="classImageBase_html_ae81a8c11a832924c2bda0909882c3168"><div class="ttname"><a href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">ImageBase::write</a></div><div class="ttdeci">void write(const FileName &amp;name=&quot;&quot;, size_t select_img=ALL_IMAGES, bool isStack=false, int mode=WRITE_OVERWRITE, CastWriteMode castMode=CW_CAST, int _swapWrite=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00210">xmipp_image_base.cpp:210</a></div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_a1623bf3dd4e089c688beb66f44c4f857"><div class="ttname"><a href="structThreadBlobsToVoxels.html#a1623bf3dd4e089c688beb66f44c4f857">ThreadBlobsToVoxels::grid</a></div><div class="ttdeci">const SimpleGrid * grid</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00053">blobs.h:53</a></div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_a29521d89777591d338275f0f20b4f950"><div class="ttname"><a href="structThreadBlobsToVoxels.html#a29521d89777591d338275f0f20b4f950">ThreadBlobsToVoxels::istep</a></div><div class="ttdeci">int istep</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00057">blobs.h:57</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__StringUtilities_html_ga01d0008bd87a0d41a3927e28b9f44b63"><div class="ttname"><a href="group__StringUtilities.html#ga01d0008bd87a0d41a3927e28b9f44b63">integerToString</a></div><div class="ttdeci">String integerToString(int I, int _width, char fill_with)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__strings_8cpp_source.html#l00261">xmipp_strings.cpp:261</a></div></div>
<div class="ttc" id="group__Blobs_html_gae1a62943287cc2f243753d3a9d0dcd9d"><div class="ttname"><a href="group__Blobs.html#gae1a62943287cc2f243753d3a9d0dcd9d">VARTK</a></div><div class="ttdeci">#define VARTK</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00379">blobs.h:379</a></div></div>
<div class="ttc" id="blobs_8cpp_html_ae5c7e526fd81559ab6bdef77d8c97c3d"><div class="ttname"><a href="blobs_8cpp.html#ae5c7e526fd81559ab6bdef77d8c97c3d">slices_status</a></div><div class="ttdeci">int * slices_status</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00037">blobs.cpp:37</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_a5f05d8d3ef2e745d5c6e7256f2bcc430"><div class="ttname"><a href="structThreadBlobsToVoxels.html#a5f05d8d3ef2e745d5c6e7256f2bcc430">ThreadBlobsToVoxels::blob</a></div><div class="ttdeci">const struct blobtype * blob</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00054">blobs.h:54</a></div></div>
<div class="ttc" id="classGridVolumeT_html_a15c952085d4d666a36edd51858c90d0a"><div class="ttname"><a href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">GridVolumeT::grid</a></div><div class="ttdeci">const SimpleGrid &amp; grid(size_t n) const </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00991">grids.h:991</a></div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_a47d16fa950ad9fc76471617c176444a0"><div class="ttname"><a href="structThreadBlobsToVoxels.html#a47d16fa950ad9fc76471617c176444a0">ThreadBlobsToVoxels::min_separation</a></div><div class="ttdeci">int min_separation</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00064">blobs.h:64</a></div></div>
<div class="ttc" id="classGridVolumeT_html_a8273923cc41926a2c0a65ab8dd2eadff"><div class="ttname"><a href="classGridVolumeT.html#a8273923cc41926a2c0a65ab8dd2eadff">GridVolumeT::VolumesNo</a></div><div class="ttdeci">size_t VolumesNo() const </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l01016">grids.h:1016</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a32927ba57ddc0c409fd40fe79cad9982"><div class="ttname"><a href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a></div><div class="ttdeci">free((char *) ob)</div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_a3634025d0dab4211c460c83661f07f81"><div class="ttname"><a href="structThreadBlobsToVoxels.html#a3634025d0dab4211c460c83661f07f81">ThreadBlobsToVoxels::threads_num</a></div><div class="ttdeci">int threads_num</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00063">blobs.h:63</a></div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_a83b1894e4fe53a976912f92d9e224be0"><div class="ttname"><a href="structThreadBlobsToVoxels.html#a83b1894e4fe53a976912f92d9e224be0">ThreadBlobsToVoxels::thread_id</a></div><div class="ttdeci">int thread_id</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00062">blobs.h:62</a></div></div>
<div class="ttc" id="group__Macros_html_gac9ae6a207f10c821b06a8c0df153a7d5"><div class="ttname"><a href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a></div><div class="ttdeci">#define XMIPP_MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00181">xmipp_macros.h:181</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae6148da7d0bfbf264b8bcd89163b3b0f"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae6148da7d0bfbf264b8bcd89163b3b0f">memset</a></div><div class="ttdeci">memset(wksp+1, 0, n *sizeof(double))</div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_ab053912f5462bff57ded7d83120b6720"><div class="ttname"><a href="structThreadBlobsToVoxels.html#ab053912f5462bff57ded7d83120b6720">ThreadBlobsToVoxels::vol_blobs</a></div><div class="ttdeci">const MultidimArray&lt; double &gt; * vol_blobs</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00052">blobs.h:52</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_af10daae6ea83e674567d7a6757269f2c"><div class="ttname"><a href="structThreadBlobsToVoxels.html#af10daae6ea83e674567d7a6757269f2c">ThreadBlobsToVoxels::D</a></div><div class="ttdeci">const Matrix2D&lt; double &gt; * D</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00056">blobs.h:56</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; int &gt;</a></div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_ae331e2f5ce815286a2abba2bebff460f"><div class="ttname"><a href="structThreadBlobsToVoxels.html#ae331e2f5ce815286a2abba2bebff460f">ThreadBlobsToVoxels::vol_mask</a></div><div class="ttdeci">const MultidimArray&lt; double &gt; * vol_mask</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00059">blobs.h:59</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a3bbb23972a1285645ecf5f00d7b15b08"><div class="ttname"><a href="blobs_8cpp.html#a3bbb23972a1285645ecf5f00d7b15b08">slices_processed</a></div><div class="ttdeci">int slices_processed</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00038">blobs.cpp:38</a></div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_a96e79f27723347b78dfc93337f9684fe"><div class="ttname"><a href="structThreadBlobsToVoxels.html#a96e79f27723347b78dfc93337f9684fe">ThreadBlobsToVoxels::FORW</a></div><div class="ttdeci">bool FORW</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00060">blobs.h:60</a></div></div>
<div class="ttc" id="structblobtype_html_a292968bd7221739a3a58231353f0d0ec"><div class="ttname"><a href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">blobtype::radius</a></div><div class="ttdeci">double radius</div><div class="ttdoc">Spatial radius in Universal System units. </div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00116">blobs.h:116</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="structThreadBlobsToVoxels_html_a1164372307756843545e2ab15d801c4a"><div class="ttname"><a href="structThreadBlobsToVoxels.html#a1164372307756843545e2ab15d801c4a">ThreadBlobsToVoxels::vol_voxels</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * vol_voxels</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00055">blobs.h:55</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a5877cb192e2327f576e577778cb5bdd9"><div class="ttname"><a href="blobs_8cpp.html#a5877cb192e2327f576e577778cb5bdd9">blobs2voxels_SimpleGrid</a></div><div class="ttdeci">void * blobs2voxels_SimpleGrid(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00431">blobs.cpp:431</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gab81ecd64b721b04143708dc10aa4a4bb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void footprint_blob </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classImageOver.html">ImageOver</a> &amp;&#160;</td>
          <td class="paramname"><em>blobprint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structblobtype.html">blobtype</a> &amp;&#160;</td>
          <td class="paramname"><em>blob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>istep</em> = <code>50</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>normalise</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Footprint of a blob. In the actual implementation of the 3D reconstruction one of the most important things to save time is to have a precomputed blob projection. As it is spherically symmetrical all projections from different directions of the same blob happen to be the same. This function makes this precalculation storing it in an oversampled image. This is done so because the blob footprint might not be centered with respect to the universal grid needing so, the footprint at non-integer positions. As parameters to this function you may give the sampling rate in each direction, and an optional normalisation (usually disabled) at the end of the computation which divides the whole image by the sum of the whole image. \ Ex: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;ImageOver             blobprint;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;struct blobtype       blob;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;blob.radius = 1.7;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;blob.order  = 2;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;blob.alpha  = 3.6;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;footprint_blob(blobprint, blob);</div></div><!-- fragment --><p> As the blob radius is 1.7, the function will create a normalised footprint of logical corners (-2,-2) to (2,2) (in the universal coord. system) (this size is the minimum integer number of pixels which contain entirely the blob), with 50 samples each pixel. The real size of the footprint is (550)<a class="el" href="projection_8cpp.html#ab81d9253b246f09be9999505d515d517">x(550)</a>. </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l00397">397</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;{</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">// Resize output image and redefine the origin of it</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordtype">int</span> footmax = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(blob.<a class="code" href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">radius</a>);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    blobprint.<a class="code" href="classImageOver.html#a3d5afad8fa0d941a716e64a218b51d37">init</a>(-footmax, footmax, istep, -footmax, footmax, istep);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="comment">// Run for Imge class indexes</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(blobprint()); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= <a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(blobprint()); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(blobprint()); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt;= <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(blobprint()); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        {</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <span class="comment">// Compute oversampled index and blob value</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <span class="keywordtype">double</span> vi, ui;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <a class="code" href="xmipp__image__over_8h.html#aec248f641411eee7c13d5eaf800366e3">IMG2OVER</a>(blobprint, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, vi, ui);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <span class="keywordtype">double</span> r = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(vi * vi + ui * ui);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(blobprint, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__Blobs.html#ga0af420e41e9958b9c5b562c1df9a6b9e">blob_proj</a>(r, blob);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">// Adjust the footprint structure</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">if</span> (normalise)</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        blobprint() /= blobprint().sum();</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;}</div><div class="ttc" id="classImageOver_html_a3d5afad8fa0d941a716e64a218b51d37"><div class="ttname"><a href="classImageOver.html#a3d5afad8fa0d941a716e64a218b51d37">ImageOver::init</a></div><div class="ttdeci">void init(int _umin, int _umax, int _uistep, int _vmin, int _vmax, int _vistep, int _wmin=0, int _wmax=0, int _wistep=1)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__over_8cpp_source.html#l00033">xmipp_image_over.cpp:33</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00065">multidim_array.h:65</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="xmipp__image__over_8h_html_aec248f641411eee7c13d5eaf800366e3"><div class="ttname"><a href="xmipp__image__over_8h.html#aec248f641411eee7c13d5eaf800366e3">IMG2OVER</a></div><div class="ttdeci">#define IMG2OVER(IO, iv, iu, v, u)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__over_8h_source.html#l00234">xmipp_image_over.h:234</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00073">multidim_array.h:73</a></div></div>
<div class="ttc" id="group__Blobs_html_ga0af420e41e9958b9c5b562c1df9a6b9e"><div class="ttname"><a href="group__Blobs.html#ga0af420e41e9958b9c5b562c1df9a6b9e">blob_proj</a></div><div class="ttdeci">#define blob_proj(r, blob)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00162">blobs.h:162</a></div></div>
<div class="ttc" id="structblobtype_html_a292968bd7221739a3a58231353f0d0ec"><div class="ttname"><a href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">blobtype::radius</a></div><div class="ttdeci">double radius</div><div class="ttdoc">Spatial radius in Universal System units. </div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00116">blobs.h:116</a></div></div>
<div class="ttc" id="group__Images_html_gaad11fc7e221702e9f1adeb445ba5db9c"><div class="ttname"><a href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a></div><div class="ttdeci">#define IMGPIXEL(I, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00176">xmipp_image_base.h:176</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gab1c7e82811e94d7957dc0f8891a57cfa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double i_n </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Bessel function I_n (x), n = 0, 1, 2, ... Use ONLY for small values of n </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l00234">234</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;{</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">double</span> i_ns1, <a class="code" href="group__Blobs.html#gab1c7e82811e94d7957dc0f8891a57cfa">i_n</a>, i_np1;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> == 0)</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#af79423b2c41ae25087708dabd9722890">bessi0</a>(<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> == 1)</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#a0f5384a1781d8b6b6fb92837eeaea591">bessi1</a>(<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> == 0.0)</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">return</span> 0.0;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    i_ns1 = <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#af79423b2c41ae25087708dabd9722890">bessi0</a>(<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    i_n   = <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#a0f5384a1781d8b6b6fb92837eeaea591">bessi1</a>(<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">for</span> (i = 1; i &lt; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>; i++)</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        i_np1 = i_ns1 - (2 * <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) / <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> * i_n;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        i_ns1 = <a class="code" href="group__Blobs.html#gab1c7e82811e94d7957dc0f8891a57cfa">i_n</a>;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        i_n   = i_np1;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__Blobs.html#gab1c7e82811e94d7957dc0f8891a57cfa">i_n</a>;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;}</div><div class="ttc" id="cuda__gpu__reconstruct__fourier_8cpp_html_a0f5384a1781d8b6b6fb92837eeaea591"><div class="ttname"><a href="cuda__gpu__reconstruct__fourier_8cpp.html#a0f5384a1781d8b6b6fb92837eeaea591">bessi1</a></div><div class="ttdeci">__device__ float bessi1(float x)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gpu__reconstruct__fourier_8cpp_source.html#l00109">cuda_gpu_reconstruct_fourier.cpp:109</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="cuda__gpu__reconstruct__fourier_8cpp_html_af79423b2c41ae25087708dabd9722890"><div class="ttname"><a href="cuda__gpu__reconstruct__fourier_8cpp.html#af79423b2c41ae25087708dabd9722890">bessi0</a></div><div class="ttdeci">__device__ float bessi0(float x)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gpu__reconstruct__fourier_8cpp_source.html#l00086">cuda_gpu_reconstruct_fourier.cpp:86</a></div></div>
<div class="ttc" id="group__Blobs_html_gab1c7e82811e94d7957dc0f8891a57cfa"><div class="ttname"><a href="group__Blobs.html#gab1c7e82811e94d7957dc0f8891a57cfa">i_n</a></div><div class="ttdeci">double i_n(int n, double x)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00234">blobs.cpp:234</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga1c16f98dae81ec5758de5d1de321e4a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double i_nph </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Bessel function I_(n+1/2) (x), n = 0, 1, 2, ... </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l00258">258</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;{</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordtype">double</span> r2dpix;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordtype">double</span> i_ns1, <a class="code" href="group__Blobs.html#gab1c7e82811e94d7957dc0f8891a57cfa">i_n</a>, i_np1;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> == 0.0)</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">return</span> 0.0;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    r2dpix = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(2.0 / (<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>));</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    i_ns1 = r2dpix * cosh(<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    i_n   = r2dpix * sinh(<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">for</span> (i = 1; i &lt;= <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>; i++)</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    {</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        i_np1 = i_ns1 - (2 * i - 1) / <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> * i_n;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        i_ns1 = <a class="code" href="group__Blobs.html#gab1c7e82811e94d7957dc0f8891a57cfa">i_n</a>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        i_n   = i_np1;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__Blobs.html#gab1c7e82811e94d7957dc0f8891a57cfa">i_n</a>;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div><div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Blobs_html_gab1c7e82811e94d7957dc0f8891a57cfa"><div class="ttname"><a href="group__Blobs.html#gab1c7e82811e94d7957dc0f8891a57cfa">i_n</a></div><div class="ttdeci">double i_n(int n, double x)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00234">blobs.cpp:234</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga9ca9464825734b841e8fe3b688d4210b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double in_zeroarg </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Limit (z-&gt;0) of (1/z)^n I_n(z) (needed by basvolume) </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l00280">280</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;{</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8h.html#a24e9480e03f551bf5d5a62b2011f8236">fact</a>;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    fact = 1.0;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">for</span> (i = 1; i &lt;= <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>; i++)</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        fact *= 0.5 / <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="numerical__recipes_8h.html#a24e9480e03f551bf5d5a62b2011f8236">fact</a>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;}</div><div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8h_html_a24e9480e03f551bf5d5a62b2011f8236"><div class="ttname"><a href="numerical__recipes_8h.html#a24e9480e03f551bf5d5a62b2011f8236">fact</a></div><div class="ttdeci">size_t fact(int num)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8h_source.html#l00090">numerical_recipes.h:90</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga5535ae1ec6293ae20ff93667838ab722"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double inph_zeroarg </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Limit (z-&gt;0) of (1/z)^(n+1/2) I_(n+1/2) (z) (needed by basvolume) </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l00293">293</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;{</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8h.html#a24e9480e03f551bf5d5a62b2011f8236">fact</a>;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    fact = 1.0;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">for</span> (i = 1; i &lt;= <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>; i++)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    {</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        fact *= 1.0 / (2 * i + 1.0);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">return</span> fact*<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(2.0 / <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;}</div><div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="numerical__recipes_8h_html_a24e9480e03f551bf5d5a62b2011f8236"><div class="ttname"><a href="numerical__recipes_8h.html#a24e9480e03f551bf5d5a62b2011f8236">fact</a></div><div class="ttdeci">size_t fact(int num)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8h_source.html#l00090">numerical_recipes.h:90</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gad2a185cd88a0d1a7e22ccbaa01624751"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double kaiser_Fourier_value </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function actually computing the blob Fourier transform. </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l00141">141</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;{</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> != 2 &amp;&amp; <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> !=0)</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a>, <span class="stringliteral">&quot;m out of range in kaiser_Fourier_value()&quot;</span>);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordtype">double</span> sigma = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(alpha * alpha - (2. * <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a> * <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>) * (2. * <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a> * w)));</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> == 2)</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">if</span> (2.*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>*<a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>*w &gt; alpha)</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <span class="keywordflow">return</span>  pow(2.*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>, 3. / 2.)*pow(<a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, 3.)*pow(alpha, 2.)*<a class="code" href="numerical__recipes_8cpp.html#a6f74634d72716ff35d074baa35719dc8">bessj3_5</a>(sigma)</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                    / (<a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#af79423b2c41ae25087708dabd9722890">bessi0</a>(alpha)*pow(sigma, 3.5));</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keywordflow">return</span>  pow(2.*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>, 3. / 2.)*pow(<a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, 3.)*pow(alpha, 2.)*<a class="code" href="numerical__recipes_8cpp.html#a8c05f66d04870be6e184c0b3f5c41f58">bessi3_5</a>(sigma)</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                    / (<a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#af79423b2c41ae25087708dabd9722890">bessi0</a>(alpha)*pow(sigma, 3.5));</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> == 0)</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    {</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">if</span> (2*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>*<a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>*w &gt; alpha)</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <span class="keywordflow">return</span>  pow(2.*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>, 3. / 2.)*pow(<a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, 3)*<a class="code" href="numerical__recipes_8cpp.html#a5db46314a9556f2a97ca45bda70f7e02">bessj1_5</a>(sigma)</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                    / (<a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#af79423b2c41ae25087708dabd9722890">bessi0</a>(alpha)*pow(sigma, 1.5));</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="keywordflow">return</span>  pow(2.*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>, 3. / 2.)*pow(<a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, 3)*<a class="code" href="numerical__recipes_8cpp.html#a378247a74c2225e7df95d64595c69be0">bessi1_5</a>(sigma)</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                    / (<a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#af79423b2c41ae25087708dabd9722890">bessi0</a>(alpha)*pow(sigma, 1.5));</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa99ae519fb00e32cc6e716cc01d21cadf">ERR_ARG_INCORRECT</a>,<span class="stringliteral">&quot;Invalid blob order&quot;</span>);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a2b83edee7677c7a2b0a4e5ac99baa586"><div class="ttname"><a href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a></div><div class="ttdeci">doublereal * w</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02494">numerical_recipes.cpp:2494</a></div></div>
<div class="ttc" id="cuda__gpu__reconstruct__fourier_8cpp_html_af79423b2c41ae25087708dabd9722890"><div class="ttname"><a href="cuda__gpu__reconstruct__fourier_8cpp.html#af79423b2c41ae25087708dabd9722890">bessi0</a></div><div class="ttdeci">__device__ float bessi0(float x)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gpu__reconstruct__fourier_8cpp_source.html#l00086">cuda_gpu_reconstruct_fourier.cpp:86</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a378247a74c2225e7df95d64595c69be0"><div class="ttname"><a href="numerical__recipes_8cpp.html#a378247a74c2225e7df95d64595c69be0">bessi1_5</a></div><div class="ttdeci">double bessi1_5(double x)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l00549">numerical_recipes.cpp:549</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa99ae519fb00e32cc6e716cc01d21cadf"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa99ae519fb00e32cc6e716cc01d21cadf">ERR_ARG_INCORRECT</a></div><div class="ttdoc">Incorrect argument received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00118">xmipp_error.h:118</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a5db46314a9556f2a97ca45bda70f7e02"><div class="ttname"><a href="numerical__recipes_8cpp.html#a5db46314a9556f2a97ca45bda70f7e02">bessj1_5</a></div><div class="ttdeci">double bessj1_5(double x)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l00573">numerical_recipes.cpp:573</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a438c75002165fed58970c95d67a268c1"><div class="ttname"><a href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a></div><div class="ttdeci">int m</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a6f74634d72716ff35d074baa35719dc8"><div class="ttname"><a href="numerical__recipes_8cpp.html#a6f74634d72716ff35d074baa35719dc8">bessj3_5</a></div><div class="ttdeci">double bessj3_5(double x)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l00579">numerical_recipes.cpp:579</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a8c05f66d04870be6e184c0b3f5c41f58"><div class="ttname"><a href="numerical__recipes_8cpp.html#a8c05f66d04870be6e184c0b3f5c41f58">bessi3_5</a></div><div class="ttdeci">double bessi3_5(double x)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l00565">numerical_recipes.cpp:565</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a></div><div class="ttdoc">Incorrect value received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00200">xmipp_error.h:200</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af2a333b1670df64a88d3a2f22210d155"><div class="ttname"><a href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a></div><div class="ttdeci">doublereal * a</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gae3586255797a1a110ba99268a050ccef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double kaiser_proj </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function actually computing the blob projection. </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l00095">95</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;{</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordtype">double</span> sda, sdas, <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>, arg, p;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    sda = s / <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    sdas = sda * sda;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    w = 1.0 - sdas;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">if</span> (w &gt; 1.0e-10)</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    {</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        arg = alpha * <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(w);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> == 0)</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordflow">if</span> (alpha == 0.0)</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                p = 2.0 * <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a> * <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(w);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                p = (2.0 * <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a> / alpha) * sinh(arg) / <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#af79423b2c41ae25087708dabd9722890">bessi0</a>(alpha);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        }</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> == 1)</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keywordflow">if</span> (alpha == 0.0)</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                p = 2.0 * <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a> * w * <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(w) * (2.0 / 3.0);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                p = (2.0 * <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a> / alpha) * <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(w) * (cosh(arg) - sinh(arg) / arg)</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                    / <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#a0f5384a1781d8b6b6fb92837eeaea591">bessi1</a>(alpha);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        }</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> == 2)</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keywordflow">if</span> (alpha == 0.0)</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                p = 2.0 * <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a> * w * w * <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(w) * (8.0 / 15.0);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                p = (2.0 * <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a> / alpha) * w *</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                    ((3.0 / (arg * arg) + 1.0) * sinh(arg) - (3.0 / arg) * cosh(arg)) / <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#a51bd532ff2569d437668cf284a0c42c9">bessi2</a>(alpha);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a>, <span class="stringliteral">&quot;m out of range in kaiser_proj()&quot;</span>);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        p = 0.0;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">return</span> p;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;}</div><div class="ttc" id="cuda__gpu__reconstruct__fourier_8cpp_html_a0f5384a1781d8b6b6fb92837eeaea591"><div class="ttname"><a href="cuda__gpu__reconstruct__fourier_8cpp.html#a0f5384a1781d8b6b6fb92837eeaea591">bessi1</a></div><div class="ttdeci">__device__ float bessi1(float x)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gpu__reconstruct__fourier_8cpp_source.html#l00109">cuda_gpu_reconstruct_fourier.cpp:109</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a2b83edee7677c7a2b0a4e5ac99baa586"><div class="ttname"><a href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a></div><div class="ttdeci">doublereal * w</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02494">numerical_recipes.cpp:2494</a></div></div>
<div class="ttc" id="cuda__gpu__reconstruct__fourier_8cpp_html_af79423b2c41ae25087708dabd9722890"><div class="ttname"><a href="cuda__gpu__reconstruct__fourier_8cpp.html#af79423b2c41ae25087708dabd9722890">bessi0</a></div><div class="ttdeci">__device__ float bessi0(float x)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gpu__reconstruct__fourier_8cpp_source.html#l00086">cuda_gpu_reconstruct_fourier.cpp:86</a></div></div>
<div class="ttc" id="cuda__gpu__reconstruct__fourier_8cpp_html_a51bd532ff2569d437668cf284a0c42c9"><div class="ttname"><a href="cuda__gpu__reconstruct__fourier_8cpp.html#a51bd532ff2569d437668cf284a0c42c9">bessi2</a></div><div class="ttdeci">__device__ float bessi2(float x)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gpu__reconstruct__fourier_8cpp_source.html#l00133">cuda_gpu_reconstruct_fourier.cpp:133</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a438c75002165fed58970c95d67a268c1"><div class="ttname"><a href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a></div><div class="ttdeci">int m</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a></div><div class="ttdoc">Incorrect value received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00200">xmipp_error.h:200</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af2a333b1670df64a88d3a2f22210d155"><div class="ttname"><a href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a></div><div class="ttdeci">doublereal * a</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga1d25336dea0e85d705d18ebdb27f018a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double kaiser_value </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function actually computing the blob value. </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l00041">41</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;{</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordtype">double</span> rda, rdas, arg, <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    rda = r / <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">if</span> (rda &lt;= 1.0)</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    {</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        rdas = rda * rda;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        arg = alpha * <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(1.0 - rdas);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> == 0)</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        {</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            w = <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#af79423b2c41ae25087708dabd9722890">bessi0</a>(arg) / <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#af79423b2c41ae25087708dabd9722890">bessi0</a>(alpha);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        }</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> == 1)</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        {</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            w = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a> (1.0 - rdas);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            <span class="keywordflow">if</span> (alpha != 0.0)</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                w *= <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#a0f5384a1781d8b6b6fb92837eeaea591">bessi1</a>(arg) / <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#a0f5384a1781d8b6b6fb92837eeaea591">bessi1</a>(alpha);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        }</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> == 2)</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        {</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            w = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a> (1.0 - rdas);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            w = w * <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <span class="keywordflow">if</span> (alpha != 0.0)</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                w *= <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#a51bd532ff2569d437668cf284a0c42c9">bessi2</a>(arg) / <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#a51bd532ff2569d437668cf284a0c42c9">bessi2</a>(alpha);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        }</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> == 3)</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        {</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            w = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a> (1.0 - rdas);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            w = w * w * <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordflow">if</span> (alpha != 0.0)</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                w *= <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#ae069da24861bf05ed2644e63d0520ecb">bessi3</a>(arg) / <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#ae069da24861bf05ed2644e63d0520ecb">bessi3</a>(alpha);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        }</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> == 4)</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        {</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            w = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a> (1.0 - rdas);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            w = w * w * w *<a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <span class="keywordflow">if</span> (alpha != 0.0)</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                w *= <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#aad2afc59fbf2f4b7d5c722ea5faf592e">bessi4</a>(arg) / <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#aad2afc59fbf2f4b7d5c722ea5faf592e">bessi4</a>(alpha);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a>, <span class="stringliteral">&quot;m out of range in kaiser_value()&quot;</span>);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    }</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        w = 0.0;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;}</div><div class="ttc" id="cuda__gpu__reconstruct__fourier_8cpp_html_a0f5384a1781d8b6b6fb92837eeaea591"><div class="ttname"><a href="cuda__gpu__reconstruct__fourier_8cpp.html#a0f5384a1781d8b6b6fb92837eeaea591">bessi1</a></div><div class="ttdeci">__device__ float bessi1(float x)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gpu__reconstruct__fourier_8cpp_source.html#l00109">cuda_gpu_reconstruct_fourier.cpp:109</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="cuda__gpu__reconstruct__fourier_8cpp_html_aad2afc59fbf2f4b7d5c722ea5faf592e"><div class="ttname"><a href="cuda__gpu__reconstruct__fourier_8cpp.html#aad2afc59fbf2f4b7d5c722ea5faf592e">bessi4</a></div><div class="ttdeci">__device__ float bessi4(float x)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gpu__reconstruct__fourier_8cpp_source.html#l00145">cuda_gpu_reconstruct_fourier.cpp:145</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a2b83edee7677c7a2b0a4e5ac99baa586"><div class="ttname"><a href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a></div><div class="ttdeci">doublereal * w</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02494">numerical_recipes.cpp:2494</a></div></div>
<div class="ttc" id="cuda__gpu__reconstruct__fourier_8cpp_html_af79423b2c41ae25087708dabd9722890"><div class="ttname"><a href="cuda__gpu__reconstruct__fourier_8cpp.html#af79423b2c41ae25087708dabd9722890">bessi0</a></div><div class="ttdeci">__device__ float bessi0(float x)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gpu__reconstruct__fourier_8cpp_source.html#l00086">cuda_gpu_reconstruct_fourier.cpp:86</a></div></div>
<div class="ttc" id="cuda__gpu__reconstruct__fourier_8cpp_html_ae069da24861bf05ed2644e63d0520ecb"><div class="ttname"><a href="cuda__gpu__reconstruct__fourier_8cpp.html#ae069da24861bf05ed2644e63d0520ecb">bessi3</a></div><div class="ttdeci">__device__ float bessi3(float x)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gpu__reconstruct__fourier_8cpp_source.html#l00139">cuda_gpu_reconstruct_fourier.cpp:139</a></div></div>
<div class="ttc" id="cuda__gpu__reconstruct__fourier_8cpp_html_a51bd532ff2569d437668cf284a0c42c9"><div class="ttname"><a href="cuda__gpu__reconstruct__fourier_8cpp.html#a51bd532ff2569d437668cf284a0c42c9">bessi2</a></div><div class="ttdeci">__device__ float bessi2(float x)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gpu__reconstruct__fourier_8cpp_source.html#l00133">cuda_gpu_reconstruct_fourier.cpp:133</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a438c75002165fed58970c95d67a268c1"><div class="ttname"><a href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a></div><div class="ttdeci">int m</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a></div><div class="ttdoc">Incorrect value received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00200">xmipp_error.h:200</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af2a333b1670df64a88d3a2f22210d155"><div class="ttname"><a href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a></div><div class="ttdeci">doublereal * a</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga8e29cec73aae5e98ae56cdfe566b8493"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double optimal_BCC_grid_relative_size </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structblobtype.html">blobtype</a>&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Optimal BCC grid spastd::cing. This function returns the optimal grid relative size for the blob selected. </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l00338">338</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;{</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(8.0) / (2*<a class="code" href="group__Blobs.html#ga87a45c6b1e8619e08888ab103c1fd7f9">blob_freq_zero</a>(b));</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;}</div><div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="group__Blobs_html_ga87a45c6b1e8619e08888ab103c1fd7f9"><div class="ttname"><a href="group__Blobs.html#ga87a45c6b1e8619e08888ab103c1fd7f9">blob_freq_zero</a></div><div class="ttdeci">double blob_freq_zero(struct blobtype b)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00316">blobs.cpp:316</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga65b6f10264ad108020eab832bc54e483"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double optimal_CC_grid_relative_size </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structblobtype.html">blobtype</a>&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Optimal CC grid spastd::cing. This function returns the optimal grid relative size for the blob selected. </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l00334">334</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;{</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">return</span> 1 / <a class="code" href="group__Blobs.html#ga87a45c6b1e8619e08888ab103c1fd7f9">blob_freq_zero</a>(b);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;}</div><div class="ttc" id="group__Blobs_html_ga87a45c6b1e8619e08888ab103c1fd7f9"><div class="ttname"><a href="group__Blobs.html#ga87a45c6b1e8619e08888ab103c1fd7f9">blob_freq_zero</a></div><div class="ttdeci">double blob_freq_zero(struct blobtype b)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00316">blobs.cpp:316</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga7316736d9a542f44eb2d81dc33e909aa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double optimal_FCC_grid_relative_size </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structblobtype.html">blobtype</a>&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Optimal FCC grid spastd::cing. This function returns the optimal grid relative size for the blob selected. </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l00342">342</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;{</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(27.0) / (4*<a class="code" href="group__Blobs.html#ga87a45c6b1e8619e08888ab103c1fd7f9">blob_freq_zero</a>(b));</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;}</div><div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="group__Blobs_html_ga87a45c6b1e8619e08888ab103c1fd7f9"><div class="ttname"><a href="group__Blobs.html#ga87a45c6b1e8619e08888ab103c1fd7f9">blob_freq_zero</a></div><div class="ttdeci">double blob_freq_zero(struct blobtype b)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00316">blobs.cpp:316</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gade32964792892a00478421dcdba274bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double sum_blob_Grid </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structblobtype.html">blobtype</a> &amp;&#160;</td>
          <td class="paramname"><em>blob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classGrid.html">Grid</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>D</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sum of a single blob over a grid. As a normalisation factor, the sum of the blob values over a given grid is needed. What this function does is put a blob at coordinate (0,0,0) and sums all the blob values at points of the grid which are inside the blob. It doesn't matter if the grid is compound or not. \ Ex: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// Blob definition</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;struct blobtype       blob;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;blob.radius = 2;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;blob.order  = 2;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;blob.alpha  = 3.6;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;// Grid definition</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;Grid BCCgrid;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;BCCgrid=BCC_grid(1.41,vectorR3(-5,-5,-5),vector_R3( 5, 5, 5));</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;std::cout &lt;&lt; &quot;The sum of a single blob over the grid is &quot; &lt;&lt;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;     &lt;&lt; sum_blob_grid(blob, BCCgrid);</div></div><!-- fragment --><p>D is a 3x3 matrix specifying a volume deformation. It means that the sample at logical position (i,j,k) is really placed at space position D*(i,j,k)'. </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l00306">306</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;{</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordtype">double</span> sum = 0;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; grid.<a class="code" href="classGrid.html#a99ffd374eb347fafe5938b01d6815759">GridsNo</a>(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        sum += <a class="code" href="blobs_8cpp.html#aa6dbf40fd16382053440e68bb02caf7d">sum_blob_SimpleGrid</a>(blob, grid(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>), D);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">return</span> sum;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div><div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classGrid_html_a99ffd374eb347fafe5938b01d6815759"><div class="ttname"><a href="classGrid.html#a99ffd374eb347fafe5938b01d6815759">Grid::GridsNo</a></div><div class="ttdeci">size_t GridsNo() const </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00544">grids.h:544</a></div></div>
<div class="ttc" id="blobs_8cpp_html_aa6dbf40fd16382053440e68bb02caf7d"><div class="ttname"><a href="blobs_8cpp.html#aa6dbf40fd16382053440e68bb02caf7d">sum_blob_SimpleGrid</a></div><div class="ttdeci">double sum_blob_SimpleGrid(const struct blobtype &amp;blob, const SimpleGrid &amp;grid, const Matrix2D&lt; double &gt; *D)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l00172">blobs.cpp:172</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga8947e150817ff61eebf5187a73985610"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void voxel_volume_shape </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__Grids.html#gae3eeb15b316a9800a7c35372dfd57460">GridVolume</a> &amp;&#160;</td>
          <td class="paramname"><em>vol_blobs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structblobtype.html">blobtype</a> &amp;&#160;</td>
          <td class="paramname"><em>blob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>corner1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Voxel shape for a blob volume. Given a blob volume this function returns the logical origin and size for the minimum voxel volume which holds it. See <a class="el" href="group__Blobs.html#ga769d35289332d6806a6358b748ecc0a9">blobs2voxels</a> for an explanation of the limit and V parameters. </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l00833">833</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;{</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a>  Gcorner1(3),  Gcorner2(3);     <span class="comment">// lowest and highest coord.</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    corner1.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(3);</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    size.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(3);</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="comment">// Look for the lowest and highest volume coordinate</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    vol_blobs.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>().voxel_corners(Gcorner1, Gcorner2, D);</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="comment">// Add blob radius in each direction, and find the furthest integer</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="comment">// samples =&gt; compute size</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    Gcorner1 -= blob.<a class="code" href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">radius</a>;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    Gcorner1.selfCEIL();</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    Gcorner2 += blob.<a class="code" href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">radius</a>;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    Gcorner2.selfFLOOR();</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(size) = (int)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(Gcorner2) - (int)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(Gcorner1) + 1;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(size) = (int)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(Gcorner2) - (int)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(Gcorner1) + 1;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(size) = (int)<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(Gcorner2) - (int)<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(Gcorner1) + 1;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Gcorner1  &quot;</span> &lt;&lt; Gcorner1.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Gcorner2  &quot;</span> &lt;&lt; Gcorner2.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Size of voxel volume &quot;</span> &lt;&lt; (int)<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(size) &lt;&lt; <span class="stringliteral">&quot; x &quot;</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    &lt;&lt; (int)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(size) &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; (int)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(size) &lt;&lt; std::endl;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="preprocessor">#ifdef NEVER_DEFINED</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="comment">// In principle this limitation has been substituted by a direct</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="comment">// specification of the output volume size, and should no longer</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="comment">// be valid. However it is a beautiful piece of code to be removed</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="comment">// already</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordflow">if</span> (limit != 0 &amp;&amp; <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(size) != limit)</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    {</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <span class="keywordtype">double</span> diff = ((double)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(size) - (double)limit) / 2;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        <span class="keywordflow">if</span> (diff == (<span class="keywordtype">int</span>)diff)</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        {</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            Gcorner1 += diff;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            Gcorner2 -= diff;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        }</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        {</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            Gcorner1 += (diff - 0.5);</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            Gcorner2 -= (diff + 0.5);</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        }</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(size) = (int)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(Gcorner2) - (int)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(Gcorner1) + 1;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(size) = (int)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(Gcorner2) - (int)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(Gcorner1) + 1;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(size) = (int)<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(Gcorner2) - (int)<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(Gcorner1) + 1;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Limiting to &quot;</span> &lt;&lt; limit &lt;&lt; <span class="stringliteral">&quot; diff = &quot;</span> &lt;&lt; diff &lt;&lt; std::endl;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;New Gcorner1  &quot;</span> &lt;&lt; Gcorner1.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;New Gcorner2  &quot;</span> &lt;&lt; Gcorner2.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    }</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <a class="code" href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a>(Gcorner1, corner1);</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Final size of voxel volume &quot;</span> &lt;&lt; (int)<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(size) &lt;&lt; <span class="stringliteral">&quot; x &quot;</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    &lt;&lt; (int)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(size) &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; (int)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(size) &lt;&lt; std::endl;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Corner1= &quot;</span> &lt;&lt; corner1.<a class="code" href="classMatrix1D.html#a8849e36416cde2a57914953a815d4b43">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;}</div><div class="ttc" id="classMatrix1D_html_a8849e36416cde2a57914953a815d4b43"><div class="ttname"><a href="classMatrix1D.html#a8849e36416cde2a57914953a815d4b43">Matrix1D::transpose</a></div><div class="ttdeci">Matrix1D&lt; T &gt; transpose() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01466">matrix1d.h:1466</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="classGridVolumeT_html_a15c952085d4d666a36edd51858c90d0a"><div class="ttname"><a href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">GridVolumeT::grid</a></div><div class="ttdeci">const SimpleGrid &amp; grid(size_t n) const </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00991">grids.h:991</a></div></div>
<div class="ttc" id="classMatrix1D_html_a79a482948ae334cbefaef7c7839cd934"><div class="ttname"><a href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">Matrix1D::resize</a></div><div class="ttdeci">void resize(size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00451">matrix1d.h:451</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_gaf36b657319bb585c75cfa14744dab275"><div class="ttname"><a href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a></div><div class="ttdeci">void typeCast(const Matrix1D&lt; T1 &gt; &amp;v1, Matrix1D&lt; T2 &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01904">matrix1d.h:1904</a></div></div>
<div class="ttc" id="structblobtype_html_a292968bd7221739a3a58231353f0d0ec"><div class="ttname"><a href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">blobtype::radius</a></div><div class="ttdeci">double radius</div><div class="ttdoc">Spatial radius in Universal System units. </div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00116">blobs.h:116</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaae235a7c2de134c88fe477b9d98149d4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void voxels2blobs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>vol_voxels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structblobtype.html">blobtype</a> &amp;&#160;</td>
          <td class="paramname"><em>blob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__Grids.html#gae3eeb15b316a9800a7c35372dfd57460">GridVolume</a> &amp;&#160;</td>
          <td class="paramname"><em>vol_blobs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>grid_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>grid_relative_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>vol_mask</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>D</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>final_error_change</em> = <code>0.01</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tell</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>R</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>threads</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Voxels &mdash;&gt; Blobs. The voxels to blobs procedure is an iterative process resolved by ART as an iterative technique to solve an equation system. The blobs to voxels process is the BASIC way to solve this problem. This applies the whole ART process. You can set a debugging level by setting the flag SHOW_CONVERSION in the tell argument.</p>
<p>If the mask is NULL then it is assumed that all voxels in the input voxel volume must be adjusted by the blobs. If the input voxel volume is NULL the it is assumed that it is equal to 0 and only those corresponding to the 1 positions within the mask must be adjusted.</p>
<p>R is the interest radius. If it is -1 two superimposed grids are created, otherwise a single grid with tilted axis is.</p>
<p>Valid grid types are defined in Some useful grids </p>

<p>Definition at line <a class="el" href="blobs_8cpp_source.html#l01298">1298</a> of file <a class="el" href="blobs_8cpp_source.html">blobs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;{</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <a class="code" href="classImage.html">Image&lt;double&gt;</a> theo_vol, corr_vol;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keywordtype">double</span> mean_error, mean_error_1, max_error;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="keywordtype">int</span> it = 1;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    tell = <a class="code" href="group__Blobs.html#gad1f8107fe2e79dd5a210df9509ab6055">SHOW_CONVERSION</a>;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="comment">// Resize output volume .................................................</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <a class="code" href="classGrid.html">Grid</a> grid_blobs;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="keywordflow">if</span> (R == -1)</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    {</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> corner1(3), corner2(3);</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1) = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(*vol_voxels);</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1) = <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(*vol_voxels);</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner1) = <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(*vol_voxels);</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2) = <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(*vol_voxels);</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2) = <a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(*vol_voxels);</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner2) = <a class="code" href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(*vol_voxels);</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        <span class="keywordflow">switch</span> (grid_type)</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        {</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group__Grids.html#ga78d126676907aa89a0adbfbef8282585">CC</a>):</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                        grid_blobs = <a class="code" href="group__Grids.html#ga0e4e33df423a3d7f415e4de84cd8ebf8">Create_CC_grid</a>(grid_relative_size, corner1, corner2);</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group__Grids.html#ga0de7dbedeae567025be0323d8f278528">FCC</a>):</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                        grid_blobs = <a class="code" href="group__Grids.html#ga6aa76a2e4586c723594ad9170776d83a">Create_FCC_grid</a>(grid_relative_size, corner1, corner2);</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group__Grids.html#ga9f9b5c3908c35064e11e3d4fb15cb434">BCC</a>):</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                        grid_blobs = <a class="code" href="group__Grids.html#gabcee3c16466dd4ce63338d369dc90cbb">Create_BCC_grid</a>(grid_relative_size, corner1, corner2);</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        }</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    }</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;{</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        <span class="keywordflow">switch</span> (grid_type)</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        {</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group__Grids.html#ga78d126676907aa89a0adbfbef8282585">CC</a>):</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                        grid_blobs = <a class="code" href="group__Grids.html#ga0e4e33df423a3d7f415e4de84cd8ebf8">Create_CC_grid</a>(grid_relative_size, R);</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group__Grids.html#ga0de7dbedeae567025be0323d8f278528">FCC</a>):</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                        grid_blobs = <a class="code" href="group__Grids.html#ga6aa76a2e4586c723594ad9170776d83a">Create_FCC_grid</a>(grid_relative_size, R);</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group__Grids.html#ga9f9b5c3908c35064e11e3d4fb15cb434">BCC</a>):</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                        grid_blobs = <a class="code" href="group__Grids.html#gabcee3c16466dd4ce63338d369dc90cbb">Create_BCC_grid</a>(grid_relative_size, R);</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        }</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    }</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    vol_blobs.<a class="code" href="classGridVolumeT.html#a6b8c21b3a6a62cdefcae5540b61401d7">adapt_to_grid</a>(grid_blobs);</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <span class="comment">// Convert ..............................................................</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Converting voxel volume to blobs\n&quot;</span>;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <a class="code" href="group__Blobs.html#ga94823f436a57fc7e534e04d1829f47a5">ART_voxels2blobs_single_step</a>(vol_blobs, &amp;vol_blobs, blob, D, <a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>,</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                                 &amp;(theo_vol()), vol_voxels,</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                                 &amp;(corr_vol()), vol_mask, mean_error_1, max_error, <a class="code" href="group__Blobs.html#gae1a62943287cc2f243753d3a9d0dcd9d">VARTK</a>, threads);</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="keywordflow">if</span> (tell &amp;&amp; <a class="code" href="group__Blobs.html#gad1f8107fe2e79dd5a210df9509ab6055">SHOW_CONVERSION</a>)</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;   Finished iteration: &quot;</span> &lt;&lt; it++</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; Mean Error= &quot;</span> &lt;&lt; mean_error_1</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; Max_Error= &quot;</span> &lt;&lt; max_error</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        &lt;&lt; std::endl;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;0%&quot;</span>;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    std::cout.flush();</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    theo_vol.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;PPPtheo.vol&quot;</span>);</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    corr_vol.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;PPPcorr.vol&quot;</span>);</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Press any key\n&quot;</span>;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="keywordtype">char</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    std::cin &gt;&gt; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <span class="keywordtype">double</span> change;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <span class="keywordtype">bool</span> end_condition;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="keywordflow">do</span></div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;{</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        <a class="code" href="group__Blobs.html#ga94823f436a57fc7e534e04d1829f47a5">ART_voxels2blobs_single_step</a>(vol_blobs, &amp;vol_blobs, blob, D, <a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>,</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                                     &amp;(theo_vol()), vol_voxels,</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                                     &amp;(corr_vol()), vol_mask, mean_error, max_error, <a class="code" href="group__Blobs.html#gae1a62943287cc2f243753d3a9d0dcd9d">VARTK</a>);</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        theo_vol.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;PPPtheo.vol&quot;</span>);</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        corr_vol.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;PPPcorr.vol&quot;</span>);</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Press any key\n&quot;</span>;</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        <span class="keywordtype">char</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        std::cin &gt;&gt; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        change = <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(mean_error - mean_error_1) / mean_error_1;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        mean_error_1 = mean_error;</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        <span class="keywordflow">if</span> (tell &amp;&amp; <a class="code" href="group__Blobs.html#gad1f8107fe2e79dd5a210df9509ab6055">SHOW_CONVERSION</a>)</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;   Finished iteration: &quot;</span> &lt;&lt; it++</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; Mean Error= &quot;</span> &lt;&lt; mean_error</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; Max_Error= &quot;</span> &lt;&lt; max_error</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            &lt;&lt; std::endl;</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;        {</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;            printf(<span class="stringliteral">&quot;\r&quot;</span>);</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;            std::cout &lt;&lt; 100 - change &lt;&lt; <span class="stringliteral">&quot;%&quot;</span>;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;        }</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;        std::cout.flush();</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;        end_condition = change &lt;= final_error_change;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    }</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="keywordflow">while</span> (!end_condition);</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__Grids_html_ga0e4e33df423a3d7f415e4de84cd8ebf8"><div class="ttname"><a href="group__Grids.html#ga0e4e33df423a3d7f415e4de84cd8ebf8">Create_CC_grid</a></div><div class="ttdeci">SimpleGrid Create_CC_grid(double relative_size, const Matrix1D&lt; double &gt; &amp;corner1, const Matrix1D&lt; double &gt; &amp;corner2, const Matrix1D&lt; double &gt; &amp;origin)</div><div class="ttdef"><b>Definition:</b> <a href="grids_8cpp_source.html#l00218">grids.cpp:218</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga706d2ce724d393d4d759a46225bbc6c1"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a></div><div class="ttdeci">#define FINISHINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00081">multidim_array.h:81</a></div></div>
<div class="ttc" id="group__Blobs_html_ga94823f436a57fc7e534e04d1829f47a5"><div class="ttname"><a href="group__Blobs.html#ga94823f436a57fc7e534e04d1829f47a5">ART_voxels2blobs_single_step</a></div><div class="ttdeci">void ART_voxels2blobs_single_step(GridVolume &amp;vol_in, GridVolume *vol_out, const struct blobtype &amp;blob, const Matrix2D&lt; double &gt; *D, double lambda, MultidimArray&lt; double &gt; *theo_vol, const MultidimArray&lt; double &gt; *read_vol, MultidimArray&lt; double &gt; *corr_vol, const MultidimArray&lt; double &gt; *mask_vol, double &amp;mean_error, double &amp;max_error, int eq_mode, int threads)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l01074">blobs.cpp:1074</a></div></div>
<div class="ttc" id="classImageBase_html_ae81a8c11a832924c2bda0909882c3168"><div class="ttname"><a href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">ImageBase::write</a></div><div class="ttdeci">void write(const FileName &amp;name=&quot;&quot;, size_t select_img=ALL_IMAGES, bool isStack=false, int mode=WRITE_OVERWRITE, CastWriteMode castMode=CW_CAST, int _swapWrite=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00210">xmipp_image_base.cpp:210</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00065">multidim_array.h:65</a></div></div>
<div class="ttc" id="classGrid_html"><div class="ttname"><a href="classGrid.html">Grid</a></div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00487">grids.h:487</a></div></div>
<div class="ttc" id="group__Grids_html_ga78d126676907aa89a0adbfbef8282585"><div class="ttname"><a href="group__Grids.html#ga78d126676907aa89a0adbfbef8282585">CC</a></div><div class="ttdeci">#define CC</div><div class="ttdoc">CC identifier. </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00602">grids.h:602</a></div></div>
<div class="ttc" id="group__Blobs_html_gae1a62943287cc2f243753d3a9d0dcd9d"><div class="ttname"><a href="group__Blobs.html#gae1a62943287cc2f243753d3a9d0dcd9d">VARTK</a></div><div class="ttdeci">#define VARTK</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00379">blobs.h:379</a></div></div>
<div class="ttc" id="group__Grids_html_ga9f9b5c3908c35064e11e3d4fb15cb434"><div class="ttname"><a href="group__Grids.html#ga9f9b5c3908c35064e11e3d4fb15cb434">BCC</a></div><div class="ttdeci">#define BCC</div><div class="ttdoc">BCC identifier. </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00606">grids.h:606</a></div></div>
<div class="ttc" id="classGridVolumeT_html_a6b8c21b3a6a62cdefcae5540b61401d7"><div class="ttname"><a href="classGridVolumeT.html#a6b8c21b3a6a62cdefcae5540b61401d7">GridVolumeT::adapt_to_grid</a></div><div class="ttdeci">void adapt_to_grid(const Grid &amp;_grid)</div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00855">grids.h:855</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca36b09d6e71a60cfa3837d7e24c07ca"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a></div><div class="ttdeci">double * lambda</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04431">numerical_recipes.cpp:4431</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Grids_html_ga0de7dbedeae567025be0323d8f278528"><div class="ttname"><a href="group__Grids.html#ga0de7dbedeae567025be0323d8f278528">FCC</a></div><div class="ttdeci">#define FCC</div><div class="ttdoc">FCC identifier. </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00604">grids.h:604</a></div></div>
<div class="ttc" id="group__Blobs_html_gad1f8107fe2e79dd5a210df9509ab6055"><div class="ttname"><a href="group__Blobs.html#gad1f8107fe2e79dd5a210df9509ab6055">SHOW_CONVERSION</a></div><div class="ttdeci">#define SHOW_CONVERSION</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00354">blobs.h:354</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00073">multidim_array.h:73</a></div></div>
<div class="ttc" id="group__Grids_html_ga6aa76a2e4586c723594ad9170776d83a"><div class="ttname"><a href="group__Grids.html#ga6aa76a2e4586c723594ad9170776d83a">Create_FCC_grid</a></div><div class="ttdeci">Grid Create_FCC_grid(double relative_size, const Matrix1D&lt; double &gt; &amp;corner1, const Matrix1D&lt; double &gt; &amp;corner2)</div><div class="ttdef"><b>Definition:</b> <a href="grids_8cpp_source.html#l00328">grids.cpp:328</a></div></div>
<div class="ttc" id="group__Grids_html_gabcee3c16466dd4ce63338d369dc90cbb"><div class="ttname"><a href="group__Grids.html#gabcee3c16466dd4ce63338d369dc90cbb">Create_BCC_grid</a></div><div class="ttdeci">Grid Create_BCC_grid(double relative_size, const Matrix1D&lt; double &gt; &amp;corner1, const Matrix1D&lt; double &gt; &amp;corner2)</div><div class="ttdef"><b>Definition:</b> <a href="grids_8cpp_source.html#l00273">grids.cpp:273</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
