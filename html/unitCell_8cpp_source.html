<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Xmipp: /home/yunior/Yunior/Projects/Scipion/COSS/xmipp-bundle/src/xmipp/libraries/data/unitCell.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_dbce2b2c1291334a9ade6207c7a262fa.html">xmipp-bundle</a></li><li class="navelem"><a class="el" href="dir_5ca4f3e8e51f1e22c724fe6427eb943c.html">src</a></li><li class="navelem"><a class="el" href="dir_51a4fe91bde3feaf0f23bad87d0144e4.html">xmipp</a></li><li class="navelem"><a class="el" href="dir_c1f8b3d1b5354b6c120dfc6668096234.html">libraries</a></li><li class="navelem"><a class="el" href="dir_f083b9d43eb51ff5c9ab4698ce0a19c4.html">data</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">unitCell.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="unitCell_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="unitCell_8h.html">unitCell.h</a>&quot;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// 60 is the angle between the vectors</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// icosahedron from_5f_to_2f and from_5f_2fp: vector that joing a vertex with the two closes 2-fold symmetry axis</span></div><div class="line"><a name="l00005"></a><span class="lineno"><a class="line" href="unitCell_8cpp.html#a359543e7eaa41c97697967cbb7e24be3">    5</a></span>&#160;<span class="preprocessor">#define tg60   1.73205081</span></div><div class="line"><a name="l00006"></a><span class="lineno"><a class="line" href="unitCell_8cpp.html#a7d1eba56fef5e364c82de0f9df48f547">    6</a></span>&#160;<span class="preprocessor">#define sin60  0.8660254</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//#define DEBUG </span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#define scale 1.//780-use to scale chimera bild files so they fit your actual 3Dmap</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno"><a class="line" href="classUnitCell.html#ab136e40c962e0c7c2da765cc60228242">   12</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classUnitCell.html#ab136e40c962e0c7c2da765cc60228242">UnitCell::doCyclic</a>(<span class="keywordtype">int</span> order) { <span class="comment">//check offset is in radians</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> sym_centre, sym_2f, sym_2fp;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    sym_centre = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0., 0., 0.);</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    sym_2f = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(cos(offset), sin(offset), 0.) * rmax;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    sym_2fp = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(cos(<a class="code" href="group__Macros.html#ga4912c64aec0c943b7985db6cb61ff83a">TWOPI</a> / order + offset), sin(<a class="code" href="group__Macros.html#ga4912c64aec0c943b7985db6cb61ff83a">TWOPI</a> / order + offset),</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;            0.) * rmax;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    _minZ = -rmax;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    _maxZ = +rmax;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    cyclicSymmetry(sym_centre, sym_2f, sym_2fp, order, expanded, offset);</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;}</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="classUnitCell.html#ab0c75627e2b78cf715b1912e3dee97fe">   24</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classUnitCell.html#ab0c75627e2b78cf715b1912e3dee97fe">UnitCell::doDihedral</a>(<span class="keywordtype">int</span> order) {</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> sym_centre, sym_2f, sym_2fp;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    sym_centre = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0., 0., 0.);</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    sym_2f = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(cos(offset), sin(offset), 0.) * rmax;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    sym_2fp = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(cos(<a class="code" href="group__Macros.html#ga4912c64aec0c943b7985db6cb61ff83a">TWOPI</a> / order + offset), sin(<a class="code" href="group__Macros.html#ga4912c64aec0c943b7985db6cb61ff83a">TWOPI</a> / order + offset),</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;            0.) * rmax;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    _minZ = -rmax;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    _maxZ = +rmax;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    dihedralSymmetry(sym_centre, sym_2f, sym_2fp, order, expanded, offset);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;}</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="classUnitCell.html#aa38f3fe7d2e6c2a5543f4b30c694ec64">   36</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classUnitCell.html#aa38f3fe7d2e6c2a5543f4b30c694ec64">UnitCell::doTetrahedral</a>(<span class="keywordtype">int</span> symmetry) {</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> sym_centroid,sym_3f, sym_3fp, sym_3fpp;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    sym_centroid = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0., 0., 0.);</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    sym_3f = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0., 0., 1.) * rmax;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    sym_3fp = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0., 0.94281, -0.33333) * rmax;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    sym_3fpp = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0.81650, -0.47140, -0.33333) * rmax;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    _minZ = -rmax;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    _maxZ = +rmax;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    tetrahedralSymmetry(sym_centroid, sym_3f, sym_3fp, sym_3fpp, expanded);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;}</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="classUnitCell.html#add3a805aaa484afd07dd17e564f936ad">   48</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classUnitCell.html#add3a805aaa484afd07dd17e564f936ad">UnitCell::doOctahedral</a>(<span class="keywordtype">int</span> symmetry) {</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> sym_centre, sym_4f, sym_4fp, sym_4fpp;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    sym_centre = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0., 0., 0.);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    sym_4f = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(1., 0., 0.) * rmax;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    sym_4fp = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0., 1., 0.) * rmax;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    sym_4fpp = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0., 0., 1.) * rmax;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    _minZ = -rmax;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    _maxZ = +rmax;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    octahedralSymmetry(sym_centre, sym_4f, sym_4fp, sym_4fpp, expanded);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;}</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="classUnitCell.html#a96b0e74aa75814ab30430e7025f5d653">   60</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classUnitCell.html#a96b0e74aa75814ab30430e7025f5d653">UnitCell::doIcosahedral</a>(<span class="keywordtype">int</span> symmetry) {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> sym_centre, sym_5f, sym_5fp, sym_5fpp;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    sym_centre = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0., 0., 0.);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">if</span> (symmetry == <a class="code" href="group__SymmetryLists.html#ga930edf6b18af8f7e83289d07e61d4682">pg_I1</a>) {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        sym_5f = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0., -0.52573111, 0.85065081);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        sym_5fp = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0., 0.52573111, 0.85065081);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        sym_5fpp = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(-8.50650808e-01, -5.55111512e-17, 5.25731112e-01);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (symmetry == <a class="code" href="group__SymmetryLists.html#gaae2c66149cb20fe0313c7bd526f80e81">pg_I2</a>) {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        sym_5f = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(-0.52573111, 0., 0.85065081);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        sym_5fp = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0.52573111, 0., 0.85065081);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        sym_5fpp = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(-5.55111512e-17, 8.50650808e-01, 5.25731112e-01);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (symmetry == <a class="code" href="group__SymmetryLists.html#gacd290bd088451d573299020abe17526a">pg_I3</a>) {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        sym_5f = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0., 0., -1.);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        sym_5fp = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0.89442719, 0., -0.4472136);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        sym_5fpp = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0.2763932, -0.85065081, -0.4472136);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (symmetry == <a class="code" href="group__SymmetryLists.html#ga4a20daff060d6ef0dd683c5069dd04f5">pg_I4</a>) {</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        sym_5f = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0., 0., 1.);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        sym_5fp = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0.89442719, 0., 0.4472136);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        sym_5fpp = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0.2763932, 0.85065081, 0.4472136);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    } <span class="keywordflow">else</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa99ae519fb00e32cc6e716cc01d21cadf">ERR_ARG_INCORRECT</a>, <span class="stringliteral">&quot;Symmetry not implemented&quot;</span>);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    _minZ = rmax;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    _maxZ = rmin;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    icoSymmetry(sym_centre, sym_5f, sym_5fp, sym_5fpp, expanded);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;}</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="classUnitCell.html#a31e92e72477a7518f03c37faf7d600ce">   87</a></span>&#160;<a class="code" href="classUnitCell.html#a31e92e72477a7518f03c37faf7d600ce">UnitCell::UnitCell</a>(<a class="code" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a> sym, <span class="keywordtype">double</span> rmin, <span class="keywordtype">double</span> rmax, <span class="keywordtype">double</span> expanded,</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordtype">double</span> offset, <span class="keywordtype">double</span> sampling, <span class="keywordtype">double</span> x_origin, <span class="keywordtype">double</span> y_origin, <span class="keywordtype">double</span> z_origin) {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">// list of numbers smaller than 10000 which have prime decomposition</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">// that does not contain prime number greater than 19</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// This is the greatest prime number that can handle ccp4 fft routine</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    this-&gt;rmin = rmin; <span class="comment">//delete voxels closer to the center than this radius</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    this-&gt;rmax = rmax; <span class="comment">//delete voxels more far away to the center than this radius</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    this-&gt;offset = offset; <span class="comment">//rotate unit cell this degrees</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    this-&gt;expanded = expanded; <span class="comment">//coefficient of expansion</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    this-&gt;sampling = sampling; <span class="comment">// Angstrom/pixels relation </span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    this-&gt;x_origin = x_origin; <span class="comment">// origin x coordinate introduced with the input volume (in pixels)</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    this-&gt;y_origin = y_origin; <span class="comment">// origin y coordinate introduced with the input volume (in pixels)</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    this-&gt;z_origin = z_origin; <span class="comment">// origin z coordinate introduced with the input volume (in pixels)</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    this-&gt;newOriginAfterExpansion = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0., 0., 0.);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    SL.<a class="code" href="classSymList.html#aa13b2960281c3a24dc3dd811cf69060e">isSymmetryGroup</a>(sym, symmetry, sym_order); <span class="comment">//parse symmetry string</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;symmetry: &quot;</span> &lt;&lt; symmetry &lt;&lt; std::endl;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">if</span> (symmetry == <a class="code" href="group__SymmetryLists.html#ga727206ac0df28216494359a5ce37f528">pg_CN</a> &amp;&amp; sym_order != 1)</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <a class="code" href="classUnitCell.html#ab136e40c962e0c7c2da765cc60228242">doCyclic</a>(sym_order);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (symmetry == <a class="code" href="group__SymmetryLists.html#ga92f9cbf5e9c4697c04bd95bff32cb20a">pg_DN</a>)</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="classUnitCell.html#ab0c75627e2b78cf715b1912e3dee97fe">doDihedral</a>(sym_order);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (symmetry == <a class="code" href="group__SymmetryLists.html#ga80f12f698aa746dc72fb34ed48a90369">pg_T</a>)</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <a class="code" href="classUnitCell.html#aa38f3fe7d2e6c2a5543f4b30c694ec64">doTetrahedral</a>();</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (symmetry == <a class="code" href="group__SymmetryLists.html#ga050b1e97c030678ee4033ade569fc960">pg_O</a>)</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="classUnitCell.html#add3a805aaa484afd07dd17e564f936ad">doOctahedral</a>();</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (symmetry &gt;= <a class="code" href="group__SymmetryLists.html#ga930edf6b18af8f7e83289d07e61d4682">pg_I1</a> &amp;&amp; symmetry &lt;= <a class="code" href="group__SymmetryLists.html#ga4a20daff060d6ef0dd683c5069dd04f5">pg_I4</a>)</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <a class="code" href="classUnitCell.html#a96b0e74aa75814ab30430e7025f5d653">doIcosahedral</a>(symmetry);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    {</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        std::ofstream testFile;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        testFile.open(<span class="stringliteral">&quot;planeVectors_in_expandedUnitCell.bild&quot;</span>);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        testFile &lt;&lt; <span class="stringliteral">&quot;.color blue\n&quot;</span>;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> t;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> tt;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; expandedUnitCell.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keywordflow">if</span> (symmetry == <a class="code" href="group__SymmetryLists.html#ga727206ac0df28216494359a5ce37f528">pg_CN</a> || symmetry == <a class="code" href="group__SymmetryLists.html#ga80f12f698aa746dc72fb34ed48a90369">pg_T</a> || symmetry == <a class="code" href="group__SymmetryLists.html#ga050b1e97c030678ee4033ade569fc960">pg_O</a>) {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> == 0)</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                planeVectors[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1].selfNormalize();</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                t = expandedUnitCell[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                tt = expandedUnitCell[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] + (planeVectors[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1] * 10.);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (symmetry == <a class="code" href="group__SymmetryLists.html#ga92f9cbf5e9c4697c04bd95bff32cb20a">pg_DN</a>) {</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> == 0) {</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                    t = expandedUnitCell[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                    planeVectors[expandedUnitCell.size() - 1].selfNormalize();</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                    tt = expandedUnitCell[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                            + (planeVectors[expandedUnitCell.size() - 1] * 10.);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> != 0) {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                    t = expandedUnitCell[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                    planeVectors[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1].selfNormalize();</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                    tt = expandedUnitCell[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] + (planeVectors[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1] * 10.);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (symmetry &gt;= <a class="code" href="group__SymmetryLists.html#ga930edf6b18af8f7e83289d07e61d4682">pg_I1</a> || symmetry &lt;= <a class="code" href="group__SymmetryLists.html#ga4a20daff060d6ef0dd683c5069dd04f5">pg_I4</a>) {</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                t = expandedUnitCell[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] * 74;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                planeVectors[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].selfNormalize();</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                tt = (expandedUnitCell[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] + (planeVectors[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] * 0.1)) * 74;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            }</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            t *= scale;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            tt *= scale;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            testFile &lt;&lt; <span class="stringliteral">&quot;.arrow &quot;</span> &lt;&lt; t(0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; t(1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; t(2) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                    &lt;&lt; tt(0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; tt(1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; tt(2) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                    &lt;&lt; .011 * scale * 10 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        testFile.close();</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;}</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">//FUNCTION cyclicSymmetry fills out the variable planeVectors</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">//(normal vectors to the two flat faces that define a unit cell)</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="keywordtype">void</span> UnitCell::cyclicSymmetry(<span class="keyword">const</span> <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> &amp; sym_centre,</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keyword">const</span> <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> &amp; sym_2f, <span class="keyword">const</span> <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> &amp; sym_2fp, <span class="keywordtype">int</span> order,</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordtype">double</span> expanded, <span class="keywordtype">double</span> offset) {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> from_centre_to_2f = sym_2f - sym_centre;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> from_centre_to_2fp = sym_2fp - sym_centre;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> from_2f_to_2fp = sym_2fp - sym_2f;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    from_2f_to_2fp.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// vector perpendicular to the triangle face, oriented in the positive sense of z axis</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> planeVector;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">if</span> (order == 2) {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        planeVector = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0., 0., 1.);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (order &gt; 2) {</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        planeVector = <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(from_centre_to_2f, from_2f_to_2fp);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    }</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    planeVector.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">//vectExpansion: vectors perpendicular to the unit cell faces</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> vp_0 = <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(from_centre_to_2f, planeVector);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    vp_0.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    vectExpansion.push_back(expanded * vp_0 * rmax / 2);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> vp_1 = <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(planeVector, from_centre_to_2fp);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    vp_1.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    vectExpansion.push_back(expanded * vp_1 * rmax / 2);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    </div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">//vectExpansion of the sym_centre of coordinates</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordtype">double</span> mod_vector = (expanded * rmax / 2) / sin(0.5 * (<a class="code" href="group__Macros.html#ga4912c64aec0c943b7985db6cb61ff83a">TWOPI</a> / order));</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> vp_2 = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(mod_vector * cos((0.5 * (<a class="code" href="group__Macros.html#ga4912c64aec0c943b7985db6cb61ff83a">TWOPI</a> / order)) + offset + (<a class="code" href="group__Macros.html#ga4912c64aec0c943b7985db6cb61ff83a">TWOPI</a> / 2)), mod_vector * sin((0.5 * (<a class="code" href="group__Macros.html#ga4912c64aec0c943b7985db6cb61ff83a">TWOPI</a> / order)) + offset + (<a class="code" href="group__Macros.html#ga4912c64aec0c943b7985db6cb61ff83a">TWOPI</a> / 2)), 0.);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">//computation of coordinates for expandedUnitCell vertices</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">if</span> (expanded == 0) {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        expandedUnitCell.push_back(sym_centre);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        expandedUnitCell.push_back(sym_2f);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        expandedUnitCell.push_back(sym_2fp);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (expanded &gt;= 0) {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="comment">//sym_centre expands to expandedUnitCell[0], which is equivalent to newOriginAfterExpansion</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordflow">if</span> (order == 2) {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            expandedUnitCell.push_back(sym_centre + vectExpansion[0]); </div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (order &gt; 2) {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <span class="comment">//expandedUnitCell.push_back(sym_centre + vp_2);</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            expandedUnitCell.push_back(sym_centre + vp_2);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        }</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="comment">//sym_2f expands to expandedUnitCell[1]</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        expandedUnitCell.push_back(sym_2f + vectExpansion[0]);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="comment">//sym_2fp expands to expandedUnitCell[2]</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        expandedUnitCell.push_back(sym_2fp + vectExpansion[1]);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    newOriginAfterExpansion = expandedUnitCell[0];</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    </div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">//computation of coordinates from expandedUnitCells regarding to the newOriginAfterExpansion</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> new_centre_to_new_2f = expandedUnitCell[1]</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            - newOriginAfterExpansion;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> new_centre_to_new_2fp = expandedUnitCell[2]</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            - newOriginAfterExpansion;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">//vectors normal to faces of the expanded unit cell</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    planeVectors.push_back(</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            (-1) * <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(new_centre_to_new_2f, planeVector));</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    planeVectors.push_back(</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            (-1) * <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(planeVector, new_centre_to_new_2fp));</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor">#include &quot;chimeraTesterC.txt&quot;</span> <span class="comment">//draws the (expanded) unit cell and directions of vectExpansion vectors using chimera</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">//FUNCTION dihedralSymmetry fills out the variable planeVectors</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">//(normal vectors to the three flat faces that define a unit cell)</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="keywordtype">void</span> UnitCell::dihedralSymmetry(<span class="keyword">const</span> <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> &amp; sym_centre,</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keyword">const</span> <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> &amp; sym_2f, <span class="keyword">const</span> <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> &amp; sym_2fp, <span class="keywordtype">int</span> order,</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keywordtype">double</span> expanded, <span class="keywordtype">double</span> offset) {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> from_centre_to_2f = sym_2f - sym_centre;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> from_centre_to_2fp = sym_2fp - sym_centre;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> from_2f_to_2fp = sym_2fp - sym_2f;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    from_2f_to_2fp.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">// vector perpendicular to the triangle face, oriented in the positive sense of z axis</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> planeVector;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">if</span> (order == 2) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        planeVector = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0., 0., 1.);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (order &gt; 2) {</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        planeVector = <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(from_centre_to_2f, from_2f_to_2fp);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    planeVector.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">// vector perpendicular to the triangle face, oriented in the negative sense of z axis</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> planeVector_down;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">if</span> (order == 2) {</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        planeVector_down = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0., 0., -1.);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (order &gt; 2) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        planeVector_down = (-1) * <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(from_centre_to_2f, from_2f_to_2fp);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    planeVector_down.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">//vectExpansion: vectors perpendicular to the unit cell faces</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> vp_0 = <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(from_centre_to_2f, planeVector);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    vp_0.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    vectExpansion.push_back(expanded * vp_0 * rmax / 2);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> vp_1 = <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(planeVector, from_centre_to_2fp);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    vp_1.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    vectExpansion.push_back(expanded * vp_1 * rmax / 2);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> vp_2 = planeVector_down;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    vectExpansion.push_back(expanded * vp_2 * rmax / 2);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    </div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">//vectExpansion of the sym_centre of coordinates</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordtype">double</span> mod_vector = (expanded * rmax / 2) / sin(0.5 * (<a class="code" href="group__Macros.html#ga4912c64aec0c943b7985db6cb61ff83a">TWOPI</a> / order));</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> vp_3 = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(mod_vector * cos((0.5 * (<a class="code" href="group__Macros.html#ga4912c64aec0c943b7985db6cb61ff83a">TWOPI</a> / order)) + offset + (<a class="code" href="group__Macros.html#ga4912c64aec0c943b7985db6cb61ff83a">TWOPI</a> / 2)), mod_vector * sin((0.5 * (<a class="code" href="group__Macros.html#ga4912c64aec0c943b7985db6cb61ff83a">TWOPI</a> / order)) + offset + (<a class="code" href="group__Macros.html#ga4912c64aec0c943b7985db6cb61ff83a">TWOPI</a> / 2)), 0.);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">//computation of coordinates for expandedUnitCell vertices</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">if</span> (expanded == 0) {</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        expandedUnitCell.push_back(sym_centre);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        expandedUnitCell.push_back(sym_2f);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        expandedUnitCell.push_back(sym_2fp);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (expanded &gt;= 0) {</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="comment">//sym_centre expands to expandedUnitCell[0], which is equivalent to newOriginAfterExpansion</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">if</span> (order == 2) {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            expandedUnitCell.push_back(</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                    sym_centre + vectExpansion[0] + vectExpansion[2]);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (order &gt; 2) {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            expandedUnitCell.push_back(</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                    sym_centre + vp_3 + vectExpansion[2]);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="comment">//sym_2f expands to expandedUnitCell[1]</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        expandedUnitCell.push_back(sym_2f + vectExpansion[0] + vectExpansion[2]);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="comment">//sym_2fp expands to expandedUnitCell[2]</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        expandedUnitCell.push_back(sym_2fp + vectExpansion[1] + vectExpansion[2]);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    }</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    newOriginAfterExpansion = expandedUnitCell[0];</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">//computation of coordinates from expandedUnitCells regarding to the newOriginAfterExpansion</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> new_centre_to_new_2f = expandedUnitCell[1]</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            - newOriginAfterExpansion;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> new_centre_to_new_2fp = expandedUnitCell[2]</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            - newOriginAfterExpansion;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">//vectors normal to faces of the expanded unit cell</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    planeVectors.push_back(</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            (-1) * <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(new_centre_to_new_2f, planeVector));</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    planeVectors.push_back(</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            (-1) * <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(planeVector, new_centre_to_new_2fp));</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">if</span> (order == 2) {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        planeVectors.push_back(planeVector);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (order &gt; 2) {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        planeVectors.push_back(</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(new_centre_to_new_2f, new_centre_to_new_2fp));</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="preprocessor">#include &quot;chimeraTesterD.txt&quot;</span> <span class="comment">//draws the (expanded) unit cell and directions of vectExpansion vectors using chimera</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;}</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">//FUNCTION tetrahedralSymmetry fills out the variable planeVectors</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">// (normal vectors to the polyhedron that define a unit cell)</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="keywordtype">void</span> UnitCell::tetrahedralSymmetry(<span class="keyword">const</span> <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> &amp; sym_centroid,</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keyword">const</span> <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> &amp; sym_3f, <span class="keyword">const</span> <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> &amp; sym_3fp,</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keyword">const</span> <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> &amp; sym_3fpp, <span class="keyword">const</span> <span class="keywordtype">double</span> expanded) {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">//amplified_expanded is the resulting product of multiplying the expanded selected value by the factor 25, which could be changed</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordtype">double</span> amplified_expanded = expanded * 25;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    </div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> sym_2f = (sym_3f + sym_3fp) / 2.;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> sym_2fp = (sym_3f + sym_3fpp) / 2.;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> sym_f = (sym_3f + sym_3fp + sym_3fpp) / 3.;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">//vectors that join a symmetry axis with the next only.</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> from_f_to_2f = sym_2f - sym_f;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> from_2f_to_3f = sym_3f - sym_2f;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> from_3f_to_2fp = sym_2fp - sym_3f;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> from_2fp_to_f = sym_f - sym_2fp;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">// vector perpendicular to the triangle face.</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> planeVector = <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(from_2f_to_3f, from_3f_to_2fp);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    planeVector.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">//vectExpansion: vectors perpendicular to the unit cell edges</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> vectorPlane_0 = <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(from_f_to_2f, planeVector);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    vectorPlane_0.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    vectExpansion.push_back(amplified_expanded * vectorPlane_0);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> vectorPlane_1 = <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(from_2f_to_3f, planeVector);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    vectorPlane_1.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    vectExpansion.push_back(amplified_expanded * vectorPlane_1);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> vectorPlane_2 = <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(from_3f_to_2fp, planeVector);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    vectorPlane_2.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    vectExpansion.push_back(amplified_expanded * vectorPlane_2);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> vectorPlane_3 = <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(from_2fp_to_f, planeVector);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    vectorPlane_3.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    vectExpansion.push_back(amplified_expanded * vectorPlane_3);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">//computation of coordinates for expandedUnitCell vertices</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    from_3f_to_2fp.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    from_2f_to_3f.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> first_expandedUnitCell_0 = sym_3f</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            + (amplified_expanded / <a class="code" href="unitCell_8cpp.html#a7d1eba56fef5e364c82de0f9df48f547">sin60</a>) * (-1) * (from_3f_to_2fp)</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            + (amplified_expanded / <a class="code" href="unitCell_8cpp.html#a7d1eba56fef5e364c82de0f9df48f547">sin60</a>) * (from_2f_to_3f);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> first_expandedUnitCell_1 = sym_2f + vectExpansion[0]</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            + vectExpansion[1];</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> v4 = (from_2fp_to_f - from_f_to_2f);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    v4.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> first_expandedUnitCell_2 = sym_f </div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;             + (v4 * amplified_expanded / <a class="code" href="unitCell_8cpp.html#a7d1eba56fef5e364c82de0f9df48f547">sin60</a>);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> first_expandedUnitCell_3 = sym_2fp + vectExpansion[2]</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            + vectExpansion[3];</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">//sym_centre expands to expandedUnitCell[0], which is equivalent to newOriginAfterExpansion</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">//intersection of the three planes of coordinates</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">if</span> (expanded == 0) {</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        expandedUnitCell.push_back(sym_centroid);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        expandedUnitCell.push_back(sym_3f);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        expandedUnitCell.push_back(sym_2f);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        expandedUnitCell.push_back(sym_2fp);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        expandedUnitCell.push_back(sym_f);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (expanded &gt;= 0) {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        x = first_expandedUnitCell_0(0);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        y = first_expandedUnitCell_0(1);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        z = (-1) * ((vectorPlane_0(2) * vectorPlane_0(2)) / vectorPlane_0(1));</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        expandedUnitCell.push_back(sym_centroid + <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(x, y, z));</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="comment">//sym_3f expands to expandedUnitCell[1]</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        expandedUnitCell.push_back(first_expandedUnitCell_0);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="comment">//sym_2f expands to expandedUnitCell[2]</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        expandedUnitCell.push_back(first_expandedUnitCell_1);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="comment">//sym_f expands to expandeUnitCell[3]</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        expandedUnitCell.push_back(first_expandedUnitCell_2);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="comment">//sym_2fp expands to expandedUnitCell[4]</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        expandedUnitCell.push_back(first_expandedUnitCell_3);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    newOriginAfterExpansion = expandedUnitCell[0];</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">//computation of coordinates from expandedUnitCells regarding to the newOriginAfterExpansion</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> new_expandedUnitCell_1 = expandedUnitCell[1]</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            - newOriginAfterExpansion;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> new_expandedUnitCell_2 = expandedUnitCell[2]</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            - newOriginAfterExpansion;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> new_expandedUnitCell_3 = expandedUnitCell[3]</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            - newOriginAfterExpansion;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> new_expandedUnitCell_4 = expandedUnitCell[4]</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            - newOriginAfterExpansion;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    </div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="comment">//vectors normal to faces of the expanded unit cell</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    planeVectors.push_back(<a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(new_expandedUnitCell_2,</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                            new_expandedUnitCell_1));</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    planeVectors.push_back(<a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(new_expandedUnitCell_3,</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                            new_expandedUnitCell_2));</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    planeVectors.push_back(<a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(new_expandedUnitCell_4,</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                            new_expandedUnitCell_3));</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    planeVectors.push_back(<a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(new_expandedUnitCell_1,</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                            new_expandedUnitCell_4));</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="preprocessor">#include &quot;chimeraTesterT.txt&quot;</span> <span class="comment">//draws the (expanded) unit cell and directions of vectExpansion vectors using chimera</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;}</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">//FUNCTION octahedralSymmetry fills out the variable planeVectors</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">// (normal vectors to the polyhedron that define a unit cell)</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="keywordtype">void</span> UnitCell::octahedralSymmetry(<span class="keyword">const</span> <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> &amp; sym_centre,</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="keyword">const</span> <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> &amp; sym_4f, <span class="keyword">const</span> <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> &amp; sym_4fp,</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keyword">const</span> <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> &amp; sym_4fpp, <span class="keywordtype">double</span> expanded) {</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">//amplified_expanded is the resulting product of multiplying the expanded selected value by the factor 25, which could be changed</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordtype">double</span> amplified_expanded = expanded * 25;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> sym_2f = (sym_4f + sym_4fp) / 2.;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> sym_2fp = (sym_4fpp + sym_4f) / 2.;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> sym_3f = (sym_4f + sym_4fp + sym_4fpp) / 3.;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">//vectors that join a symmetry axis with the next only.</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> from_4f_to_2f = sym_2f - sym_4f;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> from_2f_to_3f = sym_3f - sym_2f;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> from_3f_to_2fp = sym_2fp - sym_3f;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> from_2fp_to_4f = sym_4f - sym_2fp;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">// vector perpendicular to the triangle face.</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> planeVector = <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(from_4f_to_2f, from_2fp_to_4f);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    planeVector.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">//vectExpansion: vectors perpendicular to the unit cell edges</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#a8eb6f9afe59b4924d42d1ea2002148e7">v0</a> = <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(planeVector, from_4f_to_2f);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    v0.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#a9f954d5f5402aa3e24d96406b24f27a7">v1</a> = <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(planeVector, from_2f_to_3f);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    v1.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> v2 = <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(planeVector, from_3f_to_2fp);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    v2.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> v3 = <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(planeVector, from_2fp_to_4f);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    v3.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    vectExpansion.push_back(amplified_expanded * planeVector);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    vectExpansion.push_back(amplified_expanded * v0);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    vectExpansion.push_back(amplified_expanded * v1);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    vectExpansion.push_back(amplified_expanded * v2);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    vectExpansion.push_back(amplified_expanded * v3);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="comment">//computation of coordinates for expandedUnitCell vertices</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    from_4f_to_2f.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    from_2fp_to_4f.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> first_expandedUnitCell_0 = sym_4f</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            + (amplified_expanded / <a class="code" href="unitCell_8cpp.html#a7d1eba56fef5e364c82de0f9df48f547">sin60</a>) * (-1) * (from_4f_to_2f)</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            + (amplified_expanded / <a class="code" href="unitCell_8cpp.html#a7d1eba56fef5e364c82de0f9df48f547">sin60</a>) * (from_2fp_to_4f);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> first_expandedUnitCell_1 = sym_2f + vectExpansion[1]</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            + vectExpansion[2];</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> v4 = (from_2f_to_3f - from_3f_to_2fp);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    v4.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> first_expandedUnitCell_2 = sym_3f</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            + v4 * amplified_expanded / <a class="code" href="unitCell_8cpp.html#a7d1eba56fef5e364c82de0f9df48f547">sin60</a>;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">//sym_centre expands to expandedUnitCell[0], which is equivalent to newOriginAfterExpansion</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">//intersection of the three planes of coordinates</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">if</span> (expanded == 0) {</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        expandedUnitCell.push_back(sym_centre);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        expandedUnitCell.push_back(sym_4f);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        expandedUnitCell.push_back(sym_2f);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        expandedUnitCell.push_back(sym_3f);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        expandedUnitCell.push_back(sym_2fp);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (expanded &gt;= 0) {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        x = first_expandedUnitCell_1(0) - first_expandedUnitCell_1(1)</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            + first_expandedUnitCell_0(1);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        y = first_expandedUnitCell_0(1);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        z = first_expandedUnitCell_0(2);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        expandedUnitCell.push_back(sym_centre + <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(x, y, z));</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="comment">//sym_4f expands to expandedUnitCell[1]</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        expandedUnitCell.push_back(first_expandedUnitCell_0);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="comment">//sym_2f expands to expandedUnitCell[2]</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        expandedUnitCell.push_back(first_expandedUnitCell_1);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="comment">//sym_3f expands to expandeUnitCell[3]</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        expandedUnitCell.push_back(first_expandedUnitCell_2);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="comment">//sym_2fp expands to expandedUnitCell[4]</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        expandedUnitCell.push_back(sym_2fp + vectExpansion[3] + vectExpansion[4]);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    newOriginAfterExpansion = expandedUnitCell[0];</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="comment">//computation of coordinates from expandedUnitCells regarding to the newOriginAfterExpansion</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> new_expandedUnitCell_1 = expandedUnitCell[1]</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            - newOriginAfterExpansion;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> new_expandedUnitCell_2 = expandedUnitCell[2]</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            - newOriginAfterExpansion;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> new_expandedUnitCell_3 = expandedUnitCell[3]</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            - newOriginAfterExpansion;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> new_expandedUnitCell_4 = expandedUnitCell[4]</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            - newOriginAfterExpansion;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">//vectors normal to faces of the expanded unit cell</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    planeVectors.push_back(<a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(new_expandedUnitCell_1,</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                            new_expandedUnitCell_2));</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    planeVectors.push_back(<a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(new_expandedUnitCell_2,</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                            new_expandedUnitCell_3));</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    planeVectors.push_back(<a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(new_expandedUnitCell_3,</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                            new_expandedUnitCell_4));</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    planeVectors.push_back(<a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(new_expandedUnitCell_4,</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                            new_expandedUnitCell_1));</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="preprocessor">#include &quot;chimeraTesterO.txt&quot;</span> <span class="comment">//draws the (expanded) unit cell </span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">//and directions of vectExpansion vectors using chimera</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;}<span class="comment">//FUNCTION icoSymmetry fills out the variable planeVectors</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">// (normal vectors to the polyhedron that define a unit cell)</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="keywordtype">void</span> UnitCell::icoSymmetry(<span class="keyword">const</span> <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> &amp; sym_centre,</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="keyword">const</span> <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> &amp; sym_5f, <span class="keyword">const</span> <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> &amp; sym_5fp,</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="keyword">const</span> <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> &amp; sym_5fpp, <span class="keywordtype">double</span> expanded) {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> sym_2f = (sym_5f + sym_5fp) / 2.;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> sym_2fp = (sym_5fpp + sym_5f) / 2.;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> sym_3f = (sym_5f + sym_5fp + sym_5fpp) / 3.;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">//vectors that join a symmetry axis with the next only.</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> from_5f_to_2f = sym_2f - sym_5f;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> from_2f_to_3f = sym_3f - sym_2f;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> from_3f_to_2fp = sym_2fp - sym_3f;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> from_2fp_to_5f = sym_5f - sym_2fp;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="comment">// vector perpendicular to the triangle face.</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> planeVector = <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(from_5f_to_2f, from_2fp_to_5f);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="comment">//vectExpansion: vectors perpendicular to the unit cell edges</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#a8eb6f9afe59b4924d42d1ea2002148e7">v0</a> = <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(planeVector, from_5f_to_2f);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    v0.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    vectExpansion.push_back(expanded * v0);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#a9f954d5f5402aa3e24d96406b24f27a7">v1</a> = <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(planeVector, from_2f_to_3f);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    v1.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    vectExpansion.push_back(expanded * v1);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> v2 = <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(planeVector, from_3f_to_2fp);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    v2.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    vectExpansion.push_back(expanded * v2);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> v3 = <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(planeVector, from_2fp_to_5f);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    v3.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    vectExpansion.push_back(expanded * v3);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="comment">//computation of coordinates for expandedUnitCell vertices</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">//sym_centre remains constant and it is equivalent to newOriginAfterExpansion</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    newOriginAfterExpansion = sym_centre;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keywordflow">if</span> (expanded == 0) {</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        expandedUnitCell.push_back(sym_5f);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        expandedUnitCell.push_back(sym_2f);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        expandedUnitCell.push_back(sym_3f);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        expandedUnitCell.push_back(sym_2fp);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (expanded &gt;= 0) {</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="comment">//60 is the angle between from_5f_to_2f and from_2fp_to_5f</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="comment">//mod: proyection (module) of expanded in the negative direction of the from_5f_to_2f vector, and</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="comment">//proyection (module) of expanded in the direction of the from_2fp_to_5f vector</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <span class="comment">//double mod = tg60 * (sin60 * expanded);</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="group__MultidimensionalArrays.html#ga716fb5264cf9c19edb101df0741af79a">mod</a> = expanded / <a class="code" href="unitCell_8cpp.html#a7d1eba56fef5e364c82de0f9df48f547">sin60</a>;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        from_2fp_to_5f.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        from_5f_to_2f.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="comment">//sym_5f expands to expandedUnitCell[0]</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        expandedUnitCell.push_back(</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                sym_5f + mod * ((from_2fp_to_5f) + ((-1) * from_5f_to_2f)));</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="comment">//sym_2f expands to expandedUnitCell[1]</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        expandedUnitCell.push_back(sym_2f + vectExpansion[0] + vectExpansion[1]);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="comment">//mod: proyection (module) of expanded in the negative direction of the from_3f_to_2fp vector</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        mod = (1 / <a class="code" href="unitCell_8cpp.html#a359543e7eaa41c97697967cbb7e24be3">tg60</a>) * expanded;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        from_3f_to_2fp.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <span class="comment">//sym_3f expands to expandedUnitCell[2]</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        expandedUnitCell.push_back(</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                sym_3f + vectExpansion[2] + ((-1) * from_3f_to_2fp * mod));</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <span class="comment">//sym_2fp expands to expandedUnitCell[3]</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        expandedUnitCell.push_back(sym_2fp + vectExpansion[2] + vectExpansion[3]);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    }</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="comment">//vectors normal to faces of the expanded polyhedra</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 4; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        planeVectors.push_back(</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                <a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(expandedUnitCell[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>],</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                        expandedUnitCell[(i + 1) % 4]));</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    }</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="preprocessor">#include &quot;chimeraTesterI2.txt&quot;</span> <span class="comment">//draws the (expanded) unit cell and directions of vectExpansion vectors using chimera</span></div><div class="line"><a name="l00567"></a><span class="lineno"><a class="line" href="classUnitCell.html#a2f419b55566972b3a1abe9a057fc578d">  567</a></span>&#160;}<span class="keywordtype">void</span> <a class="code" href="classUnitCell.html#a2f419b55566972b3a1abe9a057fc578d">UnitCell::maskUnitCell</a>(<a class="code" href="classImageGeneric.html">ImageGeneric</a> &amp; in3Dmap, <a class="code" href="classImageGeneric.html">ImageGeneric</a> &amp; out3DDmap) {</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="comment">//1) get dimensions</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="projection_8cpp.html#ab17807a5400b7a54607c87513d0edf80">xDim</a>, <a class="code" href="projection_8cpp.html#a151b09680d4024bb8c942ec71983b77f">yDim</a>, zDim;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    in3Dmap.<a class="code" href="classImageGeneric.html#a8af1dcbf4fba0a168f370b3be8e33302">getDimensions</a>(xDim, yDim, zDim);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordtype">double</span> x_offset = x_origin - xDim/2.; <span class="comment">//difference between default and user introduced x_origin coordinate</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordtype">double</span> y_offset = y_origin - yDim/2.; <span class="comment">//difference between default and user introduced y_origin coordinate</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordtype">double</span> z_offset = z_origin - zDim/2.; <span class="comment">//difference between default and user introduced z_origin coordinate</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    </div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">if</span> (rmax == 0)</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        rmax = (double) xDim / 2.;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="preprocessor">#ifdef DEBUG1</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        std::ofstream testFile;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        testFile.open(<span class="stringliteral">&quot;ico2.bild&quot;</span>);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> t;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keywordtype">double</span> th = 1.;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        testFile &lt;&lt; <span class="stringliteral">&quot;.scale 1\n.color blue\n&quot;</span>;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> tt;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 4; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            t = expandedUnitCell[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] * scale;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            tt = expandedUnitCell[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] * scale + planeVectors[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] * scale;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            testFile &lt;&lt; <span class="stringliteral">&quot;.v &quot;</span> &lt;&lt; t(0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; t(1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; t(2) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            &lt;&lt; tt(0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; tt(1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; tt(2) &lt;&lt; <span class="stringliteral">&quot; 1\n&quot;</span>;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        }</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        testFile.close();</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    }</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="comment">//2) get expanded unitcell enclosing box</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    {</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordtype">double</span> minX = rmin;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="keywordtype">double</span> minY = rmin;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keywordtype">double</span> minZ = rmin;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <span class="keywordtype">double</span> maxX = rmax;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordtype">double</span> maxY = rmax;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <span class="keywordtype">double</span> maxZ = rmax;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordflow">if</span> (sym_order != 1) {</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;             minX = rmax;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;             minY = rmax;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;             minZ = _minZ;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;             maxX = rmin;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;             maxY;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <span class="keywordflow">if</span> (symmetry == <a class="code" href="group__SymmetryLists.html#ga727206ac0df28216494359a5ce37f528">pg_CN</a> || symmetry == <a class="code" href="group__SymmetryLists.html#ga92f9cbf5e9c4697c04bd95bff32cb20a">pg_DN</a>) {</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                maxY = rmax;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                <span class="keywordflow">if</span> (sym_order == 2){</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                    minX = - rmax;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                    minY = - rmax;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                    minZ = - rmax;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                    maxX = rmax;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                    maxY = rmax;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                }</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (symmetry != <a class="code" href="group__SymmetryLists.html#ga727206ac0df28216494359a5ce37f528">pg_CN</a> &amp;&amp; symmetry != <a class="code" href="group__SymmetryLists.html#ga92f9cbf5e9c4697c04bd95bff32cb20a">pg_DN</a>) {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                maxY = rmin;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            }</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            maxZ = _maxZ;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> minVector, maxVector;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <span class="keywordflow">for</span> (std::vector&lt;<a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> &gt;::iterator it =</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                    expandedUnitCell.begin(); it != expandedUnitCell.end();</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                    ++it) {</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                <span class="keywordflow">if</span> (symmetry == <a class="code" href="group__SymmetryLists.html#ga727206ac0df28216494359a5ce37f528">pg_CN</a> || symmetry == <a class="code" href="group__SymmetryLists.html#ga92f9cbf5e9c4697c04bd95bff32cb20a">pg_DN</a> || symmetry == <a class="code" href="group__SymmetryLists.html#ga80f12f698aa746dc72fb34ed48a90369">pg_T</a></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                        || symmetry == <a class="code" href="group__SymmetryLists.html#ga050b1e97c030678ee4033ade569fc960">pg_O</a>) {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                    minVector = (*it);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                    maxVector = (*it);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (symmetry &gt;= <a class="code" href="group__SymmetryLists.html#ga930edf6b18af8f7e83289d07e61d4682">pg_I1</a> || symmetry &lt;= <a class="code" href="group__SymmetryLists.html#ga4a20daff060d6ef0dd683c5069dd04f5">pg_I4</a>) {</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                    (*it).<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                    minVector = (*it) * rmin;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                    maxVector = (*it) * <a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(rmax, (<span class="keywordtype">double</span>) xDim / 2.);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                }</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                expandedUnitCellMin.push_back(minVector);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                expandedUnitCellMax.push_back(maxVector);</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                minX = <a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(minX, minVector(0));</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                minX = <a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(minX, maxVector(0));</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                minY = <a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(minY, minVector(1));</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                minY = <a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(minY, maxVector(1));</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                minZ = <a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(minZ, minVector(2));</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                minZ = <a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(minZ, maxVector(2));</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                maxX = <a class="code" href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">std::max</a>(maxX, minVector(0));</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                maxX = <a class="code" href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">std::max</a>(maxX, maxVector(0));</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                maxY = <a class="code" href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">std::max</a>(maxY, minVector(1));</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                maxY = <a class="code" href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">std::max</a>(maxY, maxVector(1));</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                maxZ = <a class="code" href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">std::max</a>(maxZ, minVector(2));</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                maxZ = <a class="code" href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">std::max</a>(maxZ, maxVector(2));</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            }</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        }</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(sym_order == 1 &amp;&amp; symmetry == <a class="code" href="group__SymmetryLists.html#ga727206ac0df28216494359a5ce37f528">pg_CN</a>) {</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            minX = - rmax;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            minY = - rmax;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            minZ = - rmax;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            maxX = rmax;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            maxY = rmax;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            maxZ = rmax;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        }</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;minX &quot;</span> &lt;&lt; minX &lt;&lt; std::endl;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;minY &quot;</span> &lt;&lt; minY &lt;&lt; std::endl;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;minZ &quot;</span> &lt;&lt; minZ &lt;&lt; std::endl;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;maxX &quot;</span> &lt;&lt; maxX &lt;&lt; std::endl;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;maxY &quot;</span> &lt;&lt; maxY &lt;&lt; std::endl;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;maxZ &quot;</span> &lt;&lt; maxZ &lt;&lt; std::endl;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="comment">//draw real unitcell</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        {</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            <span class="comment">//Debug chimera file</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            std::ofstream testFile;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="comment">//draw box</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            testFile.open(<span class="stringliteral">&quot;box.bild&quot;</span>);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> t, tt;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            t = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(minX, minY, minZ);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            tt = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(maxX, maxY, maxZ);</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            testFile &lt;&lt; <span class="stringliteral">&quot;.color red\n&quot;</span>;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            testFile &lt;&lt; <span class="stringliteral">&quot;.box &quot;</span> &lt;&lt; t(0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; t(1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; t(2) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                    &lt;&lt; tt(0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; tt(1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; tt(2) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            testFile.close();</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        }</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        in3Dmap.<a class="code" href="classImageGeneric.html#a820218a1a3b4d806736efacd2a23ebd3">data</a>-&gt;<a class="code" href="classMultidimArrayGeneric.html#ab25ff6ccf1ea0ad997f0d63ef3fcf616">im</a>;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <a class="code" href="classMultidimArray.html">MultidimArray&lt;float&gt;</a> * map;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <a class="code" href="classMultidimArray.html">MultidimArray&lt;float&gt;</a> * imageMap2;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        in3Dmap().getMultidimArrayPointer(map);</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        out3DDmap.<a class="code" href="classImageGeneric.html#a5eea0cb97735bbb00ad33280b7afa3f4">setDatatype</a>(<a class="code" href="group__Datatypes.html#ggad8ed01ff3ff33333d8e19db4d2818bb6ab46fe84e5b6cba8683d95faf71dccc6f">DT_Float</a>);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        out3DDmap.<a class="code" href="classImageGeneric.html#a72eb9d08de9150e748d7a264c761de50">resize</a>(xDim, yDim, zDim, 1);</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        out3DDmap().getMultidimArrayPointer(imageMap2);</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        imageMap2-&gt;<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a>;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <span class="keywordtype">int</span> rmin2 = rmin * rmin;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <span class="keywordtype">int</span> rmax2 = rmax * rmax;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="keywordtype">int</span> iMinZ, iMinY, iMinX, iMaxZ, iMaxY, iMaxX;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        iMinZ = (int) ceil(minZ);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        iMaxZ = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(maxZ);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        iMinY = (int) ceil(minY);</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        iMaxY = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(maxY);</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        iMinX = (int) ceil(minX);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        iMaxX = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(maxX);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        <span class="comment">//check that the output 3Dmap has a valid size</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">size_t</span> N = 1168;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>[N] = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                    17, 18, 19, 20, 21, 22, 24, 25, 26, 27, 28, 30, 32, 33, 34,</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                    35, 36, 38, 39, 40, 42, 44, 45, 48, 49, 50, 51, 52, 54, 55,</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                    56, 57, 60, 63, 64, 65, 66, 68, 70, 72, 75, 76, 77, 78, 80,</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                    81, 84, 85, 88, 90, 91, 95, 96, 98, 99, 100, 102, 104, 105,</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                    108, 110, 112, 114, 117, 119, 120, 121, 125, 126, 128, 130,</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                    132, 133, 135, 136, 140, 143, 144, 147, 150, 152, 153, 154,</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                    156, 160, 162, 165, 168, 169, 170, 171, 175, 176, 180, 182,</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                    187, 189, 190, 192, 195, 196, 198, 200, 204, 208, 209, 210,</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                    216, 220, 221, 224, 225, 228, 231, 234, 238, 240, 242, 243,</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                    245, 247, 250, 252, 255, 256, 260, 264, 266, 270, 272, 273,</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                    275, 280, 285, 286, 288, 289, 294, 297, 300, 304, 306, 308,</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                    312, 315, 320, 323, 324, 325, 330, 336, 338, 340, 342, 343,</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                    350, 351, 352, 357, 360, 361, 363, 364, 374, 375, 378, 380,</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                    384, 385, 390, 392, 396, 399, 400, 405, 408, 416, 418, 420,</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                    425, 429, 432, 440, 441, 442, 448, 450, 455, 456, 459, 462,</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                    468, 475, 476, 480, 484, 486, 490, 494, 495, 500, 504, 507,</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                    510, 512, 513, 520, 525, 528, 532, 539, 540, 544, 546, 550,</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                    560, 561, 567, 570, 572, 576, 578, 585, 588, 594, 595, 600,</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                    605, 608, 612, 616, 624, 625, 627, 630, 637, 640, 646, 648,</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                    650, 660, 663, 665, 672, 675, 676, 680, 684, 686, 693, 700,</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                    702, 704, 714, 715, 720, 722, 726, 728, 729, 735, 741, 748,</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                    750, 756, 760, 765, 768, 770, 780, 784, 792, 798, 800, 810,</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                    816, 819, 825, 832, 833, 836, 840, 845, 847, 850, 855, 858,</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                    864, 867, 875, 880, 882, 884, 891, 896, 900, 910, 912, 918,</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                    924, 931, 935, 936, 945, 950, 952, 960, 968, 969, 972, 975,</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                    980, 988, 990, 1000, 1001, 1008, 1014, 1020, 1024, 1026,</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                    1029, 1040, 1045, 1050, 1053, 1056, 1064, 1071, 1078, 1080,</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                    1083, 1088, 1089, 1092, 1100, 1105, 1120, 1122, 1125, 1134,</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                    1140, 1144, 1152, 1155, 1156, 1170, 1176, 1183, 1188, 1190,</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                    1197, 1200, 1210, 1215, 1216, 1224, 1225, 1232, 1235, 1248,</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                    1250, 1254, 1260, 1274, 1275, 1280, 1287, 1292, 1296, 1300,</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                    1309, 1320, 1323, 1326, 1330, 1331, 1344, 1350, 1352, 1360,</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                    1365, 1368, 1372, 1375, 1377, 1386, 1400, 1404, 1408, 1425,</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                    1428, 1430, 1440, 1444, 1445, 1452, 1456, 1458, 1463, 1470,</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                    1482, 1485, 1496, 1500, 1512, 1520, 1521, 1530, 1536, 1539,</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                    1540, 1547, 1560, 1568, 1573, 1575, 1584, 1596, 1600, 1615,</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                    1617, 1620, 1625, 1632, 1638, 1650, 1664, 1666, 1672, 1680,</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                    1683, 1690, 1694, 1700, 1701, 1710, 1715, 1716, 1728, 1729,</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                    1734, 1750, 1755, 1760, 1764, 1768, 1782, 1785, 1792, 1800,</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                    1805, 1815, 1820, 1824, 1836, 1848, 1859, 1862, 1870, 1872,</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                    1875, 1881, 1890, 1900, 1904, 1911, 1920, 1925, 1936, 1938,</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                    1944, 1950, 1960, 1976, 1980, 1989, 1995, 2000, 2002, 2016,</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                    2023, 2025, 2028, 2040, 2048, 2052, 2057, 2058, 2079, 2080,</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                    2090, 2100, 2106, 2112, 2125, 2128, 2142, 2145, 2156, 2160,</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                    2166, 2176, 2178, 2184, 2187, 2197, 2200, 2205, 2210, 2223,</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                    2240, 2244, 2250, 2261, 2268, 2275, 2280, 2288, 2295, 2299,</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                    2304, 2310, 2312, 2340, 2352, 2366, 2375, 2376, 2380, 2394,</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                    2400, 2401, 2420, 2430, 2431, 2432, 2448, 2450, 2457, 2464,</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                    2470, 2475, 2496, 2499, 2500, 2508, 2520, 2527, 2535, 2541,</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                    2548, 2550, 2560, 2565, 2574, 2584, 2592, 2600, 2601, 2618,</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                    2625, 2640, 2646, 2652, 2660, 2662, 2673, 2688, 2695, 2700,</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                    2704, 2717, 2720, 2730, 2736, 2744, 2750, 2754, 2772, 2793,</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                    2800, 2805, 2808, 2816, 2835, 2850, 2856, 2860, 2873, 2880,</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                    2888, 2890, 2904, 2907, 2912, 2916, 2925, 2926, 2940, 2964,</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                    2970, 2975, 2992, 3000, 3003, 3024, 3025, 3040, 3042, 3060,</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                    3072, 3078, 3080, 3087, 3094, 3120, 3125, 3135, 3136, 3146,</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                    3150, 3159, 3168, 3179, 3185, 3192, 3200, 3211, 3213, 3230,</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                    3234, 3240, 3249, 3250, 3264, 3267, 3276, 3300, 3315, 3325,</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                    3328, 3332, 3344, 3360, 3366, 3375, 3380, 3388, 3400, 3402,</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                    3420, 3430, 3432, 3456, 3458, 3465, 3468, 3500, 3510, 3520,</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                    3528, 3536, 3549, 3553, 3564, 3570, 3575, 3584, 3591, 3600,</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                    3610, 3630, 3640, 3645, 3648, 3672, 3675, 3696, 3705, 3718,</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                    3724, 3740, 3744, 3750, 3757, 3762, 3773, 3780, 3800, 3808,</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                    3822, 3825, 3840, 3850, 3861, 3872, 3876, 3888, 3900, 3920,</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                    3927, 3952, 3960, 3969, 3971, 3978, 3990, 3993, 4000, 4004,</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                    4032, 4046, 4050, 4056, 4080, 4095, 4096, 4104, 4114, 4116,</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                    4125, 4131, 4158, 4160, 4165, 4180, 4199, 4200, 4212, 4224,</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                    4225, 4235, 4250, 4256, 4275, 4284, 4290, 4312, 4320, 4332,</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                    4335, 4352, 4356, 4368, 4374, 4375, 4389, 4394, 4400, 4410,</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                    4420, 4446, 4455, 4459, 4480, 4488, 4500, 4522, 4536, 4550,</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                    4560, 4563, 4576, 4590, 4598, 4608, 4617, 4620, 4624, 4641,</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                    4655, 4675, 4680, 4693, 4704, 4719, 4725, 4732, 4750, 4752,</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                    4760, 4788, 4800, 4802, 4840, 4845, 4851, 4860, 4862, 4864,</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                    4875, 4896, 4900, 4913, 4914, 4928, 4940, 4950, 4992, 4998,</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                    5000, 5005, 5016, 5040, 5049, 5054, 5070, 5082, 5096, 5100,</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                    5103, 5120, 5130, 5145, 5148, 5168, 5184, 5187, 5200, 5202,</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                    5225, 5236, 5250, 5265, 5280, 5292, 5304, 5320, 5324, 5346,</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                    5355, 5376, 5390, 5400, 5408, 5415, 5434, 5440, 5445, 5460,</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                    5472, 5488, 5491, 5500, 5508, 5525, 5544, 5577, 5586, 5600,</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                    5610, 5616, 5625, 5632, 5643, 5670, 5700, 5712, 5720, 5733,</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                    5746, 5760, 5775, 5776, 5780, 5808, 5814, 5824, 5831, 5832,</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                    5850, 5852, 5880, 5915, 5928, 5929, 5940, 5950, 5967, 5984,</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                    5985, 6000, 6006, 6048, 6050, 6069, 6075, 6080, 6084, 6120,</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                    6125, 6137, 6144, 6156, 6160, 6171, 6174, 6175, 6188, 6237,</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                    6240, 6250, 6270, 6272, 6292, 6300, 6318, 6336, 6358, 6370,</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                    6375, 6384, 6400, 6422, 6426, 6435, 6460, 6468, 6480, 6498,</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                    6500, 6517, 6528, 6534, 6545, 6552, 6561, 6591, 6600, 6615,</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                    6630, 6650, 6655, 6656, 6664, 6669, 6688, 6720, 6732, 6750,</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                    6760, 6776, 6783, 6800, 6804, 6825, 6840, 6859, 6860, 6864,</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                    6875, 6885, 6897, 6912, 6916, 6930, 6936, 7000, 7007, 7020,</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                    7040, 7056, 7072, 7098, 7106, 7125, 7128, 7140, 7150, 7168,</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                    7182, 7200, 7203, 7220, 7225, 7260, 7280, 7290, 7293, 7296,</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                    7315, 7344, 7350, 7371, 7392, 7410, 7425, 7436, 7448, 7480,</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                    7488, 7497, 7500, 7514, 7524, 7546, 7560, 7581, 7600, 7605,</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                    7616, 7623, 7644, 7650, 7680, 7695, 7700, 7722, 7735, 7744,</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                    7752, 7776, 7800, 7803, 7840, 7854, 7865, 7875, 7904, 7920,</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                    7938, 7942, 7956, 7980, 7986, 8000, 8008, 8019, 8064, 8075,</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                    8085, 8092, 8100, 8112, 8125, 8151, 8160, 8190, 8192, 8208,</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                    8228, 8232, 8250, 8262, 8281, 8316, 8320, 8330, 8360, 8379,</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                    8398, 8400, 8415, 8424, 8448, 8450, 8470, 8500, 8505, 8512,</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                    8550, 8568, 8575, 8580, 8619, 8624, 8640, 8645, 8664, 8670,</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                    8704, 8712, 8721, 8736, 8748, 8750, 8775, 8778, 8788, 8800,</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                    8820, 8840, 8892, 8910, 8918, 8925, 8960, 8976, 9000, 9009,</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                    9025, 9044, 9072, 9075, 9100, 9120, 9126, 9152, 9163, 9180,</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                    9196, 9216, 9234, 9240, 9248, 9261, 9282, 9295, 9310, 9317,</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                    9350, 9360, 9375, 9386, 9405, 9408, 9438, 9450, 9464, 9477,</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                    9500, 9504, 9520, 9537, 9555, 9576, 9600, 9604, 9625, 9633,</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                    9639, 9680, 9690, 9702, 9720, 9724, 9728, 9747, 9750, 9792,</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                    9800, 9801, 9826, 9828, 9856, 9880, 9900, 9945, 9975, 9984,</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                    9996 };</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        std::vector&lt;int&gt; validSizes(a, a + <span class="keyword">sizeof</span>(a) / <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        std::vector&lt;int&gt;::iterator low; <span class="comment">// iterator to search in validSizes</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        low = std::lower_bound(validSizes.begin(), validSizes.end(), iMaxX);</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="keywordflow">if</span> (validSizes[low - validSizes.begin()] != iMaxX)</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            iMaxX = validSizes[low - validSizes.begin()];</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        low = std::lower_bound(validSizes.begin(), validSizes.end(), iMaxY);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="keywordflow">if</span> (validSizes[low - validSizes.begin()] != iMaxY)</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            iMaxY = validSizes[low - validSizes.begin()];</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        low = std::lower_bound(validSizes.begin(), validSizes.end(), iMaxZ);</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <span class="keywordflow">if</span> (validSizes[low - validSizes.begin()] != iMaxZ)</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            iMaxZ = validSizes[low - validSizes.begin()];</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <span class="keywordtype">double</span> dotproduct;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <span class="keywordtype">bool</span> doIt = <span class="keyword">false</span>;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <span class="comment">//for all points in the enclosing box</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <span class="comment">//check if they are inside the expanded unit cell</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> = iMinZ; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> &lt;= iMaxZ; ++<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>)</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = iMinY; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= iMaxY; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = iMinX; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt;= iMaxX; ++<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) {</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                    r2 = (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> * <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> * <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>);</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                    <span class="keywordflow">if</span> (r2 &gt;= rmin2 &amp;&amp; r2 &lt; rmax2) {</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                        doIt = <span class="keyword">true</span>;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                        <span class="keywordflow">if</span> (sym_order != 1) {</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                            <span class="keywordflow">for</span> (std::vector&lt;<a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> &gt;::iterator it1 =</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                                    planeVectors.begin();</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                                    it1 != planeVectors.end(); ++it1) {</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                                dotproduct =</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                                        <a class="code" href="group__Vectors.html#ga5d2bc77c327154906885f1ebedc8d787">dotProduct</a>(*it1,</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                                                <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                                                        ((<span class="keywordtype">double</span>) <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                                                                - newOriginAfterExpansion(</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                                                                        0),</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                                                        ((<span class="keywordtype">double</span>) <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                                                                - newOriginAfterExpansion(</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                                                                        1),</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                                                        ((<span class="keywordtype">double</span>) <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>)</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                                                                - newOriginAfterExpansion(</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                                                                        2)));</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                                <span class="keywordflow">if</span> (dotproduct &lt; 0) {</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                                    doIt = <span class="keyword">false</span>;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                                }</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                            }</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                        }</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                        <span class="keywordflow">if</span> (doIt) {</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                            <span class="keywordflow">if</span> (x_offset == 0.0 &amp;&amp; y_offset == 0.0 &amp;&amp; z_offset == 0.0){</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                                <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*imageMap2,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*map, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                            }<span class="keywordflow">else</span> {</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                                <span class="keywordtype">int</span> k1 = <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> + z_offset;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                                <span class="keywordtype">int</span> i1 = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + y_offset;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                                <span class="keywordtype">int</span> j1 = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + x_offset;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                                <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*imageMap2,k1,i1,j1) = <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*map, k1, i1, j1);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                            }</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                        }</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                    }</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                }</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <span class="keywordflow">if</span> (x_offset != 0.0 || y_offset != 0.0 || z_offset != 0.0){</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            iMinZ = iMinZ + z_offset;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            iMinY = iMinY + y_offset;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            iMinX = iMinX + x_offset;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            iMaxZ = iMaxZ + z_offset;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            iMaxY = iMaxY + y_offset;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            iMaxX = iMaxX + x_offset;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        }</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        imageMap2-&gt;<a class="code" href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">selfWindow</a>(iMinZ, iMinY, iMinX, iMaxZ, iMaxY, iMaxX, 0.);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <a class="code" href="classMDRow.html">MDRow</a> MD;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        out3DDmap.<a class="code" href="classImageGeneric.html#a0153fa05c64e15a1f13a706fca9a51c6">setDataMode</a>(<a class="code" href="group__Images.html#gga22f7d7ee058354c030d2b52a8f190543afda1463ca408cc79db492465781b3269">_DATA_ALL</a>);</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <span class="comment">//CCP save routine multiplies by sampling rate</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        MD.<a class="code" href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a09e91db5e17c6781c7207ba2aa26ddb3">MDL_ORIGIN_X</a>, (<span class="keywordtype">double</span>) (iMinX - x_offset) );</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        MD.<a class="code" href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a0784622a8bba995ca9861f9385cd02b9">MDL_ORIGIN_Y</a>, (<span class="keywordtype">double</span>) (iMinY - y_offset) );</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        MD.<a class="code" href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a5ecf92c764218ad8557f08079bb931a6">MDL_ORIGIN_Z</a>, (<span class="keywordtype">double</span>) (iMinZ - z_offset) );</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        out3DDmap.<a class="code" href="classImageGeneric.html#a3db6ca0bb5eaafa6fbea69f8d83d04a8">image</a>-&gt;<a class="code" href="classImageBase.html#ad98cea6fed75f124441744d347b8b127">MDMainHeader</a>.<a class="code" href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a5d58a8a34b5fe80b2f224fb3a56ac0a5">MDL_SAMPLINGRATE_X</a>, sampling);</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        out3DDmap.<a class="code" href="classImageGeneric.html#a3db6ca0bb5eaafa6fbea69f8d83d04a8">image</a>-&gt;<a class="code" href="classImageBase.html#ad98cea6fed75f124441744d347b8b127">MDMainHeader</a>.<a class="code" href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ae68d28651600dcd9b0b3e03710b0e7bf">MDL_SAMPLINGRATE_Y</a>, sampling);</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        out3DDmap.<a class="code" href="classImageGeneric.html#a3db6ca0bb5eaafa6fbea69f8d83d04a8">image</a>-&gt;<a class="code" href="classImageBase.html#ad98cea6fed75f124441744d347b8b127">MDMainHeader</a>.<a class="code" href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab2f64c1f4965d352ef274ebbd0addb1f">MDL_SAMPLINGRATE_Z</a>, sampling);</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        out3DDmap.<a class="code" href="classImageGeneric.html#a3db6ca0bb5eaafa6fbea69f8d83d04a8">image</a>-&gt;<a class="code" href="classImageBase.html#ae144d3ee9a3ab388af441c0c561752fc">setGeo</a>(MD, 0);</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    }</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;}</div><div class="ttc" id="classImageGeneric_html_a0153fa05c64e15a1f13a706fca9a51c6"><div class="ttname"><a href="classImageGeneric.html#a0153fa05c64e15a1f13a706fca9a51c6">ImageGeneric::setDataMode</a></div><div class="ttdeci">void setDataMode(DataMode mode)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__generic_8h_source.html#l00167">xmipp_image_generic.h:167</a></div></div>
<div class="ttc" id="unitCell_8h_html"><div class="ttname"><a href="unitCell_8h.html">unitCell.h</a></div></div>
<div class="ttc" id="classMultidimArray_html_ac78e0480644752604f2cd3089aeac804"><div class="ttname"><a href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">MultidimArray::selfWindow</a></div><div class="ttdeci">void selfWindow(int n0, int z0, int y0, int x0, int nF, int zF, int yF, int xF, T init_value=0)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01736">multidim_array.h:1736</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_afbbd36781c10524238c70745c6f6f35d"><div class="ttname"><a href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">min</a></div><div class="ttdeci">void min(Image&lt; double &gt; &amp;op1, const Image&lt; double &gt; &amp;op2)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00115">image_operate.cpp:115</a></div></div>
<div class="ttc" id="classImageGeneric_html_a72eb9d08de9150e748d7a264c761de50"><div class="ttname"><a href="classImageGeneric.html#a72eb9d08de9150e748d7a264c761de50">ImageGeneric::resize</a></div><div class="ttdeci">void resize(int Xdim, int Ydim, int Zdim, size_t Ndim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__generic_8h_source.html#l00150">xmipp_image_generic.h:150</a></div></div>
<div class="ttc" id="group__SymmetryLists_html_ga92f9cbf5e9c4697c04bd95bff32cb20a"><div class="ttname"><a href="group__SymmetryLists.html#ga92f9cbf5e9c4697c04bd95bff32cb20a">pg_DN</a></div><div class="ttdeci">#define pg_DN</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2symmetries_8h_source.html#l00079">symmetries.h:79</a></div></div>
<div class="ttc" id="projection_8cpp_html_a151b09680d4024bb8c942ec71983b77f"><div class="ttname"><a href="projection_8cpp.html#a151b09680d4024bb8c942ec71983b77f">yDim</a></div><div class="ttdeci">#define yDim</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l00034">projection.cpp:34</a></div></div>
<div class="ttc" id="classUnitCell_html_add3a805aaa484afd07dd17e564f936ad"><div class="ttname"><a href="classUnitCell.html#add3a805aaa484afd07dd17e564f936ad">UnitCell::doOctahedral</a></div><div class="ttdeci">void doOctahedral(int symmetry=pg_O)</div><div class="ttdef"><b>Definition:</b> <a href="unitCell_8cpp_source.html#l00048">unitCell.cpp:48</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78ae68d28651600dcd9b0b3e03710b0e7bf"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ae68d28651600dcd9b0b3e03710b0e7bf">MDL_SAMPLINGRATE_Y</a></div><div class="ttdoc">sampling rate in A/pixel (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00382">metadata_label.h:382</a></div></div>
<div class="ttc" id="group__SymmetryLists_html_ga80f12f698aa746dc72fb34ed48a90369"><div class="ttname"><a href="group__SymmetryLists.html#ga80f12f698aa746dc72fb34ed48a90369">pg_T</a></div><div class="ttdeci">#define pg_T</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2symmetries_8h_source.html#l00082">symmetries.h:82</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a5d58a8a34b5fe80b2f224fb3a56ac0a5"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a5d58a8a34b5fe80b2f224fb3a56ac0a5">MDL_SAMPLINGRATE_X</a></div><div class="ttdoc">sampling rate in A/pixel (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00381">metadata_label.h:381</a></div></div>
<div class="ttc" id="classImageBase_html_ad98cea6fed75f124441744d347b8b127"><div class="ttname"><a href="classImageBase.html#ad98cea6fed75f124441744d347b8b127">ImageBase::MDMainHeader</a></div><div class="ttdeci">MDRow MDMainHeader</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00233">xmipp_image_base.h:233</a></div></div>
<div class="ttc" id="cuda__basic__math_8h_html_a2065eb145275f878c1d045c9f3fb1cc7"><div class="ttname"><a href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a></div><div class="ttdeci">__host__ __device__ float2 floor(const float2 v)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__basic__math_8h_source.html#l00175">cuda_basic_math.h:175</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; float &gt;</a></div></div>
<div class="ttc" id="group__SymmetryLists_html_ga050b1e97c030678ee4033ade569fc960"><div class="ttname"><a href="group__SymmetryLists.html#ga050b1e97c030678ee4033ade569fc960">pg_O</a></div><div class="ttdeci">#define pg_O</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2symmetries_8h_source.html#l00085">symmetries.h:85</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab2f64c1f4965d352ef274ebbd0addb1f"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab2f64c1f4965d352ef274ebbd0addb1f">MDL_SAMPLINGRATE_Z</a></div><div class="ttdoc">sampling rate in A/pixel (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00383">metadata_label.h:383</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="projection_8cpp_html_ab17807a5400b7a54607c87513d0edf80"><div class="ttname"><a href="projection_8cpp.html#ab17807a5400b7a54607c87513d0edf80">xDim</a></div><div class="ttdeci">#define xDim</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l00033">projection.cpp:33</a></div></div>
<div class="ttc" id="classUnitCell_html_a31e92e72477a7518f03c37faf7d600ce"><div class="ttname"><a href="classUnitCell.html#a31e92e72477a7518f03c37faf7d600ce">UnitCell::UnitCell</a></div><div class="ttdeci">UnitCell(String sym, double rmin, double rmax, double expanded, double offset, double sampling, double x_origin, double y_origin, double z_origin)</div><div class="ttdef"><b>Definition:</b> <a href="unitCell_8cpp_source.html#l00087">unitCell.cpp:87</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad919bbce6f061400a0bc5231a9cd1621"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a></div><div class="ttdeci">static double * y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08506">numerical_recipes.cpp:8506</a></div></div>
<div class="ttc" id="group__SymmetryLists_html_gacd290bd088451d573299020abe17526a"><div class="ttname"><a href="group__SymmetryLists.html#gacd290bd088451d573299020abe17526a">pg_I3</a></div><div class="ttdeci">#define pg_I3</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2symmetries_8h_source.html#l00092">symmetries.h:92</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8caf6673fdc30d0b6f4a529cb1f4e3ab"><div class="ttname"><a href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a></div><div class="ttdeci">Matrix1D&lt; double &gt; vectorR3(double x, double y, double z)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8cpp_source.html#l00036">matrix1d.cpp:36</a></div></div>
<div class="ttc" id="classSymList_html_aa13b2960281c3a24dc3dd811cf69060e"><div class="ttname"><a href="classSymList.html#aa13b2960281c3a24dc3dd811cf69060e">SymList::isSymmetryGroup</a></div><div class="ttdeci">bool isSymmetryGroup(FileName fn_sym, int &amp;pgGroup, int &amp;pgOrder)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2symmetries_8cpp_source.html#l01547">symmetries.cpp:1547</a></div></div>
<div class="ttc" id="classUnitCell_html_aa38f3fe7d2e6c2a5543f4b30c694ec64"><div class="ttname"><a href="classUnitCell.html#aa38f3fe7d2e6c2a5543f4b30c694ec64">UnitCell::doTetrahedral</a></div><div class="ttdeci">void doTetrahedral(int symmetry=pg_T)</div><div class="ttdef"><b>Definition:</b> <a href="unitCell_8cpp_source.html#l00036">unitCell.cpp:36</a></div></div>
<div class="ttc" id="group__Macros_html_ga4912c64aec0c943b7985db6cb61ff83a"><div class="ttname"><a href="group__Macros.html#ga4912c64aec0c943b7985db6cb61ff83a">TWOPI</a></div><div class="ttdeci">#define TWOPI</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00111">xmipp_macros.h:111</a></div></div>
<div class="ttc" id="group__Images_html_gga22f7d7ee058354c030d2b52a8f190543afda1463ca408cc79db492465781b3269"><div class="ttname"><a href="group__Images.html#gga22f7d7ee058354c030d2b52a8f190543afda1463ca408cc79db492465781b3269">_DATA_ALL</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00084">xmipp_image_base.h:84</a></div></div>
<div class="ttc" id="classMatrix1D_html_a4afb1b4e8a8132a53b985e5fa7da6e30"><div class="ttname"><a href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">Matrix1D::selfNormalize</a></div><div class="ttdeci">void selfNormalize()</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01595">matrix1d.h:1595</a></div></div>
<div class="ttc" id="group__Vectors_html_ga4bdee25c828ee43970e047b304c7dd20"><div class="ttname"><a href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a></div><div class="ttdeci">Matrix1D&lt; T &gt; vectorProduct(const Matrix1D&lt; T &gt; &amp;v1, const Matrix1D&lt; T &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01842">matrix1d.h:1842</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a09e91db5e17c6781c7207ba2aa26ddb3"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a09e91db5e17c6781c7207ba2aa26ddb3">MDL_ORIGIN_X</a></div><div class="ttdoc">auxiliary label to be used as an index (long) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00310">metadata_label.h:310</a></div></div>
<div class="ttc" id="classUnitCell_html_ab136e40c962e0c7c2da765cc60228242"><div class="ttname"><a href="classUnitCell.html#ab136e40c962e0c7c2da765cc60228242">UnitCell::doCyclic</a></div><div class="ttdeci">void doCyclic(int order=1)</div><div class="ttdef"><b>Definition:</b> <a href="unitCell_8cpp_source.html#l00012">unitCell.cpp:12</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="unitCell_8cpp_html_a359543e7eaa41c97697967cbb7e24be3"><div class="ttname"><a href="unitCell_8cpp.html#a359543e7eaa41c97697967cbb7e24be3">tg60</a></div><div class="ttdeci">#define tg60</div><div class="ttdef"><b>Definition:</b> <a href="unitCell_8cpp_source.html#l00005">unitCell.cpp:5</a></div></div>
<div class="ttc" id="group__SymmetryLists_html_ga4a20daff060d6ef0dd683c5069dd04f5"><div class="ttname"><a href="group__SymmetryLists.html#ga4a20daff060d6ef0dd683c5069dd04f5">pg_I4</a></div><div class="ttdeci">#define pg_I4</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2symmetries_8h_source.html#l00093">symmetries.h:93</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a9f954d5f5402aa3e24d96406b24f27a7"><div class="ttname"><a href="numerical__recipes_8cpp.html#a9f954d5f5402aa3e24d96406b24f27a7">v1</a></div><div class="ttdeci">double v1</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l06229">numerical_recipes.cpp:6229</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a0784622a8bba995ca9861f9385cd02b9"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a0784622a8bba995ca9861f9385cd02b9">MDL_ORIGIN_Y</a></div><div class="ttdoc">Origin for the image in the Y axis (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00311">metadata_label.h:311</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa99ae519fb00e32cc6e716cc01d21cadf"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa99ae519fb00e32cc6e716cc01d21cadf">ERR_ARG_INCORRECT</a></div><div class="ttdoc">Incorrect argument received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00118">xmipp_error.h:118</a></div></div>
<div class="ttc" id="group__SymmetryLists_html_ga930edf6b18af8f7e83289d07e61d4682"><div class="ttname"><a href="group__SymmetryLists.html#ga930edf6b18af8f7e83289d07e61d4682">pg_I1</a></div><div class="ttdeci">#define pg_I1</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2symmetries_8h_source.html#l00090">symmetries.h:90</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_ac5474a01d203d14c046620266b2f1954"><div class="ttname"><a href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">max</a></div><div class="ttdeci">void max(Image&lt; double &gt; &amp;op1, const Image&lt; double &gt; &amp;op2)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00125">image_operate.cpp:125</a></div></div>
<div class="ttc" id="group__Datatypes_html_ggad8ed01ff3ff33333d8e19db4d2818bb6ab46fe84e5b6cba8683d95faf71dccc6f"><div class="ttname"><a href="group__Datatypes.html#ggad8ed01ff3ff33333d8e19db4d2818bb6ab46fe84e5b6cba8683d95faf71dccc6f">DT_Float</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__datatype_8h_source.html#l00049">xmipp_datatype.h:49</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aa508e3dbd0e86258b5c69e8a8b6b8295"><div class="ttname"><a href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08509">numerical_recipes.cpp:8509</a></div></div>
<div class="ttc" id="unitCell_8cpp_html_a7d1eba56fef5e364c82de0f9df48f547"><div class="ttname"><a href="unitCell_8cpp.html#a7d1eba56fef5e364c82de0f9df48f547">sin60</a></div><div class="ttdeci">#define sin60</div><div class="ttdef"><b>Definition:</b> <a href="unitCell_8cpp_source.html#l00006">unitCell.cpp:6</a></div></div>
<div class="ttc" id="classUnitCell_html_a96b0e74aa75814ab30430e7025f5d653"><div class="ttname"><a href="classUnitCell.html#a96b0e74aa75814ab30430e7025f5d653">UnitCell::doIcosahedral</a></div><div class="ttdeci">void doIcosahedral(int symmetry=pg_I1)</div><div class="ttdef"><b>Definition:</b> <a href="unitCell_8cpp_source.html#l00060">unitCell.cpp:60</a></div></div>
<div class="ttc" id="classImageGeneric_html_a3db6ca0bb5eaafa6fbea69f8d83d04a8"><div class="ttname"><a href="classImageGeneric.html#a3db6ca0bb5eaafa6fbea69f8d83d04a8">ImageGeneric::image</a></div><div class="ttdeci">ImageBase * image</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__generic_8h_source.html#l00051">xmipp_image_generic.h:51</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga716fb5264cf9c19edb101df0741af79a"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga716fb5264cf9c19edb101df0741af79a">mod</a></div><div class="ttdeci">void mod(const MultidimArray&lt; T &gt; &amp;x, MultidimArray&lt; T &gt; &amp;m, double y)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05620">multidim_array.h:5620</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classUnitCell_html_ab0c75627e2b78cf715b1912e3dee97fe"><div class="ttname"><a href="classUnitCell.html#ab0c75627e2b78cf715b1912e3dee97fe">UnitCell::doDihedral</a></div><div class="ttdeci">void doDihedral(int order=1)</div><div class="ttdef"><b>Definition:</b> <a href="unitCell_8cpp_source.html#l00024">unitCell.cpp:24</a></div></div>
<div class="ttc" id="group__SymmetryLists_html_ga727206ac0df28216494359a5ce37f528"><div class="ttname"><a href="group__SymmetryLists.html#ga727206ac0df28216494359a5ce37f528">pg_CN</a></div><div class="ttdeci">#define pg_CN</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2symmetries_8h_source.html#l00075">symmetries.h:75</a></div></div>
<div class="ttc" id="classMDRow_html_a916bbf19ab9a48f400800160b9b581fa"><div class="ttname"><a href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">MDRow::setValue</a></div><div class="ttdeci">void setValue(MDLabel label, const T &amp;d, bool addLabel=true)</div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l01168">metadata_label.h:1168</a></div></div>
<div class="ttc" id="classImageGeneric_html"><div class="ttname"><a href="classImageGeneric.html">ImageGeneric</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__generic_8h_source.html#l00047">xmipp_image_generic.h:47</a></div></div>
<div class="ttc" id="classImageGeneric_html_a8af1dcbf4fba0a168f370b3be8e33302"><div class="ttname"><a href="classImageGeneric.html#a8af1dcbf4fba0a168f370b3be8e33302">ImageGeneric::getDimensions</a></div><div class="ttdeci">void getDimensions(size_t &amp;Xdim, size_t &amp;Ydim, size_t &amp;Zdim, size_t &amp;Ndim) const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__generic_8cpp_source.html#l00097">xmipp_image_generic.cpp:97</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classImageGeneric_html_a5eea0cb97735bbb00ad33280b7afa3f4"><div class="ttname"><a href="classImageGeneric.html#a5eea0cb97735bbb00ad33280b7afa3f4">ImageGeneric::setDatatype</a></div><div class="ttdeci">void setDatatype(DataType _datatype)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__generic_8cpp_source.html#l00112">xmipp_image_generic.cpp:112</a></div></div>
<div class="ttc" id="classUnitCell_html_a2f419b55566972b3a1abe9a057fc578d"><div class="ttname"><a href="classUnitCell.html#a2f419b55566972b3a1abe9a057fc578d">UnitCell::maskUnitCell</a></div><div class="ttdeci">void maskUnitCell(ImageGeneric &amp;in3DDmap, ImageGeneric &amp;out3DDmap)</div><div class="ttdef"><b>Definition:</b> <a href="unitCell_8cpp_source.html#l00567">unitCell.cpp:567</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_ga5d2bc77c327154906885f1ebedc8d787"><div class="ttname"><a href="group__Vectors.html#ga5d2bc77c327154906885f1ebedc8d787">dotProduct</a></div><div class="ttdeci">T dotProduct(const Matrix1D&lt; T &gt; &amp;v1, const Matrix1D&lt; T &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01817">matrix1d.h:1817</a></div></div>
<div class="ttc" id="xmipp__strings_8h_html_afbeda3fd1bdc8c37d01bdf9f5c8274ff"><div class="ttname"><a href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a></div><div class="ttdeci">std::string String</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__strings_8h_source.html#l00034">xmipp_strings.h:34</a></div></div>
<div class="ttc" id="group__SymmetryLists_html_gaae2c66149cb20fe0313c7bd526f80e81"><div class="ttname"><a href="group__SymmetryLists.html#gaae2c66149cb20fe0313c7bd526f80e81">pg_I2</a></div><div class="ttdeci">#define pg_I2</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2symmetries_8h_source.html#l00091">symmetries.h:91</a></div></div>
<div class="ttc" id="classMultidimArrayGeneric_html_ab25ff6ccf1ea0ad997f0d63ef3fcf616"><div class="ttname"><a href="classMultidimArrayGeneric.html#ab25ff6ccf1ea0ad997f0d63ef3fcf616">MultidimArrayGeneric::im</a></div><div class="ttdeci">MultidimArrayBase * im</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00111">multidim_array_generic.h:111</a></div></div>
<div class="ttc" id="classMDRow_html"><div class="ttname"><a href="classMDRow.html">MDRow</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l01087">metadata_label.h:1087</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a5ecf92c764218ad8557f08079bb931a6"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a5ecf92c764218ad8557f08079bb931a6">MDL_ORIGIN_Z</a></div><div class="ttdoc">Origin for the image in the Z axis (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00312">metadata_label.h:312</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_ab7a69dabaa7151dae4d7a3998167e2f3"><div class="ttname"><a href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a></div><div class="ttdeci">float r2</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00051">image_find_center.cpp:51</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a8eb6f9afe59b4924d42d1ea2002148e7"><div class="ttname"><a href="numerical__recipes_8cpp.html#a8eb6f9afe59b4924d42d1ea2002148e7">v0</a></div><div class="ttdeci">double v0</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l06229">numerical_recipes.cpp:6229</a></div></div>
<div class="ttc" id="classImageGeneric_html_a820218a1a3b4d806736efacd2a23ebd3"><div class="ttname"><a href="classImageGeneric.html#a820218a1a3b4d806736efacd2a23ebd3">ImageGeneric::data</a></div><div class="ttdeci">MultidimArrayGeneric * data</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__generic_8h_source.html#l00053">xmipp_image_generic.h:53</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af2a333b1670df64a88d3a2f22210d155"><div class="ttname"><a href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a></div><div class="ttdeci">doublereal * a</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="classImageBase_html_ae144d3ee9a3ab388af441c0c561752fc"><div class="ttname"><a href="classImageBase.html#ae144d3ee9a3ab388af441c0c561752fc">ImageBase::setGeo</a></div><div class="ttdeci">void setGeo(const MDRow &amp;row, size_t n=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00175">xmipp_image_base.cpp:175</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
