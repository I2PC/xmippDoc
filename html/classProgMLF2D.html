<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Xmipp: ProgMLF2D Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classProgMLF2D-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ProgMLF2D Class Reference<div class="ingroups"><a class="el" href="group__MLFalign2D.html">mlf_align2d (Maximum likelihood in 2D in Fourier space)</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for ProgMLF2D:</div>
<div class="dyncontent">
<div class="center"><img src="classProgMLF2D__inherit__graph.png" border="0" usemap="#ProgMLF2D_inherit__map" alt="Inheritance graph"/></div>
<map name="ProgMLF2D_inherit__map" id="ProgMLF2D_inherit__map">
<area shape="rect" id="node4" href="classMpiProgMLF2D.html" title="MpiProgMLF2D" alt="" coords="17,229,130,256"/>
<area shape="rect" id="node2" href="classML2DBaseProgram.html" title="ML2DBaseProgram" alt="" coords="5,80,141,107"/>
<area shape="rect" id="node3" href="classXmippProgram.html" title="XmippProgram" alt="" coords="19,5,127,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for ProgMLF2D:</div>
<div class="dyncontent">
<div class="center"><img src="classProgMLF2D__coll__graph.png" border="0" usemap="#ProgMLF2D_coll__map" alt="Collaboration graph"/></div>
<map name="ProgMLF2D_coll__map" id="ProgMLF2D_coll__map">
<area shape="rect" id="node2" href="classML2DBaseProgram.html" title="ML2DBaseProgram" alt="" coords="458,541,594,568"/>
<area shape="rect" id="node3" href="classXmippProgram.html" title="XmippProgram" alt="" coords="209,355,317,382"/>
<area shape="rect" id="node4" href="classProgramDef.html" title="ProgramDef" alt="" coords="171,199,263,225"/>
<area shape="rect" id="node5" href="classASTNode.html" title="ASTNode" alt="" coords="56,95,135,121"/>
<area shape="rect" id="node6" href="classArgToken.html" title="ArgToken" alt="" coords="5,5,84,32"/>
<area shape="rect" id="node7" href="classArgLexer.html" title="ArgLexer" alt="" coords="109,5,183,32"/>
<area shape="rect" id="node8" href="classCommentList.html" title="CommentList" alt="" coords="224,95,324,121"/>
<area shape="rect" id="node9" href="classMetaData.html" title="MetaData" alt="" coords="369,355,448,382"/>
<area shape="rect" id="node10" href="classMDSql.html" title="MDSql" alt="" coords="287,199,349,225"/>
<area shape="rect" id="node11" href="classFileName.html" title="FileName" alt="" coords="416,199,495,225"/>
<area shape="rect" id="node13" href="classModelML2D.html" title="ModelML2D" alt="" coords="583,355,675,382"/>
<area shape="rect" id="node14" href="classMultidimArray.html" title="MultidimArray\&lt; double \&gt;" alt="" coords="699,355,863,382"/>
<area shape="rect" id="node17" href="classHistogram1D.html" title="Histogram1D" alt="" coords="735,541,834,568"/>
<area shape="rect" id="node15" href="classMultidimArrayBase.html" title="MultidimArrayBase" alt="" coords="804,199,936,225"/>
<area shape="rect" id="node16" href="classMultidimArray.html" title="MultidimArray\&lt; size_t \&gt;" alt="" coords="815,475,976,501"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab5a95eba9e0cc4105b7911601f4aa350"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#ab5a95eba9e0cc4105b7911601f4aa350">ProgMLF2D</a> (int <a class="el" href="classProgMLF2D.html#ac45e6bbd1a035e75dc4f9bdb5b775ae0">nr_vols</a>=0, int <a class="el" href="classProgMLF2D.html#aba28a0ffa831626698f137197c961017">rank</a>=0, int <a class="el" href="classProgMLF2D.html#a5399db01ffd31021ae8f1c8ab983eabb">size</a>=1)</td></tr>
<tr class="separator:ab5a95eba9e0cc4105b7911601f4aa350"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56d9638f6555e0a4793920b45283bc83"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a56d9638f6555e0a4793920b45283bc83">defineParams</a> ()</td></tr>
<tr class="memdesc:a56d9638f6555e0a4793920b45283bc83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Params definition.  <a href="#a56d9638f6555e0a4793920b45283bc83">More...</a><br /></td></tr>
<tr class="separator:a56d9638f6555e0a4793920b45283bc83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa07ffb6df1a5e91b43ea7786cd0717f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#aa07ffb6df1a5e91b43ea7786cd0717f5">readParams</a> ()</td></tr>
<tr class="memdesc:aa07ffb6df1a5e91b43ea7786cd0717f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read arguments from command line.  <a href="#aa07ffb6df1a5e91b43ea7786cd0717f5">More...</a><br /></td></tr>
<tr class="separator:aa07ffb6df1a5e91b43ea7786cd0717f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cbbdebbb1328f32dabd4cf3a36d289a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a7cbbdebbb1328f32dabd4cf3a36d289a">show</a> (bool ML3D=false)</td></tr>
<tr class="memdesc:a7cbbdebbb1328f32dabd4cf3a36d289a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Show.  <a href="#a7cbbdebbb1328f32dabd4cf3a36d289a">More...</a><br /></td></tr>
<tr class="separator:a7cbbdebbb1328f32dabd4cf3a36d289a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e0a9b2281fc0e33fc0af350514c893b"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a5e0a9b2281fc0e33fc0af350514c893b">produceSideInfo</a> ()</td></tr>
<tr class="memdesc:a5e0a9b2281fc0e33fc0af350514c893b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup lots of stuff.  <a href="#a5e0a9b2281fc0e33fc0af350514c893b">More...</a><br /></td></tr>
<tr class="separator:a5e0a9b2281fc0e33fc0af350514c893b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04ca5ccf66605a78474081363ac48581"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a04ca5ccf66605a78474081363ac48581">produceSideInfo2</a> ()</td></tr>
<tr class="separator:a04ca5ccf66605a78474081363ac48581"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66a03b0afd064ec89a5aa3f4b574d51f"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a66a03b0afd064ec89a5aa3f4b574d51f">defineBasicParams</a> (<a class="el" href="classXmippProgram.html">XmippProgram</a> *<a class="el" href="transform__dimred_8cpp.html#ac5f3f903d13fe800dff02116591db85e">prog</a>)</td></tr>
<tr class="memdesc:a66a03b0afd064ec89a5aa3f4b574d51f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Some redefinitions of the basic and additional params.  <a href="#a66a03b0afd064ec89a5aa3f4b574d51f">More...</a><br /></td></tr>
<tr class="separator:a66a03b0afd064ec89a5aa3f4b574d51f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89129c2b58a8ab4da944706d4da109d0"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a89129c2b58a8ab4da944706d4da109d0">defineAdditionalParams</a> (<a class="el" href="classXmippProgram.html">XmippProgram</a> *<a class="el" href="transform__dimred_8cpp.html#ac5f3f903d13fe800dff02116591db85e">prog</a>, const char *sectionLine)</td></tr>
<tr class="separator:a89129c2b58a8ab4da944706d4da109d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b3ad1500cc0fff4024cc23ce3c2b192"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a8b3ad1500cc0fff4024cc23ce3c2b192">estimateInitialNoiseSpectra</a> ()</td></tr>
<tr class="separator:a8b3ad1500cc0fff4024cc23ce3c2b192"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1a1724f969e8cfca5c84d766366dd7b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#ab1a1724f969e8cfca5c84d766366dd7b">updateWienerFilters</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;<a class="el" href="classML2DBaseProgram.html#add43d72480811707dcaa89df00324f42">spectral_signal</a>, std::vector&lt; double &gt; &amp;<a class="el" href="classProgMLF2D.html#a9c42feb7d8cbf224f91e903bac49663e">sumw_defocus</a>, int <a class="el" href="classML2DBaseProgram.html#a20e2b948711e3e66894740b99e8cf017">iter</a>)</td></tr>
<tr class="separator:ab1a1724f969e8cfca5c84d766366dd7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a501c85d59b6f2dc691f93c2afde6455f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a501c85d59b6f2dc691f93c2afde6455f">setCurrentSamplingRates</a> (double current_probres_limit)</td></tr>
<tr class="memdesc:a501c85d59b6f2dc691f93c2afde6455f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vary in-plane and translational sampling rates with resolution.  <a href="#a501c85d59b6f2dc691f93c2afde6455f">More...</a><br /></td></tr>
<tr class="separator:a501c85d59b6f2dc691f93c2afde6455f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41a5836d1f8b6fcac9f20d447263bf13"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a41a5836d1f8b6fcac9f20d447263bf13">generateInitialReferences</a> ()</td></tr>
<tr class="memdesc:a41a5836d1f8b6fcac9f20d447263bf13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate initial references from random subset averages.  <a href="#a41a5836d1f8b6fcac9f20d447263bf13">More...</a><br /></td></tr>
<tr class="separator:a41a5836d1f8b6fcac9f20d447263bf13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf2dca554cdb8f87793b36dedf8e744a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#aaf2dca554cdb8f87793b36dedf8e744a">calculatePdfInplane</a> ()</td></tr>
<tr class="memdesc:aaf2dca554cdb8f87793b36dedf8e744a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate probability density distribution for in-plane transformations.  <a href="#aaf2dca554cdb8f87793b36dedf8e744a">More...</a><br /></td></tr>
<tr class="separator:aaf2dca554cdb8f87793b36dedf8e744a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab88b1c3d37f23eb7ef079f2535136780"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#ab88b1c3d37f23eb7ef079f2535136780">appendFTtoVector</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;Fin, std::vector&lt; double &gt; &amp;out)</td></tr>
<tr class="separator:ab88b1c3d37f23eb7ef079f2535136780"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae249382ce2eb9eb7d6fc5b547041805d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#ae249382ce2eb9eb7d6fc5b547041805d">getFTfromVector</a> (const std::vector&lt; double &gt; &amp;<a class="el" href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a>, const int start_point, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;out, bool only_real=false)</td></tr>
<tr class="separator:ae249382ce2eb9eb7d6fc5b547041805d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4518fb4fdc375d19d4439d32a6a60d71"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a4518fb4fdc375d19d4439d32a6a60d71">rotateReference</a> (std::vector&lt; double &gt; &amp;out)</td></tr>
<tr class="memdesc:a4518fb4fdc375d19d4439d32a6a60d71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill vector of matrices with all rotations of reference.  <a href="#a4518fb4fdc375d19d4439d32a6a60d71">More...</a><br /></td></tr>
<tr class="separator:a4518fb4fdc375d19d4439d32a6a60d71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a191c8f337bb393b5c8ea9d45e1e7b1a6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a191c8f337bb393b5c8ea9d45e1e7b1a6">reverseRotateReference</a> (const std::vector&lt; double &gt; &amp;<a class="el" href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a>, std::vector&lt; <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &gt; &amp;out)</td></tr>
<tr class="memdesc:a191c8f337bb393b5c8ea9d45e1e7b1a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply reverse rotations to all matrices in vector and fill new matrix with their sum.  <a href="#a191c8f337bb393b5c8ea9d45e1e7b1a6">More...</a><br /></td></tr>
<tr class="separator:a191c8f337bb393b5c8ea9d45e1e7b1a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2c6d5b3598c2851c1919661965cee74"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#ae2c6d5b3598c2851c1919661965cee74">preselectDirections</a> (float &amp;phi, float &amp;<a class="el" href="numerical__recipes_8cpp.html#aca81c35c21e3a5f7f3a8d24504e76664">theta</a>, std::vector&lt; double &gt; &amp;pdf_directions)</td></tr>
<tr class="separator:ae2c6d5b3598c2851c1919661965cee74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae091bc27292e881bb2fcb6c9e96903f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#ae091bc27292e881bb2fcb6c9e96903f8">preselect_significant_model_phi</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Mimg, std::vector&lt; double &gt; &amp;offsets, std::vector&lt; std::vector&lt; <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &gt; &gt; &amp;Mref, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;Msignificant, std::vector&lt; double &gt; &amp;pdf_directions)</td></tr>
<tr class="separator:ae091bc27292e881bb2fcb6c9e96903f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab887549eff44d4b6ff4209effc176a39"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#ab887549eff44d4b6ff4209effc176a39">fourierTranslate2D</a> (const std::vector&lt; double &gt; &amp;<a class="el" href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a>, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;trans, std::vector&lt; double &gt; &amp;out, int point_start=0)</td></tr>
<tr class="separator:ab887549eff44d4b6ff4209effc176a39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86d435aa562ed8f627734219a54f9fbc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a86d435aa562ed8f627734219a54f9fbc">calculateFourierOffsets</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Mimg, const std::vector&lt; double &gt; &amp;offsets, std::vector&lt; double &gt; &amp;out, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;Moffsets, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;Moffsets_mirror)</td></tr>
<tr class="separator:a86d435aa562ed8f627734219a54f9fbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d77accb6928b8ef9febe0cc57883c28"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a9d77accb6928b8ef9febe0cc57883c28">processOneImage</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Mimg, size_t focus, bool apply_ctf, double &amp;fracweight, double &amp;maxweight2, double &amp;sum_refw2, double &amp;opt_scale, size_t &amp;opt_refno, double &amp;opt_psi, size_t &amp;opt_ipsi, size_t &amp;opt_iflip, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;opt_offsets, std::vector&lt; double &gt; &amp;opt_offsets_ref, std::vector&lt; double &gt; &amp;pdf_directions, bool <a class="el" href="classProgMLF2D.html#a79873ba6ac0a02ebff149285475a8721">do_kstest</a>, bool write_histograms, <a class="el" href="classFileName.html">FileName</a> <a class="el" href="classML2DBaseProgram.html#a4e593a9112ddcc0256bc9b72213cdb3b">fn_img</a>, double &amp;KSprob)</td></tr>
<tr class="memdesc:a9d77accb6928b8ef9febe0cc57883c28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform expectation step for a single image.  <a href="#a9d77accb6928b8ef9febe0cc57883c28">More...</a><br /></td></tr>
<tr class="separator:a9d77accb6928b8ef9febe0cc57883c28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68e996f0ddb68cbe68e8964fffdb635b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a68e996f0ddb68cbe68e8964fffdb635b">performKSTest</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Mimg, const int focus, bool apply_ctf, <a class="el" href="classFileName.html">FileName</a> &amp;<a class="el" href="classML2DBaseProgram.html#a4e593a9112ddcc0256bc9b72213cdb3b">fn_img</a>, bool write_histogram, std::vector&lt; std::vector&lt; <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &gt; &gt; &amp;<a class="el" href="classProgMLF2D.html#a3e59aa87465a609828f311a1b40f0ea9">Fref</a>, double &amp;opt_scale, int &amp;opt_refno, int &amp;opt_ipsi, int &amp;opt_iflip, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;opt_offsets)</td></tr>
<tr class="memdesc:a68e996f0ddb68cbe68e8964fffdb635b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform Kolmogorov-Smirnov test.  <a href="#a68e996f0ddb68cbe68e8964fffdb635b">More...</a><br /></td></tr>
<tr class="separator:a68e996f0ddb68cbe68e8964fffdb635b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca8831df4147241ec146bdea4ed1ac02"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#aca8831df4147241ec146bdea4ed1ac02">iteration</a> ()</td></tr>
<tr class="memdesc:aca8831df4147241ec146bdea4ed1ac02"><td class="mdescLeft">&#160;</td><td class="mdescRight">One iteration of the process.  <a href="#aca8831df4147241ec146bdea4ed1ac02">More...</a><br /></td></tr>
<tr class="separator:aca8831df4147241ec146bdea4ed1ac02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8d02bc5f161f68226d359e166dad892"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#ab8d02bc5f161f68226d359e166dad892">expectation</a> ()</td></tr>
<tr class="memdesc:ab8d02bc5f161f68226d359e166dad892"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integrate over all experimental images.  <a href="#ab8d02bc5f161f68226d359e166dad892">More...</a><br /></td></tr>
<tr class="separator:ab8d02bc5f161f68226d359e166dad892"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0f72ba394c61a95823a1d49955da873"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#aa0f72ba394c61a95823a1d49955da873">maximization</a> ()</td></tr>
<tr class="memdesc:aa0f72ba394c61a95823a1d49955da873"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update all model parameters (maximization step)  <a href="#aa0f72ba394c61a95823a1d49955da873">More...</a><br /></td></tr>
<tr class="separator:aa0f72ba394c61a95823a1d49955da873"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c7260c6653450b23777354e70d7f8d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a7c7260c6653450b23777354e70d7f8d0">endIteration</a> ()</td></tr>
<tr class="memdesc:a7c7260c6653450b23777354e70d7f8d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Redefine endIteration to update Wiener filters.  <a href="#a7c7260c6653450b23777354e70d7f8d0">More...</a><br /></td></tr>
<tr class="separator:a7c7260c6653450b23777354e70d7f8d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52205b353efd0a5130f3a8506409b7f2"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a52205b353efd0a5130f3a8506409b7f2">writeOutputFiles</a> (const <a class="el" href="classModelML2D.html">ModelML2D</a> &amp;<a class="el" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>, <a class="el" href="ml2d_8h.html#a4e0517338e6c4a31a2addafc06d4f3a3">OutputType</a> outputType)</td></tr>
<tr class="memdesc:a52205b353efd0a5130f3a8506409b7f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write out reference images, selfile and logfile.  <a href="#a52205b353efd0a5130f3a8506409b7f2">More...</a><br /></td></tr>
<tr class="separator:a52205b353efd0a5130f3a8506409b7f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8540e7e059c7bc46e2a010d25225d08b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a8540e7e059c7bc46e2a010d25225d08b">writeNoiseFile</a> (const <a class="el" href="classFileName.html">FileName</a> &amp;fn_base, int ifocus)</td></tr>
<tr class="memdesc:a8540e7e059c7bc46e2a010d25225d08b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write noise estimation per resolution.  <a href="#a8540e7e059c7bc46e2a010d25225d08b">More...</a><br /></td></tr>
<tr class="separator:a8540e7e059c7bc46e2a010d25225d08b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a860bbd97c3343ad108328fac98a3f2f3"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a860bbd97c3343ad108328fac98a3f2f3">addPartialDocfileData</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;data, size_t <a class="el" href="example_8cpp.html#a848f440bf07226576d4e883f552bec25">first</a>, size_t last)</td></tr>
<tr class="memdesc:a860bbd97c3343ad108328fac98a3f2f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add docfiledata to docfile.  <a href="#a860bbd97c3343ad108328fac98a3f2f3">More...</a><br /></td></tr>
<tr class="separator:a860bbd97c3343ad108328fac98a3f2f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classML2DBaseProgram"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classML2DBaseProgram')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classML2DBaseProgram.html">ML2DBaseProgram</a></td></tr>
<tr class="memitem:a08dc75912c3b5bf4be88e88a81cf23fa inherit pub_methods_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a08dc75912c3b5bf4be88e88a81cf23fa">initSamplingStuff</a> ()</td></tr>
<tr class="separator:a08dc75912c3b5bf4be88e88a81cf23fa inherit pub_methods_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af472ba552a45c063d2eef8395503e690 inherit pub_methods_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#af472ba552a45c063d2eef8395503e690">ML2DBaseProgram</a> ()</td></tr>
<tr class="separator:af472ba552a45c063d2eef8395503e690 inherit pub_methods_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a950eaf7e71168d33294c20a7b3efa94b inherit pub_methods_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a950eaf7e71168d33294c20a7b3efa94b">setNumberOfLocalImages</a> ()</td></tr>
<tr class="memdesc:a950eaf7e71168d33294c20a7b3efa94b inherit pub_methods_classML2DBaseProgram"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the number of images, this function is useful only for MPI.  <a href="#a950eaf7e71168d33294c20a7b3efa94b">More...</a><br /></td></tr>
<tr class="separator:a950eaf7e71168d33294c20a7b3efa94b inherit pub_methods_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9a692726fabc472f521d3e6ecaf432d inherit pub_methods_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#af9a692726fabc472f521d3e6ecaf432d">randomizeImagesOrder</a> ()</td></tr>
<tr class="memdesc:af9a692726fabc472f521d3e6ecaf432d inherit pub_methods_classML2DBaseProgram"><td class="mdescLeft">&#160;</td><td class="mdescRight">Randomize initial images order, only once.  <a href="#af9a692726fabc472f521d3e6ecaf432d">More...</a><br /></td></tr>
<tr class="separator:af9a692726fabc472f521d3e6ecaf432d inherit pub_methods_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a729101ca5a561dc8e697f8a3698faac0 inherit pub_methods_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a729101ca5a561dc8e697f8a3698faac0">createThreads</a> ()</td></tr>
<tr class="memdesc:a729101ca5a561dc8e697f8a3698faac0 inherit pub_methods_classML2DBaseProgram"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create working threads.  <a href="#a729101ca5a561dc8e697f8a3698faac0">More...</a><br /></td></tr>
<tr class="separator:a729101ca5a561dc8e697f8a3698faac0 inherit pub_methods_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9086e5c476a75fd659b247e0720f8483 inherit pub_methods_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a9086e5c476a75fd659b247e0720f8483">destroyThreads</a> ()</td></tr>
<tr class="memdesc:a9086e5c476a75fd659b247e0720f8483 inherit pub_methods_classML2DBaseProgram"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exit threads and free memory.  <a href="#a9086e5c476a75fd659b247e0720f8483">More...</a><br /></td></tr>
<tr class="separator:a9086e5c476a75fd659b247e0720f8483 inherit pub_methods_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a057ec249b6f0c9aac33c29bd0e314ab7 inherit pub_methods_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a057ec249b6f0c9aac33c29bd0e314ab7">checkConvergence</a> ()</td></tr>
<tr class="separator:a057ec249b6f0c9aac33c29bd0e314ab7 inherit pub_methods_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae264ff00d210804b766ed14445bf1015 inherit pub_methods_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#ae264ff00d210804b766ed14445bf1015">run</a> ()</td></tr>
<tr class="memdesc:ae264ff00d210804b766ed14445bf1015 inherit pub_methods_classML2DBaseProgram"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main function of the program.  <a href="#ae264ff00d210804b766ed14445bf1015">More...</a><br /></td></tr>
<tr class="separator:ae264ff00d210804b766ed14445bf1015 inherit pub_methods_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bfd3f7250efeda01483917e5382b857 inherit pub_methods_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a5bfd3f7250efeda01483917e5382b857">defineHiddenParams</a> (<a class="el" href="classXmippProgram.html">XmippProgram</a> *<a class="el" href="transform__dimred_8cpp.html#ac5f3f903d13fe800dff02116591db85e">prog</a>)</td></tr>
<tr class="separator:a5bfd3f7250efeda01483917e5382b857 inherit pub_methods_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classXmippProgram"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classXmippProgram')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classXmippProgram.html">XmippProgram</a></td></tr>
<tr class="memitem:a5d9e1f008822effa47814c59e9a3c797 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a5d9e1f008822effa47814c59e9a3c797">getParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, int arg=0)</td></tr>
<tr class="separator:a5d9e1f008822effa47814c59e9a3c797 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8e51e73a487e0d53408dc84ebbe6655 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#af8e51e73a487e0d53408dc84ebbe6655">getParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, const char *subparam, int arg=0)</td></tr>
<tr class="separator:af8e51e73a487e0d53408dc84ebbe6655 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b7ddf0836dc1079ea2622e2a420c39c inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, int arg=0)</td></tr>
<tr class="separator:a7b7ddf0836dc1079ea2622e2a420c39c inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1da1a25db76959a3e747d0ebd34512a4 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a1da1a25db76959a3e747d0ebd34512a4">getIntParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, const char *subparam, int arg=0)</td></tr>
<tr class="separator:a1da1a25db76959a3e747d0ebd34512a4 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a552e1ea4a84576d9149b965d9edb6277 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, int arg=0)</td></tr>
<tr class="separator:a552e1ea4a84576d9149b965d9edb6277 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4becd069f9a9fefe06cbdd60e238db5 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aa4becd069f9a9fefe06cbdd60e238db5">getDoubleParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, const char *subparam, int arg=0)</td></tr>
<tr class="separator:aa4becd069f9a9fefe06cbdd60e238db5 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f7511fbf474a4752f9a472138b64089 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a6f7511fbf474a4752f9a472138b64089">getListParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, <a class="el" href="argsparser_8h.html#ab7db7f89faba290ac54cc52f052795e7">StringVector</a> &amp;list)</td></tr>
<tr class="separator:a6f7511fbf474a4752f9a472138b64089 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9deab8bd129383d08e390ff15c185c62 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a9deab8bd129383d08e390ff15c185c62">getCountParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>)</td></tr>
<tr class="separator:a9deab8bd129383d08e390ff15c185c62 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a27c450de95c55d122be23e3fe89ac1 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>)</td></tr>
<tr class="separator:a1a27c450de95c55d122be23e3fe89ac1 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a9e74a9350dd6211fa0d287c347585a inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a8a9e74a9350dd6211fa0d287c347585a">existsParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>)</td></tr>
<tr class="separator:a8a9e74a9350dd6211fa0d287c347585a inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaeb37f0bac83f5d2a605aaa0e5c4b6ef inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a> (const <a class="el" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a> &amp;line)</td></tr>
<tr class="separator:aaeb37f0bac83f5d2a605aaa0e5c4b6ef inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ce43fdc0dd88cfbd4010a0f77b57d5e inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a8ce43fdc0dd88cfbd4010a0f77b57d5e">addParamsLine</a> (const char *line)</td></tr>
<tr class="separator:a8ce43fdc0dd88cfbd4010a0f77b57d5e inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40382f7972fd7a38486dafe620dca4dd inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classParamDef.html">ParamDef</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a40382f7972fd7a38486dafe620dca4dd">getParamDef</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>) const </td></tr>
<tr class="separator:a40382f7972fd7a38486dafe620dca4dd inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60458fab67fea34afe85b76f63435dcc inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a60458fab67fea34afe85b76f63435dcc">quit</a> (int exit_code=0) const </td></tr>
<tr class="separator:a60458fab67fea34afe85b76f63435dcc inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d0f9381e3828497ca4ee651bba15d9b inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a3d0f9381e3828497ca4ee651bba15d9b">tryRun</a> ()</td></tr>
<tr class="separator:a3d0f9381e3828497ca4ee651bba15d9b inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea0549c1e40215ee12b1abc36648b39a inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aea0549c1e40215ee12b1abc36648b39a">initProgress</a> (size_t total, size_t stepBin=60)</td></tr>
<tr class="separator:aea0549c1e40215ee12b1abc36648b39a inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a074c10cbbaa660749bbc2778592a54c4 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a074c10cbbaa660749bbc2778592a54c4">setProgress</a> (size_t value=0)</td></tr>
<tr class="separator:a074c10cbbaa660749bbc2778592a54c4 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef9f1a6f495c898cb12eac9a7922a84c inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aef9f1a6f495c898cb12eac9a7922a84c">endProgress</a> ()</td></tr>
<tr class="separator:aef9f1a6f495c898cb12eac9a7922a84c inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a0f62b1fe4af78a41e2f9ffe7725962 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a7a0f62b1fe4af78a41e2f9ffe7725962">processDefaultComment</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, const char *left)</td></tr>
<tr class="separator:a7a0f62b1fe4af78a41e2f9ffe7725962 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a439ac2830d63f9e58578203fafaacc10 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a439ac2830d63f9e58578203fafaacc10">setDefaultComment</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, const char *comment)</td></tr>
<tr class="separator:a439ac2830d63f9e58578203fafaacc10 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e88782ecb59e921f041389b71b1183f inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a3e88782ecb59e921f041389b71b1183f">initComments</a> ()</td></tr>
<tr class="separator:a3e88782ecb59e921f041389b71b1183f inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e98654ef7fc47806d345b619b7779d9 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a3e98654ef7fc47806d345b619b7779d9">setProgramName</a> (const char *<a class="el" href="classXmippProgram.html#a1589c976748620757957d494599b6de2">name</a>)</td></tr>
<tr class="separator:a3e98654ef7fc47806d345b619b7779d9 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f396af57519ec443b4656176eb962bf inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a4f396af57519ec443b4656176eb962bf">addUsageLine</a> (const char *line, bool verbatim=false)</td></tr>
<tr class="separator:a4f396af57519ec443b4656176eb962bf inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9df4b765a93997c2505c42f457040a2b inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a9df4b765a93997c2505c42f457040a2b">clearUsage</a> ()</td></tr>
<tr class="separator:a9df4b765a93997c2505c42f457040a2b inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b8f0a6e1bd09e4dbf56a412101e905e inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a4b8f0a6e1bd09e4dbf56a412101e905e">addExampleLine</a> (const char *example, bool verbatim=true)</td></tr>
<tr class="separator:a4b8f0a6e1bd09e4dbf56a412101e905e inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78cb844dedc5e8f4de8320c9a7c8d0a2 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a78cb844dedc5e8f4de8320c9a7c8d0a2">addSeeAlsoLine</a> (const char *seeAlso)</td></tr>
<tr class="separator:a78cb844dedc5e8f4de8320c9a7c8d0a2 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd4adc575f113cb61b3e4bb7bc5106b3 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#afd4adc575f113cb61b3e4bb7bc5106b3">addKeywords</a> (const char *keywords)</td></tr>
<tr class="separator:afd4adc575f113cb61b3e4bb7bc5106b3 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1589c976748620757957d494599b6de2 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a1589c976748620757957d494599b6de2">name</a> () const </td></tr>
<tr class="separator:a1589c976748620757957d494599b6de2 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6eb019dcb9970f1f70678a7bbb3fdaf inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aa6eb019dcb9970f1f70678a7bbb3fdaf">usage</a> (int verb=0) const </td></tr>
<tr class="separator:aa6eb019dcb9970f1f70678a7bbb3fdaf inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53b6cbca94fdb35a012e9a57083a697e inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a53b6cbca94fdb35a012e9a57083a697e">usage</a> (const <a class="el" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a> &amp;<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, int verb=2)</td></tr>
<tr class="separator:a53b6cbca94fdb35a012e9a57083a697e inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2aef2b56d6b0c9bc33a4701ca7d6236d inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a2aef2b56d6b0c9bc33a4701ca7d6236d">version</a> () const </td></tr>
<tr class="separator:a2aef2b56d6b0c9bc33a4701ca7d6236d inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b0644621f62746e36bd7dac7067379b inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a7b0644621f62746e36bd7dac7067379b">show</a> () const </td></tr>
<tr class="separator:a7b0644621f62746e36bd7dac7067379b inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4eff3704eab2b7a94a89185e22f89512 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a4eff3704eab2b7a94a89185e22f89512">read</a> (int <a class="el" href="classXmippProgram.html#a8659f9e603143c1788360f0eeb01e589">argc</a>, const char **<a class="el" href="classXmippProgram.html#af2f60708934c302e1289c5405109dd45">argv</a>, bool reportErrors=true)</td></tr>
<tr class="separator:a4eff3704eab2b7a94a89185e22f89512 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a78239155c382a83b6bc4bbbccbe16c inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a8a78239155c382a83b6bc4bbbccbe16c">read</a> (int <a class="el" href="classXmippProgram.html#a8659f9e603143c1788360f0eeb01e589">argc</a>, char **<a class="el" href="classXmippProgram.html#af2f60708934c302e1289c5405109dd45">argv</a>, bool reportErrors=true)</td></tr>
<tr class="separator:a8a78239155c382a83b6bc4bbbccbe16c inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2afcfd93fe372b575850fc7f526b4f1 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#ae2afcfd93fe372b575850fc7f526b4f1">read</a> (const <a class="el" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a> &amp;argumentsLine)</td></tr>
<tr class="separator:ae2afcfd93fe372b575850fc7f526b4f1 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd42916af00d9ef6222399828349b581 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#abd42916af00d9ef6222399828349b581">XmippProgram</a> ()</td></tr>
<tr class="separator:abd42916af00d9ef6222399828349b581 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f90137c4d1bf8be6bae657e2a880a38 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a8f90137c4d1bf8be6bae657e2a880a38">XmippProgram</a> (int <a class="el" href="classXmippProgram.html#a8659f9e603143c1788360f0eeb01e589">argc</a>, const char **<a class="el" href="classXmippProgram.html#af2f60708934c302e1289c5405109dd45">argv</a>)</td></tr>
<tr class="separator:a8f90137c4d1bf8be6bae657e2a880a38 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b3035afffe42adb8c76518d4d53225b inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a3b3035afffe42adb8c76518d4d53225b">~XmippProgram</a> ()</td></tr>
<tr class="separator:a3b3035afffe42adb8c76518d4d53225b inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a0177d3113415179168699efda64bd860"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a0177d3113415179168699efda64bd860">sigma_offset</a></td></tr>
<tr class="separator:a0177d3113415179168699efda64bd860"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cf09cc5d8c9949acc48438be868773c"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a0cf09cc5d8c9949acc48438be868773c">alpha_k</a></td></tr>
<tr class="separator:a0cf09cc5d8c9949acc48438be868773c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a619e2aed7d1934de3ce40d04b4d160b3"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a619e2aed7d1934de3ce40d04b4d160b3">mirror_fraction</a></td></tr>
<tr class="separator:a619e2aed7d1934de3ce40d04b4d160b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a373f1965ed767abbf1d5b3e53104623b"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a373f1965ed767abbf1d5b3e53104623b">max_nr_psi</a></td></tr>
<tr class="separator:a373f1965ed767abbf1d5b3e53104623b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac06a02372d68274fa8fb58dab620db9a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#ac06a02372d68274fa8fb58dab620db9a">do_variable_psi</a></td></tr>
<tr class="separator:ac06a02372d68274fa8fb58dab620db9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef9b9f1aff83b4d111cf2a8be84d4c07"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#aef9b9f1aff83b4d111cf2a8be84d4c07">do_variable_trans</a></td></tr>
<tr class="separator:aef9b9f1aff83b4d111cf2a8be84d4c07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe2d74f54f4aa6916eb6f6d29164e023"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classImage.html">Image</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#abe2d74f54f4aa6916eb6f6d29164e023">Ictf</a></td></tr>
<tr class="separator:abe2d74f54f4aa6916eb6f6d29164e023"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada357d6508ec414e1203b029816fa3ad"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#ada357d6508ec414e1203b029816fa3ad">limit_trans</a></td></tr>
<tr class="separator:ada357d6508ec414e1203b029816fa3ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f05f45301557f3c0a855a414b87b5fd"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a1f05f45301557f3c0a855a414b87b5fd">nr_trans</a></td></tr>
<tr class="separator:a1f05f45301557f3c0a855a414b87b5fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adec8e47d0ada48f2aea2259ca1b400cf"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#adec8e47d0ada48f2aea2259ca1b400cf">zero_trans</a></td></tr>
<tr class="separator:adec8e47d0ada48f2aea2259ca1b400cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13f69696df08368a14b8928b60faaad7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a13f69696df08368a14b8928b60faaad7">search_shift</a></td></tr>
<tr class="separator:a13f69696df08368a14b8928b60faaad7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1de58371deea621eafdb71373065de80"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a1de58371deea621eafdb71373065de80">offsets_keepdir</a></td></tr>
<tr class="separator:a1de58371deea621eafdb71373065de80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c3f7c47054265ad3589ee6d40764fbc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">do_ctf_correction</a></td></tr>
<tr class="separator:a7c3f7c47054265ad3589ee6d40764fbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1176823dd265484796aa9b52215719e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a></td></tr>
<tr class="separator:af1176823dd265484796aa9b52215719e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c75192acc215ccf8e062881d14f9ac4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a5c75192acc215ccf8e062881d14f9ac4">count_defocus</a></td></tr>
<tr class="separator:a5c75192acc215ccf8e062881d14f9ac4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c504b96e173e1eeb6cda09a00e5b638"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a9c504b96e173e1eeb6cda09a00e5b638">phase_flipped</a></td></tr>
<tr class="separator:a9c504b96e173e1eeb6cda09a00e5b638"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78ef99a6261c8c228ca1bab9f0c2205a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a78ef99a6261c8c228ca1bab9f0c2205a">Mresol_int</a></td></tr>
<tr class="separator:a78ef99a6261c8c228ca1bab9f0c2205a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aad5b0a7bb75420f63794660d636454"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a5aad5b0a7bb75420f63794660d636454">Vsig</a></td></tr>
<tr class="separator:a5aad5b0a7bb75420f63794660d636454"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeacca439f42dea963c5997d589f419a4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#aeacca439f42dea963c5997d589f419a4">Vctf</a></td></tr>
<tr class="separator:aeacca439f42dea963c5997d589f419a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83eda37039c3fc321091307e24dc60fa"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a83eda37039c3fc321091307e24dc60fa">Vdec</a></td></tr>
<tr class="separator:a83eda37039c3fc321091307e24dc60fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19dbbebd916d67da0d3e0ce5c9d77993"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a19dbbebd916d67da0d3e0ce5c9d77993">reduce_snr</a></td></tr>
<tr class="separator:a19dbbebd916d67da0d3e0ce5c9d77993"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e08de076e12e519d59f5e39854f1dc5"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a7e08de076e12e519d59f5e39854f1dc5">nr_focus</a></td></tr>
<tr class="separator:a7e08de076e12e519d59f5e39854f1dc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c5751afdfd3fe27554492356c09a58c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a0c5751afdfd3fe27554492356c09a58c">lowres_limit</a></td></tr>
<tr class="separator:a0c5751afdfd3fe27554492356c09a58c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27f1ed8b93ea62c3e3727f7fa57f41b8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a27f1ed8b93ea62c3e3727f7fa57f41b8">highres_limit</a></td></tr>
<tr class="separator:a27f1ed8b93ea62c3e3727f7fa57f41b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a552a32e4f5ff63eda3ffa4708eef6f67"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a552a32e4f5ff63eda3ffa4708eef6f67">ini_highres_limit</a></td></tr>
<tr class="separator:a552a32e4f5ff63eda3ffa4708eef6f67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e967d6a01f0dcdce99c62e591bb7995"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a5e967d6a01f0dcdce99c62e591bb7995">first_iter_noctf</a></td></tr>
<tr class="separator:a5e967d6a01f0dcdce99c62e591bb7995"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67e4c76098a1309d855c2649ed148b85"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a67e4c76098a1309d855c2649ed148b85">do_divide_ctf</a></td></tr>
<tr class="separator:a67e4c76098a1309d855c2649ed148b85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33a7368df74c02b48043acaed12b3ce7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a33a7368df74c02b48043acaed12b3ce7">do_include_allfreqs</a></td></tr>
<tr class="separator:a33a7368df74c02b48043acaed12b3ce7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77ca59aeaa398779a7f562940d1363a2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a77ca59aeaa398779a7f562940d1363a2">fix_high</a></td></tr>
<tr class="separator:a77ca59aeaa398779a7f562940d1363a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26c5a01345ef85eaabf6056c0f76f848"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a26c5a01345ef85eaabf6056c0f76f848">pointer_2d</a></td></tr>
<tr class="separator:a26c5a01345ef85eaabf6056c0f76f848"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae34810925acecb7d097272aae20cf26b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#ae34810925acecb7d097272aae20cf26b">pointer_i</a></td></tr>
<tr class="separator:ae34810925acecb7d097272aae20cf26b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0756608605967a063784669478c62bf"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#ac0756608605967a063784669478c62bf">pointer_j</a></td></tr>
<tr class="separator:ac0756608605967a063784669478c62bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a963f62304538d74f796a3d20475480ee"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a963f62304538d74f796a3d20475480ee">nr_points_prob</a></td></tr>
<tr class="separator:a963f62304538d74f796a3d20475480ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7f2b4639397c6f14e13371207476c06"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">nr_points_2d</a></td></tr>
<tr class="separator:af7f2b4639397c6f14e13371207476c06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2839dd97c6d6098e665b16bed661b615"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a2839dd97c6d6098e665b16bed661b615">dnr_points_2d</a></td></tr>
<tr class="separator:a2839dd97c6d6098e665b16bed661b615"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca3a507abbae9720e21b774955fccdb6"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#aca3a507abbae9720e21b774955fccdb6">current_highres_limit</a></td></tr>
<tr class="separator:aca3a507abbae9720e21b774955fccdb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8402eab40b0e66cd7aee78b747720af9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a></td></tr>
<tr class="memdesc:a8402eab40b0e66cd7aee78b747720af9"><td class="mdescLeft">&#160;</td><td class="mdescRight">IN DEVELOPMENT.  <a href="#a8402eab40b0e66cd7aee78b747720af9">More...</a><br /></td></tr>
<tr class="separator:a8402eab40b0e66cd7aee78b747720af9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad176d8656485e60ed725b2754a070aa"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#aad176d8656485e60ed725b2754a070aa">do_student_sigma_trick</a></td></tr>
<tr class="separator:aad176d8656485e60ed725b2754a070aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79873ba6ac0a02ebff149285475a8721"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a79873ba6ac0a02ebff149285475a8721">do_kstest</a></td></tr>
<tr class="memdesc:a79873ba6ac0a02ebff149285475a8721"><td class="mdescLeft">&#160;</td><td class="mdescRight">Statistical analysis of the noise distributions.  <a href="#a79873ba6ac0a02ebff149285475a8721">More...</a><br /></td></tr>
<tr class="separator:a79873ba6ac0a02ebff149285475a8721"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bd3c9e0f12cfa45daa109e0c96c3f28"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a1bd3c9e0f12cfa45daa109e0c96c3f28">iter_write_histograms</a></td></tr>
<tr class="separator:a1bd3c9e0f12cfa45daa109e0c96c3f28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4876f30a8c1b41ead612a89de1f3eed0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classHistogram1D.html">Histogram1D</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a4876f30a8c1b41ead612a89de1f3eed0">sumhist</a></td></tr>
<tr class="separator:a4876f30a8c1b41ead612a89de1f3eed0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff8593015f02560e8e3e85ebd86ba894"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classHistogram1D.html">Histogram1D</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#aff8593015f02560e8e3e85ebd86ba894">resolhist</a></td></tr>
<tr class="separator:aff8593015f02560e8e3e85ebd86ba894"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fd51100d35db6ecdcb3ac704ab58435"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a2fd51100d35db6ecdcb3ac704ab58435">refs_avgscale</a></td></tr>
<tr class="separator:a2fd51100d35db6ecdcb3ac704ab58435"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba28a0ffa831626698f137197c961017"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#aba28a0ffa831626698f137197c961017">rank</a></td></tr>
<tr class="separator:aba28a0ffa831626698f137197c961017"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5399db01ffd31021ae8f1c8ab983eabb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a5399db01ffd31021ae8f1c8ab983eabb">size</a></td></tr>
<tr class="separator:a5399db01ffd31021ae8f1c8ab983eabb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac45e6bbd1a035e75dc4f9bdb5b775ae0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#ac45e6bbd1a035e75dc4f9bdb5b775ae0">nr_vols</a></td></tr>
<tr class="separator:ac45e6bbd1a035e75dc4f9bdb5b775ae0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62bd5315721add5edf8b74e19c7d2de8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a62bd5315721add5edf8b74e19c7d2de8">LL</a></td></tr>
<tr class="separator:a62bd5315721add5edf8b74e19c7d2de8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc9875f9cb5025678bebb8eff54a1118"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#abc9875f9cb5025678bebb8eff54a1118">sumcorr</a></td></tr>
<tr class="separator:abc9875f9cb5025678bebb8eff54a1118"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae311e353866c6ac035c8f795ee2e1a6b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#ae311e353866c6ac035c8f795ee2e1a6b">wsum_sigma_offset</a></td></tr>
<tr class="separator:ae311e353866c6ac035c8f795ee2e1a6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01e5f8b55632ee6d8263827376051807"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a01e5f8b55632ee6d8263827376051807">sumw_allrefs</a></td></tr>
<tr class="separator:a01e5f8b55632ee6d8263827376051807"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b5bd8fb49b6864cdfcba9779bb163d2"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a7b5bd8fb49b6864cdfcba9779bb163d2">wsum_Mref</a></td></tr>
<tr class="separator:a7b5bd8fb49b6864cdfcba9779bb163d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7126f012ef6183355f71114a35f7149f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a7126f012ef6183355f71114a35f7149f">wsum_ctfMref</a></td></tr>
<tr class="separator:a7126f012ef6183355f71114a35f7149f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af78a059d07b955ccd42e8a17ef827d19"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#af78a059d07b955ccd42e8a17ef827d19">Mwsum_sigma2</a></td></tr>
<tr class="separator:af78a059d07b955ccd42e8a17ef827d19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a90a0680ddfe59efa8bac1303fada63"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a0a90a0680ddfe59efa8bac1303fada63">sumw</a></td></tr>
<tr class="separator:a0a90a0680ddfe59efa8bac1303fada63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07e1e912286ab9303da3d4a654d26dd6"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a07e1e912286ab9303da3d4a654d26dd6">sumw2</a></td></tr>
<tr class="separator:a07e1e912286ab9303da3d4a654d26dd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92faef343a74868a005e5de666778470"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a92faef343a74868a005e5de666778470">sumwsc</a></td></tr>
<tr class="separator:a92faef343a74868a005e5de666778470"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab34721b1edbfbb6b3feb83c1aa825166"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#ab34721b1edbfbb6b3feb83c1aa825166">sumwsc2</a></td></tr>
<tr class="separator:ab34721b1edbfbb6b3feb83c1aa825166"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86adb43015401e250b579f9d49f00730"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a86adb43015401e250b579f9d49f00730">sumw_mirror</a></td></tr>
<tr class="separator:a86adb43015401e250b579f9d49f00730"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c42feb7d8cbf224f91e903bac49663e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a9c42feb7d8cbf224f91e903bac49663e">sumw_defocus</a></td></tr>
<tr class="separator:a9c42feb7d8cbf224f91e903bac49663e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e59aa87465a609828f311a1b40f0ea9"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a3e59aa87465a609828f311a1b40f0ea9">Fref</a></td></tr>
<tr class="separator:a3e59aa87465a609828f311a1b40f0ea9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b8e2ceb24d15d08f35c4549b1bef95a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#a0b8e2ceb24d15d08f35c4549b1bef95a">Fwsum_imgs</a></td></tr>
<tr class="separator:a0b8e2ceb24d15d08f35c4549b1bef95a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff2c6db0108d1ef849c88221a1506ef8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMLF2D.html#aff2c6db0108d1ef849c88221a1506ef8">Fwsum_ctfimgs</a></td></tr>
<tr class="separator:aff2c6db0108d1ef849c88221a1506ef8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_attribs_classML2DBaseProgram"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_classML2DBaseProgram')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="classML2DBaseProgram.html">ML2DBaseProgram</a></td></tr>
<tr class="memitem:a4e593a9112ddcc0256bc9b72213cdb3b inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFileName.html">FileName</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a4e593a9112ddcc0256bc9b72213cdb3b">fn_img</a></td></tr>
<tr class="separator:a4e593a9112ddcc0256bc9b72213cdb3b inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9544695d9d0054d6e75d62f227bee889 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFileName.html">FileName</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a9544695d9d0054d6e75d62f227bee889">fn_ref</a></td></tr>
<tr class="separator:a9544695d9d0054d6e75d62f227bee889 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfab8933f95443ac6d909a9b206b3fa8 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFileName.html">FileName</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#adfab8933f95443ac6d909a9b206b3fa8">fn_root</a></td></tr>
<tr class="separator:adfab8933f95443ac6d909a9b206b3fa8 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf6ec880b915a0887a9e0a864c3ff467 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFileName.html">FileName</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#abf6ec880b915a0887a9e0a864c3ff467">fn_frac</a></td></tr>
<tr class="separator:abf6ec880b915a0887a9e0a864c3ff467 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa94d2fe0d51e3c000bdc710dcc92654b inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFileName.html">FileName</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#aa94d2fe0d51e3c000bdc710dcc92654b">fn_sig</a></td></tr>
<tr class="separator:aa94d2fe0d51e3c000bdc710dcc92654b inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bbcbc7d5a34c9c53193a54f5f3d3d40 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFileName.html">FileName</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a5bbcbc7d5a34c9c53193a54f5f3d3d40">fn_doc</a></td></tr>
<tr class="separator:a5bbcbc7d5a34c9c53193a54f5f3d3d40 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a726be1cdd8572074646a8c9df1eb81f5 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFileName.html">FileName</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a726be1cdd8572074646a8c9df1eb81f5">fn_oext</a></td></tr>
<tr class="separator:a726be1cdd8572074646a8c9df1eb81f5 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b904ff65f4ee4b5bbcfd31f79753b5f inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFileName.html">FileName</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a1b904ff65f4ee4b5bbcfd31f79753b5f">fn_scratch</a></td></tr>
<tr class="separator:a1b904ff65f4ee4b5bbcfd31f79753b5f inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed01125c198740cd73e9f450320389ca inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFileName.html">FileName</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#aed01125c198740cd73e9f450320389ca">fn_control</a></td></tr>
<tr class="separator:aed01125c198740cd73e9f450320389ca inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62698e9d68c10fa72db6deb1d3fc6794 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a62698e9d68c10fa72db6deb1d3fc6794">cline</a></td></tr>
<tr class="separator:a62698e9d68c10fa72db6deb1d3fc6794 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9b9535e1774d805e5bbee89dee0f4b5 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#ad9b9535e1774d805e5bbee89dee0f4b5">do_mirror</a></td></tr>
<tr class="separator:ad9b9535e1774d805e5bbee89dee0f4b5 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f89b87041906702ae5c30638bd2762c inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a6f89b87041906702ae5c30638bd2762c">fix_fractions</a></td></tr>
<tr class="separator:a6f89b87041906702ae5c30638bd2762c inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c0fde6f9005eec528cc1f703019719c inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a3c0fde6f9005eec528cc1f703019719c">fix_sigma_offset</a></td></tr>
<tr class="separator:a3c0fde6f9005eec528cc1f703019719c inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4646a8113c64d86101389cb4f373bca3 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a4646a8113c64d86101389cb4f373bca3">fix_sigma_noise</a></td></tr>
<tr class="separator:a4646a8113c64d86101389cb4f373bca3 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a495926025de4de5360efd7266377cc2c inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a495926025de4de5360efd7266377cc2c">istart</a></td></tr>
<tr class="separator:a495926025de4de5360efd7266377cc2c inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20e2b948711e3e66894740b99e8cf017 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a20e2b948711e3e66894740b99e8cf017">iter</a></td></tr>
<tr class="separator:a20e2b948711e3e66894740b99e8cf017 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a027f02ad68a63785c0ef49fa1b9db759 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a027f02ad68a63785c0ef49fa1b9db759">Niter</a></td></tr>
<tr class="separator:a027f02ad68a63785c0ef49fa1b9db759 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae96de19117479eb8bf594268bb9af590 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a></td></tr>
<tr class="separator:ae96de19117479eb8bf594268bb9af590 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a997e2be4af206a96283a2f73cfacdcfe inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a997e2be4af206a96283a2f73cfacdcfe">dim2</a></td></tr>
<tr class="separator:a997e2be4af206a96283a2f73cfacdcfe inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90e6ce499655b4566e17e32102a905c4 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">hdim</a></td></tr>
<tr class="separator:a90e6ce499655b4566e17e32102a905c4 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a790a55bd210ce856bfbbd8853c6789df inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a790a55bd210ce856bfbbd8853c6789df">ddim2</a></td></tr>
<tr class="separator:a790a55bd210ce856bfbbd8853c6789df inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a976dc404489a0c66af2800f0f73e76c7 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a976dc404489a0c66af2800f0f73e76c7">nr_psi</a></td></tr>
<tr class="separator:a976dc404489a0c66af2800f0f73e76c7 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a715ad0eb7ac0ce476faf1623fedea1a8 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a715ad0eb7ac0ce476faf1623fedea1a8">nr_flip</a></td></tr>
<tr class="separator:a715ad0eb7ac0ce476faf1623fedea1a8 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae259850c9b209a3ff3cbcc7799e2742 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#aae259850c9b209a3ff3cbcc7799e2742">psi_step</a></td></tr>
<tr class="separator:aae259850c9b209a3ff3cbcc7799e2742 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ab21717291173f3155a2e4006137167 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a2ab21717291173f3155a2e4006137167">psi_max</a></td></tr>
<tr class="separator:a2ab21717291173f3155a2e4006137167 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe104a9ef312f6d857b008188e5dfbea inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a></td></tr>
<tr class="separator:abe104a9ef312f6d857b008188e5dfbea inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55332f697c74f72635ae850439407645 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a55332f697c74f72635ae850439407645">nr_images_global</a></td></tr>
<tr class="separator:a55332f697c74f72635ae850439407645 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac53bad3c2339d92ebbda4ba5abe7aa57 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#ac53bad3c2339d92ebbda4ba5abe7aa57">nr_images_local</a></td></tr>
<tr class="separator:ac53bad3c2339d92ebbda4ba5abe7aa57 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a791b7cb014db4297f7772becd1daa287 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a791b7cb014db4297f7772becd1daa287">myFirstImg</a></td></tr>
<tr class="separator:a791b7cb014db4297f7772becd1daa287 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c0b6cb5428a40ae95864f5c45c50940 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a3c0b6cb5428a40ae95864f5c45c50940">myLastImg</a></td></tr>
<tr class="separator:a3c0b6cb5428a40ae95864f5c45c50940 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a909478a47c338d181693f9421ecb4bd3 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a909478a47c338d181693f9421ecb4bd3">eps</a></td></tr>
<tr class="separator:a909478a47c338d181693f9421ecb4bd3 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a080fbf81a2b9dfceab4cfe1a649f13a4 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMetaData.html">MetaData</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a></td></tr>
<tr class="separator:a080fbf81a2b9dfceab4cfe1a649f13a4 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62caa148ed1109af0cf324ffec9ff2cd inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMetaData.html">MetaData</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">MDref</a></td></tr>
<tr class="separator:a62caa148ed1109af0cf324ffec9ff2cd inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d67b88d67e821d1e17965fe83afefb9 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMetaData.html">MetaData</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a6d67b88d67e821d1e17965fe83afefb9">MDlog</a></td></tr>
<tr class="separator:a6d67b88d67e821d1e17965fe83afefb9 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a879e423db0331279b0421e881b73be57 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a879e423db0331279b0421e881b73be57">F</a></td></tr>
<tr class="separator:a879e423db0331279b0421e881b73be57 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa53d160970e65511ba3f5d89db29b651 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classImage.html">Image</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#aa53d160970e65511ba3f5d89db29b651">Iold</a></td></tr>
<tr class="separator:aa53d160970e65511ba3f5d89db29b651 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f44905656bc9d5a5bb57dea399cd18e inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a6f44905656bc9d5a5bb57dea399cd18e">P_phi</a></td></tr>
<tr class="separator:a6f44905656bc9d5a5bb57dea399cd18e inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a394058da00920fa8e21edd9cf95cd49c inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a394058da00920fa8e21edd9cf95cd49c">Mr2</a></td></tr>
<tr class="separator:a394058da00920fa8e21edd9cf95cd49c inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47f7cd87d5f078979db61864b4f6d55f inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a47f7cd87d5f078979db61864b4f6d55f">fast_mode</a></td></tr>
<tr class="separator:a47f7cd87d5f078979db61864b4f6d55f inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67faef1c7bbe1544c7f51e4d4fa0e833 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a67faef1c7bbe1544c7f51e4d4fa0e833">C_fast</a></td></tr>
<tr class="separator:a67faef1c7bbe1544c7f51e4d4fa0e833 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2a82e39d73ee5d2911c6c9a95b9b54c inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">Vtrans</a></td></tr>
<tr class="separator:ad2a82e39d73ee5d2911c6c9a95b9b54c inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4ef26e8db432f9c366375915204f0d7 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#ab4ef26e8db432f9c366375915204f0d7">zero_offsets</a></td></tr>
<tr class="separator:ab4ef26e8db432f9c366375915204f0d7 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a549ca4cda193eb449087f9a316c61f20 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a549ca4cda193eb449087f9a316c61f20">limit_rot</a></td></tr>
<tr class="separator:a549ca4cda193eb449087f9a316c61f20 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ca3328df09f636935d22b5b946a3704 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a4ca3328df09f636935d22b5b946a3704">search_rot</a></td></tr>
<tr class="separator:a4ca3328df09f636935d22b5b946a3704 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad640e8275de5576531913f2e9ed1628d inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#ad640e8275de5576531913f2e9ed1628d">save_mem1</a></td></tr>
<tr class="separator:ad640e8275de5576531913f2e9ed1628d inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5597237821521e53baea8549f16a8d55 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a5597237821521e53baea8549f16a8d55">save_mem2</a></td></tr>
<tr class="separator:a5597237821521e53baea8549f16a8d55 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b27032485df9eb841f870fbde9096d7 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a4b27032485df9eb841f870fbde9096d7">save_mem3</a></td></tr>
<tr class="separator:a4b27032485df9eb841f870fbde9096d7 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d817d670cd567d427da30fad46f5592 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a2d817d670cd567d427da30fad46f5592">imgs_oldphi</a></td></tr>
<tr class="separator:a2d817d670cd567d427da30fad46f5592 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0d684b9bbe78bfa5ed5ad2610dc4fbe inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#ae0d684b9bbe78bfa5ed5ad2610dc4fbe">imgs_oldtheta</a></td></tr>
<tr class="separator:ae0d684b9bbe78bfa5ed5ad2610dc4fbe inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a963af5cdb6f63d876c147c24fbf8452e inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a963af5cdb6f63d876c147c24fbf8452e">do_ML3D</a></td></tr>
<tr class="separator:a963af5cdb6f63d876c147c24fbf8452e inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd93072cb690045eff13e91439461a6a inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#acd93072cb690045eff13e91439461a6a">do_generate_refs</a></td></tr>
<tr class="separator:acd93072cb690045eff13e91439461a6a inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb224115e7f853ead371caf7a3767fa4 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#adb224115e7f853ead371caf7a3767fa4">imgs_offsets</a></td></tr>
<tr class="separator:adb224115e7f853ead371caf7a3767fa4 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bff1f1ebc6ee583b1b6f4f2d55ec3ae inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a0bff1f1ebc6ee583b1b6f4f2d55ec3ae">trymindiff_factor</a></td></tr>
<tr class="separator:a0bff1f1ebc6ee583b1b6f4f2d55ec3ae inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8671946de2e241de54a47e2822989ca1 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a></td></tr>
<tr class="separator:a8671946de2e241de54a47e2822989ca1 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3106e12c5756e90d770df3708307258d inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a3106e12c5756e90d770df3708307258d">df2</a></td></tr>
<tr class="separator:a3106e12c5756e90d770df3708307258d inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3169a7f52fce4768757155f99b12fa84 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a3169a7f52fce4768757155f99b12fa84">dfsigma2</a></td></tr>
<tr class="separator:a3169a7f52fce4768757155f99b12fa84 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e143fabdc67d1ee8cd67dcad98e74fc inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">do_norm</a></td></tr>
<tr class="memdesc:a9e143fabdc67d1ee8cd67dcad98e74fc inherit pub_attribs_classML2DBaseProgram"><td class="mdescLeft">&#160;</td><td class="mdescRight">Re-normalize internally.  <a href="#a9e143fabdc67d1ee8cd67dcad98e74fc">More...</a><br /></td></tr>
<tr class="separator:a9e143fabdc67d1ee8cd67dcad98e74fc inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7caa861fcd7c5a139c0a0825c1abbe0 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#ab7caa861fcd7c5a139c0a0825c1abbe0">imgs_scale</a></td></tr>
<tr class="separator:ab7caa861fcd7c5a139c0a0825c1abbe0 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae32011b5a8251cbaaf3b5e28933b9806 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#ae32011b5a8251cbaaf3b5e28933b9806">imgs_bgmean</a></td></tr>
<tr class="separator:ae32011b5a8251cbaaf3b5e28933b9806 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf6efe79d6a17ff818c2f06d11e7b7b0 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#adf6efe79d6a17ff818c2f06d11e7b7b0">imgs_trymindiff</a></td></tr>
<tr class="separator:adf6efe79d6a17ff818c2f06d11e7b7b0 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d35db214957b6a4d00b411e8a63a554 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a2d35db214957b6a4d00b411e8a63a554">imgs_optrefno</a></td></tr>
<tr class="separator:a2d35db214957b6a4d00b411e8a63a554 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90f80f69b900eb15f9300560d50286ca inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a90f80f69b900eb15f9300560d50286ca">average_scale</a></td></tr>
<tr class="separator:a90f80f69b900eb15f9300560d50286ca inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4908e05cb99ce92314917225f524ac6c inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a4908e05cb99ce92314917225f524ac6c">factor_nref</a></td></tr>
<tr class="separator:a4908e05cb99ce92314917225f524ac6c inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e429b25f696eba0bb30a316517f0b31 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a1e429b25f696eba0bb30a316517f0b31">refs_per_class</a></td></tr>
<tr class="separator:a1e429b25f696eba0bb30a316517f0b31 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b21e31f64ae12053ef1192ef39e309e inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a3b21e31f64ae12053ef1192ef39e309e">conv</a></td></tr>
<tr class="separator:a3b21e31f64ae12053ef1192ef39e309e inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab31f295dfdeb52bada9f0ca819c8fb29 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#ab31f295dfdeb52bada9f0ca819c8fb29">current_image</a></td></tr>
<tr class="separator:ab31f295dfdeb52bada9f0ca819c8fb29 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5578230b3fb9e054c437e187cb0ad5d3 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classModelML2D.html">ModelML2D</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a></td></tr>
<tr class="separator:a5578230b3fb9e054c437e187cb0ad5d3 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c12505ee0c33a78803f661267d19653 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classModelML2D.html">ModelML2D</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a6c12505ee0c33a78803f661267d19653">current_model</a></td></tr>
<tr class="separator:a6c12505ee0c33a78803f661267d19653 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b0d716eb64a885e060bd3d380fe83be inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a7b0d716eb64a885e060bd3d380fe83be">blocks</a></td></tr>
<tr class="separator:a7b0d716eb64a885e060bd3d380fe83be inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3db6d60cc8179ba2a57c55cf7d5ba362 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a3db6d60cc8179ba2a57c55cf7d5ba362">current_block</a></td></tr>
<tr class="separator:a3db6d60cc8179ba2a57c55cf7d5ba362 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3464cb9938eb4cf849b7c8bbb354734f inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">std::vector&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a3464cb9938eb4cf849b7c8bbb354734f">img_id</a></td></tr>
<tr class="separator:a3464cb9938eb4cf849b7c8bbb354734f inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddfa227d1aec7fcfd31cb2c23ec3d0f inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a0ddfa227d1aec7fcfd31cb2c23ec3d0f">docfiledata</a></td></tr>
<tr class="separator:a0ddfa227d1aec7fcfd31cb2c23ec3d0f inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f7d61fca21cd29df3119a200b9a4bd3 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a4f7d61fca21cd29df3119a200b9a4bd3">do_restart</a></td></tr>
<tr class="separator:a4f7d61fca21cd29df3119a200b9a4bd3 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15bd38bb7846c62a5444aa2848600ca9 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a15bd38bb7846c62a5444aa2848600ca9">referenceExclusive</a></td></tr>
<tr class="separator:a15bd38bb7846c62a5444aa2848600ca9 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71cc9fe7fbc2eafdd6b5cfe1cfc3249c inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a71cc9fe7fbc2eafdd6b5cfe1cfc3249c">allowFastOption</a></td></tr>
<tr class="separator:a71cc9fe7fbc2eafdd6b5cfe1cfc3249c inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05a2478e8671e1ee60b7da076719f016 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a05a2478e8671e1ee60b7da076719f016">allowThreads</a></td></tr>
<tr class="separator:a05a2478e8671e1ee60b7da076719f016 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36d4c020f76461b5862cd1b09d53d9cb inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a36d4c020f76461b5862cd1b09d53d9cb">allowIEM</a></td></tr>
<tr class="separator:a36d4c020f76461b5862cd1b09d53d9cb inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00e959454e0727e58b9452cc1d5cfef1 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a00e959454e0727e58b9452cc1d5cfef1">allowRestart</a></td></tr>
<tr class="separator:a00e959454e0727e58b9452cc1d5cfef1 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a936f95ff82d7ac76db2dcba20c0c002f inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a936f95ff82d7ac76db2dcba20c0c002f">defaultRoot</a></td></tr>
<tr class="separator:a936f95ff82d7ac76db2dcba20c0c002f inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcb67ce21620584feb013d6da4494192 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#abcb67ce21620584feb013d6da4494192">defaultNiter</a></td></tr>
<tr class="separator:abcb67ce21620584feb013d6da4494192 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40caeda36f7442b06db84ef8e2dc6743 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#a40caeda36f7442b06db84ef8e2dc6743">defaultStartingIter</a></td></tr>
<tr class="separator:a40caeda36f7442b06db84ef8e2dc6743 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af249c63e39331ba0e4dfbcd39cafdce9 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#af249c63e39331ba0e4dfbcd39cafdce9">threads</a></td></tr>
<tr class="separator:af249c63e39331ba0e4dfbcd39cafdce9 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3eac3d0fb4000223088846bee6bcb0b inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#ac3eac3d0fb4000223088846bee6bcb0b">outRefsMd</a></td></tr>
<tr class="separator:ac3eac3d0fb4000223088846bee6bcb0b inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add43d72480811707dcaa89df00324f42 inherit pub_attribs_classML2DBaseProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classML2DBaseProgram.html#add43d72480811707dcaa89df00324f42">spectral_signal</a></td></tr>
<tr class="separator:add43d72480811707dcaa89df00324f42 inherit pub_attribs_classML2DBaseProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_attribs_classXmippProgram"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_classXmippProgram')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="classXmippProgram.html">XmippProgram</a></td></tr>
<tr class="memitem:ae829d20125d500b80d008ea4b9a0e0bd inherit pub_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#ae829d20125d500b80d008ea4b9a0e0bd">doRun</a></td></tr>
<tr class="separator:ae829d20125d500b80d008ea4b9a0e0bd inherit pub_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41ca5bb0bd76fd8319d3b44459da4bf9 inherit pub_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a41ca5bb0bd76fd8319d3b44459da4bf9">runWithoutArgs</a></td></tr>
<tr class="separator:a41ca5bb0bd76fd8319d3b44459da4bf9 inherit pub_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed62cfe3c074e69076bf348fc101a717 inherit pub_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a></td></tr>
<tr class="memdesc:aed62cfe3c074e69076bf348fc101a717 inherit pub_attribs_classXmippProgram"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verbosity level.  <a href="#aed62cfe3c074e69076bf348fc101a717">More...</a><br /></td></tr>
<tr class="separator:aed62cfe3c074e69076bf348fc101a717 inherit pub_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0130b89f1f5431b03ef161d7e231bd48 inherit pub_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a0130b89f1f5431b03ef161d7e231bd48">debug</a></td></tr>
<tr class="separator:a0130b89f1f5431b03ef161d7e231bd48 inherit pub_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51ae38ef10274f8f7c6c02ab2a67a28c inherit pub_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a51ae38ef10274f8f7c6c02ab2a67a28c">seed</a></td></tr>
<tr class="separator:a51ae38ef10274f8f7c6c02ab2a67a28c inherit pub_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classXmippProgram"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classXmippProgram')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classXmippProgram.html">XmippProgram</a></td></tr>
<tr class="memitem:a95f826fa543dafe9afee959919537f9b inherit pro_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a95f826fa543dafe9afee959919537f9b">defineCommons</a> ()</td></tr>
<tr class="separator:a95f826fa543dafe9afee959919537f9b inherit pro_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classXmippProgram"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classXmippProgram')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classXmippProgram.html">XmippProgram</a></td></tr>
<tr class="memitem:aa8d070e9454a1282137facadd3e45a35 inherit pro_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aa8d070e9454a1282137facadd3e45a35">errorCode</a></td></tr>
<tr class="separator:aa8d070e9454a1282137facadd3e45a35 inherit pro_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba95ed5693ab33d77ae4c184a36e8f61 inherit pro_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classProgramDef.html">ProgramDef</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aba95ed5693ab33d77ae4c184a36e8f61">progDef</a></td></tr>
<tr class="memdesc:aba95ed5693ab33d77ae4c184a36e8f61 inherit pro_attribs_classXmippProgram"><td class="mdescLeft">&#160;</td><td class="mdescRight">Program definition and arguments parser.  <a href="#aba95ed5693ab33d77ae4c184a36e8f61">More...</a><br /></td></tr>
<tr class="separator:aba95ed5693ab33d77ae4c184a36e8f61 inherit pro_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e187353c6a6f9e06d44bbeaa6e872ac inherit pro_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a>, <a class="el" href="classCommentList.html">CommentList</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a5e187353c6a6f9e06d44bbeaa6e872ac">defaultComments</a></td></tr>
<tr class="separator:a5e187353c6a6f9e06d44bbeaa6e872ac inherit pro_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8659f9e603143c1788360f0eeb01e589 inherit pro_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a8659f9e603143c1788360f0eeb01e589">argc</a></td></tr>
<tr class="memdesc:a8659f9e603143c1788360f0eeb01e589 inherit pro_attribs_classXmippProgram"><td class="mdescLeft">&#160;</td><td class="mdescRight">Original command line arguments.  <a href="#a8659f9e603143c1788360f0eeb01e589">More...</a><br /></td></tr>
<tr class="separator:a8659f9e603143c1788360f0eeb01e589 inherit pro_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2f60708934c302e1289c5405109dd45 inherit pro_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">const char **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#af2f60708934c302e1289c5405109dd45">argv</a></td></tr>
<tr class="separator:af2f60708934c302e1289c5405109dd45 inherit pro_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>MLFalign2D parameters. </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00070">70</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ab5a95eba9e0cc4105b7911601f4aa350"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ProgMLF2D::ProgMLF2D </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nr_vols</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rank</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor nr_vols: Used for 3D case, if 0, then doML3D = false rank and size are for MPI use </p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l00028">28</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a936f95ff82d7ac76db2dcba20c0c002f">defaultRoot</a> = <span class="stringliteral">&quot;mlf2d&quot;</span>;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#ac45e6bbd1a035e75dc4f9bdb5b775ae0">nr_vols</a> == 0)</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    {</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a963af5cdb6f63d876c147c24fbf8452e">do_ML3D</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        this-&gt;<a class="code" href="classProgMLF2D.html#ac45e6bbd1a035e75dc4f9bdb5b775ae0">nr_vols</a> = 1;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a1e429b25f696eba0bb30a316517f0b31">refs_per_class</a> = 1;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    }</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a963af5cdb6f63d876c147c24fbf8452e">do_ML3D</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    this-&gt;<a class="code" href="classProgMLF2D.html#aba28a0ffa831626698f137197c961017">rank</a> = <a class="code" href="classProgMLF2D.html#aba28a0ffa831626698f137197c961017">rank</a>;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    this-&gt;<a class="code" href="classProgMLF2D.html#a5399db01ffd31021ae8f1c8ab983eabb">size</a> = <a class="code" href="classProgMLF2D.html#a5399db01ffd31021ae8f1c8ab983eabb">size</a>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;}</div><div class="ttc" id="classML2DBaseProgram_html_a1e429b25f696eba0bb30a316517f0b31"><div class="ttname"><a href="classML2DBaseProgram.html#a1e429b25f696eba0bb30a316517f0b31">ML2DBaseProgram::refs_per_class</a></div><div class="ttdeci">int refs_per_class</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00217">ml2d.h:217</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a5399db01ffd31021ae8f1c8ab983eabb"><div class="ttname"><a href="classProgMLF2D.html#a5399db01ffd31021ae8f1c8ab983eabb">ProgMLF2D::size</a></div><div class="ttdeci">int size</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00150">mlf_align2d.h:150</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a936f95ff82d7ac76db2dcba20c0c002f"><div class="ttname"><a href="classML2DBaseProgram.html#a936f95ff82d7ac76db2dcba20c0c002f">ML2DBaseProgram::defaultRoot</a></div><div class="ttdeci">String defaultRoot</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00240">ml2d.h:240</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a963af5cdb6f63d876c147c24fbf8452e"><div class="ttname"><a href="classML2DBaseProgram.html#a963af5cdb6f63d876c147c24fbf8452e">ML2DBaseProgram::do_ML3D</a></div><div class="ttdeci">bool do_ML3D</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00196">ml2d.h:196</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ac45e6bbd1a035e75dc4f9bdb5b775ae0"><div class="ttname"><a href="classProgMLF2D.html#ac45e6bbd1a035e75dc4f9bdb5b775ae0">ProgMLF2D::nr_vols</a></div><div class="ttdeci">int nr_vols</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00150">mlf_align2d.h:150</a></div></div>
<div class="ttc" id="classProgMLF2D_html_aba28a0ffa831626698f137197c961017"><div class="ttname"><a href="classProgMLF2D.html#aba28a0ffa831626698f137197c961017">ProgMLF2D::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00150">mlf_align2d.h:150</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a860bbd97c3343ad108328fac98a3f2f3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::addPartialDocfileData </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>first</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>last</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add docfiledata to docfile. </p>

<p>Implements <a class="el" href="classML2DBaseProgram.html#ab48cc483bffc4a3c1805eff0dfe9de08">ML2DBaseProgram</a>.</p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l02866">2866</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;{</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;    <a class="code" href="xmipp__log_8h.html#a485ad250637a874aa112548b4133e8d0">LOG_LEVEL</a>(addPartialDocfile);</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imgno = <a class="code" href="numerical__recipes_8cpp.html#acaec38248b66cfba849985072bd311f6">first</a>; imgno &lt;= last; imgno++)</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    {</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;        <span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#ad2289c67cc7ca1c54d70d173b37d8820">index</a> = imgno - <a class="code" href="numerical__recipes_8cpp.html#acaec38248b66cfba849985072bd311f6">first</a>;</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;        <span class="keywordtype">size_t</span> <span class="keywordtype">id</span> = <a class="code" href="classML2DBaseProgram.html#a3464cb9938eb4cf849b7c8bbb354734f">img_id</a>[imgno];</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;        <span class="comment">//FIXME now directly to MDimg</span></div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a963af5cdb6f63d876c147c24fbf8452e">do_ML3D</a>)</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;        {</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a59fffce298c0f99a1d592544d3d39a08">MDL_ANGLE_ROT</a>, <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(data, index, 0), <span class="keywordtype">id</span>);</div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac15f836e18a2035d2923ecf76c6e8c7f">MDL_ANGLE_TILT</a>, <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(data, index, 1), <span class="keywordtype">id</span>);</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;        }</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;        <span class="comment">//Here we change the sign of the angle becase in the code</span></div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;        <span class="comment">//is represent the rotation of the reference and we want</span></div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;        <span class="comment">//to store the rotation of the image</span></div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a> = -<a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(data, index, 2);</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a114e3414dd216e4308946a016b5cc46f">MDL_ANGLE_PSI</a>, psi, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;        <span class="comment">//MDimg.setValue(MDL_ANGLE_PSI, dAij(data, index, 2), id);</span></div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acb3aa7acca32f4524608635e2e09650e">MDL_SHIFT_X</a>, <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(data, index, 3), <span class="keywordtype">id</span>);</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab00882fc483e9a1a7e6af5829a6afb8e">MDL_SHIFT_Y</a>, <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(data, index, 4), <span class="keywordtype">id</span>);</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a3637da3214664c45458ae3e56a92c88e">MDL_REF</a>, <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(data, index, 5)), <span class="keywordtype">id</span>);</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#ad9b9535e1774d805e5bbee89dee0f4b5">do_mirror</a>)</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;        {</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af6495a877b8c80b9c45b8156b406b183">MDL_FLIP</a>, <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(data, index, 6) != 0., <span class="keywordtype">id</span>);</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;        }</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ad8a81df6271e91f540f943bf8ef0d192">MDL_PMAX</a>, <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(data, index, 7), <span class="keywordtype">id</span>);</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a>)</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;        {</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af25c0f56fca98fcdd37f613ba2c61de3">MDL_WROBUST</a>, <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(data, index, 8), <span class="keywordtype">id</span>);</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;        }</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">do_norm</a>)</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;        {</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a29c393fe6e00aa337783865f8694b0af">MDL_INTSCALE</a>, <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(data, index, 9), <span class="keywordtype">id</span>);</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;        }</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a79873ba6ac0a02ebff149285475a8721">do_kstest</a>)</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;        {</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af2012e5267456629b7491b47a56344da">MDL_KSTEST</a>, <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(data, index, 10), <span class="keywordtype">id</span>);</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;        }</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    }</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;}<span class="comment">//close function addDocfileData</span></div><div class="ttc" id="classProgMLF2D_html_a8402eab40b0e66cd7aee78b747720af9"><div class="ttname"><a href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">ProgMLF2D::do_student</a></div><div class="ttdeci">bool do_student</div><div class="ttdoc">IN DEVELOPMENT. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00135">mlf_align2d.h:135</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a3464cb9938eb4cf849b7c8bbb354734f"><div class="ttname"><a href="classML2DBaseProgram.html#a3464cb9938eb4cf849b7c8bbb354734f">ML2DBaseProgram::img_id</a></div><div class="ttdeci">std::vector&lt; size_t &gt; img_id</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00232">ml2d.h:232</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a59fffce298c0f99a1d592544d3d39a08"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a59fffce298c0f99a1d592544d3d39a08">MDL_ANGLE_ROT</a></div><div class="ttdoc">Rotation angle of an image (double,degrees) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00057">metadata_label.h:57</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac15f836e18a2035d2923ecf76c6e8c7f"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac15f836e18a2035d2923ecf76c6e8c7f">MDL_ANGLE_TILT</a></div><div class="ttdoc">Tilting angle of an image (double,degrees) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00060">metadata_label.h:60</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78acb3aa7acca32f4524608635e2e09650e"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acb3aa7acca32f4524608635e2e09650e">MDL_SHIFT_X</a></div><div class="ttdoc">Shift for the image in the X axis (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00412">metadata_label.h:412</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a114e3414dd216e4308946a016b5cc46f"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a114e3414dd216e4308946a016b5cc46f">MDL_ANGLE_PSI</a></div><div class="ttdoc">Special label to be used when gathering MDs in MpiMetadataPrograms. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00054">metadata_label.h:54</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af25c0f56fca98fcdd37f613ba2c61de3"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af25c0f56fca98fcdd37f613ba2c61de3">MDL_WROBUST</a></div><div class="ttdoc">Weight of t-student distribution in robust Maximum likelihood. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00460">metadata_label.h:460</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a9e143fabdc67d1ee8cd67dcad98e74fc"><div class="ttname"><a href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">ML2DBaseProgram::do_norm</a></div><div class="ttdeci">bool do_norm</div><div class="ttdoc">Re-normalize internally. </div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00207">ml2d.h:207</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a963af5cdb6f63d876c147c24fbf8452e"><div class="ttname"><a href="classML2DBaseProgram.html#a963af5cdb6f63d876c147c24fbf8452e">ML2DBaseProgram::do_ML3D</a></div><div class="ttdeci">bool do_ML3D</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00196">ml2d.h:196</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_acaec38248b66cfba849985072bd311f6"><div class="ttname"><a href="numerical__recipes_8cpp.html#acaec38248b66cfba849985072bd311f6">first</a></div><div class="ttdeci">glob_log first</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05218">numerical_recipes.cpp:5218</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a79873ba6ac0a02ebff149285475a8721"><div class="ttname"><a href="classProgMLF2D.html#a79873ba6ac0a02ebff149285475a8721">ProgMLF2D::do_kstest</a></div><div class="ttdeci">bool do_kstest</div><div class="ttdoc">Statistical analysis of the noise distributions. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00141">mlf_align2d.h:141</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad2289c67cc7ca1c54d70d173b37d8820"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad2289c67cc7ca1c54d70d173b37d8820">index</a></div><div class="ttdeci">viol index</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05214">numerical_recipes.cpp:5214</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af6495a877b8c80b9c45b8156b406b183"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af6495a877b8c80b9c45b8156b406b183">MDL_FLIP</a></div><div class="ttdoc">Flip the image? (bool) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00231">metadata_label.h:231</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78ad8a81df6271e91f540f943bf8ef0d192"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ad8a81df6271e91f540f943bf8ef0d192">MDL_PMAX</a></div><div class="ttdoc">Maximum value of normalized probability function (now called &quot;Pmax/sumP&quot;) (double) ...</div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00338">metadata_label.h:338</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gafa02b309a507bf04daf9f31fa828ce4f"><div class="ttname"><a href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a></div><div class="ttdeci">#define dAij(M, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00355">multidim_array.h:355</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a29c393fe6e00aa337783865f8694b0af"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a29c393fe6e00aa337783865f8694b0af">MDL_INTSCALE</a></div><div class="ttdoc">Intensity scale for an image. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00249">metadata_label.h:249</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af2012e5267456629b7491b47a56344da"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af2012e5267456629b7491b47a56344da">MDL_KSTEST</a></div><div class="ttdoc">KS-test statistics. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00257">metadata_label.h:257</a></div></div>
<div class="ttc" id="xmipp__log_8h_html_a485ad250637a874aa112548b4133e8d0"><div class="ttname"><a href="xmipp__log_8h.html#a485ad250637a874aa112548b4133e8d0">LOG_LEVEL</a></div><div class="ttdeci">#define LOG_LEVEL(msg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__log_8h_source.html#l00089">xmipp_log.h:89</a></div></div>
<div class="ttc" id="classMetaData_html_adf4ee2ad1ad0964990a8a11a2109d578"><div class="ttname"><a href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">MetaData::setValue</a></div><div class="ttdeci">bool setValue(const MDLabel label, const T &amp;valueIn, size_t id)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00550">metadata.h:550</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a3637da3214664c45458ae3e56a92c88e"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a3637da3214664c45458ae3e56a92c88e">MDL_REF</a></div><div class="ttdoc">Class to which the image belongs (int) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00363">metadata_label.h:363</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a080fbf81a2b9dfceab4cfe1a649f13a4"><div class="ttname"><a href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">ML2DBaseProgram::MDimg</a></div><div class="ttdeci">MetaData MDimg</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00172">ml2d.h:172</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ad9b9535e1774d805e5bbee89dee0f4b5"><div class="ttname"><a href="classML2DBaseProgram.html#ad9b9535e1774d805e5bbee89dee0f4b5">ML2DBaseProgram::do_mirror</a></div><div class="ttdeci">bool do_mirror</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00137">ml2d.h:137</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab00882fc483e9a1a7e6af5829a6afb8e"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab00882fc483e9a1a7e6af5829a6afb8e">MDL_SHIFT_Y</a></div><div class="ttdoc">Shift for the image in the Y axis (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00415">metadata_label.h:415</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab88b1c3d37f23eb7ef079f2535136780"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::appendFTtoVector </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>Fin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l01284">1284</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;{</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="comment">// First, store the points used in the probability calculations</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    std::complex&lt;double&gt; * tmp_in = <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(<a class="code" href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a>);</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ipoint = 0; ipoint &lt; <a class="code" href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">nr_points_2d</a>; ipoint++)</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    {</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        <span class="keywordtype">int</span> ii = <a class="code" href="classProgMLF2D.html#a26c5a01345ef85eaabf6056c0f76f848">pointer_2d</a>[ipoint];</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        out.push_back(tmp_in[ii].real());</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        out.push_back(tmp_in[ii].imag());</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    }</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_gac87b223f03097d45f776b44b6aeea9f7"><div class="ttname"><a href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a></div><div class="ttdeci">#define MULTIDIM_ARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00136">multidim_array.h:136</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a26c5a01345ef85eaabf6056c0f76f848"><div class="ttname"><a href="classProgMLF2D.html#a26c5a01345ef85eaabf6056c0f76f848">ProgMLF2D::pointer_2d</a></div><div class="ttdeci">std::vector&lt; int &gt; pointer_2d</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00126">mlf_align2d.h:126</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a26aeebe75887b4360c73659342f5dc61"><div class="ttname"><a href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a></div><div class="ttdeci">int in</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00053">image_find_center.cpp:53</a></div></div>
<div class="ttc" id="classProgMLF2D_html_af7f2b4639397c6f14e13371207476c06"><div class="ttname"><a href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">ProgMLF2D::nr_points_2d</a></div><div class="ttdeci">size_t nr_points_2d</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00127">mlf_align2d.h:127</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a86d435aa562ed8f627734219a54f9fbc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::calculateFourierOffsets </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Mimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>offsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>Moffsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>Moffsets_mirror</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l01475">1475</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;{</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="keywordtype">int</span> irefmir, ix, iy, iflip_start, iflip_stop, count;</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="keywordtype">int</span> nr_mir = (<a class="code" href="classML2DBaseProgram.html#ad9b9535e1774d805e5bbee89dee0f4b5">do_mirror</a>) ? 2 : 1;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="keywordtype">double</span> dxx, dyy;</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    std::vector&lt;double&gt; Fimg_flip;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;std::complex&lt;double&gt;</a> &gt; Fimg;</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> trans(2);</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Maux2, Maux;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    Moffsets.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>, <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>);</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    Moffsets.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    Moffsets.<a class="code" href="classMultidimArray.html#a239f45b043ed7715dec4d44ceef74dce">initConstant</a>(-1);</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    Moffsets_mirror.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>, <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>);</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    Moffsets_mirror.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    Moffsets_mirror.<a class="code" href="classMultidimArray.html#a239f45b043ed7715dec4d44ceef74dce">initConstant</a>(-1);</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    Maux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>, <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>);</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    Maux.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    Maux2.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>, <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>);</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    Maux2.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <span class="comment">// Flip images and store the precalculates Fourier Transforms in Fimg_flip</span></div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    out.clear();</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <a class="code" href="group__MLFalign2D.html#ga20bc753097a030d2c2650ca5120deeab">FOR_ALL_FLIPS</a>()</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    {</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        Maux.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a>(<a class="code" href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a>, Maux, Mimg, <a class="code" href="classML2DBaseProgram.html#a879e423db0331279b0421e881b73be57">F</a>[iflip], <a class="code" href="transformations_8h.html#a855436c9d0ed5174df8917d5239d7597">IS_INV</a>, <a class="code" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a>);</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        <a class="code" href="group__Fourier.html#ga5ed410a4eb328191715155101e93758e">FourierTransformHalf</a>(Maux, Fimg);</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        <a class="code" href="classProgMLF2D.html#ab88b1c3d37f23eb7ef079f2535136780">appendFTtoVector</a>(Fimg,Fimg_flip);</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    }</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    <span class="comment">// Now for all relevant offsets calculate the Fourier transforms</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <span class="comment">// Matrices Moffsets &amp; Moffsets_mirror contain pointers for the</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <span class="comment">// out vector (access as count*4*dnr_points_2d + iflip*dnr_points_2d)</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    count = 0;</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <a class="code" href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a>()</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    {</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> imir = 0; imir &lt; nr_mir; imir++)</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        {</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;            irefmir = imir * <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a> + refno;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;            iflip_start = imir * <a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>;</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            iflip_stop = imir * nr_nomirror_flips + <a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>;</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;            <a class="code" href="group__MLFalign2D.html#gacd0a39abfcd60d9c68ca9b3756a8ebc2">FOR_ALL_LIMITED_TRANSLATIONS</a>()</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;            {</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                ix = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(offsets[2*irefmir] + <a class="code" href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">Vtrans</a>[itrans](0));</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                iy = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(offsets[2*irefmir+1] + <a class="code" href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">Vtrans</a>[itrans](1));</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                dxx = (double)<a class="code" href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a>(ix, Moffsets.<a class="code" href="classMultidimArrayBase.html#a9d46c4a40e7fa656d736cd84c91441ac">startingX</a>(), Moffsets.<a class="code" href="classMultidimArrayBase.html#a57eff2edbeab2c1ade325bb2c9092df6">finishingX</a>());</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                dyy = (double)<a class="code" href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a>(iy, Moffsets.<a class="code" href="classMultidimArrayBase.html#a885b890f96dee6e79581cf66b65c6c9f">startingY</a>(), Moffsets.<a class="code" href="classMultidimArrayBase.html#abebd0765c1bda52640e5e51aa8dae0f9">finishingY</a>());</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                <span class="comment">// For non-mirrors</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                <span class="keywordflow">if</span> (imir == 0 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Moffsets, <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(dyy), <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(dxx)) &lt; 0)</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                {</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iflip = iflip_start; iflip &lt; iflip_stop; iflip++)</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                    {</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                        <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> &amp; refF_iflip = <a class="code" href="classML2DBaseProgram.html#a879e423db0331279b0421e881b73be57">F</a>[iflip];</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                        <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(trans, 0) = dxx * <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(refF_iflip, 0, 0) + dyy * <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(refF_iflip, 0, 1);</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                        <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(trans, 1) = dxx * <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(refF_iflip, 1, 0) + dyy * <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(refF_iflip, 1, 1);</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                        <a class="code" href="classProgMLF2D.html#ab887549eff44d4b6ff4209effc176a39">fourierTranslate2D</a>(Fimg_flip,trans,out,iflip*<a class="code" href="classProgMLF2D.html#a2839dd97c6d6098e665b16bed661b615">dnr_points_2d</a>);</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                    }</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Moffsets, <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(dyy), <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(dxx)) = count;</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                    count++;</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                }</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                <span class="comment">// For mirrors use a separate offset-matrix</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (imir == 1 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Moffsets_mirror, <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(dyy), <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(dxx)) &lt; 0)</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                {</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iflip = iflip_start; iflip &lt; iflip_stop; iflip++)</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                    {</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                        <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> &amp; refF_iflip = <a class="code" href="classML2DBaseProgram.html#a879e423db0331279b0421e881b73be57">F</a>[iflip];</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                        <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(trans, 0) = dxx * <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(refF_iflip, 0, 0) + dyy * <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(refF_iflip, 0, 1);</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                        <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(trans, 1) = dxx * <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(refF_iflip, 1, 0) + dyy * <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(refF_iflip, 1, 1);</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                        <a class="code" href="classProgMLF2D.html#ab887549eff44d4b6ff4209effc176a39">fourierTranslate2D</a>(Fimg_flip,trans,out,iflip*<a class="code" href="classProgMLF2D.html#a2839dd97c6d6098e665b16bed661b615">dnr_points_2d</a>);</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                    }</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Moffsets_mirror, <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(dyy), <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(dxx)) = count;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                    count++;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                }</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            }</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        }</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    }</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;}</div><div class="ttc" id="group__Fourier_html_ga5ed410a4eb328191715155101e93758e"><div class="ttname"><a href="group__Fourier.html#ga5ed410a4eb328191715155101e93758e">FourierTransformHalf</a></div><div class="ttdeci">void FourierTransformHalf(const MultidimArray&lt; double &gt; &amp;in, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8cpp_source.html#l00187">xmipp_fft.cpp:187</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ad2a82e39d73ee5d2911c6c9a95b9b54c"><div class="ttname"><a href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">ML2DBaseProgram::Vtrans</a></div><div class="ttdeci">std::vector&lt; Matrix1D&lt; double &gt; &gt; Vtrans</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00184">ml2d.h:184</a></div></div>
<div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00364">multidim_array.h:364</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a5578230b3fb9e054c437e187cb0ad5d3"><div class="ttname"><a href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">ML2DBaseProgram::model</a></div><div class="ttdeci">ModelML2D model</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00224">ml2d.h:224</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga3cc15e5dda7c58b9cacb7eee440d6bdc"><div class="ttname"><a href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a></div><div class="ttdeci">void applyGeometry(int SplineDegree, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V2, const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V1, const Matrix2D&lt; double &gt; &amp;A, bool inv, bool wrap, std::complex&lt; double &gt; outside, MultidimArray&lt; double &gt; *BcoeffsPtr)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00517">transformations.cpp:517</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a57eff2edbeab2c1ade325bb2c9092df6"><div class="ttname"><a href="classMultidimArrayBase.html#a57eff2edbeab2c1ade325bb2c9092df6">MultidimArrayBase::finishingX</a></div><div class="ttdeci">int finishingX() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01037">multidim_array.h:1037</a></div></div>
<div class="ttc" id="classMultidimArray_html_a239f45b043ed7715dec4d44ceef74dce"><div class="ttname"><a href="classMultidimArray.html#a239f45b043ed7715dec4d44ceef74dce">MultidimArray::initConstant</a></div><div class="ttdeci">void initConstant(T val)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04309">multidim_array.h:4309</a></div></div>
<div class="ttc" id="transformations_8h_html_a43c1de45dbd91827a260224c9c40221b"><div class="ttname"><a href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a></div><div class="ttdeci">#define WRAP</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00043">transformations.h:43</a></div></div>
<div class="ttc" id="classModelML2D_html_a63a3a3534d1cb72a9db046508b9a59f6"><div class="ttname"><a href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">ModelML2D::n_ref</a></div><div class="ttdeci">int n_ref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00083">ml2d.h:83</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_abebd0765c1bda52640e5e51aa8dae0f9"><div class="ttname"><a href="classMultidimArrayBase.html#abebd0765c1bda52640e5e51aa8dae0f9">MultidimArrayBase::finishingY</a></div><div class="ttdeci">int finishingY() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01023">multidim_array.h:1023</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gacd0a39abfcd60d9c68ca9b3756a8ebc2"><div class="ttname"><a href="group__MLFalign2D.html#gacd0a39abfcd60d9c68ca9b3756a8ebc2">FOR_ALL_LIMITED_TRANSLATIONS</a></div><div class="ttdeci">#define FOR_ALL_LIMITED_TRANSLATIONS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00039">mlf_align2d.h:39</a></div></div>
<div class="ttc" id="group__Matrices_html_gab40746be05d4bbf352787018922ecc2e"><div class="ttname"><a href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a></div><div class="ttdeci">#define MAT_ELEM(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00117">matrix2d.h:117</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a2839dd97c6d6098e665b16bed661b615"><div class="ttname"><a href="classProgMLF2D.html#a2839dd97c6d6098e665b16bed661b615">ProgMLF2D::dnr_points_2d</a></div><div class="ttdeci">size_t dnr_points_2d</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00127">mlf_align2d.h:127</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_ga20bc753097a030d2c2650ca5120deeab"><div class="ttname"><a href="group__MLFalign2D.html#ga20bc753097a030d2c2650ca5120deeab">FOR_ALL_FLIPS</a></div><div class="ttdeci">#define FOR_ALL_FLIPS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00038">mlf_align2d.h:38</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a879e423db0331279b0421e881b73be57"><div class="ttname"><a href="classML2DBaseProgram.html#a879e423db0331279b0421e881b73be57">ML2DBaseProgram::F</a></div><div class="ttdeci">std::vector&lt; Matrix2D&lt; double &gt; &gt; F</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00174">ml2d.h:174</a></div></div>
<div class="ttc" id="transformations_8h_html_a855436c9d0ed5174df8917d5239d7597"><div class="ttname"><a href="transformations_8h.html#a855436c9d0ed5174df8917d5239d7597">IS_INV</a></div><div class="ttdeci">#define IS_INV</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00040">transformations.h:40</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gac645eb9a88619ee6f5e14c557ab8ef62"><div class="ttname"><a href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a></div><div class="ttdeci">#define LINEAR</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00208">transformations.h:208</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ae96de19117479eb8bf594268bb9af590"><div class="ttname"><a href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">ML2DBaseProgram::dim</a></div><div class="ttdeci">size_t dim</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00151">ml2d.h:151</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga53e37122134100316031eae982abee03"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a></div><div class="ttdeci">#define dAi(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00540">multidim_array.h:540</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a9d46c4a40e7fa656d736cd84c91441ac"><div class="ttname"><a href="classMultidimArrayBase.html#a9d46c4a40e7fa656d736cd84c91441ac">MultidimArrayBase::startingX</a></div><div class="ttdeci">int startingX() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01030">multidim_array.h:1030</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ab887549eff44d4b6ff4209effc176a39"><div class="ttname"><a href="classProgMLF2D.html#ab887549eff44d4b6ff4209effc176a39">ProgMLF2D::fourierTranslate2D</a></div><div class="ttdeci">void fourierTranslate2D(const std::vector&lt; double &gt; &amp;in, MultidimArray&lt; double &gt; &amp;trans, std::vector&lt; double &gt; &amp;out, int point_start=0)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l01441">mlf_align2d.cpp:1441</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ad9b9535e1774d805e5bbee89dee0f4b5"><div class="ttname"><a href="classML2DBaseProgram.html#ad9b9535e1774d805e5bbee89dee0f4b5">ML2DBaseProgram::do_mirror</a></div><div class="ttdeci">bool do_mirror</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00137">ml2d.h:137</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a885b890f96dee6e79581cf66b65c6c9f"><div class="ttname"><a href="classMultidimArrayBase.html#a885b890f96dee6e79581cf66b65c6c9f">MultidimArrayBase::startingY</a></div><div class="ttdeci">int startingY() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01016">multidim_array.h:1016</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_abe104a9ef312f6d857b008188e5dfbea"><div class="ttname"><a href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">ML2DBaseProgram::nr_nomirror_flips</a></div><div class="ttdeci">size_t nr_nomirror_flips</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00162">ml2d.h:162</a></div></div>
<div class="ttc" id="group__Macros_html_ga10de40044d2903ec0d4e7e57c31322aa"><div class="ttname"><a href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a></div><div class="ttdeci">#define intWRAP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00272">xmipp_macros.h:272</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ab88b1c3d37f23eb7ef079f2535136780"><div class="ttname"><a href="classProgMLF2D.html#ab88b1c3d37f23eb7ef079f2535136780">ProgMLF2D::appendFTtoVector</a></div><div class="ttdeci">void appendFTtoVector(const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;Fin, std::vector&lt; double &gt; &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l01284">mlf_align2d.cpp:1284</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gadcb82c3ff44ffd9c34b67c3ca943613d"><div class="ttname"><a href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a></div><div class="ttdeci">#define FOR_ALL_MODELS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00036">mlf_align2d.h:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aaf2dca554cdb8f87793b36dedf8e744a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::calculatePdfInplane </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate probability density distribution for in-plane transformations. </p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l01250">1250</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;{</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a>, pdfpix, sum;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a6f44905656bc9d5a5bb57dea399cd18e">P_phi</a>.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>, <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>);</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a6f44905656bc9d5a5bb57dea399cd18e">P_phi</a>.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a394058da00920fa8e21edd9cf95cd49c">Mr2</a>.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>, <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>);</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a394058da00920fa8e21edd9cf95cd49c">Mr2</a>.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    sum=0.;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(<a class="code" href="classML2DBaseProgram.html#a6f44905656bc9d5a5bb57dea399cd18e">P_phi</a>)</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    {</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        r2 = (double)(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> * <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a0177d3113415179168699efda64bd860">sigma_offset</a> &gt; 0.)</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        {</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;            pdfpix = exp(-r2 / (2 * <a class="code" href="classProgMLF2D.html#a0177d3113415179168699efda64bd860">sigma_offset</a> * <a class="code" href="classProgMLF2D.html#a0177d3113415179168699efda64bd860">sigma_offset</a>));</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            pdfpix /= 2 * <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * <a class="code" href="classProgMLF2D.html#a0177d3113415179168699efda64bd860">sigma_offset</a> * <a class="code" href="classProgMLF2D.html#a0177d3113415179168699efda64bd860">sigma_offset</a> * <a class="code" href="classML2DBaseProgram.html#a976dc404489a0c66af2800f0f73e76c7">nr_psi</a> * <a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        }</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        {</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> == 0 &amp;&amp; i == 0)</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                pdfpix = 1.;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                pdfpix = 0.;</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        }</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(<a class="code" href="classML2DBaseProgram.html#a6f44905656bc9d5a5bb57dea399cd18e">P_phi</a>, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = pdfpix;</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(<a class="code" href="classML2DBaseProgram.html#a394058da00920fa8e21edd9cf95cd49c">Mr2</a>, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = (float)r2;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        sum+=pdfpix;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    }</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="comment">// Normalization</span></div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a6f44905656bc9d5a5bb57dea399cd18e">P_phi</a>/=sum;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;}</div><div class="ttc" id="classML2DBaseProgram_html_a976dc404489a0c66af2800f0f73e76c7"><div class="ttname"><a href="classML2DBaseProgram.html#a976dc404489a0c66af2800f0f73e76c7">ML2DBaseProgram::nr_psi</a></div><div class="ttdeci">size_t nr_psi</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00154">ml2d.h:154</a></div></div>
<div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00364">multidim_array.h:364</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a394058da00920fa8e21edd9cf95cd49c"><div class="ttname"><a href="classML2DBaseProgram.html#a394058da00920fa8e21edd9cf95cd49c">ML2DBaseProgram::Mr2</a></div><div class="ttdeci">MultidimArray&lt; double &gt; Mr2</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00178">ml2d.h:178</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00400">multidim_array.h:400</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a0177d3113415179168699efda64bd860"><div class="ttname"><a href="classProgMLF2D.html#a0177d3113415179168699efda64bd860">ProgMLF2D::sigma_offset</a></div><div class="ttdeci">double sigma_offset</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00075">mlf_align2d.h:75</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ae96de19117479eb8bf594268bb9af590"><div class="ttname"><a href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">ML2DBaseProgram::dim</a></div><div class="ttdeci">size_t dim</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00151">ml2d.h:151</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a6f44905656bc9d5a5bb57dea399cd18e"><div class="ttname"><a href="classML2DBaseProgram.html#a6f44905656bc9d5a5bb57dea399cd18e">ML2DBaseProgram::P_phi</a></div><div class="ttdeci">MultidimArray&lt; double &gt; P_phi</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00178">ml2d.h:178</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_ab7a69dabaa7151dae4d7a3998167e2f3"><div class="ttname"><a href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a></div><div class="ttdeci">float r2</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00051">image_find_center.cpp:51</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_abe104a9ef312f6d857b008188e5dfbea"><div class="ttname"><a href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">ML2DBaseProgram::nr_nomirror_flips</a></div><div class="ttdeci">size_t nr_nomirror_flips</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00162">ml2d.h:162</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a89129c2b58a8ab4da944706d4da109d0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::defineAdditionalParams </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classXmippProgram.html">XmippProgram</a> *&#160;</td>
          <td class="paramname"><em>prog</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>sectionLine</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="classML2DBaseProgram.html#a8c1341b893fa1371ebf8fea3255d3e41">ML2DBaseProgram</a>.</p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l00053">53</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;{</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a8c1341b893fa1371ebf8fea3255d3e41">ML2DBaseProgram::defineAdditionalParams</a>(prog, sectionLine);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">//even more additional params</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    prog-&gt;<a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot; [ --search_shift &lt;int=3&gt;]      : Limited translational searches (in pixels) &quot;</span>);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    prog-&gt;<a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot; [ --reduce_snr &lt;factor=1&gt; ]    : Use a value smaller than one to decrease the estimated SSNRs &quot;</span>);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    prog-&gt;<a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot; [ --not_phase_flipped ]        : Use this if the experimental images have not been phase flipped &quot;</span>);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    prog-&gt;<a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot; [ --ctf_affected_refs ]        : Use this if the references (-ref) are not CTF-deconvoluted &quot;</span>);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    prog-&gt;<a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot; [ --limit_resolution &lt;first_high=0&gt; &lt;high=0&gt; &lt;low=999&gt;]: Exclude frequencies from P-calculations (in Ang)&quot;</span>);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    prog-&gt;<a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;                               : First value is highest frequency during first iteration.&quot;</span>);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    prog-&gt;<a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;                               : Second is the highest in following iterations and third is lowest&quot;</span>);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    prog-&gt;<a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot; [ --fix_high &lt;float=-1&gt;]       : &quot;</span>);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    prog-&gt;<a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot; [ --include_allfreqs ] &quot;</span>);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div><div class="ttc" id="classML2DBaseProgram_html_a8c1341b893fa1371ebf8fea3255d3e41"><div class="ttname"><a href="classML2DBaseProgram.html#a8c1341b893fa1371ebf8fea3255d3e41">ML2DBaseProgram::defineAdditionalParams</a></div><div class="ttdeci">virtual void defineAdditionalParams(XmippProgram *prog, const char *sectionLine)</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8cpp_source.html#l00265">ml2d.cpp:265</a></div></div>
<div class="ttc" id="classXmippProgram_html_aaeb37f0bac83f5d2a605aaa0e5c4b6ef"><div class="ttname"><a href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">XmippProgram::addParamsLine</a></div><div class="ttdeci">void addParamsLine(const String &amp;line)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00361">xmipp_program.cpp:361</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a66a03b0afd064ec89a5aa3f4b574d51f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::defineBasicParams </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classXmippProgram.html">XmippProgram</a> *&#160;</td>
          <td class="paramname"><em>prog</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Some redefinitions of the basic and additional params. </p>

<p>Reimplemented from <a class="el" href="classML2DBaseProgram.html#ac20210a2ca026ff1831be53bd25fe561">ML2DBaseProgram</a>.</p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l00044">44</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="classML2DBaseProgram.html#ac20210a2ca026ff1831be53bd25fe561">ML2DBaseProgram::defineBasicParams</a>(prog);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    prog-&gt;<a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;[--no_ctf]          : do not use any CTF correction, you should provide sampling rate&quot;</span>);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    prog-&gt;<a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;     requires --sampling_rate;&quot;</span>);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">//prog-&gt;addParamsLine(&quot;                    : by defaut the CTF info is read from input images metadata&quot;);</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    prog-&gt;<a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;   [--sampling_rate &lt;Ts&gt;]    : If provided, this sampling rate will overwrites the one in the ctf file&quot;</span>);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;}</div><div class="ttc" id="classML2DBaseProgram_html_ac20210a2ca026ff1831be53bd25fe561"><div class="ttname"><a href="classML2DBaseProgram.html#ac20210a2ca026ff1831be53bd25fe561">ML2DBaseProgram::defineBasicParams</a></div><div class="ttdeci">virtual void defineBasicParams(XmippProgram *prog)</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8cpp_source.html#l00225">ml2d.cpp:225</a></div></div>
<div class="ttc" id="classXmippProgram_html_aaeb37f0bac83f5d2a605aaa0e5c4b6ef"><div class="ttname"><a href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">XmippProgram::addParamsLine</a></div><div class="ttdeci">void addParamsLine(const String &amp;line)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00361">xmipp_program.cpp:361</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a56d9638f6555e0a4793920b45283bc83"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::defineParams </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Params definition. </p>

<p>Reimplemented from <a class="el" href="classXmippProgram.html#a75ba820f6afd62c89524b497ae9b560d">XmippProgram</a>.</p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l00069">69</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;{</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">//add usage</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">//params</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a936f95ff82d7ac76db2dcba20c0c002f">defaultRoot</a> = <span class="stringliteral">&quot;mlf2d&quot;</span>;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a00e959454e0727e58b9452cc1d5cfef1">allowRestart</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a36d4c020f76461b5862cd1b09d53d9cb">allowIEM</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="classProgMLF2D.html#a66a03b0afd064ec89a5aa3f4b574d51f">defineBasicParams</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="classProgMLF2D.html#a89129c2b58a8ab4da944706d4da109d0">defineAdditionalParams</a>(<span class="keyword">this</span>, <span class="stringliteral">&quot;==+ Additional options ==&quot;</span>);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">//hidden params</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a5bfd3f7250efeda01483917e5382b857">defineHiddenParams</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot; [--var_psi]&quot;</span>);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot; [--var_trans]&quot;</span>);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot; [--kstest]&quot;</span>);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot; [--iter_histogram &lt;int=-1&gt;]&quot;</span>);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;}</div><div class="ttc" id="classProgMLF2D_html_a89129c2b58a8ab4da944706d4da109d0"><div class="ttname"><a href="classProgMLF2D.html#a89129c2b58a8ab4da944706d4da109d0">ProgMLF2D::defineAdditionalParams</a></div><div class="ttdeci">virtual void defineAdditionalParams(XmippProgram *prog, const char *sectionLine)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l00053">mlf_align2d.cpp:53</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a00e959454e0727e58b9452cc1d5cfef1"><div class="ttname"><a href="classML2DBaseProgram.html#a00e959454e0727e58b9452cc1d5cfef1">ML2DBaseProgram::allowRestart</a></div><div class="ttdeci">bool allowRestart</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00239">ml2d.h:239</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a936f95ff82d7ac76db2dcba20c0c002f"><div class="ttname"><a href="classML2DBaseProgram.html#a936f95ff82d7ac76db2dcba20c0c002f">ML2DBaseProgram::defaultRoot</a></div><div class="ttdeci">String defaultRoot</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00240">ml2d.h:240</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a5bfd3f7250efeda01483917e5382b857"><div class="ttname"><a href="classML2DBaseProgram.html#a5bfd3f7250efeda01483917e5382b857">ML2DBaseProgram::defineHiddenParams</a></div><div class="ttdeci">virtual void defineHiddenParams(XmippProgram *prog)</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8cpp_source.html#l00289">ml2d.cpp:289</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a66a03b0afd064ec89a5aa3f4b574d51f"><div class="ttname"><a href="classProgMLF2D.html#a66a03b0afd064ec89a5aa3f4b574d51f">ProgMLF2D::defineBasicParams</a></div><div class="ttdeci">virtual void defineBasicParams(XmippProgram *prog)</div><div class="ttdoc">Some redefinitions of the basic and additional params. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l00044">mlf_align2d.cpp:44</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a36d4c020f76461b5862cd1b09d53d9cb"><div class="ttname"><a href="classML2DBaseProgram.html#a36d4c020f76461b5862cd1b09d53d9cb">ML2DBaseProgram::allowIEM</a></div><div class="ttdeci">bool allowIEM</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00239">ml2d.h:239</a></div></div>
<div class="ttc" id="classXmippProgram_html_aaeb37f0bac83f5d2a605aaa0e5c4b6ef"><div class="ttname"><a href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">XmippProgram::addParamsLine</a></div><div class="ttdeci">void addParamsLine(const String &amp;line)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00361">xmipp_program.cpp:361</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7c7260c6653450b23777354e70d7f8d0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::endIteration </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Redefine endIteration to update Wiener filters. </p>

<p>Reimplemented from <a class="el" href="classML2DBaseProgram.html#a1c7ab5da3d028b12fde6da84854eb720">ML2DBaseProgram</a>.</p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l02663">2663</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;{</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a1c7ab5da3d028b12fde6da84854eb720">ML2DBaseProgram::endIteration</a>();</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    <span class="comment">//std::cerr &lt;&lt; &quot;DEBUG_JM, endIteration: spectral_signal: &quot; &lt;&lt; spectral_signal &lt;&lt; std::endl;</span></div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;    <a class="code" href="classProgMLF2D.html#ab1a1724f969e8cfca5c84d766366dd7b">updateWienerFilters</a>(<a class="code" href="classML2DBaseProgram.html#add43d72480811707dcaa89df00324f42">spectral_signal</a>, <a class="code" href="classProgMLF2D.html#a9c42feb7d8cbf224f91e903bac49663e">sumw_defocus</a>, <a class="code" href="classML2DBaseProgram.html#a20e2b948711e3e66894740b99e8cf017">iter</a>);</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;}</div><div class="ttc" id="classML2DBaseProgram_html_a20e2b948711e3e66894740b99e8cf017"><div class="ttname"><a href="classML2DBaseProgram.html#a20e2b948711e3e66894740b99e8cf017">ML2DBaseProgram::iter</a></div><div class="ttdeci">int iter</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00147">ml2d.h:147</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a9c42feb7d8cbf224f91e903bac49663e"><div class="ttname"><a href="classProgMLF2D.html#a9c42feb7d8cbf224f91e903bac49663e">ProgMLF2D::sumw_defocus</a></div><div class="ttdeci">std::vector&lt; double &gt; sumw_defocus</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00156">mlf_align2d.h:156</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_add43d72480811707dcaa89df00324f42"><div class="ttname"><a href="classML2DBaseProgram.html#add43d72480811707dcaa89df00324f42">ML2DBaseProgram::spectral_signal</a></div><div class="ttdeci">MultidimArray&lt; double &gt; spectral_signal</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00253">ml2d.h:253</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ab1a1724f969e8cfca5c84d766366dd7b"><div class="ttname"><a href="classProgMLF2D.html#ab1a1724f969e8cfca5c84d766366dd7b">ProgMLF2D::updateWienerFilters</a></div><div class="ttdeci">void updateWienerFilters(const MultidimArray&lt; double &gt; &amp;spectral_signal, std::vector&lt; double &gt; &amp;sumw_defocus, int iter)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l00849">mlf_align2d.cpp:849</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a1c7ab5da3d028b12fde6da84854eb720"><div class="ttname"><a href="classML2DBaseProgram.html#a1c7ab5da3d028b12fde6da84854eb720">ML2DBaseProgram::endIteration</a></div><div class="ttdeci">virtual void endIteration()</div><div class="ttdoc">Do some task at the end of iteration. </div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8cpp_source.html#l00167">ml2d.cpp:167</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8b3ad1500cc0fff4024cc23ce3c2b192"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::estimateInitialNoiseSpectra </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate initial sigma2 from average power spectrum of the experimental images </p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l00734">734</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;{</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <a class="code" href="xmipp__log_8h.html#a9d0e78c69b9733e4419a5f65d5a38a3a">LOG_FUNCTION</a>();</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="comment">// For first iteration only: calculate sigma2 (&amp; spectral noise) from power</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="comment">// spectra of all images and subtract power spectrum of average image</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="comment">// (to take away low-res frequencies where the signal dominates!)</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a495926025de4de5360efd7266377cc2c">istart</a> == 1)</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    {</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a>            Maux, Mallave;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <a class="code" href="classMultidimArray.html">MultidimArray&lt;std::complex&lt;double&gt;</a> &gt;  Fimg, Faux, Fave;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a>            rmean_noise, rmean_signal, rmean_avesignal;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        std::vector&lt;MultidimArray&lt;double&gt; &gt;   Msigma2, Mave;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a>               center(2);</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <a class="code" href="classMultidimArray.html">MultidimArray&lt;int&gt;</a>           radial_count;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        <a class="code" href="classImage.html">Image&lt;double&gt;</a>                       img;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        <a class="code" href="classFileName.html">FileName</a>                    fn_tmp;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        std::ofstream                    fh;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        center.initZeros();</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <span class="keywordtype">int</span> focus = 0;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a> &gt; 0)</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;--&gt; Estimating initial noise models from average power spectra ...&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <a class="code" href="classXmippProgram.html#aea0549c1e40215ee12b1abc36648b39a">initProgress</a>(<a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#ad844b6a5655be4205e4bb03ab6372562">size</a>());</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        Msigma2.clear();</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        Msigma2.resize(<a class="code" href="classProgMLF2D.html#a7e08de076e12e519d59f5e39854f1dc5">nr_focus</a>);</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        Mave.clear();</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        Mave.resize(<a class="code" href="classProgMLF2D.html#a7e08de076e12e519d59f5e39854f1dc5">nr_focus</a>);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        <a class="code" href="group__MLFalign2D.html#gab39599380e42cadda13b0cfb14588d46">FOR_ALL_DEFOCUS_GROUPS</a>()</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        {</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            Msigma2[ifocus].initZeros(<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>, <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>);</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            Msigma2[ifocus].setXmippOrigin();</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            Mave[ifocus].initZeros(<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>, <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            Mave[ifocus].setXmippOrigin();</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        }</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        Maux.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>, <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>);</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        <span class="keywordtype">int</span> imgno = 0;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        <a class="code" href="group__MetaData.html#ga85652b971edca3acc93a9f1bef2f17f6">FOR_ALL_OBJECTS_IN_METADATA</a>(<a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>)</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        {</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            focus = 0;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">do_ctf_correction</a>)</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a7d9d585d218e22d9569dae329fb0c538">MDL_DEFGROUP</a>, focus, __iter.objId);</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a>, fn_tmp, __iter.objId);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            <span class="comment">//img.read(fn_tmp, false, false, false, false);</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            <span class="comment">//TODO: Check this????</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            img.<a class="code" href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">read</a>(fn_tmp);</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            img().setXmippOrigin();</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            <a class="code" href="group__Fourier.html#ga5fddf4cf6da360abdc8fd7d2f21fcbb9">FourierTransform</a>(img(), Fimg);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            <a class="code" href="group__FourierW.html#ga1075fe73c87077296a879f44ded3a2c3">FFT_magnitude</a>(Fimg, Maux);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            Maux.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            Maux *= Maux;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            Msigma2[focus] += Maux;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            Mave[focus] += img();</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            <a class="code" href="classXmippProgram.html#a074c10cbbaa660749bbc2778592a54c4">setProgress</a>(++imgno);</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        }</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <a class="code" href="classXmippProgram.html#aef9f1a6f495c898cb12eac9a7922a84c">endProgress</a>();</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <a class="code" href="classFileName.html">FileName</a> fn_base = <a class="code" href="ml__refine3d_8cpp.html#a36c1b07f8f73f52294afe38445f71e17">FN_ITER_BASE</a>(<a class="code" href="classML2DBaseProgram.html#a495926025de4de5360efd7266377cc2c">istart</a> - 1);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <span class="comment">// Calculate Vsig vectors and write them to disc</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <a class="code" href="group__MLFalign2D.html#gab39599380e42cadda13b0cfb14588d46">FOR_ALL_DEFOCUS_GROUPS</a>()</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        {</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            Mave[ifocus] /= (double)<a class="code" href="classProgMLF2D.html#a5c75192acc215ccf8e062881d14f9ac4">count_defocus</a>[ifocus];</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            <a class="code" href="group__Fourier.html#ga5fddf4cf6da360abdc8fd7d2f21fcbb9">FourierTransform</a>(Mave[ifocus], Fave);</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            <a class="code" href="group__FourierW.html#ga1075fe73c87077296a879f44ded3a2c3">FFT_magnitude</a>(Fave, Maux);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            Maux *= Maux;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            <a class="code" href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a>(Maux, <span class="keyword">true</span>);</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            Maux.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            rmean_signal.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#ga82c19639b510d33894fe268664130410">radialAverage</a>(Maux, center, rmean_signal, radial_count, <span class="keyword">true</span>);</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            <a class="code" href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a>(Msigma2[ifocus], <span class="keyword">true</span>);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            Msigma2[ifocus].setXmippOrigin();</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            rmean_noise.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#ga82c19639b510d33894fe268664130410">radialAverage</a>(Msigma2[ifocus], center, rmean_noise, radial_count, <span class="keyword">true</span>);</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            rmean_noise /= (double)<a class="code" href="classProgMLF2D.html#a5c75192acc215ccf8e062881d14f9ac4">count_defocus</a>[ifocus];</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            <span class="comment">// Subtract signal terms</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            <span class="comment">// Divide by factor 2 because of the 2D-Gaussian distribution!</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            <a class="code" href="group__MLFalign2D.html#ga0b5e5d4b8eb0463459e3fe178b6622cd">FOR_ALL_DIGITAL_FREQS</a>()</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            <a class="code" href="group__MLFalign2D.html#gaea9964961fe272b8b7277239202912cb">VSIG_ITEM</a> = (<a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(rmean_noise, irr) - <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(rmean_signal, irr)) / 2.;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <span class="comment">// write Vsig vector to disc (only master)</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (<a class="code" href="mpi__write__test_8cpp.html#aa9e47fbdaba5183887426dcfe231c4f4">IS_MASTER</a>)</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                <a class="code" href="classProgMLF2D.html#a8540e7e059c7bc46e2a010d25225d08b">writeNoiseFile</a>(fn_base, ifocus);</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            fn_tmp = <a class="code" href="group__MLFalign2D.html#gace9129bcfa1cd128950b15385abff09f">FN_VSIG</a>(fn_base, ifocus, &quot;noise.xmd&quot;);</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="preprocessor">#ifdef OLD_FILE</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            fh.open((fn_tmp).c_str(), std::ios::out);</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <span class="keywordflow">if</span> (!fh)</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aabda7431146b956debfa7f89164af1790">ERR_IO_NOTOPEN</a>, (<a class="code" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a>)<span class="stringliteral">&quot;Prog_MLFalign2D_prm: Cannot write file: &quot;</span> + fn_tmp);</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            <a class="code" href="group__MLFalign2D.html#ga0b5e5d4b8eb0463459e3fe178b6622cd">FOR_ALL_DIGITAL_FREQS</a>()</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            {</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                fh &lt;&lt; (double)irr/(<a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a>*<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="group__MLFalign2D.html#gaea9964961fe272b8b7277239202912cb">VSIG_ITEM</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            }</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            fh.close();</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        }</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        Msigma2.clear();</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        Mave.clear();</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    }</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="classXmippProgram_html_aea0549c1e40215ee12b1abc36648b39a"><div class="ttname"><a href="classXmippProgram.html#aea0549c1e40215ee12b1abc36648b39a">XmippProgram::initProgress</a></div><div class="ttdeci">void initProgress(size_t total, size_t stepBin=60)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00307">xmipp_program.cpp:307</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gab39599380e42cadda13b0cfb14588d46"><div class="ttname"><a href="group__MLFalign2D.html#gab39599380e42cadda13b0cfb14588d46">FOR_ALL_DEFOCUS_GROUPS</a></div><div class="ttdeci">#define FOR_ALL_DEFOCUS_GROUPS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00040">mlf_align2d.h:40</a></div></div>
<div class="ttc" id="classXmippProgram_html_aef9f1a6f495c898cb12eac9a7922a84c"><div class="ttname"><a href="classXmippProgram.html#aef9f1a6f495c898cb12eac9a7922a84c">XmippProgram::endProgress</a></div><div class="ttdeci">void endProgress()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00327">xmipp_program.cpp:327</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00068">xmipp_filename.h:68</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a7e08de076e12e519d59f5e39854f1dc5"><div class="ttname"><a href="classProgMLF2D.html#a7e08de076e12e519d59f5e39854f1dc5">ProgMLF2D::nr_focus</a></div><div class="ttdeci">size_t nr_focus</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00114">mlf_align2d.h:114</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_ga0b5e5d4b8eb0463459e3fe178b6622cd"><div class="ttname"><a href="group__MLFalign2D.html#ga0b5e5d4b8eb0463459e3fe178b6622cd">FOR_ALL_DIGITAL_FREQS</a></div><div class="ttdeci">#define FOR_ALL_DIGITAL_FREQS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00041">mlf_align2d.h:41</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="group__Fourier_html_ga0447bcc3d329ad07e453b0d9b0872468"><div class="ttname"><a href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a></div><div class="ttdeci">void CenterFFT(MultidimArray&lt; T &gt; &amp;v, bool forward)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8h_source.html#l00291">xmipp_fft.h:291</a></div></div>
<div class="ttc" id="classMetaData_html_a2239fbb7e492654f1e2866ab27492a5d"><div class="ttname"><a href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">MetaData::getValue</a></div><div class="ttdeci">bool getValue(MDObject &amp;mdValueOut, size_t id) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00217">metadata.cpp:217</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a7d9d585d218e22d9569dae329fb0c538"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a7d9d585d218e22d9569dae329fb0c538">MDL_DEFGROUP</a></div><div class="ttdoc">Defocus group. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00210">metadata_label.h:210</a></div></div>
<div class="ttc" id="classMetaData_html_ad844b6a5655be4205e4bb03ab6372562"><div class="ttname"><a href="classMetaData.html#ad844b6a5655be4205e4bb03ab6372562">MetaData::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00702">metadata.cpp:702</a></div></div>
<div class="ttc" id="ml__refine3d_8cpp_html_a36c1b07f8f73f52294afe38445f71e17"><div class="ttname"><a href="ml__refine3d_8cpp.html#a36c1b07f8f73f52294afe38445f71e17">FN_ITER_BASE</a></div><div class="ttdeci">#define FN_ITER_BASE(iter)</div><div class="ttdef"><b>Definition:</b> <a href="ml__refine3d_8cpp_source.html#l00050">ml_refine3d.cpp:50</a></div></div>
<div class="ttc" id="mpi__write__test_8cpp_html_aa9e47fbdaba5183887426dcfe231c4f4"><div class="ttname"><a href="mpi__write__test_8cpp.html#aa9e47fbdaba5183887426dcfe231c4f4">IS_MASTER</a></div><div class="ttdeci">#define IS_MASTER</div><div class="ttdef"><b>Definition:</b> <a href="mpi__write__test_8cpp_source.html#l00052">mpi_write_test.cpp:52</a></div></div>
<div class="ttc" id="group__MetaData_html_ga85652b971edca3acc93a9f1bef2f17f6"><div class="ttname"><a href="group__MetaData.html#ga85652b971edca3acc93a9f1bef2f17f6">FOR_ALL_OBJECTS_IN_METADATA</a></div><div class="ttdeci">#define FOR_ALL_OBJECTS_IN_METADATA(__md)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00081">metadata.h:81</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a495926025de4de5360efd7266377cc2c"><div class="ttname"><a href="classML2DBaseProgram.html#a495926025de4de5360efd7266377cc2c">ML2DBaseProgram::istart</a></div><div class="ttdeci">int istart</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00145">ml2d.h:145</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ae96de19117479eb8bf594268bb9af590"><div class="ttname"><a href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">ML2DBaseProgram::dim</a></div><div class="ttdeci">size_t dim</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00151">ml2d.h:151</a></div></div>
<div class="ttc" id="classXmippProgram_html_aed62cfe3c074e69076bf348fc101a717"><div class="ttname"><a href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">XmippProgram::verbose</a></div><div class="ttdeci">int verbose</div><div class="ttdoc">Verbosity level. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8h_source.html#l00168">xmipp_program.h:168</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a7c3f7c47054265ad3589ee6d40764fbc"><div class="ttname"><a href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">ProgMLF2D::do_ctf_correction</a></div><div class="ttdeci">bool do_ctf_correction</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00100">mlf_align2d.h:100</a></div></div>
<div class="ttc" id="group__Fourier_html_ga5fddf4cf6da360abdc8fd7d2f21fcbb9"><div class="ttname"><a href="group__Fourier.html#ga5fddf4cf6da360abdc8fd7d2f21fcbb9">FourierTransform</a></div><div class="ttdeci">void FourierTransform(const MultidimArray&lt; double &gt; &amp;in, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8cpp_source.html#l00124">xmipp_fft.cpp:124</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a8540e7e059c7bc46e2a010d25225d08b"><div class="ttname"><a href="classProgMLF2D.html#a8540e7e059c7bc46e2a010d25225d08b">ProgMLF2D::writeNoiseFile</a></div><div class="ttdeci">void writeNoiseFile(const FileName &amp;fn_base, int ifocus)</div><div class="ttdoc">Write noise estimation per resolution. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l02848">mlf_align2d.cpp:2848</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga53e37122134100316031eae982abee03"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a></div><div class="ttdeci">#define dAi(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00540">multidim_array.h:540</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aabda7431146b956debfa7f89164af1790"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aabda7431146b956debfa7f89164af1790">ERR_IO_NOTOPEN</a></div><div class="ttdoc">File cannot be open. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00142">xmipp_error.h:142</a></div></div>
<div class="ttc" id="classXmippProgram_html_a074c10cbbaa660749bbc2778592a54c4"><div class="ttname"><a href="classXmippProgram.html#a074c10cbbaa660749bbc2778592a54c4">XmippProgram::setProgress</a></div><div class="ttdeci">void setProgress(size_t value=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00319">xmipp_program.cpp:319</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga82c19639b510d33894fe268664130410"><div class="ttname"><a href="group__GeometricalTransformations.html#ga82c19639b510d33894fe268664130410">radialAverage</a></div><div class="ttdeci">void radialAverage(const MultidimArray&lt; T &gt; &amp;m, Matrix1D&lt; int &gt; &amp;center_of_rot, MultidimArray&lt; T &gt; &amp;radial_mean, MultidimArray&lt; int &gt; &amp;radial_count, const bool &amp;rounding=false)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01575">transformations.h:1575</a></div></div>
<div class="ttc" id="xmipp__log_8h_html_a9d0e78c69b9733e4419a5f65d5a38a3a"><div class="ttname"><a href="xmipp__log_8h.html#a9d0e78c69b9733e4419a5f65d5a38a3a">LOG_FUNCTION</a></div><div class="ttdeci">#define LOG_FUNCTION()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__log_8h_source.html#l00090">xmipp_log.h:90</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a080fbf81a2b9dfceab4cfe1a649f13a4"><div class="ttname"><a href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">ML2DBaseProgram::MDimg</a></div><div class="ttdeci">MetaData MDimg</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00172">ml2d.h:172</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; int &gt;</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="xmipp__strings_8h_html_afbeda3fd1bdc8c37d01bdf9f5c8274ff"><div class="ttname"><a href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a></div><div class="ttdeci">std::string String</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__strings_8h_source.html#l00034">xmipp_strings.h:34</a></div></div>
<div class="ttc" id="classProgMLF2D_html_af1176823dd265484796aa9b52215719e"><div class="ttname"><a href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">ProgMLF2D::sampling</a></div><div class="ttdeci">double sampling</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00102">mlf_align2d.h:102</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gace9129bcfa1cd128950b15385abff09f"><div class="ttname"><a href="group__MLFalign2D.html#gace9129bcfa1cd128950b15385abff09f">FN_VSIG</a></div><div class="ttdeci">#define FN_VSIG(base, ifocus, ext)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00066">mlf_align2d.h:66</a></div></div>
<div class="ttc" id="classImageBase_html_a88636b7a7bd4e0e454877e691ee2da84"><div class="ttname"><a href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">ImageBase::read</a></div><div class="ttdeci">int read(const FileName &amp;name, DataMode datamode=DATA, size_t select_img=ALL_IMAGES, bool mapData=false, int mode=WRITE_READONLY)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00061">xmipp_image_base.cpp:61</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a5c75192acc215ccf8e062881d14f9ac4"><div class="ttname"><a href="classProgMLF2D.html#a5c75192acc215ccf8e062881d14f9ac4">ProgMLF2D::count_defocus</a></div><div class="ttdeci">std::vector&lt; int &gt; count_defocus</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00104">mlf_align2d.h:104</a></div></div>
<div class="ttc" id="group__FourierW_html_ga1075fe73c87077296a879f44ded3a2c3"><div class="ttname"><a href="group__FourierW.html#ga1075fe73c87077296a879f44ded3a2c3">FFT_magnitude</a></div><div class="ttdeci">void FFT_magnitude(const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;v, MultidimArray&lt; double &gt; &amp;mag)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00393">xmipp_fftw.cpp:393</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gaea9964961fe272b8b7277239202912cb"><div class="ttname"><a href="group__MLFalign2D.html#gaea9964961fe272b8b7277239202912cb">VSIG_ITEM</a></div><div class="ttdeci">#define VSIG_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00049">mlf_align2d.h:49</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a></div><div class="ttdoc">Name of an image (std::string) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00235">metadata_label.h:235</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab8d02bc5f161f68226d359e166dad892"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::expectation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Integrate over all experimental images. </p>

<p>Implements <a class="el" href="classML2DBaseProgram.html#a62778b1cb42318b12c19042fb85f58a7">ML2DBaseProgram</a>.</p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l02297">2297</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;{</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;    <a class="code" href="classImage.html">Image&lt;double&gt;</a> img;</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    <a class="code" href="classFileName.html">FileName</a> <a class="code" href="classML2DBaseProgram.html#a4e593a9112ddcc0256bc9b72213cdb3b">fn_img</a>, fn_trans;</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;    std::vector&lt;double&gt; allref_offsets, pdf_directions(<a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a>);</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> trans(2);</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> opt_offsets(2);</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    <span class="keywordtype">float</span> old_phi = -999., old_theta = -999.;</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;    <span class="keywordtype">double</span> opt_psi, opt_flip, opt_scale, maxcorr, maxweight2;</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    <span class="keywordtype">double</span> w2, KSprob = 0.;</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;    <span class="keywordtype">size_t</span> opt_refno, opt_ipsi, opt_iflip;</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    <span class="keywordtype">int</span> focus = 0;</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    <span class="keywordtype">bool</span> apply_ctf;</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;    <span class="comment">// Pre-calculate pdfs</span></div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    <a class="code" href="classProgMLF2D.html#aaf2dca554cdb8f87793b36dedf8e744a">calculatePdfInplane</a>();</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    <span class="comment">// Generate (FT of) each rotated version of all references</span></div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    <a class="code" href="classProgMLF2D.html#a4518fb4fdc375d19d4439d32a6a60d71">rotateReference</a>(<a class="code" href="classProgMLF2D.html#a3e59aa87465a609828f311a1b40f0ea9">Fref</a>);</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;    <span class="comment">// Initialize progress bar</span></div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    <a class="code" href="classXmippProgram.html#aea0549c1e40215ee12b1abc36648b39a">initProgress</a>(<a class="code" href="classML2DBaseProgram.html#ac53bad3c2339d92ebbda4ba5abe7aa57">nr_images_local</a>);</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    trans.initZeros();</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a>;</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    <span class="comment">// Set all weighted sums to zero</span></div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;    <a class="code" href="classProgMLF2D.html#a0a90a0680ddfe59efa8bac1303fada63">sumw</a>.assign(n, 0.);</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;    <a class="code" href="classProgMLF2D.html#a07e1e912286ab9303da3d4a654d26dd6">sumw2</a>.assign(n, 0.);</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;    <a class="code" href="classProgMLF2D.html#a92faef343a74868a005e5de666778470">sumwsc</a>.assign(n, 0.);</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    <a class="code" href="classProgMLF2D.html#ab34721b1edbfbb6b3feb83c1aa825166">sumwsc2</a>.assign(n, 0.);</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    <a class="code" href="classProgMLF2D.html#a86adb43015401e250b579f9d49f00730">sumw_mirror</a>.assign(n, 0.);</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    <a class="code" href="classProgMLF2D.html#a9c42feb7d8cbf224f91e903bac49663e">sumw_defocus</a>.clear();</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    <a class="code" href="classProgMLF2D.html#af78a059d07b955ccd42e8a17ef827d19">Mwsum_sigma2</a>.clear();</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    <a class="code" href="classProgMLF2D.html#a0b8e2ceb24d15d08f35c4549b1bef95a">Fwsum_imgs</a>.clear();</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;    <a class="code" href="classProgMLF2D.html#aff2c6db0108d1ef849c88221a1506ef8">Fwsum_ctfimgs</a>.clear();</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    <a class="code" href="classProgMLF2D.html#a62bd5315721add5edf8b74e19c7d2de8">LL</a> = 0.;</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    <a class="code" href="classProgMLF2D.html#ae311e353866c6ac035c8f795ee2e1a6b">wsum_sigma_offset</a> = 0.;</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    <a class="code" href="classProgMLF2D.html#abc9875f9cb5025678bebb8eff54a1118">sumcorr</a> = 0.;</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    std::vector&lt;double&gt; dum;</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    dum.assign(<a class="code" href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">nr_points_2d</a>, 0.);</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    <a class="code" href="classProgMLF2D.html#af78a059d07b955ccd42e8a17ef827d19">Mwsum_sigma2</a>.assign(<a class="code" href="classProgMLF2D.html#a7e08de076e12e519d59f5e39854f1dc5">nr_focus</a>, dum);</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a> &amp;&amp; <a class="code" href="classProgMLF2D.html#aad176d8656485e60ed725b2754a070aa">do_student_sigma_trick</a>)</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        <a class="code" href="classProgMLF2D.html#a9c42feb7d8cbf224f91e903bac49663e">sumw_defocus</a>.assign(<a class="code" href="classProgMLF2D.html#a7e08de076e12e519d59f5e39854f1dc5">nr_focus</a>, 0.);</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;    {</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;        <a class="code" href="group__MLFalign2D.html#gab39599380e42cadda13b0cfb14588d46">FOR_ALL_DEFOCUS_GROUPS</a>()</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;        {</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;            <a class="code" href="classProgMLF2D.html#a9c42feb7d8cbf224f91e903bac49663e">sumw_defocus</a>.push_back((<span class="keywordtype">double</span>)<a class="code" href="classProgMLF2D.html#a5c75192acc215ccf8e062881d14f9ac4">count_defocus</a>[ifocus]);</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;        }</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;    }</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a2839dd97c6d6098e665b16bed661b615">dnr_points_2d</a> &gt; 0)</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;    {</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a03cb6822d714181506765a7df4f70ee7">nn</a> = n * <a class="code" href="classML2DBaseProgram.html#a976dc404489a0c66af2800f0f73e76c7">nr_psi</a> * <a class="code" href="classProgMLF2D.html#a2839dd97c6d6098e665b16bed661b615">dnr_points_2d</a>;</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;        <a class="code" href="classProgMLF2D.html#a0b8e2ceb24d15d08f35c4549b1bef95a">Fwsum_imgs</a>.assign(nn, 0.);</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;        <span class="keywordflow">if</span>  (<a class="code" href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">do_ctf_correction</a>)</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;            <a class="code" href="classProgMLF2D.html#aff2c6db0108d1ef849c88221a1506ef8">Fwsum_ctfimgs</a>.assign(nn, 0.);</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    }</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;    std::stringstream ss;</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;    <a class="code" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a> s;</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;    <span class="comment">// Loop over all images</span></div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;    <a class="code" href="ml2d_8h.html#a63b804f3c807ffe0259b3ee45cb19693">FOR_ALL_LOCAL_IMAGES</a>()</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;    {</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;        <span class="keywordtype">size_t</span> <span class="keywordtype">id</span> = <a class="code" href="classML2DBaseProgram.html#a3464cb9938eb4cf849b7c8bbb354734f">img_id</a>[imgno];</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;        <a class="code" href="classML2DBaseProgram.html#ab31f295dfdeb52bada9f0ca819c8fb29">current_image</a> = imgno;</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;        focus = 0;</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;        <span class="comment">// Get defocus-group</span></div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">do_ctf_correction</a>)</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a7d9d585d218e22d9569dae329fb0c538">MDL_DEFGROUP</a>, focus, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;        <span class="comment">//std::cerr &lt;&lt; formatString(&quot;processing img: %lu with id: %lu\n&quot;, imgno, id);</span></div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a>, fn_img, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;        <span class="comment">//std::cerr &lt;&lt; formatString(&quot;   filename: %s\n&quot;, fn_img.c_str());</span></div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;        <span class="comment">//img.read(fn_img, false, false, false, false);</span></div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;        img.<a class="code" href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">read</a>(fn_img);</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;        img().setXmippOrigin();</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;        <span class="comment">// Get optimal offsets for all references</span></div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;        allref_offsets = <a class="code" href="classML2DBaseProgram.html#adb224115e7f853ead371caf7a3767fa4">imgs_offsets</a>[<a class="code" href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a>];</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;        <span class="comment">// Read optimal orientations from memory</span></div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a549ca4cda193eb449087f9a316c61f20">limit_rot</a>)</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;        {</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;            old_phi = <a class="code" href="classML2DBaseProgram.html#a2d817d670cd567d427da30fad46f5592">imgs_oldphi</a>[<a class="code" href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a>];</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;            old_theta = <a class="code" href="classML2DBaseProgram.html#ae0d684b9bbe78bfa5ed5ad2610dc4fbe">imgs_oldtheta</a>[<a class="code" href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a>];</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;        }</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">do_norm</a>)</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;        {</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;            opt_scale = <a class="code" href="classML2DBaseProgram.html#ab7caa861fcd7c5a139c0a0825c1abbe0">imgs_scale</a>[<a class="code" href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a>];</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;        }</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;        <span class="comment">// For limited orientational search: preselect relevant directions</span></div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;        <a class="code" href="classProgMLF2D.html#ae2c6d5b3598c2851c1919661965cee74">preselectDirections</a>(old_phi, old_theta, pdf_directions);</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;        <span class="comment">// Perform the actual expectation step for this image</span></div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;        apply_ctf = !(<a class="code" href="classML2DBaseProgram.html#a20e2b948711e3e66894740b99e8cf017">iter</a> == 1 &amp;&amp; <a class="code" href="classProgMLF2D.html#a5e967d6a01f0dcdce99c62e591bb7995">first_iter_noctf</a>);</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;        <a class="code" href="classProgMLF2D.html#a9d77accb6928b8ef9febe0cc57883c28">processOneImage</a>(img(), focus, apply_ctf, maxcorr, maxweight2, w2,</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;                        opt_scale, opt_refno, opt_psi, opt_ipsi, opt_iflip, opt_offsets,</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;                        allref_offsets, pdf_directions,</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;                        <a class="code" href="classProgMLF2D.html#a79873ba6ac0a02ebff149285475a8721">do_kstest</a>, <a class="code" href="classML2DBaseProgram.html#a20e2b948711e3e66894740b99e8cf017">iter</a>==<a class="code" href="classProgMLF2D.html#a1bd3c9e0f12cfa45daa109e0c96c3f28">iter_write_histograms</a>, fn_img, KSprob);</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;        <span class="comment">// for t-student, update sumw_defocus</span></div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a> &amp;&amp; <a class="code" href="classProgMLF2D.html#aad176d8656485e60ed725b2754a070aa">do_student_sigma_trick</a>)</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;        {</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classXmippProgram.html#a0130b89f1f5431b03ef161d7e231bd48">debug</a>==8)</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;                std::cerr&lt;&lt;<span class="stringliteral">&quot;sumw_defocus[focus]= &quot;</span>&lt;&lt;<a class="code" href="classProgMLF2D.html#a9c42feb7d8cbf224f91e903bac49663e">sumw_defocus</a>[focus]&lt;&lt;<span class="stringliteral">&quot; w2= &quot;</span>&lt;&lt;w2&lt;&lt;std::endl;</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;            <a class="code" href="classProgMLF2D.html#a9c42feb7d8cbf224f91e903bac49663e">sumw_defocus</a>[focus] += w2;</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;        }</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;        <span class="comment">// Store optimal scale in memory</span></div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">do_norm</a>)</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;        {</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;            <a class="code" href="classML2DBaseProgram.html#ab7caa861fcd7c5a139c0a0825c1abbe0">imgs_scale</a>[<a class="code" href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a>] = opt_scale;</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;        }</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;        <span class="comment">// Store optimal translations</span></div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;        <a class="code" href="classML2DBaseProgram.html#adb224115e7f853ead371caf7a3767fa4">imgs_offsets</a>[<a class="code" href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a>] = allref_offsets;</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;        <span class="comment">// Store optimal phi and theta in memory</span></div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a549ca4cda193eb449087f9a316c61f20">limit_rot</a>)</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;        {</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a2d817d670cd567d427da30fad46f5592">imgs_oldphi</a>[<a class="code" href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a>] = <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>[opt_refno].rot();</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;            <a class="code" href="classML2DBaseProgram.html#ae0d684b9bbe78bfa5ed5ad2610dc4fbe">imgs_oldtheta</a>[<a class="code" href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a>] = <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>[opt_refno].tilt();</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;        }</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;        <span class="comment">// Output docfile</span></div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;        <a class="code" href="classProgMLF2D.html#abc9875f9cb5025678bebb8eff54a1118">sumcorr</a> += maxcorr;</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;        opt_flip = 0.;</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;        <span class="keywordflow">if</span> (-opt_psi &gt; 360.)</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;        {</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;            opt_psi += 360.;</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;            opt_flip = 1.;</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;        }</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(<a class="code" href="classML2DBaseProgram.html#a0ddfa227d1aec7fcfd31cb2c23ec3d0f">docfiledata</a>,<a class="code" href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a>,0)</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;        = <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>[opt_refno].rot(); <span class="comment">// rot</span></div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(<a class="code" href="classML2DBaseProgram.html#a0ddfa227d1aec7fcfd31cb2c23ec3d0f">docfiledata</a>,<a class="code" href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a>,1)</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;        = <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>[opt_refno].tilt(); <span class="comment">// tilt</span></div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(<a class="code" href="classML2DBaseProgram.html#a0ddfa227d1aec7fcfd31cb2c23ec3d0f">docfiledata</a>,<a class="code" href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a>,2) = opt_psi + 360.; <span class="comment">// psi</span></div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(<a class="code" href="classML2DBaseProgram.html#a0ddfa227d1aec7fcfd31cb2c23ec3d0f">docfiledata</a>,<a class="code" href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a>,3) = trans(0) + opt_offsets(0); <span class="comment">// Xoff</span></div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(<a class="code" href="classML2DBaseProgram.html#a0ddfa227d1aec7fcfd31cb2c23ec3d0f">docfiledata</a>,<a class="code" href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a>,4) = trans(1) + opt_offsets(1); <span class="comment">// Yoff</span></div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(<a class="code" href="classML2DBaseProgram.html#a0ddfa227d1aec7fcfd31cb2c23ec3d0f">docfiledata</a>,<a class="code" href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a>,5) = (double) (opt_refno + 1); <span class="comment">// Ref</span></div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(<a class="code" href="classML2DBaseProgram.html#a0ddfa227d1aec7fcfd31cb2c23ec3d0f">docfiledata</a>,<a class="code" href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a>,6) = opt_flip; <span class="comment">// Mirror</span></div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(<a class="code" href="classML2DBaseProgram.html#a0ddfa227d1aec7fcfd31cb2c23ec3d0f">docfiledata</a>,<a class="code" href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a>,7) = maxcorr; <span class="comment">// P_max/P_tot</span></div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a>)</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;        {</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(<a class="code" href="classML2DBaseProgram.html#a0ddfa227d1aec7fcfd31cb2c23ec3d0f">docfiledata</a>,<a class="code" href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a>,8) = maxweight2; <span class="comment">// Robustness weight</span></div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;        }</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">do_norm</a>)</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;        {</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(<a class="code" href="classML2DBaseProgram.html#a0ddfa227d1aec7fcfd31cb2c23ec3d0f">docfiledata</a>,<a class="code" href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a>,9) = opt_scale; <span class="comment">// image scale</span></div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;        }</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a79873ba6ac0a02ebff149285475a8721">do_kstest</a>)</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;        {</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(<a class="code" href="classML2DBaseProgram.html#a0ddfa227d1aec7fcfd31cb2c23ec3d0f">docfiledata</a>,<a class="code" href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a>,10) = KSprob;</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;        }</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;        <span class="comment">// Report progress bar</span></div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;        <a class="code" href="classXmippProgram.html#a074c10cbbaa660749bbc2778592a54c4">setProgress</a>();</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    }</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    <a class="code" href="classXmippProgram.html#aef9f1a6f495c898cb12eac9a7922a84c">endProgress</a>();</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">do_ctf_correction</a>)</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    {</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;        <a class="code" href="classProgMLF2D.html#a191c8f337bb393b5c8ea9d45e1e7b1a6">reverseRotateReference</a>(<a class="code" href="classProgMLF2D.html#aff2c6db0108d1ef849c88221a1506ef8">Fwsum_ctfimgs</a>,<a class="code" href="classProgMLF2D.html#a7126f012ef6183355f71114a35f7149f">wsum_ctfMref</a>);</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;    }</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    <a class="code" href="classProgMLF2D.html#a191c8f337bb393b5c8ea9d45e1e7b1a6">reverseRotateReference</a>(<a class="code" href="classProgMLF2D.html#a0b8e2ceb24d15d08f35c4549b1bef95a">Fwsum_imgs</a>,<a class="code" href="classProgMLF2D.html#a7b5bd8fb49b6864cdfcba9779bb163d2">wsum_Mref</a>);</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;}</div><div class="ttc" id="classML2DBaseProgram_html_a976dc404489a0c66af2800f0f73e76c7"><div class="ttname"><a href="classML2DBaseProgram.html#a976dc404489a0c66af2800f0f73e76c7">ML2DBaseProgram::nr_psi</a></div><div class="ttdeci">size_t nr_psi</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00154">ml2d.h:154</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a8402eab40b0e66cd7aee78b747720af9"><div class="ttname"><a href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">ProgMLF2D::do_student</a></div><div class="ttdeci">bool do_student</div><div class="ttdoc">IN DEVELOPMENT. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00135">mlf_align2d.h:135</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a0b8e2ceb24d15d08f35c4549b1bef95a"><div class="ttname"><a href="classProgMLF2D.html#a0b8e2ceb24d15d08f35c4549b1bef95a">ProgMLF2D::Fwsum_imgs</a></div><div class="ttdeci">std::vector&lt; double &gt; Fwsum_imgs</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00157">mlf_align2d.h:157</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ae311e353866c6ac035c8f795ee2e1a6b"><div class="ttname"><a href="classProgMLF2D.html#ae311e353866c6ac035c8f795ee2e1a6b">ProgMLF2D::wsum_sigma_offset</a></div><div class="ttdeci">double wsum_sigma_offset</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00153">mlf_align2d.h:153</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a3464cb9938eb4cf849b7c8bbb354734f"><div class="ttname"><a href="classML2DBaseProgram.html#a3464cb9938eb4cf849b7c8bbb354734f">ML2DBaseProgram::img_id</a></div><div class="ttdeci">std::vector&lt; size_t &gt; img_id</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00232">ml2d.h:232</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a03cb6822d714181506765a7df4f70ee7"><div class="ttname"><a href="numerical__recipes_8cpp.html#a03cb6822d714181506765a7df4f70ee7">nn</a></div><div class="ttdeci">nn</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04717">numerical_recipes.cpp:4717</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="ml2d_8h_html_a63b804f3c807ffe0259b3ee45cb19693"><div class="ttname"><a href="ml2d_8h.html#a63b804f3c807ffe0259b3ee45cb19693">FOR_ALL_LOCAL_IMAGES</a></div><div class="ttdeci">#define FOR_ALL_LOCAL_IMAGES()</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00064">ml2d.h:64</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a20e2b948711e3e66894740b99e8cf017"><div class="ttname"><a href="classML2DBaseProgram.html#a20e2b948711e3e66894740b99e8cf017">ML2DBaseProgram::iter</a></div><div class="ttdeci">int iter</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00147">ml2d.h:147</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a5578230b3fb9e054c437e187cb0ad5d3"><div class="ttname"><a href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">ML2DBaseProgram::model</a></div><div class="ttdeci">ModelML2D model</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00224">ml2d.h:224</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a62bd5315721add5edf8b74e19c7d2de8"><div class="ttname"><a href="classProgMLF2D.html#a62bd5315721add5edf8b74e19c7d2de8">ProgMLF2D::LL</a></div><div class="ttdeci">double LL</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00153">mlf_align2d.h:153</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a4518fb4fdc375d19d4439d32a6a60d71"><div class="ttname"><a href="classProgMLF2D.html#a4518fb4fdc375d19d4439d32a6a60d71">ProgMLF2D::rotateReference</a></div><div class="ttdeci">void rotateReference(std::vector&lt; double &gt; &amp;out)</div><div class="ttdoc">Fill vector of matrices with all rotations of reference. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l01330">mlf_align2d.cpp:1330</a></div></div>
<div class="ttc" id="classXmippProgram_html_aea0549c1e40215ee12b1abc36648b39a"><div class="ttname"><a href="classXmippProgram.html#aea0549c1e40215ee12b1abc36648b39a">XmippProgram::initProgress</a></div><div class="ttdeci">void initProgress(size_t total, size_t stepBin=60)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00307">xmipp_program.cpp:307</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a4e593a9112ddcc0256bc9b72213cdb3b"><div class="ttname"><a href="classML2DBaseProgram.html#a4e593a9112ddcc0256bc9b72213cdb3b">ML2DBaseProgram::fn_img</a></div><div class="ttdeci">FileName fn_img</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00132">ml2d.h:132</a></div></div>
<div class="ttc" id="classModelML2D_html_a63a3a3534d1cb72a9db046508b9a59f6"><div class="ttname"><a href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">ModelML2D::n_ref</a></div><div class="ttdeci">int n_ref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00083">ml2d.h:83</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a9c42feb7d8cbf224f91e903bac49663e"><div class="ttname"><a href="classProgMLF2D.html#a9c42feb7d8cbf224f91e903bac49663e">ProgMLF2D::sumw_defocus</a></div><div class="ttdeci">std::vector&lt; double &gt; sumw_defocus</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00156">mlf_align2d.h:156</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ae2c6d5b3598c2851c1919661965cee74"><div class="ttname"><a href="classProgMLF2D.html#ae2c6d5b3598c2851c1919661965cee74">ProgMLF2D::preselectDirections</a></div><div class="ttdeci">void preselectDirections(float &amp;phi, float &amp;theta, std::vector&lt; double &gt; &amp;pdf_directions)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l01406">mlf_align2d.cpp:1406</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gab39599380e42cadda13b0cfb14588d46"><div class="ttname"><a href="group__MLFalign2D.html#gab39599380e42cadda13b0cfb14588d46">FOR_ALL_DEFOCUS_GROUPS</a></div><div class="ttdeci">#define FOR_ALL_DEFOCUS_GROUPS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00040">mlf_align2d.h:40</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a5e967d6a01f0dcdce99c62e591bb7995"><div class="ttname"><a href="classProgMLF2D.html#a5e967d6a01f0dcdce99c62e591bb7995">ProgMLF2D::first_iter_noctf</a></div><div class="ttdeci">bool first_iter_noctf</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00118">mlf_align2d.h:118</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a1bd3c9e0f12cfa45daa109e0c96c3f28"><div class="ttname"><a href="classProgMLF2D.html#a1bd3c9e0f12cfa45daa109e0c96c3f28">ProgMLF2D::iter_write_histograms</a></div><div class="ttdeci">int iter_write_histograms</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00143">mlf_align2d.h:143</a></div></div>
<div class="ttc" id="classXmippProgram_html_aef9f1a6f495c898cb12eac9a7922a84c"><div class="ttname"><a href="classXmippProgram.html#aef9f1a6f495c898cb12eac9a7922a84c">XmippProgram::endProgress</a></div><div class="ttdeci">void endProgress()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00327">xmipp_program.cpp:327</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00068">xmipp_filename.h:68</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a7e08de076e12e519d59f5e39854f1dc5"><div class="ttname"><a href="classProgMLF2D.html#a7e08de076e12e519d59f5e39854f1dc5">ProgMLF2D::nr_focus</a></div><div class="ttdeci">size_t nr_focus</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00114">mlf_align2d.h:114</a></div></div>
<div class="ttc" id="ml2d_8h_html_a5c733b69a54d6f6997b09d41b77ec37f"><div class="ttname"><a href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a></div><div class="ttdeci">#define IMG_LOCAL_INDEX</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00067">ml2d.h:67</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ab34721b1edbfbb6b3feb83c1aa825166"><div class="ttname"><a href="classProgMLF2D.html#ab34721b1edbfbb6b3feb83c1aa825166">ProgMLF2D::sumwsc2</a></div><div class="ttdeci">std::vector&lt; double &gt; sumwsc2</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00156">mlf_align2d.h:156</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a9e143fabdc67d1ee8cd67dcad98e74fc"><div class="ttname"><a href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">ML2DBaseProgram::do_norm</a></div><div class="ttdeci">bool do_norm</div><div class="ttdoc">Re-normalize internally. </div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00207">ml2d.h:207</a></div></div>
<div class="ttc" id="classMetaData_html_a2239fbb7e492654f1e2866ab27492a5d"><div class="ttname"><a href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">MetaData::getValue</a></div><div class="ttdeci">bool getValue(MDObject &amp;mdValueOut, size_t id) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00217">metadata.cpp:217</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ac53bad3c2339d92ebbda4ba5abe7aa57"><div class="ttname"><a href="classML2DBaseProgram.html#ac53bad3c2339d92ebbda4ba5abe7aa57">ML2DBaseProgram::nr_images_local</a></div><div class="ttdeci">size_t nr_images_local</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00166">ml2d.h:166</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a549ca4cda193eb449087f9a316c61f20"><div class="ttname"><a href="classML2DBaseProgram.html#a549ca4cda193eb449087f9a316c61f20">ML2DBaseProgram::limit_rot</a></div><div class="ttdeci">bool limit_rot</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00188">ml2d.h:188</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a79873ba6ac0a02ebff149285475a8721"><div class="ttname"><a href="classProgMLF2D.html#a79873ba6ac0a02ebff149285475a8721">ProgMLF2D::do_kstest</a></div><div class="ttdeci">bool do_kstest</div><div class="ttdoc">Statistical analysis of the noise distributions. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00141">mlf_align2d.h:141</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ae0d684b9bbe78bfa5ed5ad2610dc4fbe"><div class="ttname"><a href="classML2DBaseProgram.html#ae0d684b9bbe78bfa5ed5ad2610dc4fbe">ML2DBaseProgram::imgs_oldtheta</a></div><div class="ttdeci">std::vector&lt; double &gt; imgs_oldtheta</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00194">ml2d.h:194</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a2839dd97c6d6098e665b16bed661b615"><div class="ttname"><a href="classProgMLF2D.html#a2839dd97c6d6098e665b16bed661b615">ProgMLF2D::dnr_points_2d</a></div><div class="ttdeci">size_t dnr_points_2d</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00127">mlf_align2d.h:127</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a7d9d585d218e22d9569dae329fb0c538"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a7d9d585d218e22d9569dae329fb0c538">MDL_DEFGROUP</a></div><div class="ttdoc">Defocus group. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00210">metadata_label.h:210</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a7b5bd8fb49b6864cdfcba9779bb163d2"><div class="ttname"><a href="classProgMLF2D.html#a7b5bd8fb49b6864cdfcba9779bb163d2">ProgMLF2D::wsum_Mref</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; double &gt; &gt; wsum_Mref</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00154">mlf_align2d.h:154</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a191c8f337bb393b5c8ea9d45e1e7b1a6"><div class="ttname"><a href="classProgMLF2D.html#a191c8f337bb393b5c8ea9d45e1e7b1a6">ProgMLF2D::reverseRotateReference</a></div><div class="ttdeci">void reverseRotateReference(const std::vector&lt; double &gt; &amp;in, std::vector&lt; MultidimArray&lt; double &gt; &gt; &amp;out)</div><div class="ttdoc">Apply reverse rotations to all matrices in vector and fill new matrix with their sum. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l01375">mlf_align2d.cpp:1375</a></div></div>
<div class="ttc" id="classProgMLF2D_html_aad176d8656485e60ed725b2754a070aa"><div class="ttname"><a href="classProgMLF2D.html#aad176d8656485e60ed725b2754a070aa">ProgMLF2D::do_student_sigma_trick</a></div><div class="ttdeci">bool do_student_sigma_trick</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00137">mlf_align2d.h:137</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a0ddfa227d1aec7fcfd31cb2c23ec3d0f"><div class="ttname"><a href="classML2DBaseProgram.html#a0ddfa227d1aec7fcfd31cb2c23ec3d0f">ML2DBaseProgram::docfiledata</a></div><div class="ttdeci">MultidimArray&lt; double &gt; docfiledata</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00234">ml2d.h:234</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_adb224115e7f853ead371caf7a3767fa4"><div class="ttname"><a href="classML2DBaseProgram.html#adb224115e7f853ead371caf7a3767fa4">ML2DBaseProgram::imgs_offsets</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; imgs_offsets</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00200">ml2d.h:200</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gafa02b309a507bf04daf9f31fa828ce4f"><div class="ttname"><a href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a></div><div class="ttdeci">#define dAij(M, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00355">multidim_array.h:355</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a7c3f7c47054265ad3589ee6d40764fbc"><div class="ttname"><a href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">ProgMLF2D::do_ctf_correction</a></div><div class="ttdeci">bool do_ctf_correction</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00100">mlf_align2d.h:100</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a2d817d670cd567d427da30fad46f5592"><div class="ttname"><a href="classML2DBaseProgram.html#a2d817d670cd567d427da30fad46f5592">ML2DBaseProgram::imgs_oldphi</a></div><div class="ttdeci">std::vector&lt; double &gt; imgs_oldphi</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00194">ml2d.h:194</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a92faef343a74868a005e5de666778470"><div class="ttname"><a href="classProgMLF2D.html#a92faef343a74868a005e5de666778470">ProgMLF2D::sumwsc</a></div><div class="ttdeci">std::vector&lt; double &gt; sumwsc</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00156">mlf_align2d.h:156</a></div></div>
<div class="ttc" id="classXmippProgram_html_a0130b89f1f5431b03ef161d7e231bd48"><div class="ttname"><a href="classXmippProgram.html#a0130b89f1f5431b03ef161d7e231bd48">XmippProgram::debug</a></div><div class="ttdeci">int debug</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8h_source.html#l00170">xmipp_program.h:170</a></div></div>
<div class="ttc" id="classXmippProgram_html_a074c10cbbaa660749bbc2778592a54c4"><div class="ttname"><a href="classXmippProgram.html#a074c10cbbaa660749bbc2778592a54c4">XmippProgram::setProgress</a></div><div class="ttdeci">void setProgress(size_t value=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00319">xmipp_program.cpp:319</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a0a90a0680ddfe59efa8bac1303fada63"><div class="ttname"><a href="classProgMLF2D.html#a0a90a0680ddfe59efa8bac1303fada63">ProgMLF2D::sumw</a></div><div class="ttdeci">std::vector&lt; double &gt; sumw</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00156">mlf_align2d.h:156</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a3e59aa87465a609828f311a1b40f0ea9"><div class="ttname"><a href="classProgMLF2D.html#a3e59aa87465a609828f311a1b40f0ea9">ProgMLF2D::Fref</a></div><div class="ttdeci">std::vector&lt; double &gt; Fref</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00157">mlf_align2d.h:157</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a86adb43015401e250b579f9d49f00730"><div class="ttname"><a href="classProgMLF2D.html#a86adb43015401e250b579f9d49f00730">ProgMLF2D::sumw_mirror</a></div><div class="ttdeci">std::vector&lt; double &gt; sumw_mirror</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00156">mlf_align2d.h:156</a></div></div>
<div class="ttc" id="classModelML2D_html_a29baa2fb66177265cb0de6d027ea454a"><div class="ttname"><a href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">ModelML2D::Iref</a></div><div class="ttdeci">std::vector&lt; Image&lt; double &gt; &gt; Iref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00085">ml2d.h:85</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a080fbf81a2b9dfceab4cfe1a649f13a4"><div class="ttname"><a href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">ML2DBaseProgram::MDimg</a></div><div class="ttdeci">MetaData MDimg</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00172">ml2d.h:172</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a07e1e912286ab9303da3d4a654d26dd6"><div class="ttname"><a href="classProgMLF2D.html#a07e1e912286ab9303da3d4a654d26dd6">ProgMLF2D::sumw2</a></div><div class="ttdeci">std::vector&lt; double &gt; sumw2</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00156">mlf_align2d.h:156</a></div></div>
<div class="ttc" id="classProgMLF2D_html_aff2c6db0108d1ef849c88221a1506ef8"><div class="ttname"><a href="classProgMLF2D.html#aff2c6db0108d1ef849c88221a1506ef8">ProgMLF2D::Fwsum_ctfimgs</a></div><div class="ttdeci">std::vector&lt; double &gt; Fwsum_ctfimgs</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00157">mlf_align2d.h:157</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="xmipp__strings_8h_html_afbeda3fd1bdc8c37d01bdf9f5c8274ff"><div class="ttname"><a href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a></div><div class="ttdeci">std::string String</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__strings_8h_source.html#l00034">xmipp_strings.h:34</a></div></div>
<div class="ttc" id="classProgMLF2D_html_af78a059d07b955ccd42e8a17ef827d19"><div class="ttname"><a href="classProgMLF2D.html#af78a059d07b955ccd42e8a17ef827d19">ProgMLF2D::Mwsum_sigma2</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; Mwsum_sigma2</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00155">mlf_align2d.h:155</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a9d77accb6928b8ef9febe0cc57883c28"><div class="ttname"><a href="classProgMLF2D.html#a9d77accb6928b8ef9febe0cc57883c28">ProgMLF2D::processOneImage</a></div><div class="ttdeci">void processOneImage(const MultidimArray&lt; double &gt; &amp;Mimg, size_t focus, bool apply_ctf, double &amp;fracweight, double &amp;maxweight2, double &amp;sum_refw2, double &amp;opt_scale, size_t &amp;opt_refno, double &amp;opt_psi, size_t &amp;opt_ipsi, size_t &amp;opt_iflip, MultidimArray&lt; double &gt; &amp;opt_offsets, std::vector&lt; double &gt; &amp;opt_offsets_ref, std::vector&lt; double &gt; &amp;pdf_directions, bool do_kstest, bool write_histograms, FileName fn_img, double &amp;KSprob)</div><div class="ttdoc">Perform expectation step for a single image. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l01585">mlf_align2d.cpp:1585</a></div></div>
<div class="ttc" id="classProgMLF2D_html_aaf2dca554cdb8f87793b36dedf8e744a"><div class="ttname"><a href="classProgMLF2D.html#aaf2dca554cdb8f87793b36dedf8e744a">ProgMLF2D::calculatePdfInplane</a></div><div class="ttdeci">void calculatePdfInplane()</div><div class="ttdoc">Calculate probability density distribution for in-plane transformations. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l01250">mlf_align2d.cpp:1250</a></div></div>
<div class="ttc" id="classImageBase_html_a88636b7a7bd4e0e454877e691ee2da84"><div class="ttname"><a href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">ImageBase::read</a></div><div class="ttdeci">int read(const FileName &amp;name, DataMode datamode=DATA, size_t select_img=ALL_IMAGES, bool mapData=false, int mode=WRITE_READONLY)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00061">xmipp_image_base.cpp:61</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a5c75192acc215ccf8e062881d14f9ac4"><div class="ttname"><a href="classProgMLF2D.html#a5c75192acc215ccf8e062881d14f9ac4">ProgMLF2D::count_defocus</a></div><div class="ttdeci">std::vector&lt; int &gt; count_defocus</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00104">mlf_align2d.h:104</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a></div><div class="ttdoc">Name of an image (std::string) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00235">metadata_label.h:235</a></div></div>
<div class="ttc" id="classProgMLF2D_html_abc9875f9cb5025678bebb8eff54a1118"><div class="ttname"><a href="classProgMLF2D.html#abc9875f9cb5025678bebb8eff54a1118">ProgMLF2D::sumcorr</a></div><div class="ttdeci">double sumcorr</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00153">mlf_align2d.h:153</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ab31f295dfdeb52bada9f0ca819c8fb29"><div class="ttname"><a href="classML2DBaseProgram.html#ab31f295dfdeb52bada9f0ca819c8fb29">ML2DBaseProgram::current_image</a></div><div class="ttdeci">size_t current_image</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00221">ml2d.h:221</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ab7caa861fcd7c5a139c0a0825c1abbe0"><div class="ttname"><a href="classML2DBaseProgram.html#ab7caa861fcd7c5a139c0a0825c1abbe0">ML2DBaseProgram::imgs_scale</a></div><div class="ttdeci">std::vector&lt; double &gt; imgs_scale</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00209">ml2d.h:209</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a7126f012ef6183355f71114a35f7149f"><div class="ttname"><a href="classProgMLF2D.html#a7126f012ef6183355f71114a35f7149f">ProgMLF2D::wsum_ctfMref</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; double &gt; &gt; wsum_ctfMref</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00154">mlf_align2d.h:154</a></div></div>
<div class="ttc" id="classProgMLF2D_html_af7f2b4639397c6f14e13371207476c06"><div class="ttname"><a href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">ProgMLF2D::nr_points_2d</a></div><div class="ttdeci">size_t nr_points_2d</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00127">mlf_align2d.h:127</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab887549eff44d4b6ff4209effc176a39"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::fourierTranslate2D </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>trans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>point_start</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l01441">1441</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;{</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="keywordtype">double</span> xx, yy, xxshift, yyshift, dotp;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>, <a class="code" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a>, ac, bd, ab_cd;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    xxshift = -trans(0) / (double)<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    yyshift = -trans(1) / (double)<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>;</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="comment">//Not very clean, but very fast</span></div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> * ptrIn = &amp;(<a class="code" href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a>[point_start]);</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <span class="keywordtype">int</span> * ptrJ = &amp;(<a class="code" href="classProgMLF2D.html#ac0756608605967a063784669478c62bf">pointer_j</a>[0]);</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <span class="keywordtype">int</span> * ptrI = &amp;(<a class="code" href="classProgMLF2D.html#ae34810925acecb7d097272aae20cf26b">pointer_i</a>[0]);</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">nr_points_2d</a>; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    {</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;        xx = (double)ptrJ[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        yy = (double)ptrI[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        dotp = 2 * <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * (xx * xxshift + yyshift * yy);</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        a = cos(dotp);</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        b = sin(dotp);</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        c = *ptrIn++;<span class="comment">//in[point_start + 2*i];</span></div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        d = *ptrIn++;<span class="comment">//in[point_start + 2*i+1];</span></div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        ac = a * <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        bd = b * <a class="code" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a>;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        ab_cd = (a + <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>) * (c + d);</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        out.push_back(ac - bd); <span class="comment">// real</span></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        out.push_back(ab_cd - ac - bd); <span class="comment">// imag</span></div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        <span class="comment">//*ptrOut = ac - bd; ++ptrOut;// real</span></div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        <span class="comment">//*ptrOut = ab_cd - ac - bd; ++ptrOut;// imag</span></div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    }</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3939496af6ccffe20d083935ebd3225b"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a></div><div class="ttdeci">doublereal * d</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ac0756608605967a063784669478c62bf"><div class="ttname"><a href="classProgMLF2D.html#ac0756608605967a063784669478c62bf">ProgMLF2D::pointer_j</a></div><div class="ttdeci">std::vector&lt; int &gt; pointer_j</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00126">mlf_align2d.h:126</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af090b2fbbd2916bfb2e493c5162969d6"><div class="ttname"><a href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a></div><div class="ttdeci">doublereal * b</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a26aeebe75887b4360c73659342f5dc61"><div class="ttname"><a href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a></div><div class="ttdeci">int in</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00053">image_find_center.cpp:53</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ae96de19117479eb8bf594268bb9af590"><div class="ttname"><a href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">ML2DBaseProgram::dim</a></div><div class="ttdeci">size_t dim</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00151">ml2d.h:151</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ae34810925acecb7d097272aae20cf26b"><div class="ttname"><a href="classProgMLF2D.html#ae34810925acecb7d097272aae20cf26b">ProgMLF2D::pointer_i</a></div><div class="ttdeci">std::vector&lt; int &gt; pointer_i</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00126">mlf_align2d.h:126</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af2a333b1670df64a88d3a2f22210d155"><div class="ttname"><a href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a></div><div class="ttdeci">doublereal * a</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="classProgMLF2D_html_af7f2b4639397c6f14e13371207476c06"><div class="ttname"><a href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">ProgMLF2D::nr_points_2d</a></div><div class="ttdeci">size_t nr_points_2d</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00127">mlf_align2d.h:127</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a41a5836d1f8b6fcac9f20d447263bf13"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::generateInitialReferences </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate initial references from random subset averages. </p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l01195">1195</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;{</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a> &gt; 0)</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    {</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;  Generating initial references by averaging over random subsets&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        <a class="code" href="group__GeneralFunctions.html#ga8c220fe710ecdb4f9b1696dd53e20ff3">init_progress_bar</a>(<a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a>);</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    }</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <a class="code" href="classImage.html">Image&lt;double&gt;</a> IRef, ITemp;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <a class="code" href="classFileName.html">FileName</a> fn_tmp;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <a class="code" href="classFileName.html">FileName</a> fn_base = <a class="code" href="group__MLalign2D.html#ga37dd4c436766acd586ca95f773236000">getIterExtraPath</a>(<a class="code" href="classML2DBaseProgram.html#adfab8933f95443ac6d909a9b206b3fa8">fn_root</a>, 0);</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="comment">//randomizeImagesOrder();</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">MDref</a>.<a class="code" href="classMetaData.html#a7c80f24121d6c01ff3c9ec939a17e542">clear</a>();</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="keywordtype">size_t</span> nsub, <a class="code" href="numerical__recipes_8cpp.html#acaec38248b66cfba849985072bd311f6">first</a>, last;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="keywordtype">size_t</span> id;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> refno = 0; refno &lt; <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a>; refno++)</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    {</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        nsub = <a class="code" href="group__GeneralFunctions.html#gaf849138fb8a55da429e85e6813f3c3ca">divide_equally</a>(<a class="code" href="classML2DBaseProgram.html#a55332f697c74f72635ae850439407645">nr_images_global</a>, <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a>, refno, first, last);</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        <span class="comment">//Clear images</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        IRef().initZeros(<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>, <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>);</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        IRef().setXmippOrigin();</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imgno = first; imgno &lt;= last; imgno++)</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        {</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a>, fn_tmp, <a class="code" href="classML2DBaseProgram.html#a3464cb9938eb4cf849b7c8bbb354734f">img_id</a>[imgno]);</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;            ITemp.<a class="code" href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">read</a>(fn_tmp);</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;            ITemp().setXmippOrigin();</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;            IRef() += ITemp();</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        }</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        fn_tmp = <a class="code" href="group__MLFalign2D.html#ga4b64e613a26295aa34dbe4301f1374a4">FN_REF</a>(fn_base, refno + 1);</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        IRef() /= nsub;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        IRef.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(fn_tmp);</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        <span class="keywordtype">id</span> = <a class="code" href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">MDref</a>.<a class="code" href="classMetaData.html#acd6018636eda733443f3df6c61978faa">addObject</a>();</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">MDref</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a>, fn_tmp, <span class="keywordtype">id</span>);</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">MDref</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78adc4c6714fd11379df071ebe8a442c30d">MDL_ENABLED</a>, 1, <span class="keywordtype">id</span>);</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a> &gt; 0)</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;            <a class="code" href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a>(refno);</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    }<span class="comment">//close for refno</span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a> &gt; 0)</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        <a class="code" href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a>(<a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a>);</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a9544695d9d0054d6e75d62f227bee889">fn_ref</a> = <a class="code" href="ml2d_8h.html#a8ef0c472d79a03426c3c02f8777ef3c3">FN_CLASSES_MD</a>(fn_base);</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">MDref</a>.<a class="code" href="classMetaData.html#a163fee49247af4f55802e8480503b342">write</a>(<a class="code" href="classML2DBaseProgram.html#a9544695d9d0054d6e75d62f227bee889">fn_ref</a>);</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;}</div><div class="ttc" id="group__GeneralFunctions_html_ga8c220fe710ecdb4f9b1696dd53e20ff3"><div class="ttname"><a href="group__GeneralFunctions.html#ga8c220fe710ecdb4f9b1696dd53e20ff3">init_progress_bar</a></div><div class="ttdeci">void init_progress_bar(long total)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00773">xmipp_funcs.cpp:773</a></div></div>
<div class="ttc" id="classMetaData_html_a163fee49247af4f55802e8480503b342"><div class="ttname"><a href="classMetaData.html#a163fee49247af4f55802e8480503b342">MetaData::write</a></div><div class="ttdeci">void write(const FileName &amp;outFile, WriteModeMetaData mode=MD_OVERWRITE) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00907">metadata.cpp:907</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a3464cb9938eb4cf849b7c8bbb354734f"><div class="ttname"><a href="classML2DBaseProgram.html#a3464cb9938eb4cf849b7c8bbb354734f">ML2DBaseProgram::img_id</a></div><div class="ttdeci">std::vector&lt; size_t &gt; img_id</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00232">ml2d.h:232</a></div></div>
<div class="ttc" id="classMetaData_html_a7c80f24121d6c01ff3c9ec939a17e542"><div class="ttname"><a href="classMetaData.html#a7c80f24121d6c01ff3c9ec939a17e542">MetaData::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00131">metadata.cpp:131</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a5578230b3fb9e054c437e187cb0ad5d3"><div class="ttname"><a href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">ML2DBaseProgram::model</a></div><div class="ttdeci">ModelML2D model</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00224">ml2d.h:224</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_gaf849138fb8a55da429e85e6813f3c3ca"><div class="ttname"><a href="group__GeneralFunctions.html#gaf849138fb8a55da429e85e6813f3c3ca">divide_equally</a></div><div class="ttdeci">size_t divide_equally(size_t N, size_t size, size_t rank, size_t &amp;first, size_t &amp;last)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l01141">xmipp_funcs.cpp:1141</a></div></div>
<div class="ttc" id="classImageBase_html_ae81a8c11a832924c2bda0909882c3168"><div class="ttname"><a href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">ImageBase::write</a></div><div class="ttdeci">void write(const FileName &amp;name=&quot;&quot;, size_t select_img=ALL_IMAGES, bool isStack=false, int mode=WRITE_OVERWRITE, CastWriteMode castMode=CW_CAST, int _swapWrite=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00210">xmipp_image_base.cpp:210</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_ga4b64e613a26295aa34dbe4301f1374a4"><div class="ttname"><a href="group__MLFalign2D.html#ga4b64e613a26295aa34dbe4301f1374a4">FN_REF</a></div><div class="ttdeci">#define FN_REF(base, refno)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00065">mlf_align2d.h:65</a></div></div>
<div class="ttc" id="classModelML2D_html_a63a3a3534d1cb72a9db046508b9a59f6"><div class="ttname"><a href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">ModelML2D::n_ref</a></div><div class="ttdeci">int n_ref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00083">ml2d.h:83</a></div></div>
<div class="ttc" id="classMetaData_html_acd6018636eda733443f3df6c61978faa"><div class="ttname"><a href="classMetaData.html#acd6018636eda733443f3df6c61978faa">MetaData::addObject</a></div><div class="ttdeci">size_t addObject()</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00750">metadata.cpp:750</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_adfab8933f95443ac6d909a9b206b3fa8"><div class="ttname"><a href="classML2DBaseProgram.html#adfab8933f95443ac6d909a9b206b3fa8">ML2DBaseProgram::fn_root</a></div><div class="ttdeci">FileName fn_root</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00132">ml2d.h:132</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00068">xmipp_filename.h:68</a></div></div>
<div class="ttc" id="ml2d_8h_html_a8ef0c472d79a03426c3c02f8777ef3c3"><div class="ttname"><a href="ml2d_8h.html#a8ef0c472d79a03426c3c02f8777ef3c3">FN_CLASSES_MD</a></div><div class="ttdeci">#define FN_CLASSES_MD(base)</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00055">ml2d.h:55</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78adc4c6714fd11379df071ebe8a442c30d"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78adc4c6714fd11379df071ebe8a442c30d">MDL_ENABLED</a></div><div class="ttdoc">Is this image enabled? (int [-1 or 1]) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00226">metadata_label.h:226</a></div></div>
<div class="ttc" id="classMetaData_html_a2239fbb7e492654f1e2866ab27492a5d"><div class="ttname"><a href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">MetaData::getValue</a></div><div class="ttdeci">bool getValue(MDObject &amp;mdValueOut, size_t id) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00217">metadata.cpp:217</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_acaec38248b66cfba849985072bd311f6"><div class="ttname"><a href="numerical__recipes_8cpp.html#acaec38248b66cfba849985072bd311f6">first</a></div><div class="ttdeci">glob_log first</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05218">numerical_recipes.cpp:5218</a></div></div>
<div class="ttc" id="group__MLalign2D_html_ga37dd4c436766acd586ca95f773236000"><div class="ttname"><a href="group__MLalign2D.html#ga37dd4c436766acd586ca95f773236000">getIterExtraPath</a></div><div class="ttdeci">FileName getIterExtraPath(const FileName &amp;fn_root, int iter, bool makePath)</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8cpp_source.html#l00304">ml2d.cpp:304</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga3bdba82f045e73fb216c6be539e6b129"><div class="ttname"><a href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a></div><div class="ttdeci">void progress_bar(long rlen)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00782">xmipp_funcs.cpp:782</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ae96de19117479eb8bf594268bb9af590"><div class="ttname"><a href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">ML2DBaseProgram::dim</a></div><div class="ttdeci">size_t dim</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00151">ml2d.h:151</a></div></div>
<div class="ttc" id="classXmippProgram_html_aed62cfe3c074e69076bf348fc101a717"><div class="ttname"><a href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">XmippProgram::verbose</a></div><div class="ttdeci">int verbose</div><div class="ttdoc">Verbosity level. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8h_source.html#l00168">xmipp_program.h:168</a></div></div>
<div class="ttc" id="classMetaData_html_adf4ee2ad1ad0964990a8a11a2109d578"><div class="ttname"><a href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">MetaData::setValue</a></div><div class="ttdeci">bool setValue(const MDLabel label, const T &amp;valueIn, size_t id)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00550">metadata.h:550</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a62caa148ed1109af0cf324ffec9ff2cd"><div class="ttname"><a href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">ML2DBaseProgram::MDref</a></div><div class="ttdeci">MetaData MDref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00172">ml2d.h:172</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a080fbf81a2b9dfceab4cfe1a649f13a4"><div class="ttname"><a href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">ML2DBaseProgram::MDimg</a></div><div class="ttdeci">MetaData MDimg</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00172">ml2d.h:172</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a9544695d9d0054d6e75d62f227bee889"><div class="ttname"><a href="classML2DBaseProgram.html#a9544695d9d0054d6e75d62f227bee889">ML2DBaseProgram::fn_ref</a></div><div class="ttdeci">FileName fn_ref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00132">ml2d.h:132</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="classImageBase_html_a88636b7a7bd4e0e454877e691ee2da84"><div class="ttname"><a href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">ImageBase::read</a></div><div class="ttdeci">int read(const FileName &amp;name, DataMode datamode=DATA, size_t select_img=ALL_IMAGES, bool mapData=false, int mode=WRITE_READONLY)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00061">xmipp_image_base.cpp:61</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a55332f697c74f72635ae850439407645"><div class="ttname"><a href="classML2DBaseProgram.html#a55332f697c74f72635ae850439407645">ML2DBaseProgram::nr_images_global</a></div><div class="ttdeci">size_t nr_images_global</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00164">ml2d.h:164</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a></div><div class="ttdoc">Name of an image (std::string) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00235">metadata_label.h:235</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae249382ce2eb9eb7d6fc5b547041805d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::getFTfromVector </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>start_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>only_real</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l01298">1298</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;{</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    out.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">hdim</a> + 1, <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>);</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    out.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    std::complex&lt;double&gt; * tmp_out = <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(out);</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="keywordflow">if</span> (only_real)</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    {</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ipoint = 0; ipoint &lt; <a class="code" href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">nr_points_2d</a>; ipoint++)</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        {</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;            <span class="keywordtype">int</span> ii = <a class="code" href="classProgMLF2D.html#a26c5a01345ef85eaabf6056c0f76f848">pointer_2d</a>[ipoint];</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;            std::complex&lt;double&gt; aux(<a class="code" href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a>[start_point+ipoint], 0.);</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;            tmp_out[ii] = aux;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        }</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    }</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    {</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ipoint = 0; ipoint &lt; <a class="code" href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">nr_points_2d</a>; ipoint++)</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        {</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;            <span class="keywordtype">int</span> ii = <a class="code" href="classProgMLF2D.html#a26c5a01345ef85eaabf6056c0f76f848">pointer_2d</a>[ipoint];</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;            std::complex&lt;double&gt; aux(<a class="code" href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a>[start_point+2*ipoint],<a class="code" href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a>[start_point+2*ipoint+1]);</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;            tmp_out[ii] = aux;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        }</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    }</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gac87b223f03097d45f776b44b6aeea9f7"><div class="ttname"><a href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a></div><div class="ttdeci">#define MULTIDIM_ARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00136">multidim_array.h:136</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a26c5a01345ef85eaabf6056c0f76f848"><div class="ttname"><a href="classProgMLF2D.html#a26c5a01345ef85eaabf6056c0f76f848">ProgMLF2D::pointer_2d</a></div><div class="ttdeci">std::vector&lt; int &gt; pointer_2d</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00126">mlf_align2d.h:126</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a90e6ce499655b4566e17e32102a905c4"><div class="ttname"><a href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">ML2DBaseProgram::hdim</a></div><div class="ttdeci">size_t hdim</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00151">ml2d.h:151</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a26aeebe75887b4360c73659342f5dc61"><div class="ttname"><a href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a></div><div class="ttdeci">int in</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00053">image_find_center.cpp:53</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ae96de19117479eb8bf594268bb9af590"><div class="ttname"><a href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">ML2DBaseProgram::dim</a></div><div class="ttdeci">size_t dim</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00151">ml2d.h:151</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="classProgMLF2D_html_af7f2b4639397c6f14e13371207476c06"><div class="ttname"><a href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">ProgMLF2D::nr_points_2d</a></div><div class="ttdeci">size_t nr_points_2d</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00127">mlf_align2d.h:127</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aca8831df4147241ec146bdea4ed1ac02"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::iteration </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>One iteration of the process. </p>

<p>Implements <a class="el" href="classML2DBaseProgram.html#adba8c776a2519367211c0ccefda049a7">ML2DBaseProgram</a>.</p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l02289">2289</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;{</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;    <span class="comment">// Integrate over all images</span></div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;    <a class="code" href="classProgMLF2D.html#ab8d02bc5f161f68226d359e166dad892">expectation</a>();</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;    <span class="comment">// Update model with new estimates</span></div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;    <a class="code" href="classProgMLF2D.html#aa0f72ba394c61a95823a1d49955da873">maximization</a>();</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;}</div><div class="ttc" id="classProgMLF2D_html_aa0f72ba394c61a95823a1d49955da873"><div class="ttname"><a href="classProgMLF2D.html#aa0f72ba394c61a95823a1d49955da873">ProgMLF2D::maximization</a></div><div class="ttdeci">void maximization()</div><div class="ttdoc">Update all model parameters (maximization step) </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l02479">mlf_align2d.cpp:2479</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ab8d02bc5f161f68226d359e166dad892"><div class="ttname"><a href="classProgMLF2D.html#ab8d02bc5f161f68226d359e166dad892">ProgMLF2D::expectation</a></div><div class="ttdeci">void expectation()</div><div class="ttdoc">Integrate over all experimental images. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l02297">mlf_align2d.cpp:2297</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa0f72ba394c61a95823a1d49955da873"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::maximization </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update all model parameters (maximization step) </p>

<p>Implements <a class="el" href="classML2DBaseProgram.html#a7a681c2276732436dd7b968c53927699">ML2DBaseProgram</a>.</p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l02479">2479</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;{</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> rmean_sigma2, rmean_signal2;</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;int&gt;</a>  radial_count;</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a> center(2);</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;std::complex&lt;double&gt;</a> &gt; Faux, Faux2;</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Maux;</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    <a class="code" href="classFileName.html">FileName</a> fn_tmp;</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    <span class="keywordtype">double</span> aux;</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    <span class="comment">// Pre-calculate sumw_allrefs &amp; average Pmax/sumP or cross-correlation</span></div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    <a class="code" href="classProgMLF2D.html#a01e5f8b55632ee6d8263827376051807">sumw_allrefs</a> = 0.;</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    <span class="comment">// Update the reference images</span></div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;    <a class="code" href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a>()</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    {</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a> &amp;&amp; <a class="code" href="classProgMLF2D.html#a0a90a0680ddfe59efa8bac1303fada63">sumw</a>[refno] &gt; 0.)</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;        {</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>[refno]() = <a class="code" href="classProgMLF2D.html#a7b5bd8fb49b6864cdfcba9779bb163d2">wsum_Mref</a>[refno];</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>[refno]() /= <a class="code" href="classProgMLF2D.html#ab34721b1edbfbb6b3feb83c1aa825166">sumwsc2</a>[refno];</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>[refno].setWeight(<a class="code" href="classProgMLF2D.html#a0a90a0680ddfe59efa8bac1303fada63">sumw</a>[refno]);</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;            <a class="code" href="classProgMLF2D.html#a01e5f8b55632ee6d8263827376051807">sumw_allrefs</a> += <a class="code" href="classProgMLF2D.html#a0a90a0680ddfe59efa8bac1303fada63">sumw</a>[refno];</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">do_ctf_correction</a>)</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;            {</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;                <a class="code" href="classProgMLF2D.html#abe2d74f54f4aa6916eb6f6d29164e023">Ictf</a>[refno]() = <a class="code" href="classProgMLF2D.html#a7126f012ef6183355f71114a35f7149f">wsum_ctfMref</a>[refno];</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;                <a class="code" href="classProgMLF2D.html#abe2d74f54f4aa6916eb6f6d29164e023">Ictf</a>[refno]() /= <a class="code" href="classProgMLF2D.html#ab34721b1edbfbb6b3feb83c1aa825166">sumwsc2</a>[refno];</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;                <a class="code" href="classProgMLF2D.html#abe2d74f54f4aa6916eb6f6d29164e023">Ictf</a>[refno].setWeight(<a class="code" href="classProgMLF2D.html#a0a90a0680ddfe59efa8bac1303fada63">sumw</a>[refno]);</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;            }</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;            {</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;                <a class="code" href="classProgMLF2D.html#abe2d74f54f4aa6916eb6f6d29164e023">Ictf</a>[refno]=<a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>[refno];</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;            }</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;        }</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a> &amp;&amp; <a class="code" href="classProgMLF2D.html#a07e1e912286ab9303da3d4a654d26dd6">sumw2</a>[refno] &gt; 0.)</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;        {</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>[refno]() = <a class="code" href="classProgMLF2D.html#a7b5bd8fb49b6864cdfcba9779bb163d2">wsum_Mref</a>[refno];</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>[refno]() /= <a class="code" href="classProgMLF2D.html#ab34721b1edbfbb6b3feb83c1aa825166">sumwsc2</a>[refno];</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>[refno].setWeight(<a class="code" href="classProgMLF2D.html#a07e1e912286ab9303da3d4a654d26dd6">sumw2</a>[refno]);</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;            <a class="code" href="classProgMLF2D.html#a01e5f8b55632ee6d8263827376051807">sumw_allrefs</a> += <a class="code" href="classProgMLF2D.html#a0a90a0680ddfe59efa8bac1303fada63">sumw</a>[refno];</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;            <span class="comment">//sumw_allrefs2 += sumw2[refno];</span></div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">do_ctf_correction</a>)</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;            {</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;                <a class="code" href="classProgMLF2D.html#abe2d74f54f4aa6916eb6f6d29164e023">Ictf</a>[refno]() = <a class="code" href="classProgMLF2D.html#a7126f012ef6183355f71114a35f7149f">wsum_ctfMref</a>[refno];</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;                <a class="code" href="classProgMLF2D.html#abe2d74f54f4aa6916eb6f6d29164e023">Ictf</a>[refno]() /= <a class="code" href="classProgMLF2D.html#ab34721b1edbfbb6b3feb83c1aa825166">sumwsc2</a>[refno];</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;                <a class="code" href="classProgMLF2D.html#abe2d74f54f4aa6916eb6f6d29164e023">Ictf</a>[refno].setWeight(<a class="code" href="classProgMLF2D.html#a07e1e912286ab9303da3d4a654d26dd6">sumw2</a>[refno]);</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;            }</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;            {</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;                <a class="code" href="classProgMLF2D.html#abe2d74f54f4aa6916eb6f6d29164e023">Ictf</a>[refno]=<a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>[refno];</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;            }</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;        }</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;        {</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>[refno].setWeight(0.);</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;            <a class="code" href="classProgMLF2D.html#abe2d74f54f4aa6916eb6f6d29164e023">Ictf</a>[refno].setWeight(0.);</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>[refno]().initZeros(<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>, <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>);</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;            <a class="code" href="classProgMLF2D.html#abe2d74f54f4aa6916eb6f6d29164e023">Ictf</a>[refno]().initZeros();</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;        }</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;    }</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;    <span class="comment">// Adjust average scale (nr_classes will be smaller than n_ref for the 3D case!)</span></div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">do_norm</a>)</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;    {</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;        <span class="keywordtype">int</span> iclass, nr_classes = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a> / <a class="code" href="classML2DBaseProgram.html#a1e429b25f696eba0bb30a316517f0b31">refs_per_class</a>);</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;        std::vector&lt;double&gt; wsum_scale(nr_classes), sumw_scale(nr_classes);</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;        ldiv_t temp;</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a90f80f69b900eb15f9300560d50286ca">average_scale</a> = 0.;</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;        <a class="code" href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a>()</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;        {</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a90f80f69b900eb15f9300560d50286ca">average_scale</a> += <a class="code" href="classProgMLF2D.html#a92faef343a74868a005e5de666778470">sumwsc</a>[refno];</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;            temp = ldiv( refno, <a class="code" href="classML2DBaseProgram.html#a1e429b25f696eba0bb30a316517f0b31">refs_per_class</a> );</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;            iclass = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(temp.quot);</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;            wsum_scale[iclass] += <a class="code" href="classProgMLF2D.html#a92faef343a74868a005e5de666778470">sumwsc</a>[refno];</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;            sumw_scale[iclass] += <a class="code" href="classProgMLF2D.html#a0a90a0680ddfe59efa8bac1303fada63">sumw</a>[refno];</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;        }</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;        <a class="code" href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a>()</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;        {</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;            temp = ldiv( refno, <a class="code" href="classML2DBaseProgram.html#a1e429b25f696eba0bb30a316517f0b31">refs_per_class</a> );</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;            iclass = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(temp.quot);</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;            <span class="keywordflow">if</span> (sumw_scale[iclass]&gt;0.)</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;            {</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;                <a class="code" href="classProgMLF2D.html#a2fd51100d35db6ecdcb3ac704ab58435">refs_avgscale</a>[refno] = wsum_scale[iclass]/sumw_scale[iclass];</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;                <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>[refno]() *= <a class="code" href="classProgMLF2D.html#a2fd51100d35db6ecdcb3ac704ab58435">refs_avgscale</a>[refno];</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;                <a class="code" href="classProgMLF2D.html#abe2d74f54f4aa6916eb6f6d29164e023">Ictf</a>[refno]() *= <a class="code" href="classProgMLF2D.html#a2fd51100d35db6ecdcb3ac704ab58435">refs_avgscale</a>[refno];</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;            }</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;            {</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;                <a class="code" href="classProgMLF2D.html#a2fd51100d35db6ecdcb3ac704ab58435">refs_avgscale</a>[refno] = 1.;</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;            }</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;        }</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a90f80f69b900eb15f9300560d50286ca">average_scale</a> /= <a class="code" href="classProgMLF2D.html#a01e5f8b55632ee6d8263827376051807">sumw_allrefs</a>;</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    }</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;    <span class="comment">// Average corr</span></div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;    <a class="code" href="classProgMLF2D.html#abc9875f9cb5025678bebb8eff54a1118">sumcorr</a> /= <a class="code" href="classProgMLF2D.html#a01e5f8b55632ee6d8263827376051807">sumw_allrefs</a>;</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    <span class="comment">// Update the model fractions</span></div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classML2DBaseProgram.html#a6f89b87041906702ae5c30638bd2762c">fix_fractions</a>)</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;    {</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;        <a class="code" href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a>()</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;        {</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a0a90a0680ddfe59efa8bac1303fada63">sumw</a>[refno] &gt; 0.)</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;            {</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;                <a class="code" href="classProgMLF2D.html#a0cf09cc5d8c9949acc48438be868773c">alpha_k</a>[refno] = <a class="code" href="classProgMLF2D.html#a0a90a0680ddfe59efa8bac1303fada63">sumw</a>[refno] / <a class="code" href="classProgMLF2D.html#a01e5f8b55632ee6d8263827376051807">sumw_allrefs</a>;</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;                <a class="code" href="classProgMLF2D.html#a619e2aed7d1934de3ce40d04b4d160b3">mirror_fraction</a>[refno] = <a class="code" href="classProgMLF2D.html#a86adb43015401e250b579f9d49f00730">sumw_mirror</a>[refno] / <a class="code" href="classProgMLF2D.html#a0a90a0680ddfe59efa8bac1303fada63">sumw</a>[refno];</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;            }</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;            {</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;                <a class="code" href="classProgMLF2D.html#a0cf09cc5d8c9949acc48438be868773c">alpha_k</a>[refno] = 0.;</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;                <a class="code" href="classProgMLF2D.html#a619e2aed7d1934de3ce40d04b4d160b3">mirror_fraction</a>[refno] = 0.;</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;            }</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;        }</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;    }</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    <span class="comment">// Update sigma of the origin offsets</span></div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classML2DBaseProgram.html#a3c0fde6f9005eec528cc1f703019719c">fix_sigma_offset</a>)</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;    {</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;        <a class="code" href="classProgMLF2D.html#a0177d3113415179168699efda64bd860">sigma_offset</a> = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(<a class="code" href="classProgMLF2D.html#ae311e353866c6ac035c8f795ee2e1a6b">wsum_sigma_offset</a> / (2. * <a class="code" href="classProgMLF2D.html#a01e5f8b55632ee6d8263827376051807">sumw_allrefs</a>));</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;    }</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;    <span class="comment">// Update the noise parameters</span></div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classML2DBaseProgram.html#a4646a8113c64d86101389cb4f373bca3">fix_sigma_noise</a>)</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;    {</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;        <a class="code" href="group__MLFalign2D.html#gab39599380e42cadda13b0cfb14588d46">FOR_ALL_DEFOCUS_GROUPS</a>()</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;        {</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;            <a class="code" href="classProgMLF2D.html#ae249382ce2eb9eb7d6fc5b547041805d">getFTfromVector</a>(<a class="code" href="classProgMLF2D.html#af78a059d07b955ccd42e8a17ef827d19">Mwsum_sigma2</a>[ifocus],0,Faux,<span class="keyword">true</span>);</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;            <a class="code" href="group__Fourier.html#ga802c259c4d5e663a4139946d89c120a4">Half2Whole</a>(Faux, Faux2, <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>);</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;            <a class="code" href="group__FourierW.html#ga1075fe73c87077296a879f44ded3a2c3">FFT_magnitude</a>(Faux2, Maux);</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;            <a class="code" href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a>(Maux, <span class="keyword">true</span>);</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;            Maux.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;            center.initZeros();</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;            rmean_sigma2.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#ga82c19639b510d33894fe268664130410">radialAverage</a>(Maux, center, rmean_sigma2, radial_count, <span class="keyword">true</span>);</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;            <span class="comment">// Factor 2 here, because the Gaussian distribution is 2D!</span></div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> irr = 0; irr &lt;= <a class="code" href="classProgMLF2D.html#aca3a507abbae9720e21b774955fccdb6">current_highres_limit</a>; irr++)</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;            {</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;                aux = <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(rmean_sigma2, irr) / (2. * <a class="code" href="classProgMLF2D.html#a9c42feb7d8cbf224f91e903bac49663e">sumw_defocus</a>[ifocus]);</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;                <span class="keywordflow">if</span> (aux &gt; 0.)</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;                {</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;                    <a class="code" href="group__MLFalign2D.html#gaea9964961fe272b8b7277239202912cb">VSIG_ITEM</a> = aux;</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;                }</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;            }</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;        }</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;    }</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    <span class="comment">// Calculate average spectral signal</span></div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;    c = 0;</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;    <a class="code" href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a>()</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    {</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;        <span class="keywordflow">if</span> ( (!<a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a> &amp;&amp; <a class="code" href="classProgMLF2D.html#a0a90a0680ddfe59efa8bac1303fada63">sumw</a>[refno] &gt; 0.) ||</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;             ( <a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a> &amp;&amp; <a class="code" href="classProgMLF2D.html#a07e1e912286ab9303da3d4a654d26dd6">sumw2</a>[refno] &gt; 0.) )</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;        {</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;            <a class="code" href="group__Fourier.html#ga5fddf4cf6da360abdc8fd7d2f21fcbb9">FourierTransform</a>(<a class="code" href="classProgMLF2D.html#abe2d74f54f4aa6916eb6f6d29164e023">Ictf</a>[refno](), Faux);</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;            <a class="code" href="group__FourierW.html#ga1075fe73c87077296a879f44ded3a2c3">FFT_magnitude</a>(Faux, Maux);</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;            <a class="code" href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a>(Maux, <span class="keyword">true</span>);</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;            Maux *= Maux;</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;            <span class="comment">//if (!do_student)</span></div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;            <span class="comment">//Maux *= sumw[refno];</span></div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;            <span class="comment">//else</span></div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;            <span class="comment">//Maux *= sumw2[refno];</span></div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;            Maux *= <a class="code" href="classProgMLF2D.html#a0a90a0680ddfe59efa8bac1303fada63">sumw</a>[refno];</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;            center.initZeros();</div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;            rmean_signal2.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;            Maux.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#ga82c19639b510d33894fe268664130410">radialAverage</a>(Maux, center, rmean_signal2, radial_count, <span class="keyword">true</span>);</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;            <span class="keywordflow">if</span> (c == 0)</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;                <a class="code" href="classML2DBaseProgram.html#add43d72480811707dcaa89df00324f42">spectral_signal</a> = rmean_signal2;</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;                <a class="code" href="classML2DBaseProgram.html#add43d72480811707dcaa89df00324f42">spectral_signal</a> += rmean_signal2;</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;            c++;</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;            <span class="comment">//            std::cerr &lt;&lt; &quot;DEBUG_JM: ====================&quot; &lt;&lt;std::endl;</span></div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;            <span class="comment">//            std::cerr &lt;&lt; &quot;DEBUG_JM: refno: &quot; &lt;&lt; refno &lt;&lt; std::endl;</span></div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;            <span class="comment">//            std::cerr &lt;&lt; &quot;DEBUG_JM: rmean_signal2: &quot; &lt;&lt; rmean_signal2 &lt;&lt; std::endl;</span></div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;            <span class="comment">//            std::cerr &lt;&lt; &quot;DEBUG_JM: spectral_signal: &quot; &lt;&lt; spectral_signal &lt;&lt; std::endl;</span></div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;        }</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;    }</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;    <span class="keywordtype">double</span> inv_nref = 1./(double)<a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a>;</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;    <a class="code" href="classML2DBaseProgram.html#add43d72480811707dcaa89df00324f42">spectral_signal</a> *= inv_nref;</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    <span class="comment">//    std::cerr &lt;&lt; &quot;DEBUG_JM: inv_nref: &quot; &lt;&lt; inv_nref &lt;&lt; std::endl;</span></div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;    <span class="comment">//    std::cerr &lt;&lt; &quot;DEBUG_JM, maximization: spectral_signal: &quot; &lt;&lt; spectral_signal &lt;&lt; std::endl;</span></div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;}</div><div class="ttc" id="classProgMLF2D_html_a8402eab40b0e66cd7aee78b747720af9"><div class="ttname"><a href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">ProgMLF2D::do_student</a></div><div class="ttdeci">bool do_student</div><div class="ttdoc">IN DEVELOPMENT. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00135">mlf_align2d.h:135</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ae311e353866c6ac035c8f795ee2e1a6b"><div class="ttname"><a href="classProgMLF2D.html#ae311e353866c6ac035c8f795ee2e1a6b">ProgMLF2D::wsum_sigma_offset</a></div><div class="ttdeci">double wsum_sigma_offset</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00153">mlf_align2d.h:153</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a1e429b25f696eba0bb30a316517f0b31"><div class="ttname"><a href="classML2DBaseProgram.html#a1e429b25f696eba0bb30a316517f0b31">ML2DBaseProgram::refs_per_class</a></div><div class="ttdeci">int refs_per_class</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00217">ml2d.h:217</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a5578230b3fb9e054c437e187cb0ad5d3"><div class="ttname"><a href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">ML2DBaseProgram::model</a></div><div class="ttdeci">ModelML2D model</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00224">ml2d.h:224</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a6f89b87041906702ae5c30638bd2762c"><div class="ttname"><a href="classML2DBaseProgram.html#a6f89b87041906702ae5c30638bd2762c">ML2DBaseProgram::fix_fractions</a></div><div class="ttdeci">bool fix_fractions</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00139">ml2d.h:139</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a90f80f69b900eb15f9300560d50286ca"><div class="ttname"><a href="classML2DBaseProgram.html#a90f80f69b900eb15f9300560d50286ca">ML2DBaseProgram::average_scale</a></div><div class="ttdeci">double average_scale</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00213">ml2d.h:213</a></div></div>
<div class="ttc" id="classModelML2D_html_a63a3a3534d1cb72a9db046508b9a59f6"><div class="ttname"><a href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">ModelML2D::n_ref</a></div><div class="ttdeci">int n_ref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00083">ml2d.h:83</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a9c42feb7d8cbf224f91e903bac49663e"><div class="ttname"><a href="classProgMLF2D.html#a9c42feb7d8cbf224f91e903bac49663e">ProgMLF2D::sumw_defocus</a></div><div class="ttdeci">std::vector&lt; double &gt; sumw_defocus</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00156">mlf_align2d.h:156</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gab39599380e42cadda13b0cfb14588d46"><div class="ttname"><a href="group__MLFalign2D.html#gab39599380e42cadda13b0cfb14588d46">FOR_ALL_DEFOCUS_GROUPS</a></div><div class="ttdeci">#define FOR_ALL_DEFOCUS_GROUPS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00040">mlf_align2d.h:40</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00068">xmipp_filename.h:68</a></div></div>
<div class="ttc" id="classProgMLF2D_html_aca3a507abbae9720e21b774955fccdb6"><div class="ttname"><a href="classProgMLF2D.html#aca3a507abbae9720e21b774955fccdb6">ProgMLF2D::current_highres_limit</a></div><div class="ttdeci">size_t current_highres_limit</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00129">mlf_align2d.h:129</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ab34721b1edbfbb6b3feb83c1aa825166"><div class="ttname"><a href="classProgMLF2D.html#ab34721b1edbfbb6b3feb83c1aa825166">ProgMLF2D::sumwsc2</a></div><div class="ttdeci">std::vector&lt; double &gt; sumwsc2</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00156">mlf_align2d.h:156</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a9e143fabdc67d1ee8cd67dcad98e74fc"><div class="ttname"><a href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">ML2DBaseProgram::do_norm</a></div><div class="ttdeci">bool do_norm</div><div class="ttdoc">Re-normalize internally. </div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00207">ml2d.h:207</a></div></div>
<div class="ttc" id="group__Fourier_html_ga0447bcc3d329ad07e453b0d9b0872468"><div class="ttname"><a href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a></div><div class="ttdeci">void CenterFFT(MultidimArray&lt; T &gt; &amp;v, bool forward)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8h_source.html#l00291">xmipp_fft.h:291</a></div></div>
<div class="ttc" id="group__Fourier_html_ga802c259c4d5e663a4139946d89c120a4"><div class="ttname"><a href="group__Fourier.html#ga802c259c4d5e663a4139946d89c120a4">Half2Whole</a></div><div class="ttdeci">void Half2Whole(const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;in, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;out, size_t oridim)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8cpp_source.html#l00066">xmipp_fft.cpp:66</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a2fd51100d35db6ecdcb3ac704ab58435"><div class="ttname"><a href="classProgMLF2D.html#a2fd51100d35db6ecdcb3ac704ab58435">ProgMLF2D::refs_avgscale</a></div><div class="ttdeci">std::vector&lt; double &gt; refs_avgscale</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00148">mlf_align2d.h:148</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_add43d72480811707dcaa89df00324f42"><div class="ttname"><a href="classML2DBaseProgram.html#add43d72480811707dcaa89df00324f42">ML2DBaseProgram::spectral_signal</a></div><div class="ttdeci">MultidimArray&lt; double &gt; spectral_signal</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00253">ml2d.h:253</a></div></div>
<div class="ttc" id="classProgMLF2D_html_abe2d74f54f4aa6916eb6f6d29164e023"><div class="ttname"><a href="classProgMLF2D.html#abe2d74f54f4aa6916eb6f6d29164e023">ProgMLF2D::Ictf</a></div><div class="ttdeci">std::vector&lt; Image&lt; double &gt; &gt; Ictf</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00085">mlf_align2d.h:85</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a7b5bd8fb49b6864cdfcba9779bb163d2"><div class="ttname"><a href="classProgMLF2D.html#a7b5bd8fb49b6864cdfcba9779bb163d2">ProgMLF2D::wsum_Mref</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; double &gt; &gt; wsum_Mref</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00154">mlf_align2d.h:154</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a0177d3113415179168699efda64bd860"><div class="ttname"><a href="classProgMLF2D.html#a0177d3113415179168699efda64bd860">ProgMLF2D::sigma_offset</a></div><div class="ttdeci">double sigma_offset</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00075">mlf_align2d.h:75</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a0cf09cc5d8c9949acc48438be868773c"><div class="ttname"><a href="classProgMLF2D.html#a0cf09cc5d8c9949acc48438be868773c">ProgMLF2D::alpha_k</a></div><div class="ttdeci">std::vector&lt; double &gt; alpha_k</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00077">mlf_align2d.h:77</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ae96de19117479eb8bf594268bb9af590"><div class="ttname"><a href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">ML2DBaseProgram::dim</a></div><div class="ttdeci">size_t dim</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00151">ml2d.h:151</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a7c3f7c47054265ad3589ee6d40764fbc"><div class="ttname"><a href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">ProgMLF2D::do_ctf_correction</a></div><div class="ttdeci">bool do_ctf_correction</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00100">mlf_align2d.h:100</a></div></div>
<div class="ttc" id="group__Fourier_html_ga5fddf4cf6da360abdc8fd7d2f21fcbb9"><div class="ttname"><a href="group__Fourier.html#ga5fddf4cf6da360abdc8fd7d2f21fcbb9">FourierTransform</a></div><div class="ttdeci">void FourierTransform(const MultidimArray&lt; double &gt; &amp;in, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8cpp_source.html#l00124">xmipp_fft.cpp:124</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a619e2aed7d1934de3ce40d04b4d160b3"><div class="ttname"><a href="classProgMLF2D.html#a619e2aed7d1934de3ce40d04b4d160b3">ProgMLF2D::mirror_fraction</a></div><div class="ttdeci">std::vector&lt; double &gt; mirror_fraction</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00079">mlf_align2d.h:79</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a4646a8113c64d86101389cb4f373bca3"><div class="ttname"><a href="classML2DBaseProgram.html#a4646a8113c64d86101389cb4f373bca3">ML2DBaseProgram::fix_sigma_noise</a></div><div class="ttdeci">bool fix_sigma_noise</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00143">ml2d.h:143</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga53e37122134100316031eae982abee03"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a></div><div class="ttdeci">#define dAi(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00540">multidim_array.h:540</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a92faef343a74868a005e5de666778470"><div class="ttname"><a href="classProgMLF2D.html#a92faef343a74868a005e5de666778470">ProgMLF2D::sumwsc</a></div><div class="ttdeci">std::vector&lt; double &gt; sumwsc</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00156">mlf_align2d.h:156</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a0a90a0680ddfe59efa8bac1303fada63"><div class="ttname"><a href="classProgMLF2D.html#a0a90a0680ddfe59efa8bac1303fada63">ProgMLF2D::sumw</a></div><div class="ttdeci">std::vector&lt; double &gt; sumw</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00156">mlf_align2d.h:156</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga82c19639b510d33894fe268664130410"><div class="ttname"><a href="group__GeometricalTransformations.html#ga82c19639b510d33894fe268664130410">radialAverage</a></div><div class="ttdeci">void radialAverage(const MultidimArray&lt; T &gt; &amp;m, Matrix1D&lt; int &gt; &amp;center_of_rot, MultidimArray&lt; T &gt; &amp;radial_mean, MultidimArray&lt; int &gt; &amp;radial_count, const bool &amp;rounding=false)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01575">transformations.h:1575</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a01e5f8b55632ee6d8263827376051807"><div class="ttname"><a href="classProgMLF2D.html#a01e5f8b55632ee6d8263827376051807">ProgMLF2D::sumw_allrefs</a></div><div class="ttdeci">double sumw_allrefs</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00153">mlf_align2d.h:153</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a86adb43015401e250b579f9d49f00730"><div class="ttname"><a href="classProgMLF2D.html#a86adb43015401e250b579f9d49f00730">ProgMLF2D::sumw_mirror</a></div><div class="ttdeci">std::vector&lt; double &gt; sumw_mirror</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00156">mlf_align2d.h:156</a></div></div>
<div class="ttc" id="classModelML2D_html_a29baa2fb66177265cb0de6d027ea454a"><div class="ttname"><a href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">ModelML2D::Iref</a></div><div class="ttdeci">std::vector&lt; Image&lt; double &gt; &gt; Iref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00085">ml2d.h:85</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; int &gt;</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ae249382ce2eb9eb7d6fc5b547041805d"><div class="ttname"><a href="classProgMLF2D.html#ae249382ce2eb9eb7d6fc5b547041805d">ProgMLF2D::getFTfromVector</a></div><div class="ttdeci">void getFTfromVector(const std::vector&lt; double &gt; &amp;in, const int start_point, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;out, bool only_real=false)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l01298">mlf_align2d.cpp:1298</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a07e1e912286ab9303da3d4a654d26dd6"><div class="ttname"><a href="classProgMLF2D.html#a07e1e912286ab9303da3d4a654d26dd6">ProgMLF2D::sumw2</a></div><div class="ttdeci">std::vector&lt; double &gt; sumw2</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00156">mlf_align2d.h:156</a></div></div>
<div class="ttc" id="classProgMLF2D_html_af78a059d07b955ccd42e8a17ef827d19"><div class="ttname"><a href="classProgMLF2D.html#af78a059d07b955ccd42e8a17ef827d19">ProgMLF2D::Mwsum_sigma2</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; Mwsum_sigma2</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00155">mlf_align2d.h:155</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a3c0fde6f9005eec528cc1f703019719c"><div class="ttname"><a href="classML2DBaseProgram.html#a3c0fde6f9005eec528cc1f703019719c">ML2DBaseProgram::fix_sigma_offset</a></div><div class="ttdeci">bool fix_sigma_offset</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00141">ml2d.h:141</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="group__FourierW_html_ga1075fe73c87077296a879f44ded3a2c3"><div class="ttname"><a href="group__FourierW.html#ga1075fe73c87077296a879f44ded3a2c3">FFT_magnitude</a></div><div class="ttdeci">void FFT_magnitude(const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;v, MultidimArray&lt; double &gt; &amp;mag)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00393">xmipp_fftw.cpp:393</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gaea9964961fe272b8b7277239202912cb"><div class="ttname"><a href="group__MLFalign2D.html#gaea9964961fe272b8b7277239202912cb">VSIG_ITEM</a></div><div class="ttdeci">#define VSIG_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00049">mlf_align2d.h:49</a></div></div>
<div class="ttc" id="classProgMLF2D_html_abc9875f9cb5025678bebb8eff54a1118"><div class="ttname"><a href="classProgMLF2D.html#abc9875f9cb5025678bebb8eff54a1118">ProgMLF2D::sumcorr</a></div><div class="ttdeci">double sumcorr</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00153">mlf_align2d.h:153</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gadcb82c3ff44ffd9c34b67c3ca943613d"><div class="ttname"><a href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a></div><div class="ttdeci">#define FOR_ALL_MODELS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00036">mlf_align2d.h:36</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a7126f012ef6183355f71114a35f7149f"><div class="ttname"><a href="classProgMLF2D.html#a7126f012ef6183355f71114a35f7149f">ProgMLF2D::wsum_ctfMref</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; double &gt; &gt; wsum_ctfMref</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00154">mlf_align2d.h:154</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a68e996f0ddb68cbe68e8964fffdb635b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgMLF2D::performKSTest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Mimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>focus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>apply_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFileName.html">FileName</a> &amp;&#160;</td>
          <td class="paramname"><em>fn_img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>write_histogram</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>Fref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>opt_scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>opt_refno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>opt_ipsi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>opt_iflip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>opt_offsets</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform Kolmogorov-Smirnov test. </p>

</div>
</div>
<a class="anchor" id="ae091bc27292e881bb2fcb6c9e96903f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::preselect_significant_model_phi </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Mimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>offsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>Mref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>Msignificant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>pdf_directions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pre-calculate which model and phi have significant probabilities without taking translations into account! </p>

</div>
</div>
<a class="anchor" id="ae2c6d5b3598c2851c1919661965cee74"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::preselectDirections </td>
          <td>(</td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>pdf_directions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate which references have projection directions close to phi and theta </p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l01406">1406</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;{</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="keywordtype">float</span> phi_ref, theta_ref, angle, angle2;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a>, v;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    pdf_directions.clear();</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    pdf_directions.resize(<a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a>);</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <a class="code" href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a>()</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    {</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classML2DBaseProgram.html#a549ca4cda193eb449087f9a316c61f20">limit_rot</a> || (phi == -999. &amp;&amp; <a class="code" href="numerical__recipes_8cpp.html#aca81c35c21e3a5f7f3a8d24504e76664">theta</a> == -999.))</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;            pdf_directions[refno] = 1.;</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        {</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;            phi_ref = <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>[refno].rot();</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;            theta_ref = <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>[refno].tilt();</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;            <a class="code" href="group__Geometry.html#gac0a39b9536b704ecb1c9e44436796b2b">Euler_direction</a>(phi, <a class="code" href="numerical__recipes_8cpp.html#aca81c35c21e3a5f7f3a8d24504e76664">theta</a>, 0., u);</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;            <a class="code" href="group__Geometry.html#gac0a39b9536b704ecb1c9e44436796b2b">Euler_direction</a>(phi_ref, theta_ref, 0., v);</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;            u.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;            v.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;            angle = <a class="code" href="group__Macros.html#ga18b5ff2c19b69c072069398c7a5520cd">RAD2DEG</a>(acos(<a class="code" href="group__Vectors.html#ga5d2bc77c327154906885f1ebedc8d787">dotProduct</a>(u, v)));</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;            angle = fabs(<a class="code" href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a>(angle, -180, 180));</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            <span class="comment">// also check mirror</span></div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;            angle2 = 180. + angle;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;            angle2 = fabs(<a class="code" href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a>(angle2, -180, 180));</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;            angle = <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(angle, angle2);</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;            <span class="keywordflow">if</span> (fabs(angle) &gt; <a class="code" href="classML2DBaseProgram.html#a4ca3328df09f636935d22b5b946a3704">search_rot</a>)</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                pdf_directions[refno] = 0.;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                pdf_directions[refno] = 1.;</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        }</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    }</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;}</div><div class="ttc" id="group__Geometry_html_gac0a39b9536b704ecb1c9e44436796b2b"><div class="ttname"><a href="group__Geometry.html#gac0a39b9536b704ecb1c9e44436796b2b">Euler_direction</a></div><div class="ttdeci">void Euler_direction(double alpha, double beta, double gamma, Matrix1D&lt; double &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00718">geometry.cpp:718</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a5578230b3fb9e054c437e187cb0ad5d3"><div class="ttname"><a href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">ML2DBaseProgram::model</a></div><div class="ttdeci">ModelML2D model</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00224">ml2d.h:224</a></div></div>
<div class="ttc" id="classModelML2D_html_a63a3a3534d1cb72a9db046508b9a59f6"><div class="ttname"><a href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">ModelML2D::n_ref</a></div><div class="ttdeci">int n_ref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00083">ml2d.h:83</a></div></div>
<div class="ttc" id="classMatrix1D_html_a4afb1b4e8a8132a53b985e5fa7da6e30"><div class="ttname"><a href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">Matrix1D::selfNormalize</a></div><div class="ttdeci">void selfNormalize()</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01595">matrix1d.h:1595</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca81c35c21e3a5f7f3a8d24504e76664"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca81c35c21e3a5f7f3a8d24504e76664">theta</a></div><div class="ttdeci">double theta</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l06233">numerical_recipes.cpp:6233</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a4ca3328df09f636935d22b5b946a3704"><div class="ttname"><a href="classML2DBaseProgram.html#a4ca3328df09f636935d22b5b946a3704">ML2DBaseProgram::search_rot</a></div><div class="ttdeci">double search_rot</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00190">ml2d.h:190</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a549ca4cda193eb449087f9a316c61f20"><div class="ttname"><a href="classML2DBaseProgram.html#a549ca4cda193eb449087f9a316c61f20">ML2DBaseProgram::limit_rot</a></div><div class="ttdeci">bool limit_rot</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00188">ml2d.h:188</a></div></div>
<div class="ttc" id="group__Macros_html_gac9ae6a207f10c821b06a8c0df153a7d5"><div class="ttname"><a href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a></div><div class="ttdeci">#define XMIPP_MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00181">xmipp_macros.h:181</a></div></div>
<div class="ttc" id="classModelML2D_html_a29baa2fb66177265cb0de6d027ea454a"><div class="ttname"><a href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">ModelML2D::Iref</a></div><div class="ttdeci">std::vector&lt; Image&lt; double &gt; &gt; Iref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00085">ml2d.h:85</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_ga5d2bc77c327154906885f1ebedc8d787"><div class="ttname"><a href="group__Vectors.html#ga5d2bc77c327154906885f1ebedc8d787">dotProduct</a></div><div class="ttdeci">T dotProduct(const Matrix1D&lt; T &gt; &amp;v1, const Matrix1D&lt; T &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01817">matrix1d.h:1817</a></div></div>
<div class="ttc" id="group__Macros_html_ga18b5ff2c19b69c072069398c7a5520cd"><div class="ttname"><a href="group__Macros.html#ga18b5ff2c19b69c072069398c7a5520cd">RAD2DEG</a></div><div class="ttdeci">#define RAD2DEG(r)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00320">xmipp_macros.h:320</a></div></div>
<div class="ttc" id="group__Macros_html_ga25935c2309abe02cff60809c4d7d9b9e"><div class="ttname"><a href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a></div><div class="ttdeci">#define realWRAP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00304">xmipp_macros.h:304</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a6277e2a7446059985dc9bcf0a4ac1a8f"><div class="ttname"><a href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a></div><div class="ttdeci">doublereal * u</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gadcb82c3ff44ffd9c34b67c3ca943613d"><div class="ttname"><a href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a></div><div class="ttdeci">#define FOR_ALL_MODELS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00036">mlf_align2d.h:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9d77accb6928b8ef9febe0cc57883c28"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::processOneImage </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Mimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>focus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>apply_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>fracweight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>maxweight2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>sum_refw2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>opt_scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t &amp;&#160;</td>
          <td class="paramname"><em>opt_refno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>opt_psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t &amp;&#160;</td>
          <td class="paramname"><em>opt_ipsi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t &amp;&#160;</td>
          <td class="paramname"><em>opt_iflip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>opt_offsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>opt_offsets_ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>pdf_directions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>do_kstest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>write_histograms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFileName.html">FileName</a>&#160;</td>
          <td class="paramname"><em>fn_img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>KSprob</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform expectation step for a single image. </p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l01585">1585</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;{</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    std::vector&lt;double&gt; &amp;Mwsum_sigma2_local = <a class="code" href="classProgMLF2D.html#af78a059d07b955ccd42e8a17ef827d19">Mwsum_sigma2</a>[focus];</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a>                             Mweight;</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;int&gt;</a>                                Moffsets, Moffsets_mirror;</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    std::vector&lt;double&gt;                               Fimg_trans;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    std::vector&lt;MultidimArray&lt;double&gt; &gt;               uniq_offsets;</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    std::vector&lt;double&gt; refw(<a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a>), refw2(<a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a>), refw_mirror(<a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a>), Pmax_refmir(2*<a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a>);</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    <span class="keywordtype">double</span> aux, fracpdf, weight, weight2=0.;</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <span class="keywordtype">double</span> tmpr, tmpi, sum_refw = 0.;</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="keywordtype">double</span> diff, maxweight = -99.e99, mindiff2 = 99.e99;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="keywordtype">double</span> logsigma2, ldim, ref_scale = 1.;</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="keywordtype">double</span> scale_denom, scale_numer, wsum_sc = 0., wsum_sc2 = 0.;</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="keywordtype">int</span>    irot, irefmir, opt_irefmir=0, ix, iy;</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="keywordtype">size_t</span> point_trans=0;</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    <span class="keywordtype">int</span>    opt_itrans=0, iflip_start, iflip_stop, nr_mir;</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <span class="keywordtype">int</span>    img_start, ref_start, wsum_start;</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">do_norm</a>)</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;        opt_scale =1.;</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    <span class="comment">// Convert 1D Vsig vectors to the correct vector size for the 2D FTHalfs</span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    <span class="comment">// Multiply by a factor of two because we consider both the real and the imaginary parts</span></div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    ldim = (double) 2 * <a class="code" href="classProgMLF2D.html#a963f62304538d74f796a3d20475480ee">nr_points_prob</a>;</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <span class="comment">// For t-student: df2 changes with effective resolution!</span></div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a>)</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a3106e12c5756e90d770df3708307258d">df2</a> = - ( <a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a> +  ldim ) / 2. ;</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    sum_refw2 = 0.;</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="comment">//change std::vectors by arrays</span></div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <span class="keywordtype">double</span> *sigma2=<span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">nr_points_2d</a>];</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <span class="keywordtype">double</span> *inv_sigma2=<span class="keyword">new</span> <span class="keywordtype">double</span> [<a class="code" href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">nr_points_2d</a>];</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="keywordtype">double</span> *ctf=<span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">nr_points_2d</a>];</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="keywordtype">double</span> *decctf=<span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">nr_points_2d</a>];</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;ifocus = focus;</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <a class="code" href="group__MLFalign2D.html#gad6c8256d157712ecc71b18f4d3335f56">FOR_ALL_POINTS</a>()</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    {</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        <span class="keywordtype">int</span> irr = <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(<a class="code" href="classProgMLF2D.html#a78ef99a6261c8c228ca1bab9f0c2205a">Mresol_int</a>,<a class="code" href="classProgMLF2D.html#a26c5a01345ef85eaabf6056c0f76f848">pointer_2d</a>[ipoint]);</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;        sigma2[ipoint] = 2. * <a class="code" href="group__MLFalign2D.html#gaea9964961fe272b8b7277239202912cb">VSIG_ITEM</a>;</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        inv_sigma2[ipoint] = 1./ sigma2[ipoint];</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;        decctf[ipoint] = <a class="code" href="group__MLFalign2D.html#ga7ba3f876baf2feea5984660892eeeb8a">VDEC_ITEM</a>;</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        ctf[ipoint] = <a class="code" href="group__MLFalign2D.html#gae2592474564ce2c4143fab306b777807">VCTF_ITEM</a>;</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    }</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <span class="keywordflow">if</span> (!apply_ctf)</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    {</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        <a class="code" href="group__MLFalign2D.html#gad6c8256d157712ecc71b18f4d3335f56">FOR_ALL_POINTS</a>()</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;        ctf[ipoint] = 1.;</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    }</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    <span class="comment">// Precalculate normalization constant</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    logsigma2 = 0.;</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="keywordtype">double</span> factor = (<a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a>) ? <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * <a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a> * 0.5 : <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>;</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <span class="comment">// Multiply by two because we treat real and imaginary parts!</span></div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aca6408d1d58d2334ecf5b80c3a9a8881">for</a> (<span class="keywordtype">size_t</span> ipoint = 0; ipoint &lt; <a class="code" href="classProgMLF2D.html#a963f62304538d74f796a3d20475480ee">nr_points_prob</a>; ipoint++)</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;        logsigma2 += 2 * <a class="code" href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a>( <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(factor * sigma2[ipoint]));</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <span class="comment">// Precalculate Fimg_trans, on pruned and expanded offset list</span></div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <a class="code" href="classProgMLF2D.html#a86d435aa562ed8f627734219a54f9fbc">calculateFourierOffsets</a>(Mimg, opt_offsets_ref, Fimg_trans, Moffsets, Moffsets_mirror);</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    Mweight.initZeros(<a class="code" href="classProgMLF2D.html#a1f05f45301557f3c0a855a414b87b5fd">nr_trans</a>, <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.n_ref, <a class="code" href="classML2DBaseProgram.html#a715ad0eb7ac0ce476faf1623fedea1a8">nr_flip</a>*<a class="code" href="classML2DBaseProgram.html#a976dc404489a0c66af2800f0f73e76c7">nr_psi</a>);</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <a class="code" href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a>()</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    {</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classML2DBaseProgram.html#a549ca4cda193eb449087f9a316c61f20">limit_rot</a> || pdf_directions[refno] &gt; 0.)</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        {</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">do_norm</a>)</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                ref_scale = opt_scale / <a class="code" href="classProgMLF2D.html#a2fd51100d35db6ecdcb3ac704ab58435">refs_avgscale</a>[refno];</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;            <a class="code" href="group__MLFalign2D.html#ga20bc753097a030d2c2650ca5120deeab">FOR_ALL_FLIPS</a>()</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;            {</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                irefmir = (int)<a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(iflip / <a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>) * <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a> + refno;</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;                ix = (int)<a class="code" href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">round</a>(opt_offsets_ref[2*irefmir]);</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;                iy = (int)<a class="code" href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">round</a>(opt_offsets_ref[2*irefmir+1]);</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;                Pmax_refmir[irefmir] = 0.;</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;                point_trans = (iflip &lt; <a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>) ? <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Moffsets, iy, ix) : <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Moffsets_mirror, iy, ix);</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;                <span class="keywordflow">if</span> (point_trans &lt; 0 || point_trans &gt; <a class="code" href="classML2DBaseProgram.html#a997e2be4af206a96283a2f73cfacdcfe">dim2</a>)</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                {</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                    std::cerr&lt;&lt;<span class="stringliteral">&quot;point_trans = &quot;</span>&lt;&lt;point_trans&lt;&lt;<span class="stringliteral">&quot; ix= &quot;</span>&lt;&lt;ix&lt;&lt;<span class="stringliteral">&quot; iy= &quot;</span>&lt;&lt;iy&lt;&lt;std::endl;</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                    <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa640217ae2418fe91401329baab687564">ERR_INDEX_OUTOFBOUNDS</a>,<span class="stringliteral">&quot;mlf_align2d BUG: point_trans &lt; 0&quot;</span>);</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                }</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                fracpdf = (iflip &lt; <a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>) ? 1. - <a class="code" href="classProgMLF2D.html#a619e2aed7d1934de3ce40d04b4d160b3">mirror_fraction</a>[refno] : <a class="code" href="classProgMLF2D.html#a619e2aed7d1934de3ce40d04b4d160b3">mirror_fraction</a>[refno];</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                <span class="comment">// get the starting point in the Fimg_trans vector</span></div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;                img_start = point_trans*4*<a class="code" href="classProgMLF2D.html#a2839dd97c6d6098e665b16bed661b615">dnr_points_2d</a> + (iflip%<a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>)*<a class="code" href="classProgMLF2D.html#a2839dd97c6d6098e665b16bed661b615">dnr_points_2d</a>;</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                <a class="code" href="group__MLFalign2D.html#gae1d499e9328ad87a22b0cafeae0f1f01">FOR_ALL_ROTATIONS</a>()</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                {</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                    irot = iflip * nr_psi + ipsi;</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                    diff = 0.;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                    <span class="comment">// get the starting point in the Fref vector</span></div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                    ref_start = refno * nr_psi * <a class="code" href="classProgMLF2D.html#a2839dd97c6d6098e665b16bed661b615">dnr_points_2d</a> + ipsi * <a class="code" href="classProgMLF2D.html#a2839dd97c6d6098e665b16bed661b615">dnr_points_2d</a>;</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">do_ctf_correction</a>)</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;                    {</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ii = 0; ii &lt; <a class="code" href="classProgMLF2D.html#a963f62304538d74f796a3d20475480ee">nr_points_prob</a>; ii++)</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;                        {</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;                            tmpr = Fimg_trans[img_start + 2*ii] - ctf[ii] * ref_scale * <a class="code" href="classProgMLF2D.html#a3e59aa87465a609828f311a1b40f0ea9">Fref</a>[ref_start + 2*ii];</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;                            tmpi = Fimg_trans[img_start + 2*ii+1] - ctf[ii] * ref_scale * Fref[ref_start + 2*ii+1];</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;                            tmpr = (tmpr * tmpr + tmpi * tmpi) * inv_sigma2[ii];</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                            diff += tmpr;</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;                        }</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                    }</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;                    {</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ii = 0; ii &lt; <a class="code" href="classProgMLF2D.html#a963f62304538d74f796a3d20475480ee">nr_points_prob</a>; ii++)</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                        {</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                            tmpr = Fimg_trans[img_start + 2*ii] - ref_scale * <a class="code" href="classProgMLF2D.html#a3e59aa87465a609828f311a1b40f0ea9">Fref</a>[ref_start + 2*ii];</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                            tmpi = Fimg_trans[img_start + 2*ii+1] - ref_scale * Fref[ref_start + 2*ii+1];</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                            diff += (tmpr * tmpr + tmpi * tmpi) * inv_sigma2[ii];</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                        }</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                    }</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                    <span class="comment">// Multiply by two for t-student, because we divided by 2*sigma2 instead of sigma2!</span></div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a>)</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                        diff *= 2.;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(Mweight, <a class="code" href="classProgMLF2D.html#adec8e47d0ada48f2aea2259ca1b400cf">zero_trans</a>, refno, irot) = diff;</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classXmippProgram.html#a0130b89f1f5431b03ef161d7e231bd48">debug</a> == 9)</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;                    {</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;                        std::cerr&lt;&lt;<span class="stringliteral">&quot;refno= &quot;</span>&lt;&lt;refno&lt;&lt;<span class="stringliteral">&quot; irot= &quot;</span>&lt;&lt;irot&lt;&lt;<span class="stringliteral">&quot; diff= &quot;</span>&lt;&lt;diff&lt;&lt;<span class="stringliteral">&quot; mindiff2= &quot;</span>&lt;&lt;mindiff2&lt;&lt;std::endl;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                    }</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                    <span class="keywordflow">if</span> (diff &lt; mindiff2)</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                    {</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                        mindiff2 = diff;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                        opt_refno = refno;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                        opt_ipsi = ipsi;</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                        opt_iflip = iflip;</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                        opt_itrans = <a class="code" href="classProgMLF2D.html#adec8e47d0ada48f2aea2259ca1b400cf">zero_trans</a>;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;                        opt_irefmir = irefmir;</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                    }</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                }</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;            }</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        }</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classXmippProgram.html#a0130b89f1f5431b03ef161d7e231bd48">debug</a> == 9)</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        {</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;            std::cerr&lt;&lt;<span class="stringliteral">&quot;&gt;&gt;&gt;&gt;&gt; mindiff2= &quot;</span>&lt;&lt;mindiff2&lt;&lt;std::endl;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;            exit(1);</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        }</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    }</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="comment">// Now that we have mindiff2 calculate all weights and maxweight</span></div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <a class="code" href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a>()</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    {</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classML2DBaseProgram.html#a549ca4cda193eb449087f9a316c61f20">limit_rot</a> || pdf_directions[refno] &gt; 0.)</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        {</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;            refw[refno] = 0.;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;            refw_mirror[refno] = 0.;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;            <a class="code" href="group__MLFalign2D.html#ga20bc753097a030d2c2650ca5120deeab">FOR_ALL_FLIPS</a>()</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;            {</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;                irefmir = (int)<a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(iflip / <a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>) * <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a> + refno;</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;                ix = (int)<a class="code" href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">round</a>(opt_offsets_ref[2*irefmir]);</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;                iy = (int)<a class="code" href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">round</a>(opt_offsets_ref[2*irefmir+1]);</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                fracpdf = (iflip &lt; <a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>) ? 1. - <a class="code" href="classProgMLF2D.html#a619e2aed7d1934de3ce40d04b4d160b3">mirror_fraction</a>[refno] : <a class="code" href="classProgMLF2D.html#a619e2aed7d1934de3ce40d04b4d160b3">mirror_fraction</a>[refno];</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                <span class="keywordtype">double</span> pdf =  <a class="code" href="classProgMLF2D.html#a0cf09cc5d8c9949acc48438be868773c">alpha_k</a>[refno] * fracpdf * <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(<a class="code" href="classML2DBaseProgram.html#a6f44905656bc9d5a5bb57dea399cd18e">P_phi</a>, iy, ix);</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;                <span class="comment">// get the starting point in the Fimg_trans vector</span></div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;                img_start = point_trans*4*dnr_points_2d + (iflip%<a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>)*dnr_points_2d;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                <a class="code" href="group__MLFalign2D.html#gae1d499e9328ad87a22b0cafeae0f1f01">FOR_ALL_ROTATIONS</a>()</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                {</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                    irot = iflip * nr_psi + ipsi;</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                    diff = <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(Mweight, <a class="code" href="classProgMLF2D.html#adec8e47d0ada48f2aea2259ca1b400cf">zero_trans</a>, refno, irot);</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;                    <span class="comment">// get the starting point in the Fref vector</span></div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                    ref_start = refno*nr_psi*dnr_points_2d + ipsi*<a class="code" href="classProgMLF2D.html#a2839dd97c6d6098e665b16bed661b615">dnr_points_2d</a>;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a>)</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                    {</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;                        <span class="comment">// normal distribution</span></div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                        aux = diff - mindiff2;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;                        <span class="comment">// next line because of numerical precision of exp-function</span></div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                        <span class="keywordflow">if</span> (aux &gt; 100.)</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;                            weight = 0.;</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;                            weight = exp(-aux) * pdf;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;                        <span class="comment">// Store weight</span></div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;                        <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(Mweight, <a class="code" href="classProgMLF2D.html#adec8e47d0ada48f2aea2259ca1b400cf">zero_trans</a>, refno, irot) = weight;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;                    }</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                    {</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;                        <span class="comment">// t-student distribution</span></div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                        <span class="comment">// pdf = (1 + diff2/df)^df2</span></div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                        <span class="comment">// Correcting for mindiff2:</span></div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;                        <span class="comment">// pdfc = (1 + diff2/df)^df2 / (1 + mindiff2/df)^df2</span></div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                        <span class="comment">//      = ( (1 + diff2/df)/(1 + mindiff2/df) )^df2</span></div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;                        <span class="comment">//      = ( (df + diff2) / (df + mindiff2) )^df2</span></div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                        <span class="comment">// Extra factor two because we saved diff = | X - A |^2 / TWO * sigma</span></div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                        aux = (<a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a> + diff) / (<a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a> + mindiff2);</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                        weight = pow(aux, <a class="code" href="classML2DBaseProgram.html#a3106e12c5756e90d770df3708307258d">df2</a>) * pdf;</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                        <span class="comment">// Calculate extra weight acc. to Eq (10) Wang et al.</span></div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;                        <span class="comment">// Patt. Recognition Lett. 25, 701-710 (2004)</span></div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                        weight2 = ( <a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a> + ldim ) / ( <a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a> + diff  );</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                        <span class="comment">// Store probability weights</span></div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;                        <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(Mweight, <a class="code" href="classProgMLF2D.html#adec8e47d0ada48f2aea2259ca1b400cf">zero_trans</a>, refno, irot) = weight * weight2;</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                        refw2[refno] += weight * weight2;</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                        sum_refw2 += weight * weight2;</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                    }</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                    <span class="comment">// Accumulate sum weights</span></div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                    <span class="keywordflow">if</span> (iflip &lt; <a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>)</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                        refw[refno] += weight;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                        refw_mirror[refno] += weight;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;                    sum_refw += weight;</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                    <span class="comment">//std::cerr &lt;&lt; &quot;DEBUG_JM: refno &lt;&lt; iflip &lt;&lt; ipsi: &quot; &lt;&lt; refno &lt;&lt; &quot; &quot; &lt;&lt; iflip &lt;&lt; &quot; &quot; &lt;&lt; ipsi &lt;&lt; std::endl;</span></div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                    <span class="comment">//std::cerr &lt;&lt; &quot;DEBUG_JM:          weight: &quot; &lt;&lt; weight &lt;&lt; &quot; sum_refw: &quot; &lt;&lt; sum_refw &lt;&lt; std::endl;</span></div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">do_norm</a>)</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                    {</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;                        scale_numer = 0.;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                        scale_denom = 0.;</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">do_ctf_correction</a>)</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;                        {</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;                            <span class="comment">// NOTE: scale_denom could be precalculated in</span></div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                            <span class="comment">// a much cheaper way!!!!</span></div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ii = 0; ii &lt; <a class="code" href="classProgMLF2D.html#a963f62304538d74f796a3d20475480ee">nr_points_prob</a>; ii++)</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;                            {</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;                                scale_numer += Fimg_trans[img_start + 2*ii] * ctf[ii] * <a class="code" href="classProgMLF2D.html#a3e59aa87465a609828f311a1b40f0ea9">Fref</a>[ref_start + 2*ii];</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;                                scale_numer += Fimg_trans[img_start + 2*ii+1] * ctf[ii] * Fref[ref_start + 2*ii+1];</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;                                scale_denom += ctf[ii] * Fref[ref_start + 2*ii] * ctf[ii] * Fref[ref_start + 2*ii];</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;                                scale_denom += ctf[ii] * Fref[ref_start + 2*ii+1] * ctf[ii] * Fref[ref_start + 2*ii+1];</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;                            }</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;                        }</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;                        {</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ii = 0; ii &lt; <a class="code" href="classProgMLF2D.html#a963f62304538d74f796a3d20475480ee">nr_points_prob</a>; ii++)</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;                            {</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;                                scale_numer += Fimg_trans[img_start + 2*ii] * <a class="code" href="classProgMLF2D.html#a3e59aa87465a609828f311a1b40f0ea9">Fref</a>[ref_start + 2*ii];</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;                                scale_numer += Fimg_trans[img_start + 2*ii+1] * Fref[ref_start + 2*ii+1];</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                                scale_denom += Fref[ref_start + 2*ii] * Fref[ref_start + 2*ii];</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;                                scale_denom += Fref[ref_start + 2*ii+1] * Fref[ref_start + 2*ii+1];</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                            }</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                        }</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;                        wsum_sc += <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(Mweight, <a class="code" href="classProgMLF2D.html#adec8e47d0ada48f2aea2259ca1b400cf">zero_trans</a>, refno, irot) * scale_numer;</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                        wsum_sc2 += <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(Mweight, <a class="code" href="classProgMLF2D.html#adec8e47d0ada48f2aea2259ca1b400cf">zero_trans</a>, refno, irot) * scale_denom;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                    }</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                    <span class="keywordflow">if</span> (weight &gt; Pmax_refmir[irefmir])</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                        Pmax_refmir[irefmir] = weight;</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;                    <span class="keywordflow">if</span> (weight &gt; maxweight)</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                    {</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                        maxweight = weight;</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a>)</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                            maxweight2 = weight2;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                        opt_refno = refno;</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                        opt_ipsi = ipsi;</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                        opt_iflip = iflip;</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                        opt_itrans = <a class="code" href="classProgMLF2D.html#adec8e47d0ada48f2aea2259ca1b400cf">zero_trans</a>;</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                        opt_irefmir = irefmir;</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                    }</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                }</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;            }</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;        }</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    }</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="comment">//std::cerr &lt;&lt; &quot;DEBUG_JM: &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&quot; &lt;&lt;std::endl;</span></div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="comment">// Now for all irefmir, check significant rotations...</span></div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="comment">// and calculate their limited_translations probabilities</span></div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    <a class="code" href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a>()</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    {</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classML2DBaseProgram.html#a549ca4cda193eb449087f9a316c61f20">limit_rot</a> || pdf_directions[refno] &gt; 0.)</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        {</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">do_norm</a>)</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;                ref_scale = opt_scale / <a class="code" href="classProgMLF2D.html#a2fd51100d35db6ecdcb3ac704ab58435">refs_avgscale</a>[refno];</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;            <a class="code" href="group__MLFalign2D.html#ga20bc753097a030d2c2650ca5120deeab">FOR_ALL_FLIPS</a>()</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;            {</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                irefmir = (int)<a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(iflip / <a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>) * <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a> + refno;</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                fracpdf = (iflip &lt; <a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>) ? 1. - <a class="code" href="classProgMLF2D.html#a619e2aed7d1934de3ce40d04b4d160b3">mirror_fraction</a>[refno] : <a class="code" href="classProgMLF2D.html#a619e2aed7d1934de3ce40d04b4d160b3">mirror_fraction</a>[refno];</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;                <a class="code" href="group__MLFalign2D.html#gae1d499e9328ad87a22b0cafeae0f1f01">FOR_ALL_ROTATIONS</a>()</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                {</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                    irot = iflip * nr_psi + ipsi;</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;                    <span class="comment">// Note that for t-students distribution we now do something</span></div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;                    <span class="comment">// a little bit different compared to ML_integrate_complete!</span></div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                    <span class="comment">// Instead of comparing &quot;weight&quot;, we compare &quot;weight*weight2&quot;!!</span></div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(Mweight, <a class="code" href="classProgMLF2D.html#adec8e47d0ada48f2aea2259ca1b400cf">zero_trans</a>, refno, irot) &gt; <a class="code" href="classML2DBaseProgram.html#a67faef1c7bbe1544c7f51e4d4fa0e833">C_fast</a>*Pmax_refmir[irefmir])</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;                    {</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;                        <span class="comment">// get the starting point in the Fref vector</span></div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;                        ref_start = refno*nr_psi*dnr_points_2d + ipsi*<a class="code" href="classProgMLF2D.html#a2839dd97c6d6098e665b16bed661b615">dnr_points_2d</a>;</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;                        <span class="comment">// expand for all limited translations</span></div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;                        <a class="code" href="group__MLFalign2D.html#gacd0a39abfcd60d9c68ca9b3756a8ebc2">FOR_ALL_LIMITED_TRANSLATIONS</a>()</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;                        {</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;                            <span class="keywordflow">if</span> (itrans != <a class="code" href="classProgMLF2D.html#adec8e47d0ada48f2aea2259ca1b400cf">zero_trans</a>)</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;                            { <span class="comment">// zero_trans has already been calculated!</span></div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;                                ix = (int)<a class="code" href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">round</a>(opt_offsets_ref[2*irefmir] + <a class="code" href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">Vtrans</a>[itrans](0));</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;                                iy = (int)<a class="code" href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">round</a>(opt_offsets_ref[2*irefmir+1] + <a class="code" href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">Vtrans</a>[itrans](1));</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;                                ix = <a class="code" href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a>(ix, Moffsets.startingX(), Moffsets.finishingX());</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;                                iy = <a class="code" href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a>(iy, Moffsets.startingY(), Moffsets.finishingY());</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;                                <span class="keywordflow">if</span> (iflip &lt; <a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>)</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;                                    point_trans = <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Moffsets, iy, ix);</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;                                <span class="keywordflow">else</span></div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                                    point_trans = <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Moffsets_mirror, iy, ix);</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;                                <span class="keywordflow">if</span> (point_trans &lt; 0 || point_trans &gt; dim2)</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;                                {</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;                                    std::cerr&lt;&lt;<span class="stringliteral">&quot;point_trans = &quot;</span>&lt;&lt;point_trans&lt;&lt;<span class="stringliteral">&quot; ix= &quot;</span>&lt;&lt;ix&lt;&lt;<span class="stringliteral">&quot; iy= &quot;</span>&lt;&lt;iy&lt;&lt;std::endl;</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;                                    <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa640217ae2418fe91401329baab687564">ERR_INDEX_OUTOFBOUNDS</a>,<span class="stringliteral">&quot;mlf_align2d BUG: point_trans &lt; 0 or &gt; dim2&quot;</span>);</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;                                }</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;                                <span class="keywordtype">double</span> pdf =  <a class="code" href="classProgMLF2D.html#a0cf09cc5d8c9949acc48438be868773c">alpha_k</a>[refno] * fracpdf * <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(<a class="code" href="classML2DBaseProgram.html#a6f44905656bc9d5a5bb57dea399cd18e">P_phi</a>, iy, ix);</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                                <span class="keywordflow">if</span> (pdf &gt; 0)</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;                                {</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                                    <span class="comment">// get the starting point in the Fimg_trans vector</span></div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;                                    img_start = point_trans*4*dnr_points_2d + (iflip%<a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>)*dnr_points_2d;</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;                                    diff = 0.;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">do_ctf_correction</a>)</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;                                    {</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;                                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ii = 0; ii &lt; <a class="code" href="classProgMLF2D.html#a963f62304538d74f796a3d20475480ee">nr_points_prob</a>; ii++)</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;                                        {</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;                                            tmpr = Fimg_trans[img_start + 2*ii] - ctf[ii] * ref_scale * <a class="code" href="classProgMLF2D.html#a3e59aa87465a609828f311a1b40f0ea9">Fref</a>[ref_start + 2*ii];</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;                                            tmpi = Fimg_trans[img_start + 2*ii+1] - ctf[ii] * ref_scale * Fref[ref_start + 2*ii+1];</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;                                            diff += (tmpr * tmpr + tmpi * tmpi) * inv_sigma2[ii];</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;                                        }</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;                                    }</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;                                    <span class="keywordflow">else</span></div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;                                    {</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;                                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ii = 0; ii &lt; <a class="code" href="classProgMLF2D.html#a963f62304538d74f796a3d20475480ee">nr_points_prob</a>; ii++)</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;                                        {</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;                                            tmpr = Fimg_trans[img_start + 2*ii] - ref_scale * <a class="code" href="classProgMLF2D.html#a3e59aa87465a609828f311a1b40f0ea9">Fref</a>[ref_start + 2*ii];</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;                                            tmpi = Fimg_trans[img_start + 2*ii+1] - ref_scale * Fref[ref_start + 2*ii+1];</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;                                            diff += (tmpr * tmpr + tmpi * tmpi) * inv_sigma2[ii];</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;                                        }</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;                                    }</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;                                    <span class="keywordflow">if</span> (!<a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a>)</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;                                    {</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;                                        <span class="comment">// Normal distribution</span></div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;                                        aux = diff - mindiff2;</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                                        <span class="comment">//FIXME: In this second loop the mindiff2 is not really the</span></div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;                                        <span class="comment">//minimum diff, that&#39;s why sometimes aux is less than zero</span></div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;                                        <span class="comment">//causing exponential to go inf, for now setting weight to zero</span></div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;                                        <span class="comment">// next line because of numerical precision of exp-function</span></div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;                                        <span class="keywordflow">if</span> (aux &gt; 100. || aux &lt; 0)</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                                            weight = 0.;</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;                                        <span class="keywordflow">else</span></div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;                                            weight = exp(-aux) * pdf;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;                                        <span class="comment">// Store weight</span></div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;                                        <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(Mweight, itrans, refno, irot) = weight;</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;                                    }</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;                                    <span class="keywordflow">else</span></div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;                                    {</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;                                        <span class="comment">// t-student distribution</span></div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;                                        <span class="comment">// now diff2 and mindiff2 are already divided by sigma2!!</span></div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                                        <span class="comment">// pdf = (1 + diff2/df)^df2</span></div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;                                        <span class="comment">// Correcting for mindiff2:</span></div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;                                        <span class="comment">// pdfc = (1 + diff2/df)^df2 / (1 + mindiff2/df)^df2</span></div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;                                        <span class="comment">//      = ( (1 + diff2/df)/(1 + mindiff2/df) )^df2</span></div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;                                        <span class="comment">//      = ( (df + diff2) / (df + mindiff2) )^df2</span></div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;                                        <span class="comment">// Multiply by two for t-student, because we divided by 2*sigma2</span></div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;                                        diff *= 2.;</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;                                        <span class="comment">// Extra factor two because we saved diff = | X - A |^2 / TWO * sigma</span></div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;                                        aux = (<a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a> + diff) / (<a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a> + mindiff2);</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;                                        weight = pow(aux, <a class="code" href="classML2DBaseProgram.html#a3106e12c5756e90d770df3708307258d">df2</a>) * pdf;</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;                                        <span class="comment">// Calculate extra weight acc. to Eq (10) Wang et al.</span></div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                                        <span class="comment">// Patt. Recognition Lett. 25, 701-710 (2004)</span></div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;                                        weight2 = ( <a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a> + ldim ) / ( <a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a> + diff);</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;                                        <span class="comment">// Store probability weights</span></div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;                                        <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(Mweight, itrans, refno, irot) = weight * weight2;</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;                                        refw2[refno] += weight * weight2;</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;                                        sum_refw2 += weight * weight2;</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;                                    }</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;                                    <span class="comment">// Accumulate sum weights</span></div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;                                    <span class="keywordflow">if</span> (iflip &lt; <a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>)</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;                                        refw[refno] += weight;</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;                                    <span class="keywordflow">else</span></div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                                        refw_mirror[refno] += weight;</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;                                    sum_refw += weight;</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">do_norm</a>)</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;                                    {</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;                                        scale_numer = 0.;</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;                                        scale_denom = 0.;</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;                                        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">do_ctf_correction</a>)</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;                                        {</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;                                            <span class="comment">// NOTE: scale_denom could be precalculated in</span></div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;                                            <span class="comment">// a much cheaper way!!!!</span></div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;                                            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ii = 0; ii &lt; <a class="code" href="classProgMLF2D.html#a963f62304538d74f796a3d20475480ee">nr_points_prob</a>; ii++)</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;                                            {</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;                                                scale_numer += Fimg_trans[img_start + 2*ii]</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;                                                               * ctf[ii] * <a class="code" href="classProgMLF2D.html#a3e59aa87465a609828f311a1b40f0ea9">Fref</a>[ref_start + 2*ii];</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;                                                scale_numer += Fimg_trans[img_start + 2*ii+1]</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;                                                               * ctf[ii] * Fref[ref_start + 2*ii+1];</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;                                                scale_denom += ctf[ii] * Fref[ref_start + 2*ii]</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;                                                               * ctf[ii] * Fref[ref_start + 2*ii];</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;                                                scale_denom += ctf[ii] * Fref[ref_start + 2*ii+1]</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                                                               * ctf[ii] * Fref[ref_start + 2*ii+1];</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;                                            }</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                                        }</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;                                        <span class="keywordflow">else</span></div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;                                        {</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;                                            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ii = 0; ii &lt; <a class="code" href="classProgMLF2D.html#a963f62304538d74f796a3d20475480ee">nr_points_prob</a>; ii++)</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;                                            {</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;                                                scale_numer += Fimg_trans[img_start + 2*ii]</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;                                                               * <a class="code" href="classProgMLF2D.html#a3e59aa87465a609828f311a1b40f0ea9">Fref</a>[ref_start + 2*ii];</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;                                                scale_numer += Fimg_trans[img_start + 2*ii+1]</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;                                                               * Fref[ref_start + 2*ii+1];</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;                                                scale_denom += Fref[ref_start + 2*ii]</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;                                                               * Fref[ref_start + 2*ii];</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;                                                scale_denom += Fref[ref_start + 2*ii+1]</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;                                                               * Fref[ref_start + 2*ii+1];</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;                                            }</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;                                        }</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;                                        wsum_sc += <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(Mweight, itrans, refno, irot) * scale_numer;</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;                                        wsum_sc2 += <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(Mweight, itrans, refno, irot) * scale_denom;</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;                                    }</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;                                    <span class="keywordflow">if</span> (weight &gt; maxweight)</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;                                    {</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;                                        maxweight = weight;</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;                                        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a>)</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                                            maxweight2 = weight2;</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                                        opt_refno = refno;</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;                                        opt_ipsi = ipsi;</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;                                        opt_iflip = iflip;</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                                        opt_itrans = itrans;</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;                                        opt_irefmir = irefmir;</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                                    }</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;                                }</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;                                <span class="keywordflow">else</span></div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;                                    <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(Mweight, itrans, refno, irot) = 0.;</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;                            }</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;                        }</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;                    }</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;                }</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;            }</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        }</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    }</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    <span class="comment">// Update optimal offsets</span></div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    opt_offsets(0) = opt_offsets_ref[2*opt_irefmir] + <a class="code" href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">Vtrans</a>[opt_itrans](0);</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    opt_offsets(1) = opt_offsets_ref[2*opt_irefmir+1] + <a class="code" href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">Vtrans</a>[opt_itrans](1);</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    opt_psi = -<a class="code" href="classML2DBaseProgram.html#aae259850c9b209a3ff3cbcc7799e2742">psi_step</a> * (opt_iflip * nr_psi + opt_ipsi) - <a class="code" href="ml2d_8h.html#a6b49ded9ade4e2a8b65b16670db60486">SMALLANGLE</a>;</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    <span class="comment">// Perform KS-test on difference image of optimal hidden parameters</span></div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    <span class="comment">// And calculate noise distribution histograms</span></div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a79873ba6ac0a02ebff149285475a8721">do_kstest</a>)</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    {</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;        <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> diff(2*nr_points_prob);</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        std::vector&lt;std::vector&lt;double&gt; &gt; res_diff;</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;        res_diff.resize(<a class="code" href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">hdim</a>);</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        <span class="keywordflow">if</span> (opt_iflip &lt; <a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>)</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;            point_trans = <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Moffsets, (<span class="keywordtype">int</span>)opt_offsets(1), (<span class="keywordtype">int</span>)opt_offsets(0));</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;            point_trans = <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Moffsets_mirror, (<span class="keywordtype">int</span>)opt_offsets(1), (<span class="keywordtype">int</span>)opt_offsets(0));</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;        img_start = point_trans*4*dnr_points_2d + (opt_iflip%<a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>)*dnr_points_2d;</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;        ref_start = opt_refno*nr_psi*dnr_points_2d + opt_ipsi*<a class="code" href="classProgMLF2D.html#a2839dd97c6d6098e665b16bed661b615">dnr_points_2d</a>;</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">do_norm</a>)</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;            ref_scale = opt_scale / <a class="code" href="classProgMLF2D.html#a2fd51100d35db6ecdcb3ac704ab58435">refs_avgscale</a>[opt_refno];</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ii = 0; ii &lt; <a class="code" href="classProgMLF2D.html#a963f62304538d74f796a3d20475480ee">nr_points_prob</a>; ii++)</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;        {</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;            <span class="keywordtype">double</span> inv_sqrt_sigma2 = 1. / <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(0.5*sigma2[ii]);</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">do_ctf_correction</a>)</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;            {</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(diff,2*ii) = (Fimg_trans[img_start + 2*ii] -</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;                                  ctf[ii] * ref_scale * <a class="code" href="classProgMLF2D.html#a3e59aa87465a609828f311a1b40f0ea9">Fref</a>[ref_start + 2*ii]) * inv_sqrt_sigma2;</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(diff,2*ii+1) = (Fimg_trans[img_start + 2*ii+1] -</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                                    ctf[ii] * ref_scale * <a class="code" href="classProgMLF2D.html#a3e59aa87465a609828f311a1b40f0ea9">Fref</a>[ref_start + 2*ii+1]) * inv_sqrt_sigma2;</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;            }</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;            {</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(diff,2*ii) = (Fimg_trans[img_start + 2*ii] -</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;                                  ref_scale * <a class="code" href="classProgMLF2D.html#a3e59aa87465a609828f311a1b40f0ea9">Fref</a>[ref_start + 2*ii])*  inv_sqrt_sigma2;</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(diff,2*ii+1) = (Fimg_trans[img_start + 2*ii+1] -</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;                                    ref_scale * <a class="code" href="classProgMLF2D.html#a3e59aa87465a609828f311a1b40f0ea9">Fref</a>[ref_start + 2*ii+1]) *  inv_sqrt_sigma2;</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;            }</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;            <span class="comment">// Fill vectors for resolution-depedent histograms</span></div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;            <span class="keywordtype">int</span> ires = <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(<a class="code" href="classProgMLF2D.html#a78ef99a6261c8c228ca1bab9f0c2205a">Mresol_int</a>, <a class="code" href="classProgMLF2D.html#a26c5a01345ef85eaabf6056c0f76f848">pointer_2d</a>[ii]);</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;            res_diff[ires].push_back(<a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(diff,2*ii));</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;            res_diff[ires].push_back(<a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(diff,2*ii+1));</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;        }</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;        <span class="keywordtype">double</span> * aux_array = <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(diff) - 1;</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;        <span class="keywordtype">double</span> KSD =0.;</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a>)</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;        {</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a>==1)</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;                <a class="code" href="numerical__recipes_8cpp.html#a539e20a02b977a36314ddec48e8033a5">ksone</a>(aux_array, 2*nr_points_prob, &amp;<a class="code" href="mlf__align2d_8cpp.html#a276d2af179c768b68c2a53270783d58a">lcdf_tstudent_mlf1</a>, &amp;KSD, &amp;KSprob);</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a>==3)</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;                <a class="code" href="numerical__recipes_8cpp.html#a539e20a02b977a36314ddec48e8033a5">ksone</a>(aux_array, 2*nr_points_prob, &amp;<a class="code" href="mlf__align2d_8cpp.html#abfbf7b3eddce4b077e5488ed0387c00a">lcdf_tstudent_mlf3</a>, &amp;KSD, &amp;KSprob);</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a>==6)</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;                <a class="code" href="numerical__recipes_8cpp.html#a539e20a02b977a36314ddec48e8033a5">ksone</a>(aux_array, 2*nr_points_prob, &amp;<a class="code" href="mlf__align2d_8cpp.html#aa9caeb01ffd59d5630c89d38c519e70e">lcdf_tstudent_mlf6</a>, &amp;KSD, &amp;KSprob);</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a>==9)</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;                <a class="code" href="numerical__recipes_8cpp.html#a539e20a02b977a36314ddec48e8033a5">ksone</a>(aux_array, 2*nr_points_prob, &amp;<a class="code" href="mlf__align2d_8cpp.html#aa5b0c57accec2f3b8de9df2adfa4e52d">lcdf_tstudent_mlf9</a>, &amp;KSD, &amp;KSprob);</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a>==30)</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;                <a class="code" href="numerical__recipes_8cpp.html#a539e20a02b977a36314ddec48e8033a5">ksone</a>(aux_array, 2*nr_points_prob, &amp;<a class="code" href="mlf__align2d_8cpp.html#a4d5d05f55593a53915fb65e07840756e">lcdf_tstudent_mlf30</a>, &amp;KSD, &amp;KSprob);</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a>,<span class="stringliteral">&quot;KS-test for t-distribution only implemented for df=1,3,6,9 or 30!&quot;</span>);</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;        }</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        {</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;            <a class="code" href="numerical__recipes_8cpp.html#a539e20a02b977a36314ddec48e8033a5">ksone</a>(aux_array, 2*nr_points_prob, &amp;<a class="code" href="group__GeneralFunctions.html#ga5a4604cb3736cd6b9e4a577f7b0c68f3">cdf_gauss</a>, &amp;KSD, &amp;KSprob);</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        }</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;        <span class="comment">// Compute resolution-dependent histograms</span></div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ires = 0; ires &lt; <a class="code" href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">hdim</a>; ires++)</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        {</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;res_diff[ires].size(); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                <a class="code" href="classProgMLF2D.html#aff8593015f02560e8e3e85ebd86ba894">resolhist</a>[ires].insert_value(res_diff[ires][<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>]);</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;        }</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;        <span class="comment">// Overall average histogram</span></div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a4876f30a8c1b41ead612a89de1f3eed0">sumhist</a>.<a class="code" href="classHistogram1D.html#a493d78efd9e4967222aad25dab31447c">sampleNo</a>()==0)</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;            <a class="code" href="classProgMLF2D.html#a4876f30a8c1b41ead612a89de1f3eed0">sumhist</a>.<a class="code" href="classHistogram1D.html#ac40dd6aedb6ee53598b7bcc05ab27db5">init</a>(<a class="code" href="group__MLFalign2D.html#ga998b4df4b03424508c129e4fad74b36f">HISTMIN</a>, <a class="code" href="group__MLFalign2D.html#gab2b66f57ef06321905e6675d295b3172">HISTMAX</a>, <a class="code" href="group__MLFalign2D.html#ga2dfb9d47a060372ac150f68c9ff4cc09">HISTSTEPS</a>);</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(diff)</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;        <a class="code" href="classProgMLF2D.html#a4876f30a8c1b41ead612a89de1f3eed0">sumhist</a>.insert_value(<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(diff, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>));</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (write_histograms)</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;        {</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;            <a class="code" href="classHistogram1D.html">Histogram1D</a>     hist;</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;            <span class="keywordtype">double</span>          val;</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;            hist.<a class="code" href="classHistogram1D.html#ac40dd6aedb6ee53598b7bcc05ab27db5">init</a>(<a class="code" href="group__MLFalign2D.html#ga998b4df4b03424508c129e4fad74b36f">HISTMIN</a>, <a class="code" href="group__MLFalign2D.html#gab2b66f57ef06321905e6675d295b3172">HISTMAX</a>, <a class="code" href="group__MLFalign2D.html#ga2dfb9d47a060372ac150f68c9ff4cc09">HISTSTEPS</a>);</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;            <a class="code" href="group__Histograms.html#gaaa3501212e9e03d46c6e7aba56dd6c21">compute_hist</a>(diff,hist,<a class="code" href="group__MLFalign2D.html#ga998b4df4b03424508c129e4fad74b36f">HISTMIN</a>, <a class="code" href="group__MLFalign2D.html#gab2b66f57ef06321905e6675d295b3172">HISTMAX</a>, <a class="code" href="group__MLFalign2D.html#ga2dfb9d47a060372ac150f68c9ff4cc09">HISTSTEPS</a>);</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;            hist /= hist.<a class="code" href="classMultidimArray.html#a2917347534008460dd52e90049e4257f">sum</a>()*hist.<a class="code" href="classHistogram1D.html#a1f33208fed8e9026279a5002176107f3">step_size</a>;</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;            <a class="code" href="classFileName.html">FileName</a> fn_hist = fn_img + <span class="stringliteral">&quot;.hist&quot;</span>;</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;            std::ofstream fh_hist;</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;            fh_hist.open((fn_hist).c_str(), std::ios::out);</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;            <span class="keywordflow">if</span> (!fh_hist)</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;                <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aabda7431146b956debfa7f89164af1790">ERR_IO_NOTOPEN</a>, (<a class="code" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a>)<span class="stringliteral">&quot;Cannot write histogram file &quot;</span>+ fn_hist);</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gaa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(hist)</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;            {</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;                hist.<a class="code" href="classHistogram1D.html#a5b24f78917ecda9d47e420b3a6c4cbd7">index2val</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, val);</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;                val += 0.5*hist.<a class="code" href="classHistogram1D.html#a1f33208fed8e9026279a5002176107f3">step_size</a>;</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;                fh_hist &lt;&lt; val&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;<a class="code" href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(hist, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a>)</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;                    fh_hist &lt;&lt; <a class="code" href="group__GeneralFunctions.html#ga9483aca229770e20a5b7fb1df4aee6a1">tstudent1D</a>(val, <a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a>, 1., 0.)&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;                    fh_hist &lt;&lt; <a class="code" href="group__GeneralFunctions.html#ga15ac71366a2fcd18ab5769593246a2ed">gaussian1D</a>(val, 1., 0.)&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;            }</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;            fh_hist.close();</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;        }</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    }</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    <span class="comment">// Update opt_scale</span></div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">do_norm</a>)</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    {</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;        opt_scale = wsum_sc / wsum_sc2;</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    }</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;    <span class="comment">// Acummulate all weighted sums</span></div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    <span class="comment">// and normalize them by sum_refw, such that sum over all weights is one!</span></div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    <a class="code" href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a>()</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    {</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classML2DBaseProgram.html#a549ca4cda193eb449087f9a316c61f20">limit_rot</a> || pdf_directions[refno] &gt; 0.)</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;        {</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;            <a class="code" href="classProgMLF2D.html#a0a90a0680ddfe59efa8bac1303fada63">sumw</a>[refno] += (refw[refno] + refw_mirror[refno]) / sum_refw;</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;            <a class="code" href="classProgMLF2D.html#a07e1e912286ab9303da3d4a654d26dd6">sumw2</a>[refno] += refw2[refno] / sum_refw;</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a>)</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;            {</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;                <a class="code" href="classProgMLF2D.html#a92faef343a74868a005e5de666778470">sumwsc</a>[refno] += refw2[refno] * opt_scale / sum_refw;</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;                <a class="code" href="classProgMLF2D.html#ab34721b1edbfbb6b3feb83c1aa825166">sumwsc2</a>[refno] += refw2[refno] * opt_scale * opt_scale / sum_refw;</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;            }</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;            {</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;                <a class="code" href="classProgMLF2D.html#a92faef343a74868a005e5de666778470">sumwsc</a>[refno] += (refw[refno] + refw_mirror[refno]) * (opt_scale) / sum_refw;</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                <a class="code" href="classProgMLF2D.html#ab34721b1edbfbb6b3feb83c1aa825166">sumwsc2</a>[refno] += (refw[refno] + refw_mirror[refno]) * (opt_scale * opt_scale) / sum_refw;</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;            }</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;            <a class="code" href="classProgMLF2D.html#a86adb43015401e250b579f9d49f00730">sumw_mirror</a>[refno] += refw_mirror[refno] / sum_refw;</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;            <a class="code" href="group__MLFalign2D.html#ga20bc753097a030d2c2650ca5120deeab">FOR_ALL_FLIPS</a>()</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;            {</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;                irefmir = (int)<a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(iflip / <a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>) * <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a> + refno;</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;                <a class="code" href="group__MLFalign2D.html#gae1d499e9328ad87a22b0cafeae0f1f01">FOR_ALL_ROTATIONS</a>()</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;                {</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;                    irot = iflip * nr_psi + ipsi;</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;                    <span class="comment">// get the starting point in the Fwsum_imgs vectors</span></div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                    wsum_start = refno*nr_psi*dnr_points_2d + ipsi*<a class="code" href="classProgMLF2D.html#a2839dd97c6d6098e665b16bed661b615">dnr_points_2d</a>;</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                    <a class="code" href="group__MLFalign2D.html#gacd0a39abfcd60d9c68ca9b3756a8ebc2">FOR_ALL_LIMITED_TRANSLATIONS</a>()</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                    {</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;                        ix = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(opt_offsets_ref[2*irefmir] + <a class="code" href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">Vtrans</a>[itrans](0));</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;                        iy = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(opt_offsets_ref[2*irefmir+1] + <a class="code" href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">Vtrans</a>[itrans](1));</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;                        ix = <a class="code" href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a>(ix, Moffsets.startingX(), Moffsets.finishingX());</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                        iy = <a class="code" href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a>(iy, Moffsets.startingY(), Moffsets.finishingY());</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;                        <span class="keywordflow">if</span> (iflip &lt; <a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>)</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;                            point_trans = <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Moffsets, iy, ix);</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                            point_trans = <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Moffsets_mirror, iy, ix);</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;                        weight = <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(Mweight, itrans, refno, irot);</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                        <span class="keywordflow">if</span> (weight &gt; <a class="code" href="ml2d_8h.html#a12d43bb17e6532367f74d92c2f08ef73">SIGNIFICANT_WEIGHT_LOW</a>*maxweight)</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;                        {</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                            weight /= sum_refw;</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;                            <span class="comment">// get the starting point in the Fimg_trans vector</span></div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;                            img_start = point_trans*4*dnr_points_2d + (iflip%<a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>)*dnr_points_2d;</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;                            <a class="code" href="classProgMLF2D.html#ae311e353866c6ac035c8f795ee2e1a6b">wsum_sigma_offset</a> += weight * (double)(ix * ix + iy * iy);</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">do_ctf_correction</a>)</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;                            {</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ii = 0; ii &lt; <a class="code" href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">nr_points_2d</a>; ii++)</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;                                {</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;                                    <a class="code" href="classProgMLF2D.html#a0b8e2ceb24d15d08f35c4549b1bef95a">Fwsum_imgs</a>[wsum_start + 2*ii] += weight</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;                                                                     * opt_scale * decctf[ii] * Fimg_trans[img_start + 2*ii];</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;                                    <a class="code" href="classProgMLF2D.html#a0b8e2ceb24d15d08f35c4549b1bef95a">Fwsum_imgs</a>[wsum_start + 2*ii+1] += weight</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;                                                                       * opt_scale * decctf[ii] * Fimg_trans[img_start + 2*ii+1];</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;                                    <a class="code" href="classProgMLF2D.html#aff2c6db0108d1ef849c88221a1506ef8">Fwsum_ctfimgs</a>[wsum_start + 2*ii] += weight</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;                                                                        * opt_scale * Fimg_trans[img_start + 2*ii];</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;                                    <a class="code" href="classProgMLF2D.html#aff2c6db0108d1ef849c88221a1506ef8">Fwsum_ctfimgs</a>[wsum_start + 2*ii+1] += weight</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;                                                                          * opt_scale * Fimg_trans[img_start + 2*ii+1];</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;                                    tmpr = Fimg_trans[img_start + 2*ii]</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                                           - ctf[ii] * opt_scale * <a class="code" href="classProgMLF2D.html#a3e59aa87465a609828f311a1b40f0ea9">Fref</a>[wsum_start + 2*ii];</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;                                    tmpi = Fimg_trans[img_start + 2*ii+1]</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;                                           - ctf[ii] * opt_scale * Fref[wsum_start + 2*ii+1];</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;                                    Mwsum_sigma2_local[ii] += weight * (tmpr * tmpr + tmpi * tmpi);</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;                                }</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;                            }</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;                            <span class="keywordflow">else</span></div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                            {</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ii = 0; ii &lt; <a class="code" href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">nr_points_2d</a>; ii++)</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                                {</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                                    <a class="code" href="classProgMLF2D.html#a0b8e2ceb24d15d08f35c4549b1bef95a">Fwsum_imgs</a>[wsum_start + 2*ii] += weight</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                                                                     * opt_scale * Fimg_trans[img_start + 2*ii];</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;                                    <a class="code" href="classProgMLF2D.html#a0b8e2ceb24d15d08f35c4549b1bef95a">Fwsum_imgs</a>[wsum_start + 2*ii+1] += weight</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;                                                                       * opt_scale * Fimg_trans[img_start + 2*ii+1];</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;                                    tmpr = Fimg_trans[img_start + 2*ii]</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;                                           - opt_scale * <a class="code" href="classProgMLF2D.html#a3e59aa87465a609828f311a1b40f0ea9">Fref</a>[wsum_start + 2*ii];</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;                                    tmpi = Fimg_trans[img_start + 2*ii+1]</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;                                           - opt_scale * Fref[wsum_start + 2*ii+1];</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;                                    Mwsum_sigma2_local[ii] += weight * (tmpr * tmpr + tmpi * tmpi);</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                                }</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                            }</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;                        }<span class="comment">// if weight &gt; SIGNIFICANT_WEIGHT_LOW*maxweight</span></div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;                    }<span class="comment">//forall translation</span></div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;                }<span class="comment">//forall rotation</span></div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;            }<span class="comment">//forall flips</span></div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        }</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    }<span class="comment">//forall models</span></div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    <span class="comment">// Update the optimal origin offsets</span></div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    nr_mir = (<a class="code" href="classML2DBaseProgram.html#ad9b9535e1774d805e5bbee89dee0f4b5">do_mirror</a>) ? 2 : 1;</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    <a class="code" href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a>()</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;    {</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classML2DBaseProgram.html#a549ca4cda193eb449087f9a316c61f20">limit_rot</a> || pdf_directions[refno] &gt; 0.)</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;        {</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> imir = 0; imir &lt; nr_mir; imir++)</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;            {</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;                irefmir = imir * <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a> + refno;</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;                iflip_start = imir * <a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>;</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                iflip_stop = imir * nr_nomirror_flips + <a class="code" href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">nr_nomirror_flips</a>;</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;                opt_itrans = <a class="code" href="classProgMLF2D.html#adec8e47d0ada48f2aea2259ca1b400cf">zero_trans</a>;</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iflip = iflip_start; iflip &lt; iflip_stop; iflip++)</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;                {</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                    <a class="code" href="group__MLFalign2D.html#gae1d499e9328ad87a22b0cafeae0f1f01">FOR_ALL_ROTATIONS</a>()</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                    {</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                        irot = iflip * nr_psi + ipsi;</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;                        <a class="code" href="group__MLFalign2D.html#gacd0a39abfcd60d9c68ca9b3756a8ebc2">FOR_ALL_LIMITED_TRANSLATIONS</a>()</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;                        {</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;                            weight = <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(Mweight, itrans, refno, irot);</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;                            <span class="keywordflow">if</span> (weight &gt; Pmax_refmir[irefmir])</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;                            {</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                                Pmax_refmir[irefmir] = weight;</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;                                opt_itrans = itrans;</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;                            }</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;                        }</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;                    }</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;                }</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;                opt_offsets_ref[2*irefmir] += <a class="code" href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">Vtrans</a>[opt_itrans](0);</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;                opt_offsets_ref[2*irefmir+1] += <a class="code" href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">Vtrans</a>[opt_itrans](1);</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;            }</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;        }</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    }</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    <span class="comment">// Distribution widths</span></div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    fracweight = maxweight / sum_refw;</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    sum_refw2 /= sum_refw;</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    <span class="comment">// Compute Log Likelihood</span></div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a>)</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;        <span class="comment">// 1st term: log(refw_i)</span></div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;        <span class="comment">// 2nd term: for subtracting mindiff2</span></div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;        <span class="comment">// 3rd term: for missing normalization constant</span></div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;        <a class="code" href="classProgMLF2D.html#a62bd5315721add5edf8b74e19c7d2de8">LL</a> += <a class="code" href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a>(sum_refw)</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;              - mindiff2</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;              - logsigma2;</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;        <span class="comment">// 1st term: log(refw_i)</span></div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;        <span class="comment">// 2nd term: for dividing by (1 + mindiff2/df)^df2</span></div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;        <span class="comment">// 3rd term: for sigma-dependent normalization term in t-student distribution</span></div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;        <span class="comment">// 4th&amp;5th terms: gamma functions in t-distribution</span></div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;        <span class="comment">//LL += log(sum_refw) - log(1. + ( mindiff2 / df )) - log(sigma_noise * sigma_noise);</span></div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;        <a class="code" href="classProgMLF2D.html#a62bd5315721add5edf8b74e19c7d2de8">LL</a> += <a class="code" href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a>(sum_refw)</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;              + <a class="code" href="classML2DBaseProgram.html#a3106e12c5756e90d770df3708307258d">df2</a> * <a class="code" href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a>( 1. + ( mindiff2 / <a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a> ))</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;              - logsigma2</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;              + <a class="code" href="numerical__recipes_8cpp.html#ae01374ddda83bc2216ba9df9c76d9995">gammln</a>(-<a class="code" href="classML2DBaseProgram.html#a3106e12c5756e90d770df3708307258d">df2</a>) - <a class="code" href="numerical__recipes_8cpp.html#ae01374ddda83bc2216ba9df9c76d9995">gammln</a>(<a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a>/2.);</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;    <span class="comment">//    if (rank == 0)</span></div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    <span class="comment">//    {</span></div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    <span class="comment">//      std::cerr &lt;&lt; &quot;DEBUG_JM: current_image : &quot; &lt;&lt; current_image</span></div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    <span class="comment">//          &lt;&lt; &quot; sum_refw: &quot; &lt;&lt; sum_refw</span></div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    <span class="comment">//         &lt;&lt; &quot; LL: &quot; &lt;&lt; LL &lt;&lt; std::endl;</span></div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    <span class="comment">//    }</span></div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    <span class="keyword">delete</span> []sigma2;</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;    <span class="keyword">delete</span> []inv_sigma2;</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;    <span class="keyword">delete</span> []ctf;</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;    <span class="keyword">delete</span> []decctf;</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;}</div><div class="ttc" id="group__GeneralFunctions_html_ga5a4604cb3736cd6b9e4a577f7b0c68f3"><div class="ttname"><a href="group__GeneralFunctions.html#ga5a4604cb3736cd6b9e4a577f7b0c68f3">cdf_gauss</a></div><div class="ttdeci">double cdf_gauss(double x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00232">xmipp_funcs.cpp:232</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a976dc404489a0c66af2800f0f73e76c7"><div class="ttname"><a href="classML2DBaseProgram.html#a976dc404489a0c66af2800f0f73e76c7">ML2DBaseProgram::nr_psi</a></div><div class="ttdeci">size_t nr_psi</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00154">ml2d.h:154</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a8402eab40b0e66cd7aee78b747720af9"><div class="ttname"><a href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">ProgMLF2D::do_student</a></div><div class="ttdeci">bool do_student</div><div class="ttdoc">IN DEVELOPMENT. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00135">mlf_align2d.h:135</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a0b8e2ceb24d15d08f35c4549b1bef95a"><div class="ttname"><a href="classProgMLF2D.html#a0b8e2ceb24d15d08f35c4549b1bef95a">ProgMLF2D::Fwsum_imgs</a></div><div class="ttdeci">std::vector&lt; double &gt; Fwsum_imgs</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00157">mlf_align2d.h:157</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa640217ae2418fe91401329baab687564"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa640217ae2418fe91401329baab687564">ERR_INDEX_OUTOFBOUNDS</a></div><div class="ttdoc">Index out of bounds. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00137">xmipp_error.h:137</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ad2a82e39d73ee5d2911c6c9a95b9b54c"><div class="ttname"><a href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">ML2DBaseProgram::Vtrans</a></div><div class="ttdeci">std::vector&lt; Matrix1D&lt; double &gt; &gt; Vtrans</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00184">ml2d.h:184</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ae311e353866c6ac035c8f795ee2e1a6b"><div class="ttname"><a href="classProgMLF2D.html#ae311e353866c6ac035c8f795ee2e1a6b">ProgMLF2D::wsum_sigma_offset</a></div><div class="ttdeci">double wsum_sigma_offset</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00153">mlf_align2d.h:153</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gad6c8256d157712ecc71b18f4d3335f56"><div class="ttname"><a href="group__MLFalign2D.html#gad6c8256d157712ecc71b18f4d3335f56">FOR_ALL_POINTS</a></div><div class="ttdeci">#define FOR_ALL_POINTS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00042">mlf_align2d.h:42</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00364">multidim_array.h:364</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a715ad0eb7ac0ce476faf1623fedea1a8"><div class="ttname"><a href="classML2DBaseProgram.html#a715ad0eb7ac0ce476faf1623fedea1a8">ML2DBaseProgram::nr_flip</a></div><div class="ttdeci">size_t nr_flip</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00156">ml2d.h:156</a></div></div>
<div class="ttc" id="cuda__basic__math_8h_html_a2065eb145275f878c1d045c9f3fb1cc7"><div class="ttname"><a href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a></div><div class="ttdeci">__host__ __device__ float2 floor(const float2 v)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__basic__math_8h_source.html#l00175">cuda_basic_math.h:175</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga97809f7244a28aaa1c26e29e6e3204ef"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a></div><div class="ttdeci">#define A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00549">multidim_array.h:549</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a539e20a02b977a36314ddec48e8033a5"><div class="ttname"><a href="numerical__recipes_8cpp.html#a539e20a02b977a36314ddec48e8033a5">ksone</a></div><div class="ttdeci">void ksone(double data[], int n, double(*func)(double), double *d, double *prob)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l00163">numerical_recipes.cpp:163</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gac87b223f03097d45f776b44b6aeea9f7"><div class="ttname"><a href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a></div><div class="ttdeci">#define MULTIDIM_ARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00136">multidim_array.h:136</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a5578230b3fb9e054c437e187cb0ad5d3"><div class="ttname"><a href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">ML2DBaseProgram::model</a></div><div class="ttdeci">ModelML2D model</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00224">ml2d.h:224</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a78ef99a6261c8c228ca1bab9f0c2205a"><div class="ttname"><a href="classProgMLF2D.html#a78ef99a6261c8c228ca1bab9f0c2205a">ProgMLF2D::Mresol_int</a></div><div class="ttdeci">MultidimArray&lt; size_t &gt; Mresol_int</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00108">mlf_align2d.h:108</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a62bd5315721add5edf8b74e19c7d2de8"><div class="ttname"><a href="classProgMLF2D.html#a62bd5315721add5edf8b74e19c7d2de8">ProgMLF2D::LL</a></div><div class="ttdeci">double LL</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00153">mlf_align2d.h:153</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a1f05f45301557f3c0a855a414b87b5fd"><div class="ttname"><a href="classProgMLF2D.html#a1f05f45301557f3c0a855a414b87b5fd">ProgMLF2D::nr_trans</a></div><div class="ttdeci">size_t nr_trans</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00089">mlf_align2d.h:89</a></div></div>
<div class="ttc" id="classHistogram1D_html"><div class="ttname"><a href="classHistogram1D.html">Histogram1D</a></div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00121">histogram.h:121</a></div></div>
<div class="ttc" id="classModelML2D_html_a63a3a3534d1cb72a9db046508b9a59f6"><div class="ttname"><a href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">ModelML2D::n_ref</a></div><div class="ttdeci">int n_ref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00083">ml2d.h:83</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_aae259850c9b209a3ff3cbcc7799e2742"><div class="ttname"><a href="classML2DBaseProgram.html#aae259850c9b209a3ff3cbcc7799e2742">ML2DBaseProgram::psi_step</a></div><div class="ttdeci">double psi_step</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00158">ml2d.h:158</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gafd91bd40ff4b515cade0323c37f21ac5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a></div><div class="ttdeci">#define dAkij(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00254">multidim_array.h:254</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a26c5a01345ef85eaabf6056c0f76f848"><div class="ttname"><a href="classProgMLF2D.html#a26c5a01345ef85eaabf6056c0f76f848">ProgMLF2D::pointer_2d</a></div><div class="ttdeci">std::vector&lt; int &gt; pointer_2d</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00126">mlf_align2d.h:126</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaa924a84ae5fbf0ba6b4052eb9d92ef60"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00564">multidim_array.h:564</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a90e6ce499655b4566e17e32102a905c4"><div class="ttname"><a href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">ML2DBaseProgram::hdim</a></div><div class="ttdeci">size_t hdim</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00151">ml2d.h:151</a></div></div>
<div class="ttc" id="ml2d_8h_html_a6b49ded9ade4e2a8b65b16670db60486"><div class="ttname"><a href="ml2d_8h.html#a6b49ded9ade4e2a8b65b16670db60486">SMALLANGLE</a></div><div class="ttdeci">#define SMALLANGLE</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00049">ml2d.h:49</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00068">xmipp_filename.h:68</a></div></div>
<div class="ttc" id="classHistogram1D_html_a5b24f78917ecda9d47e420b3a6c4cbd7"><div class="ttname"><a href="classHistogram1D.html#a5b24f78917ecda9d47e420b3a6c4cbd7">Histogram1D::index2val</a></div><div class="ttdeci">void index2val(double i, double &amp;v) const </div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00295">histogram.h:295</a></div></div>
<div class="ttc" id="classHistogram1D_html_ac40dd6aedb6ee53598b7bcc05ab27db5"><div class="ttname"><a href="classHistogram1D.html#ac40dd6aedb6ee53598b7bcc05ab27db5">Histogram1D::init</a></div><div class="ttdeci">void init(double min_val, double max_val, int n_steps)</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00069">histogram.cpp:69</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ab34721b1edbfbb6b3feb83c1aa825166"><div class="ttname"><a href="classProgMLF2D.html#ab34721b1edbfbb6b3feb83c1aa825166">ProgMLF2D::sumwsc2</a></div><div class="ttdeci">std::vector&lt; double &gt; sumwsc2</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00156">mlf_align2d.h:156</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gacd0a39abfcd60d9c68ca9b3756a8ebc2"><div class="ttname"><a href="group__MLFalign2D.html#gacd0a39abfcd60d9c68ca9b3756a8ebc2">FOR_ALL_LIMITED_TRANSLATIONS</a></div><div class="ttdeci">#define FOR_ALL_LIMITED_TRANSLATIONS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00039">mlf_align2d.h:39</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a9e143fabdc67d1ee8cd67dcad98e74fc"><div class="ttname"><a href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">ML2DBaseProgram::do_norm</a></div><div class="ttdeci">bool do_norm</div><div class="ttdoc">Re-normalize internally. </div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00207">ml2d.h:207</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_ga7ba3f876baf2feea5984660892eeeb8a"><div class="ttname"><a href="group__MLFalign2D.html#ga7ba3f876baf2feea5984660892eeeb8a">VDEC_ITEM</a></div><div class="ttdeci">#define VDEC_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00048">mlf_align2d.h:48</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a2fd51100d35db6ecdcb3ac704ab58435"><div class="ttname"><a href="classProgMLF2D.html#a2fd51100d35db6ecdcb3ac704ab58435">ProgMLF2D::refs_avgscale</a></div><div class="ttdeci">std::vector&lt; double &gt; refs_avgscale</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00148">mlf_align2d.h:148</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a549ca4cda193eb449087f9a316c61f20"><div class="ttname"><a href="classML2DBaseProgram.html#a549ca4cda193eb449087f9a316c61f20">ML2DBaseProgram::limit_rot</a></div><div class="ttdeci">bool limit_rot</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00188">ml2d.h:188</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_a0994f8f1ab050711112683b89fb90b0b"><div class="ttname"><a href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a></div><div class="ttdeci">void log(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00225">image_operate.cpp:225</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_ga2dfb9d47a060372ac150f68c9ff4cc09"><div class="ttname"><a href="group__MLFalign2D.html#ga2dfb9d47a060372ac150f68c9ff4cc09">HISTSTEPS</a></div><div class="ttdeci">#define HISTSTEPS</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00055">mlf_align2d.h:55</a></div></div>
<div class="ttc" id="group__Histograms_html_gaaa3501212e9e03d46c6e7aba56dd6c21"><div class="ttname"><a href="group__Histograms.html#gaaa3501212e9e03d46c6e7aba56dd6c21">compute_hist</a></div><div class="ttdeci">void compute_hist(const MultidimArrayGeneric &amp;array, Histogram1D &amp;hist, int no_steps)</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00570">histogram.cpp:570</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a79873ba6ac0a02ebff149285475a8721"><div class="ttname"><a href="classProgMLF2D.html#a79873ba6ac0a02ebff149285475a8721">ProgMLF2D::do_kstest</a></div><div class="ttdeci">bool do_kstest</div><div class="ttdoc">Statistical analysis of the noise distributions. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00141">mlf_align2d.h:141</a></div></div>
<div class="ttc" id="mlf__align2d_8cpp_html_aa9caeb01ffd59d5630c89d38c519e70e"><div class="ttname"><a href="mlf__align2d_8cpp.html#aa9caeb01ffd59d5630c89d38c519e70e">lcdf_tstudent_mlf6</a></div><div class="ttdeci">double lcdf_tstudent_mlf6(double t)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l01569">mlf_align2d.cpp:1569</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a2839dd97c6d6098e665b16bed661b615"><div class="ttname"><a href="classProgMLF2D.html#a2839dd97c6d6098e665b16bed661b615">ProgMLF2D::dnr_points_2d</a></div><div class="ttdeci">size_t dnr_points_2d</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00127">mlf_align2d.h:127</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_ga20bc753097a030d2c2650ca5120deeab"><div class="ttname"><a href="group__MLFalign2D.html#ga20bc753097a030d2c2650ca5120deeab">FOR_ALL_FLIPS</a></div><div class="ttdeci">#define FOR_ALL_FLIPS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00038">mlf_align2d.h:38</a></div></div>
<div class="ttc" id="mlf__align2d_8cpp_html_a276d2af179c768b68c2a53270783d58a"><div class="ttname"><a href="mlf__align2d_8cpp.html#a276d2af179c768b68c2a53270783d58a">lcdf_tstudent_mlf1</a></div><div class="ttdeci">double lcdf_tstudent_mlf1(double t)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l01561">mlf_align2d.cpp:1561</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gae1d499e9328ad87a22b0cafeae0f1f01"><div class="ttname"><a href="group__MLFalign2D.html#gae1d499e9328ad87a22b0cafeae0f1f01">FOR_ALL_ROTATIONS</a></div><div class="ttdeci">#define FOR_ALL_ROTATIONS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00037">mlf_align2d.h:37</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a8671946de2e241de54a47e2822989ca1"><div class="ttname"><a href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">ML2DBaseProgram::df</a></div><div class="ttdeci">double df</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00204">ml2d.h:204</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a0cf09cc5d8c9949acc48438be868773c"><div class="ttname"><a href="classProgMLF2D.html#a0cf09cc5d8c9949acc48438be868773c">ProgMLF2D::alpha_k</a></div><div class="ttdeci">std::vector&lt; double &gt; alpha_k</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00077">mlf_align2d.h:77</a></div></div>
<div class="ttc" id="classMultidimArray_html_a2917347534008460dd52e90049e4257f"><div class="ttname"><a href="classMultidimArray.html#a2917347534008460dd52e90049e4257f">MultidimArray::sum</a></div><div class="ttdeci">double sum() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05095">multidim_array.h:5095</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca6408d1d58d2334ecf5b80c3a9a8881"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca6408d1d58d2334ecf5b80c3a9a8881">for</a></div><div class="ttdeci">for(j=1;j&lt;=i__1;++j)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02327">numerical_recipes.cpp:2327</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a7c3f7c47054265ad3589ee6d40764fbc"><div class="ttname"><a href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">ProgMLF2D::do_ctf_correction</a></div><div class="ttdeci">bool do_ctf_correction</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00100">mlf_align2d.h:100</a></div></div>
<div class="ttc" id="mlf__align2d_8cpp_html_abfbf7b3eddce4b077e5488ed0387c00a"><div class="ttname"><a href="mlf__align2d_8cpp.html#abfbf7b3eddce4b077e5488ed0387c00a">lcdf_tstudent_mlf3</a></div><div class="ttdeci">double lcdf_tstudent_mlf3(double t)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l01565">mlf_align2d.cpp:1565</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a86d435aa562ed8f627734219a54f9fbc"><div class="ttname"><a href="classProgMLF2D.html#a86d435aa562ed8f627734219a54f9fbc">ProgMLF2D::calculateFourierOffsets</a></div><div class="ttdeci">void calculateFourierOffsets(const MultidimArray&lt; double &gt; &amp;Mimg, const std::vector&lt; double &gt; &amp;offsets, std::vector&lt; double &gt; &amp;out, MultidimArray&lt; int &gt; &amp;Moffsets, MultidimArray&lt; int &gt; &amp;Moffsets_mirror)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l01475">mlf_align2d.cpp:1475</a></div></div>
<div class="ttc" id="classProgMLF2D_html_aff8593015f02560e8e3e85ebd86ba894"><div class="ttname"><a href="classProgMLF2D.html#aff8593015f02560e8e3e85ebd86ba894">ProgMLF2D::resolhist</a></div><div class="ttdeci">std::vector&lt; Histogram1D &gt; resolhist</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00146">mlf_align2d.h:146</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga9483aca229770e20a5b7fb1df4aee6a1"><div class="ttname"><a href="group__GeneralFunctions.html#ga9483aca229770e20a5b7fb1df4aee6a1">tstudent1D</a></div><div class="ttdeci">double tstudent1D(double x, double df, double sigma, double mu)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00179">xmipp_funcs.cpp:179</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a619e2aed7d1934de3ce40d04b4d160b3"><div class="ttname"><a href="classProgMLF2D.html#a619e2aed7d1934de3ce40d04b4d160b3">ProgMLF2D::mirror_fraction</a></div><div class="ttdeci">std::vector&lt; double &gt; mirror_fraction</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00079">mlf_align2d.h:79</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga53e37122134100316031eae982abee03"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a></div><div class="ttdeci">#define dAi(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00540">multidim_array.h:540</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a92faef343a74868a005e5de666778470"><div class="ttname"><a href="classProgMLF2D.html#a92faef343a74868a005e5de666778470">ProgMLF2D::sumwsc</a></div><div class="ttdeci">std::vector&lt; double &gt; sumwsc</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00156">mlf_align2d.h:156</a></div></div>
<div class="ttc" id="classXmippProgram_html_a0130b89f1f5431b03ef161d7e231bd48"><div class="ttname"><a href="classXmippProgram.html#a0130b89f1f5431b03ef161d7e231bd48">XmippProgram::debug</a></div><div class="ttdeci">int debug</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8h_source.html#l00170">xmipp_program.h:170</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a3106e12c5756e90d770df3708307258d"><div class="ttname"><a href="classML2DBaseProgram.html#a3106e12c5756e90d770df3708307258d">ML2DBaseProgram::df2</a></div><div class="ttdeci">double df2</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00204">ml2d.h:204</a></div></div>
<div class="ttc" id="mlf__align2d_8cpp_html_aa5b0c57accec2f3b8de9df2adfa4e52d"><div class="ttname"><a href="mlf__align2d_8cpp.html#aa5b0c57accec2f3b8de9df2adfa4e52d">lcdf_tstudent_mlf9</a></div><div class="ttdeci">double lcdf_tstudent_mlf9(double t)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l01573">mlf_align2d.cpp:1573</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aabda7431146b956debfa7f89164af1790"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aabda7431146b956debfa7f89164af1790">ERR_IO_NOTOPEN</a></div><div class="ttdoc">File cannot be open. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00142">xmipp_error.h:142</a></div></div>
<div class="ttc" id="classHistogram1D_html_a493d78efd9e4967222aad25dab31447c"><div class="ttname"><a href="classHistogram1D.html#a493d78efd9e4967222aad25dab31447c">Histogram1D::sampleNo</a></div><div class="ttdeci">double sampleNo() const </div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00350">histogram.h:350</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a0a90a0680ddfe59efa8bac1303fada63"><div class="ttname"><a href="classProgMLF2D.html#a0a90a0680ddfe59efa8bac1303fada63">ProgMLF2D::sumw</a></div><div class="ttdeci">std::vector&lt; double &gt; sumw</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00156">mlf_align2d.h:156</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a3e59aa87465a609828f311a1b40f0ea9"><div class="ttname"><a href="classProgMLF2D.html#a3e59aa87465a609828f311a1b40f0ea9">ProgMLF2D::Fref</a></div><div class="ttdeci">std::vector&lt; double &gt; Fref</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00157">mlf_align2d.h:157</a></div></div>
<div class="ttc" id="namespacealglib_html_a43452b10ffe26174e5d328a6ceb5fa9a"><div class="ttname"><a href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">alglib::round</a></div><div class="ttdeci">int round(double x)</div><div class="ttdef"><b>Definition:</b> <a href="ap_8cpp_source.html#l07245">ap.cpp:7245</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a86adb43015401e250b579f9d49f00730"><div class="ttname"><a href="classProgMLF2D.html#a86adb43015401e250b579f9d49f00730">ProgMLF2D::sumw_mirror</a></div><div class="ttdeci">std::vector&lt; double &gt; sumw_mirror</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00156">mlf_align2d.h:156</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a07e1e912286ab9303da3d4a654d26dd6"><div class="ttname"><a href="classProgMLF2D.html#a07e1e912286ab9303da3d4a654d26dd6">ProgMLF2D::sumw2</a></div><div class="ttdeci">std::vector&lt; double &gt; sumw2</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00156">mlf_align2d.h:156</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a67faef1c7bbe1544c7f51e4d4fa0e833"><div class="ttname"><a href="classML2DBaseProgram.html#a67faef1c7bbe1544c7f51e4d4fa0e833">ML2DBaseProgram::C_fast</a></div><div class="ttdeci">double C_fast</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00182">ml2d.h:182</a></div></div>
<div class="ttc" id="classProgMLF2D_html_aff2c6db0108d1ef849c88221a1506ef8"><div class="ttname"><a href="classProgMLF2D.html#aff2c6db0108d1ef849c88221a1506ef8">ProgMLF2D::Fwsum_ctfimgs</a></div><div class="ttdeci">std::vector&lt; double &gt; Fwsum_ctfimgs</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00157">mlf_align2d.h:157</a></div></div>
<div class="ttc" id="xmipp__strings_8h_html_afbeda3fd1bdc8c37d01bdf9f5c8274ff"><div class="ttname"><a href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a></div><div class="ttdeci">std::string String</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__strings_8h_source.html#l00034">xmipp_strings.h:34</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gab2b66f57ef06321905e6675d295b3172"><div class="ttname"><a href="group__MLFalign2D.html#gab2b66f57ef06321905e6675d295b3172">HISTMAX</a></div><div class="ttdeci">#define HISTMAX</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00054">mlf_align2d.h:54</a></div></div>
<div class="ttc" id="classProgMLF2D_html_af78a059d07b955ccd42e8a17ef827d19"><div class="ttname"><a href="classProgMLF2D.html#af78a059d07b955ccd42e8a17ef827d19">ProgMLF2D::Mwsum_sigma2</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; Mwsum_sigma2</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00155">mlf_align2d.h:155</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gae2592474564ce2c4143fab306b777807"><div class="ttname"><a href="group__MLFalign2D.html#gae2592474564ce2c4143fab306b777807">VCTF_ITEM</a></div><div class="ttdeci">#define VCTF_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00047">mlf_align2d.h:47</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a6f44905656bc9d5a5bb57dea399cd18e"><div class="ttname"><a href="classML2DBaseProgram.html#a6f44905656bc9d5a5bb57dea399cd18e">ML2DBaseProgram::P_phi</a></div><div class="ttdeci">MultidimArray&lt; double &gt; P_phi</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00178">ml2d.h:178</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ad9b9535e1774d805e5bbee89dee0f4b5"><div class="ttname"><a href="classML2DBaseProgram.html#ad9b9535e1774d805e5bbee89dee0f4b5">ML2DBaseProgram::do_mirror</a></div><div class="ttdeci">bool do_mirror</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00137">ml2d.h:137</a></div></div>
<div class="ttc" id="mlf__align2d_8cpp_html_a4d5d05f55593a53915fb65e07840756e"><div class="ttname"><a href="mlf__align2d_8cpp.html#a4d5d05f55593a53915fb65e07840756e">lcdf_tstudent_mlf30</a></div><div class="ttdeci">double lcdf_tstudent_mlf30(double t)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l01577">mlf_align2d.cpp:1577</a></div></div>
<div class="ttc" id="classHistogram1D_html_a1f33208fed8e9026279a5002176107f3"><div class="ttname"><a href="classHistogram1D.html#a1f33208fed8e9026279a5002176107f3">Histogram1D::step_size</a></div><div class="ttdeci">double step_size</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00127">histogram.h:127</a></div></div>
<div class="ttc" id="ml2d_8h_html_a12d43bb17e6532367f74d92c2f08ef73"><div class="ttname"><a href="ml2d_8h.html#a12d43bb17e6532367f74d92c2f08ef73">SIGNIFICANT_WEIGHT_LOW</a></div><div class="ttdeci">#define SIGNIFICANT_WEIGHT_LOW</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00048">ml2d.h:48</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_ga998b4df4b03424508c129e4fad74b36f"><div class="ttname"><a href="group__MLFalign2D.html#ga998b4df4b03424508c129e4fad74b36f">HISTMIN</a></div><div class="ttdeci">#define HISTMIN</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00053">mlf_align2d.h:53</a></div></div>
<div class="ttc" id="classProgMLF2D_html_adec8e47d0ada48f2aea2259ca1b400cf"><div class="ttname"><a href="classProgMLF2D.html#adec8e47d0ada48f2aea2259ca1b400cf">ProgMLF2D::zero_trans</a></div><div class="ttdeci">size_t zero_trans</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00091">mlf_align2d.h:91</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a997e2be4af206a96283a2f73cfacdcfe"><div class="ttname"><a href="classML2DBaseProgram.html#a997e2be4af206a96283a2f73cfacdcfe">ML2DBaseProgram::dim2</a></div><div class="ttdeci">size_t dim2</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00151">ml2d.h:151</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_abe104a9ef312f6d857b008188e5dfbea"><div class="ttname"><a href="classML2DBaseProgram.html#abe104a9ef312f6d857b008188e5dfbea">ML2DBaseProgram::nr_nomirror_flips</a></div><div class="ttdeci">size_t nr_nomirror_flips</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00162">ml2d.h:162</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a4876f30a8c1b41ead612a89de1f3eed0"><div class="ttname"><a href="classProgMLF2D.html#a4876f30a8c1b41ead612a89de1f3eed0">ProgMLF2D::sumhist</a></div><div class="ttdeci">Histogram1D sumhist</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00145">mlf_align2d.h:145</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a></div><div class="ttdoc">Incorrect value received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00200">xmipp_error.h:200</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gaea9964961fe272b8b7277239202912cb"><div class="ttname"><a href="group__MLFalign2D.html#gaea9964961fe272b8b7277239202912cb">VSIG_ITEM</a></div><div class="ttdeci">#define VSIG_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00049">mlf_align2d.h:49</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a963f62304538d74f796a3d20475480ee"><div class="ttname"><a href="classProgMLF2D.html#a963f62304538d74f796a3d20475480ee">ProgMLF2D::nr_points_prob</a></div><div class="ttdeci">size_t nr_points_prob</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00127">mlf_align2d.h:127</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="group__Macros_html_ga10de40044d2903ec0d4e7e57c31322aa"><div class="ttname"><a href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a></div><div class="ttdeci">#define intWRAP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00272">xmipp_macros.h:272</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae01374ddda83bc2216ba9df9c76d9995"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae01374ddda83bc2216ba9df9c76d9995">gammln</a></div><div class="ttdeci">double gammln(double xx)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l00587">numerical_recipes.cpp:587</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gadcb82c3ff44ffd9c34b67c3ca943613d"><div class="ttname"><a href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a></div><div class="ttdeci">#define FOR_ALL_MODELS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00036">mlf_align2d.h:36</a></div></div>
<div class="ttc" id="classProgMLF2D_html_af7f2b4639397c6f14e13371207476c06"><div class="ttname"><a href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">ProgMLF2D::nr_points_2d</a></div><div class="ttdeci">size_t nr_points_2d</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00127">mlf_align2d.h:127</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga15ac71366a2fcd18ab5769593246a2ed"><div class="ttname"><a href="group__GeneralFunctions.html#ga15ac71366a2fcd18ab5769593246a2ed">gaussian1D</a></div><div class="ttdeci">double gaussian1D(double x, double sigma, double mu)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00172">xmipp_funcs.cpp:172</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5e0a9b2281fc0e33fc0af350514c893b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::produceSideInfo </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Setup lots of stuff. </p>

<p>Implements <a class="el" href="classML2DBaseProgram.html#a7aa3789c400c60cb72fdcf42d96373d0">ML2DBaseProgram</a>.</p>

<p>Reimplemented in <a class="el" href="classMpiProgMLF2D.html#adab3ae627fd2be91e8c424a7def92896">MpiProgMLF2D</a>.</p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l00296">296</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;{</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">//LOG_LEVEL(produceSideInfo);</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="xmipp__log_8h.html#a9d0e78c69b9733e4419a5f65d5a38a3a">LOG_FUNCTION</a>();</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="classFileName.html">FileName</a>                    fn_tmp, fn_base, fn_tmp2;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="classImage.html">Image&lt;double&gt;</a>              img;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="classCTFDescription.html">CTFDescription</a>                    ctf;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a>           dum, rmean_ctf;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a>           A(3, 3);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a>           offsets(2);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a>      Maux, Maux2;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;std::complex&lt;double&gt;</a> &gt;  Faux, ctfmask; <span class="comment">//2D</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;int&gt;</a>        radial_count; <span class="comment">//1D</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a>               center(2);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    std::vector&lt;int&gt;            tmppointp, tmppointp_nolow, tmppointi, tmppointj;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordtype">double</span>                      Q0=0.;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">// Read selfile with experimental images</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#ab7f8d43d77647ade923e6cd63eafdd03">read</a>(<a class="code" href="classML2DBaseProgram.html#a4e593a9112ddcc0256bc9b72213cdb3b">fn_img</a>);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#a55651d0806335c55622838d62b8068b5">removeDisabled</a>(); <span class="comment">// Discard disabled images</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a55332f697c74f72635ae850439407645">nr_images_global</a> = <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#ad844b6a5655be4205e4bb03ab6372562">size</a>();</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">// Create a vector of objectIDs, which may be randomized later on</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#a1a76384897857d639447524ff2f14ab3">findObjects</a>(<a class="code" href="classML2DBaseProgram.html#a3464cb9938eb4cf849b7c8bbb354734f">img_id</a>);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">// Get image sizes and total number of images</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="xmipp__funcs_8cpp.html#a6b2ac43eac850ac39594e8a5f5aa42fe">idum</a>, ndum;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="group__MetaDataExtension.html#gac0be4f4f5a50390ff4939b437170e700">getImageSize</a>(<a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>, <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>, idum, idum, ndum);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">hdim</a> = <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a> / 2;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a997e2be4af206a96283a2f73cfacdcfe">dim2</a> = <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a> * <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">// Set sampling stuff: flipping matrices, psi_step etc.</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a08dc75912c3b5bf4be88e88a81cf23fa">initSamplingStuff</a>();</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="classProgMLF2D.html#a373f1965ed767abbf1d5b3e53104623b">max_nr_psi</a> = <a class="code" href="classML2DBaseProgram.html#a976dc404489a0c66af2800f0f73e76c7">nr_psi</a>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">// Initialization of resolhist</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a79873ba6ac0a02ebff149285475a8721">do_kstest</a>)</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    {</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <a class="code" href="classProgMLF2D.html#aff8593015f02560e8e3e85ebd86ba894">resolhist</a>.resize(<a class="code" href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">hdim</a>);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ires = 0; ires &lt; <a class="code" href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">hdim</a>; ires++)</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <a class="code" href="classProgMLF2D.html#aff8593015f02560e8e3e85ebd86ba894">resolhist</a>[ires].init(<a class="code" href="group__MLFalign2D.html#ga998b4df4b03424508c129e4fad74b36f">HISTMIN</a>, <a class="code" href="group__MLFalign2D.html#gab2b66f57ef06321905e6675d295b3172">HISTMAX</a>, <a class="code" href="group__MLFalign2D.html#ga2dfb9d47a060372ac150f68c9ff4cc09">HISTSTEPS</a>);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    }</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">// Fill limited translation shift-vectors</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="classProgMLF2D.html#a1f05f45301557f3c0a855a414b87b5fd">nr_trans</a> = 0;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    Maux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(dim, dim);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    Maux.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordtype">int</span> ss = <a class="code" href="classProgMLF2D.html#a13f69696df08368a14b8928b60faaad7">search_shift</a> * <a class="code" href="classProgMLF2D.html#a13f69696df08368a14b8928b60faaad7">search_shift</a>;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(Maux)</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a> = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> * <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">if</span> (r2 &lt;= ss)</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        {</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(offsets) = (double)j;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(offsets) = (double)<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            <a class="code" href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">Vtrans</a>.push_back(offsets);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> == 0 &amp;&amp; j == 0)</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                <a class="code" href="classProgMLF2D.html#adec8e47d0ada48f2aea2259ca1b400cf">zero_trans</a> = <a class="code" href="classProgMLF2D.html#a1f05f45301557f3c0a855a414b87b5fd">nr_trans</a>;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <a class="code" href="classProgMLF2D.html#a1f05f45301557f3c0a855a414b87b5fd">nr_trans</a>++;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        }</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <a class="code" href="classFileName.html">FileName</a> fnt_img, fnt;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    std::vector&lt;FileName&gt; all_fn_ctfs;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="classProgMLF2D.html#a5c75192acc215ccf8e062881d14f9ac4">count_defocus</a>.clear();</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="classProgMLF2D.html#aeacca439f42dea963c5997d589f419a4">Vctf</a>.clear();</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <a class="code" href="classProgMLF2D.html#a83eda37039c3fc321091307e24dc60fa">Vdec</a>.clear();</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="classProgMLF2D.html#a5aad5b0a7bb75420f63794660d636454">Vsig</a>.clear();</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">do_ctf_correction</a>)</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <a class="code" href="classProgMLF2D.html#a7e08de076e12e519d59f5e39854f1dc5">nr_focus</a> = 1;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <a class="code" href="classProgMLF2D.html#a5c75192acc215ccf8e062881d14f9ac4">count_defocus</a>.push_back(<a class="code" href="classML2DBaseProgram.html#a55332f697c74f72635ae850439407645">nr_images_global</a>);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <a class="code" href="classProgMLF2D.html#aeacca439f42dea963c5997d589f419a4">Vctf</a>.push_back(dum);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <a class="code" href="classProgMLF2D.html#aeacca439f42dea963c5997d589f419a4">Vctf</a>[0].resize(hdim);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <a class="code" href="classProgMLF2D.html#aeacca439f42dea963c5997d589f419a4">Vctf</a>[0].initConstant(1.); <span class="comment">//fill with 1.</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <a class="code" href="classProgMLF2D.html#a83eda37039c3fc321091307e24dc60fa">Vdec</a>.push_back(<a class="code" href="classProgMLF2D.html#aeacca439f42dea963c5997d589f419a4">Vctf</a>[0]); <span class="comment">//just copy</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <a class="code" href="classProgMLF2D.html#a5aad5b0a7bb75420f63794660d636454">Vsig</a>.push_back(<a class="code" href="classProgMLF2D.html#aeacca439f42dea963c5997d589f419a4">Vctf</a>[0]);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    }</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    {</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="comment">// Read ctfdat and determine the number of CTF groups</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <a class="code" href="classProgMLF2D.html#a7e08de076e12e519d59f5e39854f1dc5">nr_focus</a> = 0;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        all_fn_ctfs.clear();</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <a class="code" href="classFileName.html">FileName</a> fn_ctf;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="comment">//CTF info now comes on input metadatas</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <a class="code" href="classMetaData.html">MetaData</a> mdCTF;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        std::vector&lt;MDLabel&gt; groupby;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <a class="code" href="ctf_8cpp.html#aca3073742a1cc4b86d0c59bd19352cae">groupCTFMetaData</a>(<a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>, mdCTF, groupby);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a> &gt; 0)</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;          <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#ab448a0c9242f0442d4a04e1fff948c7f">setValueCol</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a2c4443e4facc7cacc4da074ac10154e6">MDL_CTF_SAMPLING_RATE</a>, <a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a>);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;          mdCTF.<a class="code" href="classMetaData.html#ab448a0c9242f0442d4a04e1fff948c7f">setValueCol</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a2c4443e4facc7cacc4da074ac10154e6">MDL_CTF_SAMPLING_RATE</a>, <a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a>);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        }</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <a class="code" href="classProgMLF2D.html#a7e08de076e12e519d59f5e39854f1dc5">nr_focus</a> = mdCTF.<a class="code" href="classMetaData.html#ad844b6a5655be4205e4bb03ab6372562">size</a>();</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="comment">//todo: set defocus group for each image</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="comment">// Check the number of images in each CTF group</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="comment">// and read CTF-parameters from disc</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="comment">//FOR_ALL_DEFOCUS_GROUPS()</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordtype">int</span> ifocus = 0;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <a class="code" href="classProgMLF2D.html#a5c75192acc215ccf8e062881d14f9ac4">count_defocus</a>.resize(<a class="code" href="classProgMLF2D.html#a7e08de076e12e519d59f5e39854f1dc5">nr_focus</a>);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordtype">size_t</span> id;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> dum(hdim);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <a class="code" href="group__MetaData.html#ga85652b971edca3acc93a9f1bef2f17f6">FOR_ALL_OBJECTS_IN_METADATA</a>(mdCTF)</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        {</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            <span class="keywordtype">id</span> = __iter.objId;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            <span class="comment">//Set defocus group</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            mdCTF.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a7d9d585d218e22d9569dae329fb0c538">MDL_DEFGROUP</a>, ifocus, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <span class="comment">//Read number of images in group</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            mdCTF.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a1a2c16ef85a25a0117e3387cbfc0c89d">MDL_COUNT</a>, c, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <a class="code" href="classProgMLF2D.html#a5c75192acc215ccf8e062881d14f9ac4">count_defocus</a>[ifocus] = (int)c;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a5c75192acc215ccf8e062881d14f9ac4">count_defocus</a>[ifocus] &lt; 50 &amp;&amp; <a class="code" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a>)</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                std::cerr &lt;&lt; <span class="stringliteral">&quot;WARNING%% CTF group &quot;</span> &lt;&lt; (ifocus + 1) &lt;&lt; <span class="stringliteral">&quot; contains less than 50 images!&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <span class="comment">//Read ctf from disk</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            ctf.<a class="code" href="group__CTFSupport.html#ga78bd0bf278a605995f4360142dbf0043">readFromMetadataRow</a>(mdCTF, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="keywordtype">double</span> astigmCTFFactor = fabs( (ctf.<a class="code" href="group__CTFSupport.html#ga78c788d379d36da4590e556d36c8a31e">DeltafV</a> - ctf.<a class="code" href="group__CTFSupport.html#ga3cdc4a8beb7e3b37ee8089a5e474852d">DeltafU</a>) / (<a class="code" href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">std::max</a>(ctf.<a class="code" href="group__CTFSupport.html#ga78c788d379d36da4590e556d36c8a31e">DeltafV</a>, ctf.<a class="code" href="group__CTFSupport.html#ga3cdc4a8beb7e3b37ee8089a5e474852d">DeltafU</a>)) );</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <span class="comment">// we discard the CTF with a normalized diference between deltaU and deltaV of 10%</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            <span class="keywordflow">if</span> (astigmCTFFactor &gt; 0.1)</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            {</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                <a class="code" href="classFileName.html">FileName</a> ctfname;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                <span class="comment">//REPORT_ERROR(ERR_NUMERICAL, &quot;Prog_MLFalign2D-ERROR%% Only non-astigmatic CTFs are allowed!&quot;);</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                std::cerr &lt;&lt; <span class="stringliteral">&quot;CTF is too astigmatic. We ill ignore it.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                std::cerr &lt;&lt; <span class="stringliteral">&quot;   defocus U: &quot;</span> &lt;&lt; ctf.<a class="code" href="group__CTFSupport.html#ga3cdc4a8beb7e3b37ee8089a5e474852d">DeltafU</a> &lt;&lt; <span class="stringliteral">&quot;   defocus V: &quot;</span> &lt;&lt; ctf.<a class="code" href="group__CTFSupport.html#ga78c788d379d36da4590e556d36c8a31e">DeltafV</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                std::cerr &lt;&lt; <span class="stringliteral">&quot;   astigmCTFFactor &quot;</span> &lt;&lt; astigmCTFFactor &lt;&lt;  std::endl;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                <span class="comment">//continue;</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            }</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            ctf.<a class="code" href="group__CTFSupport.html#ga78c788d379d36da4590e556d36c8a31e">DeltafV</a> =  (ctf.<a class="code" href="group__CTFSupport.html#ga3cdc4a8beb7e3b37ee8089a5e474852d">DeltafU</a>+ctf.<a class="code" href="group__CTFSupport.html#ga78c788d379d36da4590e556d36c8a31e">DeltafV</a>)*0.5;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            ctf.<a class="code" href="group__CTFSupport.html#ga3cdc4a8beb7e3b37ee8089a5e474852d">DeltafU</a> =  ctf.<a class="code" href="group__CTFSupport.html#ga78c788d379d36da4590e556d36c8a31e">DeltafV</a>;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            ctf.<a class="code" href="group__CTFSupport.html#gaeaf27c441146c42522c545521e5f6872">K</a> = 1.;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            ctf.<a class="code" href="group__CTFSupport.html#ga05d00aaebfb6507b217c76b63ffb34a6">enable_CTF</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            ctf.<a class="code" href="group__CTFSupport.html#gaf7c2db081b566837a909634b8dba6caf">produceSideInfo</a>();</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            ctf.<a class="code" href="group__CTFSupport.html#ga827ec32b7dfce0e4b4b4f43013d4fc7c">generateCTF</a>(dim, dim, ctfmask);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keywordflow">if</span> (ifocus == 0)</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                <a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a> = ctf.<a class="code" href="group__CTFSupport.html#gad0be2567780de22f531c2d8793d31a60">Tm</a>;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                Q0 = ctf.<a class="code" href="group__CTFSupport.html#ga6afcb5a27fe2576ea868b3ad9e12ca5a">Q0</a>;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            }</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a> != ctf.<a class="code" href="group__CTFSupport.html#gad0be2567780de22f531c2d8793d31a60">Tm</a>)</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                    <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa22981b63092f2ecbaee8984f0bc9867c">ERR_NUMERICAL</a>, <span class="stringliteral">&quot;Prog_MLFalign2D-ERROR%% Different sampling rates in CTF parameter files!&quot;</span>);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                <span class="keywordflow">if</span> (Q0 != ctf.<a class="code" href="group__CTFSupport.html#ga6afcb5a27fe2576ea868b3ad9e12ca5a">Q0</a> )</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                    <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa22981b63092f2ecbaee8984f0bc9867c">ERR_NUMERICAL</a>, <span class="stringliteral">&quot;Prog_MLFalign2D-ERROR%% Avoid different Q0 values in the CTF parameter files!&quot;</span>);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            }</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            Maux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(dim, dim);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a>(Maux)</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            {</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a9c504b96e173e1eeb6cda09a00e5b638">phase_flipped</a>)</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(Maux, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j) = fabs(<a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(ctfmask, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j).real());</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(Maux, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j) = <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(ctfmask, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j).real();</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            }</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <a class="code" href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a>(Maux, <span class="keyword">true</span>);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            center.initZeros();</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            rmean_ctf.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            Maux.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#ga82c19639b510d33894fe268664130410">radialAverage</a>(Maux, center, rmean_ctf, radial_count, <span class="keyword">true</span>);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <a class="code" href="classProgMLF2D.html#aeacca439f42dea963c5997d589f419a4">Vctf</a>.push_back(dum);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            <a class="code" href="classProgMLF2D.html#a83eda37039c3fc321091307e24dc60fa">Vdec</a>.push_back(dum);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            <a class="code" href="classProgMLF2D.html#a5aad5b0a7bb75420f63794660d636454">Vsig</a>.push_back(dum);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <a class="code" href="classProgMLF2D.html#aeacca439f42dea963c5997d589f419a4">Vctf</a>[ifocus].resize(hdim);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            <a class="code" href="group__MLFalign2D.html#ga0b5e5d4b8eb0463459e3fe178b6622cd">FOR_ALL_DIGITAL_FREQS</a>()</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                <a class="code" href="group__MLFalign2D.html#gae2592474564ce2c4143fab306b777807">VCTF_ITEM</a> = <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(rmean_ctf, irr);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            }</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <a class="code" href="classProgMLF2D.html#a83eda37039c3fc321091307e24dc60fa">Vdec</a>[ifocus].resize(<a class="code" href="classProgMLF2D.html#aeacca439f42dea963c5997d589f419a4">Vctf</a>[ifocus]);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <a class="code" href="classProgMLF2D.html#a5aad5b0a7bb75420f63794660d636454">Vsig</a>[ifocus].resize(<a class="code" href="classProgMLF2D.html#aeacca439f42dea963c5997d589f419a4">Vctf</a>[ifocus]);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            ++ifocus;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        }</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="comment">// Make a join to set the MDL_DEFGROUP to each image</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <a class="code" href="classMetaData.html">MetaData</a> md(<a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#a8ae22c14b56df70e06ca5941bba4bc47">joinNatural</a>(md, mdCTF);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    }</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">// Get a resolution pointer in Fourier-space</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    Maux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(dim, dim);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    Maux.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(Maux)</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    {</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Maux, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j) = <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>((<span class="keywordtype">double</span>) (hdim - 1), <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>((<span class="keywordtype">double</span>)(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + j * j)));</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    }</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <a class="code" href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a>(Maux, <span class="keyword">false</span>);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <a class="code" href="classProgMLF2D.html#a78ef99a6261c8c228ca1bab9f0c2205a">Mresol_int</a>.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(dim, dim);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a>(<a class="code" href="classProgMLF2D.html#a78ef99a6261c8c228ca1bab9f0c2205a">Mresol_int</a>)</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    {</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(<a class="code" href="classProgMLF2D.html#a78ef99a6261c8c228ca1bab9f0c2205a">Mresol_int</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j) = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(Maux, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j));</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    }</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">// Check whether to generate new references</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <a class="code" href="classML2DBaseProgram.html#acd93072cb690045eff13e91439461a6a">do_generate_refs</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a9544695d9d0054d6e75d62f227bee889">fn_ref</a>.empty())</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    {</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a> &gt; 0)</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a9544695d9d0054d6e75d62f227bee889">fn_ref</a> = <a class="code" href="ml2d_8h.html#a8ef0c472d79a03426c3c02f8777ef3c3">FN_CLASSES_MD</a>(<a class="code" href="group__MLalign2D.html#ga37dd4c436766acd586ca95f773236000">getIterExtraPath</a>(<a class="code" href="classML2DBaseProgram.html#adfab8933f95443ac6d909a9b206b3fa8">fn_root</a>, 0));</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            <a class="code" href="classML2DBaseProgram.html#acd93072cb690045eff13e91439461a6a">do_generate_refs</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#aba28a0ffa831626698f137197c961017">rank</a> == 0)</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                <a class="code" href="classProgMLF2D.html#a41a5836d1f8b6fcac9f20d447263bf13">generateInitialReferences</a>();</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        }</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa640217ae2418fe91401329baab687564">ERR_INDEX_OUTOFBOUNDS</a>, <span class="stringliteral">&quot;Please provide -ref or -nref larger than zero&quot;</span>);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    }</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <a class="code" href="classXmippProgram.html#a7b0644621f62746e36bd7dac7067379b">show</a>();</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <a class="code" href="classProgMLF2D.html#a8b3ad1500cc0fff4024cc23ce3c2b192">estimateInitialNoiseSpectra</a>();</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;}</div><div class="ttc" id="classML2DBaseProgram_html_a976dc404489a0c66af2800f0f73e76c7"><div class="ttname"><a href="classML2DBaseProgram.html#a976dc404489a0c66af2800f0f73e76c7">ML2DBaseProgram::nr_psi</a></div><div class="ttdeci">size_t nr_psi</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00154">ml2d.h:154</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa640217ae2418fe91401329baab687564"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa640217ae2418fe91401329baab687564">ERR_INDEX_OUTOFBOUNDS</a></div><div class="ttdoc">Index out of bounds. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00137">xmipp_error.h:137</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ad2a82e39d73ee5d2911c6c9a95b9b54c"><div class="ttname"><a href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">ML2DBaseProgram::Vtrans</a></div><div class="ttdeci">std::vector&lt; Matrix1D&lt; double &gt; &gt; Vtrans</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00184">ml2d.h:184</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a3464cb9938eb4cf849b7c8bbb354734f"><div class="ttname"><a href="classML2DBaseProgram.html#a3464cb9938eb4cf849b7c8bbb354734f">ML2DBaseProgram::img_id</a></div><div class="ttdeci">std::vector&lt; size_t &gt; img_id</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00232">ml2d.h:232</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_acd93072cb690045eff13e91439461a6a"><div class="ttname"><a href="classML2DBaseProgram.html#acd93072cb690045eff13e91439461a6a">ML2DBaseProgram::do_generate_refs</a></div><div class="ttdeci">bool do_generate_refs</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00198">ml2d.h:198</a></div></div>
<div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a41a5836d1f8b6fcac9f20d447263bf13"><div class="ttname"><a href="classProgMLF2D.html#a41a5836d1f8b6fcac9f20d447263bf13">ProgMLF2D::generateInitialReferences</a></div><div class="ttdeci">void generateInitialReferences()</div><div class="ttdoc">Generate initial references from random subset averages. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l01195">mlf_align2d.cpp:1195</a></div></div>
<div class="ttc" id="classProgMLF2D_html_aeacca439f42dea963c5997d589f419a4"><div class="ttname"><a href="classProgMLF2D.html#aeacca439f42dea963c5997d589f419a4">ProgMLF2D::Vctf</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; double &gt; &gt; Vctf</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00110">mlf_align2d.h:110</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00364">multidim_array.h:364</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a2c4443e4facc7cacc4da074ac10154e6"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a2c4443e4facc7cacc4da074ac10154e6">MDL_CTF_SAMPLING_RATE</a></div><div class="ttdoc">Sampling rate. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00127">metadata_label.h:127</a></div></div>
<div class="ttc" id="classMetaData_html_a8ae22c14b56df70e06ca5941bba4bc47"><div class="ttname"><a href="classMetaData.html#a8ae22c14b56df70e06ca5941bba4bc47">MetaData::joinNatural</a></div><div class="ttdeci">void joinNatural(const MetaData &amp;mdInLeft, const MetaData &amp;mdInRight)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l02133">metadata.cpp:2133</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a5578230b3fb9e054c437e187cb0ad5d3"><div class="ttname"><a href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">ML2DBaseProgram::model</a></div><div class="ttdeci">ModelML2D model</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00224">ml2d.h:224</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a78ef99a6261c8c228ca1bab9f0c2205a"><div class="ttname"><a href="classProgMLF2D.html#a78ef99a6261c8c228ca1bab9f0c2205a">ProgMLF2D::Mresol_int</a></div><div class="ttdeci">MultidimArray&lt; size_t &gt; Mresol_int</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00108">mlf_align2d.h:108</a></div></div>
<div class="ttc" id="group__CTFSupport_html_ga78c788d379d36da4590e556d36c8a31e"><div class="ttname"><a href="group__CTFSupport.html#ga78c788d379d36da4590e556d36c8a31e">CTFDescription::DeltafV</a></div><div class="ttdeci">double DeltafV</div><div class="ttdoc">Defocus in V (in Angstroms). Negative values are underfocused. </div><div class="ttdef"><b>Definition:</b> <a href="ctf_8h_source.html#l00829">ctf.h:829</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a13f69696df08368a14b8928b60faaad7"><div class="ttname"><a href="classProgMLF2D.html#a13f69696df08368a14b8928b60faaad7">ProgMLF2D::search_shift</a></div><div class="ttdeci">int search_shift</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00093">mlf_align2d.h:93</a></div></div>
<div class="ttc" id="group__MetaDataExtension_html_gac0be4f4f5a50390ff4939b437170e700"><div class="ttname"><a href="group__MetaDataExtension.html#gac0be4f4f5a50390ff4939b437170e700">getImageSize</a></div><div class="ttdeci">void getImageSize(const MetaData &amp;md, size_t &amp;Xdim, size_t &amp;Ydim, size_t &amp;Zdim, size_t &amp;Ndim, MDLabel image_label)</div><div class="ttdef"><b>Definition:</b> <a href="metadata__extension_8cpp_source.html#l00260">metadata_extension.cpp:260</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a1f05f45301557f3c0a855a414b87b5fd"><div class="ttname"><a href="classProgMLF2D.html#a1f05f45301557f3c0a855a414b87b5fd">ProgMLF2D::nr_trans</a></div><div class="ttdeci">size_t nr_trans</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00089">mlf_align2d.h:89</a></div></div>
<div class="ttc" id="classMetaData_html"><div class="ttname"><a href="classMetaData.html">MetaData</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00234">metadata.h:234</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a4e593a9112ddcc0256bc9b72213cdb3b"><div class="ttname"><a href="classML2DBaseProgram.html#a4e593a9112ddcc0256bc9b72213cdb3b">ML2DBaseProgram::fn_img</a></div><div class="ttdeci">FileName fn_img</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00132">ml2d.h:132</a></div></div>
<div class="ttc" id="classModelML2D_html_a63a3a3534d1cb72a9db046508b9a59f6"><div class="ttname"><a href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">ModelML2D::n_ref</a></div><div class="ttdeci">int n_ref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00083">ml2d.h:83</a></div></div>
<div class="ttc" id="classMetaData_html_ab7f8d43d77647ade923e6cd63eafdd03"><div class="ttname"><a href="classMetaData.html#ab7f8d43d77647ade923e6cd63eafdd03">MetaData::read</a></div><div class="ttdeci">void read(const FileName &amp;inFile, const std::vector&lt; MDLabel &gt; *desiredLabels=NULL, bool decomposeStack=true)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l01447">metadata.cpp:1447</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a90e6ce499655b4566e17e32102a905c4"><div class="ttname"><a href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">ML2DBaseProgram::hdim</a></div><div class="ttdeci">size_t hdim</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00151">ml2d.h:151</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_adfab8933f95443ac6d909a9b206b3fa8"><div class="ttname"><a href="classML2DBaseProgram.html#adfab8933f95443ac6d909a9b206b3fa8">ML2DBaseProgram::fn_root</a></div><div class="ttdeci">FileName fn_root</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00132">ml2d.h:132</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00068">xmipp_filename.h:68</a></div></div>
<div class="ttc" id="ml2d_8h_html_a8ef0c472d79a03426c3c02f8777ef3c3"><div class="ttname"><a href="ml2d_8h.html#a8ef0c472d79a03426c3c02f8777ef3c3">FN_CLASSES_MD</a></div><div class="ttdeci">#define FN_CLASSES_MD(base)</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00055">ml2d.h:55</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a7e08de076e12e519d59f5e39854f1dc5"><div class="ttname"><a href="classProgMLF2D.html#a7e08de076e12e519d59f5e39854f1dc5">ProgMLF2D::nr_focus</a></div><div class="ttdeci">size_t nr_focus</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00114">mlf_align2d.h:114</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a8b3ad1500cc0fff4024cc23ce3c2b192"><div class="ttname"><a href="classProgMLF2D.html#a8b3ad1500cc0fff4024cc23ce3c2b192">ProgMLF2D::estimateInitialNoiseSpectra</a></div><div class="ttdeci">void estimateInitialNoiseSpectra()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l00734">mlf_align2d.cpp:734</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_ga0b5e5d4b8eb0463459e3fe178b6622cd"><div class="ttname"><a href="group__MLFalign2D.html#ga0b5e5d4b8eb0463459e3fe178b6622cd">FOR_ALL_DIGITAL_FREQS</a></div><div class="ttdeci">#define FOR_ALL_DIGITAL_FREQS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00041">mlf_align2d.h:41</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="group__CTFSupport_html_ga3cdc4a8beb7e3b37ee8089a5e474852d"><div class="ttname"><a href="group__CTFSupport.html#ga3cdc4a8beb7e3b37ee8089a5e474852d">CTFDescription::DeltafU</a></div><div class="ttdeci">double DeltafU</div><div class="ttdoc">Global gain. By default, 1. </div><div class="ttdef"><b>Definition:</b> <a href="ctf_8h_source.html#l00827">ctf.h:827</a></div></div>
<div class="ttc" id="group__CTFSupport_html_ga05d00aaebfb6507b217c76b63ffb34a6"><div class="ttname"><a href="group__CTFSupport.html#ga05d00aaebfb6507b217c76b63ffb34a6">CTFDescription1D::enable_CTF</a></div><div class="ttdeci">bool enable_CTF</div><div class="ttdoc">Enable CTF part. </div><div class="ttdef"><b>Definition:</b> <a href="ctf_8h_source.html#l00278">ctf.h:278</a></div></div>
<div class="ttc" id="group__Fourier_html_ga0447bcc3d329ad07e453b0d9b0872468"><div class="ttname"><a href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a></div><div class="ttdeci">void CenterFFT(MultidimArray&lt; T &gt; &amp;v, bool forward)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8h_source.html#l00291">xmipp_fft.h:291</a></div></div>
<div class="ttc" id="classMetaData_html_a2239fbb7e492654f1e2866ab27492a5d"><div class="ttname"><a href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">MetaData::getValue</a></div><div class="ttdeci">bool getValue(MDObject &amp;mdValueOut, size_t id) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00217">metadata.cpp:217</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_ga2dfb9d47a060372ac150f68c9ff4cc09"><div class="ttname"><a href="group__MLFalign2D.html#ga2dfb9d47a060372ac150f68c9ff4cc09">HISTSTEPS</a></div><div class="ttdeci">#define HISTSTEPS</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00055">mlf_align2d.h:55</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a1a2c16ef85a25a0117e3387cbfc0c89d"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a1a2c16ef85a25a0117e3387cbfc0c89d">MDL_COUNT</a></div><div class="ttdoc">Number of elements of a type (int) [this is a genereic type do not use to transfer information to ano...</div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00091">metadata_label.h:91</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a79873ba6ac0a02ebff149285475a8721"><div class="ttname"><a href="classProgMLF2D.html#a79873ba6ac0a02ebff149285475a8721">ProgMLF2D::do_kstest</a></div><div class="ttdeci">bool do_kstest</div><div class="ttdoc">Statistical analysis of the noise distributions. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00141">mlf_align2d.h:141</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00400">multidim_array.h:400</a></div></div>
<div class="ttc" id="group__CTFSupport_html_ga78bd0bf278a605995f4360142dbf0043"><div class="ttname"><a href="group__CTFSupport.html#ga78bd0bf278a605995f4360142dbf0043">CTFDescription::readFromMetadataRow</a></div><div class="ttdeci">void readFromMetadataRow(const MetaData &amp;MD, size_t id, bool disable_if_not_K=true)</div><div class="ttdef"><b>Definition:</b> <a href="ctf_8cpp_source.html#l01209">ctf.cpp:1209</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a7d9d585d218e22d9569dae329fb0c538"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a7d9d585d218e22d9569dae329fb0c538">MDL_DEFGROUP</a></div><div class="ttdoc">Defocus group. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00210">metadata_label.h:210</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a08dc75912c3b5bf4be88e88a81cf23fa"><div class="ttname"><a href="classML2DBaseProgram.html#a08dc75912c3b5bf4be88e88a81cf23fa">ML2DBaseProgram::initSamplingStuff</a></div><div class="ttdeci">void initSamplingStuff()</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8cpp_source.html#l00043">ml2d.cpp:43</a></div></div>
<div class="ttc" id="classMetaData_html_ad844b6a5655be4205e4bb03ab6372562"><div class="ttname"><a href="classMetaData.html#ad844b6a5655be4205e4bb03ab6372562">MetaData::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00702">metadata.cpp:702</a></div></div>
<div class="ttc" id="group__MLalign2D_html_ga37dd4c436766acd586ca95f773236000"><div class="ttname"><a href="group__MLalign2D.html#ga37dd4c436766acd586ca95f773236000">getIterExtraPath</a></div><div class="ttdeci">FileName getIterExtraPath(const FileName &amp;fn_root, int iter, bool makePath)</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8cpp_source.html#l00304">ml2d.cpp:304</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a9c504b96e173e1eeb6cda09a00e5b638"><div class="ttname"><a href="classProgMLF2D.html#a9c504b96e173e1eeb6cda09a00e5b638">ProgMLF2D::phase_flipped</a></div><div class="ttdeci">bool phase_flipped</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00106">mlf_align2d.h:106</a></div></div>
<div class="ttc" id="group__MetaData_html_ga85652b971edca3acc93a9f1bef2f17f6"><div class="ttname"><a href="group__MetaData.html#ga85652b971edca3acc93a9f1bef2f17f6">FOR_ALL_OBJECTS_IN_METADATA</a></div><div class="ttdeci">#define FOR_ALL_OBJECTS_IN_METADATA(__md)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00081">metadata.h:81</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_ac5474a01d203d14c046620266b2f1954"><div class="ttname"><a href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">max</a></div><div class="ttdeci">void max(Image&lt; double &gt; &amp;op1, const Image&lt; double &gt; &amp;op2)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00125">image_operate.cpp:125</a></div></div>
<div class="ttc" id="group__CTFSupport_html_gad0be2567780de22f531c2d8793d31a60"><div class="ttname"><a href="group__CTFSupport.html#gad0be2567780de22f531c2d8793d31a60">CTFDescription1D::Tm</a></div><div class="ttdeci">double Tm</div><div class="ttdoc">Sampling rate (A/pixel) </div><div class="ttdef"><b>Definition:</b> <a href="ctf_8h_source.html#l00243">ctf.h:243</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa22981b63092f2ecbaee8984f0bc9867c"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa22981b63092f2ecbaee8984f0bc9867c">ERR_NUMERICAL</a></div><div class="ttdoc">Error related to numerical calculation. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00184">xmipp_error.h:184</a></div></div>
<div class="ttc" id="classCTFDescription_html"><div class="ttname"><a href="classCTFDescription.html">CTFDescription</a></div><div class="ttdef"><b>Definition:</b> <a href="ctf_8h_source.html#l00781">ctf.h:781</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gafa02b309a507bf04daf9f31fa828ce4f"><div class="ttname"><a href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a></div><div class="ttdeci">#define dAij(M, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00355">multidim_array.h:355</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ae96de19117479eb8bf594268bb9af590"><div class="ttname"><a href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">ML2DBaseProgram::dim</a></div><div class="ttdeci">size_t dim</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00151">ml2d.h:151</a></div></div>
<div class="ttc" id="classXmippProgram_html_aed62cfe3c074e69076bf348fc101a717"><div class="ttname"><a href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">XmippProgram::verbose</a></div><div class="ttdeci">int verbose</div><div class="ttdoc">Verbosity level. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8h_source.html#l00168">xmipp_program.h:168</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a7c3f7c47054265ad3589ee6d40764fbc"><div class="ttname"><a href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">ProgMLF2D::do_ctf_correction</a></div><div class="ttdeci">bool do_ctf_correction</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00100">mlf_align2d.h:100</a></div></div>
<div class="ttc" id="classProgMLF2D_html_aff8593015f02560e8e3e85ebd86ba894"><div class="ttname"><a href="classProgMLF2D.html#aff8593015f02560e8e3e85ebd86ba894">ProgMLF2D::resolhist</a></div><div class="ttdeci">std::vector&lt; Histogram1D &gt; resolhist</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00146">mlf_align2d.h:146</a></div></div>
<div class="ttc" id="classMetaData_html_a1a76384897857d639447524ff2f14ab3"><div class="ttname"><a href="classMetaData.html#a1a76384897857d639447524ff2f14ab3">MetaData::findObjects</a></div><div class="ttdeci">void findObjects(std::vector&lt; size_t &gt; &amp;objectsOut, const MDQuery &amp;query) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00868">metadata.cpp:868</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a83eda37039c3fc321091307e24dc60fa"><div class="ttname"><a href="classProgMLF2D.html#a83eda37039c3fc321091307e24dc60fa">ProgMLF2D::Vdec</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; double &gt; &gt; Vdec</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00110">mlf_align2d.h:110</a></div></div>
<div class="ttc" id="classXmippProgram_html_a7b0644621f62746e36bd7dac7067379b"><div class="ttname"><a href="classXmippProgram.html#a7b0644621f62746e36bd7dac7067379b">XmippProgram::show</a></div><div class="ttdeci">virtual void show() const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00475">xmipp_program.cpp:475</a></div></div>
<div class="ttc" id="group__Macros_html_gac9ae6a207f10c821b06a8c0df153a7d5"><div class="ttname"><a href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a></div><div class="ttdeci">#define XMIPP_MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00181">xmipp_macros.h:181</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga53e37122134100316031eae982abee03"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a></div><div class="ttdeci">#define dAi(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00540">multidim_array.h:540</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__CTFSupport_html_ga827ec32b7dfce0e4b4b4f43013d4fc7c"><div class="ttname"><a href="group__CTFSupport.html#ga827ec32b7dfce0e4b4b4f43013d4fc7c">CTFDescription::generateCTF</a></div><div class="ttdeci">void generateCTF(const MultidimArray&lt; T1 &gt; &amp;sample_image, MultidimArray&lt; T2 &gt; &amp;CTF, double Ts=-1)</div><div class="ttdef"><b>Definition:</b> <a href="ctf_8h_source.html#l01218">ctf.h:1218</a></div></div>
<div class="ttc" id="group__CTFSupport_html_gaeaf27c441146c42522c545521e5f6872"><div class="ttname"><a href="group__CTFSupport.html#gaeaf27c441146c42522c545521e5f6872">CTFDescription1D::K</a></div><div class="ttdeci">double K</div><div class="ttdoc">Global gain. By default, 1. </div><div class="ttdef"><b>Definition:</b> <a href="ctf_8h_source.html#l00241">ctf.h:241</a></div></div>
<div class="ttc" id="classMetaData_html_adf4ee2ad1ad0964990a8a11a2109d578"><div class="ttname"><a href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">MetaData::setValue</a></div><div class="ttdeci">bool setValue(const MDLabel label, const T &amp;valueIn, size_t id)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00550">metadata.h:550</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga82c19639b510d33894fe268664130410"><div class="ttname"><a href="group__GeometricalTransformations.html#ga82c19639b510d33894fe268664130410">radialAverage</a></div><div class="ttdeci">void radialAverage(const MultidimArray&lt; T &gt; &amp;m, Matrix1D&lt; int &gt; &amp;center_of_rot, MultidimArray&lt; T &gt; &amp;radial_mean, MultidimArray&lt; int &gt; &amp;radial_count, const bool &amp;rounding=false)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01575">transformations.h:1575</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4e8db4e5757ca2f6e233d0a1eec7ff1c"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00519">multidim_array.h:519</a></div></div>
<div class="ttc" id="xmipp__log_8h_html_a9d0e78c69b9733e4419a5f65d5a38a3a"><div class="ttname"><a href="xmipp__log_8h.html#a9d0e78c69b9733e4419a5f65d5a38a3a">LOG_FUNCTION</a></div><div class="ttdeci">#define LOG_FUNCTION()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__log_8h_source.html#l00090">xmipp_log.h:90</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a080fbf81a2b9dfceab4cfe1a649f13a4"><div class="ttname"><a href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">ML2DBaseProgram::MDimg</a></div><div class="ttdeci">MetaData MDimg</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00172">ml2d.h:172</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classMetaData_html_a55651d0806335c55622838d62b8068b5"><div class="ttname"><a href="classMetaData.html#a55651d0806335c55622838d62b8068b5">MetaData::removeDisabled</a></div><div class="ttdeci">void removeDisabled()</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l02093">metadata.cpp:2093</a></div></div>
<div class="ttc" id="classMetaData_html_ab448a0c9242f0442d4a04e1fff948c7f"><div class="ttname"><a href="classMetaData.html#ab448a0c9242f0442d4a04e1fff948c7f">MetaData::setValueCol</a></div><div class="ttdeci">bool setValueCol(const MDObject &amp;mdValueIn)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00210">metadata.cpp:210</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a9544695d9d0054d6e75d62f227bee889"><div class="ttname"><a href="classML2DBaseProgram.html#a9544695d9d0054d6e75d62f227bee889">ML2DBaseProgram::fn_ref</a></div><div class="ttdeci">FileName fn_ref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00132">ml2d.h:132</a></div></div>
<div class="ttc" id="ctf_8cpp_html_aca3073742a1cc4b86d0c59bd19352cae"><div class="ttname"><a href="ctf_8cpp.html#aca3073742a1cc4b86d0c59bd19352cae">groupCTFMetaData</a></div><div class="ttdeci">void groupCTFMetaData(const MetaData &amp;imgMd, MetaData &amp;ctfMd, std::vector&lt; MDLabel &gt; &amp;groupbyLabels)</div><div class="ttdef"><b>Definition:</b> <a href="ctf_8cpp_source.html#l00041">ctf.cpp:41</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="group__CTFSupport_html_gaf7c2db081b566837a909634b8dba6caf"><div class="ttname"><a href="group__CTFSupport.html#gaf7c2db081b566837a909634b8dba6caf">CTFDescription::produceSideInfo</a></div><div class="ttdeci">void produceSideInfo()</div><div class="ttdoc">Produce Side information. </div><div class="ttdef"><b>Definition:</b> <a href="ctf_8cpp_source.html#l01387">ctf.cpp:1387</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gab2b66f57ef06321905e6675d295b3172"><div class="ttname"><a href="group__MLFalign2D.html#gab2b66f57ef06321905e6675d295b3172">HISTMAX</a></div><div class="ttdeci">#define HISTMAX</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00054">mlf_align2d.h:54</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a373f1965ed767abbf1d5b3e53104623b"><div class="ttname"><a href="classProgMLF2D.html#a373f1965ed767abbf1d5b3e53104623b">ProgMLF2D::max_nr_psi</a></div><div class="ttdeci">size_t max_nr_psi</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00081">mlf_align2d.h:81</a></div></div>
<div class="ttc" id="classProgMLF2D_html_af1176823dd265484796aa9b52215719e"><div class="ttname"><a href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">ProgMLF2D::sampling</a></div><div class="ttdeci">double sampling</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00102">mlf_align2d.h:102</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gae2592474564ce2c4143fab306b777807"><div class="ttname"><a href="group__MLFalign2D.html#gae2592474564ce2c4143fab306b777807">VCTF_ITEM</a></div><div class="ttdeci">#define VCTF_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00047">mlf_align2d.h:47</a></div></div>
<div class="ttc" id="classProgMLF2D_html_aba28a0ffa831626698f137197c961017"><div class="ttname"><a href="classProgMLF2D.html#aba28a0ffa831626698f137197c961017">ProgMLF2D::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00150">mlf_align2d.h:150</a></div></div>
<div class="ttc" id="group__CTFSupport_html_ga6afcb5a27fe2576ea868b3ad9e12ca5a"><div class="ttname"><a href="group__CTFSupport.html#ga6afcb5a27fe2576ea868b3ad9e12ca5a">CTFDescription1D::Q0</a></div><div class="ttdeci">double Q0</div><div class="ttdoc">Factor for the importance of the Amplitude contrast. </div><div class="ttdef"><b>Definition:</b> <a href="ctf_8h_source.html#l00264">ctf.h:264</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_ab7a69dabaa7151dae4d7a3998167e2f3"><div class="ttname"><a href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a></div><div class="ttdeci">float r2</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00051">image_find_center.cpp:51</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a55332f697c74f72635ae850439407645"><div class="ttname"><a href="classML2DBaseProgram.html#a55332f697c74f72635ae850439407645">ML2DBaseProgram::nr_images_global</a></div><div class="ttdeci">size_t nr_images_global</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00164">ml2d.h:164</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_ga998b4df4b03424508c129e4fad74b36f"><div class="ttname"><a href="group__MLFalign2D.html#ga998b4df4b03424508c129e4fad74b36f">HISTMIN</a></div><div class="ttdeci">#define HISTMIN</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00053">mlf_align2d.h:53</a></div></div>
<div class="ttc" id="xmipp__funcs_8cpp_html_a6b2ac43eac850ac39594e8a5f5aa42fe"><div class="ttname"><a href="xmipp__funcs_8cpp.html#a6b2ac43eac850ac39594e8a5f5aa42fe">idum</a></div><div class="ttdeci">int idum</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00382">xmipp_funcs.cpp:382</a></div></div>
<div class="ttc" id="classProgMLF2D_html_adec8e47d0ada48f2aea2259ca1b400cf"><div class="ttname"><a href="classProgMLF2D.html#adec8e47d0ada48f2aea2259ca1b400cf">ProgMLF2D::zero_trans</a></div><div class="ttdeci">size_t zero_trans</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00091">mlf_align2d.h:91</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a997e2be4af206a96283a2f73cfacdcfe"><div class="ttname"><a href="classML2DBaseProgram.html#a997e2be4af206a96283a2f73cfacdcfe">ML2DBaseProgram::dim2</a></div><div class="ttdeci">size_t dim2</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00151">ml2d.h:151</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a5c75192acc215ccf8e062881d14f9ac4"><div class="ttname"><a href="classProgMLF2D.html#a5c75192acc215ccf8e062881d14f9ac4">ProgMLF2D::count_defocus</a></div><div class="ttdeci">std::vector&lt; int &gt; count_defocus</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00104">mlf_align2d.h:104</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a5aad5b0a7bb75420f63794660d636454"><div class="ttname"><a href="classProgMLF2D.html#a5aad5b0a7bb75420f63794660d636454">ProgMLF2D::Vsig</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; double &gt; &gt; Vsig</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00110">mlf_align2d.h:110</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a04ca5ccf66605a78474081363ac48581"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::produceSideInfo2 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Read reference images in memory &amp; set offset vectors (This produceSideInfo is Selfile-dependent!) </p>

<p>Implements <a class="el" href="classML2DBaseProgram.html#a61d5b5ea172bcafe961ece6a8f3e5808">ML2DBaseProgram</a>.</p>

<p>Reimplemented in <a class="el" href="classMpiProgMLF2D.html#af0e111d9df646275ace5af91889f8c51">MpiProgMLF2D</a>.</p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l00521">521</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;{</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <a class="code" href="xmipp__log_8h.html#a485ad250637a874aa112548b4133e8d0">LOG_LEVEL</a>(<a class="code" href="classProgMLF2D.html#a04ca5ccf66605a78474081363ac48581">produceSideInfo2</a>);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordtype">int</span>                       <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>, <a class="code" href="xmipp__funcs_8cpp.html#a6b2ac43eac850ac39594e8a5f5aa42fe">idum</a>, refno = 0;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordtype">double</span>                    aux = 0.;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="classFileName.html">FileName</a>                  fn_tmp;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <a class="code" href="classImage.html">Image&lt;double&gt;</a>                img;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    std::vector&lt;double&gt;       Vdum, <a class="code" href="classProgMLF2D.html#a9c42feb7d8cbf224f91e903bac49663e">sumw_defocus</a>;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="comment">// Read in all reference images in memory</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">MDref</a>.<a class="code" href="classMetaData.html#ab7f8d43d77647ade923e6cd63eafdd03">read</a>(<a class="code" href="classML2DBaseProgram.html#a9544695d9d0054d6e75d62f227bee889">fn_ref</a>);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a> = <a class="code" href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">MDref</a>.<a class="code" href="classMetaData.html#ad844b6a5655be4205e4bb03ab6372562">size</a>();</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    refno = 0;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordtype">double</span> ref_fraction = (double)1. / <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a>;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordtype">double</span> ref_weight = (<span class="keywordtype">double</span>)<a class="code" href="classML2DBaseProgram.html#a55332f697c74f72635ae850439407645">nr_images_global</a> / <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a>;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <a class="code" href="group__MetaData.html#ga85652b971edca3acc93a9f1bef2f17f6">FOR_ALL_OBJECTS_IN_METADATA</a>(<a class="code" href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">MDref</a>)</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">MDref</a>.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a>, fn_tmp, __iter.objId);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        img.<a class="code" href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">read</a>(fn_tmp);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        img().setXmippOrigin();</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>.push_back(img);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <a class="code" href="classML2DBaseProgram.html#aa53d160970e65511ba3f5d89db29b651">Iold</a>.push_back(img);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <a class="code" href="classProgMLF2D.html#abe2d74f54f4aa6916eb6f6d29164e023">Ictf</a>.push_back(img);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="comment">// Default start is all equal model fractions</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <a class="code" href="classProgMLF2D.html#a0cf09cc5d8c9949acc48438be868773c">alpha_k</a>.push_back(ref_fraction);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>[refno].setWeight(ref_weight);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="comment">// Default start is half-half mirrored images</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <a class="code" href="classProgMLF2D.html#a619e2aed7d1934de3ce40d04b4d160b3">mirror_fraction</a>.push_back((<a class="code" href="classML2DBaseProgram.html#ad9b9535e1774d805e5bbee89dee0f4b5">do_mirror</a> ? 0.5 : 0.));</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        refno++;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    }</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="comment">//This will differ from nr_images_global if MPI</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <a class="code" href="classML2DBaseProgram.html#ac53bad3c2339d92ebbda4ba5abe7aa57">nr_images_local</a> = <a class="code" href="group__GeneralFunctions.html#gaf849138fb8a55da429e85e6813f3c3ca">divide_equally</a>(<a class="code" href="classML2DBaseProgram.html#a55332f697c74f72635ae850439407645">nr_images_global</a>, <a class="code" href="classProgMLF2D.html#a5399db01ffd31021ae8f1c8ab983eabb">size</a>, <a class="code" href="classProgMLF2D.html#aba28a0ffa831626698f137197c961017">rank</a>, <a class="code" href="classML2DBaseProgram.html#a791b7cb014db4297f7772becd1daa287">myFirstImg</a>, <a class="code" href="classML2DBaseProgram.html#a3c0b6cb5428a40ae95864f5c45c50940">myLastImg</a>);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="comment">//#define DEBUG</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;nr_images_local= &quot;</span>&lt;&lt; <a class="code" href="classML2DBaseProgram.html#ac53bad3c2339d92ebbda4ba5abe7aa57">nr_images_local</a>&lt;&lt;std::endl;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;myFirstImg= &quot;</span>&lt;&lt; <a class="code" href="classML2DBaseProgram.html#a791b7cb014db4297f7772becd1daa287">myFirstImg</a>&lt;&lt;std::endl;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;myLastImg= &quot;</span>&lt;&lt; <a class="code" href="classML2DBaseProgram.html#a3c0b6cb5428a40ae95864f5c45c50940">myLastImg</a>&lt;&lt;std::endl;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    std::cerr &lt;&lt;<span class="stringliteral">&quot;size=&quot;</span>&lt;&lt;<a class="code" href="classProgMLF2D.html#a5399db01ffd31021ae8f1c8ab983eabb">size</a>&lt;&lt;<span class="stringliteral">&quot;rank=&quot;</span>&lt;&lt;<a class="code" href="classProgMLF2D.html#aba28a0ffa831626698f137197c961017">rank</a>&lt;&lt;std::endl;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="comment">//--------Setup for Docfile -----------</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a0ddfa227d1aec7fcfd31cb2c23ec3d0f">docfiledata</a>.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="classML2DBaseProgram.html#ac53bad3c2339d92ebbda4ba5abe7aa57">nr_images_local</a>, <a class="code" href="ml2d_8h.html#a119f8d4cc2bfa19d21093a7694874226">DATALINELENGTH</a>);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">do_norm</a>)</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    {</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a90f80f69b900eb15f9300560d50286ca">average_scale</a> = 1.;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <a class="code" href="classProgMLF2D.html#a2fd51100d35db6ecdcb3ac704ab58435">refs_avgscale</a>.assign(<a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a>, 1.);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <a class="code" href="classML2DBaseProgram.html#ab7caa861fcd7c5a139c0a0825c1abbe0">imgs_scale</a>.assign(<a class="code" href="classML2DBaseProgram.html#ac53bad3c2339d92ebbda4ba5abe7aa57">nr_images_local</a>, 1.);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    }</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="comment">// Fill imgs_offsets vectors with zeros</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    idum = (<a class="code" href="classML2DBaseProgram.html#ad9b9535e1774d805e5bbee89dee0f4b5">do_mirror</a> ? 4 : 2) * <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a>;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <a class="code" href="ml2d_8h.html#a63b804f3c807ffe0259b3ee45cb19693">FOR_ALL_LOCAL_IMAGES</a>()</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <a class="code" href="classML2DBaseProgram.html#adb224115e7f853ead371caf7a3767fa4">imgs_offsets</a>.push_back(Vdum);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> refno = 0; refno &lt; <a class="code" href="xmipp__funcs_8cpp.html#a6b2ac43eac850ac39594e8a5f5aa42fe">idum</a>; refno++)</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        {</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            <a class="code" href="classML2DBaseProgram.html#adb224115e7f853ead371caf7a3767fa4">imgs_offsets</a>[<a class="code" href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a>].push_back(0.);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        }</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    }</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="comment">// For limited orientational search: fill imgs_oldphi &amp; imgs_oldtheta</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment">// (either read from fn_doc or initialize to -999.)</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a549ca4cda193eb449087f9a316c61f20">limit_rot</a>)</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    {</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a2d817d670cd567d427da30fad46f5592">imgs_oldphi</a>.assign(<a class="code" href="classML2DBaseProgram.html#ac53bad3c2339d92ebbda4ba5abe7aa57">nr_images_local</a>, -999.);</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <a class="code" href="classML2DBaseProgram.html#ae0d684b9bbe78bfa5ed5ad2610dc4fbe">imgs_oldtheta</a>.assign(<a class="code" href="classML2DBaseProgram.html#ac53bad3c2339d92ebbda4ba5abe7aa57">nr_images_local</a>, -999.);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    }</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a4f7d61fca21cd29df3119a200b9a4bd3">do_restart</a>)</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    {</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="comment">// Read optimal image-parameters</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="comment">//        FOR_ALL_LOCAL_IMAGES()</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="comment">//        {</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="comment">//            if (limit_rot || do_norm)</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="comment">//            {</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <span class="comment">//                MDimg.getValue(MDL_ANGLE_ROT, imgs_oldphi[IMG_LOCAL_INDEX]);</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="comment">//                MDimg.getValue(MDL_ANGLE_TILT, imgs_oldtheta[IMG_LOCAL_INDEX]);</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <span class="comment">//            }</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="comment">//            idum = (do_mirror ? 2 : 1) * model.n_ref;</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="comment">//            double xoff, yoff;</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="comment">//            MDimg.getValue(MDL_SHIFT_X, xoff);</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="comment">//            MDimg.getValue(MDL_SHIFT_Y, yoff);</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="comment">//            for (int refno = 0; refno &lt; idum; refno++)</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="comment">//            {</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="comment">//                imgs_offsets[IMG_LOCAL_INDEX][2 * refno] = xoff;</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="comment">//                imgs_offsets[IMG_LOCAL_INDEX][2 * refno + 1] = yoff;</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="comment">//            }</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="comment">//            if (do_norm)</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="comment">//            {</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="comment">//                MDimg.getValue(MDL_INTSCALE, imgs_scale[IMG_LOCAL_INDEX]);</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <span class="comment">//            }</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="comment">//        }</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="comment">// read Model parameters</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        refno = 0;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classProgMLF2D.html#a0a90a0680ddfe59efa8bac1303fada63">sumw</a> = 0.;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <a class="code" href="group__MetaData.html#ga85652b971edca3acc93a9f1bef2f17f6">FOR_ALL_OBJECTS_IN_METADATA</a>(<a class="code" href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">MDref</a>)</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        {</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">MDref</a>.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a8807f4c926a3e980249df162c9ff0bdf">MDL_WEIGHT</a>, <a class="code" href="classProgMLF2D.html#a0cf09cc5d8c9949acc48438be868773c">alpha_k</a>[refno], __iter.objId);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            sumw += <a class="code" href="classProgMLF2D.html#a0cf09cc5d8c9949acc48438be868773c">alpha_k</a>[refno];</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#ad9b9535e1774d805e5bbee89dee0f4b5">do_mirror</a>)</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                <a class="code" href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">MDref</a>.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a0704d0153add5aa8abcf3e82bb174ebc">MDL_MIRRORFRAC</a>,</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                               <a class="code" href="classProgMLF2D.html#a619e2aed7d1934de3ce40d04b4d160b3">mirror_fraction</a>[refno], __iter.objId);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">do_norm</a>)</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                <a class="code" href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">MDref</a>.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a29c393fe6e00aa337783865f8694b0af">MDL_INTSCALE</a>, <a class="code" href="classProgMLF2D.html#a2fd51100d35db6ecdcb3ac704ab58435">refs_avgscale</a>[refno], __iter.objId);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            refno++;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <a class="code" href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a>()</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        {</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            <a class="code" href="classProgMLF2D.html#a0cf09cc5d8c9949acc48438be868773c">alpha_k</a>[refno] /= <a class="code" href="classProgMLF2D.html#a0a90a0680ddfe59efa8bac1303fada63">sumw</a>;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        }</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    }</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;std::complex&lt;double&gt;</a> &gt;   Faux;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a>       Maux;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a>       dum, rmean_signal2, <a class="code" href="classML2DBaseProgram.html#add43d72480811707dcaa89df00324f42">spectral_signal</a>;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a>                center(2);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;int&gt;</a>           radial_count;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    std::ifstream                fh;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    center.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">// Calculate average spectral signal</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    c = 0;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <a class="code" href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a>()</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    {</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a0cf09cc5d8c9949acc48438be868773c">alpha_k</a>[refno] &gt; 0.)</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        {</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            <a class="code" href="group__Fourier.html#ga5fddf4cf6da360abdc8fd7d2f21fcbb9">FourierTransform</a>(<a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>[refno](), Faux);</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            <a class="code" href="group__FourierW.html#ga1075fe73c87077296a879f44ded3a2c3">FFT_magnitude</a>(Faux, Maux);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <a class="code" href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a>(Maux, <span class="keyword">true</span>);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            Maux *= Maux;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            Maux *= <a class="code" href="classProgMLF2D.html#a0cf09cc5d8c9949acc48438be868773c">alpha_k</a>[refno] * (double)<a class="code" href="classML2DBaseProgram.html#a55332f697c74f72635ae850439407645">nr_images_global</a>;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            Maux.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            rmean_signal2.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#ga82c19639b510d33894fe268664130410">radialAverage</a>(Maux, center, rmean_signal2, radial_count, <span class="keyword">true</span>);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            <span class="keywordflow">if</span> (c == 0)</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                spectral_signal = rmean_signal2;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                spectral_signal += rmean_signal2;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            c++;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        }</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    }</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a963af5cdb6f63d876c147c24fbf8452e">do_ML3D</a>)</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    {</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="comment">// Divide by the number of reference volumes</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="comment">// But I don&#39;t know alpha (from 3DSSNR) yet:</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="comment">// Introduce a fudge-factor of 2 to prevent over-estimation ...</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="comment">// I think this is irrelevant, as the spectral_signal is</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="comment">// re-calculated in ml_refine3d.cpp</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="keywordtype">double</span> inv_2_nr_vol = 1. / (double)(<a class="code" href="classProgMLF2D.html#ac45e6bbd1a035e75dc4f9bdb5b775ae0">nr_vols</a> * 2);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        spectral_signal *= inv_2_nr_vol;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    }</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    {</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <span class="comment">// Divide by the number of reference images</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordtype">double</span> inv_n_ref = 1. / (double) <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a>;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        spectral_signal *= inv_n_ref;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    }</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="comment">// Read in Vsig-vectors with fixed file names</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <a class="code" href="classFileName.html">FileName</a> fn_base = <a class="code" href="ml__refine3d_8cpp.html#a36c1b07f8f73f52294afe38445f71e17">FN_ITER_BASE</a>(<a class="code" href="classML2DBaseProgram.html#a495926025de4de5360efd7266377cc2c">istart</a> - 1);</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <a class="code" href="classMetaData.html">MetaData</a> md;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <a class="code" href="group__MLFalign2D.html#gab39599380e42cadda13b0cfb14588d46">FOR_ALL_DEFOCUS_GROUPS</a>()</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    {</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        fn_tmp = <a class="code" href="group__MLFalign2D.html#gace9129bcfa1cd128950b15385abff09f">FN_VSIG</a>(fn_base, ifocus, <span class="stringliteral">&quot;noise.xmd&quot;</span>);</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        md.<a class="code" href="classMetaData.html#ab7f8d43d77647ade923e6cd63eafdd03">read</a>(fn_tmp);</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <a class="code" href="group__MetaData.html#ga85652b971edca3acc93a9f1bef2f17f6">FOR_ALL_OBJECTS_IN_METADATA</a>(md)</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        {</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            md.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a783dd0b5e0db5a49b20a3334dc06a063">MDL_MLF_NOISE</a>, aux, __iter.objId);</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(<a class="code" href="classProgMLF2D.html#a5aad5b0a7bb75420f63794660d636454">Vsig</a>[ifocus], __iter.objIndex) = aux;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        }</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="preprocessor">#ifdef OLD_FILE</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        fh.open((fn_tmp).c_str(), <a class="code" href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">std::ios::in</a>);</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keywordflow">if</span> (!fh)</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aabda7431146b956debfa7f89164af1790">ERR_IO_NOTOPEN</a>, (<a class="code" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a>)<span class="stringliteral">&quot;Prog_MLFalign2D_prm: Cannot read file: &quot;</span> + fn_tmp);</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        {</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            <a class="code" href="group__MLFalign2D.html#ga0b5e5d4b8eb0463459e3fe178b6622cd">FOR_ALL_DIGITAL_FREQS</a>()</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            {</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                fh &gt;&gt; aux;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(aux - ((<span class="keywordtype">double</span>)irr/(<a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a>*<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>)) ) &gt; 0.01 )</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                {</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                    std::cerr&lt;&lt;<span class="stringliteral">&quot;aux= &quot;</span>&lt;&lt;aux&lt;&lt;<span class="stringliteral">&quot; resol= &quot;</span>&lt;&lt;(double)irr/(<a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a>*dim)&lt;&lt;std::endl;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                    <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa22981b63092f2ecbaee8984f0bc9867c">ERR_NUMERICAL</a>, (<a class="code" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a>)<span class="stringliteral">&quot;Prog_MLFalign2D_prm: Wrong format: &quot;</span> + fn_tmp);</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                }</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                fh &gt;&gt; aux;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                <a class="code" href="group__MLFalign2D.html#gaea9964961fe272b8b7277239202912cb">VSIG_ITEM</a> = aux;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            }</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        }</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        fh.close();</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="comment">// Initially set sumw_defocus equal to count_defocus</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        sumw_defocus.push_back((<span class="keywordtype">double</span>)<a class="code" href="classProgMLF2D.html#a5c75192acc215ccf8e062881d14f9ac4">count_defocus</a>[ifocus]);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    }</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="comment">// Calculate all Wiener filters</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <a class="code" href="classProgMLF2D.html#ab1a1724f969e8cfca5c84d766366dd7b">updateWienerFilters</a>(spectral_signal, sumw_defocus, <a class="code" href="classML2DBaseProgram.html#a495926025de4de5360efd7266377cc2c">istart</a> - 1);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="ml2d_8h_html_a63b804f3c807ffe0259b3ee45cb19693"><div class="ttname"><a href="ml2d_8h.html#a63b804f3c807ffe0259b3ee45cb19693">FOR_ALL_LOCAL_IMAGES</a></div><div class="ttdeci">#define FOR_ALL_LOCAL_IMAGES()</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00064">ml2d.h:64</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a5578230b3fb9e054c437e187cb0ad5d3"><div class="ttname"><a href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">ML2DBaseProgram::model</a></div><div class="ttdeci">ModelML2D model</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00224">ml2d.h:224</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a90f80f69b900eb15f9300560d50286ca"><div class="ttname"><a href="classML2DBaseProgram.html#a90f80f69b900eb15f9300560d50286ca">ML2DBaseProgram::average_scale</a></div><div class="ttdeci">double average_scale</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00213">ml2d.h:213</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_gaf849138fb8a55da429e85e6813f3c3ca"><div class="ttname"><a href="group__GeneralFunctions.html#gaf849138fb8a55da429e85e6813f3c3ca">divide_equally</a></div><div class="ttdeci">size_t divide_equally(size_t N, size_t size, size_t rank, size_t &amp;first, size_t &amp;last)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l01141">xmipp_funcs.cpp:1141</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a5399db01ffd31021ae8f1c8ab983eabb"><div class="ttname"><a href="classProgMLF2D.html#a5399db01ffd31021ae8f1c8ab983eabb">ProgMLF2D::size</a></div><div class="ttdeci">int size</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00150">mlf_align2d.h:150</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a3c0b6cb5428a40ae95864f5c45c50940"><div class="ttname"><a href="classML2DBaseProgram.html#a3c0b6cb5428a40ae95864f5c45c50940">ML2DBaseProgram::myLastImg</a></div><div class="ttdeci">size_t myLastImg</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00168">ml2d.h:168</a></div></div>
<div class="ttc" id="classMetaData_html"><div class="ttname"><a href="classMetaData.html">MetaData</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00234">metadata.h:234</a></div></div>
<div class="ttc" id="classModelML2D_html_a63a3a3534d1cb72a9db046508b9a59f6"><div class="ttname"><a href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">ModelML2D::n_ref</a></div><div class="ttdeci">int n_ref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00083">ml2d.h:83</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a9c42feb7d8cbf224f91e903bac49663e"><div class="ttname"><a href="classProgMLF2D.html#a9c42feb7d8cbf224f91e903bac49663e">ProgMLF2D::sumw_defocus</a></div><div class="ttdeci">std::vector&lt; double &gt; sumw_defocus</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00156">mlf_align2d.h:156</a></div></div>
<div class="ttc" id="classMetaData_html_ab7f8d43d77647ade923e6cd63eafdd03"><div class="ttname"><a href="classMetaData.html#ab7f8d43d77647ade923e6cd63eafdd03">MetaData::read</a></div><div class="ttdeci">void read(const FileName &amp;inFile, const std::vector&lt; MDLabel &gt; *desiredLabels=NULL, bool decomposeStack=true)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l01447">metadata.cpp:1447</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gab39599380e42cadda13b0cfb14588d46"><div class="ttname"><a href="group__MLFalign2D.html#gab39599380e42cadda13b0cfb14588d46">FOR_ALL_DEFOCUS_GROUPS</a></div><div class="ttdeci">#define FOR_ALL_DEFOCUS_GROUPS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00040">mlf_align2d.h:40</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00068">xmipp_filename.h:68</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_ga0b5e5d4b8eb0463459e3fe178b6622cd"><div class="ttname"><a href="group__MLFalign2D.html#ga0b5e5d4b8eb0463459e3fe178b6622cd">FOR_ALL_DIGITAL_FREQS</a></div><div class="ttdeci">#define FOR_ALL_DIGITAL_FREQS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00041">mlf_align2d.h:41</a></div></div>
<div class="ttc" id="ml2d_8h_html_a5c733b69a54d6f6997b09d41b77ec37f"><div class="ttname"><a href="ml2d_8h.html#a5c733b69a54d6f6997b09d41b77ec37f">IMG_LOCAL_INDEX</a></div><div class="ttdeci">#define IMG_LOCAL_INDEX</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00067">ml2d.h:67</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a9e143fabdc67d1ee8cd67dcad98e74fc"><div class="ttname"><a href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">ML2DBaseProgram::do_norm</a></div><div class="ttdeci">bool do_norm</div><div class="ttdoc">Re-normalize internally. </div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00207">ml2d.h:207</a></div></div>
<div class="ttc" id="group__Fourier_html_ga0447bcc3d329ad07e453b0d9b0872468"><div class="ttname"><a href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a></div><div class="ttdeci">void CenterFFT(MultidimArray&lt; T &gt; &amp;v, bool forward)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8h_source.html#l00291">xmipp_fft.h:291</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a963af5cdb6f63d876c147c24fbf8452e"><div class="ttname"><a href="classML2DBaseProgram.html#a963af5cdb6f63d876c147c24fbf8452e">ML2DBaseProgram::do_ML3D</a></div><div class="ttdeci">bool do_ML3D</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00196">ml2d.h:196</a></div></div>
<div class="ttc" id="classMetaData_html_a2239fbb7e492654f1e2866ab27492a5d"><div class="ttname"><a href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">MetaData::getValue</a></div><div class="ttdeci">bool getValue(MDObject &amp;mdValueOut, size_t id) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00217">metadata.cpp:217</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ac53bad3c2339d92ebbda4ba5abe7aa57"><div class="ttname"><a href="classML2DBaseProgram.html#ac53bad3c2339d92ebbda4ba5abe7aa57">ML2DBaseProgram::nr_images_local</a></div><div class="ttdeci">size_t nr_images_local</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00166">ml2d.h:166</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a2fd51100d35db6ecdcb3ac704ab58435"><div class="ttname"><a href="classProgMLF2D.html#a2fd51100d35db6ecdcb3ac704ab58435">ProgMLF2D::refs_avgscale</a></div><div class="ttdeci">std::vector&lt; double &gt; refs_avgscale</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00148">mlf_align2d.h:148</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_add43d72480811707dcaa89df00324f42"><div class="ttname"><a href="classML2DBaseProgram.html#add43d72480811707dcaa89df00324f42">ML2DBaseProgram::spectral_signal</a></div><div class="ttdeci">MultidimArray&lt; double &gt; spectral_signal</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00253">ml2d.h:253</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a549ca4cda193eb449087f9a316c61f20"><div class="ttname"><a href="classML2DBaseProgram.html#a549ca4cda193eb449087f9a316c61f20">ML2DBaseProgram::limit_rot</a></div><div class="ttdeci">bool limit_rot</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00188">ml2d.h:188</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a791b7cb014db4297f7772becd1daa287"><div class="ttname"><a href="classML2DBaseProgram.html#a791b7cb014db4297f7772becd1daa287">ML2DBaseProgram::myFirstImg</a></div><div class="ttdeci">size_t myFirstImg</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00168">ml2d.h:168</a></div></div>
<div class="ttc" id="classProgMLF2D_html_abe2d74f54f4aa6916eb6f6d29164e023"><div class="ttname"><a href="classProgMLF2D.html#abe2d74f54f4aa6916eb6f6d29164e023">ProgMLF2D::Ictf</a></div><div class="ttdeci">std::vector&lt; Image&lt; double &gt; &gt; Ictf</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00085">mlf_align2d.h:85</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ae0d684b9bbe78bfa5ed5ad2610dc4fbe"><div class="ttname"><a href="classML2DBaseProgram.html#ae0d684b9bbe78bfa5ed5ad2610dc4fbe">ML2DBaseProgram::imgs_oldtheta</a></div><div class="ttdeci">std::vector&lt; double &gt; imgs_oldtheta</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00194">ml2d.h:194</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a26aeebe75887b4360c73659342f5dc61"><div class="ttname"><a href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a></div><div class="ttdeci">int in</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00053">image_find_center.cpp:53</a></div></div>
<div class="ttc" id="classMetaData_html_ad844b6a5655be4205e4bb03ab6372562"><div class="ttname"><a href="classMetaData.html#ad844b6a5655be4205e4bb03ab6372562">MetaData::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00702">metadata.cpp:702</a></div></div>
<div class="ttc" id="ml__refine3d_8cpp_html_a36c1b07f8f73f52294afe38445f71e17"><div class="ttname"><a href="ml__refine3d_8cpp.html#a36c1b07f8f73f52294afe38445f71e17">FN_ITER_BASE</a></div><div class="ttdeci">#define FN_ITER_BASE(iter)</div><div class="ttdef"><b>Definition:</b> <a href="ml__refine3d_8cpp_source.html#l00050">ml_refine3d.cpp:50</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a4f7d61fca21cd29df3119a200b9a4bd3"><div class="ttname"><a href="classML2DBaseProgram.html#a4f7d61fca21cd29df3119a200b9a4bd3">ML2DBaseProgram::do_restart</a></div><div class="ttdeci">bool do_restart</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00236">ml2d.h:236</a></div></div>
<div class="ttc" id="group__MetaData_html_ga85652b971edca3acc93a9f1bef2f17f6"><div class="ttname"><a href="group__MetaData.html#ga85652b971edca3acc93a9f1bef2f17f6">FOR_ALL_OBJECTS_IN_METADATA</a></div><div class="ttdeci">#define FOR_ALL_OBJECTS_IN_METADATA(__md)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00081">metadata.h:81</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa22981b63092f2ecbaee8984f0bc9867c"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa22981b63092f2ecbaee8984f0bc9867c">ERR_NUMERICAL</a></div><div class="ttdoc">Error related to numerical calculation. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00184">xmipp_error.h:184</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a0ddfa227d1aec7fcfd31cb2c23ec3d0f"><div class="ttname"><a href="classML2DBaseProgram.html#a0ddfa227d1aec7fcfd31cb2c23ec3d0f">ML2DBaseProgram::docfiledata</a></div><div class="ttdeci">MultidimArray&lt; double &gt; docfiledata</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00234">ml2d.h:234</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a04ca5ccf66605a78474081363ac48581"><div class="ttname"><a href="classProgMLF2D.html#a04ca5ccf66605a78474081363ac48581">ProgMLF2D::produceSideInfo2</a></div><div class="ttdeci">virtual void produceSideInfo2()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l00521">mlf_align2d.cpp:521</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_adb224115e7f853ead371caf7a3767fa4"><div class="ttname"><a href="classML2DBaseProgram.html#adb224115e7f853ead371caf7a3767fa4">ML2DBaseProgram::imgs_offsets</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; imgs_offsets</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00200">ml2d.h:200</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a495926025de4de5360efd7266377cc2c"><div class="ttname"><a href="classML2DBaseProgram.html#a495926025de4de5360efd7266377cc2c">ML2DBaseProgram::istart</a></div><div class="ttdeci">int istart</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00145">ml2d.h:145</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a0cf09cc5d8c9949acc48438be868773c"><div class="ttname"><a href="classProgMLF2D.html#a0cf09cc5d8c9949acc48438be868773c">ProgMLF2D::alpha_k</a></div><div class="ttdeci">std::vector&lt; double &gt; alpha_k</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00077">mlf_align2d.h:77</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a29c393fe6e00aa337783865f8694b0af"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a29c393fe6e00aa337783865f8694b0af">MDL_INTSCALE</a></div><div class="ttdoc">Intensity scale for an image. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00249">metadata_label.h:249</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ae96de19117479eb8bf594268bb9af590"><div class="ttname"><a href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">ML2DBaseProgram::dim</a></div><div class="ttdeci">size_t dim</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00151">ml2d.h:151</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a2d817d670cd567d427da30fad46f5592"><div class="ttname"><a href="classML2DBaseProgram.html#a2d817d670cd567d427da30fad46f5592">ML2DBaseProgram::imgs_oldphi</a></div><div class="ttdeci">std::vector&lt; double &gt; imgs_oldphi</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00194">ml2d.h:194</a></div></div>
<div class="ttc" id="group__Fourier_html_ga5fddf4cf6da360abdc8fd7d2f21fcbb9"><div class="ttname"><a href="group__Fourier.html#ga5fddf4cf6da360abdc8fd7d2f21fcbb9">FourierTransform</a></div><div class="ttdeci">void FourierTransform(const MultidimArray&lt; double &gt; &amp;in, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8cpp_source.html#l00124">xmipp_fft.cpp:124</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a619e2aed7d1934de3ce40d04b4d160b3"><div class="ttname"><a href="classProgMLF2D.html#a619e2aed7d1934de3ce40d04b4d160b3">ProgMLF2D::mirror_fraction</a></div><div class="ttdeci">std::vector&lt; double &gt; mirror_fraction</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00079">mlf_align2d.h:79</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ac45e6bbd1a035e75dc4f9bdb5b775ae0"><div class="ttname"><a href="classProgMLF2D.html#ac45e6bbd1a035e75dc4f9bdb5b775ae0">ProgMLF2D::nr_vols</a></div><div class="ttdeci">int nr_vols</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00150">mlf_align2d.h:150</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga53e37122134100316031eae982abee03"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a></div><div class="ttdeci">#define dAi(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00540">multidim_array.h:540</a></div></div>
<div class="ttc" id="xmipp__log_8h_html_a485ad250637a874aa112548b4133e8d0"><div class="ttname"><a href="xmipp__log_8h.html#a485ad250637a874aa112548b4133e8d0">LOG_LEVEL</a></div><div class="ttdeci">#define LOG_LEVEL(msg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__log_8h_source.html#l00089">xmipp_log.h:89</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aabda7431146b956debfa7f89164af1790"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aabda7431146b956debfa7f89164af1790">ERR_IO_NOTOPEN</a></div><div class="ttdoc">File cannot be open. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00142">xmipp_error.h:142</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a62caa148ed1109af0cf324ffec9ff2cd"><div class="ttname"><a href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">ML2DBaseProgram::MDref</a></div><div class="ttdeci">MetaData MDref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00172">ml2d.h:172</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a0a90a0680ddfe59efa8bac1303fada63"><div class="ttname"><a href="classProgMLF2D.html#a0a90a0680ddfe59efa8bac1303fada63">ProgMLF2D::sumw</a></div><div class="ttdeci">std::vector&lt; double &gt; sumw</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00156">mlf_align2d.h:156</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga82c19639b510d33894fe268664130410"><div class="ttname"><a href="group__GeometricalTransformations.html#ga82c19639b510d33894fe268664130410">radialAverage</a></div><div class="ttdeci">void radialAverage(const MultidimArray&lt; T &gt; &amp;m, Matrix1D&lt; int &gt; &amp;center_of_rot, MultidimArray&lt; T &gt; &amp;radial_mean, MultidimArray&lt; int &gt; &amp;radial_count, const bool &amp;rounding=false)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01575">transformations.h:1575</a></div></div>
<div class="ttc" id="classModelML2D_html_a29baa2fb66177265cb0de6d027ea454a"><div class="ttname"><a href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">ModelML2D::Iref</a></div><div class="ttdeci">std::vector&lt; Image&lt; double &gt; &gt; Iref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00085">ml2d.h:85</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; int &gt;</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a9544695d9d0054d6e75d62f227bee889"><div class="ttname"><a href="classML2DBaseProgram.html#a9544695d9d0054d6e75d62f227bee889">ML2DBaseProgram::fn_ref</a></div><div class="ttdeci">FileName fn_ref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00132">ml2d.h:132</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="xmipp__strings_8h_html_afbeda3fd1bdc8c37d01bdf9f5c8274ff"><div class="ttname"><a href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a></div><div class="ttdeci">std::string String</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__strings_8h_source.html#l00034">xmipp_strings.h:34</a></div></div>
<div class="ttc" id="classProgMLF2D_html_af1176823dd265484796aa9b52215719e"><div class="ttname"><a href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">ProgMLF2D::sampling</a></div><div class="ttdeci">double sampling</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00102">mlf_align2d.h:102</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gace9129bcfa1cd128950b15385abff09f"><div class="ttname"><a href="group__MLFalign2D.html#gace9129bcfa1cd128950b15385abff09f">FN_VSIG</a></div><div class="ttdeci">#define FN_VSIG(base, ifocus, ext)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00066">mlf_align2d.h:66</a></div></div>
<div class="ttc" id="classProgMLF2D_html_aba28a0ffa831626698f137197c961017"><div class="ttname"><a href="classProgMLF2D.html#aba28a0ffa831626698f137197c961017">ProgMLF2D::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00150">mlf_align2d.h:150</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ad9b9535e1774d805e5bbee89dee0f4b5"><div class="ttname"><a href="classML2DBaseProgram.html#ad9b9535e1774d805e5bbee89dee0f4b5">ML2DBaseProgram::do_mirror</a></div><div class="ttdeci">bool do_mirror</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00137">ml2d.h:137</a></div></div>
<div class="ttc" id="classImageBase_html_a88636b7a7bd4e0e454877e691ee2da84"><div class="ttname"><a href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">ImageBase::read</a></div><div class="ttdeci">int read(const FileName &amp;name, DataMode datamode=DATA, size_t select_img=ALL_IMAGES, bool mapData=false, int mode=WRITE_READONLY)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00061">xmipp_image_base.cpp:61</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a55332f697c74f72635ae850439407645"><div class="ttname"><a href="classML2DBaseProgram.html#a55332f697c74f72635ae850439407645">ML2DBaseProgram::nr_images_global</a></div><div class="ttdeci">size_t nr_images_global</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00164">ml2d.h:164</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a0704d0153add5aa8abcf3e82bb174ebc"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a0704d0153add5aa8abcf3e82bb174ebc">MDL_MIRRORFRAC</a></div><div class="ttdoc">Mirror fraction for a Maximum Likelihood model. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00280">metadata_label.h:280</a></div></div>
<div class="ttc" id="xmipp__funcs_8cpp_html_a6b2ac43eac850ac39594e8a5f5aa42fe"><div class="ttname"><a href="xmipp__funcs_8cpp.html#a6b2ac43eac850ac39594e8a5f5aa42fe">idum</a></div><div class="ttdeci">int idum</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00382">xmipp_funcs.cpp:382</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="ml2d_8h_html_a119f8d4cc2bfa19d21093a7694874226"><div class="ttname"><a href="ml2d_8h.html#a119f8d4cc2bfa19d21093a7694874226">DATALINELENGTH</a></div><div class="ttdeci">#define DATALINELENGTH</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00050">ml2d.h:50</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a5c75192acc215ccf8e062881d14f9ac4"><div class="ttname"><a href="classProgMLF2D.html#a5c75192acc215ccf8e062881d14f9ac4">ProgMLF2D::count_defocus</a></div><div class="ttdeci">std::vector&lt; int &gt; count_defocus</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00104">mlf_align2d.h:104</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ab1a1724f969e8cfca5c84d766366dd7b"><div class="ttname"><a href="classProgMLF2D.html#ab1a1724f969e8cfca5c84d766366dd7b">ProgMLF2D::updateWienerFilters</a></div><div class="ttdeci">void updateWienerFilters(const MultidimArray&lt; double &gt; &amp;spectral_signal, std::vector&lt; double &gt; &amp;sumw_defocus, int iter)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l00849">mlf_align2d.cpp:849</a></div></div>
<div class="ttc" id="group__FourierW_html_ga1075fe73c87077296a879f44ded3a2c3"><div class="ttname"><a href="group__FourierW.html#ga1075fe73c87077296a879f44ded3a2c3">FFT_magnitude</a></div><div class="ttdeci">void FFT_magnitude(const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;v, MultidimArray&lt; double &gt; &amp;mag)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00393">xmipp_fftw.cpp:393</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_aa53d160970e65511ba3f5d89db29b651"><div class="ttname"><a href="classML2DBaseProgram.html#aa53d160970e65511ba3f5d89db29b651">ML2DBaseProgram::Iold</a></div><div class="ttdeci">std::vector&lt; Image&lt; double &gt; &gt; Iold</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00176">ml2d.h:176</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gaea9964961fe272b8b7277239202912cb"><div class="ttname"><a href="group__MLFalign2D.html#gaea9964961fe272b8b7277239202912cb">VSIG_ITEM</a></div><div class="ttdeci">#define VSIG_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00049">mlf_align2d.h:49</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a></div><div class="ttdoc">Name of an image (std::string) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00235">metadata_label.h:235</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a783dd0b5e0db5a49b20a3334dc06a063"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a783dd0b5e0db5a49b20a3334dc06a063">MDL_MLF_NOISE</a></div><div class="ttdoc">MLF Wiener filter (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00291">metadata_label.h:291</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a8807f4c926a3e980249df162c9ff0bdf"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a8807f4c926a3e980249df162c9ff0bdf">MDL_WEIGHT</a></div><div class="ttdoc">&lt; Score 4 for volumes </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00448">metadata_label.h:448</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ab7caa861fcd7c5a139c0a0825c1abbe0"><div class="ttname"><a href="classML2DBaseProgram.html#ab7caa861fcd7c5a139c0a0825c1abbe0">ML2DBaseProgram::imgs_scale</a></div><div class="ttdeci">std::vector&lt; double &gt; imgs_scale</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00209">ml2d.h:209</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gadcb82c3ff44ffd9c34b67c3ca943613d"><div class="ttname"><a href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a></div><div class="ttdeci">#define FOR_ALL_MODELS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00036">mlf_align2d.h:36</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a5aad5b0a7bb75420f63794660d636454"><div class="ttname"><a href="classProgMLF2D.html#a5aad5b0a7bb75420f63794660d636454">ProgMLF2D::Vsig</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; double &gt; &gt; Vsig</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00110">mlf_align2d.h:110</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa07ffb6df1a5e91b43ea7786cd0717f5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::readParams </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read arguments from command line. </p>

<p>Reimplemented from <a class="el" href="classXmippProgram.html#a4f3c0b1ec483442cf6a2cba6666baa18">XmippProgram</a>.</p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l00088">88</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;{</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// Generate new command line for restart procedure</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a62698e9d68c10fa72db6deb1d3fc6794">cline</a> = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">int</span> argc2 = 0;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">char</span> ** argv2 = NULL;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordtype">double</span> restart_offset;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="classFileName.html">FileName</a> restart_imgmd, restart_refmd;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordtype">int</span> restart_iter, restart_seed;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a4f7d61fca21cd29df3119a200b9a4bd3">do_restart</a> = <a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--restart&quot;</span>);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a4f7d61fca21cd29df3119a200b9a4bd3">do_restart</a>)</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="classMetaData.html">MetaData</a> MDrestart;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordtype">char</span> *copy  = NULL;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        MDrestart.<a class="code" href="classMetaData.html#ab7f8d43d77647ade923e6cd63eafdd03">read</a>(<a class="code" href="group__Arguments.html#ga42227a0d5306b2b82e58b1952ab35976">getParameter</a>(<a class="code" href="classXmippProgram.html#a8659f9e603143c1788360f0eeb01e589">argc</a>, <a class="code" href="classXmippProgram.html#af2f60708934c302e1289c5405109dd45">argv</a>, <span class="stringliteral">&quot;--restart&quot;</span>));</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a62698e9d68c10fa72db6deb1d3fc6794">cline</a> = MDrestart.<a class="code" href="classMetaData.html#a69a3ae9ad876f6f2815441d0ccb7af21">getComment</a>();</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordtype">size_t</span> <span class="keywordtype">id</span> = MDrestart.<a class="code" href="classMetaData.html#a9f88f42faff8bfbc1952c50e2a6ffc42">firstObject</a>();</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        MDrestart.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a44d2f7bdda1efb37f9218b2ac4eb8a2c">MDL_SIGMAOFFSET</a>, restart_offset, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        MDrestart.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a003b068e945b0d00e98a00685b672690">MDL_IMGMD</a>, restart_imgmd, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        MDrestart.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a4ed32444569d43daf31cb11b992ddb9c">MDL_REFMD</a>, restart_refmd, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        MDrestart.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78abbbbb24eaf2b80e9a7ed50bd6075e833">MDL_ITER</a>, restart_iter, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        MDrestart.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a31de7898d23a11e9b1b2ba4cc816d365">MDL_RANDOMSEED</a>, restart_seed, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="comment">//MDrestart.getValue(MDL_SIGMANOISE, restart_noise);</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <a class="code" href="group__Arguments.html#ga472c9cd1c4c73bb26544dee1898de793">generateCommandLine</a>(<a class="code" href="classML2DBaseProgram.html#a62698e9d68c10fa72db6deb1d3fc6794">cline</a>, argc2, argv2, copy);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="comment">// no restart, just copy argc to argc2 and argv to argv2</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        argc2 = <a class="code" href="classXmippProgram.html#a8659f9e603143c1788360f0eeb01e589">argc</a>;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        argv2 = (<span class="keywordtype">char</span> **)<a class="code" href="classXmippProgram.html#af2f60708934c302e1289c5405109dd45">argv</a>;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; argc2; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <a class="code" href="classML2DBaseProgram.html#a62698e9d68c10fa72db6deb1d3fc6794">cline</a> = <a class="code" href="classML2DBaseProgram.html#a62698e9d68c10fa72db6deb1d3fc6794">cline</a> + (<a class="code" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a>)argv2[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] + <span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// Number of threads</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="classML2DBaseProgram.html#af249c63e39331ba0e4dfbcd39cafdce9">threads</a> = <a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--thr&quot;</span>);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// Main parameters</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a> = <a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--nref&quot;</span>);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a9544695d9d0054d6e75d62f227bee889">fn_ref</a> = <a class="code" href="classXmippProgram.html#a5d9e1f008822effa47814c59e9a3c797">getParam</a>(<span class="stringliteral">&quot;--ref&quot;</span>);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a4e593a9112ddcc0256bc9b72213cdb3b">fn_img</a> = <a class="code" href="classXmippProgram.html#a5d9e1f008822effa47814c59e9a3c797">getParam</a>(<span class="stringliteral">&quot;-i&quot;</span>);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a> = <a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--no_ctf&quot;</span>);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">do_ctf_correction</a> = !<a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>;<span class="comment">//checkParam(&quot;--no_ctf&quot;);</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a> = <a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--sampling_rate&quot;</span>) ? <a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--sampling_rate&quot;</span>) : -1;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="classML2DBaseProgram.html#adfab8933f95443ac6d909a9b206b3fa8">fn_root</a> = <a class="code" href="classXmippProgram.html#a5d9e1f008822effa47814c59e9a3c797">getParam</a>(<span class="stringliteral">&quot;--oroot&quot;</span>);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="classProgMLF2D.html#a13f69696df08368a14b8928b60faaad7">search_shift</a> = <a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--search_shift&quot;</span>);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="classML2DBaseProgram.html#aae259850c9b209a3ff3cbcc7799e2742">psi_step</a> = <a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--psi_step&quot;</span>);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="classML2DBaseProgram.html#ad9b9535e1774d805e5bbee89dee0f4b5">do_mirror</a> = <a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--mirror&quot;</span>);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="classProgMLF2D.html#a552a32e4f5ff63eda3ffa4708eef6f67">ini_highres_limit</a> = <a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--limit_resolution&quot;</span>, 0);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="classProgMLF2D.html#a27f1ed8b93ea62c3e3727f7fa57f41b8">highres_limit</a> = <a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--limit_resolution&quot;</span>, 1);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="classProgMLF2D.html#a0c5751afdfd3fe27554492356c09a58c">lowres_limit</a> = <a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--limit_resolution&quot;</span>, 2);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="classProgMLF2D.html#a9c504b96e173e1eeb6cda09a00e5b638">phase_flipped</a> = !<a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--not_phase_flipped&quot;</span>);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="classProgMLF2D.html#a19dbbebd916d67da0d3e0ce5c9d77993">reduce_snr</a> = <a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--reduce_snr&quot;</span>);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="classProgMLF2D.html#a5e967d6a01f0dcdce99c62e591bb7995">first_iter_noctf</a> = <a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--ctf_affected_refs&quot;</span>);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// Less common stuff</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a027f02ad68a63785c0ef49fa1b9db759">Niter</a> = <a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--iter&quot;</span>);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a495926025de4de5360efd7266377cc2c">istart</a> = <a class="code" href="classML2DBaseProgram.html#a963af5cdb6f63d876c147c24fbf8452e">do_ML3D</a> ? 1 : <a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--restart&quot;</span>);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="classProgMLF2D.html#a0177d3113415179168699efda64bd860">sigma_offset</a> = <a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--offset&quot;</span>);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a909478a47c338d181693f9421ecb4bd3">eps</a> = <a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--eps&quot;</span>);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="classML2DBaseProgram.html#abf6ec880b915a0887a9e0a864c3ff467">fn_frac</a> = <a class="code" href="classXmippProgram.html#a5d9e1f008822effa47814c59e9a3c797">getParam</a>(<span class="stringliteral">&quot;--frac&quot;</span>);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a6f89b87041906702ae5c30638bd2762c">fix_fractions</a> = <a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--fix_fractions&quot;</span>);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a3c0fde6f9005eec528cc1f703019719c">fix_sigma_offset</a> = <a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--fix_sigma_offset&quot;</span>);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a4646a8113c64d86101389cb4f373bca3">fix_sigma_noise</a> = <a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--fix_sigma_noise&quot;</span>);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a67faef1c7bbe1544c7f51e4d4fa0e833">C_fast</a> = <a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;-C&quot;</span>);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">//fn_doc = getParam(&quot;--doc&quot;);</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="classProgMLF2D.html#a33a7368df74c02b48043acaed12b3ce7">do_include_allfreqs</a> = <a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--include_allfreqs&quot;</span>);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="classProgMLF2D.html#a77ca59aeaa398779a7f562940d1363a2">fix_high</a> = <a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--fix_high&quot;</span>);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a4ca3328df09f636935d22b5b946a3704">search_rot</a> = <a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--search_rot&quot;</span>);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// Hidden arguments</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="classXmippProgram.html#a0130b89f1f5431b03ef161d7e231bd48">debug</a> = <a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--debug&quot;</span>);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="classProgMLF2D.html#ac06a02372d68274fa8fb58dab620db9a">do_variable_psi</a> = <a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--var_psi&quot;</span>);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="classProgMLF2D.html#aef9b9f1aff83b4d111cf2a8be84d4c07">do_variable_trans</a> = <a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--var_trans&quot;</span>);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">do_norm</a> = <a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--norm&quot;</span>);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a> = <a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--student&quot;</span>);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a> = <a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--student&quot;</span>);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="classProgMLF2D.html#aad176d8656485e60ed725b2754a070aa">do_student_sigma_trick</a> = !<a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--no_sigma_trick&quot;</span>);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="classProgMLF2D.html#a79873ba6ac0a02ebff149285475a8721">do_kstest</a> = <a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--kstest&quot;</span>);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="classProgMLF2D.html#a1bd3c9e0f12cfa45daa109e0c96c3f28">iter_write_histograms</a> = <a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--iter_histogram&quot;</span>);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="classXmippProgram.html#a51ae38ef10274f8f7c6c02ab2a67a28c">seed</a> = <a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--random_seed&quot;</span>);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">// Now reset some stuff for restart</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a4f7d61fca21cd29df3119a200b9a4bd3">do_restart</a>)</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a4e593a9112ddcc0256bc9b72213cdb3b">fn_img</a> = restart_imgmd;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a9544695d9d0054d6e75d62f227bee889">fn_ref</a> = restart_refmd;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a> = 0; <span class="comment">// Just to be sure (not strictly necessary)</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <a class="code" href="classProgMLF2D.html#a0177d3113415179168699efda64bd860">sigma_offset</a> = restart_offset;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="comment">//sigma_noise = restart_noise;</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <a class="code" href="classXmippProgram.html#a51ae38ef10274f8f7c6c02ab2a67a28c">seed</a> = restart_seed;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a495926025de4de5360efd7266377cc2c">istart</a> = restart_iter + 1;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classXmippProgram.html#a51ae38ef10274f8f7c6c02ab2a67a28c">seed</a> == -1)</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <a class="code" href="classXmippProgram.html#a51ae38ef10274f8f7c6c02ab2a67a28c">seed</a> = time(NULL);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;}</div><div class="ttc" id="classProgMLF2D_html_a8402eab40b0e66cd7aee78b747720af9"><div class="ttname"><a href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">ProgMLF2D::do_student</a></div><div class="ttdeci">bool do_student</div><div class="ttdoc">IN DEVELOPMENT. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00135">mlf_align2d.h:135</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a0c5751afdfd3fe27554492356c09a58c"><div class="ttname"><a href="classProgMLF2D.html#a0c5751afdfd3fe27554492356c09a58c">ProgMLF2D::lowres_limit</a></div><div class="ttdeci">double lowres_limit</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00116">mlf_align2d.h:116</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a4ed32444569d43daf31cb11b992ddb9c"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a4ed32444569d43daf31cb11b992ddb9c">MDL_REFMD</a></div><div class="ttdoc">Name of Metadata file for all references(string) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00365">metadata_label.h:365</a></div></div>
<div class="ttc" id="classMetaData_html_a69a3ae9ad876f6f2815441d0ccb7af21"><div class="ttname"><a href="classMetaData.html#a69a3ae9ad876f6f2815441d0ccb7af21">MetaData::getComment</a></div><div class="ttdeci">String getComment() const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00636">metadata.cpp:636</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a77ca59aeaa398779a7f562940d1363a2"><div class="ttname"><a href="classProgMLF2D.html#a77ca59aeaa398779a7f562940d1363a2">ProgMLF2D::fix_high</a></div><div class="ttdeci">double fix_high</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00124">mlf_align2d.h:124</a></div></div>
<div class="ttc" id="classXmippProgram_html_a552e1ea4a84576d9149b965d9edb6277"><div class="ttname"><a href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">XmippProgram::getDoubleParam</a></div><div class="ttdeci">double getDoubleParam(const char *param, int arg=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00397">xmipp_program.cpp:397</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a27f1ed8b93ea62c3e3727f7fa57f41b8"><div class="ttname"><a href="classProgMLF2D.html#a27f1ed8b93ea62c3e3727f7fa57f41b8">ProgMLF2D::highres_limit</a></div><div class="ttdeci">double highres_limit</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00116">mlf_align2d.h:116</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a5578230b3fb9e054c437e187cb0ad5d3"><div class="ttname"><a href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">ML2DBaseProgram::model</a></div><div class="ttdeci">ModelML2D model</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00224">ml2d.h:224</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ac06a02372d68274fa8fb58dab620db9a"><div class="ttname"><a href="classProgMLF2D.html#ac06a02372d68274fa8fb58dab620db9a">ProgMLF2D::do_variable_psi</a></div><div class="ttdeci">bool do_variable_psi</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00083">mlf_align2d.h:83</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a6f89b87041906702ae5c30638bd2762c"><div class="ttname"><a href="classML2DBaseProgram.html#a6f89b87041906702ae5c30638bd2762c">ML2DBaseProgram::fix_fractions</a></div><div class="ttdeci">bool fix_fractions</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00139">ml2d.h:139</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a13f69696df08368a14b8928b60faaad7"><div class="ttname"><a href="classProgMLF2D.html#a13f69696df08368a14b8928b60faaad7">ProgMLF2D::search_shift</a></div><div class="ttdeci">int search_shift</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00093">mlf_align2d.h:93</a></div></div>
<div class="ttc" id="classMetaData_html"><div class="ttname"><a href="classMetaData.html">MetaData</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00234">metadata.h:234</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a4e593a9112ddcc0256bc9b72213cdb3b"><div class="ttname"><a href="classML2DBaseProgram.html#a4e593a9112ddcc0256bc9b72213cdb3b">ML2DBaseProgram::fn_img</a></div><div class="ttdeci">FileName fn_img</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00132">ml2d.h:132</a></div></div>
<div class="ttc" id="classModelML2D_html_a63a3a3534d1cb72a9db046508b9a59f6"><div class="ttname"><a href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">ModelML2D::n_ref</a></div><div class="ttdeci">int n_ref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00083">ml2d.h:83</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_aae259850c9b209a3ff3cbcc7799e2742"><div class="ttname"><a href="classML2DBaseProgram.html#aae259850c9b209a3ff3cbcc7799e2742">ML2DBaseProgram::psi_step</a></div><div class="ttdeci">double psi_step</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00158">ml2d.h:158</a></div></div>
<div class="ttc" id="classMetaData_html_ab7f8d43d77647ade923e6cd63eafdd03"><div class="ttname"><a href="classMetaData.html#ab7f8d43d77647ade923e6cd63eafdd03">MetaData::read</a></div><div class="ttdeci">void read(const FileName &amp;inFile, const std::vector&lt; MDLabel &gt; *desiredLabels=NULL, bool decomposeStack=true)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l01447">metadata.cpp:1447</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a5e967d6a01f0dcdce99c62e591bb7995"><div class="ttname"><a href="classProgMLF2D.html#a5e967d6a01f0dcdce99c62e591bb7995">ProgMLF2D::first_iter_noctf</a></div><div class="ttdeci">bool first_iter_noctf</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00118">mlf_align2d.h:118</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_adfab8933f95443ac6d909a9b206b3fa8"><div class="ttname"><a href="classML2DBaseProgram.html#adfab8933f95443ac6d909a9b206b3fa8">ML2DBaseProgram::fn_root</a></div><div class="ttdeci">FileName fn_root</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00132">ml2d.h:132</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a1bd3c9e0f12cfa45daa109e0c96c3f28"><div class="ttname"><a href="classProgMLF2D.html#a1bd3c9e0f12cfa45daa109e0c96c3f28">ProgMLF2D::iter_write_histograms</a></div><div class="ttdeci">int iter_write_histograms</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00143">mlf_align2d.h:143</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00068">xmipp_filename.h:68</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a19dbbebd916d67da0d3e0ce5c9d77993"><div class="ttname"><a href="classProgMLF2D.html#a19dbbebd916d67da0d3e0ce5c9d77993">ProgMLF2D::reduce_snr</a></div><div class="ttdeci">double reduce_snr</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00112">mlf_align2d.h:112</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a9e143fabdc67d1ee8cd67dcad98e74fc"><div class="ttname"><a href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">ML2DBaseProgram::do_norm</a></div><div class="ttdeci">bool do_norm</div><div class="ttdoc">Re-normalize internally. </div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00207">ml2d.h:207</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a963af5cdb6f63d876c147c24fbf8452e"><div class="ttname"><a href="classML2DBaseProgram.html#a963af5cdb6f63d876c147c24fbf8452e">ML2DBaseProgram::do_ML3D</a></div><div class="ttdeci">bool do_ML3D</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00196">ml2d.h:196</a></div></div>
<div class="ttc" id="classMetaData_html_a2239fbb7e492654f1e2866ab27492a5d"><div class="ttname"><a href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">MetaData::getValue</a></div><div class="ttdeci">bool getValue(MDObject &amp;mdValueOut, size_t id) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00217">metadata.cpp:217</a></div></div>
<div class="ttc" id="classProgMLF2D_html_aef9b9f1aff83b4d111cf2a8be84d4c07"><div class="ttname"><a href="classProgMLF2D.html#aef9b9f1aff83b4d111cf2a8be84d4c07">ProgMLF2D::do_variable_trans</a></div><div class="ttdeci">bool do_variable_trans</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00083">mlf_align2d.h:83</a></div></div>
<div class="ttc" id="classXmippProgram_html_a8659f9e603143c1788360f0eeb01e589"><div class="ttname"><a href="classXmippProgram.html#a8659f9e603143c1788360f0eeb01e589">XmippProgram::argc</a></div><div class="ttdeci">int argc</div><div class="ttdoc">Original command line arguments. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8h_source.html#l00095">xmipp_program.h:95</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a4ca3328df09f636935d22b5b946a3704"><div class="ttname"><a href="classML2DBaseProgram.html#a4ca3328df09f636935d22b5b946a3704">ML2DBaseProgram::search_rot</a></div><div class="ttdeci">double search_rot</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00190">ml2d.h:190</a></div></div>
<div class="ttc" id="group__Arguments_html_ga42227a0d5306b2b82e58b1952ab35976"><div class="ttname"><a href="group__Arguments.html#ga42227a0d5306b2b82e58b1952ab35976">getParameter</a></div><div class="ttdeci">const char * getParameter(int argc, const char **argv, const char *param, const char *option)</div><div class="ttdef"><b>Definition:</b> <a href="args_8cpp_source.html#l00030">args.cpp:30</a></div></div>
<div class="ttc" id="classXmippProgram_html_a5d9e1f008822effa47814c59e9a3c797"><div class="ttname"><a href="classXmippProgram.html#a5d9e1f008822effa47814c59e9a3c797">XmippProgram::getParam</a></div><div class="ttdeci">const char * getParam(const char *param, int arg=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00377">xmipp_program.cpp:377</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a79873ba6ac0a02ebff149285475a8721"><div class="ttname"><a href="classProgMLF2D.html#a79873ba6ac0a02ebff149285475a8721">ProgMLF2D::do_kstest</a></div><div class="ttdeci">bool do_kstest</div><div class="ttdoc">Statistical analysis of the noise distributions. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00141">mlf_align2d.h:141</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a027f02ad68a63785c0ef49fa1b9db759"><div class="ttname"><a href="classML2DBaseProgram.html#a027f02ad68a63785c0ef49fa1b9db759">ML2DBaseProgram::Niter</a></div><div class="ttdeci">int Niter</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00149">ml2d.h:149</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a9c504b96e173e1eeb6cda09a00e5b638"><div class="ttname"><a href="classProgMLF2D.html#a9c504b96e173e1eeb6cda09a00e5b638">ProgMLF2D::phase_flipped</a></div><div class="ttdeci">bool phase_flipped</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00106">mlf_align2d.h:106</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a4f7d61fca21cd29df3119a200b9a4bd3"><div class="ttname"><a href="classML2DBaseProgram.html#a4f7d61fca21cd29df3119a200b9a4bd3">ML2DBaseProgram::do_restart</a></div><div class="ttdeci">bool do_restart</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00236">ml2d.h:236</a></div></div>
<div class="ttc" id="classProgMLF2D_html_aad176d8656485e60ed725b2754a070aa"><div class="ttname"><a href="classProgMLF2D.html#aad176d8656485e60ed725b2754a070aa">ProgMLF2D::do_student_sigma_trick</a></div><div class="ttdeci">bool do_student_sigma_trick</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00137">mlf_align2d.h:137</a></div></div>
<div class="ttc" id="classXmippProgram_html_af2f60708934c302e1289c5405109dd45"><div class="ttname"><a href="classXmippProgram.html#af2f60708934c302e1289c5405109dd45">XmippProgram::argv</a></div><div class="ttdeci">const char ** argv</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8h_source.html#l00096">xmipp_program.h:96</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a0177d3113415179168699efda64bd860"><div class="ttname"><a href="classProgMLF2D.html#a0177d3113415179168699efda64bd860">ProgMLF2D::sigma_offset</a></div><div class="ttdeci">double sigma_offset</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00075">mlf_align2d.h:75</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a33a7368df74c02b48043acaed12b3ce7"><div class="ttname"><a href="classProgMLF2D.html#a33a7368df74c02b48043acaed12b3ce7">ProgMLF2D::do_include_allfreqs</a></div><div class="ttdeci">bool do_include_allfreqs</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00122">mlf_align2d.h:122</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a495926025de4de5360efd7266377cc2c"><div class="ttname"><a href="classML2DBaseProgram.html#a495926025de4de5360efd7266377cc2c">ML2DBaseProgram::istart</a></div><div class="ttdeci">int istart</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00145">ml2d.h:145</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a8671946de2e241de54a47e2822989ca1"><div class="ttname"><a href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">ML2DBaseProgram::df</a></div><div class="ttdeci">double df</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00204">ml2d.h:204</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a7c3f7c47054265ad3589ee6d40764fbc"><div class="ttname"><a href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">ProgMLF2D::do_ctf_correction</a></div><div class="ttdeci">bool do_ctf_correction</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00100">mlf_align2d.h:100</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a44d2f7bdda1efb37f9218b2ac4eb8a2c"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a44d2f7bdda1efb37f9218b2ac4eb8a2c">MDL_SIGMAOFFSET</a></div><div class="ttdoc">Standard deviation of the offsets in ML model. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00423">metadata_label.h:423</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a4646a8113c64d86101389cb4f373bca3"><div class="ttname"><a href="classML2DBaseProgram.html#a4646a8113c64d86101389cb4f373bca3">ML2DBaseProgram::fix_sigma_noise</a></div><div class="ttdeci">bool fix_sigma_noise</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00143">ml2d.h:143</a></div></div>
<div class="ttc" id="classXmippProgram_html_a0130b89f1f5431b03ef161d7e231bd48"><div class="ttname"><a href="classXmippProgram.html#a0130b89f1f5431b03ef161d7e231bd48">XmippProgram::debug</a></div><div class="ttdeci">int debug</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8h_source.html#l00170">xmipp_program.h:170</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_abf6ec880b915a0887a9e0a864c3ff467"><div class="ttname"><a href="classML2DBaseProgram.html#abf6ec880b915a0887a9e0a864c3ff467">ML2DBaseProgram::fn_frac</a></div><div class="ttdeci">FileName fn_frac</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00132">ml2d.h:132</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a003b068e945b0d00e98a00685b672690"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a003b068e945b0d00e98a00685b672690">MDL_IMGMD</a></div><div class="ttdoc">Name of Metadata file for all images (string) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00243">metadata_label.h:243</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a67faef1c7bbe1544c7f51e4d4fa0e833"><div class="ttname"><a href="classML2DBaseProgram.html#a67faef1c7bbe1544c7f51e4d4fa0e833">ML2DBaseProgram::C_fast</a></div><div class="ttdeci">double C_fast</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00182">ml2d.h:182</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a9544695d9d0054d6e75d62f227bee889"><div class="ttname"><a href="classML2DBaseProgram.html#a9544695d9d0054d6e75d62f227bee889">ML2DBaseProgram::fn_ref</a></div><div class="ttdeci">FileName fn_ref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00132">ml2d.h:132</a></div></div>
<div class="ttc" id="xmipp__strings_8h_html_afbeda3fd1bdc8c37d01bdf9f5c8274ff"><div class="ttname"><a href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a></div><div class="ttdeci">std::string String</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__strings_8h_source.html#l00034">xmipp_strings.h:34</a></div></div>
<div class="ttc" id="classProgMLF2D_html_af1176823dd265484796aa9b52215719e"><div class="ttname"><a href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">ProgMLF2D::sampling</a></div><div class="ttdeci">double sampling</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00102">mlf_align2d.h:102</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ad9b9535e1774d805e5bbee89dee0f4b5"><div class="ttname"><a href="classML2DBaseProgram.html#ad9b9535e1774d805e5bbee89dee0f4b5">ML2DBaseProgram::do_mirror</a></div><div class="ttdeci">bool do_mirror</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00137">ml2d.h:137</a></div></div>
<div class="ttc" id="classXmippProgram_html_a51ae38ef10274f8f7c6c02ab2a67a28c"><div class="ttname"><a href="classXmippProgram.html#a51ae38ef10274f8f7c6c02ab2a67a28c">XmippProgram::seed</a></div><div class="ttdeci">int seed</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8h_source.html#l00170">xmipp_program.h:170</a></div></div>
<div class="ttc" id="classXmippProgram_html_a1a27c450de95c55d122be23e3fe89ac1"><div class="ttname"><a href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">XmippProgram::checkParam</a></div><div class="ttdeci">bool checkParam(const char *param)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00425">xmipp_program.cpp:425</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a3c0fde6f9005eec528cc1f703019719c"><div class="ttname"><a href="classML2DBaseProgram.html#a3c0fde6f9005eec528cc1f703019719c">ML2DBaseProgram::fix_sigma_offset</a></div><div class="ttdeci">bool fix_sigma_offset</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00141">ml2d.h:141</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78abbbbb24eaf2b80e9a7ed50bd6075e833"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78abbbbb24eaf2b80e9a7ed50bd6075e833">MDL_ITER</a></div><div class="ttdoc">Current iteration number (int) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00251">metadata_label.h:251</a></div></div>
<div class="ttc" id="classXmippProgram_html_a7b7ddf0836dc1079ea2622e2a420c39c"><div class="ttname"><a href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">XmippProgram::getIntParam</a></div><div class="ttdeci">int getIntParam(const char *param, int arg=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00387">xmipp_program.cpp:387</a></div></div>
<div class="ttc" id="classMetaData_html_a9f88f42faff8bfbc1952c50e2a6ffc42"><div class="ttname"><a href="classMetaData.html#a9f88f42faff8bfbc1952c50e2a6ffc42">MetaData::firstObject</a></div><div class="ttdeci">size_t firstObject() const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00849">metadata.cpp:849</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_af249c63e39331ba0e4dfbcd39cafdce9"><div class="ttname"><a href="classML2DBaseProgram.html#af249c63e39331ba0e4dfbcd39cafdce9">ML2DBaseProgram::threads</a></div><div class="ttdeci">int threads</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00244">ml2d.h:244</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af2a333b1670df64a88d3a2f22210d155"><div class="ttname"><a href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a></div><div class="ttdeci">doublereal * a</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a909478a47c338d181693f9421ecb4bd3"><div class="ttname"><a href="classML2DBaseProgram.html#a909478a47c338d181693f9421ecb4bd3">ML2DBaseProgram::eps</a></div><div class="ttdeci">double eps</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00170">ml2d.h:170</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a552a32e4f5ff63eda3ffa4708eef6f67"><div class="ttname"><a href="classProgMLF2D.html#a552a32e4f5ff63eda3ffa4708eef6f67">ProgMLF2D::ini_highres_limit</a></div><div class="ttdeci">double ini_highres_limit</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00116">mlf_align2d.h:116</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a62698e9d68c10fa72db6deb1d3fc6794"><div class="ttname"><a href="classML2DBaseProgram.html#a62698e9d68c10fa72db6deb1d3fc6794">ML2DBaseProgram::cline</a></div><div class="ttdeci">String cline</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00134">ml2d.h:134</a></div></div>
<div class="ttc" id="group__Arguments_html_ga472c9cd1c4c73bb26544dee1898de793"><div class="ttname"><a href="group__Arguments.html#ga472c9cd1c4c73bb26544dee1898de793">generateCommandLine</a></div><div class="ttdeci">void generateCommandLine(const std::string &amp;command_line, int &amp;argcp, char **&amp;argvp, char *&amp;copy)</div><div class="ttdef"><b>Definition:</b> <a href="args_8cpp_source.html#l00239">args.cpp:239</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a31de7898d23a11e9b1b2ba4cc816d365"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a31de7898d23a11e9b1b2ba4cc816d365">MDL_RANDOMSEED</a></div><div class="ttdoc">Seed for random number generator. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00361">metadata_label.h:361</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a191c8f337bb393b5c8ea9d45e1e7b1a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::reverseRotateReference </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply reverse rotations to all matrices in vector and fill new matrix with their sum. </p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l01375">1375</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;{</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Maux, Maux2;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;std::complex&lt;double&gt;</a> &gt; Faux;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    Maux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>, <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>);</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    Maux2.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>, <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>);</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    Maux.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    Maux2.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    out.clear();</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <a class="code" href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a>()</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    {</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;        Maux.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        out.push_back(Maux);</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        <a class="code" href="group__MLFalign2D.html#gae1d499e9328ad87a22b0cafeae0f1f01">FOR_ALL_ROTATIONS</a>()</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        {</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;            <span class="comment">// Add arbitrary number to avoid 0-degree rotation without interpolation effects</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;            psi = (double)(ipsi * <a class="code" href="classML2DBaseProgram.html#a2ab21717291173f3155a2e4006137167">psi_max</a> / <a class="code" href="classML2DBaseProgram.html#a976dc404489a0c66af2800f0f73e76c7">nr_psi</a>) + <a class="code" href="ml2d_8h.html#a6b49ded9ade4e2a8b65b16670db60486">SMALLANGLE</a>;</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;            <a class="code" href="classProgMLF2D.html#ae249382ce2eb9eb7d6fc5b547041805d">getFTfromVector</a>(<a class="code" href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a>, refno*<a class="code" href="classML2DBaseProgram.html#a976dc404489a0c66af2800f0f73e76c7">nr_psi</a>*<a class="code" href="classProgMLF2D.html#a2839dd97c6d6098e665b16bed661b615">dnr_points_2d</a> + ipsi*<a class="code" href="classProgMLF2D.html#a2839dd97c6d6098e665b16bed661b615">dnr_points_2d</a>, Faux);</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            <a class="code" href="group__Fourier.html#ga23b1980119bde3c22bc8a96676fa1cb6">InverseFourierTransformHalf</a>(Faux, Maux, <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>);</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;            <span class="comment">//Maux.rotateBSpline(3, -psi, Maux2, WRAP);</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;            <a class="code" href="classification_2pca_8cpp.html#ae5e08c2a7a15204653d0fdaabbc890ac">rotate</a>(<a class="code" href="group__GeometricalTransformations.html#gab8a49d8335f45ebd2ba7d86d98322bc0">BSPLINE3</a>, Maux2, Maux, psi, <span class="charliteral">&#39;Z&#39;</span>, <a class="code" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a>);</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;            out[refno] += Maux2;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;        }</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    }</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;}</div><div class="ttc" id="classML2DBaseProgram_html_a976dc404489a0c66af2800f0f73e76c7"><div class="ttname"><a href="classML2DBaseProgram.html#a976dc404489a0c66af2800f0f73e76c7">ML2DBaseProgram::nr_psi</a></div><div class="ttdeci">size_t nr_psi</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00154">ml2d.h:154</a></div></div>
<div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="transformations_8h_html_a43c1de45dbd91827a260224c9c40221b"><div class="ttname"><a href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a></div><div class="ttdeci">#define WRAP</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00043">transformations.h:43</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a2ab21717291173f3155a2e4006137167"><div class="ttname"><a href="classML2DBaseProgram.html#a2ab21717291173f3155a2e4006137167">ML2DBaseProgram::psi_max</a></div><div class="ttdeci">double psi_max</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00160">ml2d.h:160</a></div></div>
<div class="ttc" id="ml2d_8h_html_a6b49ded9ade4e2a8b65b16670db60486"><div class="ttname"><a href="ml2d_8h.html#a6b49ded9ade4e2a8b65b16670db60486">SMALLANGLE</a></div><div class="ttdeci">#define SMALLANGLE</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00049">ml2d.h:49</a></div></div>
<div class="ttc" id="classification_2pca_8cpp_html_ae5e08c2a7a15204653d0fdaabbc890ac"><div class="ttname"><a href="classification_2pca_8cpp.html#ae5e08c2a7a15204653d0fdaabbc890ac">rotate</a></div><div class="ttdeci">#define rotate(a, i, j, k, l)</div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a2839dd97c6d6098e665b16bed661b615"><div class="ttname"><a href="classProgMLF2D.html#a2839dd97c6d6098e665b16bed661b615">ProgMLF2D::dnr_points_2d</a></div><div class="ttdeci">size_t dnr_points_2d</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00127">mlf_align2d.h:127</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a26aeebe75887b4360c73659342f5dc61"><div class="ttname"><a href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a></div><div class="ttdeci">int in</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00053">image_find_center.cpp:53</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gae1d499e9328ad87a22b0cafeae0f1f01"><div class="ttname"><a href="group__MLFalign2D.html#gae1d499e9328ad87a22b0cafeae0f1f01">FOR_ALL_ROTATIONS</a></div><div class="ttdeci">#define FOR_ALL_ROTATIONS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00037">mlf_align2d.h:37</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ae96de19117479eb8bf594268bb9af590"><div class="ttname"><a href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">ML2DBaseProgram::dim</a></div><div class="ttdeci">size_t dim</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00151">ml2d.h:151</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gab8a49d8335f45ebd2ba7d86d98322bc0"><div class="ttname"><a href="group__GeometricalTransformations.html#gab8a49d8335f45ebd2ba7d86d98322bc0">BSPLINE3</a></div><div class="ttdeci">#define BSPLINE3</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00210">transformations.h:210</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ae249382ce2eb9eb7d6fc5b547041805d"><div class="ttname"><a href="classProgMLF2D.html#ae249382ce2eb9eb7d6fc5b547041805d">ProgMLF2D::getFTfromVector</a></div><div class="ttdeci">void getFTfromVector(const std::vector&lt; double &gt; &amp;in, const int start_point, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;out, bool only_real=false)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l01298">mlf_align2d.cpp:1298</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="group__Fourier_html_ga23b1980119bde3c22bc8a96676fa1cb6"><div class="ttname"><a href="group__Fourier.html#ga23b1980119bde3c22bc8a96676fa1cb6">InverseFourierTransformHalf</a></div><div class="ttdeci">void InverseFourierTransformHalf(const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;in, MultidimArray&lt; double &gt; &amp;out, int oridim)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8cpp_source.html#l00197">xmipp_fft.cpp:197</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gadcb82c3ff44ffd9c34b67c3ca943613d"><div class="ttname"><a href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a></div><div class="ttdeci">#define FOR_ALL_MODELS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00036">mlf_align2d.h:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4518fb4fdc375d19d4439d32a6a60d71"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::rotateReference </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>out</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill vector of matrices with all rotations of reference. </p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l01330">1330</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;{</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    out.clear();</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="keywordtype">double</span> AA, stdAA, <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Maux;</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;std::complex&lt;double&gt;</a> &gt; Faux;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    Maux.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>, <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>);</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    Maux.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <a class="code" href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a>()</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    {</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        <a class="code" href="group__MLFalign2D.html#gae1d499e9328ad87a22b0cafeae0f1f01">FOR_ALL_ROTATIONS</a>()</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        {</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;            <span class="comment">// Add arbitrary number (small_angle) to avoid 0-degree rotation (lacking interpolation)</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;            psi = (double)(ipsi * <a class="code" href="classML2DBaseProgram.html#a2ab21717291173f3155a2e4006137167">psi_max</a> / <a class="code" href="classML2DBaseProgram.html#a976dc404489a0c66af2800f0f73e76c7">nr_psi</a>) + <a class="code" href="ml2d_8h.html#a6b49ded9ade4e2a8b65b16670db60486">SMALLANGLE</a>;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;            <span class="comment">//model.Iref[refno]().rotateBSpline(3, psi, Maux, WRAP);</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;            <a class="code" href="classification_2pca_8cpp.html#ae5e08c2a7a15204653d0fdaabbc890ac">rotate</a>(<a class="code" href="group__GeometricalTransformations.html#gab8a49d8335f45ebd2ba7d86d98322bc0">BSPLINE3</a>, Maux, <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>[refno](), -psi, <span class="charliteral">&#39;Z&#39;</span>, <a class="code" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a>);</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;            <a class="code" href="group__Fourier.html#ga5ed410a4eb328191715155101e93758e">FourierTransformHalf</a>(Maux, Faux);</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;            <span class="comment">// Normalize the magnitude of the rotated references to 1st rot of that ref</span></div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;            <span class="comment">// This is necessary because interpolation due to rotation can lead to lower overall Fref</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            <span class="comment">// This would result in lower probabilities for those rotations</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;            AA = Maux.<a class="code" href="classMultidimArray.html#ae9f104cb09328048ed9aa7aec03c792c">sum2</a>();</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;            <span class="keywordflow">if</span> (ipsi == 0)</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            {</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                stdAA = AA;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;            }</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;            <span class="keywordflow">if</span> (AA &gt; 0)</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;            {</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                <span class="keywordtype">double</span> sqrtVal = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(stdAA/AA);</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(Faux)</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(Faux, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>) *= sqrtVal;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;            }</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;            <span class="comment">// Add all points as doubles to the vector</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;            <a class="code" href="classProgMLF2D.html#ab88b1c3d37f23eb7ef079f2535136780">appendFTtoVector</a>(Faux, out);</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        }</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        <span class="comment">// Free memory</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.Iref[refno]().resize(0,0);</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    }</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;}</div><div class="ttc" id="group__Fourier_html_ga5ed410a4eb328191715155101e93758e"><div class="ttname"><a href="group__Fourier.html#ga5ed410a4eb328191715155101e93758e">FourierTransformHalf</a></div><div class="ttdeci">void FourierTransformHalf(const MultidimArray&lt; double &gt; &amp;in, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8cpp_source.html#l00187">xmipp_fft.cpp:187</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a976dc404489a0c66af2800f0f73e76c7"><div class="ttname"><a href="classML2DBaseProgram.html#a976dc404489a0c66af2800f0f73e76c7">ML2DBaseProgram::nr_psi</a></div><div class="ttdeci">size_t nr_psi</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00154">ml2d.h:154</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a5578230b3fb9e054c437e187cb0ad5d3"><div class="ttname"><a href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">ML2DBaseProgram::model</a></div><div class="ttdeci">ModelML2D model</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00224">ml2d.h:224</a></div></div>
<div class="ttc" id="transformations_8h_html_a43c1de45dbd91827a260224c9c40221b"><div class="ttname"><a href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a></div><div class="ttdeci">#define WRAP</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00043">transformations.h:43</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a2ab21717291173f3155a2e4006137167"><div class="ttname"><a href="classML2DBaseProgram.html#a2ab21717291173f3155a2e4006137167">ML2DBaseProgram::psi_max</a></div><div class="ttdeci">double psi_max</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00160">ml2d.h:160</a></div></div>
<div class="ttc" id="ml2d_8h_html_a6b49ded9ade4e2a8b65b16670db60486"><div class="ttname"><a href="ml2d_8h.html#a6b49ded9ade4e2a8b65b16670db60486">SMALLANGLE</a></div><div class="ttdeci">#define SMALLANGLE</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00049">ml2d.h:49</a></div></div>
<div class="ttc" id="classification_2pca_8cpp_html_ae5e08c2a7a15204653d0fdaabbc890ac"><div class="ttname"><a href="classification_2pca_8cpp.html#ae5e08c2a7a15204653d0fdaabbc890ac">rotate</a></div><div class="ttdeci">#define rotate(a, i, j, k, l)</div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gae1d499e9328ad87a22b0cafeae0f1f01"><div class="ttname"><a href="group__MLFalign2D.html#gae1d499e9328ad87a22b0cafeae0f1f01">FOR_ALL_ROTATIONS</a></div><div class="ttdeci">#define FOR_ALL_ROTATIONS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00037">mlf_align2d.h:37</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ae96de19117479eb8bf594268bb9af590"><div class="ttname"><a href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">ML2DBaseProgram::dim</a></div><div class="ttdeci">size_t dim</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00151">ml2d.h:151</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gab8a49d8335f45ebd2ba7d86d98322bc0"><div class="ttname"><a href="group__GeometricalTransformations.html#gab8a49d8335f45ebd2ba7d86d98322bc0">BSPLINE3</a></div><div class="ttdeci">#define BSPLINE3</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00210">transformations.h:210</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga53e37122134100316031eae982abee03"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a></div><div class="ttdeci">#define dAi(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00540">multidim_array.h:540</a></div></div>
<div class="ttc" id="classModelML2D_html_a29baa2fb66177265cb0de6d027ea454a"><div class="ttname"><a href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">ModelML2D::Iref</a></div><div class="ttdeci">std::vector&lt; Image&lt; double &gt; &gt; Iref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00085">ml2d.h:85</a></div></div>
<div class="ttc" id="classMultidimArray_html_ae9f104cb09328048ed9aa7aec03c792c"><div class="ttname"><a href="classMultidimArray.html#ae9f104cb09328048ed9aa7aec03c792c">MultidimArray::sum2</a></div><div class="ttdeci">double sum2() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05114">multidim_array.h:5114</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ab88b1c3d37f23eb7ef079f2535136780"><div class="ttname"><a href="classProgMLF2D.html#ab88b1c3d37f23eb7ef079f2535136780">ProgMLF2D::appendFTtoVector</a></div><div class="ttdeci">void appendFTtoVector(const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;Fin, std::vector&lt; double &gt; &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l01284">mlf_align2d.cpp:1284</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gadcb82c3ff44ffd9c34b67c3ca943613d"><div class="ttname"><a href="group__MLFalign2D.html#gadcb82c3ff44ffd9c34b67c3ca943613d">FOR_ALL_MODELS</a></div><div class="ttdeci">#define FOR_ALL_MODELS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00036">mlf_align2d.h:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a501c85d59b6f2dc691f93c2afde6455f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::setCurrentSamplingRates </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>current_probres_limit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Vary in-plane and translational sampling rates with resolution. </p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l01123">1123</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;{</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="keywordtype">int</span> trans_step = 1;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#ac06a02372d68274fa8fb58dab620db9a">do_variable_psi</a>)</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    {</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        <span class="comment">// Sample the in-plane rotations 3x the current resolution</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <span class="comment">// Note that SIND(0.5*psi_step) = Delta / dim;</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        <a class="code" href="classML2DBaseProgram.html#aae259850c9b209a3ff3cbcc7799e2742">psi_step</a> = (2.* <a class="code" href="group__Macros.html#ga1a28202d513853ad372ddd2effa46621">ASIND</a>(current_probres_limit/(<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>*<a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a>))) / 3.;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a976dc404489a0c66af2800f0f73e76c7">nr_psi</a> = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="classML2DBaseProgram.html#a2ab21717291173f3155a2e4006137167">psi_max</a> / <a class="code" href="classML2DBaseProgram.html#aae259850c9b209a3ff3cbcc7799e2742">psi_step</a>);</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <span class="comment">// Use user-provided psi_step as minimum sampling</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a976dc404489a0c66af2800f0f73e76c7">nr_psi</a> = <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(<a class="code" href="classML2DBaseProgram.html#a976dc404489a0c66af2800f0f73e76c7">nr_psi</a>, <a class="code" href="classProgMLF2D.html#a373f1965ed767abbf1d5b3e53104623b">max_nr_psi</a>);</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <a class="code" href="classML2DBaseProgram.html#aae259850c9b209a3ff3cbcc7799e2742">psi_step</a> = <a class="code" href="classML2DBaseProgram.html#a2ab21717291173f3155a2e4006137167">psi_max</a> / <a class="code" href="classML2DBaseProgram.html#a976dc404489a0c66af2800f0f73e76c7">nr_psi</a>;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    }</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#aef9b9f1aff83b4d111cf2a8be84d4c07">do_variable_trans</a>)</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    {</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a>  offsets(2);</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        <a class="code" href="classProgMLF2D.html#a1f05f45301557f3c0a855a414b87b5fd">nr_trans</a> = 0;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        <a class="code" href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">Vtrans</a>.clear();</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        <span class="comment">// Sample the in-plane translations 3x the current resolution</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        trans_step = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(current_probres_limit/(3.*<a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a>));</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="comment">// Use trans_step=1 as minimum sampling</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        trans_step = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(1,trans_step);</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = -<a class="code" href="classProgMLF2D.html#a13f69696df08368a14b8928b60faaad7">search_shift</a>*trans_step; ix &lt;= <a class="code" href="classProgMLF2D.html#a13f69696df08368a14b8928b60faaad7">search_shift</a>*trans_step; ix+=trans_step)</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        {</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = -<a class="code" href="classProgMLF2D.html#a13f69696df08368a14b8928b60faaad7">search_shift</a>*trans_step; iy &lt;= <a class="code" href="classProgMLF2D.html#a13f69696df08368a14b8928b60faaad7">search_shift</a>*trans_step; iy+=trans_step)</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            {</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                <span class="keywordtype">double</span> rr = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>((<span class="keywordtype">double</span>)(ix * ix + iy * iy));</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                <span class="keywordflow">if</span> (rr &lt;= (<span class="keywordtype">double</span>)trans_step*<a class="code" href="classProgMLF2D.html#a13f69696df08368a14b8928b60faaad7">search_shift</a>)</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                {</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(offsets) = ix;</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(offsets) = iy;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                    <a class="code" href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">Vtrans</a>.push_back(offsets);</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                    <a class="code" href="classProgMLF2D.html#a1f05f45301557f3c0a855a414b87b5fd">nr_trans</a>++;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                    <span class="keywordflow">if</span> (ix == 0 &amp;&amp; iy == 0)</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                    {</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                        <a class="code" href="classProgMLF2D.html#adec8e47d0ada48f2aea2259ca1b400cf">zero_trans</a> = <a class="code" href="classProgMLF2D.html#a1f05f45301557f3c0a855a414b87b5fd">nr_trans</a>;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                        <span class="comment">// For coarser samplings, always add (-1,0) (1,0) (0,-1) and (0,1)</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                        <span class="keywordflow">if</span> (trans_step &gt; 1)</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                        {</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                            <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(offsets) = 1;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                            <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(offsets) = 0;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                            <a class="code" href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">Vtrans</a>.push_back(offsets);</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                            <a class="code" href="classProgMLF2D.html#a1f05f45301557f3c0a855a414b87b5fd">nr_trans</a>++;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                            <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(offsets) = -1;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                            <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(offsets) = 0;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                            <a class="code" href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">Vtrans</a>.push_back(offsets);</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                            <a class="code" href="classProgMLF2D.html#a1f05f45301557f3c0a855a414b87b5fd">nr_trans</a>++;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                            <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(offsets) = 0;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                            <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(offsets) = 1;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                            <a class="code" href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">Vtrans</a>.push_back(offsets);</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                            <a class="code" href="classProgMLF2D.html#a1f05f45301557f3c0a855a414b87b5fd">nr_trans</a>++;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                            <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(offsets) = 0;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                            <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(offsets) = -1;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                            <a class="code" href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">Vtrans</a>.push_back(offsets);</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                            <a class="code" href="classProgMLF2D.html#a1f05f45301557f3c0a855a414b87b5fd">nr_trans</a>++;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                        }</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                    }</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                }</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;            }</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        }</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    }</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a> &gt; 0 &amp;&amp; (<a class="code" href="classProgMLF2D.html#ac06a02372d68274fa8fb58dab620db9a">do_variable_psi</a> || <a class="code" href="classProgMLF2D.html#aef9b9f1aff83b4d111cf2a8be84d4c07">do_variable_trans</a>))</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    {</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        std::cout&lt;&lt;<span class="stringliteral">&quot; Current resolution= &quot;</span>&lt;&lt;current_probres_limit&lt;&lt;<span class="stringliteral">&quot; Ang; current psi_step = &quot;</span>&lt;&lt;<a class="code" href="classML2DBaseProgram.html#aae259850c9b209a3ff3cbcc7799e2742">psi_step</a>&lt;&lt;<span class="stringliteral">&quot; current trans_step = &quot;</span>&lt;&lt;trans_step&lt;&lt;std::endl;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    }</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;}</div><div class="ttc" id="classML2DBaseProgram_html_a976dc404489a0c66af2800f0f73e76c7"><div class="ttname"><a href="classML2DBaseProgram.html#a976dc404489a0c66af2800f0f73e76c7">ML2DBaseProgram::nr_psi</a></div><div class="ttdeci">size_t nr_psi</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00154">ml2d.h:154</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ad2a82e39d73ee5d2911c6c9a95b9b54c"><div class="ttname"><a href="classML2DBaseProgram.html#ad2a82e39d73ee5d2911c6c9a95b9b54c">ML2DBaseProgram::Vtrans</a></div><div class="ttdeci">std::vector&lt; Matrix1D&lt; double &gt; &gt; Vtrans</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00184">ml2d.h:184</a></div></div>
<div class="ttc" id="group__Macros_html_gae0a4180e923e3ffca3989e20e441aa3c"><div class="ttname"><a href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a></div><div class="ttdeci">#define XMIPP_MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00193">xmipp_macros.h:193</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ac06a02372d68274fa8fb58dab620db9a"><div class="ttname"><a href="classProgMLF2D.html#ac06a02372d68274fa8fb58dab620db9a">ProgMLF2D::do_variable_psi</a></div><div class="ttdeci">bool do_variable_psi</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00083">mlf_align2d.h:83</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a13f69696df08368a14b8928b60faaad7"><div class="ttname"><a href="classProgMLF2D.html#a13f69696df08368a14b8928b60faaad7">ProgMLF2D::search_shift</a></div><div class="ttdeci">int search_shift</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00093">mlf_align2d.h:93</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a1f05f45301557f3c0a855a414b87b5fd"><div class="ttname"><a href="classProgMLF2D.html#a1f05f45301557f3c0a855a414b87b5fd">ProgMLF2D::nr_trans</a></div><div class="ttdeci">size_t nr_trans</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00089">mlf_align2d.h:89</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_aae259850c9b209a3ff3cbcc7799e2742"><div class="ttname"><a href="classML2DBaseProgram.html#aae259850c9b209a3ff3cbcc7799e2742">ML2DBaseProgram::psi_step</a></div><div class="ttdeci">double psi_step</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00158">ml2d.h:158</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a2ab21717291173f3155a2e4006137167"><div class="ttname"><a href="classML2DBaseProgram.html#a2ab21717291173f3155a2e4006137167">ML2DBaseProgram::psi_max</a></div><div class="ttdeci">double psi_max</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00160">ml2d.h:160</a></div></div>
<div class="ttc" id="classProgMLF2D_html_aef9b9f1aff83b4d111cf2a8be84d4c07"><div class="ttname"><a href="classProgMLF2D.html#aef9b9f1aff83b4d111cf2a8be84d4c07">ProgMLF2D::do_variable_trans</a></div><div class="ttdeci">bool do_variable_trans</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00083">mlf_align2d.h:83</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="group__Macros_html_ga1a28202d513853ad372ddd2effa46621"><div class="ttname"><a href="group__Macros.html#ga1a28202d513853ad372ddd2effa46621">ASIND</a></div><div class="ttdeci">#define ASIND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00356">xmipp_macros.h:356</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ae96de19117479eb8bf594268bb9af590"><div class="ttname"><a href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">ML2DBaseProgram::dim</a></div><div class="ttdeci">size_t dim</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00151">ml2d.h:151</a></div></div>
<div class="ttc" id="classXmippProgram_html_aed62cfe3c074e69076bf348fc101a717"><div class="ttname"><a href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">XmippProgram::verbose</a></div><div class="ttdeci">int verbose</div><div class="ttdoc">Verbosity level. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8h_source.html#l00168">xmipp_program.h:168</a></div></div>
<div class="ttc" id="group__Macros_html_gac9ae6a207f10c821b06a8c0df153a7d5"><div class="ttname"><a href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a></div><div class="ttdeci">#define XMIPP_MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00181">xmipp_macros.h:181</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a373f1965ed767abbf1d5b3e53104623b"><div class="ttname"><a href="classProgMLF2D.html#a373f1965ed767abbf1d5b3e53104623b">ProgMLF2D::max_nr_psi</a></div><div class="ttdeci">size_t max_nr_psi</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00081">mlf_align2d.h:81</a></div></div>
<div class="ttc" id="classProgMLF2D_html_af1176823dd265484796aa9b52215719e"><div class="ttname"><a href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">ProgMLF2D::sampling</a></div><div class="ttdeci">double sampling</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00102">mlf_align2d.h:102</a></div></div>
<div class="ttc" id="classProgMLF2D_html_adec8e47d0ada48f2aea2259ca1b400cf"><div class="ttname"><a href="classProgMLF2D.html#adec8e47d0ada48f2aea2259ca1b400cf">ProgMLF2D::zero_trans</a></div><div class="ttdeci">size_t zero_trans</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00091">mlf_align2d.h:91</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7cbbdebbb1328f32dabd4cf3a36d289a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::show </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>ML3D</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Show. </p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l00195">195</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;{</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a>)</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="comment">// To screen</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classML2DBaseProgram.html#a963af5cdb6f63d876c147c24fbf8452e">do_ML3D</a>)</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            std::cout</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; -----------------------------------------------------------------&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; | Read more about this program in the following publication:    |&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; |  Scheres ea. (2007) Structure, 15, 1167-1177                  |&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; |                                                               |&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; |   *** Please cite it if this program is of use to you! ***    |&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; -----------------------------------------------------------------&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        std::cout</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;--&gt; Multi-reference refinement &quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;--&gt; using a maximum-likelihood in Fourier-space (MLF) target &quot;</span> &lt;&lt;std::endl</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        &lt;&lt; (<a class="code" href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">do_ctf_correction</a> ? <span class="stringliteral">&quot;--&gt; with CTF correction &quot;</span> : <span class="stringliteral">&quot;--&gt; ignoring CTF effects &quot;</span>)&lt;&lt;std::endl</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  Input images            : &quot;</span> &lt;&lt; <a class="code" href="classML2DBaseProgram.html#a4e593a9112ddcc0256bc9b72213cdb3b">fn_img</a> &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classML2DBaseProgram.html#a55332f697c74f72635ae850439407645">nr_images_global</a> &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classML2DBaseProgram.html#a9544695d9d0054d6e75d62f227bee889">fn_ref</a>.empty())</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;  Reference image(s)      : &quot;</span> &lt;&lt; <a class="code" href="classML2DBaseProgram.html#a9544695d9d0054d6e75d62f227bee889">fn_ref</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;  Number of references:   : &quot;</span> &lt;&lt; <a class="code" href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">model</a>.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        std::cout</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  Output rootname         : &quot;</span> &lt;&lt; <a class="code" href="classML2DBaseProgram.html#adfab8933f95443ac6d909a9b206b3fa8">fn_root</a> &lt;&lt; std::endl</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  Stopping criterium      : &quot;</span> &lt;&lt; <a class="code" href="classML2DBaseProgram.html#a909478a47c338d181693f9421ecb4bd3">eps</a> &lt;&lt; std::endl</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  initial sigma offset    : &quot;</span> &lt;&lt; <a class="code" href="classProgMLF2D.html#a0177d3113415179168699efda64bd860">sigma_offset</a> &lt;&lt; std::endl</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  Psi sampling interval   : &quot;</span> &lt;&lt; <a class="code" href="classML2DBaseProgram.html#aae259850c9b209a3ff3cbcc7799e2742">psi_step</a> &lt;&lt; <span class="stringliteral">&quot; degrees&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  Translational searches  : &quot;</span> &lt;&lt; <a class="code" href="classProgMLF2D.html#a13f69696df08368a14b8928b60faaad7">search_shift</a> &lt;&lt; <span class="stringliteral">&quot; pixels&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  Low resolution limit    : &quot;</span> &lt;&lt; <a class="code" href="classProgMLF2D.html#a0c5751afdfd3fe27554492356c09a58c">lowres_limit</a> &lt;&lt; <span class="stringliteral">&quot; Ang&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  High resolution limit   : &quot;</span> &lt;&lt; <a class="code" href="classProgMLF2D.html#a27f1ed8b93ea62c3e3727f7fa57f41b8">highres_limit</a> &lt;&lt; <span class="stringliteral">&quot; Ang&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a19dbbebd916d67da0d3e0ce5c9d77993">reduce_snr</a> != 1.)</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;  Multiply estimated SNR  : &quot;</span> &lt;&lt; <a class="code" href="classProgMLF2D.html#a19dbbebd916d67da0d3e0ce5c9d77993">reduce_snr</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a19dbbebd916d67da0d3e0ce5c9d77993">reduce_snr</a> &gt; 1.)</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            std::cerr &lt;&lt; <span class="stringliteral">&quot;  --&gt; WARNING!! With reduce_snr&gt;1 you may likely overfit the noise!&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;  Check mirrors           : &quot;</span> &lt;&lt; (<a class="code" href="classML2DBaseProgram.html#ad9b9535e1774d805e5bbee89dee0f4b5">do_mirror</a> ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>) &lt;&lt; std::endl;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classML2DBaseProgram.html#abf6ec880b915a0887a9e0a864c3ff467">fn_frac</a>.empty())</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;  Initial model fractions : &quot;</span> &lt;&lt; <a class="code" href="classML2DBaseProgram.html#abf6ec880b915a0887a9e0a864c3ff467">fn_frac</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">do_ctf_correction</a>)</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;    + Assuming images have &quot;</span> &lt;&lt; (<a class="code" href="classProgMLF2D.html#a9c504b96e173e1eeb6cda09a00e5b638">phase_flipped</a> ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;not&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;been phase flipped &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <a class="code" href="group__MLFalign2D.html#gab39599380e42cadda13b0cfb14588d46">FOR_ALL_DEFOCUS_GROUPS</a>()</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            {</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                std::cout &lt;&lt; <a class="code" href="group__StringUtilities.html#gaa405c9a5b808e428554e540028085dd3">formatString</a>(<span class="stringliteral">&quot;    + CTF group %d contains %d images&quot;</span>, ifocus + 1, <a class="code" href="classProgMLF2D.html#a5c75192acc215ccf8e062881d14f9ac4">count_defocus</a>[ifocus]) &lt;&lt; std::endl;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            }</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        }</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a552a32e4f5ff63eda3ffa4708eef6f67">ini_highres_limit</a> &gt; 0.)</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;    + High resolution limit for 1st iteration set to &quot;</span> &lt;&lt; <a class="code" href="classProgMLF2D.html#a552a32e4f5ff63eda3ffa4708eef6f67">ini_highres_limit</a> &lt;&lt; <span class="stringliteral">&quot;Ang&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a4ca3328df09f636935d22b5b946a3704">search_rot</a> &lt; 180.)</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;    + Limit orientational search to +/- &quot;</span> &lt;&lt; <a class="code" href="classML2DBaseProgram.html#a4ca3328df09f636935d22b5b946a3704">search_rot</a> &lt;&lt; <span class="stringliteral">&quot; degrees&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#ac06a02372d68274fa8fb58dab620db9a">do_variable_psi</a>)</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;    + Vary in-plane rotational sampling with resolution &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#aef9b9f1aff83b4d111cf2a8be84d4c07">do_variable_trans</a>)</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;    + Vary in-plane translational sampling with resolution &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="comment">// Hidden stuff</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a6f89b87041906702ae5c30638bd2762c">fix_fractions</a>)</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        {</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;    + Do not update estimates of model fractions.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        }</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a3c0fde6f9005eec528cc1f703019719c">fix_sigma_offset</a>)</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        {</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;    + Do not update sigma-estimate of origin offsets.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        }</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a4646a8113c64d86101389cb4f373bca3">fix_sigma_noise</a>)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;    + Do not update estimated noise spectra.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a>)</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;  -&gt; Use t-student distribution with df = &quot;</span> &lt;&lt;<a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a>&lt;&lt; std::endl;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#aad176d8656485e60ed725b2754a070aa">do_student_sigma_trick</a>)</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;  -&gt; Use sigma-trick for t-student distributions&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">do_norm</a>)</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        {</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;  -&gt; Developmental: refine normalization internally &quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        }</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a79873ba6ac0a02ebff149285475a8721">do_kstest</a>)</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        {</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;  -&gt; Developmental: perform KS-test on noise distributions &quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a1bd3c9e0f12cfa45daa109e0c96c3f28">iter_write_histograms</a> &gt;0.)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;  -&gt; Developmental: write noise histograms at iteration &quot;</span>&lt;&lt;<a class="code" href="classProgMLF2D.html#a1bd3c9e0f12cfa45daa109e0c96c3f28">iter_write_histograms</a>&lt;&lt;std::endl;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        }</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot; -----------------------------------------------------------------&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;}</div><div class="ttc" id="classProgMLF2D_html_a8402eab40b0e66cd7aee78b747720af9"><div class="ttname"><a href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">ProgMLF2D::do_student</a></div><div class="ttdeci">bool do_student</div><div class="ttdoc">IN DEVELOPMENT. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00135">mlf_align2d.h:135</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a0c5751afdfd3fe27554492356c09a58c"><div class="ttname"><a href="classProgMLF2D.html#a0c5751afdfd3fe27554492356c09a58c">ProgMLF2D::lowres_limit</a></div><div class="ttdeci">double lowres_limit</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00116">mlf_align2d.h:116</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a27f1ed8b93ea62c3e3727f7fa57f41b8"><div class="ttname"><a href="classProgMLF2D.html#a27f1ed8b93ea62c3e3727f7fa57f41b8">ProgMLF2D::highres_limit</a></div><div class="ttdeci">double highres_limit</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00116">mlf_align2d.h:116</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a5578230b3fb9e054c437e187cb0ad5d3"><div class="ttname"><a href="classML2DBaseProgram.html#a5578230b3fb9e054c437e187cb0ad5d3">ML2DBaseProgram::model</a></div><div class="ttdeci">ModelML2D model</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00224">ml2d.h:224</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ac06a02372d68274fa8fb58dab620db9a"><div class="ttname"><a href="classProgMLF2D.html#ac06a02372d68274fa8fb58dab620db9a">ProgMLF2D::do_variable_psi</a></div><div class="ttdeci">bool do_variable_psi</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00083">mlf_align2d.h:83</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a6f89b87041906702ae5c30638bd2762c"><div class="ttname"><a href="classML2DBaseProgram.html#a6f89b87041906702ae5c30638bd2762c">ML2DBaseProgram::fix_fractions</a></div><div class="ttdeci">bool fix_fractions</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00139">ml2d.h:139</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a13f69696df08368a14b8928b60faaad7"><div class="ttname"><a href="classProgMLF2D.html#a13f69696df08368a14b8928b60faaad7">ProgMLF2D::search_shift</a></div><div class="ttdeci">int search_shift</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00093">mlf_align2d.h:93</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a4e593a9112ddcc0256bc9b72213cdb3b"><div class="ttname"><a href="classML2DBaseProgram.html#a4e593a9112ddcc0256bc9b72213cdb3b">ML2DBaseProgram::fn_img</a></div><div class="ttdeci">FileName fn_img</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00132">ml2d.h:132</a></div></div>
<div class="ttc" id="classModelML2D_html_a63a3a3534d1cb72a9db046508b9a59f6"><div class="ttname"><a href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">ModelML2D::n_ref</a></div><div class="ttdeci">int n_ref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00083">ml2d.h:83</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_aae259850c9b209a3ff3cbcc7799e2742"><div class="ttname"><a href="classML2DBaseProgram.html#aae259850c9b209a3ff3cbcc7799e2742">ML2DBaseProgram::psi_step</a></div><div class="ttdeci">double psi_step</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00158">ml2d.h:158</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gab39599380e42cadda13b0cfb14588d46"><div class="ttname"><a href="group__MLFalign2D.html#gab39599380e42cadda13b0cfb14588d46">FOR_ALL_DEFOCUS_GROUPS</a></div><div class="ttdeci">#define FOR_ALL_DEFOCUS_GROUPS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00040">mlf_align2d.h:40</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_adfab8933f95443ac6d909a9b206b3fa8"><div class="ttname"><a href="classML2DBaseProgram.html#adfab8933f95443ac6d909a9b206b3fa8">ML2DBaseProgram::fn_root</a></div><div class="ttdeci">FileName fn_root</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00132">ml2d.h:132</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a1bd3c9e0f12cfa45daa109e0c96c3f28"><div class="ttname"><a href="classProgMLF2D.html#a1bd3c9e0f12cfa45daa109e0c96c3f28">ProgMLF2D::iter_write_histograms</a></div><div class="ttdeci">int iter_write_histograms</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00143">mlf_align2d.h:143</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a19dbbebd916d67da0d3e0ce5c9d77993"><div class="ttname"><a href="classProgMLF2D.html#a19dbbebd916d67da0d3e0ce5c9d77993">ProgMLF2D::reduce_snr</a></div><div class="ttdeci">double reduce_snr</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00112">mlf_align2d.h:112</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a9e143fabdc67d1ee8cd67dcad98e74fc"><div class="ttname"><a href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">ML2DBaseProgram::do_norm</a></div><div class="ttdeci">bool do_norm</div><div class="ttdoc">Re-normalize internally. </div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00207">ml2d.h:207</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a963af5cdb6f63d876c147c24fbf8452e"><div class="ttname"><a href="classML2DBaseProgram.html#a963af5cdb6f63d876c147c24fbf8452e">ML2DBaseProgram::do_ML3D</a></div><div class="ttdeci">bool do_ML3D</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00196">ml2d.h:196</a></div></div>
<div class="ttc" id="classProgMLF2D_html_aef9b9f1aff83b4d111cf2a8be84d4c07"><div class="ttname"><a href="classProgMLF2D.html#aef9b9f1aff83b4d111cf2a8be84d4c07">ProgMLF2D::do_variable_trans</a></div><div class="ttdeci">bool do_variable_trans</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00083">mlf_align2d.h:83</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a4ca3328df09f636935d22b5b946a3704"><div class="ttname"><a href="classML2DBaseProgram.html#a4ca3328df09f636935d22b5b946a3704">ML2DBaseProgram::search_rot</a></div><div class="ttdeci">double search_rot</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00190">ml2d.h:190</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a79873ba6ac0a02ebff149285475a8721"><div class="ttname"><a href="classProgMLF2D.html#a79873ba6ac0a02ebff149285475a8721">ProgMLF2D::do_kstest</a></div><div class="ttdeci">bool do_kstest</div><div class="ttdoc">Statistical analysis of the noise distributions. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00141">mlf_align2d.h:141</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a9c504b96e173e1eeb6cda09a00e5b638"><div class="ttname"><a href="classProgMLF2D.html#a9c504b96e173e1eeb6cda09a00e5b638">ProgMLF2D::phase_flipped</a></div><div class="ttdeci">bool phase_flipped</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00106">mlf_align2d.h:106</a></div></div>
<div class="ttc" id="classProgMLF2D_html_aad176d8656485e60ed725b2754a070aa"><div class="ttname"><a href="classProgMLF2D.html#aad176d8656485e60ed725b2754a070aa">ProgMLF2D::do_student_sigma_trick</a></div><div class="ttdeci">bool do_student_sigma_trick</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00137">mlf_align2d.h:137</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a0177d3113415179168699efda64bd860"><div class="ttname"><a href="classProgMLF2D.html#a0177d3113415179168699efda64bd860">ProgMLF2D::sigma_offset</a></div><div class="ttdeci">double sigma_offset</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00075">mlf_align2d.h:75</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a8671946de2e241de54a47e2822989ca1"><div class="ttname"><a href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">ML2DBaseProgram::df</a></div><div class="ttdeci">double df</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00204">ml2d.h:204</a></div></div>
<div class="ttc" id="classXmippProgram_html_aed62cfe3c074e69076bf348fc101a717"><div class="ttname"><a href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">XmippProgram::verbose</a></div><div class="ttdeci">int verbose</div><div class="ttdoc">Verbosity level. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8h_source.html#l00168">xmipp_program.h:168</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a7c3f7c47054265ad3589ee6d40764fbc"><div class="ttname"><a href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">ProgMLF2D::do_ctf_correction</a></div><div class="ttdeci">bool do_ctf_correction</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00100">mlf_align2d.h:100</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a4646a8113c64d86101389cb4f373bca3"><div class="ttname"><a href="classML2DBaseProgram.html#a4646a8113c64d86101389cb4f373bca3">ML2DBaseProgram::fix_sigma_noise</a></div><div class="ttdeci">bool fix_sigma_noise</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00143">ml2d.h:143</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_abf6ec880b915a0887a9e0a864c3ff467"><div class="ttname"><a href="classML2DBaseProgram.html#abf6ec880b915a0887a9e0a864c3ff467">ML2DBaseProgram::fn_frac</a></div><div class="ttdeci">FileName fn_frac</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00132">ml2d.h:132</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a9544695d9d0054d6e75d62f227bee889"><div class="ttname"><a href="classML2DBaseProgram.html#a9544695d9d0054d6e75d62f227bee889">ML2DBaseProgram::fn_ref</a></div><div class="ttdeci">FileName fn_ref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00132">ml2d.h:132</a></div></div>
<div class="ttc" id="group__StringUtilities_html_gaa405c9a5b808e428554e540028085dd3"><div class="ttname"><a href="group__StringUtilities.html#gaa405c9a5b808e428554e540028085dd3">formatString</a></div><div class="ttdeci">String formatString(const char *format,...)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__strings_8cpp_source.html#l00610">xmipp_strings.cpp:610</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ad9b9535e1774d805e5bbee89dee0f4b5"><div class="ttname"><a href="classML2DBaseProgram.html#ad9b9535e1774d805e5bbee89dee0f4b5">ML2DBaseProgram::do_mirror</a></div><div class="ttdeci">bool do_mirror</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00137">ml2d.h:137</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a3c0fde6f9005eec528cc1f703019719c"><div class="ttname"><a href="classML2DBaseProgram.html#a3c0fde6f9005eec528cc1f703019719c">ML2DBaseProgram::fix_sigma_offset</a></div><div class="ttdeci">bool fix_sigma_offset</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00141">ml2d.h:141</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a55332f697c74f72635ae850439407645"><div class="ttname"><a href="classML2DBaseProgram.html#a55332f697c74f72635ae850439407645">ML2DBaseProgram::nr_images_global</a></div><div class="ttdeci">size_t nr_images_global</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00164">ml2d.h:164</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a5c75192acc215ccf8e062881d14f9ac4"><div class="ttname"><a href="classProgMLF2D.html#a5c75192acc215ccf8e062881d14f9ac4">ProgMLF2D::count_defocus</a></div><div class="ttdeci">std::vector&lt; int &gt; count_defocus</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00104">mlf_align2d.h:104</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a909478a47c338d181693f9421ecb4bd3"><div class="ttname"><a href="classML2DBaseProgram.html#a909478a47c338d181693f9421ecb4bd3">ML2DBaseProgram::eps</a></div><div class="ttdeci">double eps</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00170">ml2d.h:170</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a552a32e4f5ff63eda3ffa4708eef6f67"><div class="ttname"><a href="classProgMLF2D.html#a552a32e4f5ff63eda3ffa4708eef6f67">ProgMLF2D::ini_highres_limit</a></div><div class="ttdeci">double ini_highres_limit</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00116">mlf_align2d.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab1a1724f969e8cfca5c84d766366dd7b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::updateWienerFilters </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>spectral_signal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>sumw_defocus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate Wiener filter for defocus series as defined by Frank (2nd ed. formula 2.32b on p.60) </p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l00849">849</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;{</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <a class="code" href="xmipp__log_8h.html#a9d0e78c69b9733e4419a5f65d5a38a3a">LOG_FUNCTION</a>();</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="comment">// Use formula 2.32b on p60 from Frank&#39;s book 2nd ed.,</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="comment">// Assume that Vctf, Vdec and Vsig exist (with their right sizes)</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="comment">// and that Vctf, Vsig are already filled with the right values</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    std::vector&lt;MultidimArray&lt;double&gt; &gt;  Vsnr;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a>           Vzero, Vdenom, Vavgctf2;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a>           Maux;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;std::complex&lt;double&gt;</a> &gt; Faux;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    std::ofstream                   fh;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordtype">size_t</span>                     maxres = 0;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordtype">double</span>                     noise, sum_sumw_defocus = 0.;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="keywordtype">size_t</span>                     int_lowres_limit, int_highres_limit, int_ini_highres_limit;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordtype">size_t</span>                     current_probres_limit;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <a class="code" href="classFileName.html">FileName</a>                   fn_base, fn_tmp;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="comment">// integer resolution limits (in shells)</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    int_lowres_limit  = (size_t)(<a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a> * <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a> / <a class="code" href="classProgMLF2D.html#a0c5751afdfd3fe27554492356c09a58c">lowres_limit</a>);</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    int_highres_limit = (<a class="code" href="classProgMLF2D.html#a27f1ed8b93ea62c3e3727f7fa57f41b8">highres_limit</a> &gt; 0.) ? <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a> * <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a> / <a class="code" href="classProgMLF2D.html#a27f1ed8b93ea62c3e3727f7fa57f41b8">highres_limit</a>) : <a class="code" href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">hdim</a>;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    int_ini_highres_limit =  (<a class="code" href="classProgMLF2D.html#a552a32e4f5ff63eda3ffa4708eef6f67">ini_highres_limit</a> &gt; 0.) ? <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a> * <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a> / <a class="code" href="classProgMLF2D.html#a552a32e4f5ff63eda3ffa4708eef6f67">ini_highres_limit</a>) : <a class="code" href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">hdim</a>;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="comment">// Pre-calculate average CTF^2 and initialize Vsnr</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    Vavgctf2.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">hdim</a>);</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    Vzero.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">hdim</a>);</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    Vsnr.resize(<a class="code" href="classProgMLF2D.html#a7e08de076e12e519d59f5e39854f1dc5">nr_focus</a>, Vzero);</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <a class="code" href="group__MLFalign2D.html#gab39599380e42cadda13b0cfb14588d46">FOR_ALL_DEFOCUS_GROUPS</a>()</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    {</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="keywordtype">double</span> &amp; defocus_weight = <a class="code" href="classProgMLF2D.html#a9c42feb7d8cbf224f91e903bac49663e">sumw_defocus</a>[ifocus];</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        sum_sumw_defocus += defocus_weight;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <a class="code" href="group__MLFalign2D.html#ga0b5e5d4b8eb0463459e3fe178b6622cd">FOR_ALL_DIGITAL_FREQS</a>()</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(Vavgctf2, irr) += <a class="code" href="group__MLFalign2D.html#gae2592474564ce2c4143fab306b777807">VCTF_ITEM</a> * <a class="code" href="group__MLFalign2D.html#gae2592474564ce2c4143fab306b777807">VCTF_ITEM</a> * defocus_weight;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    }</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    Vavgctf2 /= sum_sumw_defocus;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="comment">// std::cerr &lt;&lt; &quot;DEBUG_JM, updateWienerFilters: spectral_signal: &quot; &lt;&lt; spectral_signal &lt;&lt; std::endl;</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="comment">// Calculate SSNR for all CTF groups</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="comment">// For each group the spectral noise is estimated via (2*Vsig)/(sumw_defocus-1)</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="comment">// The spectral signal is not split into CTF groups</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="comment">// Therefore, affect the average spectral_signal for each defocu</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="comment">// group with its CTF^2 and divide by the average CTF^2</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <a class="code" href="group__MLFalign2D.html#gab39599380e42cadda13b0cfb14588d46">FOR_ALL_DEFOCUS_GROUPS</a>()</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    {</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <a class="code" href="group__MLFalign2D.html#ga0b5e5d4b8eb0463459e3fe178b6622cd">FOR_ALL_DIGITAL_FREQS</a>()</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        {</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            <span class="comment">//if (verbose) std::cerr &lt;&lt; &quot;DEBUG_JM: ifocus: &quot; &lt;&lt; ifocus &lt;&lt; std::endl;</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            <span class="comment">//if (verbose) std::cerr &lt;&lt; &quot;DEBUG_JM: irr: &quot; &lt;&lt; irr &lt;&lt; std::endl;</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            noise = 2. * <a class="code" href="group__MLFalign2D.html#gaea9964961fe272b8b7277239202912cb">VSIG_ITEM</a> * <a class="code" href="classProgMLF2D.html#a9c42feb7d8cbf224f91e903bac49663e">sumw_defocus</a>[ifocus];</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            noise /= sumw_defocus[ifocus] - 1;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            <span class="comment">//if (verbose) std::cerr &lt;&lt; &quot;DEBUG_JM: noise: &quot; &lt;&lt; noise &lt;&lt; std::endl;</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            <span class="comment">//if (verbose) std::cerr &lt;&lt; &quot;DEBUG_JM: VSNR_ITEM: &quot; &lt;&lt; VSNR_ITEM &lt;&lt; std::endl;</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            <a class="code" href="group__MLFalign2D.html#gac0109c60ff8f395a896f43f1f751a227">VSNR_ITEM</a> = 0.;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            <span class="keywordflow">if</span> (noise &gt; 1e-20 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(Vavgctf2, irr) &gt; 0.)</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            {</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                <a class="code" href="group__MLFalign2D.html#gac0109c60ff8f395a896f43f1f751a227">VSNR_ITEM</a> = <a class="code" href="classProgMLF2D.html#a19dbbebd916d67da0d3e0ce5c9d77993">reduce_snr</a> * <a class="code" href="group__MLFalign2D.html#gae2592474564ce2c4143fab306b777807">VCTF_ITEM</a> * <a class="code" href="group__MLFalign2D.html#gae2592474564ce2c4143fab306b777807">VCTF_ITEM</a> *</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                            <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(spectral_signal, irr) / (<a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(Vavgctf2, irr) * noise);</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                <span class="comment">//if (verbose) std::cerr &lt;&lt; &quot;DEBUG_JM: inside cond: (noise &gt; 1e-20 &amp;&amp; dAi(Vavgctf2, irr)&quot; &lt;&lt;std::endl;</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                <span class="comment">//if (verbose) std::cerr &lt;&lt; &quot;DEBUG_JM: VCTF_ITEM: &quot; &lt;&lt; VCTF_ITEM &lt;&lt; std::endl;</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                <span class="comment">//if (verbose) std::cerr &lt;&lt; &quot;DEBUG_JM: dAi(spectral_signal, irr): &quot; &lt;&lt; dAi(spectral_signal, irr) &lt;&lt; std::endl;</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                <span class="comment">//if (verbose) std::cerr &lt;&lt; &quot;DEBUG_JM: dAi(Vavgctf2, irr): &quot; &lt;&lt; dAi(Vavgctf2, irr) &lt;&lt; std::endl;</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                <span class="comment">//if (verbose) std::cerr &lt;&lt; &quot;DEBUG_JM: noise: &quot; &lt;&lt; noise &lt;&lt; std::endl;</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                <span class="comment">//if (verbose) std::cerr &lt;&lt; &quot;DEBUG_JM: VSNR_ITEM: &quot; &lt;&lt; VSNR_ITEM &lt;&lt; std::endl;</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            }</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;            <span class="comment">// For start from already CTF-deconvoluted references:</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="classML2DBaseProgram.html#a20e2b948711e3e66894740b99e8cf017">iter</a> == <a class="code" href="classML2DBaseProgram.html#a495926025de4de5360efd7266377cc2c">istart</a> - 1) &amp;&amp; !<a class="code" href="classProgMLF2D.html#a5e967d6a01f0dcdce99c62e591bb7995">first_iter_noctf</a>)</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            {</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                <a class="code" href="group__MLFalign2D.html#gac0109c60ff8f395a896f43f1f751a227">VSNR_ITEM</a> *= <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(Vavgctf2, irr);</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                <span class="comment">//if (verbose) std::cerr &lt;&lt; &quot;DEBUG_JM: inside cond: (noise &gt; 1e-20 &amp;&amp; dAi(Vavgctf2, irr)&quot; &lt;&lt;std::endl;</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                <span class="comment">//if (verbose) std::cerr &lt;&lt; &quot;DEBUG_JM: VSNR_ITEM: &quot; &lt;&lt; VSNR_ITEM &lt;&lt; std::endl;</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            }</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            <span class="comment">// Take ini_highres_limit into account (only for first iteration)</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            <span class="keywordflow">if</span> ( <a class="code" href="classML2DBaseProgram.html#a20e2b948711e3e66894740b99e8cf017">iter</a> == 0 &amp;&amp; <a class="code" href="classProgMLF2D.html#a552a32e4f5ff63eda3ffa4708eef6f67">ini_highres_limit</a> &gt; 0. &amp;&amp; irr &gt; int_ini_highres_limit )</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            {</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                <a class="code" href="group__MLFalign2D.html#gac0109c60ff8f395a896f43f1f751a227">VSNR_ITEM</a> = 0.;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                <span class="comment">//if (verbose) std::cerr &lt;&lt; &quot;DEBUG_JM: inside cond: iter == 0 &amp;&amp; ini_highres_limit &gt; 0. &amp;&amp; irr &gt; int_ini_highres_limit&quot; &lt;&lt;std::endl;</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                <span class="comment">//if (verbose) std::cerr &lt;&lt; &quot;DEBUG_JM: VSNR_ITEM: &quot; &lt;&lt; VSNR_ITEM &lt;&lt; std::endl;</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            }</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            <span class="comment">// Subtract 1 according Unser et al.</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            <a class="code" href="group__MLFalign2D.html#gac0109c60ff8f395a896f43f1f751a227">VSNR_ITEM</a> = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(0., <a class="code" href="group__MLFalign2D.html#gac0109c60ff8f395a896f43f1f751a227">VSNR_ITEM</a> - 1.);</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            <span class="comment">// Prevent spurious high-frequency significant SNRs from random averages</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a20e2b948711e3e66894740b99e8cf017">iter</a> == 0 &amp;&amp; <a class="code" href="classML2DBaseProgram.html#acd93072cb690045eff13e91439461a6a">do_generate_refs</a>)</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            {</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                <a class="code" href="group__MLFalign2D.html#gac0109c60ff8f395a896f43f1f751a227">VSNR_ITEM</a> = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(0., <a class="code" href="group__MLFalign2D.html#gac0109c60ff8f395a896f43f1f751a227">VSNR_ITEM</a> - 2.);</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                <span class="comment">//if (verbose) std::cerr &lt;&lt; &quot;DEBUG_JM: inside cond: iter == 0 &amp;&amp; do_generate_refs&quot; &lt;&lt;std::endl;</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                <span class="comment">//if (verbose) std::cerr &lt;&lt; &quot;DEBUG_JM: VSNR_ITEM: &quot; &lt;&lt; VSNR_ITEM &lt;&lt; std::endl;</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            }</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__MLFalign2D.html#gac0109c60ff8f395a896f43f1f751a227">VSNR_ITEM</a> &gt; 0. &amp;&amp; irr &gt; maxres)</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;            {</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                maxres = irr;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                <span class="comment">//if (verbose) std::cerr &lt;&lt; &quot;DEBUG_JM: inside cond: VSNR_ITEM &gt; 0. &amp;&amp; irr &gt; maxres&quot; &lt;&lt;std::endl;</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                <span class="comment">//if (verbose) std::cerr &lt;&lt; &quot;DEBUG_JM: VSNR_ITEM: &quot; &lt;&lt; VSNR_ITEM &lt;&lt; std::endl;</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                <span class="comment">//if (verbose) std::cerr &lt;&lt; &quot;DEBUG_JM: maxres: &quot; &lt;&lt; maxres &lt;&lt; std::endl;</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            }</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        }</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    }</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">// Check that at least some frequencies have non-zero SSNR...</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keywordflow">if</span> (maxres == 0)</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a>, <span class="stringliteral">&quot;ProgMLF2D: All frequencies have zero spectral SNRs... (increase -reduce_snr) &quot;</span>);</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">do_ctf_correction</a>)</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    {</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        <span class="comment">// Pre-calculate denominator of eq 2.32b of Frank&#39;s book (2nd ed.)</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        Vdenom.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">hdim</a>);</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        <a class="code" href="group__MLFalign2D.html#ga0b5e5d4b8eb0463459e3fe178b6622cd">FOR_ALL_DIGITAL_FREQS</a>()</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        {</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            <a class="code" href="group__MLFalign2D.html#gab39599380e42cadda13b0cfb14588d46">FOR_ALL_DEFOCUS_GROUPS</a>()</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            {</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(Vdenom, irr) += sumw_defocus[ifocus] * <a class="code" href="group__MLFalign2D.html#gac0109c60ff8f395a896f43f1f751a227">VSNR_ITEM</a> * <a class="code" href="group__MLFalign2D.html#gae2592474564ce2c4143fab306b777807">VCTF_ITEM</a> * <a class="code" href="group__MLFalign2D.html#gae2592474564ce2c4143fab306b777807">VCTF_ITEM</a>;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            }</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(Vdenom, irr) += 1.;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(Vdenom, irr) /= sum_sumw_defocus;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        }</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="comment">// Calculate Wiener filters</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <a class="code" href="group__MLFalign2D.html#gab39599380e42cadda13b0cfb14588d46">FOR_ALL_DEFOCUS_GROUPS</a>()</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        {</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            <a class="code" href="group__MLFalign2D.html#ga0b5e5d4b8eb0463459e3fe178b6622cd">FOR_ALL_DIGITAL_FREQS</a>()</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            {</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="group__MLFalign2D.html#gac0109c60ff8f395a896f43f1f751a227">VSNR_ITEM</a> &gt; 0.)</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                {</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                    <a class="code" href="group__MLFalign2D.html#ga7ba3f876baf2feea5984660892eeeb8a">VDEC_ITEM</a> = <a class="code" href="group__MLFalign2D.html#gac0109c60ff8f395a896f43f1f751a227">VSNR_ITEM</a> * <a class="code" href="group__MLFalign2D.html#gae2592474564ce2c4143fab306b777807">VCTF_ITEM</a> / <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(Vdenom, irr);</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                    <span class="comment">// Prevent too strong Wiener filter artefacts</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                    <a class="code" href="group__MLFalign2D.html#ga7ba3f876baf2feea5984660892eeeb8a">VDEC_ITEM</a> = <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(10., <a class="code" href="group__MLFalign2D.html#ga7ba3f876baf2feea5984660892eeeb8a">VDEC_ITEM</a>);</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                }</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                {</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                    <a class="code" href="group__MLFalign2D.html#ga7ba3f876baf2feea5984660892eeeb8a">VDEC_ITEM</a> = 0.;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                }</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            }</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        }</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    }</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="comment">// Write Wiener filters and spectral SNR to text files</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="keywordtype">double</span> resol_step = 1. / (<a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a> * <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>);</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="keywordtype">double</span> resol_freq = 0;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordtype">double</span> resol_real = 999.;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <a class="code" href="classMDRow.html">MDRow</a> row;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a> &gt; 0)</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    {</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        fn_base = <a class="code" href="ml__refine3d_8cpp.html#a36c1b07f8f73f52294afe38445f71e17">FN_ITER_BASE</a>(<a class="code" href="classML2DBaseProgram.html#a20e2b948711e3e66894740b99e8cf017">iter</a>);</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        <span class="comment">// CTF group-specific Wiener filter files</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        <a class="code" href="group__MLFalign2D.html#gab39599380e42cadda13b0cfb14588d46">FOR_ALL_DEFOCUS_GROUPS</a>()</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        {</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            resol_freq = 0;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            <a class="code" href="classMetaData.html">MetaData</a> md;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            <a class="code" href="group__MLFalign2D.html#ga0b5e5d4b8eb0463459e3fe178b6622cd">FOR_ALL_DIGITAL_FREQS</a>()</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            {</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                noise = 2. * <a class="code" href="group__MLFalign2D.html#gaea9964961fe272b8b7277239202912cb">VSIG_ITEM</a> * sumw_defocus[ifocus];</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                noise /= (sumw_defocus[ifocus] - 1);</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                <span class="keywordflow">if</span> (irr &gt; 0)</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                    resol_real = (<a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a>*<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>)/(<span class="keywordtype">double</span>)irr;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                row.<a class="code" href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af1b0bfc38c361322955f0c0908d8f4a4">MDL_RESOLUTION_FREQ</a>, resol_freq);</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                row.<a class="code" href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a3f7e8e44545401b9e29b49aa07cb4284">MDL_RESOLUTION_SSNR</a>, <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(25., <a class="code" href="group__MLFalign2D.html#gac0109c60ff8f395a896f43f1f751a227">VSNR_ITEM</a>));</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                row.<a class="code" href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac2189a8f669546e871bf03891c5d956d">MDL_MLF_CTF</a>, <a class="code" href="group__MLFalign2D.html#gae2592474564ce2c4143fab306b777807">VCTF_ITEM</a>);</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                row.<a class="code" href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a24075040b9756ba3e41c575e0275c7ab">MDL_MLF_WIENER</a>, <a class="code" href="group__MLFalign2D.html#ga7ba3f876baf2feea5984660892eeeb8a">VDEC_ITEM</a>);</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                row.<a class="code" href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aa0aee7b7f93615b2f0cbe70ad9ad47f1">MDL_MLF_SIGNAL</a>, <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(spectral_signal, irr));</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                row.<a class="code" href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a783dd0b5e0db5a49b20a3334dc06a063">MDL_MLF_NOISE</a>, noise);</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                row.<a class="code" href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a991afb484b00dfe6f0c82427915086f5">MDL_RESOLUTION_FREQREAL</a>, resol_real);</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                md.<a class="code" href="classMetaData.html#ae389fc2b1d35096cd366aaabd3c4043a">addRow</a>(row);</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                resol_freq += resol_step;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            }</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            fn_tmp = <a class="code" href="group__MLFalign2D.html#gace9129bcfa1cd128950b15385abff09f">FN_VSIG</a>(fn_base, ifocus, <span class="stringliteral">&quot;ssnr.xmd&quot;</span>);</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            md.<a class="code" href="classMetaData.html#a163fee49247af4f55802e8480503b342">write</a>(fn_tmp, (ifocus &gt; 0 ? <a class="code" href="group__MetaData.html#ggaf446b6aff4a8c034231bfa3e1484bc47ae658bd63b5c203ea5e350a42881a57ca">MD_APPEND</a> : <a class="code" href="group__MetaData.html#ggaf446b6aff4a8c034231bfa3e1484bc47aca6136ade8aaab2a5da1a8f56f8c6dd0">MD_OVERWRITE</a>));</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        }</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    }</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="comment">// Set the current resolution limits</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a33a7368df74c02b48043acaed12b3ce7">do_include_allfreqs</a>)</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    {</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        current_probres_limit = <a class="code" href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">hdim</a>-1;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <a class="code" href="classProgMLF2D.html#aca3a507abbae9720e21b774955fccdb6">current_highres_limit</a> = <a class="code" href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">hdim</a>-1;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    }</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a77ca59aeaa398779a7f562940d1363a2">fix_high</a> &gt; 0.)</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    {</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        current_probres_limit = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>((<a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a>*<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>)/<a class="code" href="classProgMLF2D.html#a77ca59aeaa398779a7f562940d1363a2">fix_high</a>);</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        <a class="code" href="classProgMLF2D.html#aca3a507abbae9720e21b774955fccdb6">current_highres_limit</a> = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>((<a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a>*<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>)/<a class="code" href="classProgMLF2D.html#a77ca59aeaa398779a7f562940d1363a2">fix_high</a>);</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    }</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    {</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        current_probres_limit = maxres;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        <a class="code" href="classProgMLF2D.html#aca3a507abbae9720e21b774955fccdb6">current_highres_limit</a> = maxres + 5; <span class="comment">// hard-code increase_highres_limit to 5</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    }</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="comment">// Set overall high resolution limit</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    current_probres_limit = <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(current_probres_limit, int_highres_limit);</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <a class="code" href="classProgMLF2D.html#aca3a507abbae9720e21b774955fccdb6">current_highres_limit</a> = <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(<a class="code" href="classProgMLF2D.html#aca3a507abbae9720e21b774955fccdb6">current_highres_limit</a>, int_highres_limit);</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    current_probres_limit = <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(current_probres_limit, <a class="code" href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">hdim</a>);</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <a class="code" href="classProgMLF2D.html#aca3a507abbae9720e21b774955fccdb6">current_highres_limit</a> = <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(<a class="code" href="classProgMLF2D.html#aca3a507abbae9720e21b774955fccdb6">current_highres_limit</a>, <a class="code" href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">hdim</a>);</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="comment">//std::cerr &lt;&lt; &quot;DEBUG_JM(6): current_probres_limit: &quot; &lt;&lt; current_probres_limit &lt;&lt; std::endl;</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classXmippProgram.html#a0130b89f1f5431b03ef161d7e231bd48">debug</a>&gt;0)</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    {</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        std::cerr</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;current_probres_limit dependencies: &quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; hdim: &quot;</span> &lt;&lt; <a class="code" href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">hdim</a> &lt;&lt; <span class="stringliteral">&quot; dim: &quot;</span> &lt;&lt; <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a> &lt;&lt; std::endl</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; sampling: &quot;</span> &lt;&lt; <a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a> &lt;&lt; <span class="stringliteral">&quot; fix_high: &quot;</span> &lt;&lt; <a class="code" href="classProgMLF2D.html#a77ca59aeaa398779a7f562940d1363a2">fix_high</a> &lt;&lt; std::endl</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; maxres: &quot;</span> &lt;&lt; maxres &lt;&lt; <span class="stringliteral">&quot; int_highres_limit: &quot;</span> &lt;&lt; int_highres_limit &lt;&lt; std::endl;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        std::cerr&lt;&lt;<span class="stringliteral">&quot; Current resolution limits: &quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        std::cerr&lt;&lt;<span class="stringliteral">&quot; + low   res= &quot;</span>&lt;&lt;<a class="code" href="classProgMLF2D.html#a0c5751afdfd3fe27554492356c09a58c">lowres_limit</a>&lt;&lt;<span class="stringliteral">&quot; Ang (&quot;</span>&lt;&lt;int_lowres_limit&lt;&lt;<span class="stringliteral">&quot; shell)&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        std::cerr&lt;&lt;<span class="stringliteral">&quot; + prob. res= &quot;</span>&lt;&lt;<a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a>*<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>/current_probres_limit&lt;&lt;<span class="stringliteral">&quot; Ang (&quot;</span>&lt;&lt;current_probres_limit&lt;&lt;<span class="stringliteral">&quot; shell)&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        std::cerr&lt;&lt;<span class="stringliteral">&quot; + extra res= &quot;</span>&lt;&lt;<a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a>*<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>/<a class="code" href="classProgMLF2D.html#aca3a507abbae9720e21b774955fccdb6">current_highres_limit</a>&lt;&lt;<span class="stringliteral">&quot; Ang (&quot;</span>&lt;&lt;<a class="code" href="classProgMLF2D.html#aca3a507abbae9720e21b774955fccdb6">current_highres_limit</a>&lt;&lt;<span class="stringliteral">&quot; shell)&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        std::cerr&lt;&lt;<span class="stringliteral">&quot; + high  res= &quot;</span>&lt;&lt;<a class="code" href="classProgMLF2D.html#a27f1ed8b93ea62c3e3727f7fa57f41b8">highres_limit</a>&lt;&lt;<span class="stringliteral">&quot; Ang (&quot;</span>&lt;&lt;int_highres_limit&lt;&lt;<span class="stringliteral">&quot; shell)&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    }</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="comment">// Get the new pointers to all pixels in FourierTransformHalf</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    Maux.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>, <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>);</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    Maux.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <a class="code" href="group__Fourier.html#ga5ed410a4eb328191715155101e93758e">FourierTransformHalf</a>(Maux, Faux);</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <a class="code" href="classProgMLF2D.html#a26c5a01345ef85eaabf6056c0f76f848">pointer_2d</a>.clear();</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <a class="code" href="classProgMLF2D.html#ae34810925acecb7d097272aae20cf26b">pointer_i</a>.clear();</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <a class="code" href="classProgMLF2D.html#ac0756608605967a063784669478c62bf">pointer_j</a>.clear();</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="comment">// First, get the pixels to use in the probability calculations:</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="comment">// These are within [lowres_limit,current_probres_limit]</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <a class="code" href="classProgMLF2D.html#a963f62304538d74f796a3d20475480ee">nr_points_prob</a> = 0;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a>(Faux)</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    {</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        <span class="keywordtype">size_t</span> ires = <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(<a class="code" href="classProgMLF2D.html#a78ef99a6261c8c228ca1bab9f0c2205a">Mresol_int</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        <span class="keywordflow">if</span> (ires &gt; int_lowres_limit &amp;&amp;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            ires &lt;= current_probres_limit &amp;&amp;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            !(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> == 0 &amp;&amp; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &gt; <a class="code" href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">hdim</a>) ) <span class="comment">// exclude first half row in FourierTransformHalf</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        {</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            <a class="code" href="classProgMLF2D.html#a26c5a01345ef85eaabf6056c0f76f848">pointer_2d</a>.push_back(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>*<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Maux) + <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;            <a class="code" href="classProgMLF2D.html#ae34810925acecb7d097272aae20cf26b">pointer_i</a>.push_back(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            <a class="code" href="classProgMLF2D.html#ac0756608605967a063784669478c62bf">pointer_j</a>.push_back(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;            ++<a class="code" href="classProgMLF2D.html#a963f62304538d74f796a3d20475480ee">nr_points_prob</a>;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        }</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    }</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="comment">// Second, get the rest of the currently relevant pixels:</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="comment">// These are within [0,lowres_limit&gt; and between &lt;current_probres_limit,current_highres_limit]</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <a class="code" href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">nr_points_2d</a> = <a class="code" href="classProgMLF2D.html#a963f62304538d74f796a3d20475480ee">nr_points_prob</a>;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a>(Faux)</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    {</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        <span class="keywordtype">size_t</span> ires = <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(<a class="code" href="classProgMLF2D.html#a78ef99a6261c8c228ca1bab9f0c2205a">Mresol_int</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <span class="keywordflow">if</span> ( (ires &lt;= int_lowres_limit || ires &gt; current_probres_limit) &amp;&amp;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;             ires &lt;= <a class="code" href="classProgMLF2D.html#aca3a507abbae9720e21b774955fccdb6">current_highres_limit</a> &amp;&amp;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;             !(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> == 0 &amp;&amp; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &gt; <a class="code" href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">hdim</a>) ) <span class="comment">// exclude first half row in FourierTransformHalf</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        {</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            <a class="code" href="classProgMLF2D.html#a26c5a01345ef85eaabf6056c0f76f848">pointer_2d</a>.push_back(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>*<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Maux) + <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;            <a class="code" href="classProgMLF2D.html#ae34810925acecb7d097272aae20cf26b">pointer_i</a>.push_back(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            <a class="code" href="classProgMLF2D.html#ac0756608605967a063784669478c62bf">pointer_j</a>.push_back(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            <a class="code" href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">nr_points_2d</a>++;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        }</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    }</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <a class="code" href="classProgMLF2D.html#a2839dd97c6d6098e665b16bed661b615">dnr_points_2d</a> = 2 * <a class="code" href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">nr_points_2d</a>;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classXmippProgram.html#a0130b89f1f5431b03ef161d7e231bd48">debug</a>&gt;0)</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    {</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        std::cerr&lt;&lt;<span class="stringliteral">&quot;nr_points_2d= &quot;</span>&lt;&lt;<a class="code" href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">nr_points_2d</a>&lt;&lt;<span class="stringliteral">&quot; nr_points_prob= &quot;</span>&lt;&lt;<a class="code" href="classProgMLF2D.html#a963f62304538d74f796a3d20475480ee">nr_points_prob</a>&lt;&lt;std::endl;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    }</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="comment">// For variable in-plane sampling rates</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <a class="code" href="classProgMLF2D.html#a501c85d59b6f2dc691f93c2afde6455f">setCurrentSamplingRates</a>(<a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a>*<a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>/current_probres_limit);</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;}</div><div class="ttc" id="group__Fourier_html_ga5ed410a4eb328191715155101e93758e"><div class="ttname"><a href="group__Fourier.html#ga5ed410a4eb328191715155101e93758e">FourierTransformHalf</a></div><div class="ttdeci">void FourierTransformHalf(const MultidimArray&lt; double &gt; &amp;in, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8cpp_source.html#l00187">xmipp_fft.cpp:187</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a0c5751afdfd3fe27554492356c09a58c"><div class="ttname"><a href="classProgMLF2D.html#a0c5751afdfd3fe27554492356c09a58c">ProgMLF2D::lowres_limit</a></div><div class="ttdeci">double lowres_limit</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00116">mlf_align2d.h:116</a></div></div>
<div class="ttc" id="classMetaData_html_a163fee49247af4f55802e8480503b342"><div class="ttname"><a href="classMetaData.html#a163fee49247af4f55802e8480503b342">MetaData::write</a></div><div class="ttdeci">void write(const FileName &amp;outFile, WriteModeMetaData mode=MD_OVERWRITE) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00907">metadata.cpp:907</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_acd93072cb690045eff13e91439461a6a"><div class="ttname"><a href="classML2DBaseProgram.html#acd93072cb690045eff13e91439461a6a">ML2DBaseProgram::do_generate_refs</a></div><div class="ttdeci">bool do_generate_refs</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00198">ml2d.h:198</a></div></div>
<div class="ttc" id="group__Macros_html_gae0a4180e923e3ffca3989e20e441aa3c"><div class="ttname"><a href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a></div><div class="ttdeci">#define XMIPP_MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00193">xmipp_macros.h:193</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a3f7e8e44545401b9e29b49aa07cb4284"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a3f7e8e44545401b9e29b49aa07cb4284">MDL_RESOLUTION_SSNR</a></div><div class="ttdoc">Fourier shell correlation (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00375">metadata_label.h:375</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a77ca59aeaa398779a7f562940d1363a2"><div class="ttname"><a href="classProgMLF2D.html#a77ca59aeaa398779a7f562940d1363a2">ProgMLF2D::fix_high</a></div><div class="ttdeci">double fix_high</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00124">mlf_align2d.h:124</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a27f1ed8b93ea62c3e3727f7fa57f41b8"><div class="ttname"><a href="classProgMLF2D.html#a27f1ed8b93ea62c3e3727f7fa57f41b8">ProgMLF2D::highres_limit</a></div><div class="ttdeci">double highres_limit</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00116">mlf_align2d.h:116</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a20e2b948711e3e66894740b99e8cf017"><div class="ttname"><a href="classML2DBaseProgram.html#a20e2b948711e3e66894740b99e8cf017">ML2DBaseProgram::iter</a></div><div class="ttdeci">int iter</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00147">ml2d.h:147</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a78ef99a6261c8c228ca1bab9f0c2205a"><div class="ttname"><a href="classProgMLF2D.html#a78ef99a6261c8c228ca1bab9f0c2205a">ProgMLF2D::Mresol_int</a></div><div class="ttdeci">MultidimArray&lt; size_t &gt; Mresol_int</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00108">mlf_align2d.h:108</a></div></div>
<div class="ttc" id="classMetaData_html"><div class="ttname"><a href="classMetaData.html">MetaData</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00234">metadata.h:234</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a9c42feb7d8cbf224f91e903bac49663e"><div class="ttname"><a href="classProgMLF2D.html#a9c42feb7d8cbf224f91e903bac49663e">ProgMLF2D::sumw_defocus</a></div><div class="ttdeci">std::vector&lt; double &gt; sumw_defocus</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00156">mlf_align2d.h:156</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gab39599380e42cadda13b0cfb14588d46"><div class="ttname"><a href="group__MLFalign2D.html#gab39599380e42cadda13b0cfb14588d46">FOR_ALL_DEFOCUS_GROUPS</a></div><div class="ttdeci">#define FOR_ALL_DEFOCUS_GROUPS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00040">mlf_align2d.h:40</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gac0109c60ff8f395a896f43f1f751a227"><div class="ttname"><a href="group__MLFalign2D.html#gac0109c60ff8f395a896f43f1f751a227">VSNR_ITEM</a></div><div class="ttdeci">#define VSNR_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00046">mlf_align2d.h:46</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a26c5a01345ef85eaabf6056c0f76f848"><div class="ttname"><a href="classProgMLF2D.html#a26c5a01345ef85eaabf6056c0f76f848">ProgMLF2D::pointer_2d</a></div><div class="ttdeci">std::vector&lt; int &gt; pointer_2d</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00126">mlf_align2d.h:126</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a5e967d6a01f0dcdce99c62e591bb7995"><div class="ttname"><a href="classProgMLF2D.html#a5e967d6a01f0dcdce99c62e591bb7995">ProgMLF2D::first_iter_noctf</a></div><div class="ttdeci">bool first_iter_noctf</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00118">mlf_align2d.h:118</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a90e6ce499655b4566e17e32102a905c4"><div class="ttname"><a href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">ML2DBaseProgram::hdim</a></div><div class="ttdeci">size_t hdim</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00151">ml2d.h:151</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00068">xmipp_filename.h:68</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a7e08de076e12e519d59f5e39854f1dc5"><div class="ttname"><a href="classProgMLF2D.html#a7e08de076e12e519d59f5e39854f1dc5">ProgMLF2D::nr_focus</a></div><div class="ttdeci">size_t nr_focus</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00114">mlf_align2d.h:114</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classProgMLF2D_html_aca3a507abbae9720e21b774955fccdb6"><div class="ttname"><a href="classProgMLF2D.html#aca3a507abbae9720e21b774955fccdb6">ProgMLF2D::current_highres_limit</a></div><div class="ttdeci">size_t current_highres_limit</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00129">mlf_align2d.h:129</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a19dbbebd916d67da0d3e0ce5c9d77993"><div class="ttname"><a href="classProgMLF2D.html#a19dbbebd916d67da0d3e0ce5c9d77993">ProgMLF2D::reduce_snr</a></div><div class="ttdeci">double reduce_snr</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00112">mlf_align2d.h:112</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_ga0b5e5d4b8eb0463459e3fe178b6622cd"><div class="ttname"><a href="group__MLFalign2D.html#ga0b5e5d4b8eb0463459e3fe178b6622cd">FOR_ALL_DIGITAL_FREQS</a></div><div class="ttdeci">#define FOR_ALL_DIGITAL_FREQS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00041">mlf_align2d.h:41</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ac0756608605967a063784669478c62bf"><div class="ttname"><a href="classProgMLF2D.html#ac0756608605967a063784669478c62bf">ProgMLF2D::pointer_j</a></div><div class="ttdeci">std::vector&lt; int &gt; pointer_j</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00126">mlf_align2d.h:126</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_ga7ba3f876baf2feea5984660892eeeb8a"><div class="ttname"><a href="group__MLFalign2D.html#ga7ba3f876baf2feea5984660892eeeb8a">VDEC_ITEM</a></div><div class="ttdeci">#define VDEC_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00048">mlf_align2d.h:48</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a2839dd97c6d6098e665b16bed661b615"><div class="ttname"><a href="classProgMLF2D.html#a2839dd97c6d6098e665b16bed661b615">ProgMLF2D::dnr_points_2d</a></div><div class="ttdeci">size_t dnr_points_2d</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00127">mlf_align2d.h:127</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a991afb484b00dfe6f0c82427915086f5"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a991afb484b00dfe6f0c82427915086f5">MDL_RESOLUTION_FREQREAL</a></div><div class="ttdoc">Frequency in A (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00373">metadata_label.h:373</a></div></div>
<div class="ttc" id="ml__refine3d_8cpp_html_a36c1b07f8f73f52294afe38445f71e17"><div class="ttname"><a href="ml__refine3d_8cpp.html#a36c1b07f8f73f52294afe38445f71e17">FN_ITER_BASE</a></div><div class="ttdeci">#define FN_ITER_BASE(iter)</div><div class="ttdef"><b>Definition:</b> <a href="ml__refine3d_8cpp_source.html#l00050">ml_refine3d.cpp:50</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78aa0aee7b7f93615b2f0cbe70ad9ad47f1"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aa0aee7b7f93615b2f0cbe70ad9ad47f1">MDL_MLF_SIGNAL</a></div><div class="ttdoc">MLF signal (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00290">metadata_label.h:290</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a33a7368df74c02b48043acaed12b3ce7"><div class="ttname"><a href="classProgMLF2D.html#a33a7368df74c02b48043acaed12b3ce7">ProgMLF2D::do_include_allfreqs</a></div><div class="ttdeci">bool do_include_allfreqs</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00122">mlf_align2d.h:122</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gafa02b309a507bf04daf9f31fa828ce4f"><div class="ttname"><a href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a></div><div class="ttdeci">#define dAij(M, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00355">multidim_array.h:355</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a495926025de4de5360efd7266377cc2c"><div class="ttname"><a href="classML2DBaseProgram.html#a495926025de4de5360efd7266377cc2c">ML2DBaseProgram::istart</a></div><div class="ttdeci">int istart</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00145">ml2d.h:145</a></div></div>
<div class="ttc" id="group__MetaData_html_ggaf446b6aff4a8c034231bfa3e1484bc47ae658bd63b5c203ea5e350a42881a57ca"><div class="ttname"><a href="group__MetaData.html#ggaf446b6aff4a8c034231bfa3e1484bc47ae658bd63b5c203ea5e350a42881a57ca">MD_APPEND</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00060">metadata.h:60</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ae96de19117479eb8bf594268bb9af590"><div class="ttname"><a href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">ML2DBaseProgram::dim</a></div><div class="ttdeci">size_t dim</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00151">ml2d.h:151</a></div></div>
<div class="ttc" id="classXmippProgram_html_aed62cfe3c074e69076bf348fc101a717"><div class="ttname"><a href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">XmippProgram::verbose</a></div><div class="ttdeci">int verbose</div><div class="ttdoc">Verbosity level. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8h_source.html#l00168">xmipp_program.h:168</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a7c3f7c47054265ad3589ee6d40764fbc"><div class="ttname"><a href="classProgMLF2D.html#a7c3f7c47054265ad3589ee6d40764fbc">ProgMLF2D::do_ctf_correction</a></div><div class="ttdeci">bool do_ctf_correction</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00100">mlf_align2d.h:100</a></div></div>
<div class="ttc" id="group__Macros_html_gac9ae6a207f10c821b06a8c0df153a7d5"><div class="ttname"><a href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a></div><div class="ttdeci">#define XMIPP_MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00181">xmipp_macros.h:181</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga53e37122134100316031eae982abee03"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a></div><div class="ttdeci">#define dAi(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00540">multidim_array.h:540</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af1b0bfc38c361322955f0c0908d8f4a4"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af1b0bfc38c361322955f0c0908d8f4a4">MDL_RESOLUTION_FREQ</a></div><div class="ttdoc">Frequency in 1/A (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00371">metadata_label.h:371</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a501c85d59b6f2dc691f93c2afde6455f"><div class="ttname"><a href="classProgMLF2D.html#a501c85d59b6f2dc691f93c2afde6455f">ProgMLF2D::setCurrentSamplingRates</a></div><div class="ttdeci">void setCurrentSamplingRates(double current_probres_limit)</div><div class="ttdoc">Vary in-plane and translational sampling rates with resolution. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l01123">mlf_align2d.cpp:1123</a></div></div>
<div class="ttc" id="classXmippProgram_html_a0130b89f1f5431b03ef161d7e231bd48"><div class="ttname"><a href="classXmippProgram.html#a0130b89f1f5431b03ef161d7e231bd48">XmippProgram::debug</a></div><div class="ttdeci">int debug</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8h_source.html#l00170">xmipp_program.h:170</a></div></div>
<div class="ttc" id="classMDRow_html_a916bbf19ab9a48f400800160b9b581fa"><div class="ttname"><a href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">MDRow::setValue</a></div><div class="ttdeci">void setValue(MDLabel label, const T &amp;d, bool addLabel=true)</div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l01168">metadata_label.h:1168</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4e8db4e5757ca2f6e233d0a1eec7ff1c"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00519">multidim_array.h:519</a></div></div>
<div class="ttc" id="xmipp__log_8h_html_a9d0e78c69b9733e4419a5f65d5a38a3a"><div class="ttname"><a href="xmipp__log_8h.html#a9d0e78c69b9733e4419a5f65d5a38a3a">LOG_FUNCTION</a></div><div class="ttdeci">#define LOG_FUNCTION()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__log_8h_source.html#l00090">xmipp_log.h:90</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac2189a8f669546e871bf03891c5d956d"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac2189a8f669546e871bf03891c5d956d">MDL_MLF_CTF</a></div><div class="ttdoc">MLF CTF estimated value (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00288">metadata_label.h:288</a></div></div>
<div class="ttc" id="classProgMLF2D_html_af1176823dd265484796aa9b52215719e"><div class="ttname"><a href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">ProgMLF2D::sampling</a></div><div class="ttdeci">double sampling</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00102">mlf_align2d.h:102</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gace9129bcfa1cd128950b15385abff09f"><div class="ttname"><a href="group__MLFalign2D.html#gace9129bcfa1cd128950b15385abff09f">FN_VSIG</a></div><div class="ttdeci">#define FN_VSIG(base, ifocus, ext)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00066">mlf_align2d.h:66</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gae2592474564ce2c4143fab306b777807"><div class="ttname"><a href="group__MLFalign2D.html#gae2592474564ce2c4143fab306b777807">VCTF_ITEM</a></div><div class="ttdeci">#define VCTF_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00047">mlf_align2d.h:47</a></div></div>
<div class="ttc" id="classMetaData_html_ae389fc2b1d35096cd366aaabd3c4043a"><div class="ttname"><a href="classMetaData.html#ae389fc2b1d35096cd366aaabd3c4043a">MetaData::addRow</a></div><div class="ttdeci">size_t addRow(const MDRow &amp;row)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00538">metadata.cpp:538</a></div></div>
<div class="ttc" id="classMDRow_html"><div class="ttname"><a href="classMDRow.html">MDRow</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l01087">metadata_label.h:1087</a></div></div>
<div class="ttc" id="classProgMLF2D_html_ae34810925acecb7d097272aae20cf26b"><div class="ttname"><a href="classProgMLF2D.html#ae34810925acecb7d097272aae20cf26b">ProgMLF2D::pointer_i</a></div><div class="ttdeci">std::vector&lt; int &gt; pointer_i</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00126">mlf_align2d.h:126</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a></div><div class="ttdoc">Incorrect value received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00200">xmipp_error.h:200</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a24075040b9756ba3e41c575e0275c7ab"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a24075040b9756ba3e41c575e0275c7ab">MDL_MLF_WIENER</a></div><div class="ttdoc">MLF Wiener filter (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00289">metadata_label.h:289</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gaea9964961fe272b8b7277239202912cb"><div class="ttname"><a href="group__MLFalign2D.html#gaea9964961fe272b8b7277239202912cb">VSIG_ITEM</a></div><div class="ttdeci">#define VSIG_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00049">mlf_align2d.h:49</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a963f62304538d74f796a3d20475480ee"><div class="ttname"><a href="classProgMLF2D.html#a963f62304538d74f796a3d20475480ee">ProgMLF2D::nr_points_prob</a></div><div class="ttdeci">size_t nr_points_prob</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00127">mlf_align2d.h:127</a></div></div>
<div class="ttc" id="group__MetaData_html_ggaf446b6aff4a8c034231bfa3e1484bc47aca6136ade8aaab2a5da1a8f56f8c6dd0"><div class="ttname"><a href="group__MetaData.html#ggaf446b6aff4a8c034231bfa3e1484bc47aca6136ade8aaab2a5da1a8f56f8c6dd0">MD_OVERWRITE</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00059">metadata.h:59</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a552a32e4f5ff63eda3ffa4708eef6f67"><div class="ttname"><a href="classProgMLF2D.html#a552a32e4f5ff63eda3ffa4708eef6f67">ProgMLF2D::ini_highres_limit</a></div><div class="ttdeci">double ini_highres_limit</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00116">mlf_align2d.h:116</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a783dd0b5e0db5a49b20a3334dc06a063"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a783dd0b5e0db5a49b20a3334dc06a063">MDL_MLF_NOISE</a></div><div class="ttdoc">MLF Wiener filter (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00291">metadata_label.h:291</a></div></div>
<div class="ttc" id="classProgMLF2D_html_af7f2b4639397c6f14e13371207476c06"><div class="ttname"><a href="classProgMLF2D.html#af7f2b4639397c6f14e13371207476c06">ProgMLF2D::nr_points_2d</a></div><div class="ttdeci">size_t nr_points_2d</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00127">mlf_align2d.h:127</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8540e7e059c7bc46e2a010d25225d08b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::writeNoiseFile </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFileName.html">FileName</a> &amp;&#160;</td>
          <td class="paramname"><em>fn_base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ifocus</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write noise estimation per resolution. </p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l02848">2848</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;{</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    <a class="code" href="xmipp__log_8h.html#a485ad250637a874aa112548b4133e8d0">LOG_LEVEL</a>(<a class="code" href="classProgMLF2D.html#a8540e7e059c7bc46e2a010d25225d08b">writeNoiseFile</a>);</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;    <a class="code" href="classMetaData.html">MetaData</a> md;</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;    <span class="comment">// Calculate resolution step</span></div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;    <span class="keywordtype">double</span> resol_step = 1. / (<a class="code" href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">sampling</a> * <a class="code" href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">dim</a>);</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    md.<a class="code" href="classMetaData.html#af355f70b7c6675ba2ca01cdc46b3b96f">addLabel</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af1b0bfc38c361322955f0c0908d8f4a4">MDL_RESOLUTION_FREQ</a>);</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;    <a class="code" href="group__MLFalign2D.html#ga0b5e5d4b8eb0463459e3fe178b6622cd">FOR_ALL_DIGITAL_FREQS</a>()</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;    md.setValue(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a783dd0b5e0db5a49b20a3334dc06a063">MDL_MLF_NOISE</a>, <a class="code" href="group__MLFalign2D.html#gaea9964961fe272b8b7277239202912cb">VSIG_ITEM</a>, md.addObject());</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;    md.fillLinear(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af1b0bfc38c361322955f0c0908d8f4a4">MDL_RESOLUTION_FREQ</a>, 0., resol_step);</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;    <span class="comment">// write Vsig vector to disc</span></div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;    md.write(<a class="code" href="group__MLFalign2D.html#gace9129bcfa1cd128950b15385abff09f">FN_VSIG</a>(fn_base, ifocus, &quot;noise.xmd&quot;), (ifocus &gt; 0 ? <a class="code" href="group__MetaData.html#ggaf446b6aff4a8c034231bfa3e1484bc47ae658bd63b5c203ea5e350a42881a57ca">MD_APPEND</a> : <a class="code" href="group__MetaData.html#ggaf446b6aff4a8c034231bfa3e1484bc47aca6136ade8aaab2a5da1a8f56f8c6dd0">MD_OVERWRITE</a>));</div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;</div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;}<span class="comment">//function writeNoiseFile</span></div><div class="ttc" id="classMetaData_html"><div class="ttname"><a href="classMetaData.html">MetaData</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00234">metadata.h:234</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_ga0b5e5d4b8eb0463459e3fe178b6622cd"><div class="ttname"><a href="group__MLFalign2D.html#ga0b5e5d4b8eb0463459e3fe178b6622cd">FOR_ALL_DIGITAL_FREQS</a></div><div class="ttdeci">#define FOR_ALL_DIGITAL_FREQS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00041">mlf_align2d.h:41</a></div></div>
<div class="ttc" id="group__MetaData_html_ggaf446b6aff4a8c034231bfa3e1484bc47ae658bd63b5c203ea5e350a42881a57ca"><div class="ttname"><a href="group__MetaData.html#ggaf446b6aff4a8c034231bfa3e1484bc47ae658bd63b5c203ea5e350a42881a57ca">MD_APPEND</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00060">metadata.h:60</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ae96de19117479eb8bf594268bb9af590"><div class="ttname"><a href="classML2DBaseProgram.html#ae96de19117479eb8bf594268bb9af590">ML2DBaseProgram::dim</a></div><div class="ttdeci">size_t dim</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00151">ml2d.h:151</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a8540e7e059c7bc46e2a010d25225d08b"><div class="ttname"><a href="classProgMLF2D.html#a8540e7e059c7bc46e2a010d25225d08b">ProgMLF2D::writeNoiseFile</a></div><div class="ttdeci">void writeNoiseFile(const FileName &amp;fn_base, int ifocus)</div><div class="ttdoc">Write noise estimation per resolution. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l02848">mlf_align2d.cpp:2848</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af1b0bfc38c361322955f0c0908d8f4a4"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af1b0bfc38c361322955f0c0908d8f4a4">MDL_RESOLUTION_FREQ</a></div><div class="ttdoc">Frequency in 1/A (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00371">metadata_label.h:371</a></div></div>
<div class="ttc" id="xmipp__log_8h_html_a485ad250637a874aa112548b4133e8d0"><div class="ttname"><a href="xmipp__log_8h.html#a485ad250637a874aa112548b4133e8d0">LOG_LEVEL</a></div><div class="ttdeci">#define LOG_LEVEL(msg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__log_8h_source.html#l00089">xmipp_log.h:89</a></div></div>
<div class="ttc" id="classProgMLF2D_html_af1176823dd265484796aa9b52215719e"><div class="ttname"><a href="classProgMLF2D.html#af1176823dd265484796aa9b52215719e">ProgMLF2D::sampling</a></div><div class="ttdeci">double sampling</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00102">mlf_align2d.h:102</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gace9129bcfa1cd128950b15385abff09f"><div class="ttname"><a href="group__MLFalign2D.html#gace9129bcfa1cd128950b15385abff09f">FN_VSIG</a></div><div class="ttdeci">#define FN_VSIG(base, ifocus, ext)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00066">mlf_align2d.h:66</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gaea9964961fe272b8b7277239202912cb"><div class="ttname"><a href="group__MLFalign2D.html#gaea9964961fe272b8b7277239202912cb">VSIG_ITEM</a></div><div class="ttdeci">#define VSIG_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00049">mlf_align2d.h:49</a></div></div>
<div class="ttc" id="group__MetaData_html_ggaf446b6aff4a8c034231bfa3e1484bc47aca6136ade8aaab2a5da1a8f56f8c6dd0"><div class="ttname"><a href="group__MetaData.html#ggaf446b6aff4a8c034231bfa3e1484bc47aca6136ade8aaab2a5da1a8f56f8c6dd0">MD_OVERWRITE</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00059">metadata.h:59</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a783dd0b5e0db5a49b20a3334dc06a063"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a783dd0b5e0db5a49b20a3334dc06a063">MDL_MLF_NOISE</a></div><div class="ttdoc">MLF Wiener filter (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00291">metadata_label.h:291</a></div></div>
<div class="ttc" id="classMetaData_html_af355f70b7c6675ba2ca01cdc46b3b96f"><div class="ttname"><a href="classMetaData.html#af355f70b7c6675ba2ca01cdc46b3b96f">MetaData::addLabel</a></div><div class="ttdeci">bool addLabel(const MDLabel label, int pos=-1)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00712">metadata.cpp:712</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a52205b353efd0a5130f3a8506409b7f2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProgMLF2D::writeOutputFiles </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classModelML2D.html">ModelML2D</a> &amp;&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ml2d_8h.html#a4e0517338e6c4a31a2addafc06d4f3a3">OutputType</a>&#160;</td>
          <td class="paramname"><em>outputType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write out reference images, selfile and logfile. </p>

<p>Implements <a class="el" href="classML2DBaseProgram.html#acf964c3a2f7facb93d3a50233d542e4f">ML2DBaseProgram</a>.</p>

<p>Reimplemented in <a class="el" href="classMpiProgMLF2D.html#ab10b4f664364b5b008b13f72a0b4723f">MpiProgMLF2D</a>.</p>

<p>Definition at line <a class="el" href="mlf__align2d_8cpp_source.html#l02686">2686</a> of file <a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;{</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    <a class="code" href="classFileName.html">FileName</a>          fn_tmp, fn_base;</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    <a class="code" href="classImage.html">Image&lt;double&gt;</a>        Itmp;</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;    <a class="code" href="classMetaData.html">MetaData</a>          MDo;</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;    <a class="code" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a>       comment;</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;    std::ofstream     fh;</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;    <span class="keywordtype">size_t</span> id;</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;    <span class="keywordtype">bool</span> write_conv = !<a class="code" href="classML2DBaseProgram.html#a963af5cdb6f63d876c147c24fbf8452e">do_ML3D</a>;</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;    <span class="comment">//Only override first time</span></div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a20e2b948711e3e66894740b99e8cf017">iter</a> == 0)</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;        write_conv = <span class="keyword">false</span>;</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;    fn_base = (outputType == <a class="code" href="ml2d_8h.html#a4e0517338e6c4a31a2addafc06d4f3a3aaf0fce4b419a64beac8ea79227577e27">OUT_ITER</a> || outputType == <a class="code" href="ml2d_8h.html#a4e0517338e6c4a31a2addafc06d4f3a3a2de4bf60bbff3a00593fa0db7834c71a">OUT_REFS</a>) ?</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;              <a class="code" href="group__MLalign2D.html#ga37dd4c436766acd586ca95f773236000">getIterExtraPath</a>(<a class="code" href="classML2DBaseProgram.html#adfab8933f95443ac6d909a9b206b3fa8">fn_root</a>, <a class="code" href="classML2DBaseProgram.html#a20e2b948711e3e66894740b99e8cf017">iter</a>) : <a class="code" href="classML2DBaseProgram.html#adfab8933f95443ac6d909a9b206b3fa8">fn_root</a>;</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    <span class="comment">//    {</span></div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;    <span class="comment">//        fn_base = getIterExtraPath(fn_root, iter);</span></div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;    <span class="comment">//        fn_prefix = FN_ITER_PREFIX(iter);</span></div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;    <span class="comment">//    }</span></div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;    <span class="comment">// Write out optimal image orientations</span></div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    fn_tmp = <a class="code" href="ml2d_8h.html#a110de41c02a5f818c5a698293cf0b9e8">FN_IMAGES_MD</a>(fn_base);</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>.<a class="code" href="classMetaData.html#a163fee49247af4f55802e8480503b342">write</a>(fn_tmp);</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;    <span class="comment">// Write out current reference images and fill sel &amp; log-file</span></div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;    <span class="comment">// First time for _ref, second time for _cref</span></div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    <a class="code" href="classFileName.html">FileName</a> fn_base_cref = <a class="code" href="group__MLFalign2D.html#ga752a41b82a33bedb80a8e2c19f7ab999">FN_CREF_IMG</a>;</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    <a class="code" href="classMDRow.html">MDRow</a> row;</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;    <a class="code" href="classMDIterator.html">MDIterator</a> mdIter(<a class="code" href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">MDref</a>);</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;    MDo = <a class="code" href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">MDref</a>;</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> refno = 0; refno &lt; model.<a class="code" href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">n_ref</a>; ++refno, mdIter.moveNext())</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;    {</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;        <span class="comment">//row.setValue(MDL_ITER, iter);</span></div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;        row.<a class="code" href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a3637da3214664c45458ae3e56a92c88e">MDL_REF</a>, refno + 1);</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#ad9b9535e1774d805e5bbee89dee0f4b5">do_mirror</a>)</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;            row.<a class="code" href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a0704d0153add5aa8abcf3e82bb174ebc">MDL_MIRRORFRAC</a>, <a class="code" href="classProgMLF2D.html#a619e2aed7d1934de3ce40d04b4d160b3">mirror_fraction</a>[refno]);</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;        <span class="keywordflow">if</span> (write_conv)</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;            row.<a class="code" href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a94561c5c01993bb73d33426fdfcc9338">MDL_SIGNALCHANGE</a>, <a class="code" href="classML2DBaseProgram.html#a3b21e31f64ae12053ef1192ef39e309e">conv</a>[refno]*1000);</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">do_norm</a>)</div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;            row.<a class="code" href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a29c393fe6e00aa337783865f8694b0af">MDL_INTSCALE</a>, <a class="code" href="classProgMLF2D.html#a2fd51100d35db6ecdcb3ac704ab58435">refs_avgscale</a>[refno]);</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;        <span class="comment">//write ctf</span></div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;        fn_tmp.<a class="code" href="classFileName.html#ab10d5ada0f956aef14ae171f12587d56">compose</a>(refno + 1, fn_base_cref);</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;        <a class="code" href="mlf__align2d_8cpp.html#a1b2581498728b00156cf6124bb8aba51">writeImage</a>(<a class="code" href="classProgMLF2D.html#abe2d74f54f4aa6916eb6f6d29164e023">Ictf</a>[refno], fn_tmp, row);</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;        MDo.<a class="code" href="classMetaData.html#a953446525b885033ebec09c77dbfceba">setRow</a>(row, mdIter.objId);</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;        <span class="comment">//write image</span></div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;        fn_tmp = <a class="code" href="group__MLFalign2D.html#ga4b64e613a26295aa34dbe4301f1374a4">FN_REF</a>(fn_base, refno + 1);</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;        Itmp = model.<a class="code" href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">Iref</a>[refno];</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;        <a class="code" href="mlf__align2d_8cpp.html#a1b2581498728b00156cf6124bb8aba51">writeImage</a>(Itmp, fn_tmp, row);</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;        <a class="code" href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">MDref</a>.<a class="code" href="classMetaData.html#a953446525b885033ebec09c77dbfceba">setRow</a>(row, mdIter.objId);</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;    }</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    <span class="comment">// Write out reference md file</span></div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;    MDo.<a class="code" href="classMetaData.html#a163fee49247af4f55802e8480503b342">write</a>(<a class="code" href="group__MLFalign2D.html#gaa662886e98cc46ddfdca0d9210670599">FN_CREF_IMG_MD</a>);</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;    <a class="code" href="classML2DBaseProgram.html#ac3eac3d0fb4000223088846bee6bcb0b">outRefsMd</a> = <a class="code" href="ml2d_8h.html#a8ef0c472d79a03426c3c02f8777ef3c3">FN_CLASSES_MD</a>(fn_base);</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;    <a class="code" href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">MDref</a>.<a class="code" href="classMetaData.html#a163fee49247af4f55802e8480503b342">write</a>(<a class="code" href="classML2DBaseProgram.html#ac3eac3d0fb4000223088846bee6bcb0b">outRefsMd</a>);</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;    <span class="comment">// Write out log-file</span></div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;    <a class="code" href="classMetaData.html">MetaData</a> mdLog;</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    <span class="comment">//mdLog.setComment(cline);</span></div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    <span class="keywordtype">id</span> = mdLog.<a class="code" href="classMetaData.html#acd6018636eda733443f3df6c61978faa">addObject</a>();</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;    mdLog.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78abbbbb24eaf2b80e9a7ed50bd6075e833">MDL_ITER</a>, <a class="code" href="classML2DBaseProgram.html#a20e2b948711e3e66894740b99e8cf017">iter</a>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    mdLog.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78afdd72c29a4e9b5f719e1dadfd823ac78">MDL_LL</a>, <a class="code" href="classProgMLF2D.html#a62bd5315721add5edf8b74e19c7d2de8">LL</a>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    mdLog.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ad8a81df6271e91f540f943bf8ef0d192">MDL_PMAX</a>, <a class="code" href="classProgMLF2D.html#abc9875f9cb5025678bebb8eff54a1118">sumcorr</a>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;    mdLog.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a44d2f7bdda1efb37f9218b2ac4eb8a2c">MDL_SIGMAOFFSET</a>, <a class="code" href="classProgMLF2D.html#a0177d3113415179168699efda64bd860">sigma_offset</a>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;    mdLog.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a31de7898d23a11e9b1b2ba4cc816d365">MDL_RANDOMSEED</a>, <a class="code" href="classXmippProgram.html#a51ae38ef10274f8f7c6c02ab2a67a28c">seed</a>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">do_norm</a>)</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;        mdLog.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a29c393fe6e00aa337783865f8694b0af">MDL_INTSCALE</a>, <a class="code" href="classML2DBaseProgram.html#a90f80f69b900eb15f9300560d50286ca">average_scale</a>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;    <span class="comment">//    fn_tmp = FN_IMGMD(fn_prefix);</span></div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;    <span class="comment">//    mdLog.setValue(MDL_IMGMD, fn_tmp, id);</span></div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;    <span class="comment">//    mdLog.setValue(MDL_REFMD, outRefsMd, id);</span></div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;    <span class="comment">//    if (outputType == OUT_ITER)</span></div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;    <span class="comment">//      fn_prefix = fn_root + &quot;_iter&quot;;</span></div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;    mdLog.<a class="code" href="classMetaData.html#a163fee49247af4f55802e8480503b342">write</a>(<a class="code" href="ml2d_8h.html#a108b3141800d641ccdbab77acd07a7e1">FN_LOGS_MD</a>(fn_base), <a class="code" href="group__MetaData.html#ggaf446b6aff4a8c034231bfa3e1484bc47ae658bd63b5c203ea5e350a42881a57ca">MD_APPEND</a>);</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;    <span class="keywordflow">if</span> (outputType != <a class="code" href="ml2d_8h.html#a4e0517338e6c4a31a2addafc06d4f3a3a2de4bf60bbff3a00593fa0db7834c71a">OUT_REFS</a>)</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;    {</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;        <a class="code" href="classMetaData.html">MetaData</a> mdImgs;</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = (int) <a class="code" href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">MDref</a>.<a class="code" href="classMetaData.html#ad844b6a5655be4205e4bb03ab6372562">size</a>(); <span class="comment">//Avoid int and size_t comparison warning</span></div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ref = 1; ref &lt;= <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>; ++ref)</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;        {</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;            mdImgs.<a class="code" href="classMetaData.html#a94973ba346a77cdb9aaf44fe65b2dd3c">importObjects</a>(<a class="code" href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">MDimg</a>, <a class="code" href="classMDValueEQ.html">MDValueEQ</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a3637da3214664c45458ae3e56a92c88e">MDL_REF</a>, ref));</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;            mdImgs.<a class="code" href="classMetaData.html#a163fee49247af4f55802e8480503b342">write</a>(<a class="code" href="ml2d_8h.html#a5478fca9f7c1fc0b3c861cee24fa73a6">FN_CLASS_IMAGES_MD</a>(fn_base, ref), <a class="code" href="group__MetaData.html#ggaf446b6aff4a8c034231bfa3e1484bc47ae658bd63b5c203ea5e350a42881a57ca">MD_APPEND</a>);</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;        }</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;    }</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;    <span class="comment">//    fn_tmp = FN_LOGMD(fn_prefix);</span></div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;    <span class="comment">//    if (mode == MD_OVERWRITE)</span></div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;    <span class="comment">//      mdLog.write(fn_tmp);</span></div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;    <span class="comment">//    else</span></div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;    <span class="comment">//      mdLog.append(fn_tmp);</span></div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    <span class="comment">//    mode = MD_APPEND;</span></div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;    <span class="comment">// Write out average and resolution-dependent histograms</span></div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a79873ba6ac0a02ebff149285475a8721">do_kstest</a>)</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;    {</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;        <span class="keywordtype">double</span>          val;</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;        std::ofstream fh_hist;</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;        fn_tmp = fn_base + <span class="stringliteral">&quot;avg.hist.log&quot;</span>;</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;        fh_hist.open((fn_tmp).c_str(), std::ios::out);</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;        <span class="keywordflow">if</span> (!fh_hist)</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;            <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aabda7431146b956debfa7f89164af1790">ERR_IO_NOTOPEN</a>, (<a class="code" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a>)<span class="stringliteral">&quot;Cannot write histogram file &quot;</span>+ fn_tmp);</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;        <a class="code" href="classProgMLF2D.html#a4876f30a8c1b41ead612a89de1f3eed0">sumhist</a> /= (<a class="code" href="classProgMLF2D.html#a4876f30a8c1b41ead612a89de1f3eed0">sumhist</a>.<a class="code" href="classMultidimArray.html#a2917347534008460dd52e90049e4257f">sum</a>()*<a class="code" href="classProgMLF2D.html#a4876f30a8c1b41ead612a89de1f3eed0">sumhist</a>.<a class="code" href="classHistogram1D.html#a1f33208fed8e9026279a5002176107f3">step_size</a>);</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gaa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(<a class="code" href="classProgMLF2D.html#a4876f30a8c1b41ead612a89de1f3eed0">sumhist</a>)</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;        {</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;            <a class="code" href="classProgMLF2D.html#a4876f30a8c1b41ead612a89de1f3eed0">sumhist</a>.<a class="code" href="classHistogram1D.html#a5b24f78917ecda9d47e420b3a6c4cbd7">index2val</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, val);</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;            val += 0.5*<a class="code" href="classProgMLF2D.html#a4876f30a8c1b41ead612a89de1f3eed0">sumhist</a>.<a class="code" href="classHistogram1D.html#a1f33208fed8e9026279a5002176107f3">step_size</a>;</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;            fh_hist &lt;&lt; val&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt; <a class="code" href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(<a class="code" href="classProgMLF2D.html#a4876f30a8c1b41ead612a89de1f3eed0">sumhist</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a>)</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;                fh_hist &lt;&lt; <a class="code" href="group__GeneralFunctions.html#ga9483aca229770e20a5b7fb1df4aee6a1">tstudent1D</a>(val, <a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a>, 1., 0.)&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;                fh_hist &lt;&lt; <a class="code" href="group__GeneralFunctions.html#ga15ac71366a2fcd18ab5769593246a2ed">gaussian1D</a>(val, 1., 0.)&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;        }</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;        fh_hist.close();</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;        fn_tmp = fn_base + <span class="stringliteral">&quot;_resol.hist&quot;</span>;</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;        fh_hist.open((fn_tmp).c_str(), std::ios::out);</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;        <span class="keywordflow">if</span> (!fh_hist)</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;            <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aabda7431146b956debfa7f89164af1790">ERR_IO_NOTOPEN</a>, (<a class="code" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a>)<span class="stringliteral">&quot;Cannot write histogram file &quot;</span>+ fn_tmp);</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gaa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(<a class="code" href="classProgMLF2D.html#a4876f30a8c1b41ead612a89de1f3eed0">sumhist</a>)</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;        {</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;            <a class="code" href="classProgMLF2D.html#a4876f30a8c1b41ead612a89de1f3eed0">sumhist</a>.<a class="code" href="classHistogram1D.html#a5b24f78917ecda9d47e420b3a6c4cbd7">index2val</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, val);</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;            val += 0.5*<a class="code" href="classProgMLF2D.html#a4876f30a8c1b41ead612a89de1f3eed0">sumhist</a>.<a class="code" href="classHistogram1D.html#a1f33208fed8e9026279a5002176107f3">step_size</a>;</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;            fh_hist &lt;&lt; val&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">do_student</a>)</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;                fh_hist &lt;&lt; <a class="code" href="group__GeneralFunctions.html#ga9483aca229770e20a5b7fb1df4aee6a1">tstudent1D</a>(val, <a class="code" href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">df</a>, 1., 0.)&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;                fh_hist &lt;&lt; <a class="code" href="group__GeneralFunctions.html#ga15ac71366a2fcd18ab5769593246a2ed">gaussian1D</a>(val, 1., 0.)&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ires = 0; ires &lt; <a class="code" href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">hdim</a>; ires++)</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;            {</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classProgMLF2D.html#aff8593015f02560e8e3e85ebd86ba894">resolhist</a>[ires].sampleNo() &gt; 0)</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;                {</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;                    fh_hist &lt;&lt;<a class="code" href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(<a class="code" href="classProgMLF2D.html#aff8593015f02560e8e3e85ebd86ba894">resolhist</a>[ires], <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)/(<a class="code" href="classProgMLF2D.html#aff8593015f02560e8e3e85ebd86ba894">resolhist</a>[ires].sum()*<a class="code" href="classProgMLF2D.html#aff8593015f02560e8e3e85ebd86ba894">resolhist</a>[ires].step_size)&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;                }</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;            }</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;            fh_hist &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;        }</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;        fh_hist.close();</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    }</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;    <span class="comment">// Write out updated Vsig vectors</span></div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classML2DBaseProgram.html#a4646a8113c64d86101389cb4f373bca3">fix_sigma_noise</a>)</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;    {</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;        <a class="code" href="group__MLFalign2D.html#gab39599380e42cadda13b0cfb14588d46">FOR_ALL_DEFOCUS_GROUPS</a>()</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;        {</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;            <a class="code" href="classProgMLF2D.html#a8540e7e059c7bc46e2a010d25225d08b">writeNoiseFile</a>(fn_base, ifocus);</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;        }</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;    }</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;}<span class="comment">//function writeOutputFiles</span></div><div class="ttc" id="classProgMLF2D_html_a8402eab40b0e66cd7aee78b747720af9"><div class="ttname"><a href="classProgMLF2D.html#a8402eab40b0e66cd7aee78b747720af9">ProgMLF2D::do_student</a></div><div class="ttdeci">bool do_student</div><div class="ttdoc">IN DEVELOPMENT. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00135">mlf_align2d.h:135</a></div></div>
<div class="ttc" id="classMetaData_html_a163fee49247af4f55802e8480503b342"><div class="ttname"><a href="classMetaData.html#a163fee49247af4f55802e8480503b342">MetaData::write</a></div><div class="ttdeci">void write(const FileName &amp;outFile, WriteModeMetaData mode=MD_OVERWRITE) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00907">metadata.cpp:907</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78afdd72c29a4e9b5f719e1dadfd823ac78"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78afdd72c29a4e9b5f719e1dadfd823ac78">MDL_LL</a></div><div class="ttdoc">contribution of an image to log-likelihood value </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00258">metadata_label.h:258</a></div></div>
<div class="ttc" id="ml2d_8h_html_a4e0517338e6c4a31a2addafc06d4f3a3a2de4bf60bbff3a00593fa0db7834c71a"><div class="ttname"><a href="ml2d_8h.html#a4e0517338e6c4a31a2addafc06d4f3a3a2de4bf60bbff3a00593fa0db7834c71a">OUT_REFS</a></div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00076">ml2d.h:76</a></div></div>
<div class="ttc" id="ml2d_8h_html_a4e0517338e6c4a31a2addafc06d4f3a3aaf0fce4b419a64beac8ea79227577e27"><div class="ttname"><a href="ml2d_8h.html#a4e0517338e6c4a31a2addafc06d4f3a3aaf0fce4b419a64beac8ea79227577e27">OUT_ITER</a></div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00076">ml2d.h:76</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga97809f7244a28aaa1c26e29e6e3204ef"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a></div><div class="ttdeci">#define A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00549">multidim_array.h:549</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a20e2b948711e3e66894740b99e8cf017"><div class="ttname"><a href="classML2DBaseProgram.html#a20e2b948711e3e66894740b99e8cf017">ML2DBaseProgram::iter</a></div><div class="ttdeci">int iter</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00147">ml2d.h:147</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a94561c5c01993bb73d33426fdfcc9338"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a94561c5c01993bb73d33426fdfcc9338">MDL_SIGNALCHANGE</a></div><div class="ttdoc">Signal change for an image. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00424">metadata_label.h:424</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a62bd5315721add5edf8b74e19c7d2de8"><div class="ttname"><a href="classProgMLF2D.html#a62bd5315721add5edf8b74e19c7d2de8">ProgMLF2D::LL</a></div><div class="ttdeci">double LL</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00153">mlf_align2d.h:153</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a90f80f69b900eb15f9300560d50286ca"><div class="ttname"><a href="classML2DBaseProgram.html#a90f80f69b900eb15f9300560d50286ca">ML2DBaseProgram::average_scale</a></div><div class="ttdeci">double average_scale</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00213">ml2d.h:213</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_ga4b64e613a26295aa34dbe4301f1374a4"><div class="ttname"><a href="group__MLFalign2D.html#ga4b64e613a26295aa34dbe4301f1374a4">FN_REF</a></div><div class="ttdeci">#define FN_REF(base, refno)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00065">mlf_align2d.h:65</a></div></div>
<div class="ttc" id="ml2d_8h_html_a108b3141800d641ccdbab77acd07a7e1"><div class="ttname"><a href="ml2d_8h.html#a108b3141800d641ccdbab77acd07a7e1">FN_LOGS_MD</a></div><div class="ttdeci">#define FN_LOGS_MD(base)</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00056">ml2d.h:56</a></div></div>
<div class="ttc" id="classFileName_html_ab10d5ada0f956aef14ae171f12587d56"><div class="ttname"><a href="classFileName.html#ab10d5ada0f956aef14ae171f12587d56">FileName::compose</a></div><div class="ttdeci">void compose(const String &amp;str, const size_t no, const String &amp;ext=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8cpp_source.html#l00049">xmipp_filename.cpp:49</a></div></div>
<div class="ttc" id="classMetaData_html"><div class="ttname"><a href="classMetaData.html">MetaData</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00234">metadata.h:234</a></div></div>
<div class="ttc" id="classMDValueEQ_html"><div class="ttname"><a href="classMDValueEQ.html">MDValueEQ</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata__sql_8h_source.html#l00464">metadata_sql.h:464</a></div></div>
<div class="ttc" id="classModelML2D_html_a63a3a3534d1cb72a9db046508b9a59f6"><div class="ttname"><a href="classModelML2D.html#a63a3a3534d1cb72a9db046508b9a59f6">ModelML2D::n_ref</a></div><div class="ttdeci">int n_ref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00083">ml2d.h:83</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gab39599380e42cadda13b0cfb14588d46"><div class="ttname"><a href="group__MLFalign2D.html#gab39599380e42cadda13b0cfb14588d46">FOR_ALL_DEFOCUS_GROUPS</a></div><div class="ttdeci">#define FOR_ALL_DEFOCUS_GROUPS()</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00040">mlf_align2d.h:40</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaa924a84ae5fbf0ba6b4052eb9d92ef60"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00564">multidim_array.h:564</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a90e6ce499655b4566e17e32102a905c4"><div class="ttname"><a href="classML2DBaseProgram.html#a90e6ce499655b4566e17e32102a905c4">ML2DBaseProgram::hdim</a></div><div class="ttdeci">size_t hdim</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00151">ml2d.h:151</a></div></div>
<div class="ttc" id="classMetaData_html_acd6018636eda733443f3df6c61978faa"><div class="ttname"><a href="classMetaData.html#acd6018636eda733443f3df6c61978faa">MetaData::addObject</a></div><div class="ttdeci">size_t addObject()</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00750">metadata.cpp:750</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_adfab8933f95443ac6d909a9b206b3fa8"><div class="ttname"><a href="classML2DBaseProgram.html#adfab8933f95443ac6d909a9b206b3fa8">ML2DBaseProgram::fn_root</a></div><div class="ttdeci">FileName fn_root</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00132">ml2d.h:132</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00068">xmipp_filename.h:68</a></div></div>
<div class="ttc" id="classHistogram1D_html_a5b24f78917ecda9d47e420b3a6c4cbd7"><div class="ttname"><a href="classHistogram1D.html#a5b24f78917ecda9d47e420b3a6c4cbd7">Histogram1D::index2val</a></div><div class="ttdeci">void index2val(double i, double &amp;v) const </div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00295">histogram.h:295</a></div></div>
<div class="ttc" id="ml2d_8h_html_a8ef0c472d79a03426c3c02f8777ef3c3"><div class="ttname"><a href="ml2d_8h.html#a8ef0c472d79a03426c3c02f8777ef3c3">FN_CLASSES_MD</a></div><div class="ttdeci">#define FN_CLASSES_MD(base)</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00055">ml2d.h:55</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a9e143fabdc67d1ee8cd67dcad98e74fc"><div class="ttname"><a href="classML2DBaseProgram.html#a9e143fabdc67d1ee8cd67dcad98e74fc">ML2DBaseProgram::do_norm</a></div><div class="ttdeci">bool do_norm</div><div class="ttdoc">Re-normalize internally. </div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00207">ml2d.h:207</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a963af5cdb6f63d876c147c24fbf8452e"><div class="ttname"><a href="classML2DBaseProgram.html#a963af5cdb6f63d876c147c24fbf8452e">ML2DBaseProgram::do_ML3D</a></div><div class="ttdeci">bool do_ML3D</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00196">ml2d.h:196</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a2fd51100d35db6ecdcb3ac704ab58435"><div class="ttname"><a href="classProgMLF2D.html#a2fd51100d35db6ecdcb3ac704ab58435">ProgMLF2D::refs_avgscale</a></div><div class="ttdeci">std::vector&lt; double &gt; refs_avgscale</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00148">mlf_align2d.h:148</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a79873ba6ac0a02ebff149285475a8721"><div class="ttname"><a href="classProgMLF2D.html#a79873ba6ac0a02ebff149285475a8721">ProgMLF2D::do_kstest</a></div><div class="ttdeci">bool do_kstest</div><div class="ttdoc">Statistical analysis of the noise distributions. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00141">mlf_align2d.h:141</a></div></div>
<div class="ttc" id="mlf__align2d_8cpp_html_a1b2581498728b00156cf6124bb8aba51"><div class="ttname"><a href="mlf__align2d_8cpp.html#a1b2581498728b00156cf6124bb8aba51">writeImage</a></div><div class="ttdeci">void writeImage(Image&lt; double &gt; &amp;img, const FileName &amp;fn, MDRow &amp;row)</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l02670">mlf_align2d.cpp:2670</a></div></div>
<div class="ttc" id="classProgMLF2D_html_abe2d74f54f4aa6916eb6f6d29164e023"><div class="ttname"><a href="classProgMLF2D.html#abe2d74f54f4aa6916eb6f6d29164e023">ProgMLF2D::Ictf</a></div><div class="ttdeci">std::vector&lt; Image&lt; double &gt; &gt; Ictf</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00085">mlf_align2d.h:85</a></div></div>
<div class="ttc" id="classMetaData_html_ad844b6a5655be4205e4bb03ab6372562"><div class="ttname"><a href="classMetaData.html#ad844b6a5655be4205e4bb03ab6372562">MetaData::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00702">metadata.cpp:702</a></div></div>
<div class="ttc" id="group__MLalign2D_html_ga37dd4c436766acd586ca95f773236000"><div class="ttname"><a href="group__MLalign2D.html#ga37dd4c436766acd586ca95f773236000">getIterExtraPath</a></div><div class="ttdeci">FileName getIterExtraPath(const FileName &amp;fn_root, int iter, bool makePath)</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8cpp_source.html#l00304">ml2d.cpp:304</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78ad8a81df6271e91f540f943bf8ef0d192"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ad8a81df6271e91f540f943bf8ef0d192">MDL_PMAX</a></div><div class="ttdoc">Maximum value of normalized probability function (now called &quot;Pmax/sumP&quot;) (double) ...</div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00338">metadata_label.h:338</a></div></div>
<div class="ttc" id="ml2d_8h_html_a5478fca9f7c1fc0b3c861cee24fa73a6"><div class="ttname"><a href="ml2d_8h.html#a5478fca9f7c1fc0b3c861cee24fa73a6">FN_CLASS_IMAGES_MD</a></div><div class="ttdeci">#define FN_CLASS_IMAGES_MD(base, ref)</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00057">ml2d.h:57</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a0177d3113415179168699efda64bd860"><div class="ttname"><a href="classProgMLF2D.html#a0177d3113415179168699efda64bd860">ProgMLF2D::sigma_offset</a></div><div class="ttdeci">double sigma_offset</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00075">mlf_align2d.h:75</a></div></div>
<div class="ttc" id="group__MetaData_html_ggaf446b6aff4a8c034231bfa3e1484bc47ae658bd63b5c203ea5e350a42881a57ca"><div class="ttname"><a href="group__MetaData.html#ggaf446b6aff4a8c034231bfa3e1484bc47ae658bd63b5c203ea5e350a42881a57ca">MD_APPEND</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00060">metadata.h:60</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a8671946de2e241de54a47e2822989ca1"><div class="ttname"><a href="classML2DBaseProgram.html#a8671946de2e241de54a47e2822989ca1">ML2DBaseProgram::df</a></div><div class="ttdeci">double df</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00204">ml2d.h:204</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_gaa662886e98cc46ddfdca0d9210670599"><div class="ttname"><a href="group__MLFalign2D.html#gaa662886e98cc46ddfdca0d9210670599">FN_CREF_IMG_MD</a></div><div class="ttdeci">#define FN_CREF_IMG_MD</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00062">mlf_align2d.h:62</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a29c393fe6e00aa337783865f8694b0af"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a29c393fe6e00aa337783865f8694b0af">MDL_INTSCALE</a></div><div class="ttdoc">Intensity scale for an image. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00249">metadata_label.h:249</a></div></div>
<div class="ttc" id="classMultidimArray_html_a2917347534008460dd52e90049e4257f"><div class="ttname"><a href="classMultidimArray.html#a2917347534008460dd52e90049e4257f">MultidimArray::sum</a></div><div class="ttdeci">double sum() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05095">multidim_array.h:5095</a></div></div>
<div class="ttc" id="classProgMLF2D_html_aff8593015f02560e8e3e85ebd86ba894"><div class="ttname"><a href="classProgMLF2D.html#aff8593015f02560e8e3e85ebd86ba894">ProgMLF2D::resolhist</a></div><div class="ttdeci">std::vector&lt; Histogram1D &gt; resolhist</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00146">mlf_align2d.h:146</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga9483aca229770e20a5b7fb1df4aee6a1"><div class="ttname"><a href="group__GeneralFunctions.html#ga9483aca229770e20a5b7fb1df4aee6a1">tstudent1D</a></div><div class="ttdeci">double tstudent1D(double x, double df, double sigma, double mu)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00179">xmipp_funcs.cpp:179</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a8540e7e059c7bc46e2a010d25225d08b"><div class="ttname"><a href="classProgMLF2D.html#a8540e7e059c7bc46e2a010d25225d08b">ProgMLF2D::writeNoiseFile</a></div><div class="ttdeci">void writeNoiseFile(const FileName &amp;fn_base, int ifocus)</div><div class="ttdoc">Write noise estimation per resolution. </div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8cpp_source.html#l02848">mlf_align2d.cpp:2848</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a44d2f7bdda1efb37f9218b2ac4eb8a2c"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a44d2f7bdda1efb37f9218b2ac4eb8a2c">MDL_SIGMAOFFSET</a></div><div class="ttdoc">Standard deviation of the offsets in ML model. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00423">metadata_label.h:423</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a619e2aed7d1934de3ce40d04b4d160b3"><div class="ttname"><a href="classProgMLF2D.html#a619e2aed7d1934de3ce40d04b4d160b3">ProgMLF2D::mirror_fraction</a></div><div class="ttdeci">std::vector&lt; double &gt; mirror_fraction</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00079">mlf_align2d.h:79</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a4646a8113c64d86101389cb4f373bca3"><div class="ttname"><a href="classML2DBaseProgram.html#a4646a8113c64d86101389cb4f373bca3">ML2DBaseProgram::fix_sigma_noise</a></div><div class="ttdeci">bool fix_sigma_noise</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00143">ml2d.h:143</a></div></div>
<div class="ttc" id="classMetaData_html_adf4ee2ad1ad0964990a8a11a2109d578"><div class="ttname"><a href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">MetaData::setValue</a></div><div class="ttdeci">bool setValue(const MDLabel label, const T &amp;valueIn, size_t id)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00550">metadata.h:550</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a3637da3214664c45458ae3e56a92c88e"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a3637da3214664c45458ae3e56a92c88e">MDL_REF</a></div><div class="ttdoc">Class to which the image belongs (int) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00363">metadata_label.h:363</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aabda7431146b956debfa7f89164af1790"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aabda7431146b956debfa7f89164af1790">ERR_IO_NOTOPEN</a></div><div class="ttdoc">File cannot be open. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00142">xmipp_error.h:142</a></div></div>
<div class="ttc" id="classMDRow_html_a916bbf19ab9a48f400800160b9b581fa"><div class="ttname"><a href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">MDRow::setValue</a></div><div class="ttdeci">void setValue(MDLabel label, const T &amp;d, bool addLabel=true)</div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l01168">metadata_label.h:1168</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a62caa148ed1109af0cf324ffec9ff2cd"><div class="ttname"><a href="classML2DBaseProgram.html#a62caa148ed1109af0cf324ffec9ff2cd">ML2DBaseProgram::MDref</a></div><div class="ttdeci">MetaData MDref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00172">ml2d.h:172</a></div></div>
<div class="ttc" id="ml2d_8h_html_a110de41c02a5f818c5a698293cf0b9e8"><div class="ttname"><a href="ml2d_8h.html#a110de41c02a5f818c5a698293cf0b9e8">FN_IMAGES_MD</a></div><div class="ttdeci">#define FN_IMAGES_MD(base)</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00054">ml2d.h:54</a></div></div>
<div class="ttc" id="classModelML2D_html_a29baa2fb66177265cb0de6d027ea454a"><div class="ttname"><a href="classModelML2D.html#a29baa2fb66177265cb0de6d027ea454a">ModelML2D::Iref</a></div><div class="ttdeci">std::vector&lt; Image&lt; double &gt; &gt; Iref</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00085">ml2d.h:85</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a080fbf81a2b9dfceab4cfe1a649f13a4"><div class="ttname"><a href="classML2DBaseProgram.html#a080fbf81a2b9dfceab4cfe1a649f13a4">ML2DBaseProgram::MDimg</a></div><div class="ttdeci">MetaData MDimg</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00172">ml2d.h:172</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="xmipp__strings_8h_html_afbeda3fd1bdc8c37d01bdf9f5c8274ff"><div class="ttname"><a href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a></div><div class="ttdeci">std::string String</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__strings_8h_source.html#l00034">xmipp_strings.h:34</a></div></div>
<div class="ttc" id="classMetaData_html_a94973ba346a77cdb9aaf44fe65b2dd3c"><div class="ttname"><a href="classMetaData.html#a94973ba346a77cdb9aaf44fe65b2dd3c">MetaData::importObjects</a></div><div class="ttdeci">void importObjects(const MetaData &amp;md, const std::vector&lt; size_t &gt; &amp;objectsToAdd, bool doClear=true)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00761">metadata.cpp:761</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ac3eac3d0fb4000223088846bee6bcb0b"><div class="ttname"><a href="classML2DBaseProgram.html#ac3eac3d0fb4000223088846bee6bcb0b">ML2DBaseProgram::outRefsMd</a></div><div class="ttdeci">String outRefsMd</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00250">ml2d.h:250</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_ad9b9535e1774d805e5bbee89dee0f4b5"><div class="ttname"><a href="classML2DBaseProgram.html#ad9b9535e1774d805e5bbee89dee0f4b5">ML2DBaseProgram::do_mirror</a></div><div class="ttdeci">bool do_mirror</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00137">ml2d.h:137</a></div></div>
<div class="ttc" id="classXmippProgram_html_a51ae38ef10274f8f7c6c02ab2a67a28c"><div class="ttname"><a href="classXmippProgram.html#a51ae38ef10274f8f7c6c02ab2a67a28c">XmippProgram::seed</a></div><div class="ttdeci">int seed</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8h_source.html#l00170">xmipp_program.h:170</a></div></div>
<div class="ttc" id="classHistogram1D_html_a1f33208fed8e9026279a5002176107f3"><div class="ttname"><a href="classHistogram1D.html#a1f33208fed8e9026279a5002176107f3">Histogram1D::step_size</a></div><div class="ttdeci">double step_size</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00127">histogram.h:127</a></div></div>
<div class="ttc" id="classMDRow_html"><div class="ttname"><a href="classMDRow.html">MDRow</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l01087">metadata_label.h:1087</a></div></div>
<div class="ttc" id="classMDIterator_html"><div class="ttname"><a href="classMDIterator.html">MDIterator</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00157">metadata.h:157</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a0704d0153add5aa8abcf3e82bb174ebc"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a0704d0153add5aa8abcf3e82bb174ebc">MDL_MIRRORFRAC</a></div><div class="ttdoc">Mirror fraction for a Maximum Likelihood model. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00280">metadata_label.h:280</a></div></div>
<div class="ttc" id="classMetaData_html_a953446525b885033ebec09c77dbfceba"><div class="ttname"><a href="classMetaData.html#a953446525b885033ebec09c77dbfceba">MetaData::setRow</a></div><div class="ttdeci">bool setRow(const MDRow &amp;row, size_t id)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00437">metadata.cpp:437</a></div></div>
<div class="ttc" id="group__MLFalign2D_html_ga752a41b82a33bedb80a8e2c19f7ab999"><div class="ttname"><a href="group__MLFalign2D.html#ga752a41b82a33bedb80a8e2c19f7ab999">FN_CREF_IMG</a></div><div class="ttdeci">#define FN_CREF_IMG</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00061">mlf_align2d.h:61</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78abbbbb24eaf2b80e9a7ed50bd6075e833"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78abbbbb24eaf2b80e9a7ed50bd6075e833">MDL_ITER</a></div><div class="ttdoc">Current iteration number (int) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00251">metadata_label.h:251</a></div></div>
<div class="ttc" id="classProgMLF2D_html_a4876f30a8c1b41ead612a89de1f3eed0"><div class="ttname"><a href="classProgMLF2D.html#a4876f30a8c1b41ead612a89de1f3eed0">ProgMLF2D::sumhist</a></div><div class="ttdeci">Histogram1D sumhist</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00145">mlf_align2d.h:145</a></div></div>
<div class="ttc" id="classML2DBaseProgram_html_a3b21e31f64ae12053ef1192ef39e309e"><div class="ttname"><a href="classML2DBaseProgram.html#a3b21e31f64ae12053ef1192ef39e309e">ML2DBaseProgram::conv</a></div><div class="ttdeci">std::vector&lt; double &gt; conv</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8h_source.html#l00219">ml2d.h:219</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="classProgMLF2D_html_abc9875f9cb5025678bebb8eff54a1118"><div class="ttname"><a href="classProgMLF2D.html#abc9875f9cb5025678bebb8eff54a1118">ProgMLF2D::sumcorr</a></div><div class="ttdeci">double sumcorr</div><div class="ttdef"><b>Definition:</b> <a href="mlf__align2d_8h_source.html#l00153">mlf_align2d.h:153</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a31de7898d23a11e9b1b2ba4cc816d365"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a31de7898d23a11e9b1b2ba4cc816d365">MDL_RANDOMSEED</a></div><div class="ttdoc">Seed for random number generator. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00361">metadata_label.h:361</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga15ac71366a2fcd18ab5769593246a2ed"><div class="ttname"><a href="group__GeneralFunctions.html#ga15ac71366a2fcd18ab5769593246a2ed">gaussian1D</a></div><div class="ttdeci">double gaussian1D(double x, double sigma, double mu)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00172">xmipp_funcs.cpp:172</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a0cf09cc5d8c9949acc48438be868773c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; ProgMLF2D::alpha_k</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classVector.html">Vector</a> containing estimated fraction for each model </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00077">77</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5c75192acc215ccf8e062881d14f9ac4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; ProgMLF2D::count_defocus</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classVector.html">Vector</a> with number of images per defocuss group </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00104">104</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="aca3a507abbae9720e21b774955fccdb6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t ProgMLF2D::current_highres_limit</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Current highest resolution shell </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00129">129</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2839dd97c6d6098e665b16bed661b615"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t ProgMLF2D::dnr_points_2d</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00127">127</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7c3f7c47054265ad3589ee6d40764fbc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgMLF2D::do_ctf_correction</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>CTFDat file for all images Flag whether to include CTFs in the image formation model </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00100">100</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a67e4c76098a1309d855c2649ed148b85"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgMLF2D::do_divide_ctf</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Divide by CTF (until first zero) instead of wiener filter </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00120">120</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a33a7368df74c02b48043acaed12b3ce7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgMLF2D::do_include_allfreqs</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Include all frequencies in the refinement </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00122">122</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a79873ba6ac0a02ebff149285475a8721"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgMLF2D::do_kstest</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Statistical analysis of the noise distributions. </p>
<p>Perform Kolmogorov-Smirnov test on noise distribution </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00141">141</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8402eab40b0e66cd7aee78b747720af9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgMLF2D::do_student</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>IN DEVELOPMENT. </p>
<p>USe t-distribution instead of normal one Use t-student distribution instead of normal one </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00135">135</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="aad176d8656485e60ed725b2754a070aa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgMLF2D::do_student_sigma_trick</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Perform sigma-trick for faster convergence (Mclachlan&amp;Peel, p. 228) </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00137">137</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac06a02372d68274fa8fb58dab620db9a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgMLF2D::do_variable_psi</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Vary psi and translational sampling with resolution </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00083">83</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="aef9b9f1aff83b4d111cf2a8be84d4c07"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgMLF2D::do_variable_trans</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00083">83</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5e967d6a01f0dcdce99c62e591bb7995"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgMLF2D::first_iter_noctf</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Do not multiply signal with CTF in the first iteration </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00118">118</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a77ca59aeaa398779a7f562940d1363a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgMLF2D::fix_high</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fix high-resolution limit </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00124">124</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3e59aa87465a609828f311a1b40f0ea9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; ProgMLF2D::Fref</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00157">157</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="aff2c6db0108d1ef849c88221a1506ef8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; ProgMLF2D::Fwsum_ctfimgs</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00157">157</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0b8e2ceb24d15d08f35c4549b1bef95a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; ProgMLF2D::Fwsum_imgs</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00157">157</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a27f1ed8b93ea62c3e3727f7fa57f41b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgMLF2D::highres_limit</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00116">116</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="abe2d74f54f4aa6916eb6f6d29164e023"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classImage.html">Image</a>&lt;double&gt; &gt; ProgMLF2D::Ictf</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classVector.html">Vector</a> for images to hold references (new &amp; old) </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00085">85</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a552a32e4f5ff63eda3ffa4708eef6f67"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgMLF2D::ini_highres_limit</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00116">116</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1bd3c9e0f12cfa45daa109e0c96c3f28"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgMLF2D::iter_write_histograms</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Iteration at which to write out histograms </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00143">143</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="ada357d6508ec414e1203b029816fa3ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgMLF2D::limit_trans</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Limit translational searches </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00087">87</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a62bd5315721add5edf8b74e19c7d2de8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgMLF2D::LL</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Taken from expectation and/or maximization </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00153">153</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0c5751afdfd3fe27554492356c09a58c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgMLF2D::lowres_limit</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Overall low and high resolution cutoffs for fourier-mode (in Fourier pixels) </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00116">116</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a373f1965ed767abbf1d5b3e53104623b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t ProgMLF2D::max_nr_psi</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of steps to sample in-plane rotation in 90 degrees </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00081">81</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a619e2aed7d1934de3ce40d04b4d160b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; ProgMLF2D::mirror_fraction</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classVector.html">Vector</a> containing estimated fraction for mirror of each model </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00079">79</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a78ef99a6261c8c228ca1bab9f0c2205a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt;size_t&gt; ProgMLF2D::Mresol_int</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classMatrix.html">Matrix</a> with resolution shell at each Fourier pixel </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00108">108</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="af78a059d07b955ccd42e8a17ef827d19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt;double&gt; &gt; ProgMLF2D::Mwsum_sigma2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00155">155</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7e08de076e12e519d59f5e39854f1dc5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t ProgMLF2D::nr_focus</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>number of defocus groups </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00114">114</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="af7f2b4639397c6f14e13371207476c06"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t ProgMLF2D::nr_points_2d</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00127">127</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a963f62304538d74f796a3d20475480ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t ProgMLF2D::nr_points_prob</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00127">127</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1f05f45301557f3c0a855a414b87b5fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t ProgMLF2D::nr_trans</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of limited translations </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00089">89</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac45e6bbd1a035e75dc4f9bdb5b775ae0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgMLF2D::nr_vols</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00150">150</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1de58371deea621eafdb71373065de80"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgMLF2D::offsets_keepdir</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of subdirectories to keep for unique offsets filenames </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00095">95</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9c504b96e173e1eeb6cda09a00e5b638"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgMLF2D::phase_flipped</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag whether the phases of the experimental images are flipped already </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00106">106</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a26c5a01345ef85eaabf6056c0f76f848"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; ProgMLF2D::pointer_2d</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pointers to the 2D matrices (in FourierTransformHalf format) </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00126">126</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae34810925acecb7d097272aae20cf26b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; ProgMLF2D::pointer_i</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00126">126</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac0756608605967a063784669478c62bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; ProgMLF2D::pointer_j</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00126">126</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="aba28a0ffa831626698f137197c961017"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgMLF2D::rank</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00150">150</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a19dbbebd916d67da0d3e0ce5c9d77993"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgMLF2D::reduce_snr</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Multiplicative factor for SSNR </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00112">112</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2fd51100d35db6ecdcb3ac704ab58435"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; ProgMLF2D::refs_avgscale</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00148">148</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="aff8593015f02560e8e3e85ebd86ba894"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classHistogram1D.html">Histogram1D</a> &gt; ProgMLF2D::resolhist</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00146">146</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="af1176823dd265484796aa9b52215719e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgMLF2D::sampling</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pixel size in Angstroms </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00102">102</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a13f69696df08368a14b8928b60faaad7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgMLF2D::search_shift</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Limited search range for origin offsets </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00093">93</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0177d3113415179168699efda64bd860"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgMLF2D::sigma_offset</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>sigma-value for origin offsets </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00075">75</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5399db01ffd31021ae8f1c8ab983eabb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgMLF2D::size</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00150">150</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="abc9875f9cb5025678bebb8eff54a1118"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgMLF2D::sumcorr</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00153">153</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4876f30a8c1b41ead612a89de1f3eed0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classHistogram1D.html">Histogram1D</a> ProgMLF2D::sumhist</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Average histogram </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00145">145</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0a90a0680ddfe59efa8bac1303fada63"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; ProgMLF2D::sumw</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00156">156</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a07e1e912286ab9303da3d4a654d26dd6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; ProgMLF2D::sumw2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00156">156</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a01e5f8b55632ee6d8263827376051807"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgMLF2D::sumw_allrefs</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00153">153</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9c42feb7d8cbf224f91e903bac49663e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; ProgMLF2D::sumw_defocus</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00156">156</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a86adb43015401e250b579f9d49f00730"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; ProgMLF2D::sumw_mirror</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00156">156</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a92faef343a74868a005e5de666778470"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; ProgMLF2D::sumwsc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00156">156</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab34721b1edbfbb6b3feb83c1aa825166"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; ProgMLF2D::sumwsc2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00156">156</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="aeacca439f42dea963c5997d589f419a4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt;double&gt; &gt; ProgMLF2D::Vctf</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00110">110</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a83eda37039c3fc321091307e24dc60fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt;double&gt; &gt; ProgMLF2D::Vdec</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00110">110</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5aad5b0a7bb75420f63794660d636454"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt;double&gt; &gt; ProgMLF2D::Vsig</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Vectors with sigma2 (for each defocus group) </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00110">110</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7126f012ef6183355f71114a35f7149f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt;double&gt; &gt; ProgMLF2D::wsum_ctfMref</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00154">154</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7b5bd8fb49b6864cdfcba9779bb163d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt;double&gt; &gt; ProgMLF2D::wsum_Mref</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00154">154</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae311e353866c6ac035c8f795ee2e1a6b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgMLF2D::wsum_sigma_offset</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00153">153</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<a class="anchor" id="adec8e47d0ada48f2aea2259ca1b400cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t ProgMLF2D::zero_trans</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number for which limited translation is zero </p>

<p>Definition at line <a class="el" href="mlf__align2d_8h_source.html#l00091">91</a> of file <a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/yunior/Yunior/Projects/Scipion/COSS/xmipp-bundle/src/xmipp/libraries/reconstruction/<a class="el" href="mlf__align2d_8h_source.html">mlf_align2d.h</a></li>
<li>/home/yunior/Yunior/Projects/Scipion/COSS/xmipp-bundle/src/xmipp/libraries/reconstruction/<a class="el" href="mlf__align2d_8cpp_source.html">mlf_align2d.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
