<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Xmipp: Numerical Tools</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v3.23.11-Nereus</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Numerical Tools<div class="ingroups"><a class="el" href="group__Libraries.html">Libraries</a> &raquo; <a class="el" href="group__DataLibrary.html">Basic data library</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Numerical Tools:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__NumericalTools.png" border="0" alt="" usemap="#group____NumericalTools"/>
<map name="group____NumericalTools" id="group____NumericalTools">
</map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGaussianInterpolator.html">GaussianInterpolator</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga8adb759f5f06b69188a55f32e9f798d9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__NumericalTools.html#ga8adb759f5f06b69188a55f32e9f798d9">randomPermutation</a> (int N, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;result)</td></tr>
<tr class="separator:ga8adb759f5f06b69188a55f32e9f798d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga79baaafce9164726b0f3e0cc28000f6a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__NumericalTools.html#ga79baaafce9164726b0f3e0cc28000f6a">powellOptimizer</a> (<a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;p, int i0, int <a class="el" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, double(*<a class="el" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>)(double *, void *), void *<a class="el" href="mpi__classify__CL2D_8cpp.html#a831c08adbb8230fd6a60f4a130923a19">prm</a>, double ftol, double &amp;fret, int &amp;<a class="el" href="numerical__recipes_8cpp.html#a4155d511de81aa816513aa52de01d931">iter</a>, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a2de5b01a4efcb9b1582bb2947efc6bad">steps</a>, bool show=false)</td></tr>
<tr class="separator:ga79baaafce9164726b0f3e0cc28000f6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6a7a783997c8d3252c1968ee7ba1ff4e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__NumericalTools.html#ga6a7a783997c8d3252c1968ee7ba1ff4e">solveNonNegative</a> (const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;result)</td></tr>
<tr class="separator:ga6a7a783997c8d3252c1968ee7ba1ff4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0d1aa3eef9aeec5d78cb2075b1f6c075"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__NumericalTools.html#ga0d1aa3eef9aeec5d78cb2075b1f6c075">solveViaCholesky</a> (const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;result)</td></tr>
<tr class="separator:ga0d1aa3eef9aeec5d78cb2075b1f6c075"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga19a2da0a4e5a2da62e27169e31471719"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__NumericalTools.html#ga19a2da0a4e5a2da62e27169e31471719">evaluateQuadratic</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;H, double &amp;val, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a2d70d5cde83a687bd8b9cfd74b68836f">grad</a>)</td></tr>
<tr class="separator:ga19a2da0a4e5a2da62e27169e31471719"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac8d6d47ed28167a8592043c1fcd7467a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__NumericalTools.html#gac8d6d47ed28167a8592043c1fcd7467a">quadraticProgramming</a> (const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;C, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a>, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;Aeq, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;beq, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a8ddb3706f7f0da780fedfff3731d60e7">bl</a>, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ab2cca56863d1f94c7e54807e4506ffde">bu</a>, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>)</td></tr>
<tr class="separator:gac8d6d47ed28167a8592043c1fcd7467a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaff06baf46401c09d999ae2dc0971a1f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__NumericalTools.html#gaaff06baf46401c09d999ae2dc0971a1f">leastSquare</a> (const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;C, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a>, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;Aeq, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;beq, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a8ddb3706f7f0da780fedfff3731d60e7">bl</a>, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ab2cca56863d1f94c7e54807e4506ffde">bu</a>, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>)</td></tr>
<tr class="separator:gaaff06baf46401c09d999ae2dc0971a1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf68a96a59ed1dc04c7c665add194438b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__NumericalTools.html#gaf68a96a59ed1dc04c7c665add194438b">regularizedLeastSquare</a> (const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a>, double <a class="el" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;G, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>)</td></tr>
<tr class="separator:gaf68a96a59ed1dc04c7c665add194438b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga97aa59ea3c2ed976c363510ea8c251d7"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga97aa59ea3c2ed976c363510ea8c251d7"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__NumericalTools.html#ga97aa59ea3c2ed976c363510ea8c251d7">solve</a> (const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;A, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; T &gt; &amp;result)</td></tr>
<tr class="separator:ga97aa59ea3c2ed976c363510ea8c251d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabbc5e753320601b6f56e63d13e156f05"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:gabbc5e753320601b6f56e63d13e156f05"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__NumericalTools.html#gabbc5e753320601b6f56e63d13e156f05">solveBySVD</a> (const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;A, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;result, double tolerance)</td></tr>
<tr class="separator:gabbc5e753320601b6f56e63d13e156f05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1f16b269d0089f8d7674f4348eac1402"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga1f16b269d0089f8d7674f4348eac1402"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__NumericalTools.html#ga1f16b269d0089f8d7674f4348eac1402">solve</a> (const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;A, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;result)</td></tr>
<tr class="separator:ga1f16b269d0089f8d7674f4348eac1402"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga19a2da0a4e5a2da62e27169e31471719"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga19a2da0a4e5a2da62e27169e31471719">&#9670;&nbsp;</a></span>evaluateQuadratic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void evaluateQuadratic </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>grad</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Evaluate quadratic form</p>
<p>Given x, c and H this function returns the value of the quadratic form val=c^t*x+0.5*x^t*H^t*H*x and the gradient of the quadratic form at x grad=c+H*x.</p>
<p>Exceptions are thrown if the vectors and matrices do not have consistent dimensions. </p>

<p class="definition">Definition at line <a class="el" href="numerical__tools_8cpp_source.html#l00126">126</a> of file <a class="el" href="numerical__tools_8cpp_source.html">numerical_tools.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;{</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">if</span> (x.<a class="code" href="classMatrix1D.html#afee3e8e4391cb2a57591a97895e6988e">size</a>() != c.<a class="code" href="classMatrix1D.html#afee3e8e4391cb2a57591a97895e6988e">size</a>())</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a>, <span class="stringliteral">&quot;Eval_quadratic: Not compatible sizes in x and c&quot;</span>);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">if</span> (H.<a class="code" href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Xdim</a>() != x.<a class="code" href="classMatrix1D.html#afee3e8e4391cb2a57591a97895e6988e">size</a>())</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a>, <span class="stringliteral">&quot;Eval_quadratic: Not compatible sizes in x and H&quot;</span>);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">// H*x, store in grad</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    grad.<a class="code" href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">initZeros</a>(x.<a class="code" href="classMatrix1D.html#afee3e8e4391cb2a57591a97895e6988e">size</a>());</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; H.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; x.<a class="code" href="classMatrix1D.html#afee3e8e4391cb2a57591a97895e6988e">size</a>(); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <a class="code" href="numerical__recipes_8cpp.html#a2d70d5cde83a687bd8b9cfd74b68836f">grad</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) += H(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) * <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// Now, compute c^t*x+1/2*x^t*H*x</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">// Add c to the gradient</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordtype">double</span> quad = 0;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    val = 0;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; x.<a class="code" href="classMatrix1D.html#afee3e8e4391cb2a57591a97895e6988e">size</a>(); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        quad += <a class="code" href="numerical__recipes_8cpp.html#a2d70d5cde83a687bd8b9cfd74b68836f">grad</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) * <a class="code" href="numerical__recipes_8cpp.html#a2d70d5cde83a687bd8b9cfd74b68836f">grad</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>); <span class="comment">// quad=x^t*H^t*H*x</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        val += <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) * <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);  <span class="comment">// val=c^t*x</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#a2d70d5cde83a687bd8b9cfd74b68836f">grad</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) += <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);     <span class="comment">// grad+=c</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    val += 0.5 * quad;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}</div><div class="ttc" id="classMatrix2D_html_adf509b54b7664e2e5e1e07cdf24b5a13"><div class="ttname"><a href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Matrix2D::Xdim</a></div><div class="ttdeci">size_t Xdim() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00575">matrix2d.h:575</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00211">xmipp_error.h:211</a></div></div>
<div class="ttc" id="classMatrix1D_html_afee3e8e4391cb2a57591a97895e6988e"><div class="ttname"><a href="classMatrix1D.html#afee3e8e4391cb2a57591a97895e6988e">Matrix1D::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00508">matrix1d.h:508</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a></div><div class="ttdoc">Problem with matrix size. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00152">xmipp_error.h:152</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02230">numerical_recipes.cpp:2230</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a2d70d5cde83a687bd8b9cfd74b68836f"><div class="ttname"><a href="numerical__recipes_8cpp.html#a2d70d5cde83a687bd8b9cfd74b68836f">grad</a></div><div class="ttdeci">doublereal * grad</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02473">numerical_recipes.cpp:2473</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02230">numerical_recipes.cpp:2230</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="classMatrix2D_html_a72dead316b8914e4cb4c9fd411962b55"><div class="ttname"><a href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Matrix2D::Ydim</a></div><div class="ttdeci">size_t Ydim() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00584">matrix2d.h:584</a></div></div>
<div class="ttc" id="classMatrix1D_html_a203e2128d65fd2d51dc764f5e7c52a63"><div class="ttname"><a href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">Matrix1D::initZeros</a></div><div class="ttdeci">void initZeros()</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00592">matrix1d.h:592</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaaff06baf46401c09d999ae2dc0971a1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaff06baf46401c09d999ae2dc0971a1f">&#9670;&nbsp;</a></span>leastSquare()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void leastSquare </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Aeq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>beq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>bl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>bu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solves the least square problem</p>
<div class="fragment"><div class="line"><a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">min</a> 0.5*(Norm(C*x-<a class="code" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a>))   subject to:  A*x &lt;= <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a></div><div class="line">x                                    Aeq*x=beq</div><div class="line">                                     <a class="code" href="numerical__recipes_8cpp.html#a8ddb3706f7f0da780fedfff3731d60e7">bl</a>&lt;=x&lt;=<a class="code" href="numerical__recipes_8cpp.html#ab2cca56863d1f94c7e54807e4506ffde">bu</a></div></div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="numerical__tools_8cpp_source.html#l00322">322</a> of file <a class="el" href="numerical__tools_8cpp_source.html">numerical_tools.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;{</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">// Convert d to Matrix2D for multiplication</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> P;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    P.<a class="code" href="classMatrix2D.html#a4b70bc876bba355095241f80787ae2cc">fromVector</a>(d);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    P = -2.0 * (P.<a class="code" href="classMatrix2D.html#a8073200797ec6121b2ad960f6a41f52a">transpose</a>() * C);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    P = P.<a class="code" href="classMatrix2D.html#a8073200797ec6121b2ad960f6a41f52a">transpose</a>();</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="comment">//Convert back to vector for passing it to quadraticProgramming</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> newd;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    P.<a class="code" href="classMatrix2D.html#a540343dc33b6b2c35cfe76339b27ebb3">toVector</a>(newd);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <a class="code" href="group__NumericalTools.html#gac8d6d47ed28167a8592043c1fcd7467a">quadraticProgramming</a>(C.<a class="code" href="classMatrix2D.html#a8073200797ec6121b2ad960f6a41f52a">transpose</a>()*C, newd, A, <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, Aeq, beq, <a class="code" href="numerical__recipes_8cpp.html#a8ddb3706f7f0da780fedfff3731d60e7">bl</a>, <a class="code" href="numerical__recipes_8cpp.html#ab2cca56863d1f94c7e54807e4506ffde">bu</a>, <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;}</div><div class="ttc" id="classMatrix2D_html_a4b70bc876bba355095241f80787ae2cc"><div class="ttname"><a href="classMatrix2D.html#a4b70bc876bba355095241f80787ae2cc">Matrix2D::fromVector</a></div><div class="ttdeci">void fromVector(const Matrix1D&lt; T &gt; &amp;op1)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l00803">matrix2d.cpp:803</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a8ddb3706f7f0da780fedfff3731d60e7"><div class="ttname"><a href="numerical__recipes_8cpp.html#a8ddb3706f7f0da780fedfff3731d60e7">bl</a></div><div class="ttdeci">double * bl</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04414">numerical_recipes.cpp:4414</a></div></div>
<div class="ttc" id="classMatrix2D_html_a540343dc33b6b2c35cfe76339b27ebb3"><div class="ttname"><a href="classMatrix2D.html#a540343dc33b6b2c35cfe76339b27ebb3">Matrix2D::toVector</a></div><div class="ttdeci">void toVector(Matrix1D&lt; T &gt; &amp;op1) const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l00832">matrix2d.cpp:832</a></div></div>
<div class="ttc" id="classMatrix2D_html_a8073200797ec6121b2ad960f6a41f52a"><div class="ttname"><a href="classMatrix2D.html#a8073200797ec6121b2ad960f6a41f52a">Matrix2D::transpose</a></div><div class="ttdeci">Matrix2D&lt; T &gt; transpose() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l01314">matrix2d.cpp:1314</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02230">numerical_recipes.cpp:2230</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab2cca56863d1f94c7e54807e4506ffde"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab2cca56863d1f94c7e54807e4506ffde">bu</a></div><div class="ttdeci">double * bu</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04414">numerical_recipes.cpp:4414</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af090b2fbbd2916bfb2e493c5162969d6"><div class="ttname"><a href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a></div><div class="ttdeci">doublereal * b</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02230">numerical_recipes.cpp:2230</a></div></div>
<div class="ttc" id="group__NumericalTools_html_gac8d6d47ed28167a8592043c1fcd7467a"><div class="ttname"><a href="group__NumericalTools.html#gac8d6d47ed28167a8592043c1fcd7467a">quadraticProgramming</a></div><div class="ttdeci">void quadraticProgramming(const Matrix2D&lt; double &gt; &amp;C, const Matrix1D&lt; double &gt; &amp;d, const Matrix2D&lt; double &gt; &amp;A, const Matrix1D&lt; double &gt; &amp;b, const Matrix2D&lt; double &gt; &amp;Aeq, const Matrix1D&lt; double &gt; &amp;beq, Matrix1D&lt; double &gt; &amp;bl, Matrix1D&lt; double &gt; &amp;bu, Matrix1D&lt; double &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__tools_8cpp_source.html#l00222">numerical_tools.cpp:222</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga79baaafce9164726b0f3e0cc28000f6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga79baaafce9164726b0f3e0cc28000f6a">&#9670;&nbsp;</a></span>powellOptimizer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void powellOptimizer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double(*)(double *, void *)&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>prm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ftol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>fret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>steps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>show</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Optimize using Powell's method.</p>
<p>See Numerical Recipes Chapter 10.</p>
<p>Problem: Minimize f(x) starting at point p. n is the dimension of x. If changes are smaller than ftol then stop. The number of iterations is returned in iter, fret contains the function value at the minimum and p contains the minimum.</p>
<p>Watch out that the evaluating function f must consider that x starts at index 1, at least, and goes until n. i0 is used to allow optimization in large spaces where only one part is going to be optimized. Thus, if in a vector of dimension 20 you want to optimize the first 3 components then i0=1, n=3; if you want to optimize it all, i0=1, n=20; and if you want to optimize the last five components i0=15, n=5.</p>
<p>The steps define the allowed steps on each variable. When a variable has large ranges this step should be larger to allow bigger movements. The steps should have only the dimension of the optimized part (3,20 and 5 in the examples above).</p>
<p>The option show forces the routine to show the convergence path</p>
<p>If your function needs extra parameters you can pass them through the void pointer prm. If you don't need this feature set it to NULL.</p>
<p>Example of use:</p>
<div class="fragment"><div class="line"><a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>(8), <a class="code" href="numerical__recipes_8cpp.html#a2de5b01a4efcb9b1582bb2947efc6bad">steps</a>(8);</div><div class="line"><span class="keywordtype">double</span> <a class="code" href="volume__align__prog_8cpp.html#a8b50613ae00d92ad08f3d5481b2fe213">fitness</a>;</div><div class="line"><span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a4155d511de81aa816513aa52de01d931">iter</a>;</div><div class="line"><a class="code" href="numerical__recipes_8cpp.html#a2de5b01a4efcb9b1582bb2947efc6bad">steps</a>.initConstant(1);</div><div class="line">x.<a class="code" href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">initZeros</a>();</div><div class="line"><a class="code" href="numerical__tools_8cpp.html#aa75684a0e8adbe5ee59bfd1540907ab3">powellOptimizer</a>(x,1,8,&amp;<a class="code" href="volume__align__prog_8cpp.html#a423580737626474adfd9661f26412dae">wrapperFitness</a>,NULL,0.01,fitness,iter,<a class="code" href="numerical__recipes_8cpp.html#a2de5b01a4efcb9b1582bb2947efc6bad">steps</a>,<span class="keyword">true</span>);</div></div><!-- fragment --> 
</div>
</div>
<a id="gac8d6d47ed28167a8592043c1fcd7467a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac8d6d47ed28167a8592043c1fcd7467a">&#9670;&nbsp;</a></span>quadraticProgramming()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void quadraticProgramming </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Aeq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>beq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>bl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>bu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solves Quadratic programming subproblem</p>
<div class="fragment"><div class="line"><a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">min</a> 0.5*x<span class="stringliteral">&#39;Cx + d&#39;</span>x   subject to:  A*x &lt;= b</div><div class="line"> x                                Aeq*x=beq</div><div class="line">                                  bl&lt;=x&lt;=bu</div></div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="numerical__tools_8cpp_source.html#l00222">222</a> of file <a class="el" href="numerical__tools_8cpp_source.html">numerical_tools.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;{</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="structCDAB.html">CDAB</a> <a class="code" href="mpi__classify__CL2D_8cpp.html#a831c08adbb8230fd6a60f4a130923a19">prm</a>;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    prm.<a class="code" href="structCDAB.html#a016d066ea30a00d6d2b785139ff17042">C</a> = C;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    prm.<a class="code" href="structCDAB.html#a54e4d8736fa7f05932f00307b4c0c9b8">D</a>.<a class="code" href="classMatrix2D.html#a4b70bc876bba355095241f80787ae2cc">fromVector</a>(d);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    prm.<a class="code" href="structCDAB.html#ae7bb7e196abf3001a942ce514ec3d551">A</a>.<a class="code" href="classMatrix2D.html#a35921c37b27282bac3b3868cce8feb26">initZeros</a>(A.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>() + Aeq.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>(), A.<a class="code" href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Xdim</a>());</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    prm.<a class="code" href="structCDAB.html#affc22de0a4a298bb9785dc458c86e555">B</a>.<a class="code" href="classMatrix2D.html#a35921c37b27282bac3b3868cce8feb26">initZeros</a>(prm.<a class="code" href="structCDAB.html#ae7bb7e196abf3001a942ce514ec3d551">A</a>.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>(), 1);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">// Copy Inequalities</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; A.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; A.<a class="code" href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Xdim</a>(); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            prm.<a class="code" href="structCDAB.html#ae7bb7e196abf3001a942ce514ec3d551">A</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = A(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        prm.<a class="code" href="structCDAB.html#affc22de0a4a298bb9785dc458c86e555">B</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, 0) = <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    }</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// Copy Equalities</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; Aeq.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; Aeq.<a class="code" href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Xdim</a>(); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            prm.<a class="code" href="structCDAB.html#ae7bb7e196abf3001a942ce514ec3d551">A</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + A.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>(), <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = Aeq(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        prm.<a class="code" href="structCDAB.html#affc22de0a4a298bb9785dc458c86e555">B</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + A.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>(), 0) = beq(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ac780531d5838f385c32f97451c4fe090">bigbnd</a> = 1e30;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// Bounds</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">if</span> (bl.<a class="code" href="classMatrix1D.html#afee3e8e4391cb2a57591a97895e6988e">size</a>() == 0)</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    {</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        bl.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(C.<a class="code" href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Xdim</a>());</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        bl.<a class="code" href="classMatrix1D.html#a64e7d0a8fd1ed74d99b9607e832587b5">initConstant</a>(-bigbnd);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    }</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">if</span> (bu.<a class="code" href="classMatrix1D.html#afee3e8e4391cb2a57591a97895e6988e">size</a>() == 0)</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    {</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        bu.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(C.<a class="code" href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Xdim</a>());</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        bu.<a class="code" href="classMatrix1D.html#a64e7d0a8fd1ed74d99b9607e832587b5">initConstant</a>(bigbnd);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    }</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">// Define intermediate variables</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a> = 100;  <span class="comment">// CFSQP mode</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="numerical__recipes_8cpp.html#a6d4037736afd63d4c22fd7b301748a27">iprint</a> = 0;  <span class="comment">// Debugging</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="numerical__recipes_8cpp.html#a87220f7b392aebf13d78c28f94c7a43e">miter</a> = 1000;  <span class="comment">// Maximum number of iterations</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#a974b448c3d0a13d483d36ef15de369b5">eps</a> = 1e-4; <span class="comment">// Epsilon</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordtype">double</span> epsneq = 1e-4; <span class="comment">// Epsilon for equalities</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#a5e8fc7bc2cb7c318cd3a55dc56e10ada">udelta</a> = 0.e0; <span class="comment">// Finite difference approximation</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// of the gradients. Not used in this function</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="numerical__recipes_8cpp.html#a0d43bc60ca89cf554bd5da001a754903">nparam</a> = C.<a class="code" href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Xdim</a>(); <span class="comment">// Number of variables</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="numerical__recipes_8cpp.html#abf290c48df7e67c8dd3269c3827ee97a">nf</a> = 1;          <span class="comment">// Number of objective functions</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="numerical__recipes_8cpp.html#a3dd3ff045c7d99f32d0537b3d0bf8b9c">neqn</a> = Aeq.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>();        <span class="comment">// Number of nonlinear equations</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="numerical__recipes_8cpp.html#adb33a73556ee86a4bbd6e2705fefadbb">nineqn</a> = A.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>();      <span class="comment">// Number of nonlinear inequations</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="numerical__recipes_8cpp.html#a8a633e543b82048446cac4211d62f0d3">nineq</a> = A.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>();  <span class="comment">// Number of linear inequations</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="numerical__recipes_8cpp.html#af9beebb26f8d33a0e8726f36b157a313">neq</a> = Aeq.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>();  <span class="comment">// Number of linear equations</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="numerical__recipes_8cpp.html#ab0fc8e2ac44d4a2a11c4a02f2d4c01cb">inform</a>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="numerical__recipes_8cpp.html#af187f0d75fcac151481ede87034b21cc">ncsrl</a> = 0;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="numerical__recipes_8cpp.html#acae242c29e20612fecaa14e4cbc92acd">ncsrn</a> = 0;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="numerical__recipes_8cpp.html#a185a4441d011b5e765c7170f392f4985">nfsr</a> = 0;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordtype">int</span>    <a class="code" href="numerical__recipes_8cpp.html#a9fa417606af378dc9b10cbdb8bddd646">mesh_pts</a>[] = {0};</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">if</span> (x.<a class="code" href="classMatrix1D.html#afee3e8e4391cb2a57591a97895e6988e">size</a>() == 0)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        x.<a class="code" href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">initZeros</a>(nparam);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>(nf);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a>(nineq + neq);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>(nineq + neq + nf + nparam);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// Call the minimization routine</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a5d92fe59d0f987587eee77b8a4f7adfa">cfsqp</a>(nparam, nf, nfsr, nineqn, nineq, neqn, neq, ncsrl, ncsrn, mesh_pts,</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;          mode, iprint, miter, &amp;inform, bigbnd, eps, epsneq, udelta,</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;          <a class="code" href="group__Vectors.html#ga21ab5fd33dec74a72e18c6f724e60b50">MATRIX1D_ARRAY</a>(bl), <a class="code" href="group__Vectors.html#ga21ab5fd33dec74a72e18c6f724e60b50">MATRIX1D_ARRAY</a>(bu),</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;          <a class="code" href="group__Vectors.html#ga21ab5fd33dec74a72e18c6f724e60b50">MATRIX1D_ARRAY</a>(x),</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;          <a class="code" href="group__Vectors.html#ga21ab5fd33dec74a72e18c6f724e60b50">MATRIX1D_ARRAY</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>), <a class="code" href="group__Vectors.html#ga21ab5fd33dec74a72e18c6f724e60b50">MATRIX1D_ARRAY</a>(<a class="code" href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a>),</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;          <a class="code" href="group__Vectors.html#ga21ab5fd33dec74a72e18c6f724e60b50">MATRIX1D_ARRAY</a>(<a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>),</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;          <span class="comment">//  quadprg_obj32,quadprog_cntr32,quadprog_grob32,quadprog_grcn32,</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;          <a class="code" href="numerical__tools_8cpp.html#a75b37b6177bc2adea4184aa6c4d6b8f1">quadraticProgramming_obj32</a>, <a class="code" href="numerical__tools_8cpp.html#a5850f1b96167ebb4d9f05b00b8aa5bf0">quadraticProgramming_cntr32</a>, <a class="code" href="numerical__recipes_8cpp.html#a67dfaac99b5cb19021d03f8a12e31d7d">grobfd</a>, <a class="code" href="numerical__recipes_8cpp.html#a7b82246a2e690fd207c05320b5b9d708">grcnfd</a>,</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;          (<span class="keywordtype">void</span>*)&amp;prm);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">if</span> (inform == 0)</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;SUCCESSFUL RETURN. \n&quot;</span>;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">if</span> (inform == 1 || inform == 2)</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;\nINITIAL GUESS INFEASIBLE.\n&quot;</span>;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">if</span> (inform == 3)</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        printf(<span class="stringliteral">&quot;\n MAXIMUM NUMBER OF ITERATIONS REACHED.\n&quot;</span>);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">if</span> (inform &gt; 3)</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        printf(<span class="stringliteral">&quot;\ninform=%d\n&quot;</span>, inform);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;}</div><div class="ttc" id="classMatrix2D_html_adf509b54b7664e2e5e1e07cdf24b5a13"><div class="ttname"><a href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Matrix2D::Xdim</a></div><div class="ttdeci">size_t Xdim() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00575">matrix2d.h:575</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a8a633e543b82048446cac4211d62f0d3"><div class="ttname"><a href="numerical__recipes_8cpp.html#a8a633e543b82048446cac4211d62f0d3">nineq</a></div><div class="ttdeci">void nineq</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a67dfaac99b5cb19021d03f8a12e31d7d"><div class="ttname"><a href="numerical__recipes_8cpp.html#a67dfaac99b5cb19021d03f8a12e31d7d">grobfd</a></div><div class="ttdeci">void grobfd()</div></div>
<div class="ttc" id="classMatrix1D_html_afee3e8e4391cb2a57591a97895e6988e"><div class="ttname"><a href="classMatrix1D.html#afee3e8e4391cb2a57591a97895e6988e">Matrix1D::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00508">matrix1d.h:508</a></div></div>
<div class="ttc" id="classMatrix2D_html_a4b70bc876bba355095241f80787ae2cc"><div class="ttname"><a href="classMatrix2D.html#a4b70bc876bba355095241f80787ae2cc">Matrix2D::fromVector</a></div><div class="ttdeci">void fromVector(const Matrix1D&lt; T &gt; &amp;op1)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l00803">matrix2d.cpp:803</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af72286acf4184005499476fbc853146f"><div class="ttname"><a href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a></div><div class="ttdeci">doublereal * g</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02473">numerical_recipes.cpp:2473</a></div></div>
<div class="ttc" id="structCDAB_html_ae7bb7e196abf3001a942ce514ec3d551"><div class="ttname"><a href="structCDAB.html#ae7bb7e196abf3001a942ce514ec3d551">CDAB::A</a></div><div class="ttdeci">Matrix2D&lt; double &gt; A</div><div class="ttdef"><b>Definition:</b> <a href="numerical__tools_8cpp_source.html#l00160">numerical_tools.cpp:160</a></div></div>
<div class="ttc" id="numerical__tools_8cpp_html_a5850f1b96167ebb4d9f05b00b8aa5bf0"><div class="ttname"><a href="numerical__tools_8cpp.html#a5850f1b96167ebb4d9f05b00b8aa5bf0">quadraticProgramming_cntr32</a></div><div class="ttdeci">void quadraticProgramming_cntr32(int nparam, int j, double *x, double *gj, void *cd)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__tools_8cpp_source.html#l00182">numerical_tools.cpp:182</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a0d43bc60ca89cf554bd5da001a754903"><div class="ttname"><a href="numerical__recipes_8cpp.html#a0d43bc60ca89cf554bd5da001a754903">nparam</a></div><div class="ttdeci">static void nparam</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05153">numerical_recipes.cpp:5153</a></div></div>
<div class="ttc" id="structCDAB_html"><div class="ttname"><a href="structCDAB.html">CDAB</a></div><div class="ttdef"><b>Definition:</b> <a href="numerical__tools_8cpp_source.html#l00156">numerical_tools.cpp:156</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a5e8fc7bc2cb7c318cd3a55dc56e10ada"><div class="ttname"><a href="numerical__recipes_8cpp.html#a5e8fc7bc2cb7c318cd3a55dc56e10ada">udelta</a></div><div class="ttdeci">double udelta</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04413">numerical_recipes.cpp:4413</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a185a4441d011b5e765c7170f392f4985"><div class="ttname"><a href="numerical__recipes_8cpp.html#a185a4441d011b5e765c7170f392f4985">nfsr</a></div><div class="ttdeci">void nfsr</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a9fa417606af378dc9b10cbdb8bddd646"><div class="ttname"><a href="numerical__recipes_8cpp.html#a9fa417606af378dc9b10cbdb8bddd646">mesh_pts</a></div><div class="ttdeci">void * mesh_pts</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="structCDAB_html_affc22de0a4a298bb9785dc458c86e555"><div class="ttname"><a href="structCDAB.html#affc22de0a4a298bb9785dc458c86e555">CDAB::B</a></div><div class="ttdeci">Matrix2D&lt; double &gt; B</div><div class="ttdef"><b>Definition:</b> <a href="numerical__tools_8cpp_source.html#l00161">numerical_tools.cpp:161</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a974b448c3d0a13d483d36ef15de369b5"><div class="ttname"><a href="numerical__recipes_8cpp.html#a974b448c3d0a13d483d36ef15de369b5">eps</a></div><div class="ttdeci">cmache_1 eps</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02273">numerical_recipes.cpp:2273</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a6d4037736afd63d4c22fd7b301748a27"><div class="ttname"><a href="numerical__recipes_8cpp.html#a6d4037736afd63d4c22fd7b301748a27">iprint</a></div><div class="ttdeci">integer * iprint</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02231">numerical_recipes.cpp:2231</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_adb33a73556ee86a4bbd6e2705fefadbb"><div class="ttname"><a href="numerical__recipes_8cpp.html#adb33a73556ee86a4bbd6e2705fefadbb">nineqn</a></div><div class="ttdeci">void nineqn</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="structCDAB_html_a016d066ea30a00d6d2b785139ff17042"><div class="ttname"><a href="structCDAB.html#a016d066ea30a00d6d2b785139ff17042">CDAB::C</a></div><div class="ttdeci">Matrix2D&lt; double &gt; C</div><div class="ttdef"><b>Definition:</b> <a href="numerical__tools_8cpp_source.html#l00158">numerical_tools.cpp:158</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a87220f7b392aebf13d78c28f94c7a43e"><div class="ttname"><a href="numerical__recipes_8cpp.html#a87220f7b392aebf13d78c28f94c7a43e">miter</a></div><div class="ttdeci">void miter</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af090b2fbbd2916bfb2e493c5162969d6"><div class="ttname"><a href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a></div><div class="ttdeci">doublereal * b</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02230">numerical_recipes.cpp:2230</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_abf290c48df7e67c8dd3269c3827ee97a"><div class="ttname"><a href="numerical__recipes_8cpp.html#abf290c48df7e67c8dd3269c3827ee97a">nf</a></div><div class="ttdeci">void nf</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ac780531d5838f385c32f97451c4fe090"><div class="ttname"><a href="numerical__recipes_8cpp.html#ac780531d5838f385c32f97451c4fe090">bigbnd</a></div><div class="ttdeci">double bigbnd</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04413">numerical_recipes.cpp:4413</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a5d92fe59d0f987587eee77b8a4f7adfa"><div class="ttname"><a href="numerical__recipes_8cpp.html#a5d92fe59d0f987587eee77b8a4f7adfa">cfsqp</a></div><div class="ttdeci">void cfsqp(nparam, nf, nfsr, nineqn, nineq, neqn, neq, ncsrl, ncsrn, mesh_pts, mode, iprint, miter, inform, bigbnd, eps, epseqn, udelta, bl, bu, x, f, g, lambda, obj, constr, gradob, gradcn, cd) int nparam</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca36b09d6e71a60cfa3837d7e24c07ca"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a></div><div class="ttdeci">double * lambda</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04414">numerical_recipes.cpp:4414</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a633de4b0c14ca52ea2432a3c8a5c4c31"><div class="ttname"><a href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a></div><div class="ttdeci">double * f</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04414">numerical_recipes.cpp:4414</a></div></div>
<div class="ttc" id="classMatrix1D_html_a79a482948ae334cbefaef7c7839cd934"><div class="ttname"><a href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">Matrix1D::resize</a></div><div class="ttdeci">void resize(size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00410">matrix1d.h:410</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_acae242c29e20612fecaa14e4cbc92acd"><div class="ttname"><a href="numerical__recipes_8cpp.html#acae242c29e20612fecaa14e4cbc92acd">ncsrn</a></div><div class="ttdeci">void ncsrn</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3dd3ff045c7d99f32d0537b3d0bf8b9c"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3dd3ff045c7d99f32d0537b3d0bf8b9c">neqn</a></div><div class="ttdeci">void neqn</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="classMatrix2D_html_a72dead316b8914e4cb4c9fd411962b55"><div class="ttname"><a href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Matrix2D::Ydim</a></div><div class="ttdeci">size_t Ydim() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00584">matrix2d.h:584</a></div></div>
<div class="ttc" id="structCDAB_html_a54e4d8736fa7f05932f00307b4c0c9b8"><div class="ttname"><a href="structCDAB.html#a54e4d8736fa7f05932f00307b4c0c9b8">CDAB::D</a></div><div class="ttdeci">Matrix2D&lt; double &gt; D</div><div class="ttdef"><b>Definition:</b> <a href="numerical__tools_8cpp_source.html#l00159">numerical_tools.cpp:159</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af187f0d75fcac151481ede87034b21cc"><div class="ttname"><a href="numerical__recipes_8cpp.html#af187f0d75fcac151481ede87034b21cc">ncsrl</a></div><div class="ttdeci">void ncsrl</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a74e37497baeb87072fb1730874e59adb"><div class="ttname"><a href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a></div><div class="ttdeci">void mode</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="numerical__tools_8cpp_html_a75b37b6177bc2adea4184aa6c4d6b8f1"><div class="ttname"><a href="numerical__tools_8cpp.html#a75b37b6177bc2adea4184aa6c4d6b8f1">quadraticProgramming_obj32</a></div><div class="ttdeci">void quadraticProgramming_obj32(int nparam, int j, double *x, double *fj, void *cd)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__tools_8cpp_source.html#l00169">numerical_tools.cpp:169</a></div></div>
<div class="ttc" id="classMatrix1D_html_a203e2128d65fd2d51dc764f5e7c52a63"><div class="ttname"><a href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">Matrix1D::initZeros</a></div><div class="ttdeci">void initZeros()</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00592">matrix1d.h:592</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__Vectors_html_ga21ab5fd33dec74a72e18c6f724e60b50"><div class="ttname"><a href="group__Vectors.html#ga21ab5fd33dec74a72e18c6f724e60b50">MATRIX1D_ARRAY</a></div><div class="ttdeci">#define MATRIX1D_ARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00058">matrix1d.h:58</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af9beebb26f8d33a0e8726f36b157a313"><div class="ttname"><a href="numerical__recipes_8cpp.html#af9beebb26f8d33a0e8726f36b157a313">neq</a></div><div class="ttdeci">void neq</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="classMatrix2D_html_a35921c37b27282bac3b3868cce8feb26"><div class="ttname"><a href="classMatrix2D.html#a35921c37b27282bac3b3868cce8feb26">Matrix2D::initZeros</a></div><div class="ttdeci">void initZeros()</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00626">matrix2d.h:626</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab0fc8e2ac44d4a2a11c4a02f2d4c01cb"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab0fc8e2ac44d4a2a11c4a02f2d4c01cb">inform</a></div><div class="ttdeci">void * inform</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="mpi__classify__CL2D_8cpp_html_a831c08adbb8230fd6a60f4a130923a19"><div class="ttname"><a href="mpi__classify__CL2D_8cpp.html#a831c08adbb8230fd6a60f4a130923a19">prm</a></div><div class="ttdeci">ProgClassifyCL2D * prm</div><div class="ttdef"><b>Definition:</b> <a href="mpi__classify__CL2D_8cpp_source.html#l00035">mpi_classify_CL2D.cpp:35</a></div></div>
<div class="ttc" id="classMatrix1D_html_a64e7d0a8fd1ed74d99b9607e832587b5"><div class="ttname"><a href="classMatrix1D.html#a64e7d0a8fd1ed74d99b9607e832587b5">Matrix1D::initConstant</a></div><div class="ttdeci">void initConstant(T val)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8cpp_source.html#l00083">matrix1d.cpp:83</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a7b82246a2e690fd207c05320b5b9d708"><div class="ttname"><a href="numerical__recipes_8cpp.html#a7b82246a2e690fd207c05320b5b9d708">grcnfd</a></div><div class="ttdeci">void grcnfd()</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga8adb759f5f06b69188a55f32e9f798d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8adb759f5f06b69188a55f32e9f798d9">&#9670;&nbsp;</a></span>randomPermutation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void randomPermutation </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate random permutation</p>
<p>Generate a random permutation of the numbers between 0 and N-1 </p>

<p class="definition">Definition at line <a class="el" href="numerical__tools_8cpp_source.html#l00033">33</a> of file <a class="el" href="numerical__tools_8cpp_source.html">numerical_tools.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> aux;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    aux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(N);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    aux.<a class="code" href="classMultidimArray.html#aa493753b649c73ec5a9b0938485afba5">initRandom</a>(0,1);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    aux.<a class="code" href="classMultidimArray.html#a754c320ba201c476a010c6d7ac7cb6ed">indexSort</a>(result);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    result-=1;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00983">multidim_array.cpp:983</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classMultidimArray_html_aa493753b649c73ec5a9b0938485afba5"><div class="ttname"><a href="classMultidimArray.html#aa493753b649c73ec5a9b0938485afba5">MultidimArray::initRandom</a></div><div class="ttdeci">void initRandom(double op1, double op2, RandomMode mode=RND_UNIFORM)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00821">multidim_array.cpp:821</a></div></div>
<div class="ttc" id="classMultidimArray_html_a754c320ba201c476a010c6d7ac7cb6ed"><div class="ttname"><a href="classMultidimArray.html#a754c320ba201c476a010c6d7ac7cb6ed">MultidimArray::indexSort</a></div><div class="ttdeci">void indexSort(MultidimArray&lt; int &gt; &amp;indx) const</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00882">multidim_array.cpp:882</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaf68a96a59ed1dc04c7c665add194438b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf68a96a59ed1dc04c7c665add194438b">&#9670;&nbsp;</a></span>regularizedLeastSquare()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void regularizedLeastSquare </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solves the regularized least squares problem</p>
<div class="fragment"><div class="line"><a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">min</a> Norm(A*<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>-<a class="code" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a>) + <a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a> * <a class="code" href="group__VectorOperations.html#ga97e0d6313ec44af8ab21f7842d14125e">norm</a> (G*<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>)</div></div><!-- fragment --><p>Give an empty G matrix (NULL matrix) if G is the identity matrix If AtA is not a NULL matrix, then the product AtA is not computed. </p>

<p class="definition">Definition at line <a class="el" href="numerical__tools_8cpp_source.html#l00342">342</a> of file <a class="el" href="numerical__tools_8cpp_source.html">numerical_tools.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;{</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordtype">int</span> Nx=A.<a class="code" href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Xdim</a>(); <span class="comment">// Number of variables</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> X(Nx,Nx); <span class="comment">// X=(A^t * A +lambda *G^t G)</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// Compute A^t*A</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <a class="code" href="group__Matrices.html#ga80aee91a3508fa5d1df6fc0ee3693b06">FOR_ALL_ELEMENTS_IN_MATRIX2D</a>(X)</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">// Compute the dot product of the i-th and j-th columns of A</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>=0; <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>&lt;A.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>(); <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>++)</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        X(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) += A(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) * A(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// Compute lambda*G^t*G</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">if</span> (G.<a class="code" href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Xdim</a>()==0)</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;Nx; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            X(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)+=<a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <a class="code" href="group__Matrices.html#ga80aee91a3508fa5d1df6fc0ee3693b06">FOR_ALL_ELEMENTS_IN_MATRIX2D</a>(X)</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="comment">// Compute the dot product of the i-th and j-th columns of G</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>=0; <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>&lt;G.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>(); <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>++)</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            X(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) += G(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) * G(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">// Compute A^t*d</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> Atd(Nx);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="group__Vectors.html#ga8333ba47b67df6174e1d4cfb85920c71">FOR_ALL_ELEMENTS_IN_MATRIX1D</a>(Atd)</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">// Compute the dot product of the i-th column of A and d</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>=0; <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>&lt;A.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>(); <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>++)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        Atd(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) += A(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) * <a class="code" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a>(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">// Compute the inverse of X</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> Xinv;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    X.<a class="code" href="classMatrix2D.html#a9f030f9fa81662482c08a2ac186a57ba">inv</a>(Xinv);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">// Now multiply Xinv * A^t * d</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <a class="code" href="group__Matrices.html#gad6401a5db630efab48421306d73fa2ca">matrixOperation_Ax</a>(Xinv, Atd, x);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;}</div><div class="ttc" id="group__Matrices_html_ga80aee91a3508fa5d1df6fc0ee3693b06"><div class="ttname"><a href="group__Matrices.html#ga80aee91a3508fa5d1df6fc0ee3693b06">FOR_ALL_ELEMENTS_IN_MATRIX2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_MATRIX2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00104">matrix2d.h:104</a></div></div>
<div class="ttc" id="classMatrix2D_html_adf509b54b7664e2e5e1e07cdf24b5a13"><div class="ttname"><a href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Matrix2D::Xdim</a></div><div class="ttdeci">size_t Xdim() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00575">matrix2d.h:575</a></div></div>
<div class="ttc" id="classMatrix2D_html_a9f030f9fa81662482c08a2ac186a57ba"><div class="ttname"><a href="classMatrix2D.html#a9f030f9fa81662482c08a2ac186a57ba">Matrix2D::inv</a></div><div class="ttdeci">void inv(Matrix2D&lt; T &gt; &amp;result) const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l00663">matrix2d.cpp:663</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3939496af6ccffe20d083935ebd3225b"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a></div><div class="ttdeci">doublereal * d</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02230">numerical_recipes.cpp:2230</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8333ba47b67df6174e1d4cfb85920c71"><div class="ttname"><a href="group__Vectors.html#ga8333ba47b67df6174e1d4cfb85920c71">FOR_ALL_ELEMENTS_IN_MATRIX1D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_MATRIX1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00072">matrix1d.h:72</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca36b09d6e71a60cfa3837d7e24c07ca"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a></div><div class="ttdeci">double * lambda</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04414">numerical_recipes.cpp:4414</a></div></div>
<div class="ttc" id="classMatrix2D_html_a72dead316b8914e4cb4c9fd411962b55"><div class="ttname"><a href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Matrix2D::Ydim</a></div><div class="ttdeci">size_t Ydim() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00584">matrix2d.h:584</a></div></div>
<div class="ttc" id="group__Matrices_html_gad6401a5db630efab48421306d73fa2ca"><div class="ttname"><a href="group__Matrices.html#gad6401a5db630efab48421306d73fa2ca">matrixOperation_Ax</a></div><div class="ttdeci">void matrixOperation_Ax(const Matrix2D&lt; double &gt; &amp;A, const Matrix1D&lt; double &gt; &amp;x, Matrix1D&lt; double &gt; &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l00424">matrix2d.cpp:424</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga97aa59ea3c2ed976c363510ea8c251d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga97aa59ea3c2ed976c363510ea8c251d7">&#9670;&nbsp;</a></span>solve() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void solve </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solves a linear equation system by LU decomposition. </p>

<p class="definition">Definition at line <a class="el" href="numerical__tools_8h_source.html#l00215">215</a> of file <a class="el" href="numerical__tools_8h_source.html">numerical_tools.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;{</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a>(A) == 0)</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa668727aacc2dda12360b52026d980531">ERR_MATRIX_EMPTY</a>, <span class="stringliteral">&quot;Solve: Matrix is empty&quot;</span>);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a>(A) != <a class="code" href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a>(A))</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a>, <span class="stringliteral">&quot;Solve: Matrix is not squared&quot;</span>);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a>(A) != b.<a class="code" href="classMatrix1D.html#afee3e8e4391cb2a57591a97895e6988e">size</a>())</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a>, <span class="stringliteral">&quot;Solve: Different sizes of Matrix and Vector&quot;</span>);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">if</span> (b.<a class="code" href="classMatrix1D.html#a23795730f5b91e4997d4149b083e89a6">isRow</a>())</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aaf94b1751e7bb5a7a7623c06c85301473">ERR_MATRIX_DIM</a>, <span class="stringliteral">&quot;Solve: Not correct vector shape&quot;</span>);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">// Perform LU decomposition and then solve</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt; int &gt;</a> indx;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    T <a class="code" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a>;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;T&gt;</a> LU;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="group__Matrices.html#ga622c71e61aa2209b38395e09cfc0db87">ludcmp</a>(A, LU, indx, d);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    result = <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="group__Matrices.html#gaca6ed1827ea887d166cab264ed786240">lubksb</a>(LU, indx, result);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;}</div><div class="ttc" id="group__Matrices_html_ga43e28f6079b3652588d5b76ff199ff1e"><div class="ttname"><a href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a></div><div class="ttdeci">#define MAT_YSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00124">matrix2d.h:124</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00211">xmipp_error.h:211</a></div></div>
<div class="ttc" id="classMatrix1D_html_afee3e8e4391cb2a57591a97895e6988e"><div class="ttname"><a href="classMatrix1D.html#afee3e8e4391cb2a57591a97895e6988e">Matrix1D::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00508">matrix1d.h:508</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a></div><div class="ttdoc">Problem with matrix size. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00152">xmipp_error.h:152</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa668727aacc2dda12360b52026d980531"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa668727aacc2dda12360b52026d980531">ERR_MATRIX_EMPTY</a></div><div class="ttdoc">The matrix is empty. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00151">xmipp_error.h:151</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3939496af6ccffe20d083935ebd3225b"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a></div><div class="ttdeci">doublereal * d</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02230">numerical_recipes.cpp:2230</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D</a></div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00036">mask.h:36</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af090b2fbbd2916bfb2e493c5162969d6"><div class="ttname"><a href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a></div><div class="ttdeci">doublereal * b</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02230">numerical_recipes.cpp:2230</a></div></div>
<div class="ttc" id="group__Matrices_html_gaca6ed1827ea887d166cab264ed786240"><div class="ttname"><a href="group__Matrices.html#gaca6ed1827ea887d166cab264ed786240">lubksb</a></div><div class="ttdeci">void lubksb(const Matrix2D&lt; T &gt; &amp;LU, Matrix1D&lt; int &gt; &amp;indx, Matrix1D&lt; T &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l00596">matrix2d.cpp:596</a></div></div>
<div class="ttc" id="classMatrix1D_html_a23795730f5b91e4997d4149b083e89a6"><div class="ttname"><a href="classMatrix1D.html#a23795730f5b91e4997d4149b083e89a6">Matrix1D::isRow</a></div><div class="ttdeci">int isRow() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00520">matrix1d.h:520</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aaf94b1751e7bb5a7a7623c06c85301473"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aaf94b1751e7bb5a7a7623c06c85301473">ERR_MATRIX_DIM</a></div><div class="ttdoc">Problem with matrix dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00150">xmipp_error.h:150</a></div></div>
<div class="ttc" id="group__Matrices_html_ga622c71e61aa2209b38395e09cfc0db87"><div class="ttname"><a href="group__Matrices.html#ga622c71e61aa2209b38395e09cfc0db87">ludcmp</a></div><div class="ttdeci">void ludcmp(const Matrix2D&lt; T &gt; &amp;A, Matrix2D&lt; T &gt; &amp;LU, Matrix1D&lt; int &gt; &amp;indx, T &amp;d)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l00586">matrix2d.cpp:586</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; int &gt;</a></div></div>
<div class="ttc" id="group__Matrices_html_gacd5c6ac63f21fdbbd4343a9caf1ee9c6"><div class="ttname"><a href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a></div><div class="ttdeci">#define MAT_XSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00120">matrix2d.h:120</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga1f16b269d0089f8d7674f4348eac1402"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1f16b269d0089f8d7674f4348eac1402">&#9670;&nbsp;</a></span>solve() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void solve </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solves a linear equation system by <a class="el" href="classGaussian.html">Gaussian</a> elimination. </p>

<p class="definition">Definition at line <a class="el" href="numerical__tools_8cpp_source.html#l02485">2485</a> of file <a class="el" href="numerical__tools_8cpp_source.html">numerical_tools.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;{</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    <span class="keywordflow">if</span> (A.<a class="code" href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Xdim</a>() == 0)</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa668727aacc2dda12360b52026d980531">ERR_MATRIX_EMPTY</a>, <span class="stringliteral">&quot;Solve: Matrix is empty&quot;</span>);</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;    <span class="keywordflow">if</span> (A.<a class="code" href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Xdim</a>() != A.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>())</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a>, <span class="stringliteral">&quot;Solve: Matrix is not squared&quot;</span>);</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    <span class="keywordflow">if</span> (A.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>() != b.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>())</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a>, <span class="stringliteral">&quot;Solve: Different sizes of A and b&quot;</span>);</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    <span class="comment">// Solve</span></div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;    result = <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>;</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;T&gt;</a> Aux = A;</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;    <a class="code" href="numerical__recipes_8h.html#a1bc154bf37e3fcabb98f998114c32681">gaussj</a>(Aux.<a class="code" href="classMatrix2D.html#a7a4430316785979559818126064fe5ee">adaptForNumericalRecipes2</a>(), Aux.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>(),</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;           result.<a class="code" href="classMatrix2D.html#a7a4430316785979559818126064fe5ee">adaptForNumericalRecipes2</a>(), b.<a class="code" href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Xdim</a>());</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;}</div><div class="ttc" id="classMatrix2D_html_adf509b54b7664e2e5e1e07cdf24b5a13"><div class="ttname"><a href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Matrix2D::Xdim</a></div><div class="ttdeci">size_t Xdim() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00575">matrix2d.h:575</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00211">xmipp_error.h:211</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a></div><div class="ttdoc">Problem with matrix size. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00152">xmipp_error.h:152</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa668727aacc2dda12360b52026d980531"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa668727aacc2dda12360b52026d980531">ERR_MATRIX_EMPTY</a></div><div class="ttdoc">The matrix is empty. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00151">xmipp_error.h:151</a></div></div>
<div class="ttc" id="classMatrix2D_html_a7a4430316785979559818126064fe5ee"><div class="ttname"><a href="classMatrix2D.html#a7a4430316785979559818126064fe5ee">Matrix2D::adaptForNumericalRecipes2</a></div><div class="ttdeci">T * adaptForNumericalRecipes2() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00875">matrix2d.h:875</a></div></div>
<div class="ttc" id="numerical__recipes_8h_html_a1bc154bf37e3fcabb98f998114c32681"><div class="ttname"><a href="numerical__recipes_8h.html#a1bc154bf37e3fcabb98f998114c32681">gaussj</a></div><div class="ttdeci">void gaussj(T *a, int n, T *b, int m)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8h_source.html#l00266">numerical_recipes.h:266</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D</a></div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00036">mask.h:36</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af090b2fbbd2916bfb2e493c5162969d6"><div class="ttname"><a href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a></div><div class="ttdeci">doublereal * b</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02230">numerical_recipes.cpp:2230</a></div></div>
<div class="ttc" id="classMatrix2D_html_a72dead316b8914e4cb4c9fd411962b55"><div class="ttname"><a href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Matrix2D::Ydim</a></div><div class="ttdeci">size_t Ydim() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00584">matrix2d.h:584</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gabbc5e753320601b6f56e63d13e156f05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabbc5e753320601b6f56e63d13e156f05">&#9670;&nbsp;</a></span>solveBySVD()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void solveBySVD </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tolerance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solves a linear equation system by SVD decomposition. </p>

<p class="definition">Definition at line <a class="el" href="numerical__tools_8cpp_source.html#l02446">2446</a> of file <a class="el" href="numerical__tools_8cpp_source.html">numerical_tools.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;{</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;    <span class="keywordflow">if</span> (A.<a class="code" href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Xdim</a>() == 0)</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa668727aacc2dda12360b52026d980531">ERR_MATRIX_EMPTY</a>, <span class="stringliteral">&quot;Solve: Matrix is empty&quot;</span>);</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;    <span class="keywordflow">if</span> (A.<a class="code" href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Xdim</a>() != A.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>())</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a>, <span class="stringliteral">&quot;Solve: Matrix is not squared&quot;</span>);</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    <span class="keywordflow">if</span> (A.<a class="code" href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Xdim</a>() != b.<a class="code" href="classMatrix1D.html#afee3e8e4391cb2a57591a97895e6988e">size</a>())</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a>, <span class="stringliteral">&quot;Solve: Different sizes of Matrix and Vector&quot;</span>);</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    <span class="keywordflow">if</span> (b.<a class="code" href="classMatrix1D.html#a23795730f5b91e4997d4149b083e89a6">isRow</a>())</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aaf94b1751e7bb5a7a7623c06c85301473">ERR_MATRIX_DIM</a>, <span class="stringliteral">&quot;Solve: Not correct vector shape&quot;</span>);</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    <span class="comment">// First perform de single value decomposition</span></div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    <span class="comment">// Xmipp interface that calls to svdcmp of numerical recipes</span></div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt; double &gt;</a> <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a>;</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt; double &gt;</a> v;</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt; double &gt;</a> <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>;</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    <a class="code" href="group__Matrices.html#ga46eb206e2830820e657b26bf82969b85">svdcmp</a>(A, u, w, v);</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    <span class="comment">// Here is checked if eigenvalues of the svd decomposition are acceptable</span></div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    <span class="comment">// If a value is lower than tolerance, the it&#39;s zeroed, as this increases</span></div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    <span class="comment">// the precision of the routine.</span></div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; w.<a class="code" href="classMatrix1D.html#afee3e8e4391cb2a57591a97895e6988e">size</a>(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt; tolerance)</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;            <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = 0;</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    <span class="comment">// Set size of matrices</span></div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    result.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(b.<a class="code" href="classMatrix1D.html#afee3e8e4391cb2a57591a97895e6988e">size</a>());</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    <span class="comment">// Xmipp interface that calls to svdksb of numerical recipes</span></div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt; double &gt;</a> bd;</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    <a class="code" href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a>(b, bd);</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    <a class="code" href="group__Matrices.html#ga2a61e60845f2f8542b0bf5b6f8242681">svbksb</a>(u, w, v, bd, result);</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;}</div><div class="ttc" id="classMatrix2D_html_adf509b54b7664e2e5e1e07cdf24b5a13"><div class="ttname"><a href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Matrix2D::Xdim</a></div><div class="ttdeci">size_t Xdim() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00575">matrix2d.h:575</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00211">xmipp_error.h:211</a></div></div>
<div class="ttc" id="classMatrix1D_html_afee3e8e4391cb2a57591a97895e6988e"><div class="ttname"><a href="classMatrix1D.html#afee3e8e4391cb2a57591a97895e6988e">Matrix1D::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00508">matrix1d.h:508</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a></div><div class="ttdoc">Problem with matrix size. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00152">xmipp_error.h:152</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa668727aacc2dda12360b52026d980531"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa668727aacc2dda12360b52026d980531">ERR_MATRIX_EMPTY</a></div><div class="ttdoc">The matrix is empty. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00151">xmipp_error.h:151</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a2b83edee7677c7a2b0a4e5ac99baa586"><div class="ttname"><a href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a></div><div class="ttdeci">doublereal * w</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02477">numerical_recipes.cpp:2477</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="classMatrix1D_html_a23795730f5b91e4997d4149b083e89a6"><div class="ttname"><a href="classMatrix1D.html#a23795730f5b91e4997d4149b083e89a6">Matrix1D::isRow</a></div><div class="ttdeci">int isRow() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00520">matrix1d.h:520</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aaf94b1751e7bb5a7a7623c06c85301473"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aaf94b1751e7bb5a7a7623c06c85301473">ERR_MATRIX_DIM</a></div><div class="ttdoc">Problem with matrix dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00150">xmipp_error.h:150</a></div></div>
<div class="ttc" id="classMatrix1D_html_a79a482948ae334cbefaef7c7839cd934"><div class="ttname"><a href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">Matrix1D::resize</a></div><div class="ttdeci">void resize(size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00410">matrix1d.h:410</a></div></div>
<div class="ttc" id="classMatrix2D_html_a72dead316b8914e4cb4c9fd411962b55"><div class="ttname"><a href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Matrix2D::Ydim</a></div><div class="ttdeci">size_t Ydim() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00584">matrix2d.h:584</a></div></div>
<div class="ttc" id="group__Matrices_html_ga46eb206e2830820e657b26bf82969b85"><div class="ttname"><a href="group__Matrices.html#ga46eb206e2830820e657b26bf82969b85">svdcmp</a></div><div class="ttdeci">void svdcmp(const Matrix2D&lt; T &gt; &amp;a, Matrix2D&lt; double &gt; &amp;u, Matrix1D&lt; double &gt; &amp;w, Matrix2D&lt; double &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l00125">matrix2d.cpp:125</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_gaf36b657319bb585c75cfa14744dab275"><div class="ttname"><a href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a></div><div class="ttdeci">void typeCast(const Matrix1D&lt; T1 &gt; &amp;v1, Matrix1D&lt; T2 &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01227">matrix1d.h:1227</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a6277e2a7446059985dc9bcf0a4ac1a8f"><div class="ttname"><a href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a></div><div class="ttdeci">doublereal * u</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02230">numerical_recipes.cpp:2230</a></div></div>
<div class="ttc" id="group__Matrices_html_ga2a61e60845f2f8542b0bf5b6f8242681"><div class="ttname"><a href="group__Matrices.html#ga2a61e60845f2f8542b0bf5b6f8242681">svbksb</a></div><div class="ttdeci">void svbksb(Matrix2D&lt; double &gt; &amp;u, Matrix1D&lt; double &gt; &amp;w, Matrix2D&lt; double &gt; &amp;v, Matrix1D&lt; double &gt; &amp;b, Matrix1D&lt; double &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l00174">matrix2d.cpp:174</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga6a7a783997c8d3252c1968ee7ba1ff4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6a7a783997c8d3252c1968ee7ba1ff4e">&#9670;&nbsp;</a></span>solveNonNegative()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double solveNonNegative </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve equation system, nonnegative solution</p>
<p>The equation system is defined by Ax=b, it is solved for x. x is forced to be nonnegative. It is designed to cope with large equation systems. This function is borrowed from LAPACK nnls.</p>
<p>The norm of the vector Ax-b is returned. </p>

<p class="definition">Definition at line <a class="el" href="numerical__tools_8cpp_source.html#l00082">82</a> of file <a class="el" href="numerical__tools_8cpp_source.html">numerical_tools.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;{</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">if</span> (C.Xdim() == 0)</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa668727aacc2dda12360b52026d980531">ERR_MATRIX_EMPTY</a>, <span class="stringliteral">&quot;Solve_nonneg: Matrix is empty&quot;</span>);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">if</span> (C.Ydim() != <a class="code" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a>.size())</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a>, <span class="stringliteral">&quot;Solve_nonneg: Different sizes of Matrix and Vector&quot;</span>);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a>.isRow())</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aaf94b1751e7bb5a7a7623c06c85301473">ERR_MATRIX_DIM</a>, <span class="stringliteral">&quot;Solve_nonneg: Not correct vector shape&quot;</span>);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> Ct;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    Ct=C.<a class="code" href="classMatrix2D.html#a8073200797ec6121b2ad960f6a41f52a">transpose</a>();</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    result.<a class="code" href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">initZeros</a>(Ct.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>());</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordtype">double</span> rnorm;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// Watch out that matrix Ct is transformed.</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordtype">int</span> success = <a class="code" href="numerical__recipes_8cpp.html#a684f806de26391887ed4b583e39d4640">nnls</a>(<a class="code" href="group__Matrices.html#ga43360c8277a416cfcdd9cc0586317186">MATRIX2D_ARRAY</a>(Ct), Ct.<a class="code" href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Xdim</a>(), Ct.<a class="code" href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Ydim</a>(),</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                       <a class="code" href="group__Vectors.html#ga21ab5fd33dec74a72e18c6f724e60b50">MATRIX1D_ARRAY</a>(<a class="code" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a>),</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                       <a class="code" href="group__Vectors.html#ga21ab5fd33dec74a72e18c6f724e60b50">MATRIX1D_ARRAY</a>(result),</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                       &amp;rnorm, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">if</span> (success == 1)</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;Warning, too many iterations in nnls\n&quot;</span>;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (success == 2)</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa8bc69704d15b663272adcad6be01b7f1">ERR_MEM_NOTENOUGH</a>, <span class="stringliteral">&quot;Solve_nonneg: Not enough memory&quot;</span>);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">return</span> rnorm;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;}</div><div class="ttc" id="classMatrix2D_html_adf509b54b7664e2e5e1e07cdf24b5a13"><div class="ttname"><a href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Matrix2D::Xdim</a></div><div class="ttdeci">size_t Xdim() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00575">matrix2d.h:575</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00211">xmipp_error.h:211</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a></div><div class="ttdoc">Problem with matrix size. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00152">xmipp_error.h:152</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa8bc69704d15b663272adcad6be01b7f1"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa8bc69704d15b663272adcad6be01b7f1">ERR_MEM_NOTENOUGH</a></div><div class="ttdoc">There is not enough memory for allocation. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00166">xmipp_error.h:166</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa668727aacc2dda12360b52026d980531"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa668727aacc2dda12360b52026d980531">ERR_MATRIX_EMPTY</a></div><div class="ttdoc">The matrix is empty. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00151">xmipp_error.h:151</a></div></div>
<div class="ttc" id="classMatrix2D_html_a8073200797ec6121b2ad960f6a41f52a"><div class="ttname"><a href="classMatrix2D.html#a8073200797ec6121b2ad960f6a41f52a">Matrix2D::transpose</a></div><div class="ttdeci">Matrix2D&lt; T &gt; transpose() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l01314">matrix2d.cpp:1314</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3939496af6ccffe20d083935ebd3225b"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a></div><div class="ttdeci">doublereal * d</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02230">numerical_recipes.cpp:2230</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aaf94b1751e7bb5a7a7623c06c85301473"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aaf94b1751e7bb5a7a7623c06c85301473">ERR_MATRIX_DIM</a></div><div class="ttdoc">Problem with matrix dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00150">xmipp_error.h:150</a></div></div>
<div class="ttc" id="classMatrix2D_html_a72dead316b8914e4cb4c9fd411962b55"><div class="ttname"><a href="classMatrix2D.html#a72dead316b8914e4cb4c9fd411962b55">Matrix2D::Ydim</a></div><div class="ttdeci">size_t Ydim() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00584">matrix2d.h:584</a></div></div>
<div class="ttc" id="classMatrix1D_html_a203e2128d65fd2d51dc764f5e7c52a63"><div class="ttname"><a href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">Matrix1D::initZeros</a></div><div class="ttdeci">void initZeros()</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00592">matrix1d.h:592</a></div></div>
<div class="ttc" id="group__Vectors_html_ga21ab5fd33dec74a72e18c6f724e60b50"><div class="ttname"><a href="group__Vectors.html#ga21ab5fd33dec74a72e18c6f724e60b50">MATRIX1D_ARRAY</a></div><div class="ttdeci">#define MATRIX1D_ARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00058">matrix1d.h:58</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a684f806de26391887ed4b583e39d4640"><div class="ttname"><a href="numerical__recipes_8cpp.html#a684f806de26391887ed4b583e39d4640">nnls</a></div><div class="ttdeci">int nnls(double *a, int m, int n, double *b, double *x, double *rnorm, double *wp, double *zzp, int *indexp)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l01165">numerical_recipes.cpp:1165</a></div></div>
<div class="ttc" id="group__Matrices_html_ga43360c8277a416cfcdd9cc0586317186"><div class="ttname"><a href="group__Matrices.html#ga43360c8277a416cfcdd9cc0586317186">MATRIX2D_ARRAY</a></div><div class="ttdeci">#define MATRIX2D_ARRAY(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00089">matrix2d.h:89</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga0d1aa3eef9aeec5d78cb2075b1f6c075"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0d1aa3eef9aeec5d78cb2075b1f6c075">&#9670;&nbsp;</a></span>solveViaCholesky()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void solveViaCholesky </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve equation system, symmetric positive-definite matrix</p>
<p>The equation system is defined by Ax=b, it is solved for x. This method can only be applied if A is positive-definite matrix and symmetric. It applies a Cholesky factorization and backsubstitution (see Numerical Recipes). </p>

<p class="definition">Definition at line <a class="el" href="numerical__tools_8cpp_source.html#l00111">111</a> of file <a class="el" href="numerical__tools_8cpp_source.html">numerical_tools.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;{</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> Ap = A;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> p(A.<a class="code" href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Xdim</a>());</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    result.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(A.<a class="code" href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Xdim</a>());</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a6fa26cdfa32e210d53bf09dd5b733f19">choldc</a>(Ap.<a class="code" href="classMatrix2D.html#a7a4430316785979559818126064fe5ee">adaptForNumericalRecipes2</a>(), A.<a class="code" href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Xdim</a>(),</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;           p.adaptForNumericalRecipes());</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a8164de654f2d051142e1ecd581e807ea">cholsl</a>(Ap.<a class="code" href="classMatrix2D.html#a7a4430316785979559818126064fe5ee">adaptForNumericalRecipes2</a>(), A.<a class="code" href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Xdim</a>(),</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;           p.adaptForNumericalRecipes(), b.<a class="code" href="classMatrix1D.html#a8c23809fbea1618891cbdafce3e1a78e">adaptForNumericalRecipes</a>(),</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;           result.<a class="code" href="classMatrix1D.html#a8c23809fbea1618891cbdafce3e1a78e">adaptForNumericalRecipes</a>());</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_a8164de654f2d051142e1ecd581e807ea"><div class="ttname"><a href="numerical__recipes_8cpp.html#a8164de654f2d051142e1ecd581e807ea">cholsl</a></div><div class="ttdeci">void cholsl(double *a, int n, double *p, double *b, double *x)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l09370">numerical_recipes.cpp:9370</a></div></div>
<div class="ttc" id="classMatrix2D_html_adf509b54b7664e2e5e1e07cdf24b5a13"><div class="ttname"><a href="classMatrix2D.html#adf509b54b7664e2e5e1e07cdf24b5a13">Matrix2D::Xdim</a></div><div class="ttdeci">size_t Xdim() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00575">matrix2d.h:575</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a6fa26cdfa32e210d53bf09dd5b733f19"><div class="ttname"><a href="numerical__recipes_8cpp.html#a6fa26cdfa32e210d53bf09dd5b733f19">choldc</a></div><div class="ttdeci">void choldc(double *a, int n, double *p)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l09347">numerical_recipes.cpp:9347</a></div></div>
<div class="ttc" id="classMatrix2D_html_a7a4430316785979559818126064fe5ee"><div class="ttname"><a href="classMatrix2D.html#a7a4430316785979559818126064fe5ee">Matrix2D::adaptForNumericalRecipes2</a></div><div class="ttdeci">T * adaptForNumericalRecipes2() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00875">matrix2d.h:875</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="classMatrix1D_html_a79a482948ae334cbefaef7c7839cd934"><div class="ttname"><a href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">Matrix1D::resize</a></div><div class="ttdeci">void resize(size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00410">matrix1d.h:410</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classMatrix1D_html_a8c23809fbea1618891cbdafce3e1a78e"><div class="ttname"><a href="classMatrix1D.html#a8c23809fbea1618891cbdafce3e1a78e">Matrix1D::adaptForNumericalRecipes</a></div><div class="ttdeci">T * adaptForNumericalRecipes() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00844">matrix1d.h:844</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
