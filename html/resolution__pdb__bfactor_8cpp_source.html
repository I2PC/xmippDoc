<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Xmipp: xmipp/libraries/reconstruction/resolution_pdb_bfactor.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5bce755d3f27cf36e7d1a940cfd4182d.html">xmipp</a></li><li class="navelem"><a class="el" href="dir_29dba3f3840f20df3b04d1972e99046b.html">libraries</a></li><li class="navelem"><a class="el" href="dir_28683db7d591bb6aab1650ae2c6e488e.html">reconstruction</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">resolution_pdb_bfactor.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="resolution__pdb__bfactor_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/***************************************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * Authors:    Jose Luis Vilas,         jlvilas@cnb.csic.es</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * Unidad de  Bioinformatica of Centro Nacional de Biotecnologia , CSIC</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * This program is free software; you can redistribute it and/or modify</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * it under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * the Free Software Foundation; either version 2 of the License, or</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * (at your option) any later version.</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * GNU General Public License for more details.</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * along with this program; if not, write to the Free Software</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * 02111-1307  USA</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> *  All comments concerning this program package may be sent to the</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> *  e-mail address &#39;xmipp@cnb.csic.es&#39;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> ***************************************************************************/</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="resolution__pdb__bfactor_8h.html">resolution_pdb_bfactor.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="xmipp__image_8h.html">core/xmipp_image.h</a>&gt;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="metadata__vec_8h.html">core/metadata_vec.h</a>&gt;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;iomanip&gt;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;numeric&gt;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keywordtype">void</span> ProgResBFactor::readParams()</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    fn_pdb = <a class="code" href="classXmippProgram.html#a5d9e1f008822effa47814c59e9a3c797">getParam</a>(<span class="stringliteral">&quot;--atmodel&quot;</span>);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    fn_locres = <a class="code" href="classXmippProgram.html#a5d9e1f008822effa47814c59e9a3c797">getParam</a>(<span class="stringliteral">&quot;--vol&quot;</span>);</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    sampling = <a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--sampling&quot;</span>);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    medianTrue = <a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--useMedian&quot;</span>);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    centered = <a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--centered&quot;</span>);</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    fscResolution = <a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--fscResolution&quot;</span>);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    fnOut = <a class="code" href="classXmippProgram.html#a5d9e1f008822effa47814c59e9a3c797">getParam</a>(<span class="stringliteral">&quot;-o&quot;</span>);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;}</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="keywordtype">void</span> ProgResBFactor::defineParams()</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="classXmippProgram.html#a4f396af57519ec443b4656176eb962bf">addUsageLine</a>(<span class="stringliteral">&quot;The local b-factor of an atomic model (from xray or cryoem) are compared with the local resolution of a cryoEM map. To do that, the atom positions are selected and the local resolution around that atom is taken to determine an estimation of the local resolution of the residue. Only alpha carbons are selected to carry out this task. Tha output is a metadata with the residues, local resolution estimation of the residue, and local bfactor&quot;</span>);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  --atmodel &lt;pdb_file=\&quot;\&quot;&gt;          : Atomic model (pdb). Ensure it is aligned/fitted to the local resolution map&quot;</span>);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  --vol &lt;vol_file=\&quot;\&quot;&gt;          : Local resolution map&quot;</span>);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--sampling &lt;sampling=1&gt;]      : Sampling Rate (A)&quot;</span>);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--useMedian]                  : The resolution an bfactor per residue are averaged instead of computed the median&quot;</span>);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--centered]                   : True if the atomic model centered in midle of the local resolution map&quot;</span>);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--fscResolution &lt;fscResolution=-1&gt;]   : If this is provided, the FSC resolution, R, in Angstrom is used to normalized the local resolution, LR, as (LR-R)/R, where LR is the local resoluion and R is the global resolution&quot;</span>);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  -o &lt;output=\&quot;amap.mrc\&quot;&gt;       : Output of the algorithm&quot;</span>);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;}</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;std::vector&lt;size_t&gt; ProgResBFactor::sort_indexes(<span class="keyword">const</span> std::vector&lt;T&gt; &amp;v)</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="comment">// initialize original index locations</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  std::vector&lt;size_t&gt; idx(v.size());</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  std::iota(idx.begin(), idx.end(), 0);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">// sort indexes based on comparing values in v</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">// using std::stable_sort instead of std::sort</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">// to avoid unnecessary index re-orderings</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">// when v contains elements of equal values</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  stable_sort(idx.begin(), idx.end(),</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;       [&amp;v](<span class="keywordtype">size_t</span> i1, <span class="keywordtype">size_t</span> i2) {<span class="keywordflow">return</span> v[i1] &lt; v[i2];});</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">return</span> idx;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="keywordtype">void</span> ProgResBFactor::sweepByResidue(std::vector&lt;double&gt; &amp;residuesToChimera_aux)</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;{</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// Reading Local Resolution Map</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="classImage.html">Image&lt;double&gt;</a> imgResVol;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    imgResVol.<a class="code" href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">read</a>(fn_locres);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> resvol;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    resvol = imgResVol();</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// The mask is initialized with the same dimentions of the local resolution map</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;int&gt;</a> mask;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    mask.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(resvol);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    mask.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">// Getting dimensions of th local resolution map to match atom position and local resolution information</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">size_t</span> xdim, ydim, zdim, ndim;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    resvol.<a class="code" href="classMultidimArrayBase.html#a0c69d9f18e9eae5d5439a121fa9ed8ce">getDimensions</a>(xdim, ydim, zdim, ndim);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">if</span> (zdim == 1)</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        zdim = ndim;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">//  idx_residue determines the positional index of the residue</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">//  Note that residues are stored in the vector at_pos.residue.</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">//  Then, the vector at_pos.residue is sorted from low to high</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">//  The new vector idx_residue, determine the position of each</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">//  residue in the original vector.</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">//  std::vector&lt;size_t&gt; idx_residue;</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">//  idx_residue = sort_indexes(at_pos.residue);</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// The resolution of each residue is stored in each component (as many as components as residues)</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    std::vector&lt;double&gt; resolution_per_residue(0);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// The contributing voxels to a single residue are stored</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    std::vector&lt;double&gt; resolution_to_estimate(0);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// the b-factor per residue</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    std::vector&lt;double&gt; bfactor_per_residue(0);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// number of residue list</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    std::vector&lt;double&gt; resNumberList(0);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">// vector to estimate the bfactor of each residue</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    std::vector&lt;double&gt; bfactor_to_estimate(0);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">// vectors to estimate the moving average</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    std::vector&lt;double&gt; ma_l(0);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    std::vector&lt;double&gt; ma_c(0);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// Setting the first residue before the loop that sweeps all residues. r</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// The b-factor and resolution mean per residue, as well as number of voxels contributing to the mean</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordtype">double</span> bfactor_mean = 0;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordtype">double</span> resolution_mean = 0;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordtype">int</span> N_elems = 0;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">// Selecting the residue</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordtype">int</span> resi;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> r=0; r&lt;numberOfAtoms; ++r)</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="comment">// Selecting the residue</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        resi = at_pos.<a class="code" href="structpdbInfo.html#abbfbebc3e4f2209b7ad2a74f1e9bc3be">residue</a>[r];</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="comment">// Storing Residue and bfactor</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        resNumberList.push_back(resi);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordtype">double</span> bfactorRad = at_pos.<a class="code" href="structpdbInfo.html#a9e76d5f665ba16030e776b8f36693f99">b</a>[r];</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        bfactor_per_residue.push_back(bfactorRad);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">if</span> (centered)</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="comment">// Getting the atom position</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            k = <a class="code" href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">round</a>(at_pos.<a class="code" href="structpdbInfo.html#a90a3ddb0a9efc00f1e65e79a9c8ad701">z</a>[r]/sampling) + <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(zdim/2);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            i = <a class="code" href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">round</a>(at_pos.<a class="code" href="structpdbInfo.html#afe5c4b461b6c6ab9f017937ae63768c1">y</a>[r]/sampling) + <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(ydim/2);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            j = <a class="code" href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">round</a>(at_pos.<a class="code" href="structpdbInfo.html#a5d153503d4b2b15b46926c6eeff7edce">x</a>[r]/sampling) + <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(xdim/2);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <span class="comment">// Getting the atom position</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            k = <a class="code" href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">round</a>(at_pos.<a class="code" href="structpdbInfo.html#a90a3ddb0a9efc00f1e65e79a9c8ad701">z</a>[r]/sampling);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            i = <a class="code" href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">round</a>(at_pos.<a class="code" href="structpdbInfo.html#afe5c4b461b6c6ab9f017937ae63768c1">y</a>[r]/sampling);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            j = <a class="code" href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">round</a>(at_pos.<a class="code" href="structpdbInfo.html#a5d153503d4b2b15b46926c6eeff7edce">x</a>[r]/sampling);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        }</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="comment">// Total Displacement in voxels</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordtype">int</span> totRad = 3; <span class="comment">//round( (covRad + bfactorRad)/sampling );</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="comment">// All resolutions around the atom position are stored in a vector to estimate</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="comment">// the local resolution of the residueresolution_to_estimateresolution_to_estimate</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        estimatingResolutionOfResidue(k, i, j, totRad, mask, resvol, resolution_mean, N_elems, resolution_to_estimate);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="comment">// The resolution of the residue is stored</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keywordtype">double</span> res_resi = resolution_mean/N_elems;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        resolution_per_residue.push_back(res_resi);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="comment">// If the fsc is provided, then, the local resolution is normalized</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">if</span> (fscResolution&gt;0)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        {</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            res_resi /= fscResolution;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        }</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="comment">// 0.3 and 0.4 are weigths to smooth the output</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        ma_l.push_back(res_resi*0.3);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        ma_c.push_back(res_resi*0.4);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="comment">// The means are reseted</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        bfactor_mean = 0;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        resolution_mean = 0;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        N_elems = 0;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">// Smoothing the output</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    std::vector&lt;double&gt; smoothedResolution(ma_c.size());</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    smoothedResolution[0]=(ma_c[0]+ma_l[1])/(0.3+0.4); <span class="comment">//0.3 left weight,, 0.4 central weight</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=1; i&lt;(ma_c.size()-1); ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        smoothedResolution[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = ma_l[i-1] + ma_c[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] + ma_l[i+1];</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    smoothedResolution[ma_c.size()-1] = (ma_c[ma_c.size()-1]+ma_l[ma_c.size()-2])/(0.3+0.4);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">// Creation of the output metadata with the local resolution per residue</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="classMetaDataVec.html">MetaDataVec</a> mdSmooth;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="classMetaDataVec.html">MetaDataVec</a> md;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="classMDRowVec.html">MDRowVec</a> row;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#a03cb6822d714181506765a7df4f70ee7">nn</a> = 0; <a class="code" href="numerical__recipes_8cpp.html#a03cb6822d714181506765a7df4f70ee7">nn</a>&lt;resolution_per_residue.size(); ++<a class="code" href="numerical__recipes_8cpp.html#a03cb6822d714181506765a7df4f70ee7">nn</a>)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordtype">double</span> bf, lr;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordtype">int</span> resnumber;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        lr = resolution_per_residue[<a class="code" href="numerical__recipes_8cpp.html#a03cb6822d714181506765a7df4f70ee7">nn</a>];</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        bf = bfactor_per_residue[<a class="code" href="numerical__recipes_8cpp.html#a03cb6822d714181506765a7df4f70ee7">nn</a>];</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        resnumber = resNumberList[<a class="code" href="numerical__recipes_8cpp.html#a03cb6822d714181506765a7df4f70ee7">nn</a>];</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        lr = smoothedResolution[<a class="code" href="numerical__recipes_8cpp.html#a03cb6822d714181506765a7df4f70ee7">nn</a>];</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        row.<a class="code" href="classMDRowVec.html#a5dd9a07d07c588ac728c9e59f5de6580">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a5820750be069fbf7fe7c52fff67469be">MDL_BFACTOR</a>, bf);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        row.<a class="code" href="classMDRowVec.html#a5dd9a07d07c588ac728c9e59f5de6580">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac7eb32095d544acae9ea827282e67f58">MDL_RESIDUE</a>, resnumber);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        row.<a class="code" href="classMDRowVec.html#a5dd9a07d07c588ac728c9e59f5de6580">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a130f2936d66461c62e5c078e4d8aacfc">MDL_RESOLUTION_LOCAL_RESIDUE</a>, lr);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        md.<a class="code" href="classMetaDataVec.html#a1f014b29916c01771c8cff5c1c73ba5f">addRow</a>(row);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    residuesToChimera_aux = smoothedResolution;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="classFileName.html">FileName</a> fn;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    fn = fnOut + <span class="stringliteral">&quot;/bfactor_resolution.xmd&quot;</span>;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    md.<a class="code" href="classMetaDataVec.html#a3a6682d1ec1779f477bef54492e20544">write</a>(fn);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="classImage.html">Image&lt;int&gt;</a> imMask;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    imMask() = mask;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    fn = fnOut + <span class="stringliteral">&quot;/mask.mrc&quot;</span>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    imMask.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(fn);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;}</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="keywordtype">void</span> ProgResBFactor::estimatingResolutionOfResidue(<span class="keywordtype">int</span> k, <span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> totRad, <a class="code" href="classMultidimArray.html">MultidimArray&lt;int&gt;</a> &amp;mask, <span class="keyword">const</span> <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;resvol, <span class="keywordtype">double</span> &amp;resolution_mean, <span class="keywordtype">int</span> &amp;N_elems, std::vector&lt;double&gt; &amp;resolution_to_estimate)</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;{</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordtype">int</span> dim = totRad*totRad;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> kk = 0; kk&lt;totRad; ++kk)</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordtype">size_t</span> kk2 = kk * kk;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> jj = 0; jj&lt;totRad; ++jj)</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordtype">size_t</span> jj2kk2 = jj * jj + kk2;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ii = 0; ii&lt;totRad; ++ii)</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <span class="keywordtype">size_t</span> dist2 = ii*ii + jj*jj + kk*kk;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="keywordflow">if</span> (dist2 &lt;= dim)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, k-kk, i-ii, j-jj) = 1;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, k-kk, i-ii, j+jj) = 1;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, k-kk, i+ii, j-jj) = 1;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, k-kk, i+ii, j+jj) = 1;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, k+kk, i-ii, j-jj) = 1;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, k+kk, i-ii, j+jj) = 1;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, k+kk, i+ii, j-jj) = 1;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, k+kk, i+ii, j+jj) = 1;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                <span class="keywordtype">double</span> &amp;z1 = <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(resvol, k-kk, i-ii, j-jj);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                resolution_to_estimate.push_back(z1);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                resolution_mean += z1;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                N_elems++;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                <span class="keywordtype">double</span> &amp;z2 = <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(resvol, k-kk, i-ii, j+jj);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                resolution_to_estimate.push_back(z2);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                resolution_mean += z2;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                N_elems++;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                <span class="keywordtype">double</span> &amp;z3 = <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(resvol, k-kk, i+ii, j-jj);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                resolution_to_estimate.push_back(z3);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                resolution_mean += z3;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                N_elems++;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                <span class="keywordtype">double</span> &amp;z4 = <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(resvol, k-kk, i+ii, j+jj);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                resolution_to_estimate.push_back(z4);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                resolution_mean += z4;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                N_elems++;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                <span class="keywordtype">double</span> &amp;z5 = <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(resvol, k+kk, i-ii, j-jj);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                resolution_to_estimate.push_back(z5);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                resolution_mean += z5;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                <span class="keywordtype">double</span> &amp;z6 = <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(resvol, k+kk, i-ii, j+jj);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                resolution_to_estimate.push_back(z6);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                resolution_mean += z6;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                N_elems++;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                <span class="keywordtype">double</span> &amp;z7 = <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(resvol, k+kk, i+ii, j-jj);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                resolution_to_estimate.push_back(z7);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                resolution_mean += z7;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                N_elems++;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                <span class="keywordtype">double</span> &amp;z8 = <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(resvol, k+kk, i+ii, j+jj);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                resolution_to_estimate.push_back(z8);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                resolution_mean += z8;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                N_elems++;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;}</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="keywordtype">void</span> ProgResBFactor::generateOutputPDB(<span class="keyword">const</span> std::vector&lt;double&gt; &amp;residuesToChimera)</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;{</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">//Open the pdb file</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    std::ifstream f2parse;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    f2parse.open(fn_pdb.c_str());</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    std::ofstream pdbToChimera;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    pdbToChimera.open(fnOut+<span class="stringliteral">&quot;/chimeraPDB.pdb&quot;</span>);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordtype">int</span> last_resi = 0;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">while</span> (!f2parse.eof())</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        std::string line;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        getline(f2parse, line);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">//      // The type of record (line) is defined in the first 6 characters of the pdb</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        std::string typeOfline = line.substr(0,4);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">if</span> ( (typeOfline == <span class="stringliteral">&quot;ATOM&quot;</span>) || (typeOfline == <span class="stringliteral">&quot;HETA&quot;</span>))</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        {</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            std::string lineInit = line.substr(0,61);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            std::string lineEnd = line.substr(66,  std::string::npos);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                        <span class="comment">// The residue is read</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="keyword">auto</span> resi = (int) <a class="code" href="group__StringUtilities.html#ga9767346b2233af75e82a79632c3530da">textToFloat</a>(line.substr(23,5));</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            std::string lineMiddle;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <span class="keywordtype">int</span> digitNumber = 5;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            </div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            std::string auxstr = std::to_string(residuesToChimera[resi-1]);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <span class="comment">// The bfactor column has 5 digits so we set the normalized resolution to </span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="comment">// 5 digits</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            auxstr = auxstr.substr(0, 5);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                        std::stringstream ss;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            ss &lt;&lt; std::setfill(<span class="charliteral">&#39;0&#39;</span>) &lt;&lt; std::setw(5) &lt;&lt; residuesToChimera[resi-1];</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                        lineMiddle = ss.str();</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            std::string linePDB;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            linePDB = lineInit + lineMiddle + lineEnd;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            pdbToChimera &lt;&lt; linePDB &lt;&lt; std::endl;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            pdbToChimera &lt;&lt; line &lt;&lt; std::endl;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        }</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    }</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    pdbToChimera.close();</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;}</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="keywordtype">void</span> ProgResBFactor::run()</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;{</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Start&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">// Reading the atomic model and getting the atom positions</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    std::string typeOfAtom = <span class="stringliteral">&quot;CA&quot;</span>;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    numberOfAtoms = 0;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <a class="code" href="group__PDBinterface.html#ga1d78a55abdbc481c2bf89f16ce38a955">analyzePDBAtoms</a>(fn_pdb, typeOfAtom, numberOfAtoms, at_pos);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    std::cout &lt;&lt; numberOfAtoms &lt;&lt; std::endl;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">// Estimating the local resolution per residue</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    std::vector&lt;double&gt; residuesToChimera;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    sweepByResidue(residuesToChimera);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    </div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">// Output generation: a new atomic model is generated by substituting the bfactor column by</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">// the local resolution of the residue. Also a smoothing is carried out</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    generateOutputPDB(residuesToChimera);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Finished&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_a03cb6822d714181506765a7df4f70ee7"><div class="ttname"><a href="numerical__recipes_8cpp.html#a03cb6822d714181506765a7df4f70ee7">nn</a></div><div class="ttdeci">nn</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04717">numerical_recipes.cpp:4717</a></div></div>
<div class="ttc" id="classXmippProgram_html_a552e1ea4a84576d9149b965d9edb6277"><div class="ttname"><a href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">XmippProgram::getDoubleParam</a></div><div class="ttdeci">double getDoubleParam(const char *param, int arg=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00341">xmipp_program.cpp:341</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a130f2936d66461c62e5c078e4d8aacfc"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a130f2936d66461c62e5c078e4d8aacfc">MDL_RESOLUTION_LOCAL_RESIDUE</a></div><div class="ttdoc">Frequency in A of the local resolution of a residue (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00389">metadata_label.h:389</a></div></div>
<div class="ttc" id="cuda__basic__math_8h_html_a2065eb145275f878c1d045c9f3fb1cc7"><div class="ttname"><a href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a></div><div class="ttdeci">__host__ __device__ float2 floor(const float2 v)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__basic__math_8h_source.html#l00175">cuda_basic_math.h:175</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac7eb32095d544acae9ea827282e67f58"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac7eb32095d544acae9ea827282e67f58">MDL_RESIDUE</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00379">metadata_label.h:379</a></div></div>
<div class="ttc" id="structpdbInfo_html_a90a3ddb0a9efc00f1e65e79a9c8ad701"><div class="ttname"><a href="structpdbInfo.html#a90a3ddb0a9efc00f1e65e79a9c8ad701">pdbInfo::z</a></div><div class="ttdeci">std::vector&lt; double &gt; z</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00094">pdb.h:94</a></div></div>
<div class="ttc" id="classMultidimArray_html_ac0efebfb32ab4e37cf33efca3349aa9b"><div class="ttname"><a href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">MultidimArray::resizeNoCopy</a></div><div class="ttdeci">void resizeNoCopy(const MultidimArray&lt; T1 &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00470">multidim_array.h:470</a></div></div>
<div class="ttc" id="metadata__vec_8h_html"><div class="ttname"><a href="metadata__vec_8h.html">metadata_vec.h</a></div></div>
<div class="ttc" id="classMDRowVec_html_a5dd9a07d07c588ac728c9e59f5de6580"><div class="ttname"><a href="classMDRowVec.html#a5dd9a07d07c588ac728c9e59f5de6580">MDRowVec::setValue</a></div><div class="ttdeci">void setValue(const MDObject &amp;object) override</div><div class="ttdef"><b>Definition:</b> <a href="metadata__row__vec_8cpp_source.html#l00199">metadata_row_vec.cpp:199</a></div></div>
<div class="ttc" id="classImageBase_html_ae81a8c11a832924c2bda0909882c3168"><div class="ttname"><a href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">ImageBase::write</a></div><div class="ttdeci">void write(const FileName &amp;name=&quot;&quot;, size_t select_img=ALL_IMAGES, bool isStack=false, int mode=WRITE_OVERWRITE, CastWriteMode castMode=CW_CAST, int _swapWrite=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00292">xmipp_image_base.cpp:292</a></div></div>
<div class="ttc" id="classMetaDataVec_html_a3a6682d1ec1779f477bef54492e20544"><div class="ttname"><a href="classMetaDataVec.html#a3a6682d1ec1779f477bef54492e20544">MetaDataVec::write</a></div><div class="ttdeci">void write(const FileName &amp;outFile, WriteModeMetaData mode=MD_OVERWRITE) const</div><div class="ttdef"><b>Definition:</b> <a href="metadata__vec_8cpp_source.html#l00140">metadata_vec.cpp:140</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00065">xmipp_filename.h:65</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classMetaDataVec_html_a1f014b29916c01771c8cff5c1c73ba5f"><div class="ttname"><a href="classMetaDataVec.html#a1f014b29916c01771c8cff5c1c73ba5f">MetaDataVec::addRow</a></div><div class="ttdeci">size_t addRow(const MDRow &amp;row) override</div><div class="ttdef"><b>Definition:</b> <a href="metadata__vec_8cpp_source.html#l00225">metadata_vec.cpp:225</a></div></div>
<div class="ttc" id="classMetaDataVec_html"><div class="ttname"><a href="classMetaDataVec.html">MetaDataVec</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata__vec_8h_source.html#l00046">metadata_vec.h:46</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="xmipp__image_8h_html"><div class="ttname"><a href="xmipp__image_8h.html">xmipp_image.h</a></div></div>
<div class="ttc" id="classMDRowVec_html"><div class="ttname"><a href="classMDRowVec.html">MDRowVec</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata__row__vec_8h_source.html#l00044">metadata_row_vec.h:44</a></div></div>
<div class="ttc" id="classXmippProgram_html_a5d9e1f008822effa47814c59e9a3c797"><div class="ttname"><a href="classXmippProgram.html#a5d9e1f008822effa47814c59e9a3c797">XmippProgram::getParam</a></div><div class="ttdeci">const char * getParam(const char *param, int arg=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00321">xmipp_program.cpp:321</a></div></div>
<div class="ttc" id="structpdbInfo_html_a5d153503d4b2b15b46926c6eeff7edce"><div class="ttname"><a href="structpdbInfo.html#a5d153503d4b2b15b46926c6eeff7edce">pdbInfo::x</a></div><div class="ttdeci">std::vector&lt; double &gt; x</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00092">pdb.h:92</a></div></div>
<div class="ttc" id="group__StringUtilities_html_ga9767346b2233af75e82a79632c3530da"><div class="ttname"><a href="group__StringUtilities.html#ga9767346b2233af75e82a79632c3530da">textToFloat</a></div><div class="ttdeci">float textToFloat(const char *str)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__strings_8cpp_source.html#l00124">xmipp_strings.cpp:124</a></div></div>
<div class="ttc" id="structpdbInfo_html_a9e76d5f665ba16030e776b8f36693f99"><div class="ttname"><a href="structpdbInfo.html#a9e76d5f665ba16030e776b8f36693f99">pdbInfo::b</a></div><div class="ttdeci">std::vector&lt; double &gt; b</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00095">pdb.h:95</a></div></div>
<div class="ttc" id="structpdbInfo_html_afe5c4b461b6c6ab9f017937ae63768c1"><div class="ttname"><a href="structpdbInfo.html#afe5c4b461b6c6ab9f017937ae63768c1">pdbInfo::y</a></div><div class="ttdeci">std::vector&lt; double &gt; y</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00093">pdb.h:93</a></div></div>
<div class="ttc" id="structpdbInfo_html_abbfbebc3e4f2209b7ad2a74f1e9bc3be"><div class="ttname"><a href="structpdbInfo.html#abbfbebc3e4f2209b7ad2a74f1e9bc3be">pdbInfo::residue</a></div><div class="ttdeci">std::vector&lt; int &gt; residue</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00097">pdb.h:97</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="namespacealglib_html_a43452b10ffe26174e5d328a6ceb5fa9a"><div class="ttname"><a href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">alglib::round</a></div><div class="ttdeci">int round(double x)</div><div class="ttdef"><b>Definition:</b> <a href="ap_8cpp_source.html#l07245">ap.cpp:7245</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="group__PDBinterface_html_ga1d78a55abdbc481c2bf89f16ce38a955"><div class="ttname"><a href="group__PDBinterface.html#ga1d78a55abdbc481c2bf89f16ce38a955">analyzePDBAtoms</a></div><div class="ttdeci">void analyzePDBAtoms(const FileName &amp;fn_pdb, const std::string &amp;typeOfAtom, int &amp;numberOfAtoms, pdbInfo &amp;at_pos)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00059">pdb.cpp:59</a></div></div>
<div class="ttc" id="classXmippProgram_html_a1a27c450de95c55d122be23e3fe89ac1"><div class="ttname"><a href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">XmippProgram::checkParam</a></div><div class="ttdeci">bool checkParam(const char *param)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00379">xmipp_program.cpp:379</a></div></div>
<div class="ttc" id="classImageBase_html_a88636b7a7bd4e0e454877e691ee2da84"><div class="ttname"><a href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">ImageBase::read</a></div><div class="ttdeci">int read(const FileName &amp;name, DataMode datamode=DATA, size_t select_img=ALL_IMAGES, bool mapData=false, int mode=WRITE_READONLY)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00119">xmipp_image_base.cpp:119</a></div></div>
<div class="ttc" id="classXmippProgram_html_a4f396af57519ec443b4656176eb962bf"><div class="ttname"><a href="classXmippProgram.html#a4f396af57519ec443b4656176eb962bf">XmippProgram::addUsageLine</a></div><div class="ttdeci">void addUsageLine(const char *line, bool verbatim=false)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00282">xmipp_program.cpp:282</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02689">multidim_array.h:2689</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a5820750be069fbf7fe7c52fff67469be"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a5820750be069fbf7fe7c52fff67469be">MDL_BFACTOR</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00075">metadata_label.h:75</a></div></div>
<div class="ttc" id="classXmippProgram_html_aaeb37f0bac83f5d2a605aaa0e5c4b6ef"><div class="ttname"><a href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">XmippProgram::addParamsLine</a></div><div class="ttdeci">void addParamsLine(const String &amp;line)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00305">xmipp_program.cpp:305</a></div></div>
<div class="ttc" id="resolution__pdb__bfactor_8h_html"><div class="ttname"><a href="resolution__pdb__bfactor_8h.html">resolution_pdb_bfactor.h</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0c69d9f18e9eae5d5439a121fa9ed8ce"><div class="ttname"><a href="classMultidimArrayBase.html#a0c69d9f18e9eae5d5439a121fa9ed8ce">MultidimArrayBase::getDimensions</a></div><div class="ttdeci">void getDimensions(size_t &amp;Xdim, size_t &amp;Ydim, size_t &amp;Zdim, size_t &amp;Ndim) const</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8cpp_source.html#l00114">multidim_array_base.cpp:114</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
