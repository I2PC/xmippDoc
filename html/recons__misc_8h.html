<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Xmipp: xmipp/libraries/reconstruction/recons_misc.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5bce755d3f27cf36e7d1a940cfd4182d.html">xmipp</a></li><li class="navelem"><a class="el" href="dir_29dba3f3840f20df3b04d1972e99046b.html">libraries</a></li><li class="navelem"><a class="el" href="dir_28683db7d591bb6aab1650ae2c6e488e.html">reconstruction</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">recons_misc.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="grids_8h_source.html">data/grids.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="multidim__array_8h_source.html">core/multidim_array.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for recons_misc.h:</div>
<div class="dyncontent">
<div class="center"><img src="recons__misc_8h__incl.png" border="0" usemap="#xmipp_2libraries_2reconstruction_2recons__misc_8h" alt=""/></div>
<map name="xmipp_2libraries_2reconstruction_2recons__misc_8h" id="xmipp_2libraries_2reconstruction_2recons__misc_8h">
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="recons__misc_8h__dep__incl.png" border="0" usemap="#xmipp_2libraries_2reconstruction_2recons__misc_8hdep" alt=""/></div>
<map name="xmipp_2libraries_2reconstruction_2recons__misc_8hdep" id="xmipp_2libraries_2reconstruction_2recons__misc_8hdep">
</map>
</div>
</div>
<p><a href="recons__misc_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVariabilityClass.html">VariabilityClass</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html">POCSClass</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ade4dea90e384060df30e99291429e99b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recons__misc_8h.html#ade4dea90e384060df30e99291429e99b">buildReconsInfo</a> (<a class="el" href="classMetaDataVec.html">MetaDataVec</a> &amp;selfile, const <a class="el" href="classFileName.html">FileName</a> &amp;fn_ctf, const <a class="el" href="classSymList.html">SymList</a> &amp;SL, <a class="el" href="structReconsInfo.html">ReconsInfo</a> *&amp;IMG_Inf, bool do_not_use_symproj)</td></tr>
<tr class="separator:ade4dea90e384060df30e99291429e99b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a924024746d15317f1153f4094b1ca1a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recons__misc_8h.html#a924024746d15317f1153f4094b1ca1a4">sortPerpendicular</a> (int numIMG, <a class="el" href="structReconsInfo.html">ReconsInfo</a> *IMG_Inf, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;ordered_list, int N=2)</td></tr>
<tr class="separator:a924024746d15317f1153f4094b1ca1a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a672c3d7e34084ee7d17b8cee8656a415"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recons__misc_8h.html#a672c3d7e34084ee7d17b8cee8656a415">noSort</a> (int numIMG, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;ordered_list)</td></tr>
<tr class="separator:a672c3d7e34084ee7d17b8cee8656a415"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4c7ebf4561f83df0f69739a32e43f1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recons__misc_8h.html#ac4c7ebf4561f83df0f69739a32e43f1e">sortRandomly</a> (int numIMG, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;ordered_list)</td></tr>
<tr class="separator:ac4c7ebf4561f83df0f69739a32e43f1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdd5ef5de3a9b35d6c6db338bf6352b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recons__misc_8h.html#acdd5ef5de3a9b35d6c6db338bf6352b3">updateResidualVector</a> (<a class="el" href="classBasicARTParameters.html">BasicARTParameters</a> &amp;<a class="el" href="mpi__classify__CL2D_8cpp.html#a831c08adbb8230fd6a60f4a130923a19">prm</a>, <a class="el" href="group__Grids.html#gae3eeb15b316a9800a7c35372dfd57460">GridVolume</a> &amp;vol_basis, double &amp;kappa, double &amp;pow_residual_vol, double &amp;pow_residual_imgs)</td></tr>
<tr class="separator:acdd5ef5de3a9b35d6c6db338bf6352b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ade4dea90e384060df30e99291429e99b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade4dea90e384060df30e99291429e99b">&#9670;&nbsp;</a></span>buildReconsInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void buildReconsInfo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMetaDataVec.html">MetaDataVec</a> &amp;&#160;</td>
          <td class="paramname"><em>selfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classFileName.html">FileName</a> &amp;&#160;</td>
          <td class="paramname"><em>fn_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classSymList.html">SymList</a> &amp;&#160;</td>
          <td class="paramname"><em>SL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structReconsInfo.html">ReconsInfo</a> *&amp;&#160;</td>
          <td class="paramname"><em>IMG_Inf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>do_not_use_symproj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Build from a Selection File and a Symmetry List. The result is stored in the Recons_info array which should point to NULL when it is not initialized. </p>

<p class="definition">Definition at line <a class="el" href="recons__misc_8cpp_source.html#l00037">37</a> of file <a class="el" href="recons__misc_8cpp_source.html">recons_misc.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a>  L(4, 4), R(4, 4);  <span class="comment">// A matrix from the list</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="classFileName.html">FileName</a>          fn_proj;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="classFileName.html">FileName</a>          fn_ctf1;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="classProjection.html">Projection</a>        read_proj;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordtype">bool</span>              is_there_ctf = <span class="keyword">false</span>;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordtype">bool</span>              is_ctf_unique = <span class="keyword">false</span>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">int</span> trueIMG = selfile.<a class="code" href="classMetaDataVec.html#a6dadeeb468ea65886b16518818b84111">size</a>();</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    selfile.<a class="code" href="classMetaDataVec.html#ad70a6a77277a70925eb9738afeec18d9">firstRowId</a>();</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordtype">int</span> numIMG;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">if</span> (!do_not_use_symproj)</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        numIMG = trueIMG * (SL.<a class="code" href="classSymList.html#ae5383593df3125fefc6ae883474fb0e7">symsNo</a>() + 1);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        numIMG = trueIMG;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">// The next two ifs check whether there is a CTF file, and</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">// whether it is unique</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">if</span> (fn_ctf != <span class="stringliteral">&quot;&quot;</span>)</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        is_there_ctf = <span class="keyword">true</span>;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        is_ctf_unique = <span class="keyword">true</span>;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (selfile.<a class="code" href="classMetaDataVec.html#a8aaa63269cf2564662ae806609493315">containsLabel</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a9ce32c5e52f4dbcabe97204650daea27">MDL_CTF_MODEL</a>))</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    {</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        is_there_ctf = <span class="keyword">true</span>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        is_ctf_unique = <span class="keyword">false</span>;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    }</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">if</span> (IMG_Inf != <span class="keyword">nullptr</span>)</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keyword">delete</span> [] IMG_Inf;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">if</span> ((IMG_Inf = <span class="keyword">new</span> <a class="code" href="structReconsInfo.html">ReconsInfo</a>[numIMG]) == <span class="keyword">nullptr</span>)</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa8bc69704d15b663272adcad6be01b7f1">ERR_MEM_NOTENOUGH</a>, <span class="stringliteral">&quot;Build_Recons_Info: No memory for the sorting&quot;</span>);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <span class="comment">// It will account for the number of valid projections processed</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Reading angle information ...\n&quot;</span>;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="group__GeneralFunctions.html#ga8c220fe710ecdb4f9b1696dd53e20ff3">init_progress_bar</a>(trueIMG);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> objId : selfile.<a class="code" href="classMetaData.html#aef20bffda56f171ad4e8817004451a95">ids</a>())</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <a class="code" href="structReconsInfo.html">ReconsInfo</a> &amp;imgInfo = IMG_Inf[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        selfile.<a class="code" href="classMetaDataVec.html#a71728ad7664da6eba90ec1dbc787d434">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a>,fn_proj,objId);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordflow">if</span> (is_there_ctf &amp;&amp; !is_ctf_unique)</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            selfile.<a class="code" href="classMetaDataVec.html#a71728ad7664da6eba90ec1dbc787d434">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a9ce32c5e52f4dbcabe97204650daea27">MDL_CTF_MODEL</a>,fn_ctf1,objId);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordflow">if</span> (fn_proj != <span class="stringliteral">&quot;&quot;</span>)</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <span class="comment">//            read_proj.read(fn_proj, false, HEADER);</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <span class="comment">// Filling structure</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            imgInfo.<a class="code" href="structReconsInfo.html#abbc653add64864603e019653b39c2ac5">fn_proj</a> = fn_proj;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            imgInfo.<a class="code" href="structReconsInfo.html#ad9d05e22071534631a3c396a14beee52">row</a> = selfile.<a class="code" href="classMetaDataVec.html#a093e61c27cd8b1c23071593b8b71598d">getRowVec</a>(objId);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            imgInfo.<a class="code" href="structReconsInfo.html#ad9d05e22071534631a3c396a14beee52">row</a>.<a class="code" href="classMDRowVec.html#ac0f2f7354f1179fde3c050852b7f792e">detach</a>();</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keywordflow">if</span> (is_ctf_unique)</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                imgInfo.<a class="code" href="structReconsInfo.html#ae3ff6a4deba363fb6d2ee75cc09bb4f5">fn_ctf</a> = fn_ctf;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_there_ctf)</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                imgInfo.<a class="code" href="structReconsInfo.html#ae3ff6a4deba363fb6d2ee75cc09bb4f5">fn_ctf</a> = fn_ctf1;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            imgInfo.<a class="code" href="structReconsInfo.html#a51bce2fd189ce3d68b7eb6252f47dae5">sym</a>     = -1;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            imgInfo.<a class="code" href="structReconsInfo.html#ac8ec4120cffab0d404aa427b2e0f8b3e">seed</a>    = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(65535 * <a class="code" href="group__GeneralFunctions.html#ga882088c3e41f9fdd7c357e868c001ed5">rnd_unif</a>());</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            imgInfo.<a class="code" href="structReconsInfo.html#a34a99991679c9ceac0fe32fddb4c6cc5">rot</a> = imgInfo.<a class="code" href="structReconsInfo.html#ab9ffa606534ea24c0317f8eee4b7c9fb">tilt</a> = imgInfo.<a class="code" href="structReconsInfo.html#aea44811123efefce13b1addf6139a849">psi</a> = 0;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            selfile.<a class="code" href="classMetaDataVec.html#a71728ad7664da6eba90ec1dbc787d434">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a59fffce298c0f99a1d592544d3d39a08">MDL_ANGLE_ROT</a>, imgInfo.<a class="code" href="structReconsInfo.html#a34a99991679c9ceac0fe32fddb4c6cc5">rot</a>,objId);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            selfile.<a class="code" href="classMetaDataVec.html#a71728ad7664da6eba90ec1dbc787d434">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac15f836e18a2035d2923ecf76c6e8c7f">MDL_ANGLE_TILT</a>, imgInfo.<a class="code" href="structReconsInfo.html#ab9ffa606534ea24c0317f8eee4b7c9fb">tilt</a>,objId);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            selfile.<a class="code" href="classMetaDataVec.html#a71728ad7664da6eba90ec1dbc787d434">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a114e3414dd216e4308946a016b5cc46f">MDL_ANGLE_PSI</a>, imgInfo.<a class="code" href="structReconsInfo.html#aea44811123efefce13b1addf6139a849">psi</a>,objId);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            <span class="comment">//            read_proj.getEulerAngles(imgInfo.rot, imgInfo.tilt, imgInfo.psi);</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <a class="code" href="group__Geometry.html#gac9a01090711842bea6f6fe759ca71ceb">EULER_CLIPPING</a>(imgInfo.<a class="code" href="structReconsInfo.html#a34a99991679c9ceac0fe32fddb4c6cc5">rot</a>, imgInfo.<a class="code" href="structReconsInfo.html#ab9ffa606534ea24c0317f8eee4b7c9fb">tilt</a>, imgInfo.<a class="code" href="structReconsInfo.html#aea44811123efefce13b1addf6139a849">psi</a>);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="comment">// Any symmetry?</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            <span class="keywordflow">if</span> (SL.<a class="code" href="classSymList.html#ae5383593df3125fefc6ae883474fb0e7">symsNo</a>() &gt; 0 &amp;&amp; !do_not_use_symproj)</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            {</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; SL.<a class="code" href="classSymList.html#ae5383593df3125fefc6ae883474fb0e7">symsNo</a>(); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                {</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                    <span class="keywordtype">int</span> sym_index = <a class="code" href="group__SymmetryLists.html#ga3bca97f78b08d9a4f7ea17a91bd715fa">SYMINDEX</a>(SL, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, i, trueIMG);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                    IMG_Inf[sym_index].<a class="code" href="structReconsInfo.html#abbc653add64864603e019653b39c2ac5">fn_proj</a> = imgInfo.<a class="code" href="structReconsInfo.html#abbc653add64864603e019653b39c2ac5">fn_proj</a>;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                    IMG_Inf[sym_index].<a class="code" href="structReconsInfo.html#ac8ec4120cffab0d404aa427b2e0f8b3e">seed</a>   = imgInfo.<a class="code" href="structReconsInfo.html#ac8ec4120cffab0d404aa427b2e0f8b3e">seed</a>;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                    <span class="keywordflow">if</span> (is_ctf_unique)</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                        IMG_Inf[sym_index].<a class="code" href="structReconsInfo.html#ae3ff6a4deba363fb6d2ee75cc09bb4f5">fn_ctf</a> = fn_ctf;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_there_ctf)</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                        IMG_Inf[sym_index].<a class="code" href="structReconsInfo.html#ae3ff6a4deba363fb6d2ee75cc09bb4f5">fn_ctf</a> = imgInfo.<a class="code" href="structReconsInfo.html#ae3ff6a4deba363fb6d2ee75cc09bb4f5">fn_ctf</a>;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                    IMG_Inf[sym_index].<a class="code" href="structReconsInfo.html#a51bce2fd189ce3d68b7eb6252f47dae5">sym</a> = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                    SL.<a class="code" href="classSymList.html#a057c8b931c195cde50767b01a2914463">getMatrices</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, L, R);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                    L.resize(3, 3); <span class="comment">// Erase last row and column</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                    R.resize(3, 3); <span class="comment">// as only the relative orientation</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                    <span class="comment">// is useful and not the translation</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                    <span class="keywordtype">double</span> drot, dtilt, dpsi;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                    <a class="code" href="group__Geometry.html#ga1a37da6506d421d52c9a102eb9732928">Euler_apply_transf</a>(L, R,</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                                       imgInfo.<a class="code" href="structReconsInfo.html#a34a99991679c9ceac0fe32fddb4c6cc5">rot</a>, imgInfo.<a class="code" href="structReconsInfo.html#ab9ffa606534ea24c0317f8eee4b7c9fb">tilt</a>, imgInfo.<a class="code" href="structReconsInfo.html#aea44811123efefce13b1addf6139a849">psi</a>,</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                       drot, dtilt, dpsi);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                    IMG_Inf[sym_index].<a class="code" href="structReconsInfo.html#a34a99991679c9ceac0fe32fddb4c6cc5">rot</a> = (float)drot;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                    IMG_Inf[sym_index].<a class="code" href="structReconsInfo.html#ab9ffa606534ea24c0317f8eee4b7c9fb">tilt</a> = (float)dtilt;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                    IMG_Inf[sym_index].<a class="code" href="structReconsInfo.html#aea44811123efefce13b1addf6139a849">psi</a> = (float)dpsi;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; <span class="comment">// I have processed one more image</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">if</span> (i % 25 == 0)</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <a class="code" href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a>(i);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a>(trueIMG);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;}</div><div class="ttc" id="group__GeneralFunctions_html_ga8c220fe710ecdb4f9b1696dd53e20ff3"><div class="ttname"><a href="group__GeneralFunctions.html#ga8c220fe710ecdb4f9b1696dd53e20ff3">init_progress_bar</a></div><div class="ttdeci">void init_progress_bar(long total)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00782">xmipp_funcs.cpp:782</a></div></div>
<div class="ttc" id="structReconsInfo_html_ad9d05e22071534631a3c396a14beee52"><div class="ttname"><a href="structReconsInfo.html#ad9d05e22071534631a3c396a14beee52">ReconsInfo::row</a></div><div class="ttdeci">MDRowVec row</div><div class="ttdoc">Header information of projection. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00063">basic_art.h:63</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a59fffce298c0f99a1d592544d3d39a08"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a59fffce298c0f99a1d592544d3d39a08">MDL_ANGLE_ROT</a></div><div class="ttdoc">Rotation angle of an image (double,degrees) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00055">metadata_label.h:55</a></div></div>
<div class="ttc" id="structReconsInfo_html_aea44811123efefce13b1addf6139a849"><div class="ttname"><a href="structReconsInfo.html#aea44811123efefce13b1addf6139a849">ReconsInfo::psi</a></div><div class="ttdeci">double psi</div><div class="ttdoc">Psi angle. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00071">basic_art.h:71</a></div></div>
<div class="ttc" id="classSymList_html_a057c8b931c195cde50767b01a2914463"><div class="ttname"><a href="classSymList.html#a057c8b931c195cde50767b01a2914463">SymList::getMatrices</a></div><div class="ttdeci">void getMatrices(int i, Matrix2D&lt; double &gt; &amp;L, Matrix2D&lt; double &gt; &amp;R, bool homogeneous=true) const</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2symmetries_8cpp_source.html#l00348">symmetries.cpp:348</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00211">xmipp_error.h:211</a></div></div>
<div class="ttc" id="structReconsInfo_html"><div class="ttname"><a href="structReconsInfo.html">ReconsInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00058">basic_art.h:58</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac15f836e18a2035d2923ecf76c6e8c7f"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac15f836e18a2035d2923ecf76c6e8c7f">MDL_ANGLE_TILT</a></div><div class="ttdoc">Tilting angle of an image (double,degrees) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00059">metadata_label.h:59</a></div></div>
<div class="ttc" id="structReconsInfo_html_a51bce2fd189ce3d68b7eb6252f47dae5"><div class="ttname"><a href="structReconsInfo.html#a51bce2fd189ce3d68b7eb6252f47dae5">ReconsInfo::sym</a></div><div class="ttdeci">int sym</div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00076">basic_art.h:76</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa8bc69704d15b663272adcad6be01b7f1"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa8bc69704d15b663272adcad6be01b7f1">ERR_MEM_NOTENOUGH</a></div><div class="ttdoc">There is not enough memory for allocation. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00166">xmipp_error.h:166</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a114e3414dd216e4308946a016b5cc46f"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a114e3414dd216e4308946a016b5cc46f">MDL_ANGLE_PSI</a></div><div class="ttdoc">Special label to be used when gathering MDs in MpiMetadataPrograms. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00051">metadata_label.h:51</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a9ce32c5e52f4dbcabe97204650daea27"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a9ce32c5e52f4dbcabe97204650daea27">MDL_CTF_MODEL</a></div><div class="ttdoc">Name for the CTF Model (std::string) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00129">metadata_label.h:129</a></div></div>
<div class="ttc" id="classSymList_html_ae5383593df3125fefc6ae883474fb0e7"><div class="ttname"><a href="classSymList.html#ae5383593df3125fefc6ae883474fb0e7">SymList::symsNo</a></div><div class="ttdeci">int symsNo() const</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2symmetries_8h_source.html#l00268">symmetries.h:268</a></div></div>
<div class="ttc" id="classMetaData_html_aef20bffda56f171ad4e8817004451a95"><div class="ttname"><a href="classMetaData.html#aef20bffda56f171ad4e8817004451a95">MetaData::ids</a></div><div class="ttdeci">virtual IdIteratorProxy&lt; false &gt; ids()</div><div class="ttdef"><b>Definition:</b> <a href="metadata__base_8h_source.html#l00754">metadata_base.h:754</a></div></div>
<div class="ttc" id="group__Geometry_html_ga1a37da6506d421d52c9a102eb9732928"><div class="ttname"><a href="group__Geometry.html#ga1a37da6506d421d52c9a102eb9732928">Euler_apply_transf</a></div><div class="ttdeci">void Euler_apply_transf(const Matrix2D&lt; double &gt; &amp;L, const Matrix2D&lt; double &gt; &amp;R, double rot, double tilt, double psi, double &amp;newrot, double &amp;newtilt, double &amp;newpsi)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l01038">geometry.cpp:1038</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00065">xmipp_filename.h:65</a></div></div>
<div class="ttc" id="classMetaDataVec_html_a6dadeeb468ea65886b16518818b84111"><div class="ttname"><a href="classMetaDataVec.html#a6dadeeb468ea65886b16518818b84111">MetaDataVec::size</a></div><div class="ttdeci">size_t size() const override</div><div class="ttdef"><b>Definition:</b> <a href="metadata__vec_8cpp_source.html#l00393">metadata_vec.cpp:393</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga882088c3e41f9fdd7c357e868c001ed5"><div class="ttname"><a href="group__GeneralFunctions.html#ga882088c3e41f9fdd7c357e868c001ed5">rnd_unif</a></div><div class="ttdeci">double rnd_unif()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00440">xmipp_funcs.cpp:440</a></div></div>
<div class="ttc" id="group__Geometry_html_gac9a01090711842bea6f6fe759ca71ceb"><div class="ttname"><a href="group__Geometry.html#gac9a01090711842bea6f6fe759ca71ceb">EULER_CLIPPING</a></div><div class="ttdeci">#define EULER_CLIPPING(rot, tilt, psi)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00471">geometry.h:471</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="structReconsInfo_html_ab9ffa606534ea24c0317f8eee4b7c9fb"><div class="ttname"><a href="structReconsInfo.html#ab9ffa606534ea24c0317f8eee4b7c9fb">ReconsInfo::tilt</a></div><div class="ttdeci">double tilt</div><div class="ttdoc">Tilting angle. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00069">basic_art.h:69</a></div></div>
<div class="ttc" id="classMetaDataVec_html_ad70a6a77277a70925eb9738afeec18d9"><div class="ttname"><a href="classMetaDataVec.html#ad70a6a77277a70925eb9738afeec18d9">MetaDataVec::firstRowId</a></div><div class="ttdeci">size_t firstRowId() const override</div><div class="ttdef"><b>Definition:</b> <a href="metadata__vec_8cpp_source.html#l00508">metadata_vec.cpp:508</a></div></div>
<div class="ttc" id="structReconsInfo_html_ac8ec4120cffab0d404aa427b2e0f8b3e"><div class="ttname"><a href="structReconsInfo.html#ac8ec4120cffab0d404aa427b2e0f8b3e">ReconsInfo::seed</a></div><div class="ttdeci">int seed</div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00081">basic_art.h:81</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga3bdba82f045e73fb216c6be539e6b129"><div class="ttname"><a href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a></div><div class="ttdeci">void progress_bar(long rlen)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00791">xmipp_funcs.cpp:791</a></div></div>
<div class="ttc" id="structReconsInfo_html_ae3ff6a4deba363fb6d2ee75cc09bb4f5"><div class="ttname"><a href="structReconsInfo.html#ae3ff6a4deba363fb6d2ee75cc09bb4f5">ReconsInfo::fn_ctf</a></div><div class="ttdeci">FileName fn_ctf</div><div class="ttdoc">CTF filename. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00065">basic_art.h:65</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="structReconsInfo_html_abbc653add64864603e019653b39c2ac5"><div class="ttname"><a href="structReconsInfo.html#abbc653add64864603e019653b39c2ac5">ReconsInfo::fn_proj</a></div><div class="ttdeci">FileName fn_proj</div><div class="ttdoc">Projection filename. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00061">basic_art.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="classProjection_html"><div class="ttname"><a href="classProjection.html">Projection</a></div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00056">fourier_projection.h:56</a></div></div>
<div class="ttc" id="classMetaDataVec_html_a71728ad7664da6eba90ec1dbc787d434"><div class="ttname"><a href="classMetaDataVec.html#a71728ad7664da6eba90ec1dbc787d434">MetaDataVec::getValue</a></div><div class="ttdeci">bool getValue(MDObject &amp;mdValueOut, size_t id) const override</div><div class="ttdef"><b>Definition:</b> <a href="metadata__vec_8cpp_source.html#l00293">metadata_vec.cpp:293</a></div></div>
<div class="ttc" id="structReconsInfo_html_a34a99991679c9ceac0fe32fddb4c6cc5"><div class="ttname"><a href="structReconsInfo.html#a34a99991679c9ceac0fe32fddb4c6cc5">ReconsInfo::rot</a></div><div class="ttdeci">double rot</div><div class="ttdoc">Rotational angle. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00067">basic_art.h:67</a></div></div>
<div class="ttc" id="classMetaDataVec_html_a093e61c27cd8b1c23071593b8b71598d"><div class="ttname"><a href="classMetaDataVec.html#a093e61c27cd8b1c23071593b8b71598d">MetaDataVec::getRowVec</a></div><div class="ttdeci">MDRowVec getRowVec(size_t id)</div><div class="ttdef"><b>Definition:</b> <a href="metadata__vec_8cpp_source.html#l00328">metadata_vec.cpp:328</a></div></div>
<div class="ttc" id="classMDRowVec_html_ac0f2f7354f1179fde3c050852b7f792e"><div class="ttname"><a href="classMDRowVec.html#ac0f2f7354f1179fde3c050852b7f792e">MDRowVec::detach</a></div><div class="ttdeci">void detach() override</div><div class="ttdef"><b>Definition:</b> <a href="metadata__row__vec_8cpp_source.html#l00077">metadata_row_vec.cpp:77</a></div></div>
<div class="ttc" id="classMetaDataVec_html_a8aaa63269cf2564662ae806609493315"><div class="ttname"><a href="classMetaDataVec.html#a8aaa63269cf2564662ae806609493315">MetaDataVec::containsLabel</a></div><div class="ttdeci">bool containsLabel(const MDLabel label) const override</div><div class="ttdef"><b>Definition:</b> <a href="metadata__vec_8cpp_source.html#l00397">metadata_vec.cpp:397</a></div></div>
<div class="ttc" id="group__SymmetryLists_html_ga3bca97f78b08d9a4f7ea17a91bd715fa"><div class="ttname"><a href="group__SymmetryLists.html#ga3bca97f78b08d9a4f7ea17a91bd715fa">SYMINDEX</a></div><div class="ttdeci">#define SYMINDEX(SL, sym_no, i, numIMG)</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2symmetries_8h_source.html#l00110">symmetries.h:110</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a></div><div class="ttdoc">Name of an image (std::string) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00246">metadata_label.h:246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a672c3d7e34084ee7d17b8cee8656a415"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a672c3d7e34084ee7d17b8cee8656a415">&#9670;&nbsp;</a></span>noSort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void noSort </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numIMG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>ordered_list</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>No projection sorting at all. This function directly returns the same order as in the selection file </p>

<p class="definition">Definition at line <a class="el" href="recons__misc_8cpp_source.html#l00222">222</a> of file <a class="el" href="recons__misc_8cpp_source.html">recons_misc.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;{</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    ordered_list.<a class="code" href="classMultidimArray.html#adc02bdf8ed322143079e529beb94a355">initLinear</a>(0, numIMG - 1);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_adc02bdf8ed322143079e529beb94a355"><div class="ttname"><a href="classMultidimArray.html#adc02bdf8ed322143079e529beb94a355">MultidimArray::initLinear</a></div><div class="ttdeci">void initLinear(T minF, T maxF, int n=1, const String &amp;mode=&quot;incr&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02797">multidim_array.h:2797</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a924024746d15317f1153f4094b1ca1a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a924024746d15317f1153f4094b1ca1a4">&#9670;&nbsp;</a></span>sortPerpendicular()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sortPerpendicular </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numIMG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structReconsInfo.html">ReconsInfo</a> *&#160;</td>
          <td class="paramname"><em>IMG_Inf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>ordered_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em> = <code>2</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sort projections orthogonally. This function sorts a number of images given by numIMG, whose information about their <a class="el" href="classEuler.html">Euler</a> angles are in IMG_inf, into an ordered list which gives the indexes. First an image is chosen randomly from the whole set. Then all images are compared to the first one, and the most perpendicular one is chosen. The remaining set of images are compared to this two images and the most perpendicular one to the former two is chosen, and so on until no image is left in the set.</p>
<p>If the result in ordered list is 4, 70, 54, 203, 1, 0, ... it means that the first image is the number 4, then goes the 70, then the 54, ...</p>
<p>If N!=-1 then the product is done only with the last N images. A very useful value is N=2 </p>

<p class="definition">Definition at line <a class="el" href="recons__misc_8cpp_source.html#l00145">145</a> of file <a class="el" href="recons__misc_8cpp_source.html">recons_misc.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;{</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">int</span>   <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;short&gt;</a> chosen(numIMG);     <span class="comment">// 1 if that image has been already</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// chosen</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordtype">double</span> min_prod;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordtype">int</span>   min_prod_proj=0;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> v(numIMG, 3);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> euler;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> product(numIMG);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// Initialization</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    ordered_list.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(numIMG);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; numIMG; i++)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="comment">// Initially no image is chosen</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(chosen, i) = 0;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="comment">// Compute the Euler matrix for each image and keep only</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="comment">// the third row of each one</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <a class="code" href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a>(IMG_Inf[i].rot, IMG_Inf[i].tilt, 0., euler);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        euler.<a class="code" href="classMatrix2D.html#a9e4bd9c27982c0d7775f3804bf021687">getRow</a>(2, z);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        v.setRow(i, z);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// Pick first projection as the first one to be presented</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    i = 0;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(chosen, i) = 1;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(ordered_list, 0) = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">// Choose the rest of projections</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Sorting projections ...\n&quot;</span>;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="group__GeneralFunctions.html#ga8c220fe710ecdb4f9b1696dd53e20ff3">init_progress_bar</a>(numIMG - 1);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> rowj, rowi_1, rowi_N_1;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">for</span> (i = 1; i &lt; numIMG; i++)</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="comment">// Compute the product of not already chosen vectors with the just</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="comment">// chosen one, and select that which has minimum product</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        min_prod = <a class="code" href="data__types_8h.html#a5e9e29217f6ec61105a4520ec5942225">MAXFLOAT</a>;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        v.getRow(<a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(ordered_list, i - 1),rowi_1);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordflow">if</span> (N != -1 &amp;&amp; i &gt; N)</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            v.getRow(<a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(ordered_list, i - N - 1),rowi_N_1);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; numIMG; j++)</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(chosen, j))</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                v.getRow(j,rowj);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                <a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(product, j) += <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(<a class="code" href="group__Vectors.html#ga5d2bc77c327154906885f1ebedc8d787">dotProduct</a>(rowi_1,rowj));</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                <span class="keywordflow">if</span> (N != -1 &amp;&amp; i &gt; N)</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                    <a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(product, j) -= <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(<a class="code" href="group__Vectors.html#ga5d2bc77c327154906885f1ebedc8d787">dotProduct</a>(rowi_N_1,rowj));</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(product, j) &lt; min_prod)</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                    min_prod = <a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(product, j);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                    min_prod_proj = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        }</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="comment">// Store the chosen vector and mark it as chosen</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(ordered_list, i) = min_prod_proj;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(chosen, min_prod_proj) = 1;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="comment">// The progress bar is updated only every 10 images</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordflow">if</span> (i % 10 == 0)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <a class="code" href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a>(i);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    }</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// A final call to progress bar to finish a possible small piece</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a>(numIMG - 1);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;}</div><div class="ttc" id="group__GeneralFunctions_html_ga8c220fe710ecdb4f9b1696dd53e20ff3"><div class="ttname"><a href="group__GeneralFunctions.html#ga8c220fe710ecdb4f9b1696dd53e20ff3">init_progress_bar</a></div><div class="ttdeci">void init_progress_bar(long total)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00782">xmipp_funcs.cpp:782</a></div></div>
<div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00983">multidim_array.cpp:983</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="common__lines_8h_source.html#l00035">common_lines.h:35</a></div></div>
<div class="ttc" id="group__Geometry_html_gaf67a2d233e3fbf038d111a91197fa759"><div class="ttname"><a href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a></div><div class="ttdeci">void Euler_angles2matrix(T alpha, T beta, T gamma, Matrix2D&lt; T &gt; &amp;A, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00624">geometry.cpp:624</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a97809f7244a28aaa1c26e29e6e3204ef"><div class="ttname"><a href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a></div><div class="ttdeci">#define A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00539">multidim_array_base.h:539</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga3bdba82f045e73fb216c6be539e6b129"><div class="ttname"><a href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a></div><div class="ttdeci">void progress_bar(long rlen)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00791">xmipp_funcs.cpp:791</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aa508e3dbd0e86258b5c69e8a8b6b8295"><div class="ttname"><a href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08492">numerical_recipes.cpp:8492</a></div></div>
<div class="ttc" id="data__types_8h_html_a5e9e29217f6ec61105a4520ec5942225"><div class="ttname"><a href="data__types_8h.html#a5e9e29217f6ec61105a4520ec5942225">MAXFLOAT</a></div><div class="ttdeci">#define MAXFLOAT</div><div class="ttdef"><b>Definition:</b> <a href="data__types_8h_source.html#l00047">data_types.h:47</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_ga5d2bc77c327154906885f1ebedc8d787"><div class="ttname"><a href="group__Vectors.html#ga5d2bc77c327154906885f1ebedc8d787">dotProduct</a></div><div class="ttdeci">T dotProduct(const Matrix1D&lt; T &gt; &amp;v1, const Matrix1D&lt; T &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01140">matrix1d.h:1140</a></div></div>
<div class="ttc" id="classMatrix2D_html_a9e4bd9c27982c0d7775f3804bf021687"><div class="ttname"><a href="classMatrix2D.html#a9e4bd9c27982c0d7775f3804bf021687">Matrix2D::getRow</a></div><div class="ttdeci">void getRow(size_t i, Matrix1D&lt; T &gt; &amp;v) const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l00871">matrix2d.cpp:871</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac4c7ebf4561f83df0f69739a32e43f1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4c7ebf4561f83df0f69739a32e43f1e">&#9670;&nbsp;</a></span>sortRandomly()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sortRandomly </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numIMG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>ordered_list</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Randomize the projections. This function sorts randomly a number of images given by numIMG. </p>

<p class="definition">Definition at line <a class="el" href="recons__misc_8cpp_source.html#l00230">230</a> of file <a class="el" href="recons__misc_8cpp_source.html">recons_misc.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;{</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;int&gt;</a> chosen;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// Initialisation</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    ordered_list.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(numIMG);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    chosen.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(numIMG);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Randomizing projections ...\n&quot;</span>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="group__GeneralFunctions.html#ga8c220fe710ecdb4f9b1696dd53e20ff3">init_progress_bar</a>(numIMG - 1);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordtype">int</span> ptr = 0;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="group__GeneralFunctions.html#ga7b0fb4ffbdd7f8290ea98e4f595a225a">randomize_random_generator</a>();</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = numIMG; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt; 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>--)</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    {</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="comment">// Jump a random number starting at the pointed projection</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordtype">int</span> rnd_indx = (int) <a class="code" href="group__GeneralFunctions.html#ga882088c3e41f9fdd7c357e868c001ed5">rnd_unif</a>(0, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) + 1;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordflow">while</span> (rnd_indx &gt; 0)</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        {</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <span class="comment">// Jump one not chosen image</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            ptr = (ptr + 1) % numIMG;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="comment">// Check it is not chosen, if it is, go on skipping</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="keywordflow">while</span> (chosen(ptr))</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            {</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                ptr = (ptr + 1) % numIMG;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            rnd_indx--;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        }</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="comment">// Annotate this image</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(ordered_list, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1) = ptr;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(chosen, ptr) = 1;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="comment">// The progress bar is updated only every 10 images</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> % 10 == 0)</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <a class="code" href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    }</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">// A final call to progress bar to finish a possible small piece</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a>(numIMG - 1);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;}</div><div class="ttc" id="group__GeneralFunctions_html_ga8c220fe710ecdb4f9b1696dd53e20ff3"><div class="ttname"><a href="group__GeneralFunctions.html#ga8c220fe710ecdb4f9b1696dd53e20ff3">init_progress_bar</a></div><div class="ttdeci">void init_progress_bar(long total)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00782">xmipp_funcs.cpp:782</a></div></div>
<div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00983">multidim_array.cpp:983</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; int &gt;</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a97809f7244a28aaa1c26e29e6e3204ef"><div class="ttname"><a href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a></div><div class="ttdeci">#define A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00539">multidim_array_base.h:539</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga882088c3e41f9fdd7c357e868c001ed5"><div class="ttname"><a href="group__GeneralFunctions.html#ga882088c3e41f9fdd7c357e868c001ed5">rnd_unif</a></div><div class="ttdeci">double rnd_unif()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00440">xmipp_funcs.cpp:440</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga3bdba82f045e73fb216c6be539e6b129"><div class="ttname"><a href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a></div><div class="ttdeci">void progress_bar(long rlen)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00791">xmipp_funcs.cpp:791</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02723">multidim_array.h:2723</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga7b0fb4ffbdd7f8290ea98e4f595a225a"><div class="ttname"><a href="group__GeneralFunctions.html#ga7b0fb4ffbdd7f8290ea98e4f595a225a">randomize_random_generator</a></div><div class="ttdeci">unsigned int randomize_random_generator()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00407">xmipp_funcs.cpp:407</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acdd5ef5de3a9b35d6c6db338bf6352b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdd5ef5de3a9b35d6c6db338bf6352b3">&#9670;&nbsp;</a></span>updateResidualVector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void updateResidualVector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBasicARTParameters.html">BasicARTParameters</a> &amp;&#160;</td>
          <td class="paramname"><em>prm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__Grids.html#gae3eeb15b316a9800a7c35372dfd57460">GridVolume</a> &amp;&#160;</td>
          <td class="paramname"><em>vol_basis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>kappa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>pow_residual_vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>pow_residual_imgs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Update residual vector for WLS ART </p>

<p class="definition">Definition at line <a class="el" href="recons__misc_8cpp_source.html#l00275">275</a> of file <a class="el" href="recons__misc_8cpp_source.html">recons_misc.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;{</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="classGridVolumeT.html">GridVolume</a>       residual_vol;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="classProjection.html">Projection</a>       read_proj, dummy_proj, new_proj;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="classFileName.html">FileName</a>         fn_resi, fn_tmp;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordtype">double</span>           sqrtweight, dim2;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> *A = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    std::vector&lt;MultidimArray&lt;double&gt; &gt; newres_imgs;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;int&gt;</a>    mask;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    residual_vol.<a class="code" href="classGridVolumeT.html#a12c7b1044806b70a85217d5afb24c8d8">resize</a>(vol_basis);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    residual_vol.<a class="code" href="classGridVolumeT.html#a2723ae85db4d978b4e41163768c659fd">initZeros</a>();</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">// Calculate volume from all backprojected residual images</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Backprojection of residual images &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">if</span> (!(prm.<a class="code" href="group__BasicART.html#ga5e7c18851b65433f4ff41649d4613d96">tell</a>&amp;<a class="code" href="group__BasicART.html#gab2c6db257b31a2a338c5e530419b1868">TELL_SHOW_ERROR</a>))</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <a class="code" href="group__GeneralFunctions.html#ga8c220fe710ecdb4f9b1696dd53e20ff3">init_progress_bar</a>(prm.<a class="code" href="group__BasicART.html#ga25d107985321a8896ef1e0bb3ca0f6ef">numIMG</a>);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iact_proj = 0; iact_proj &lt; prm.<a class="code" href="group__BasicART.html#ga25d107985321a8896ef1e0bb3ca0f6ef">numIMG</a> ; iact_proj++)</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="comment">// backprojection of the weighted residual image</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        sqrtweight = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(prm.<a class="code" href="group__BasicART.html#gad946a66621f5ba40cdd1fe2579313f1f">residual_imgs</a>[iact_proj].weight() / prm.<a class="code" href="group__BasicART.html#ga829f6dbf147651bb73ac4f54d12679ae">sum_weight</a>);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        read_proj = prm.<a class="code" href="group__BasicART.html#gad946a66621f5ba40cdd1fe2579313f1f">residual_imgs</a>[iact_proj];</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        read_proj() *= sqrtweight;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        dummy_proj().resize(read_proj());</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        dummy_proj.<a class="code" href="group__FourierProjection.html#ga38fc7e819f167ed62bf63c13e1058aab">setAngles</a>(prm.<a class="code" href="group__BasicART.html#ga09d000a5da23cd0102a40cc3a931568a">IMG_Inf</a>[iact_proj].<a class="code" href="structReconsInfo.html#a34a99991679c9ceac0fe32fddb4c6cc5">rot</a>,</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                              prm.<a class="code" href="group__BasicART.html#ga09d000a5da23cd0102a40cc3a931568a">IMG_Inf</a>[iact_proj].<a class="code" href="structReconsInfo.html#ab9ffa606534ea24c0317f8eee4b7c9fb">tilt</a>,</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                              prm.<a class="code" href="group__BasicART.html#ga09d000a5da23cd0102a40cc3a931568a">IMG_Inf</a>[iact_proj].<a class="code" href="structReconsInfo.html#aea44811123efefce13b1addf6139a849">psi</a>);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <a class="code" href="group__ParametersProjectionTomography.html#ga6551ebbcb3db8c9075597537f445307a">project_GridVolume</a>(residual_vol, prm.<a class="code" href="group__BasicART.html#ga5d853339de3e6d1a968d65e7022d60e4">basis</a>, dummy_proj,</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                           read_proj, <a class="code" href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(read_proj()), <a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(read_proj()),</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                           prm.<a class="code" href="group__BasicART.html#ga09d000a5da23cd0102a40cc3a931568a">IMG_Inf</a>[iact_proj].<a class="code" href="structReconsInfo.html#a34a99991679c9ceac0fe32fddb4c6cc5">rot</a>,</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                           prm.<a class="code" href="group__BasicART.html#ga09d000a5da23cd0102a40cc3a931568a">IMG_Inf</a>[iact_proj].<a class="code" href="structReconsInfo.html#ab9ffa606534ea24c0317f8eee4b7c9fb">tilt</a>,</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                           prm.<a class="code" href="group__BasicART.html#ga09d000a5da23cd0102a40cc3a931568a">IMG_Inf</a>[iact_proj].<a class="code" href="structReconsInfo.html#aea44811123efefce13b1addf6139a849">psi</a>, <a class="code" href="blobs_8cpp.html#adf445abfe1b77fa63f89e315ccc2f7f2">BACKWARD</a>, prm.<a class="code" href="group__BasicART.html#ga5f59b4c3fbea3dc2ac6fece2084184e1">eq_mode</a>,</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                           prm.<a class="code" href="group__BasicART.html#ga42b469b6663dc058e2c1967955794435">GVNeq</a>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, prm.<a class="code" href="group__BasicART.html#ga8cc17c6532abea93da31adfa68583375">ray_length</a>, prm.<a class="code" href="group__BasicART.html#gabf77777c1112743426233d1cddddf48a">threads</a>);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keywordflow">if</span> (!(prm.<a class="code" href="group__BasicART.html#ga5e7c18851b65433f4ff41649d4613d96">tell</a>&amp;<a class="code" href="group__BasicART.html#gab2c6db257b31a2a338c5e530419b1868">TELL_SHOW_ERROR</a>))</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="keywordflow">if</span> (iact_proj % <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(1, prm.<a class="code" href="group__BasicART.html#ga25d107985321a8896ef1e0bb3ca0f6ef">numIMG</a> / 60) == 0)</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                <a class="code" href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a>(iact_proj);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">if</span> (!(prm.<a class="code" href="group__BasicART.html#ga5e7c18851b65433f4ff41649d4613d96">tell</a>&amp;<a class="code" href="group__BasicART.html#gab2c6db257b31a2a338c5e530419b1868">TELL_SHOW_ERROR</a>))</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <a class="code" href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a>(prm.<a class="code" href="group__BasicART.html#ga25d107985321a8896ef1e0bb3ca0f6ef">numIMG</a>);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// Convert to voxels: solely for output of power of residual volume</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="classImage.html">Image&lt;double&gt;</a>      residual_vox;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordtype">int</span> Xoutput_volume_size = (prm.<a class="code" href="group__BasicART.html#gab535da85a5ce1686cd30df4a1c69170f">Xoutput_volume_size</a> == 0) ?</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                              prm.<a class="code" href="group__BasicART.html#gaba70ad846683e40d8a3b389aa1d5f988">projXdim</a> : prm.<a class="code" href="group__BasicART.html#gab535da85a5ce1686cd30df4a1c69170f">Xoutput_volume_size</a>;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordtype">int</span> Youtput_volume_size = (prm.<a class="code" href="group__BasicART.html#gaf0e5a2c1f0de0903249e16070491f40e">Youtput_volume_size</a> == 0) ?</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                              prm.<a class="code" href="group__BasicART.html#ga47d783f7a9857f7f69c1159d7a67f82b">projYdim</a> : prm.<a class="code" href="group__BasicART.html#gaf0e5a2c1f0de0903249e16070491f40e">Youtput_volume_size</a>;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordtype">int</span> Zoutput_volume_size = (prm.<a class="code" href="group__BasicART.html#ga7676ff5af09b9ebf692a17c27b725235">Zoutput_volume_size</a> == 0) ?</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                              prm.<a class="code" href="group__BasicART.html#gaba70ad846683e40d8a3b389aa1d5f988">projXdim</a> : prm.<a class="code" href="group__BasicART.html#ga7676ff5af09b9ebf692a17c27b725235">Zoutput_volume_size</a>;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    prm.<a class="code" href="group__BasicART.html#ga5d853339de3e6d1a968d65e7022d60e4">basis</a>.<a class="code" href="classBasis.html#a4ec8be8cf59cd1b135ab92095698a41d">changeToVoxels</a>(residual_vol, &amp;(residual_vox()),</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                             Zoutput_volume_size, Youtput_volume_size, Xoutput_volume_size);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    pow_residual_vol = residual_vox().sum2() / <a class="code" href="multidim__array__base_8h.html#a027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(residual_vox());</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    residual_vox.<a class="code" href="classImage.html#abb90c89018533188d3c5491b37f51b50">clear</a>();</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Projection of residual volume; kappa = &quot;</span> &lt;&lt; kappa &lt;&lt; std::endl;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">if</span> (!(prm.<a class="code" href="group__BasicART.html#ga5e7c18851b65433f4ff41649d4613d96">tell</a>&amp;<a class="code" href="group__BasicART.html#gab2c6db257b31a2a338c5e530419b1868">TELL_SHOW_ERROR</a>))</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <a class="code" href="group__GeneralFunctions.html#ga8c220fe710ecdb4f9b1696dd53e20ff3">init_progress_bar</a>(prm.<a class="code" href="group__BasicART.html#ga25d107985321a8896ef1e0bb3ca0f6ef">numIMG</a>);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">// Now that we have the residual volume: project in all directions</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    pow_residual_imgs = 0.;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    new_proj().resize(read_proj());</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    mask.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(read_proj());</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <a class="code" href="group__Masks.html#ga1f835f6611a65877b172c170a555f869">BinaryCircularMask</a>(mask, <a class="code" href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(read_proj()) / 2, <a class="code" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a>);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    dim2 = (double)<a class="code" href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(read_proj()) * <a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(read_proj());</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iact_proj = 0; iact_proj &lt; prm.<a class="code" href="group__BasicART.html#ga25d107985321a8896ef1e0bb3ca0f6ef">numIMG</a> ; iact_proj++)</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    {</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <a class="code" href="group__ParametersProjectionTomography.html#ga6551ebbcb3db8c9075597537f445307a">project_GridVolume</a>(residual_vol, prm.<a class="code" href="group__BasicART.html#ga5d853339de3e6d1a968d65e7022d60e4">basis</a>, new_proj,</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                           dummy_proj, <a class="code" href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(read_proj()), <a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(read_proj()),</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                           prm.<a class="code" href="group__BasicART.html#ga09d000a5da23cd0102a40cc3a931568a">IMG_Inf</a>[iact_proj].<a class="code" href="structReconsInfo.html#a34a99991679c9ceac0fe32fddb4c6cc5">rot</a>,</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                           prm.<a class="code" href="group__BasicART.html#ga09d000a5da23cd0102a40cc3a931568a">IMG_Inf</a>[iact_proj].<a class="code" href="structReconsInfo.html#ab9ffa606534ea24c0317f8eee4b7c9fb">tilt</a>,</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                           prm.<a class="code" href="group__BasicART.html#ga09d000a5da23cd0102a40cc3a931568a">IMG_Inf</a>[iact_proj].<a class="code" href="structReconsInfo.html#aea44811123efefce13b1addf6139a849">psi</a>, <a class="code" href="blobs_8cpp.html#a6ddfdda7a062d10cff4a72b76b44aeb8">FORWARD</a>, prm.<a class="code" href="group__BasicART.html#ga5f59b4c3fbea3dc2ac6fece2084184e1">eq_mode</a>,</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                           prm.<a class="code" href="group__BasicART.html#ga42b469b6663dc058e2c1967955794435">GVNeq</a>, A, <span class="keyword">nullptr</span>, prm.<a class="code" href="group__BasicART.html#ga8cc17c6532abea93da31adfa68583375">ray_length</a>, prm.<a class="code" href="group__BasicART.html#gabf77777c1112743426233d1cddddf48a">threads</a>);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        sqrtweight = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(prm.<a class="code" href="group__BasicART.html#gad946a66621f5ba40cdd1fe2579313f1f">residual_imgs</a>[iact_proj].weight() / prm.<a class="code" href="group__BasicART.html#ga829f6dbf147651bb73ac4f54d12679ae">sum_weight</a>);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="comment">// Next lines like normalization in [EHL] (2.18)?</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a>(new_proj())</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        {</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            <a class="code" href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a>(dummy_proj(), <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(1., <a class="code" href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a>(dummy_proj(), <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)); <span class="comment">// to avoid division by zero</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <a class="code" href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a>(new_proj(), <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) /= <a class="code" href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a>(dummy_proj(), <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        }</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        new_proj() *= sqrtweight * kappa;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">        fn_tmp=&quot;residual_&quot;+integerToString(iact_proj);</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">        dummy_proj()=1000*prm.residual_imgs[iact_proj]();</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">        dummy_proj.write(fn_tmp+&quot;.old&quot;);</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">        */</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        prm.<a class="code" href="group__BasicART.html#gad946a66621f5ba40cdd1fe2579313f1f">residual_imgs</a>[iact_proj]() -= new_proj();</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        pow_residual_imgs += prm.<a class="code" href="group__BasicART.html#gad946a66621f5ba40cdd1fe2579313f1f">residual_imgs</a>[iact_proj]().sum2();</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="comment">// Mask out edges of the images</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <a class="code" href="group__Masks.html#gadf8e3471e09288a8c320d1d900695c21">apply_binary_mask</a>(mask, prm.<a class="code" href="group__BasicART.html#gad946a66621f5ba40cdd1fe2579313f1f">residual_imgs</a>[iact_proj](), prm.<a class="code" href="group__BasicART.html#gad946a66621f5ba40cdd1fe2579313f1f">residual_imgs</a>[iact_proj](), 0.);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">        dummy_proj()=1000*new_proj();</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">        dummy_proj.write(fn_tmp+&quot;.change&quot;);</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">        dummy_proj()=1000*prm.residual_imgs[iact_proj]();</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">        dummy_proj.write(fn_tmp+&quot;.new&quot;);</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">        */</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keywordflow">if</span> (!(prm.<a class="code" href="group__BasicART.html#ga5e7c18851b65433f4ff41649d4613d96">tell</a>&amp;<a class="code" href="group__BasicART.html#gab2c6db257b31a2a338c5e530419b1868">TELL_SHOW_ERROR</a>))</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            <span class="keywordflow">if</span> (iact_proj % <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(1, prm.<a class="code" href="group__BasicART.html#ga25d107985321a8896ef1e0bb3ca0f6ef">numIMG</a> / 60) == 0)</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                <a class="code" href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a>(iact_proj);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    pow_residual_imgs /= dim2;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    newres_imgs.clear();</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">if</span> (!(prm.<a class="code" href="group__BasicART.html#ga5e7c18851b65433f4ff41649d4613d96">tell</a>&amp;<a class="code" href="group__BasicART.html#gab2c6db257b31a2a338c5e530419b1868">TELL_SHOW_ERROR</a>))</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <a class="code" href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a>(prm.<a class="code" href="group__BasicART.html#ga25d107985321a8896ef1e0bb3ca0f6ef">numIMG</a>);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;}</div><div class="ttc" id="group__GeneralFunctions_html_ga8c220fe710ecdb4f9b1696dd53e20ff3"><div class="ttname"><a href="group__GeneralFunctions.html#ga8c220fe710ecdb4f9b1696dd53e20ff3">init_progress_bar</a></div><div class="ttdeci">void init_progress_bar(long total)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00782">xmipp_funcs.cpp:782</a></div></div>
<div class="ttc" id="group__BasicART_html_ga25d107985321a8896ef1e0bb3ca0f6ef"><div class="ttname"><a href="group__BasicART.html#ga25d107985321a8896ef1e0bb3ca0f6ef">BasicARTParameters::numIMG</a></div><div class="ttdeci">int numIMG</div><div class="ttdoc">Total number of images to process (taking symmetries into account) </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00348">basic_art.h:348</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00095">multidim_array_base.h:95</a></div></div>
<div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00983">multidim_array.cpp:983</a></div></div>
<div class="ttc" id="group__Macros_html_gae0a4180e923e3ffca3989e20e441aa3c"><div class="ttname"><a href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a></div><div class="ttdeci">#define XMIPP_MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00193">xmipp_macros.h:193</a></div></div>
<div class="ttc" id="group__BasicART_html_gaba70ad846683e40d8a3b389aa1d5f988"><div class="ttname"><a href="group__BasicART.html#gaba70ad846683e40d8a3b389aa1d5f988">BasicARTParameters::projXdim</a></div><div class="ttdeci">size_t projXdim</div><div class="ttdoc">Projection X dimension. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00333">basic_art.h:333</a></div></div>
<div class="ttc" id="structReconsInfo_html_aea44811123efefce13b1addf6139a849"><div class="ttname"><a href="structReconsInfo.html#aea44811123efefce13b1addf6139a849">ReconsInfo::psi</a></div><div class="ttdeci">double psi</div><div class="ttdoc">Psi angle. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00071">basic_art.h:71</a></div></div>
<div class="ttc" id="group__BasicART_html_gab2c6db257b31a2a338c5e530419b1868"><div class="ttname"><a href="group__BasicART.html#gab2c6db257b31a2a338c5e530419b1868">TELL_SHOW_ERROR</a></div><div class="ttdeci">#define TELL_SHOW_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00272">basic_art.h:272</a></div></div>
<div class="ttc" id="group__BasicART_html_ga5d853339de3e6d1a968d65e7022d60e4"><div class="ttname"><a href="group__BasicART.html#ga5d853339de3e6d1a968d65e7022d60e4">BasicARTParameters::basis</a></div><div class="ttdeci">Basis basis</div><div class="ttdoc">Basis function. By default, blobs. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00097">basic_art.h:97</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; int &gt;</a></div></div>
<div class="ttc" id="classGridVolumeT_html_a12c7b1044806b70a85217d5afb24c8d8"><div class="ttname"><a href="classGridVolumeT.html#a12c7b1044806b70a85217d5afb24c8d8">GridVolumeT::resize</a></div><div class="ttdeci">void resize(const Matrix1D&lt; double &gt; &amp;corner1, const Matrix1D&lt; double &gt; &amp;corner2)</div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00873">grids.h:873</a></div></div>
<div class="ttc" id="group__Masks_html_gadf8e3471e09288a8c320d1d900695c21"><div class="ttname"><a href="group__Masks.html#gadf8e3471e09288a8c320d1d900695c21">apply_binary_mask</a></div><div class="ttdeci">void apply_binary_mask(const MultidimArray&lt; int &gt; &amp;mask, const MultidimArray&lt; T &gt; &amp;m_in, MultidimArray&lt; T &gt; &amp;m_out, T subs_val=(T) 0)</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00857">mask.h:857</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4e8db4e5757ca2f6e233d0a1eec7ff1c"><div class="ttname"><a href="multidim__array__base_8h.html#a4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00509">multidim_array_base.h:509</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a027a630a86c277b71cda769268764fd1"><div class="ttname"><a href="multidim__array__base_8h.html#a027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a></div><div class="ttdeci">#define MULTIDIM_SIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00115">multidim_array_base.h:115</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_afa02b309a507bf04daf9f31fa828ce4f"><div class="ttname"><a href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a></div><div class="ttdeci">#define dAij(M, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00345">multidim_array_base.h:345</a></div></div>
<div class="ttc" id="group__BasicART_html_ga5f59b4c3fbea3dc2ac6fece2084184e1"><div class="ttname"><a href="group__BasicART.html#ga5f59b4c3fbea3dc2ac6fece2084184e1">BasicARTParameters::eq_mode</a></div><div class="ttdeci">int eq_mode</div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00117">basic_art.h:117</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00210">image_operate.cpp:210</a></div></div>
<div class="ttc" id="group__Masks_html_ga1f835f6611a65877b172c170a555f869"><div class="ttname"><a href="group__Masks.html#ga1f835f6611a65877b172c170a555f869">BinaryCircularMask</a></div><div class="ttdeci">void BinaryCircularMask(MultidimArray&lt; int &gt; &amp;mask, double radius, int mode, double x0, double y0, double z0)</div><div class="ttdef"><b>Definition:</b> <a href="mask_8cpp_source.html#l00193">mask.cpp:193</a></div></div>
<div class="ttc" id="group__BasicART_html_gaf0e5a2c1f0de0903249e16070491f40e"><div class="ttname"><a href="group__BasicART.html#gaf0e5a2c1f0de0903249e16070491f40e">BasicARTParameters::Youtput_volume_size</a></div><div class="ttdeci">int Youtput_volume_size</div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00163">basic_art.h:163</a></div></div>
<div class="ttc" id="group__BasicART_html_ga5e7c18851b65433f4ff41649d4613d96"><div class="ttname"><a href="group__BasicART.html#ga5e7c18851b65433f4ff41649d4613d96">BasicARTParameters::tell</a></div><div class="ttdeci">int tell</div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00311">basic_art.h:311</a></div></div>
<div class="ttc" id="group__BasicART_html_gab535da85a5ce1686cd30df4a1c69170f"><div class="ttname"><a href="group__BasicART.html#gab535da85a5ce1686cd30df4a1c69170f">BasicARTParameters::Xoutput_volume_size</a></div><div class="ttdeci">int Xoutput_volume_size</div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00159">basic_art.h:159</a></div></div>
<div class="ttc" id="blobs_8cpp_html_adf445abfe1b77fa63f89e315ccc2f7f2"><div class="ttname"><a href="blobs_8cpp.html#adf445abfe1b77fa63f89e315ccc2f7f2">BACKWARD</a></div><div class="ttdeci">#define BACKWARD</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l01092">blobs.cpp:1092</a></div></div>
<div class="ttc" id="group__BasicART_html_ga47d783f7a9857f7f69c1159d7a67f82b"><div class="ttname"><a href="group__BasicART.html#ga47d783f7a9857f7f69c1159d7a67f82b">BasicARTParameters::projYdim</a></div><div class="ttdeci">size_t projYdim</div><div class="ttdoc">Projection Y dimension. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00336">basic_art.h:336</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00065">xmipp_filename.h:65</a></div></div>
<div class="ttc" id="classBasis_html_a4ec8be8cf59cd1b135ab92095698a41d"><div class="ttname"><a href="classBasis.html#a4ec8be8cf59cd1b135ab92095698a41d">Basis::changeToVoxels</a></div><div class="ttdeci">void changeToVoxels(GridVolume &amp;vol_basis, MultidimArray&lt; double &gt; *vol_voxels, int Zdim, int Ydim, int Xdim, int threads=1) const</div><div class="ttdef"><b>Definition:</b> <a href="basis_8cpp_source.html#l00261">basis.cpp:261</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="structReconsInfo_html_ab9ffa606534ea24c0317f8eee4b7c9fb"><div class="ttname"><a href="structReconsInfo.html#ab9ffa606534ea24c0317f8eee4b7c9fb">ReconsInfo::tilt</a></div><div class="ttdeci">double tilt</div><div class="ttdoc">Tilting angle. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00069">basic_art.h:69</a></div></div>
<div class="ttc" id="group__BasicART_html_ga42b469b6663dc058e2c1967955794435"><div class="ttname"><a href="group__BasicART.html#ga42b469b6663dc058e2c1967955794435">BasicARTParameters::GVNeq</a></div><div class="ttdeci">GridVolumeT&lt; int &gt; * GVNeq</div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00381">basic_art.h:381</a></div></div>
<div class="ttc" id="group__ParametersProjectionTomography_html_ga6551ebbcb3db8c9075597537f445307a"><div class="ttname"><a href="group__ParametersProjectionTomography.html#ga6551ebbcb3db8c9075597537f445307a">project_GridVolume</a></div><div class="ttdeci">void project_GridVolume(GridVolumeT&lt; T &gt; &amp;vol, const Basis &amp;basis, Projection &amp;proj, Projection &amp;norm_proj, int Ydim, int Xdim, double rot, double tilt, double psi, int FORW, int eq_mode, GridVolumeT&lt; int &gt; *GVNeq, Matrix2D&lt; double &gt; *M, const MultidimArray&lt; int &gt; *mask, double ray_length, int threads)</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l01863">projection.cpp:1863</a></div></div>
<div class="ttc" id="group__BasicART_html_ga09d000a5da23cd0102a40cc3a931568a"><div class="ttname"><a href="group__BasicART.html#ga09d000a5da23cd0102a40cc3a931568a">BasicARTParameters::IMG_Inf</a></div><div class="ttdeci">ReconsInfo * IMG_Inf</div><div class="ttdoc">Array with all the sorting information for each projection. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00342">basic_art.h:342</a></div></div>
<div class="ttc" id="classGridVolumeT_html_a2723ae85db4d978b4e41163768c659fd"><div class="ttname"><a href="classGridVolumeT.html#a2723ae85db4d978b4e41163768c659fd">GridVolumeT::initZeros</a></div><div class="ttdeci">void initZeros()</div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00936">grids.h:936</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00091">multidim_array_base.h:91</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga3bdba82f045e73fb216c6be539e6b129"><div class="ttname"><a href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a></div><div class="ttdeci">void progress_bar(long rlen)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00791">xmipp_funcs.cpp:791</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a6ddfdda7a062d10cff4a72b76b44aeb8"><div class="ttname"><a href="blobs_8cpp.html#a6ddfdda7a062d10cff4a72b76b44aeb8">FORWARD</a></div><div class="ttdeci">#define FORWARD</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l01091">blobs.cpp:1091</a></div></div>
<div class="ttc" id="classProjection_html"><div class="ttname"><a href="classProjection.html">Projection</a></div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00056">fourier_projection.h:56</a></div></div>
<div class="ttc" id="group__BasicART_html_ga8cc17c6532abea93da31adfa68583375"><div class="ttname"><a href="group__BasicART.html#ga8cc17c6532abea93da31adfa68583375">BasicARTParameters::ray_length</a></div><div class="ttdeci">double ray_length</div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00240">basic_art.h:240</a></div></div>
<div class="ttc" id="group__BasicART_html_ga7676ff5af09b9ebf692a17c27b725235"><div class="ttname"><a href="group__BasicART.html#ga7676ff5af09b9ebf692a17c27b725235">BasicARTParameters::Zoutput_volume_size</a></div><div class="ttdeci">int Zoutput_volume_size</div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00167">basic_art.h:167</a></div></div>
<div class="ttc" id="structReconsInfo_html_a34a99991679c9ceac0fe32fddb4c6cc5"><div class="ttname"><a href="structReconsInfo.html#a34a99991679c9ceac0fe32fddb4c6cc5">ReconsInfo::rot</a></div><div class="ttdeci">double rot</div><div class="ttdoc">Rotational angle. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00067">basic_art.h:67</a></div></div>
<div class="ttc" id="classGridVolumeT_html"><div class="ttname"><a href="classGridVolumeT.html">GridVolumeT</a></div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00041">grids.h:41</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="group__FourierProjection_html_ga38fc7e819f167ed62bf63c13e1058aab"><div class="ttname"><a href="group__FourierProjection.html#ga38fc7e819f167ed62bf63c13e1058aab">Projection::setAngles</a></div><div class="ttdeci">void setAngles(double _rot, double _tilt, double _psi)</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8cpp_source.html#l00040">fourier_projection.cpp:40</a></div></div>
<div class="ttc" id="group__BasicART_html_gabf77777c1112743426233d1cddddf48a"><div class="ttname"><a href="group__BasicART.html#gabf77777c1112743426233d1cddddf48a">BasicARTParameters::threads</a></div><div class="ttdeci">int threads</div><div class="ttdoc">Number of threads to use. Can not be different than 1 when using MPI. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00267">basic_art.h:267</a></div></div>
<div class="ttc" id="classImage_html_abb90c89018533188d3c5491b37f51b50"><div class="ttname"><a href="classImage.html#abb90c89018533188d3c5491b37f51b50">Image::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image_8h_source.html#l00143">xmipp_image.h:143</a></div></div>
<div class="ttc" id="group__BasicART_html_gad946a66621f5ba40cdd1fe2579313f1f"><div class="ttname"><a href="group__BasicART.html#gad946a66621f5ba40cdd1fe2579313f1f">BasicARTParameters::residual_imgs</a></div><div class="ttdeci">std::vector&lt; Projection &gt; residual_imgs</div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00135">basic_art.h:135</a></div></div>
<div class="ttc" id="group__Masks_html_gac9de3d29a36807613ac35b5179169b8e"><div class="ttname"><a href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a></div><div class="ttdeci">constexpr int INNER_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00047">mask.h:47</a></div></div>
<div class="ttc" id="group__BasicART_html_ga829f6dbf147651bb73ac4f54d12679ae"><div class="ttname"><a href="group__BasicART.html#ga829f6dbf147651bb73ac4f54d12679ae">BasicARTParameters::sum_weight</a></div><div class="ttdeci">double sum_weight</div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00138">basic_art.h:138</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
