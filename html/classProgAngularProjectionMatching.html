<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Xmipp: ProgAngularProjectionMatching Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classProgAngularProjectionMatching-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ProgAngularProjectionMatching Class Reference<div class="ingroups"><a class="el" href="group__angular__projection__matching.html">new_projmatch (Discrete angular assignment using a new projection matching)</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for ProgAngularProjectionMatching:</div>
<div class="dyncontent">
<div class="center"><img src="classProgAngularProjectionMatching__inherit__graph.png" border="0" usemap="#ProgAngularProjectionMatching_inherit__map" alt="Inheritance graph"/></div>
<map name="ProgAngularProjectionMatching_inherit__map" id="ProgAngularProjectionMatching_inherit__map">
<area shape="rect" id="node3" href="classMpiProgAngularProjectionMatching.html" title="MpiProgAngularProjection\lMatching" alt="" coords="21,155,193,196"/>
<area shape="rect" id="node2" href="classXmippProgram.html" title="XmippProgram" alt="" coords="53,5,161,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for ProgAngularProjectionMatching:</div>
<div class="dyncontent">
<div class="center"><img src="classProgAngularProjectionMatching__coll__graph.png" border="0" usemap="#ProgAngularProjectionMatching_coll__map" alt="Collaboration graph"/></div>
<map name="ProgAngularProjectionMatching_coll__map" id="ProgAngularProjectionMatching_coll__map">
<area shape="rect" id="node2" href="classXmippProgram.html" title="XmippProgram" alt="" coords="760,55,868,81"/>
<area shape="rect" id="node3" href="classProgramDef.html" title="ProgramDef" alt="" coords="485,51,577,77"/>
<area shape="rect" id="node4" href="classASTNode.html" title="ASTNode" alt="" coords="205,96,284,123"/>
<area shape="rect" id="node5" href="classArgToken.html" title="ArgToken" alt="" coords="5,71,84,97"/>
<area shape="rect" id="node6" href="classArgLexer.html" title="ArgLexer" alt="" coords="7,121,82,148"/>
<area shape="rect" id="node7" href="classCommentList.html" title="CommentList" alt="" coords="195,7,295,33"/>
<area shape="rect" id="node8" href="classMetaData.html" title="MetaData" alt="" coords="775,109,853,136"/>
<area shape="rect" id="node9" href="classMDSql.html" title="MDSql" alt="" coords="500,101,563,128"/>
<area shape="rect" id="node10" href="classFileName.html" title="FileName" alt="" coords="492,236,571,263"/>
<area shape="rect" id="node13" href="classPolar.html" title="Polar\&lt; std::complex\l\&lt; double \&gt; \&gt;" alt="" coords="745,318,883,359"/>
<area shape="rect" id="node17" href="classSampling.html" title="Sampling" alt="" coords="776,485,852,512"/>
<area shape="rect" id="node12" href="structmybarrier__t.html" title="mybarrier_t" alt="" coords="771,267,857,293"/>
<area shape="rect" id="node14" href="classPolar__fftw__plans.html" title="Polar_fftw_plans" alt="" coords="755,384,873,411"/>
<area shape="rect" id="node15" href="classMultidimArray.html" title="MultidimArray\&lt; double \&gt;" alt="" coords="732,435,896,461"/>
<area shape="rect" id="node16" href="classMultidimArrayBase.html" title="MultidimArrayBase" alt="" coords="465,435,597,461"/>
<area shape="rect" id="node18" href="classSymList.html" title="SymList" alt="" coords="496,485,567,512"/>
<area shape="rect" id="node19" href="classMatrix2D.html" title="Matrix2D\&lt; double \&gt;" alt="" coords="176,523,313,549"/>
<area shape="rect" id="node20" href="classMatrix1D.html" title="Matrix1D\&lt; int \&gt;" alt="" coords="188,448,301,475"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a991ca775d86372b59bfaa3bdaf13006a"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a991ca775d86372b59bfaa3bdaf13006a">readParams</a> ()</td></tr>
<tr class="memdesc:a991ca775d86372b59bfaa3bdaf13006a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read arguments from command line.  <a href="#a991ca775d86372b59bfaa3bdaf13006a">More...</a><br /></td></tr>
<tr class="separator:a991ca775d86372b59bfaa3bdaf13006a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26213be6c329b9878ee49af5561cf651"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a26213be6c329b9878ee49af5561cf651">defineParams</a> ()</td></tr>
<tr class="memdesc:a26213be6c329b9878ee49af5561cf651"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define arguments accepted.  <a href="#a26213be6c329b9878ee49af5561cf651">More...</a><br /></td></tr>
<tr class="separator:a26213be6c329b9878ee49af5561cf651"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33ca91be8f4ac708b3d44f03e6bb9c64"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a33ca91be8f4ac708b3d44f03e6bb9c64">show</a> ()</td></tr>
<tr class="separator:a33ca91be8f4ac708b3d44f03e6bb9c64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a457f6dd4750dc5487c210046c01fd000"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a457f6dd4750dc5487c210046c01fd000">run</a> ()</td></tr>
<tr class="separator:a457f6dd4750dc5487c210046c01fd000"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf2390e35441f03aba73075a813e9e77"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#abf2390e35441f03aba73075a813e9e77">produceSideInfo</a> ()</td></tr>
<tr class="separator:abf2390e35441f03aba73075a813e9e77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a781a97d7cc14a3d012d0de7546f7f4f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a781a97d7cc14a3d012d0de7546f7f4f6">rotationallyAlignOneImage</a> (<a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;img, int imgno, int &amp;opt_samplenr, double &amp;opt_psi, bool &amp;opt_flip, double &amp;maxcorr)</td></tr>
<tr class="separator:a781a97d7cc14a3d012d0de7546f7f4f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa1d2a0ad80c2deae0e33de00fb7af6d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#afa1d2a0ad80c2deae0e33de00fb7af6d">translationallyAlignOneImage</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img, const int &amp;samplenr, const double &amp;psi, const bool &amp;opt_flip, double &amp;opt_xoff, double &amp;opt_yoff, double &amp;maxcorr)</td></tr>
<tr class="separator:afa1d2a0ad80c2deae0e33de00fb7af6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a060fce387f382e53d5f216fdd4ed404a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a060fce387f382e53d5f216fdd4ed404a">scaleAlignOneImage</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img, const int &amp;samplenr, const double &amp;psi, const bool &amp;opt_flip, const double &amp;opt_xoff, const double &amp;opt_yoff, const double &amp;old_scale, double &amp;opt_scale, double &amp;maxcorr)</td></tr>
<tr class="separator:a060fce387f382e53d5f216fdd4ed404a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a08cfec5754dfeaa806ea6874fc2139"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a2a08cfec5754dfeaa806ea6874fc2139">getCurrentReference</a> (int refno, <a class="el" href="classPolar__fftw__plans.html">Polar_fftw_plans</a> &amp;local_plans)</td></tr>
<tr class="separator:a2a08cfec5754dfeaa806ea6874fc2139"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7247ba61ac3387ec73ba05fbe9d5dfef"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a7247ba61ac3387ec73ba05fbe9d5dfef">processAllImages</a> ()</td></tr>
<tr class="separator:a7247ba61ac3387ec73ba05fbe9d5dfef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2fa75dd517979963de1bf15cc6878cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#aa2fa75dd517979963de1bf15cc6878cb">processSomeImages</a> (const std::vector&lt; size_t &gt; &amp;imagesToProcess)</td></tr>
<tr class="separator:aa2fa75dd517979963de1bf15cc6878cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa00715bc55b889ae05eeeafb17d51d38"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#aa00715bc55b889ae05eeeafb17d51d38">getCurrentImage</a> (size_t imgid, <a class="el" href="classImage.html">Image</a>&lt; double &gt; &amp;img)</td></tr>
<tr class="separator:aa00715bc55b889ae05eeeafb17d51d38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0215f85731724322fc3f33a89ce8014"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#ac0215f85731724322fc3f33a89ce8014">writeOutputFiles</a> ()</td></tr>
<tr class="separator:ac0215f85731724322fc3f33a89ce8014"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1fc871c4f2f0f90e1d4cf62d775c8c3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#aa1fc871c4f2f0f90e1d4cf62d775c8c3">destroyAndClean</a> ()</td></tr>
<tr class="separator:aa1fc871c4f2f0f90e1d4cf62d775c8c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classXmippProgram"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classXmippProgram')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classXmippProgram.html">XmippProgram</a></td></tr>
<tr class="memitem:a5d9e1f008822effa47814c59e9a3c797 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a5d9e1f008822effa47814c59e9a3c797">getParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, int arg=0)</td></tr>
<tr class="separator:a5d9e1f008822effa47814c59e9a3c797 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8e51e73a487e0d53408dc84ebbe6655 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#af8e51e73a487e0d53408dc84ebbe6655">getParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, const char *subparam, int arg=0)</td></tr>
<tr class="separator:af8e51e73a487e0d53408dc84ebbe6655 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b7ddf0836dc1079ea2622e2a420c39c inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, int arg=0)</td></tr>
<tr class="separator:a7b7ddf0836dc1079ea2622e2a420c39c inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1da1a25db76959a3e747d0ebd34512a4 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a1da1a25db76959a3e747d0ebd34512a4">getIntParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, const char *subparam, int arg=0)</td></tr>
<tr class="separator:a1da1a25db76959a3e747d0ebd34512a4 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a552e1ea4a84576d9149b965d9edb6277 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, int arg=0)</td></tr>
<tr class="separator:a552e1ea4a84576d9149b965d9edb6277 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4becd069f9a9fefe06cbdd60e238db5 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aa4becd069f9a9fefe06cbdd60e238db5">getDoubleParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, const char *subparam, int arg=0)</td></tr>
<tr class="separator:aa4becd069f9a9fefe06cbdd60e238db5 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f7511fbf474a4752f9a472138b64089 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a6f7511fbf474a4752f9a472138b64089">getListParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, <a class="el" href="argsparser_8h.html#ab7db7f89faba290ac54cc52f052795e7">StringVector</a> &amp;list)</td></tr>
<tr class="separator:a6f7511fbf474a4752f9a472138b64089 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9deab8bd129383d08e390ff15c185c62 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a9deab8bd129383d08e390ff15c185c62">getCountParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>)</td></tr>
<tr class="separator:a9deab8bd129383d08e390ff15c185c62 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a27c450de95c55d122be23e3fe89ac1 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>)</td></tr>
<tr class="separator:a1a27c450de95c55d122be23e3fe89ac1 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a9e74a9350dd6211fa0d287c347585a inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a8a9e74a9350dd6211fa0d287c347585a">existsParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>)</td></tr>
<tr class="separator:a8a9e74a9350dd6211fa0d287c347585a inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaeb37f0bac83f5d2a605aaa0e5c4b6ef inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a> (const <a class="el" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a> &amp;line)</td></tr>
<tr class="separator:aaeb37f0bac83f5d2a605aaa0e5c4b6ef inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ce43fdc0dd88cfbd4010a0f77b57d5e inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a8ce43fdc0dd88cfbd4010a0f77b57d5e">addParamsLine</a> (const char *line)</td></tr>
<tr class="separator:a8ce43fdc0dd88cfbd4010a0f77b57d5e inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40382f7972fd7a38486dafe620dca4dd inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classParamDef.html">ParamDef</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a40382f7972fd7a38486dafe620dca4dd">getParamDef</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>) const </td></tr>
<tr class="separator:a40382f7972fd7a38486dafe620dca4dd inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60458fab67fea34afe85b76f63435dcc inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a60458fab67fea34afe85b76f63435dcc">quit</a> (int exit_code=0) const </td></tr>
<tr class="separator:a60458fab67fea34afe85b76f63435dcc inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d0f9381e3828497ca4ee651bba15d9b inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a3d0f9381e3828497ca4ee651bba15d9b">tryRun</a> ()</td></tr>
<tr class="separator:a3d0f9381e3828497ca4ee651bba15d9b inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea0549c1e40215ee12b1abc36648b39a inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aea0549c1e40215ee12b1abc36648b39a">initProgress</a> (size_t total, size_t stepBin=60)</td></tr>
<tr class="separator:aea0549c1e40215ee12b1abc36648b39a inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a074c10cbbaa660749bbc2778592a54c4 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a074c10cbbaa660749bbc2778592a54c4">setProgress</a> (size_t value=0)</td></tr>
<tr class="separator:a074c10cbbaa660749bbc2778592a54c4 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef9f1a6f495c898cb12eac9a7922a84c inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aef9f1a6f495c898cb12eac9a7922a84c">endProgress</a> ()</td></tr>
<tr class="separator:aef9f1a6f495c898cb12eac9a7922a84c inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a0f62b1fe4af78a41e2f9ffe7725962 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a7a0f62b1fe4af78a41e2f9ffe7725962">processDefaultComment</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, const char *left)</td></tr>
<tr class="separator:a7a0f62b1fe4af78a41e2f9ffe7725962 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a439ac2830d63f9e58578203fafaacc10 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a439ac2830d63f9e58578203fafaacc10">setDefaultComment</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, const char *comment)</td></tr>
<tr class="separator:a439ac2830d63f9e58578203fafaacc10 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e88782ecb59e921f041389b71b1183f inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a3e88782ecb59e921f041389b71b1183f">initComments</a> ()</td></tr>
<tr class="separator:a3e88782ecb59e921f041389b71b1183f inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e98654ef7fc47806d345b619b7779d9 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a3e98654ef7fc47806d345b619b7779d9">setProgramName</a> (const char *<a class="el" href="classXmippProgram.html#a1589c976748620757957d494599b6de2">name</a>)</td></tr>
<tr class="separator:a3e98654ef7fc47806d345b619b7779d9 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f396af57519ec443b4656176eb962bf inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a4f396af57519ec443b4656176eb962bf">addUsageLine</a> (const char *line, bool verbatim=false)</td></tr>
<tr class="separator:a4f396af57519ec443b4656176eb962bf inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9df4b765a93997c2505c42f457040a2b inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a9df4b765a93997c2505c42f457040a2b">clearUsage</a> ()</td></tr>
<tr class="separator:a9df4b765a93997c2505c42f457040a2b inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b8f0a6e1bd09e4dbf56a412101e905e inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a4b8f0a6e1bd09e4dbf56a412101e905e">addExampleLine</a> (const char *example, bool verbatim=true)</td></tr>
<tr class="separator:a4b8f0a6e1bd09e4dbf56a412101e905e inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78cb844dedc5e8f4de8320c9a7c8d0a2 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a78cb844dedc5e8f4de8320c9a7c8d0a2">addSeeAlsoLine</a> (const char *seeAlso)</td></tr>
<tr class="separator:a78cb844dedc5e8f4de8320c9a7c8d0a2 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd4adc575f113cb61b3e4bb7bc5106b3 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#afd4adc575f113cb61b3e4bb7bc5106b3">addKeywords</a> (const char *keywords)</td></tr>
<tr class="separator:afd4adc575f113cb61b3e4bb7bc5106b3 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1589c976748620757957d494599b6de2 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a1589c976748620757957d494599b6de2">name</a> () const </td></tr>
<tr class="separator:a1589c976748620757957d494599b6de2 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6eb019dcb9970f1f70678a7bbb3fdaf inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aa6eb019dcb9970f1f70678a7bbb3fdaf">usage</a> (int verb=0) const </td></tr>
<tr class="separator:aa6eb019dcb9970f1f70678a7bbb3fdaf inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53b6cbca94fdb35a012e9a57083a697e inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a53b6cbca94fdb35a012e9a57083a697e">usage</a> (const <a class="el" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a> &amp;<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, int verb=2)</td></tr>
<tr class="separator:a53b6cbca94fdb35a012e9a57083a697e inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2aef2b56d6b0c9bc33a4701ca7d6236d inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a2aef2b56d6b0c9bc33a4701ca7d6236d">version</a> () const </td></tr>
<tr class="separator:a2aef2b56d6b0c9bc33a4701ca7d6236d inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b0644621f62746e36bd7dac7067379b inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a7b0644621f62746e36bd7dac7067379b">show</a> () const </td></tr>
<tr class="separator:a7b0644621f62746e36bd7dac7067379b inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4eff3704eab2b7a94a89185e22f89512 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a4eff3704eab2b7a94a89185e22f89512">read</a> (int <a class="el" href="classXmippProgram.html#a8659f9e603143c1788360f0eeb01e589">argc</a>, const char **<a class="el" href="classXmippProgram.html#af2f60708934c302e1289c5405109dd45">argv</a>, bool reportErrors=true)</td></tr>
<tr class="separator:a4eff3704eab2b7a94a89185e22f89512 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a78239155c382a83b6bc4bbbccbe16c inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a8a78239155c382a83b6bc4bbbccbe16c">read</a> (int <a class="el" href="classXmippProgram.html#a8659f9e603143c1788360f0eeb01e589">argc</a>, char **<a class="el" href="classXmippProgram.html#af2f60708934c302e1289c5405109dd45">argv</a>, bool reportErrors=true)</td></tr>
<tr class="separator:a8a78239155c382a83b6bc4bbbccbe16c inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2afcfd93fe372b575850fc7f526b4f1 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#ae2afcfd93fe372b575850fc7f526b4f1">read</a> (const <a class="el" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a> &amp;argumentsLine)</td></tr>
<tr class="separator:ae2afcfd93fe372b575850fc7f526b4f1 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd42916af00d9ef6222399828349b581 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#abd42916af00d9ef6222399828349b581">XmippProgram</a> ()</td></tr>
<tr class="separator:abd42916af00d9ef6222399828349b581 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f90137c4d1bf8be6bae657e2a880a38 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a8f90137c4d1bf8be6bae657e2a880a38">XmippProgram</a> (int <a class="el" href="classXmippProgram.html#a8659f9e603143c1788360f0eeb01e589">argc</a>, const char **<a class="el" href="classXmippProgram.html#af2f60708934c302e1289c5405109dd45">argv</a>)</td></tr>
<tr class="separator:a8f90137c4d1bf8be6bae657e2a880a38 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b3035afffe42adb8c76518d4d53225b inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a3b3035afffe42adb8c76518d4d53225b">~XmippProgram</a> ()</td></tr>
<tr class="separator:a3b3035afffe42adb8c76518d4d53225b inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a27562024b9dfcc0ff3c14927bcd2707f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFileName.html">FileName</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a27562024b9dfcc0ff3c14927bcd2707f">fn_exp</a></td></tr>
<tr class="separator:a27562024b9dfcc0ff3c14927bcd2707f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa225d6d9aa1a2349b3fe8bfac7c61be3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFileName.html">FileName</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#aa225d6d9aa1a2349b3fe8bfac7c61be3">fn_ref</a></td></tr>
<tr class="separator:aa225d6d9aa1a2349b3fe8bfac7c61be3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0059ca01a9a2e534f234a86f1baa80cd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFileName.html">FileName</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a0059ca01a9a2e534f234a86f1baa80cd">fn_out</a></td></tr>
<tr class="separator:a0059ca01a9a2e534f234a86f1baa80cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca9eed5afc4442b6f6173b8d47046fe6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFileName.html">FileName</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#aca9eed5afc4442b6f6173b8d47046fe6">fn_ctf</a></td></tr>
<tr class="separator:aca9eed5afc4442b6f6173b8d47046fe6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c3b2ace08c588a370b41162bd04a3ee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMetaData.html">MetaData</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a9c3b2ace08c588a370b41162bd04a3ee">DFexp</a></td></tr>
<tr class="separator:a9c3b2ace08c588a370b41162bd04a3ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f0c8469a0fc03f6655791daba88a7a7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMetaData.html">MetaData</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a6f0c8469a0fc03f6655791daba88a7a7">DFo</a></td></tr>
<tr class="separator:a6f0c8469a0fc03f6655791daba88a7a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5e360b3e048572819d48b76f11df5e9"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#ae5e360b3e048572819d48b76f11df5e9">dim</a></td></tr>
<tr class="separator:ae5e360b3e048572819d48b76f11df5e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add0977a6148a63070a4c91eba71ee9cb"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#add0977a6148a63070a4c91eba71ee9cb">paddim</a></td></tr>
<tr class="separator:add0977a6148a63070a4c91eba71ee9cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a723e4a9d596d440137c0a59a6582742b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a723e4a9d596d440137c0a59a6582742b">pad</a></td></tr>
<tr class="separator:a723e4a9d596d440137c0a59a6582742b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1658eaa42a37fdcd6bffdd72a34af947"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a1658eaa42a37fdcd6bffdd72a34af947">max_shift</a></td></tr>
<tr class="separator:a1658eaa42a37fdcd6bffdd72a34af947"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60f6e7892e2cac3c25be6d46a4f9bdc5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a60f6e7892e2cac3c25be6d46a4f9bdc5">Ri</a></td></tr>
<tr class="separator:a60f6e7892e2cac3c25be6d46a4f9bdc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab67ae2242d1cd1fd2c1b106b1debff2d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#ab67ae2242d1cd1fd2c1b106b1debff2d">Ro</a></td></tr>
<tr class="separator:ab67ae2242d1cd1fd2c1b106b1debff2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20cca02bbe41ebcdba66c9e358c98559"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a20cca02bbe41ebcdba66c9e358c98559">avail_memory</a></td></tr>
<tr class="separator:a20cca02bbe41ebcdba66c9e358c98559"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e8acf7bc77be451a429e9ae8af5c37b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a5e8acf7bc77be451a429e9ae8af5c37b">max_nr_refs_in_memory</a></td></tr>
<tr class="separator:a5e8acf7bc77be451a429e9ae8af5c37b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9562d86a126dcc1d8c50cd861f616d40"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a9562d86a126dcc1d8c50cd861f616d40">max_nr_imgs_in_memory</a></td></tr>
<tr class="separator:a9562d86a126dcc1d8c50cd861f616d40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85cb8e7d09221d99e44a8a2208fd4a22"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a85cb8e7d09221d99e44a8a2208fd4a22">total_nr_refs</a></td></tr>
<tr class="separator:a85cb8e7d09221d99e44a8a2208fd4a22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9043a07e1507976fff101ec37eab8f2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#ae9043a07e1507976fff101ec37eab8f2">counter_refs_in_memory</a></td></tr>
<tr class="separator:ae9043a07e1507976fff101ec37eab8f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd57f432b75da0e346c9c0df1b3e824f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#acd57f432b75da0e346c9c0df1b3e824f">pointer_allrefs2refsinmem</a></td></tr>
<tr class="separator:acd57f432b75da0e346c9c0df1b3e824f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb35527c73b27e78c3ceb5cd3721f195"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#aeb35527c73b27e78c3ceb5cd3721f195">pointer_refsinmem2allrefs</a></td></tr>
<tr class="separator:aeb35527c73b27e78c3ceb5cd3721f195"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2959661621ae5d67cb604302bb91d74"><td class="memItemLeft" align="right" valign="top">std::vector&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#ac2959661621ae5d67cb604302bb91d74">convert_refno_to_stack_position</a></td></tr>
<tr class="separator:ac2959661621ae5d67cb604302bb91d74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14edd79cd809aba3482bddff00f5e6b1"><td class="memItemLeft" align="right" valign="top">std::vector&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a14edd79cd809aba3482bddff00f5e6b1">ids</a></td></tr>
<tr class="separator:a14edd79cd809aba3482bddff00f5e6b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadc634e170de9a09b2870fab90bd0dac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPolar.html">Polar</a>&lt; std::complex&lt; double &gt; &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#aadc634e170de9a09b2870fab90bd0dac">fP_ref</a></td></tr>
<tr class="separator:aadc634e170de9a09b2870fab90bd0dac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee78ecf7a18389e52940b9f4bf5dcff6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPolar.html">Polar</a>&lt; std::complex&lt; double &gt; &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#aee78ecf7a18389e52940b9f4bf5dcff6">fP_img</a></td></tr>
<tr class="separator:aee78ecf7a18389e52940b9f4bf5dcff6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a450a2dfc609d2b3003e3e998878082dc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPolar.html">Polar</a>&lt; std::complex&lt; double &gt; &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a450a2dfc609d2b3003e3e998878082dc">fPm_img</a></td></tr>
<tr class="separator:a450a2dfc609d2b3003e3e998878082dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc2430b6b28898178fb61bb50c1e39c8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#afc2430b6b28898178fb61bb50c1e39c8">proj_ref</a></td></tr>
<tr class="separator:afc2430b6b28898178fb61bb50c1e39c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa27a6cf70fecb56ed13b384161bc5248"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPolar__fftw__plans.html">Polar_fftw_plans</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#aa27a6cf70fecb56ed13b384161bc5248">global_plans</a></td></tr>
<tr class="separator:aa27a6cf70fecb56ed13b384161bc5248"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4840d3dcdfe64b6fd3a02096e6c83573"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a4840d3dcdfe64b6fd3a02096e6c83573">stddev_ref</a></td></tr>
<tr class="separator:a4840d3dcdfe64b6fd3a02096e6c83573"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e644422e07a3dc04ffcc5dbdb34eb52"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a4e644422e07a3dc04ffcc5dbdb34eb52">stddev_img</a></td></tr>
<tr class="separator:a4e644422e07a3dc04ffcc5dbdb34eb52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33132687def0129f4c14fa9c068a0d19"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSampling.html">Sampling</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">mysampling</a></td></tr>
<tr class="separator:a33132687def0129f4c14fa9c068a0d19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ceadd76e62fefe80a4fc832fca2c00f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a9ceadd76e62fefe80a4fc832fca2c00f">loop_forward_refs</a></td></tr>
<tr class="separator:a9ceadd76e62fefe80a4fc832fca2c00f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a989c2a0cdf20f2717d5e80baabfc40e5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a989c2a0cdf20f2717d5e80baabfc40e5">search5d_shift</a></td></tr>
<tr class="separator:a989c2a0cdf20f2717d5e80baabfc40e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ab38e7253df6c449dc6322e4c46b83b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a9ab38e7253df6c449dc6322e4c46b83b">search5d_step</a></td></tr>
<tr class="separator:a9ab38e7253df6c449dc6322e4c46b83b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a186aaabc17af38165deb81586e606cca"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a186aaabc17af38165deb81586e606cca">search5d_xoff</a></td></tr>
<tr class="separator:a186aaabc17af38165deb81586e606cca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f71b2ce22933528a9f18e757ef6efac"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a8f71b2ce22933528a9f18e757ef6efac">search5d_yoff</a></td></tr>
<tr class="separator:a8f71b2ce22933528a9f18e757ef6efac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67bce09ceb3bada415d302b03613d3b9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a67bce09ceb3bada415d302b03613d3b9">Mctf</a></td></tr>
<tr class="separator:a67bce09ceb3bada415d302b03613d3b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac612a8a129d906023ff929ec80552f90"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#ac612a8a129d906023ff929ec80552f90">phase_flipped</a></td></tr>
<tr class="separator:ac612a8a129d906023ff929ec80552f90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac043b262d9dc89979be1587b43dbe937"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#ac043b262d9dc89979be1587b43dbe937">threads</a></td></tr>
<tr class="separator:ac043b262d9dc89979be1587b43dbe937"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7557dbd7c4833be2a957e4775d899ccc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">numOrientations</a></td></tr>
<tr class="separator:a7557dbd7c4833be2a957e4775d899ccc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a037f376e933b93134ca3d6f117e3d756"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a037f376e933b93134ca3d6f117e3d756">nr_trans</a></td></tr>
<tr class="separator:a037f376e933b93134ca3d6f117e3d756"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c2f248db52457e702e7d626ba3e6547"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__Threads.html#ga0b86c483ccff385c24a8a278870af9f7">barrier_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a1c2f248db52457e702e7d626ba3e6547">thread_barrier</a></td></tr>
<tr class="separator:a1c2f248db52457e702e7d626ba3e6547"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed805df963ac159ce0e697ccdec2d976"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#aed805df963ac159ce0e697ccdec2d976">do_scale</a></td></tr>
<tr class="separator:aed805df963ac159ce0e697ccdec2d976"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10583dbac123156edd53f645fe731461"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__MetaData.html#gaf446b6aff4a8c034231bfa3e1484bc47">WriteModeMetaData</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a10583dbac123156edd53f645fe731461">do_overwrite</a></td></tr>
<tr class="separator:a10583dbac123156edd53f645fe731461"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a173d1e4af96024b6af24100bb464d448"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a173d1e4af96024b6af24100bb464d448">scale_step</a></td></tr>
<tr class="separator:a173d1e4af96024b6af24100bb464d448"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59e923cfadebda6ca0585bb4982408fd"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a59e923cfadebda6ca0585bb4982408fd">scale_nsteps</a></td></tr>
<tr class="separator:a59e923cfadebda6ca0585bb4982408fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a725039b9ec19e43bc45afc57bf8b711c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgAngularProjectionMatching.html#a725039b9ec19e43bc45afc57bf8b711c">progress_bar_step</a></td></tr>
<tr class="separator:a725039b9ec19e43bc45afc57bf8b711c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_attribs_classXmippProgram"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_classXmippProgram')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="classXmippProgram.html">XmippProgram</a></td></tr>
<tr class="memitem:ae829d20125d500b80d008ea4b9a0e0bd inherit pub_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#ae829d20125d500b80d008ea4b9a0e0bd">doRun</a></td></tr>
<tr class="separator:ae829d20125d500b80d008ea4b9a0e0bd inherit pub_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41ca5bb0bd76fd8319d3b44459da4bf9 inherit pub_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a41ca5bb0bd76fd8319d3b44459da4bf9">runWithoutArgs</a></td></tr>
<tr class="separator:a41ca5bb0bd76fd8319d3b44459da4bf9 inherit pub_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed62cfe3c074e69076bf348fc101a717 inherit pub_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a></td></tr>
<tr class="memdesc:aed62cfe3c074e69076bf348fc101a717 inherit pub_attribs_classXmippProgram"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verbosity level.  <a href="#aed62cfe3c074e69076bf348fc101a717">More...</a><br /></td></tr>
<tr class="separator:aed62cfe3c074e69076bf348fc101a717 inherit pub_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0130b89f1f5431b03ef161d7e231bd48 inherit pub_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a0130b89f1f5431b03ef161d7e231bd48">debug</a></td></tr>
<tr class="separator:a0130b89f1f5431b03ef161d7e231bd48 inherit pub_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51ae38ef10274f8f7c6c02ab2a67a28c inherit pub_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a51ae38ef10274f8f7c6c02ab2a67a28c">seed</a></td></tr>
<tr class="separator:a51ae38ef10274f8f7c6c02ab2a67a28c inherit pub_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classXmippProgram"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classXmippProgram')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classXmippProgram.html">XmippProgram</a></td></tr>
<tr class="memitem:a95f826fa543dafe9afee959919537f9b inherit pro_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a95f826fa543dafe9afee959919537f9b">defineCommons</a> ()</td></tr>
<tr class="separator:a95f826fa543dafe9afee959919537f9b inherit pro_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classXmippProgram"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classXmippProgram')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classXmippProgram.html">XmippProgram</a></td></tr>
<tr class="memitem:aa8d070e9454a1282137facadd3e45a35 inherit pro_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aa8d070e9454a1282137facadd3e45a35">errorCode</a></td></tr>
<tr class="separator:aa8d070e9454a1282137facadd3e45a35 inherit pro_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba95ed5693ab33d77ae4c184a36e8f61 inherit pro_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classProgramDef.html">ProgramDef</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aba95ed5693ab33d77ae4c184a36e8f61">progDef</a></td></tr>
<tr class="memdesc:aba95ed5693ab33d77ae4c184a36e8f61 inherit pro_attribs_classXmippProgram"><td class="mdescLeft">&#160;</td><td class="mdescRight">Program definition and arguments parser.  <a href="#aba95ed5693ab33d77ae4c184a36e8f61">More...</a><br /></td></tr>
<tr class="separator:aba95ed5693ab33d77ae4c184a36e8f61 inherit pro_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e187353c6a6f9e06d44bbeaa6e872ac inherit pro_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a>, <a class="el" href="classCommentList.html">CommentList</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a5e187353c6a6f9e06d44bbeaa6e872ac">defaultComments</a></td></tr>
<tr class="separator:a5e187353c6a6f9e06d44bbeaa6e872ac inherit pro_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8659f9e603143c1788360f0eeb01e589 inherit pro_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a8659f9e603143c1788360f0eeb01e589">argc</a></td></tr>
<tr class="memdesc:a8659f9e603143c1788360f0eeb01e589 inherit pro_attribs_classXmippProgram"><td class="mdescLeft">&#160;</td><td class="mdescRight">Original command line arguments.  <a href="#a8659f9e603143c1788360f0eeb01e589">More...</a><br /></td></tr>
<tr class="separator:a8659f9e603143c1788360f0eeb01e589 inherit pro_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2f60708934c302e1289c5405109dd45 inherit pro_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">const char **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#af2f60708934c302e1289c5405109dd45">argv</a></td></tr>
<tr class="separator:af2f60708934c302e1289c5405109dd45 inherit pro_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>projection_matching parameters. </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00072">72</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a26213be6c329b9878ee49af5561cf651"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProgAngularProjectionMatching::defineParams </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Define arguments accepted. </p>

<p>Reimplemented from <a class="el" href="classXmippProgram.html#a75ba820f6afd62c89524b497ae9b560d">XmippProgram</a>.</p>

<p>Reimplemented in <a class="el" href="classMpiProgAngularProjectionMatching.html#ae3f28573245994dbed7757e430c86f2a">MpiProgAngularProjectionMatching</a>.</p>

<p>Definition at line <a class="el" href="angular__projection__matching_8cpp_source.html#l00079">79</a> of file <a class="el" href="angular__projection__matching_8cpp_source.html">angular_projection_matching.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;{</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="classXmippProgram.html#a4f396af57519ec443b4656176eb962bf">addUsageLine</a>(<span class="stringliteral">&quot;Perform a discrete angular assignment using projection matching in real space.&quot;</span>);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="classXmippProgram.html#a4f396af57519ec443b4656176eb962bf">addUsageLine</a>(<span class="stringliteral">&quot;This program is relatively fast, using polar coordinates for the in-plane &quot;</span>);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="classXmippProgram.html#a4f396af57519ec443b4656176eb962bf">addUsageLine</a>(<span class="stringliteral">&quot;angular searches and the 5-dimensional search of rotation angles and origin &quot;</span>);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="classXmippProgram.html#a4f396af57519ec443b4656176eb962bf">addUsageLine</a>(<span class="stringliteral">&quot;offsets is broken in two: first the angles are search in a 3D-search; then, &quot;</span>);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="classXmippProgram.html#a4f396af57519ec443b4656176eb962bf">addUsageLine</a>(<span class="stringliteral">&quot;for the optimal orientation the origin offsets are searched (2D).&quot;</span>);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="classXmippProgram.html#a4f396af57519ec443b4656176eb962bf">addUsageLine</a>(<span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="classXmippProgram.html#a4f396af57519ec443b4656176eb962bf">addUsageLine</a>(<span class="stringliteral">&quot;The output of the program consists of a document file with all assigned angles&quot;</span>);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="classXmippProgram.html#a4f396af57519ec443b4656176eb962bf">addUsageLine</a>(<span class="stringliteral">&quot;and rotations. This file also contains a column for the maximum cross-correlation &quot;</span>);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="classXmippProgram.html#a4f396af57519ec443b4656176eb962bf">addUsageLine</a>(<span class="stringliteral">&quot;coefficient. Note that the program does not alter the image headers. &quot;</span>);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="classXmippProgram.html#a4f396af57519ec443b4656176eb962bf">addUsageLine</a>(<span class="stringliteral">&quot;The recommended use of this program is within the python script of the &quot;</span>);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="classXmippProgram.html#a4f396af57519ec443b4656176eb962bf">addUsageLine</a>(<span class="stringliteral">&quot;xmipp_protocol_projmatch.py&quot;</span>);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="classXmippProgram.html#a78cb844dedc5e8f4de8320c9a7c8d0a2">addSeeAlsoLine</a>(<span class="stringliteral">&quot;angular_discrete_assign, angular_continuous_assign, angular_project_library&quot;</span>);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="classXmippProgram.html#a4b8f0a6e1bd09e4dbf56a412101e905e">addExampleLine</a>(<span class="stringliteral">&quot;Example of use: Sample at 2 pixel step size for 5D shift search&quot;</span>,<span class="keyword">false</span>);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="classXmippProgram.html#a4b8f0a6e1bd09e4dbf56a412101e905e">addExampleLine</a>(<span class="stringliteral">&quot;xmipp_angular_projection_matching -i experimental.doc -o assigned_angles.doc --ref reference.stk --search5d_step 2&quot;</span>);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;   -i &lt;doc_file&gt;                : Docfile with input images&quot;</span>);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;   -o &lt;output_filename&gt;         : Output filename&quot;</span>);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;   -r &lt;stackFile&gt;               : Reference projections&quot;</span>);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;     alias --ref;&quot;</span>);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--search5d_shift &lt;s5dshift=0&gt;]: Search range (in +/- pix) for 5D shift search&quot;</span>);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--search5d_step &lt;s5dstep=2&gt;]  : Step size for 5D shift search (in pix)&quot;</span>);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--Ri &lt;ri=1&gt;]               : Inner radius to limit rotational search&quot;</span>);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--Ro &lt;ro=-1&gt;]              : Outer radius to limit rotational search&quot;</span>);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;                        : ro = -1 -&gt; dim/2-1&quot;</span>);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [-s &lt;step=1&gt; &lt;n_steps=3&gt;]    : scale step factor (1 means 0.01 in/de-crements) and number of steps around 1.&quot;</span>);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;                               : with default values: 1 0.01 | 0.02 | 0.03&quot;</span>);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;    alias --scale;&quot;</span>);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;==+Extra parameters==&quot;</span>);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--mem &lt;mem=1&gt;]             : Available memory for reference library (Gb)&quot;</span>);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--max_shift &lt;max_shift=-1&gt;]   : Max. change in origin offset (+/- pixels; neg= no limit)&quot;</span>);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--ctf &lt;filename&gt;]            : CTF to apply to the reference projections, either a&quot;</span>);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;                     : CTF parameter file or a 2D image with the CTF amplitudes&quot;</span>);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--pad &lt;pad=1&gt;]             : Padding factor (for CTF correction only)&quot;</span>);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--phase_flipped]            : Use this if the experimental images have been phase flipped&quot;</span>);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--thr &lt;threads=1&gt;]           : Number of concurrent threads&quot;</span>);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--number_orientations &lt;numOrientations=1&gt;]  : Number of possible orientations for each experimental image&quot;</span>);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--append]                : Append (versus overwrite) data to the output file&quot;</span>);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div><div class="ttc" id="classXmippProgram_html_a78cb844dedc5e8f4de8320c9a7c8d0a2"><div class="ttname"><a href="classXmippProgram.html#a78cb844dedc5e8f4de8320c9a7c8d0a2">XmippProgram::addSeeAlsoLine</a></div><div class="ttdeci">void addSeeAlsoLine(const char *seeAlso)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00346">xmipp_program.cpp:346</a></div></div>
<div class="ttc" id="classXmippProgram_html_a4b8f0a6e1bd09e4dbf56a412101e905e"><div class="ttname"><a href="classXmippProgram.html#a4b8f0a6e1bd09e4dbf56a412101e905e">XmippProgram::addExampleLine</a></div><div class="ttdeci">void addExampleLine(const char *example, bool verbatim=true)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00342">xmipp_program.cpp:342</a></div></div>
<div class="ttc" id="classXmippProgram_html_a4f396af57519ec443b4656176eb962bf"><div class="ttname"><a href="classXmippProgram.html#a4f396af57519ec443b4656176eb962bf">XmippProgram::addUsageLine</a></div><div class="ttdeci">void addUsageLine(const char *line, bool verbatim=false)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00338">xmipp_program.cpp:338</a></div></div>
<div class="ttc" id="classXmippProgram_html_aaeb37f0bac83f5d2a605aaa0e5c4b6ef"><div class="ttname"><a href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">XmippProgram::addParamsLine</a></div><div class="ttdeci">void addParamsLine(const String &amp;line)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00361">xmipp_program.cpp:361</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa1fc871c4f2f0f90e1d4cf62d775c8c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgAngularProjectionMatching::destroyAndClean </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>destroy and clean </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8cpp_source.html#l00193">193</a> of file <a class="el" href="angular__projection__matching_8cpp_source.html">angular_projection_matching.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;{</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keyword">delete</span> [] <a class="code" href="classProgAngularProjectionMatching.html#aadc634e170de9a09b2870fab90bd0dac">fP_ref</a>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keyword">delete</span> [] <a class="code" href="classProgAngularProjectionMatching.html#afc2430b6b28898178fb61bb50c1e39c8">proj_ref</a>;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keyword">delete</span> [] <a class="code" href="classProgAngularProjectionMatching.html#aee78ecf7a18389e52940b9f4bf5dcff6">fP_img</a>;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keyword">delete</span> [] <a class="code" href="classProgAngularProjectionMatching.html#a450a2dfc609d2b3003e3e998878082dc">fPm_img</a>;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keyword">delete</span> [] <a class="code" href="classProgAngularProjectionMatching.html#a4840d3dcdfe64b6fd3a02096e6c83573">stddev_ref</a>;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keyword">delete</span> [] <a class="code" href="classProgAngularProjectionMatching.html#a4e644422e07a3dc04ffcc5dbdb34eb52">stddev_img</a>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;}</div><div class="ttc" id="classProgAngularProjectionMatching_html_afc2430b6b28898178fb61bb50c1e39c8"><div class="ttname"><a href="classProgAngularProjectionMatching.html#afc2430b6b28898178fb61bb50c1e39c8">ProgAngularProjectionMatching::proj_ref</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * proj_ref</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00114">angular_projection_matching.h:114</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aadc634e170de9a09b2870fab90bd0dac"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aadc634e170de9a09b2870fab90bd0dac">ProgAngularProjectionMatching::fP_ref</a></div><div class="ttdeci">Polar&lt; std::complex&lt; double &gt; &gt; * fP_ref</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00112">angular_projection_matching.h:112</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a4840d3dcdfe64b6fd3a02096e6c83573"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a4840d3dcdfe64b6fd3a02096e6c83573">ProgAngularProjectionMatching::stddev_ref</a></div><div class="ttdeci">double * stddev_ref</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00118">angular_projection_matching.h:118</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a450a2dfc609d2b3003e3e998878082dc"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a450a2dfc609d2b3003e3e998878082dc">ProgAngularProjectionMatching::fPm_img</a></div><div class="ttdeci">Polar&lt; std::complex&lt; double &gt; &gt; * fPm_img</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00112">angular_projection_matching.h:112</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a4e644422e07a3dc04ffcc5dbdb34eb52"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a4e644422e07a3dc04ffcc5dbdb34eb52">ProgAngularProjectionMatching::stddev_img</a></div><div class="ttdeci">double * stddev_img</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00118">angular_projection_matching.h:118</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aee78ecf7a18389e52940b9f4bf5dcff6"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aee78ecf7a18389e52940b9f4bf5dcff6">ProgAngularProjectionMatching::fP_img</a></div><div class="ttdeci">Polar&lt; std::complex&lt; double &gt; &gt; * fP_img</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00112">angular_projection_matching.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa00715bc55b889ae05eeeafb17d51d38"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgAngularProjectionMatching::getCurrentImage </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>imgid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classImage.html">Image</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>img</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read current image into memory and translate according to previous optimal Xoff and Yoff </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8cpp_source.html#l01206">1206</a> of file <a class="el" href="angular__projection__matching_8cpp_source.html">angular_projection_matching.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;{</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <a class="code" href="classFileName.html">FileName</a> fn_img;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> A;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="comment">//init A just in case</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    A.<a class="code" href="classMatrix2D.html#a1b0afdb4a10ad1857db3db8b64715ba3">initIdentity</a>(3);</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="comment">// jump to line imgno+1 in DFexp, get data and filename</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a9c3b2ace08c588a370b41162bd04a3ee">DFexp</a>.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a>,fn_img, imgid);</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="comment">// Read actual image</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    img.<a class="code" href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">read</a>(fn_img);</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    img().setXmippOrigin();</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="comment">// Store translation in header and apply it to the actual image</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="comment">//No need to get initial angles since those came with the reference projection</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keywordtype">double</span> shiftX=0., shiftY=0.;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a9c3b2ace08c588a370b41162bd04a3ee">DFexp</a>.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acb3aa7acca32f4524608635e2e09650e">MDL_SHIFT_X</a>,shiftX, imgid);</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a9c3b2ace08c588a370b41162bd04a3ee">DFexp</a>.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab00882fc483e9a1a7e6af5829a6afb8e">MDL_SHIFT_Y</a>,shiftY, imgid);</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    img.<a class="code" href="classImageBase.html#a5f3710649861a2b37b98af50021f71b8">setShifts</a>(shiftX,shiftY);</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <span class="comment">//FIXME ROB</span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="comment">//img.setEulerAngles(0.,0.,psi);</span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    img.<a class="code" href="classImageBase.html#a8ea0cabc10eb710a8a997aa19bfb71a1">setEulerAngles</a>(0.,0.,0);</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    img.<a class="code" href="classImageBase.html#a6b60184c6297bddc60208e71fbba3db3">setFlip</a>(0.);</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="keywordtype">double</span> scale;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    scale = 1.;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classProgAngularProjectionMatching.html#a9c3b2ace08c588a370b41162bd04a3ee">DFexp</a>.<a class="code" href="classMetaData.html#aaf4e9b2a1a10da6c3b0eea0d3349133d">containsLabel</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aad487c1de68c3a3b8f44773ee776d87c">MDL_SCALE</a>))</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#a9c3b2ace08c588a370b41162bd04a3ee">DFexp</a>.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aad487c1de68c3a3b8f44773ee776d87c">MDL_SCALE</a>, scale, imgid);</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    img.<a class="code" href="classImageBase.html#a92804503b6ddca085af4722db25ce1f7">setScale</a>(scale);</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    img.<a class="code" href="classImage.html#a62037480fc6e720bd7eb5a7a099e5d57">getTransformationMatrix</a>(A,<span class="keyword">true</span>);</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    A=A.<a class="code" href="classMatrix2D.html#add8d2052c53fcf6689908614f67b9ee6">inv</a>();</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="comment">//std::cerr &lt;&lt; &quot;DEBUG_ROB, A:&quot; &lt;&lt; A &lt;&lt; std::endl;</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="comment">//img.write(&quot;before.spi&quot;);</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keywordflow">if</span> (!A.<a class="code" href="classMatrix2D.html#aa4b62ee9cbc7a16d480d2a9b90df2758">isIdentity</a>())</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga22035972f95a4f2bf79416b5ebf9d44e">selfApplyGeometry</a>(<a class="code" href="group__GeometricalTransformations.html#gab8a49d8335f45ebd2ba7d86d98322bc0">BSPLINE3</a>, img(), A, <a class="code" href="transformations_8h.html#a855436c9d0ed5174df8917d5239d7597">IS_INV</a>, <a class="code" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a>);</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="comment">//img.write(&quot;after.spi&quot;);</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="comment">//exit(0);</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;}</div><div class="ttc" id="group__GeometricalTransformations_html_ga22035972f95a4f2bf79416b5ebf9d44e"><div class="ttname"><a href="group__GeometricalTransformations.html#ga22035972f95a4f2bf79416b5ebf9d44e">selfApplyGeometry</a></div><div class="ttdeci">void selfApplyGeometry(int Splinedegree, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V1, const Matrix2D&lt; double &gt; &amp;A, bool inv, bool wrap, std::complex&lt; double &gt; outside)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00553">transformations.cpp:553</a></div></div>
<div class="ttc" id="classImageBase_html_a92804503b6ddca085af4722db25ce1f7"><div class="ttname"><a href="classImageBase.html#a92804503b6ddca085af4722db25ce1f7">ImageBase::setScale</a></div><div class="ttdeci">void setScale(double scale, const size_t n=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00727">xmipp_image_base.h:727</a></div></div>
<div class="ttc" id="classMatrix2D_html_add8d2052c53fcf6689908614f67b9ee6"><div class="ttname"><a href="classMatrix2D.html#add8d2052c53fcf6689908614f67b9ee6">Matrix2D::inv</a></div><div class="ttdeci">void inv(Matrix2D&lt; T &gt; &amp;result) const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01648">matrix2d.h:1648</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78acb3aa7acca32f4524608635e2e09650e"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acb3aa7acca32f4524608635e2e09650e">MDL_SHIFT_X</a></div><div class="ttdoc">Shift for the image in the X axis (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00412">metadata_label.h:412</a></div></div>
<div class="ttc" id="transformations_8h_html_a43c1de45dbd91827a260224c9c40221b"><div class="ttname"><a href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a></div><div class="ttdeci">#define WRAP</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00043">transformations.h:43</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00068">xmipp_filename.h:68</a></div></div>
<div class="ttc" id="classMetaData_html_a2239fbb7e492654f1e2866ab27492a5d"><div class="ttname"><a href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">MetaData::getValue</a></div><div class="ttdeci">bool getValue(MDObject &amp;mdValueOut, size_t id) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00217">metadata.cpp:217</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="classMetaData_html_aaf4e9b2a1a10da6c3b0eea0d3349133d"><div class="ttname"><a href="classMetaData.html#aaf4e9b2a1a10da6c3b0eea0d3349133d">MetaData::containsLabel</a></div><div class="ttdeci">bool containsLabel(const MDLabel label) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00707">metadata.cpp:707</a></div></div>
<div class="ttc" id="classImageBase_html_a5f3710649861a2b37b98af50021f71b8"><div class="ttname"><a href="classImageBase.html#a5f3710649861a2b37b98af50021f71b8">ImageBase::setShifts</a></div><div class="ttdeci">void setShifts(double xoff, double yoff, double zoff=0., const size_t n=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00447">xmipp_image_base.cpp:447</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a9c3b2ace08c588a370b41162bd04a3ee"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a9c3b2ace08c588a370b41162bd04a3ee">ProgAngularProjectionMatching::DFexp</a></div><div class="ttdeci">MetaData DFexp</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00080">angular_projection_matching.h:80</a></div></div>
<div class="ttc" id="classImageBase_html_a6b60184c6297bddc60208e71fbba3db3"><div class="ttname"><a href="classImageBase.html#a6b60184c6297bddc60208e71fbba3db3">ImageBase::setFlip</a></div><div class="ttdeci">void setFlip(bool flip, const size_t n=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00741">xmipp_image_base.h:741</a></div></div>
<div class="ttc" id="transformations_8h_html_a855436c9d0ed5174df8917d5239d7597"><div class="ttname"><a href="transformations_8h.html#a855436c9d0ed5174df8917d5239d7597">IS_INV</a></div><div class="ttdeci">#define IS_INV</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00040">transformations.h:40</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78aad487c1de68c3a3b8f44773ee776d87c"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aad487c1de68c3a3b8f44773ee776d87c">MDL_SCALE</a></div><div class="ttdoc">scaling factor for an image or volume (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00385">metadata_label.h:385</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gab8a49d8335f45ebd2ba7d86d98322bc0"><div class="ttname"><a href="group__GeometricalTransformations.html#gab8a49d8335f45ebd2ba7d86d98322bc0">BSPLINE3</a></div><div class="ttdeci">#define BSPLINE3</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00210">transformations.h:210</a></div></div>
<div class="ttc" id="classMatrix2D_html_aa4b62ee9cbc7a16d480d2a9b90df2758"><div class="ttname"><a href="classMatrix2D.html#aa4b62ee9cbc7a16d480d2a9b90df2758">Matrix2D::isIdentity</a></div><div class="ttdeci">bool isIdentity() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01759">matrix2d.h:1759</a></div></div>
<div class="ttc" id="classImageBase_html_a8ea0cabc10eb710a8a997aa19bfb71a1"><div class="ttname"><a href="classImageBase.html#a8ea0cabc10eb710a8a997aa19bfb71a1">ImageBase::setEulerAngles</a></div><div class="ttdeci">void setEulerAngles(double rot, double tilt, double psi, const size_t n=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00427">xmipp_image_base.cpp:427</a></div></div>
<div class="ttc" id="classImage_html_a62037480fc6e720bd7eb5a7a099e5d57"><div class="ttname"><a href="classImage.html#a62037480fc6e720bd7eb5a7a099e5d57">Image::getTransformationMatrix</a></div><div class="ttdeci">void getTransformationMatrix(Matrix2D&lt; double &gt; &amp;A, bool only_apply_shifts=false, const size_t n=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image_8h_source.html#l01115">xmipp_image.h:1115</a></div></div>
<div class="ttc" id="classImageBase_html_a88636b7a7bd4e0e454877e691ee2da84"><div class="ttname"><a href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">ImageBase::read</a></div><div class="ttdeci">int read(const FileName &amp;name, DataMode datamode=DATA, size_t select_img=ALL_IMAGES, bool mapData=false, int mode=WRITE_READONLY)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00061">xmipp_image_base.cpp:61</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab00882fc483e9a1a7e6af5829a6afb8e"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab00882fc483e9a1a7e6af5829a6afb8e">MDL_SHIFT_Y</a></div><div class="ttdoc">Shift for the image in the Y axis (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00415">metadata_label.h:415</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a></div><div class="ttdoc">Name of an image (std::string) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00235">metadata_label.h:235</a></div></div>
<div class="ttc" id="classMatrix2D_html_a1b0afdb4a10ad1857db3db8b64715ba3"><div class="ttname"><a href="classMatrix2D.html#a1b0afdb4a10ad1857db3db8b64715ba3">Matrix2D::initIdentity</a></div><div class="ttdeci">void initIdentity()</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00835">matrix2d.h:835</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2a08cfec5754dfeaa806ea6874fc2139"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgAngularProjectionMatching::getCurrentReference </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>refno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPolar__fftw__plans.html">Polar_fftw_plans</a> &amp;&#160;</td>
          <td class="paramname"><em>local_plans</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get pointer to the current reference image If this image wasn't stored in memory yet, read it from disc and store FT of the polar transform as well as the original image </p>
<p>a delete _DATA_ALL </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8cpp_source.html#l00404">404</a> of file <a class="el" href="angular__projection__matching_8cpp_source.html">angular_projection_matching.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;{</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="classFileName.html">FileName</a>                      fnt;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="classImage.html">Image&lt;double&gt;</a>                 img;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordtype">double</span>                        mean,stddev;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a>         Maux;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="classPolar.html">Polar&lt;double&gt;</a>                 P;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <a class="code" href="classPolar.html">Polar&lt;std::complex &lt;double&gt;</a> &gt; fP;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <a class="code" href="classFourierTransformer.html">FourierTransformer</a>                     local_transformer;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">// Image was not stored yet: read it from disc and store</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="comment">//    std::vector&lt;size_t&gt;::const_iterator found =</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">//        std::find((mysampling.no_redundant_sampling_points_index).begin(),</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">//                  (mysampling.no_redundant_sampling_points_index).end(),</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">//                  (size_t)refno</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">//                 );</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">//    //found = found - (mysampling.no_redundant_sampling_points_index).begin();</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">//    _pointer = found - (mysampling.no_redundant_sampling_points_index).begin();</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">//    if (found == (mysampling.no_redundant_sampling_points_index).end())</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">//        REPORT_ERROR(ERR_VALUE_INCORRECT, &quot;Wrong reference number&quot;);</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">//    fnt.compose(_pointer + FIRST_IMAGE, fn_ref);</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    fnt.<a class="code" href="classFileName.html#ab10d5ada0f956aef14ae171f12587d56">compose</a>(<a class="code" href="classProgAngularProjectionMatching.html#ac2959661621ae5d67cb604302bb91d74">convert_refno_to_stack_position</a>[refno] + <a class="code" href="xmipp__image__macros_8h.html#a351b4f5340ffda2f0414b8bbd9704347">FIRST_IMAGE</a>, <a class="code" href="classProgAngularProjectionMatching.html#aa225d6d9aa1a2349b3fe8bfac7c61be3">fn_ref</a>);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    img.<a class="code" href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">read</a>(fnt, <a class="code" href="group__Images.html#gga22f7d7ee058354c030d2b52a8f190543afda1463ca408cc79db492465781b3269">_DATA_ALL</a>);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    img().setXmippOrigin();</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">//#define DEBUG</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordtype">double</span> rot_tmp,tilt_tmp,psi_tmp;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    img.<a class="code" href="classImageBase.html#ad3e0b1a262029692cbe4a99e377f98ea">getEulerAngles</a>(rot_tmp,tilt_tmp,psi_tmp);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    {</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;index_found: &quot;</span> &lt;&lt; <a class="code" href="classProgAngularProjectionMatching.html#ac2959661621ae5d67cb604302bb91d74">convert_refno_to_stack_position</a>[refno] &lt;&lt; std::endl;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;refno: &quot;</span> &lt;&lt; refno&lt;&lt;std::endl;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;reading image &quot;</span> &lt;&lt; fnt &lt;&lt; std::endl;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;rot_tmp,tilt_tmp,psi_tmp: &quot;</span> &lt;&lt; rot_tmp&lt;&lt; <span class="stringliteral">&quot; &quot;</span>&lt;&lt; tilt_tmp&lt;&lt; <span class="stringliteral">&quot; &quot;</span>&lt;&lt;psi_tmp&lt;&lt; std::endl;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="comment">//        std::cerr &lt;&lt; &quot;XXXXno_redundant_sampling_points_indexXXXXXX&quot; &lt;&lt;std::endl;</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="comment">//        for (std::vector&lt;size_t&gt;::iterator i =</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="comment">//                    mysampling.my_neighbors.begin();</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="comment">//                i != mysampling.my_neighbors.end();</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="comment">//                ++i)</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="comment">//            std::cerr &lt;&lt; *i &lt;&lt; &quot; &quot;;</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        std::cerr &lt;&lt; std::endl;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    }</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="preprocessor">#undef DEBUG</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">// Apply CTF</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgAngularProjectionMatching.html#aca9eed5afc4442b6f6173b8d47046fe6">fn_ctf</a>!=<span class="stringliteral">&quot;&quot;</span>)</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <a class="code" href="classMultidimArray.html">MultidimArray&lt;std::complex&lt;double&gt;</a> &gt; Faux;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgAngularProjectionMatching.html#add0977a6148a63070a4c91eba71ee9cb">paddim</a> &gt; <a class="code" href="classProgAngularProjectionMatching.html#ae5e360b3e048572819d48b76f11df5e9">dim</a>)</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="comment">// pad real-space image</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a> = <a class="code" href="group__Macros.html#gaf809d730a6aa2f55cd4c3d0251f433a7">FIRST_XMIPP_INDEX</a>(<a class="code" href="classProgAngularProjectionMatching.html#add0977a6148a63070a4c91eba71ee9cb">paddim</a>);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a> = <a class="code" href="group__Macros.html#ga37ce421600f14de73f7006bf40cc5b3a">LAST_XMIPP_INDEX</a>(<a class="code" href="classProgAngularProjectionMatching.html#add0977a6148a63070a4c91eba71ee9cb">paddim</a>);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            img().selfWindow(x0, x0, xF,xF);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        }</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        local_transformer.<a class="code" href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransform</a>(img(),Faux);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a>(Faux)</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        {</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(Faux,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) *= <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(<a class="code" href="classProgAngularProjectionMatching.html#a67bce09ceb3bada415d302b03613d3b9">Mctf</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        }</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        local_transformer.<a class="code" href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">inverseFourierTransform</a>(Faux,img());</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgAngularProjectionMatching.html#add0977a6148a63070a4c91eba71ee9cb">paddim</a> &gt; <a class="code" href="classProgAngularProjectionMatching.html#ae5e360b3e048572819d48b76f11df5e9">dim</a>)</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="comment">// de-pad real-space image</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="keywordtype">int</span> x0 = <a class="code" href="group__Macros.html#gaf809d730a6aa2f55cd4c3d0251f433a7">FIRST_XMIPP_INDEX</a>(<a class="code" href="classProgAngularProjectionMatching.html#ae5e360b3e048572819d48b76f11df5e9">dim</a>);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <span class="keywordtype">int</span> xF = <a class="code" href="group__Macros.html#ga37ce421600f14de73f7006bf40cc5b3a">LAST_XMIPP_INDEX</a>(<a class="code" href="classProgAngularProjectionMatching.html#ae5e360b3e048572819d48b76f11df5e9">dim</a>);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            img().selfWindow(x0, x0, xF,xF);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    }</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">// Calculate FTs of polar rings and its stddev</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga007f6aec56f2b0abdb6f4903a22cedf0">produceSplineCoefficients</a>(<a class="code" href="group__GeometricalTransformations.html#gab8a49d8335f45ebd2ba7d86d98322bc0">BSPLINE3</a>,Maux,img());</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    P.<a class="code" href="classPolar.html#a0ade05210836a466416ffcb85eb1dd4e">getPolarFromCartesianBSpline</a>(Maux,<a class="code" href="classProgAngularProjectionMatching.html#a60f6e7892e2cac3c25be6d46a4f9bdc5">Ri</a>,<a class="code" href="classProgAngularProjectionMatching.html#ab67ae2242d1cd1fd2c1b106b1debff2d">Ro</a>);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    P.<a class="code" href="classPolar.html#add7db3d3fc5cbfb787d71d802bf0af10">computeAverageAndStddev</a>(mean,stddev);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    P -= mean;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="group__Polar.html#ga02e5b456ea900d6023ee4170514b9864">fourierTransformRings</a>(P,fP,local_plans,<span class="keyword">true</span>);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    pthread_mutex_lock(  &amp;<a class="code" href="angular__projection__matching_8cpp.html#a410b5f1a0c131dee585b138a6a535b5d">update_refs_in_memory_mutex</a> );</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordtype">int</span> counter = <a class="code" href="classProgAngularProjectionMatching.html#ae9043a07e1507976fff101ec37eab8f2">counter_refs_in_memory</a> % <a class="code" href="classProgAngularProjectionMatching.html#a5e8acf7bc77be451a429e9ae8af5c37b">max_nr_refs_in_memory</a>;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#acd57f432b75da0e346c9c0df1b3e824f">pointer_allrefs2refsinmem</a>[refno] = counter;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgAngularProjectionMatching.html#aeb35527c73b27e78c3ceb5cd3721f195">pointer_refsinmem2allrefs</a>[counter] != -1)</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    {</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="comment">// This position was in use already</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="comment">// Images will be overwritten, so reset the</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="comment">// pointer_allrefs2refsinmem of the old images to -1</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#acd57f432b75da0e346c9c0df1b3e824f">pointer_allrefs2refsinmem</a>[<a class="code" href="classProgAngularProjectionMatching.html#aeb35527c73b27e78c3ceb5cd3721f195">pointer_refsinmem2allrefs</a>[counter]] = -1;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    }</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#aeb35527c73b27e78c3ceb5cd3721f195">pointer_refsinmem2allrefs</a>[counter] = refno;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#aadc634e170de9a09b2870fab90bd0dac">fP_ref</a>[counter] = fP;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a4840d3dcdfe64b6fd3a02096e6c83573">stddev_ref</a>[counter] = stddev;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#afc2430b6b28898178fb61bb50c1e39c8">proj_ref</a>[counter] = img();</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">//#define DEBUG</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    std::cerr&lt;&lt;<span class="stringliteral">&quot;counter= &quot;</span>&lt;&lt;counter&lt;&lt;<span class="stringliteral">&quot;refno= &quot;</span>&lt;&lt;refno&lt;&lt;<span class="stringliteral">&quot; stddev = &quot;</span>&lt;&lt;stddev;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    std::cerr&lt;&lt;<span class="stringliteral">&quot; refsinmem2allrefs= &quot;</span>&lt;&lt;<a class="code" href="classProgAngularProjectionMatching.html#aeb35527c73b27e78c3ceb5cd3721f195">pointer_refsinmem2allrefs</a>[counter];</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    std::cerr&lt;&lt;<span class="stringliteral">&quot; allrefs2refsinmem= &quot;</span>&lt;&lt;<a class="code" href="classProgAngularProjectionMatching.html#acd57f432b75da0e346c9c0df1b3e824f">pointer_allrefs2refsinmem</a>[pointer_refsinmem2allrefs[counter]] &lt;&lt;std::endl;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;pointer_allrefs2refsinmem&quot;</span> &lt;&lt;std::endl;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">for</span> (std::vector&lt;int&gt;::iterator <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = <a class="code" href="classProgAngularProjectionMatching.html#acd57f432b75da0e346c9c0df1b3e824f">pointer_allrefs2refsinmem</a>.begin();</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;         <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> != <a class="code" href="classProgAngularProjectionMatching.html#acd57f432b75da0e346c9c0df1b3e824f">pointer_allrefs2refsinmem</a>.end();</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;         ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        std::cerr &lt;&lt; *<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    std::cerr &lt;&lt;std::endl;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;pointer_refsinmem2allrefs&quot;</span> &lt;&lt;std::endl;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">for</span> (std::vector&lt;int&gt;::iterator <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = pointer_refsinmem2allrefs.begin();</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;         <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> != pointer_refsinmem2allrefs.end();</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;         ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        std::cerr &lt;&lt; *<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    std::cerr &lt;&lt;std::endl;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#ae9043a07e1507976fff101ec37eab8f2">counter_refs_in_memory</a>++;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    pthread_mutex_unlock(  &amp;<a class="code" href="angular__projection__matching_8cpp.html#a410b5f1a0c131dee585b138a6a535b5d">update_refs_in_memory_mutex</a> );</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="comment">//    local_transformer.cleanup();</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;}</div><div class="ttc" id="classProgAngularProjectionMatching_html_ae5e360b3e048572819d48b76f11df5e9"><div class="ttname"><a href="classProgAngularProjectionMatching.html#ae5e360b3e048572819d48b76f11df5e9">ProgAngularProjectionMatching::dim</a></div><div class="ttdeci">size_t dim</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00084">angular_projection_matching.h:84</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_acd57f432b75da0e346c9c0df1b3e824f"><div class="ttname"><a href="classProgAngularProjectionMatching.html#acd57f432b75da0e346c9c0df1b3e824f">ProgAngularProjectionMatching::pointer_allrefs2refsinmem</a></div><div class="ttdeci">std::vector&lt; int &gt; pointer_allrefs2refsinmem</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00105">angular_projection_matching.h:105</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga007f6aec56f2b0abdb6f4903a22cedf0"><div class="ttname"><a href="group__GeometricalTransformations.html#ga007f6aec56f2b0abdb6f4903a22cedf0">produceSplineCoefficients</a></div><div class="ttdeci">void produceSplineCoefficients(int SplineDegree, MultidimArray&lt; double &gt; &amp;coeffs, const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V1)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00576">transformations.cpp:576</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a1c8297f634bb4f9d1235f6c4fa33d7e5"><div class="ttname"><a href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">FourierTransformer::inverseFourierTransform</a></div><div class="ttdeci">void inverseFourierTransform()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00329">xmipp_fftw.cpp:329</a></div></div>
<div class="ttc" id="angular__projection__matching_8cpp_html_a410b5f1a0c131dee585b138a6a535b5d"><div class="ttname"><a href="angular__projection__matching_8cpp.html#a410b5f1a0c131dee585b138a6a535b5d">update_refs_in_memory_mutex</a></div><div class="ttdeci">pthread_mutex_t update_refs_in_memory_mutex</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8cpp_source.html#l00035">angular_projection_matching.cpp:35</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_afc2430b6b28898178fb61bb50c1e39c8"><div class="ttname"><a href="classProgAngularProjectionMatching.html#afc2430b6b28898178fb61bb50c1e39c8">ProgAngularProjectionMatching::proj_ref</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * proj_ref</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00114">angular_projection_matching.h:114</a></div></div>
<div class="ttc" id="classFileName_html_ab10d5ada0f956aef14ae171f12587d56"><div class="ttname"><a href="classFileName.html#ab10d5ada0f956aef14ae171f12587d56">FileName::compose</a></div><div class="ttdeci">void compose(const String &amp;str, const size_t no, const String &amp;ext=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8cpp_source.html#l00049">xmipp_filename.cpp:49</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aadc634e170de9a09b2870fab90bd0dac"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aadc634e170de9a09b2870fab90bd0dac">ProgAngularProjectionMatching::fP_ref</a></div><div class="ttdeci">Polar&lt; std::complex&lt; double &gt; &gt; * fP_ref</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00112">angular_projection_matching.h:112</a></div></div>
<div class="ttc" id="group__Images_html_gga22f7d7ee058354c030d2b52a8f190543afda1463ca408cc79db492465781b3269"><div class="ttname"><a href="group__Images.html#gga22f7d7ee058354c030d2b52a8f190543afda1463ca408cc79db492465781b3269">_DATA_ALL</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00084">xmipp_image_base.h:84</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aca9eed5afc4442b6f6173b8d47046fe6"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aca9eed5afc4442b6f6173b8d47046fe6">ProgAngularProjectionMatching::fn_ctf</a></div><div class="ttdeci">FileName fn_ctf</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00078">angular_projection_matching.h:78</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00068">xmipp_filename.h:68</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_add0977a6148a63070a4c91eba71ee9cb"><div class="ttname"><a href="classProgAngularProjectionMatching.html#add0977a6148a63070a4c91eba71ee9cb">ProgAngularProjectionMatching::paddim</a></div><div class="ttdeci">size_t paddim</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00084">angular_projection_matching.h:84</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aa225d6d9aa1a2349b3fe8bfac7c61be3"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aa225d6d9aa1a2349b3fe8bfac7c61be3">ProgAngularProjectionMatching::fn_ref</a></div><div class="ttdeci">FileName fn_ref</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00078">angular_projection_matching.h:78</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classFourierTransformer_html"><div class="ttname"><a href="classFourierTransformer.html">FourierTransformer</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00060">xmipp_fftw.h:60</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="classPolar_html_a0ade05210836a466416ffcb85eb1dd4e"><div class="ttname"><a href="classPolar.html#a0ade05210836a466416ffcb85eb1dd4e">Polar::getPolarFromCartesianBSpline</a></div><div class="ttdeci">void getPolarFromCartesianBSpline(const MultidimArray&lt; T &gt; &amp;M1, int first_ring, int last_ring, int BsplineOrder=3, double xoff=0., double yoff=0., double oversample1=1., int mode1=FULL_CIRCLES)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00615">polar.h:615</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a4840d3dcdfe64b6fd3a02096e6c83573"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a4840d3dcdfe64b6fd3a02096e6c83573">ProgAngularProjectionMatching::stddev_ref</a></div><div class="ttdeci">double * stddev_ref</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00118">angular_projection_matching.h:118</a></div></div>
<div class="ttc" id="classImageBase_html_ad3e0b1a262029692cbe4a99e377f98ea"><div class="ttname"><a href="classImageBase.html#ad3e0b1a262029692cbe4a99e377f98ea">ImageBase::getEulerAngles</a></div><div class="ttdeci">void getEulerAngles(double &amp;rot, double &amp;tilt, double &amp;psi, const size_t n=0) const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00437">xmipp_image_base.cpp:437</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gafa02b309a507bf04daf9f31fa828ce4f"><div class="ttname"><a href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a></div><div class="ttdeci">#define dAij(M, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00355">multidim_array.h:355</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gab8a49d8335f45ebd2ba7d86d98322bc0"><div class="ttname"><a href="group__GeometricalTransformations.html#gab8a49d8335f45ebd2ba7d86d98322bc0">BSPLINE3</a></div><div class="ttdeci">#define BSPLINE3</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00210">transformations.h:210</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a8f613ddaea2048e3471a1f4f04ba4b79"><div class="ttname"><a href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a></div><div class="ttdeci">#define xF</div></div>
<div class="ttc" id="classFourierTransformer_html_abfdc5699d3c579a26bba39ec679b5adc"><div class="ttname"><a href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransformer::FourierTransform</a></div><div class="ttdeci">void FourierTransform(T &amp;v, T1 &amp;V, bool getCopy=true)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00166">xmipp_fftw.h:166</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a5e8acf7bc77be451a429e9ae8af5c37b"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a5e8acf7bc77be451a429e9ae8af5c37b">ProgAngularProjectionMatching::max_nr_refs_in_memory</a></div><div class="ttdeci">int max_nr_refs_in_memory</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00094">angular_projection_matching.h:94</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Polar_html_ga02e5b456ea900d6023ee4170514b9864"><div class="ttname"><a href="group__Polar.html#ga02e5b456ea900d6023ee4170514b9864">fourierTransformRings</a></div><div class="ttdeci">void fourierTransformRings(Polar&lt; double &gt; &amp;in, Polar&lt; std::complex&lt; double &gt; &gt; &amp;out, Polar_fftw_plans &amp;plans, bool conjugated)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8cpp_source.html#l00033">polar.cpp:33</a></div></div>
<div class="ttc" id="classPolar_html"><div class="ttname"><a href="classPolar.html">Polar</a></div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00061">polar.h:61</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4e8db4e5757ca2f6e233d0a1eec7ff1c"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00519">multidim_array.h:519</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_ab67ae2242d1cd1fd2c1b106b1debff2d"><div class="ttname"><a href="classProgAngularProjectionMatching.html#ab67ae2242d1cd1fd2c1b106b1debff2d">ProgAngularProjectionMatching::Ro</a></div><div class="ttdeci">int Ro</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00090">angular_projection_matching.h:90</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aeb35527c73b27e78c3ceb5cd3721f195"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aeb35527c73b27e78c3ceb5cd3721f195">ProgAngularProjectionMatching::pointer_refsinmem2allrefs</a></div><div class="ttdeci">std::vector&lt; int &gt; pointer_refsinmem2allrefs</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00106">angular_projection_matching.h:106</a></div></div>
<div class="ttc" id="group__Macros_html_gaf809d730a6aa2f55cd4c3d0251f433a7"><div class="ttname"><a href="group__Macros.html#gaf809d730a6aa2f55cd4c3d0251f433a7">FIRST_XMIPP_INDEX</a></div><div class="ttdeci">#define FIRST_XMIPP_INDEX(size)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00439">xmipp_macros.h:439</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_ac2959661621ae5d67cb604302bb91d74"><div class="ttname"><a href="classProgAngularProjectionMatching.html#ac2959661621ae5d67cb604302bb91d74">ProgAngularProjectionMatching::convert_refno_to_stack_position</a></div><div class="ttdeci">std::vector&lt; size_t &gt; convert_refno_to_stack_position</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00108">angular_projection_matching.h:108</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_ae9043a07e1507976fff101ec37eab8f2"><div class="ttname"><a href="classProgAngularProjectionMatching.html#ae9043a07e1507976fff101ec37eab8f2">ProgAngularProjectionMatching::counter_refs_in_memory</a></div><div class="ttdeci">int counter_refs_in_memory</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00103">angular_projection_matching.h:103</a></div></div>
<div class="ttc" id="classImageBase_html_a88636b7a7bd4e0e454877e691ee2da84"><div class="ttname"><a href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">ImageBase::read</a></div><div class="ttdeci">int read(const FileName &amp;name, DataMode datamode=DATA, size_t select_img=ALL_IMAGES, bool mapData=false, int mode=WRITE_READONLY)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00061">xmipp_image_base.cpp:61</a></div></div>
<div class="ttc" id="xmipp__image__macros_8h_html_a351b4f5340ffda2f0414b8bbd9704347"><div class="ttname"><a href="xmipp__image__macros_8h.html#a351b4f5340ffda2f0414b8bbd9704347">FIRST_IMAGE</a></div><div class="ttdeci">#define FIRST_IMAGE</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__macros_8h_source.html#l00038">xmipp_image_macros.h:38</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a67bce09ceb3bada415d302b03613d3b9"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a67bce09ceb3bada415d302b03613d3b9">ProgAngularProjectionMatching::Mctf</a></div><div class="ttdeci">MultidimArray&lt; double &gt; Mctf</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00131">angular_projection_matching.h:131</a></div></div>
<div class="ttc" id="group__Macros_html_ga37ce421600f14de73f7006bf40cc5b3a"><div class="ttname"><a href="group__Macros.html#ga37ce421600f14de73f7006bf40cc5b3a">LAST_XMIPP_INDEX</a></div><div class="ttdeci">#define LAST_XMIPP_INDEX(size)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00448">xmipp_macros.h:448</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a60f6e7892e2cac3c25be6d46a4f9bdc5"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a60f6e7892e2cac3c25be6d46a4f9bdc5">ProgAngularProjectionMatching::Ri</a></div><div class="ttdeci">int Ri</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00090">angular_projection_matching.h:90</a></div></div>
<div class="ttc" id="classPolar_html_add7db3d3fc5cbfb787d71d802bf0af10"><div class="ttname"><a href="classPolar.html#add7db3d3fc5cbfb787d71d802bf0af10">Polar::computeAverageAndStddev</a></div><div class="ttdeci">void computeAverageAndStddev(double &amp;avg, double &amp;stddev, int mode=FULL_CIRCLES) const </div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00482">polar.h:482</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7247ba61ac3387ec73ba05fbe9d5dfef"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProgAngularProjectionMatching::processAllImages </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get images to process. This function will return the id's of images to process. It will be specially useful for MPI case when images will be distributed by the master node. Return false if there aren't more images to process </p>

<p>Reimplemented in <a class="el" href="classMpiProgAngularProjectionMatching.html#a7d0a1d3944140bb185991bcefcb11517">MpiProgAngularProjectionMatching</a>.</p>

<p>Definition at line <a class="el" href="angular__projection__matching_8cpp_source.html#l00974">974</a> of file <a class="el" href="angular__projection__matching_8cpp_source.html">angular_projection_matching.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;{</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="comment">//Init progress bar</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="keywordtype">size_t</span> total_number_of_images = <a class="code" href="classProgAngularProjectionMatching.html#a9c3b2ace08c588a370b41162bd04a3ee">DFexp</a>.<a class="code" href="classMetaData.html#ad844b6a5655be4205e4bb03ab6372562">size</a>();</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a>)</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#a725039b9ec19e43bc45afc57bf8b711c">progress_bar_step</a> = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(1, total_number_of_images / 80);</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <a class="code" href="group__GeneralFunctions.html#ga8c220fe710ecdb4f9b1696dd53e20ff3">init_progress_bar</a>(total_number_of_images);</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    }</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#aa2fa75dd517979963de1bf15cc6878cb">processSomeImages</a>(<a class="code" href="classProgAngularProjectionMatching.html#a14edd79cd809aba3482bddff00f5e6b1">ids</a>);</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a>)</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        <a class="code" href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a>(total_number_of_images);</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;}</div><div class="ttc" id="group__GeneralFunctions_html_ga8c220fe710ecdb4f9b1696dd53e20ff3"><div class="ttname"><a href="group__GeneralFunctions.html#ga8c220fe710ecdb4f9b1696dd53e20ff3">init_progress_bar</a></div><div class="ttdeci">void init_progress_bar(long total)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00773">xmipp_funcs.cpp:773</a></div></div>
<div class="ttc" id="group__Macros_html_gae0a4180e923e3ffca3989e20e441aa3c"><div class="ttname"><a href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a></div><div class="ttdeci">#define XMIPP_MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00193">xmipp_macros.h:193</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a14edd79cd809aba3482bddff00f5e6b1"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a14edd79cd809aba3482bddff00f5e6b1">ProgAngularProjectionMatching::ids</a></div><div class="ttdeci">std::vector&lt; size_t &gt; ids</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00110">angular_projection_matching.h:110</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aa2fa75dd517979963de1bf15cc6878cb"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aa2fa75dd517979963de1bf15cc6878cb">ProgAngularProjectionMatching::processSomeImages</a></div><div class="ttdeci">void processSomeImages(const std::vector&lt; size_t &gt; &amp;imagesToProcess)</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8cpp_source.html#l00988">angular_projection_matching.cpp:988</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a9c3b2ace08c588a370b41162bd04a3ee"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a9c3b2ace08c588a370b41162bd04a3ee">ProgAngularProjectionMatching::DFexp</a></div><div class="ttdeci">MetaData DFexp</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00080">angular_projection_matching.h:80</a></div></div>
<div class="ttc" id="classMetaData_html_ad844b6a5655be4205e4bb03ab6372562"><div class="ttname"><a href="classMetaData.html#ad844b6a5655be4205e4bb03ab6372562">MetaData::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00702">metadata.cpp:702</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga3bdba82f045e73fb216c6be539e6b129"><div class="ttname"><a href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a></div><div class="ttdeci">void progress_bar(long rlen)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00782">xmipp_funcs.cpp:782</a></div></div>
<div class="ttc" id="classXmippProgram_html_aed62cfe3c074e69076bf348fc101a717"><div class="ttname"><a href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">XmippProgram::verbose</a></div><div class="ttdeci">int verbose</div><div class="ttdoc">Verbosity level. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8h_source.html#l00168">xmipp_program.h:168</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a725039b9ec19e43bc45afc57bf8b711c"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a725039b9ec19e43bc45afc57bf8b711c">ProgAngularProjectionMatching::progress_bar_step</a></div><div class="ttdeci">int progress_bar_step</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00150">angular_projection_matching.h:150</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa2fa75dd517979963de1bf15cc6878cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgAngularProjectionMatching::processSomeImages </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>imagesToProcess</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Loop over all images </p>
<p>a </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8cpp_source.html#l00988">988</a> of file <a class="el" href="angular__projection__matching_8cpp_source.html">angular_projection_matching.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;{</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <a class="code" href="classImage.html">Image&lt;double&gt;</a> img;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="comment">//double</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="comment">//opt_rot=0.,</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            <span class="comment">//opt_tilt=0.;</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                     <span class="comment">//opt_psi=0.,</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                             <span class="comment">//opt_xoff=0.,</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                                      <span class="comment">//opt_yoff=0.,</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                                               <span class="comment">//opt_scale=0.;</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                                                         <span class="comment">//maxcorr=-99.e99;</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keywordtype">bool</span> * opt_flip; <span class="comment">//=false;</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordtype">int</span> * opt_refno; <span class="comment">//-1;</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keywordtype">double</span> * opt_psi;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keywordtype">double</span> * maxcorr;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="keywordtype">double</span> * opt_xoff;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="keywordtype">double</span> * opt_yoff;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="keywordtype">double</span> * opt_scale;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="keywordtype">double</span> * opt_rot;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="keywordtype">double</span> * opt_tilt;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="keywordtype">size_t</span> itemId=0;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="keywordtype">size_t</span> nr_images = imagesToProcess.size();</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="keywordtype">size_t</span> idNew, imgid;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <a class="code" href="classFileName.html">FileName</a> fn;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="comment">// Call threads to calculate the rotational alignment of each image in the selfile</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    pthread_t * th_ids = (pthread_t *)malloc( <a class="code" href="classProgAngularProjectionMatching.html#ac043b262d9dc89979be1587b43dbe937">threads</a> * <span class="keyword">sizeof</span>( pthread_t));</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    opt_refno = (<span class="keywordtype">int</span> *)malloc (<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*<a class="code" href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">numOrientations</a>);</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    opt_psi   = (<span class="keywordtype">double</span> *)calloc (<a class="code" href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">numOrientations</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    opt_flip = (<span class="keywordtype">bool</span> *)calloc (<a class="code" href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">numOrientations</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">bool</span>));</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    maxcorr   = (<span class="keywordtype">double</span> *)malloc (<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*<a class="code" href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">numOrientations</a>);</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    opt_xoff   = (<span class="keywordtype">double</span> *)calloc (<a class="code" href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">numOrientations</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    opt_yoff   = (<span class="keywordtype">double</span> *)calloc (<a class="code" href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">numOrientations</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    opt_scale   = (<span class="keywordtype">double</span> *)malloc (<a class="code" href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">numOrientations</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    opt_rot   = (<span class="keywordtype">double</span> *)calloc (<a class="code" href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">numOrientations</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    opt_tilt   = (<span class="keywordtype">double</span> *)calloc (<a class="code" href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">numOrientations</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="comment">// Allocate threads.</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <a class="code" href="structstructThreadRotationallyAlignOneImage.html">structThreadRotationallyAlignOneImage</a> * threads_d = (<a class="code" href="structstructThreadRotationallyAlignOneImage.html">structThreadRotationallyAlignOneImage</a> *)</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            malloc ( <a class="code" href="classProgAngularProjectionMatching.html#ac043b262d9dc89979be1587b43dbe937">threads</a> * <span class="keyword">sizeof</span>( <a class="code" href="structstructThreadRotationallyAlignOneImage.html">structThreadRotationallyAlignOneImage</a> ) );</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="comment">// Allocate threads vectors.</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> = 0 ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> &lt; <a class="code" href="classProgAngularProjectionMatching.html#ac043b262d9dc89979be1587b43dbe937">threads</a> ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>++ )</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    {</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structstructThreadRotationallyAlignOneImage.html#ab9bcda7c32f743dbdc1e8104509774cf">opt_refno</a> = (<span class="keywordtype">int</span> *)malloc (<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*<a class="code" href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">numOrientations</a>);</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structstructThreadRotationallyAlignOneImage.html#a630de636706fad22b0c9f3744b4f2b5a">opt_psi</a> =  (<span class="keywordtype">double</span> *)malloc (<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*<a class="code" href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">numOrientations</a>);</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structstructThreadRotationallyAlignOneImage.html#a766da16bdf19c3173d1e27d3af64bbe2">opt_flip</a> =  (<span class="keywordtype">bool</span> *) malloc (<span class="keyword">sizeof</span>(<span class="keywordtype">bool</span>)*<a class="code" href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">numOrientations</a>);</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structstructThreadRotationallyAlignOneImage.html#a961fced4c0b3ab6e3423fe9e071b05ad">maxcorr</a> =  (<span class="keywordtype">double</span> *)malloc (<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*<a class="code" href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">numOrientations</a>);</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structstructThreadRotationallyAlignOneImage.html#a306e01fa086a78cde92c242c90d6ebf1">numOrientations</a> = <a class="code" href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">numOrientations</a>;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    }</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imgno = 0; imgno &lt; nr_images; imgno++)</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    {</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        imgid = imagesToProcess[imgno];</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        </div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        <a class="code" href="classFileName.html">FileName</a> <a class="code" href="ml2d_8cpp.html#ac5586dc09402e07fc907631409d0ff6d">pp</a>;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#a9c3b2ace08c588a370b41162bd04a3ee">DFexp</a>.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a>,pp, imgid);</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#aa00715bc55b889ae05eeeafb17d51d38">getCurrentImage</a>(imgid, img);</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> = 0 ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> &lt; <a class="code" href="classProgAngularProjectionMatching.html#ac043b262d9dc89979be1587b43dbe937">threads</a> ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>++ )</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        {</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structstructThreadRotationallyAlignOneImage.html#ac576f5e1976c1d30bc82a0652fc61c42">thread_id</a> = <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structstructThreadRotationallyAlignOneImage.html#a3f7961589328756580c04e12df0fc88e">prm</a> = <span class="keyword">this</span>;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structstructThreadRotationallyAlignOneImage.html#a6a402ccb5ea7eb3a9c0d0cc815205f83">img</a> = &amp;img();</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;            threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structstructThreadRotationallyAlignOneImage.html#aea9cb7ed822aba91d3c914c803f0edd6">this_image</a> = imgid;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">numOrientations</a> ;<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;            {</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structstructThreadRotationallyAlignOneImage.html#a961fced4c0b3ab6e3423fe9e071b05ad">maxcorr</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = -99.e99;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structstructThreadRotationallyAlignOneImage.html#ab9bcda7c32f743dbdc1e8104509774cf">opt_refno</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = -1;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                opt_scale[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 1;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                opt_refno[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = -1;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;            }</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;            pthread_create( (th_ids+<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>), NULL, <a class="code" href="angular__projection__matching_8cpp.html#a623b06eaa17f3ec38703913ffeb405b6">threadRotationallyAlignOneImage</a>, (<span class="keywordtype">void</span> *)(threads_d+<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>) );</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        }</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        <span class="comment">// Wait for threads to finish</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> = 0 ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> &lt; <a class="code" href="classProgAngularProjectionMatching.html#ac043b262d9dc89979be1587b43dbe937">threads</a> ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>++ )</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            pthread_join(*(th_ids+<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>),NULL);</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <span class="comment">//Get optimal refno, psi, flip and maxcorr</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <span class="keywordtype">int</span> * indexThreads = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classProgAngularProjectionMatching.html#ac043b262d9dc89979be1587b43dbe937">threads</a>](); <span class="comment">// init to zero</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="keywordtype">size_t</span> bestThreadCorr = 0;</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <span class="keywordtype">double</span> tempCorr;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        <span class="keywordtype">size_t</span> counterValidCorrs = 0;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="keywordtype">bool</span> validCorr = <span class="keyword">false</span>;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = 0 ; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> &lt; <a class="code" href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">numOrientations</a> ; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>++ )</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        {</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            tempCorr = -99.e99;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;            validCorr = <span class="keyword">false</span>;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            <span class="keywordflow">for</span>( <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> = 0 ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> &lt; <a class="code" href="classProgAngularProjectionMatching.html#ac043b262d9dc89979be1587b43dbe937">threads</a> ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>++ )</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            {</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                <span class="keywordflow">if</span> (threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].maxcorr[indexThreads[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>]] &gt; tempCorr)</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                {</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                    <span class="keywordflow">if</span> (not validCorr)</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                    {</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                        counterValidCorrs++;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                        validCorr = <span class="keyword">true</span>;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                    }</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                    bestThreadCorr = <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                    tempCorr = threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structstructThreadRotationallyAlignOneImage.html#a961fced4c0b3ab6e3423fe9e071b05ad">maxcorr</a>[indexThreads[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>]];</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                }</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            }</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            <span class="keywordflow">if</span> (not validCorr)</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            opt_refno[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>] = threads_d[bestThreadCorr].<a class="code" href="structstructThreadRotationallyAlignOneImage.html#ab9bcda7c32f743dbdc1e8104509774cf">opt_refno</a>[indexThreads[bestThreadCorr]];</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            opt_psi[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>] = threads_d[bestThreadCorr].<a class="code" href="structstructThreadRotationallyAlignOneImage.html#a630de636706fad22b0c9f3744b4f2b5a">opt_psi</a>[indexThreads[bestThreadCorr]];</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            opt_flip[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>] = threads_d[bestThreadCorr].<a class="code" href="structstructThreadRotationallyAlignOneImage.html#a766da16bdf19c3173d1e27d3af64bbe2">opt_flip</a>[indexThreads[bestThreadCorr]];</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            maxcorr[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>] = threads_d[bestThreadCorr].<a class="code" href="structstructThreadRotationallyAlignOneImage.html#a961fced4c0b3ab6e3423fe9e071b05ad">maxcorr</a>[indexThreads[bestThreadCorr]];</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            indexThreads[bestThreadCorr]++;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            <span class="keywordflow">if</span> (opt_refno[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>]&gt;=0)</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            {</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                opt_rot[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>]  = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(<a class="code" href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">mysampling</a>.<a class="code" href="classSampling.html#aab3b11080881b21b6de327a8f86d5d71">no_redundant_sampling_points_angles</a>[<a class="code" href="classProgAngularProjectionMatching.html#ac2959661621ae5d67cb604302bb91d74">convert_refno_to_stack_position</a>[opt_refno[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>]]]);</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                opt_tilt[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>] = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(<a class="code" href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">mysampling</a>.<a class="code" href="classSampling.html#aab3b11080881b21b6de327a8f86d5d71">no_redundant_sampling_points_angles</a>[<a class="code" href="classProgAngularProjectionMatching.html#ac2959661621ae5d67cb604302bb91d74">convert_refno_to_stack_position</a>[opt_refno[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>]]]);</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            }</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            {</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                opt_rot[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>]=0;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                opt_tilt[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>]=0;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            }</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        }</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <span class="keyword">delete</span>[] indexThreads;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <span class="comment">// Flip order to loop through references</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#a9ceadd76e62fefe80a4fc832fca2c00f">loop_forward_refs</a> = !<a class="code" href="classProgAngularProjectionMatching.html#a9ceadd76e62fefe80a4fc832fca2c00f">loop_forward_refs</a>;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        <span class="comment">//#define DEBUG</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;DEBUG_ROB, img.name():&quot;</span> &lt;&lt; img.<a class="code" href="classImageBase.html#a4f3c0fee82de6352f6d82d717e532a2b">name</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="preprocessor">#undef DEBUG</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>=0; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> &lt; counterValidCorrs; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>++)</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        {</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            <span class="comment">//std::cout &lt;&lt; &quot; &quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            <span class="comment">//std::cout &lt;&lt; maxcorr[n] &lt;&lt; std::endl;</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;            <a class="code" href="classProgAngularProjectionMatching.html#afa1d2a0ad80c2deae0e33de00fb7af6d">translationallyAlignOneImage</a>(img(),</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                                         opt_refno[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>],</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                                         opt_psi[n],</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                                         opt_flip[n],</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                                         opt_xoff[n],</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                                         opt_yoff[n],</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                                         maxcorr[n]);</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;            <span class="comment">//std::cout &lt;&lt; maxcorr[n] &lt;&lt; std::endl;</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classProgAngularProjectionMatching.html#aed805df963ac159ce0e697ccdec2d976">do_scale</a> &amp;&amp; <a class="code" href="classProgAngularProjectionMatching.html#a59e923cfadebda6ca0585bb4982408fd">scale_nsteps</a> &gt; 0)</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            {</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                <span class="comment">// Compute a better scale (scale_min -&gt; scale_max)</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                <a class="code" href="classProgAngularProjectionMatching.html#a060fce387f382e53d5f216fdd4ed404a">scaleAlignOneImage</a>(img(), opt_refno[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>], opt_psi[n], opt_flip[n], opt_xoff[n], opt_yoff[n], img.<a class="code" href="classImageBase.html#a6b0ee50530b957aae3730106e414f901">scale</a>(), opt_scale[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>], maxcorr[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>]);</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;            }</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            <span class="comment">//Add the previously applied scale to the newly found one</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            opt_scale[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>] *= img.<a class="code" href="classImageBase.html#a6b0ee50530b957aae3730106e414f901">scale</a>();</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;            <span class="comment">// Divide opt_shifts by old_scale</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            <span class="comment">// Add previously applied translation to the newly found one</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            opt_xoff[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>] += img.<a class="code" href="classImageBase.html#a45407967b3b3ee97d4e02affa460d78f">Xoff</a>();</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;            opt_yoff[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>] += img.<a class="code" href="classImageBase.html#aee9ff7df52c343fd74630256d5814fcc">Yoff</a>();</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            <span class="comment">// Output</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            <a class="code" href="classProgAngularProjectionMatching.html#a9c3b2ace08c588a370b41162bd04a3ee">DFexp</a>.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a>, fn, imgid);</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;            <a class="code" href="classProgAngularProjectionMatching.html#a9c3b2ace08c588a370b41162bd04a3ee">DFexp</a>.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a4742d43b4d22ebf65a3312767ea9b10d">MDL_ITEM_ID</a>, itemId, imgid);</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;            idNew = <a class="code" href="classProgAngularProjectionMatching.html#a6f0c8469a0fc03f6655791daba88a7a7">DFo</a>.<a class="code" href="classMetaData.html#acd6018636eda733443f3df6c61978faa">addObject</a>();</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            <a class="code" href="classProgAngularProjectionMatching.html#a6f0c8469a0fc03f6655791daba88a7a7">DFo</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a4742d43b4d22ebf65a3312767ea9b10d">MDL_ITEM_ID</a>,itemId,idNew);</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            <a class="code" href="classProgAngularProjectionMatching.html#a6f0c8469a0fc03f6655791daba88a7a7">DFo</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a>, fn,idNew);</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            <a class="code" href="classProgAngularProjectionMatching.html#a6f0c8469a0fc03f6655791daba88a7a7">DFo</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a59fffce298c0f99a1d592544d3d39a08">MDL_ANGLE_ROT</a>, opt_rot[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>],idNew);</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            <a class="code" href="classProgAngularProjectionMatching.html#a6f0c8469a0fc03f6655791daba88a7a7">DFo</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac15f836e18a2035d2923ecf76c6e8c7f">MDL_ANGLE_TILT</a>,opt_tilt[n],idNew);</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            <a class="code" href="classProgAngularProjectionMatching.html#a6f0c8469a0fc03f6655791daba88a7a7">DFo</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a114e3414dd216e4308946a016b5cc46f">MDL_ANGLE_PSI</a>, opt_psi[n],idNew);</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            </div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;            <span class="comment">//opt_xoff=0;</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            <a class="code" href="classProgAngularProjectionMatching.html#a6f0c8469a0fc03f6655791daba88a7a7">DFo</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acb3aa7acca32f4524608635e2e09650e">MDL_SHIFT_X</a>,   opt_xoff[n],idNew);</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            <a class="code" href="classProgAngularProjectionMatching.html#a6f0c8469a0fc03f6655791daba88a7a7">DFo</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab00882fc483e9a1a7e6af5829a6afb8e">MDL_SHIFT_Y</a>,   opt_yoff[n],idNew);</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            <a class="code" href="classProgAngularProjectionMatching.html#a6f0c8469a0fc03f6655791daba88a7a7">DFo</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a3637da3214664c45458ae3e56a92c88e">MDL_REF</a>,      opt_refno[n] <span class="comment">/*+ FIRST_IMAGE*/</span>,idNew);</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            <a class="code" href="classProgAngularProjectionMatching.html#a6f0c8469a0fc03f6655791daba88a7a7">DFo</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af6495a877b8c80b9c45b8156b406b183">MDL_FLIP</a>,     opt_flip[n],idNew);</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;            <a class="code" href="classProgAngularProjectionMatching.html#a6f0c8469a0fc03f6655791daba88a7a7">DFo</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aad487c1de68c3a3b8f44773ee776d87c">MDL_SCALE</a>,    opt_scale[n],idNew);</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;            <a class="code" href="classProgAngularProjectionMatching.html#a6f0c8469a0fc03f6655791daba88a7a7">DFo</a>.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a13a2ae711ddad715bec00dcfb45d39e7">MDL_MAXCC</a>,    maxcorr[n],idNew);</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        }</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;        <span class="comment">/* FIXME ROB     */</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;        <span class="comment">//opt_psi += img.psi();</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        <span class="comment">/*         */</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        <span class="comment">//opt_scale=1.0;</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a> &amp;&amp; imgno % <a class="code" href="classProgAngularProjectionMatching.html#a725039b9ec19e43bc45afc57bf8b711c">progress_bar_step</a> == 0)</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            <a class="code" href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a>(imgno);</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        <span class="comment">//#endif</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        <span class="comment">//DFo.write(&quot;/dev/stderr&quot;);</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    }<span class="comment">//loop over images</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a>(th_ids);</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> = 0 ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> &lt; <a class="code" href="classProgAngularProjectionMatching.html#ac043b262d9dc89979be1587b43dbe937">threads</a> ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>++ )</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    {</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a>(threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].opt_refno);</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a>(threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].opt_psi);</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a>(threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].opt_flip);</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a>(threads_d[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].maxcorr);</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    }</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a>(opt_refno);</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a>(opt_psi);</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a>(opt_flip);</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a>(maxcorr);</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a>(opt_xoff);</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a>(opt_yoff);</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a>(opt_scale);</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a>(opt_rot);</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a>(opt_tilt);</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a>(threads_d);</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;}<span class="comment">//function processSomeImages</span></div><div class="ttc" id="classProgAngularProjectionMatching_html_a59e923cfadebda6ca0585bb4982408fd"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a59e923cfadebda6ca0585bb4982408fd">ProgAngularProjectionMatching::scale_nsteps</a></div><div class="ttdeci">double scale_nsteps</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00147">angular_projection_matching.h:147</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a59fffce298c0f99a1d592544d3d39a08"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a59fffce298c0f99a1d592544d3d39a08">MDL_ANGLE_ROT</a></div><div class="ttdoc">Rotation angle of an image (double,degrees) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00057">metadata_label.h:57</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a060fce387f382e53d5f216fdd4ed404a"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a060fce387f382e53d5f216fdd4ed404a">ProgAngularProjectionMatching::scaleAlignOneImage</a></div><div class="ttdeci">void scaleAlignOneImage(MultidimArray&lt; double &gt; &amp;img, const int &amp;samplenr, const double &amp;psi, const bool &amp;opt_flip, const double &amp;opt_xoff, const double &amp;opt_yoff, const double &amp;old_scale, double &amp;opt_scale, double &amp;maxcorr)</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8cpp_source.html#l00867">angular_projection_matching.cpp:867</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a33132687def0129f4c14fa9c068a0d19"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">ProgAngularProjectionMatching::mysampling</a></div><div class="ttdeci">Sampling mysampling</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00120">angular_projection_matching.h:120</a></div></div>
<div class="ttc" id="classImageBase_html_a45407967b3b3ee97d4e02affa460d78f"><div class="ttname"><a href="classImageBase.html#a45407967b3b3ee97d4e02affa460d78f">ImageBase::Xoff</a></div><div class="ttdeci">double Xoff(const size_t n=0) const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00322">xmipp_image_base.cpp:322</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="ml2d_8cpp_html_ac5586dc09402e07fc907631409d0ff6d"><div class="ttname"><a href="ml2d_8cpp.html#ac5586dc09402e07fc907631409d0ff6d">pp</a></div><div class="ttdeci">#define pp(s, x)</div><div class="ttdef"><b>Definition:</b> <a href="ml2d_8cpp_source.html#l00472">ml2d.cpp:472</a></div></div>
<div class="ttc" id="structstructThreadRotationallyAlignOneImage_html"><div class="ttname"><a href="structstructThreadRotationallyAlignOneImage.html">structThreadRotationallyAlignOneImage</a></div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00056">angular_projection_matching.h:56</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac15f836e18a2035d2923ecf76c6e8c7f"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac15f836e18a2035d2923ecf76c6e8c7f">MDL_ANGLE_TILT</a></div><div class="ttdoc">Tilting angle of an image (double,degrees) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00060">metadata_label.h:60</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78acb3aa7acca32f4524608635e2e09650e"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acb3aa7acca32f4524608635e2e09650e">MDL_SHIFT_X</a></div><div class="ttdoc">Shift for the image in the X axis (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00412">metadata_label.h:412</a></div></div>
<div class="ttc" id="structstructThreadRotationallyAlignOneImage_html_a630de636706fad22b0c9f3744b4f2b5a"><div class="ttname"><a href="structstructThreadRotationallyAlignOneImage.html#a630de636706fad22b0c9f3744b4f2b5a">structThreadRotationallyAlignOneImage::opt_psi</a></div><div class="ttdeci">double * opt_psi</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00062">angular_projection_matching.h:62</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a114e3414dd216e4308946a016b5cc46f"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a114e3414dd216e4308946a016b5cc46f">MDL_ANGLE_PSI</a></div><div class="ttdoc">Special label to be used when gathering MDs in MpiMetadataPrograms. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00054">metadata_label.h:54</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a7557dbd7c4833be2a957e4775d899ccc"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">ProgAngularProjectionMatching::numOrientations</a></div><div class="ttdeci">int numOrientations</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00137">angular_projection_matching.h:137</a></div></div>
<div class="ttc" id="classMetaData_html_acd6018636eda733443f3df6c61978faa"><div class="ttname"><a href="classMetaData.html#acd6018636eda733443f3df6c61978faa">MetaData::addObject</a></div><div class="ttdeci">size_t addObject()</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00750">metadata.cpp:750</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00068">xmipp_filename.h:68</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a4742d43b4d22ebf65a3312767ea9b10d"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a4742d43b4d22ebf65a3312767ea9b10d">MDL_ITEM_ID</a></div><div class="ttdoc">Unique identifier for items inside a list or set (std::size_t) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00250">metadata_label.h:250</a></div></div>
<div class="ttc" id="angular__projection__matching_8cpp_html_a623b06eaa17f3ec38703913ffeb405b6"><div class="ttname"><a href="angular__projection__matching_8cpp.html#a623b06eaa17f3ec38703913ffeb405b6">threadRotationallyAlignOneImage</a></div><div class="ttdeci">void * threadRotationallyAlignOneImage(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8cpp_source.html#l00526">angular_projection_matching.cpp:526</a></div></div>
<div class="ttc" id="classMetaData_html_a2239fbb7e492654f1e2866ab27492a5d"><div class="ttname"><a href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">MetaData::getValue</a></div><div class="ttdeci">bool getValue(MDObject &amp;mdValueOut, size_t id) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00217">metadata.cpp:217</a></div></div>
<div class="ttc" id="classImageBase_html_a6b0ee50530b957aae3730106e414f901"><div class="ttname"><a href="classImageBase.html#a6b0ee50530b957aae3730106e414f901">ImageBase::scale</a></div><div class="ttdeci">double scale(const size_t n=0) const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00374">xmipp_image_base.cpp:374</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aed805df963ac159ce0e697ccdec2d976"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aed805df963ac159ce0e697ccdec2d976">ProgAngularProjectionMatching::do_scale</a></div><div class="ttdeci">bool do_scale</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00144">angular_projection_matching.h:144</a></div></div>
<div class="ttc" id="structstructThreadRotationallyAlignOneImage_html_aea9cb7ed822aba91d3c914c803f0edd6"><div class="ttname"><a href="structstructThreadRotationallyAlignOneImage.html#aea9cb7ed822aba91d3c914c803f0edd6">structThreadRotationallyAlignOneImage::this_image</a></div><div class="ttdeci">size_t this_image</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00060">angular_projection_matching.h:60</a></div></div>
<div class="ttc" id="structstructThreadRotationallyAlignOneImage_html_a766da16bdf19c3173d1e27d3af64bbe2"><div class="ttname"><a href="structstructThreadRotationallyAlignOneImage.html#a766da16bdf19c3173d1e27d3af64bbe2">structThreadRotationallyAlignOneImage::opt_flip</a></div><div class="ttdeci">bool * opt_flip</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00063">angular_projection_matching.h:63</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a9c3b2ace08c588a370b41162bd04a3ee"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a9c3b2ace08c588a370b41162bd04a3ee">ProgAngularProjectionMatching::DFexp</a></div><div class="ttdeci">MetaData DFexp</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00080">angular_projection_matching.h:80</a></div></div>
<div class="ttc" id="structstructThreadRotationallyAlignOneImage_html_a6a402ccb5ea7eb3a9c0d0cc815205f83"><div class="ttname"><a href="structstructThreadRotationallyAlignOneImage.html#a6a402ccb5ea7eb3a9c0d0cc815205f83">structThreadRotationallyAlignOneImage::img</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * img</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00059">angular_projection_matching.h:59</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af6495a877b8c80b9c45b8156b406b183"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af6495a877b8c80b9c45b8156b406b183">MDL_FLIP</a></div><div class="ttdoc">Flip the image? (bool) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00231">metadata_label.h:231</a></div></div>
<div class="ttc" id="structstructThreadRotationallyAlignOneImage_html_ac576f5e1976c1d30bc82a0652fc61c42"><div class="ttname"><a href="structstructThreadRotationallyAlignOneImage.html#ac576f5e1976c1d30bc82a0652fc61c42">structThreadRotationallyAlignOneImage::thread_id</a></div><div class="ttdeci">size_t thread_id</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00057">angular_projection_matching.h:57</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga3bdba82f045e73fb216c6be539e6b129"><div class="ttname"><a href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a></div><div class="ttdeci">void progress_bar(long rlen)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00782">xmipp_funcs.cpp:782</a></div></div>
<div class="ttc" id="classImageBase_html_aee9ff7df52c343fd74630256d5814fcc"><div class="ttname"><a href="classImageBase.html#aee9ff7df52c343fd74630256d5814fcc">ImageBase::Yoff</a></div><div class="ttdeci">double Yoff(const size_t n=0) const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00335">xmipp_image_base.cpp:335</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a32927ba57ddc0c409fd40fe79cad9982"><div class="ttname"><a href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a></div><div class="ttdeci">free((char *) ob)</div></div>
<div class="ttc" id="structstructThreadRotationallyAlignOneImage_html_a961fced4c0b3ab6e3423fe9e071b05ad"><div class="ttname"><a href="structstructThreadRotationallyAlignOneImage.html#a961fced4c0b3ab6e3423fe9e071b05ad">structThreadRotationallyAlignOneImage::maxcorr</a></div><div class="ttdeci">double * maxcorr</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00064">angular_projection_matching.h:64</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a13a2ae711ddad715bec00dcfb45d39e7"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a13a2ae711ddad715bec00dcfb45d39e7">MDL_MAXCC</a></div><div class="ttdoc">Maximum cross-correlation for the image (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00268">metadata_label.h:268</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78aad487c1de68c3a3b8f44773ee776d87c"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aad487c1de68c3a3b8f44773ee776d87c">MDL_SCALE</a></div><div class="ttdoc">scaling factor for an image or volume (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00385">metadata_label.h:385</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a9ceadd76e62fefe80a4fc832fca2c00f"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a9ceadd76e62fefe80a4fc832fca2c00f">ProgAngularProjectionMatching::loop_forward_refs</a></div><div class="ttdeci">bool loop_forward_refs</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00123">angular_projection_matching.h:123</a></div></div>
<div class="ttc" id="classXmippProgram_html_aed62cfe3c074e69076bf348fc101a717"><div class="ttname"><a href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">XmippProgram::verbose</a></div><div class="ttdeci">int verbose</div><div class="ttdoc">Verbosity level. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8h_source.html#l00168">xmipp_program.h:168</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_afa1d2a0ad80c2deae0e33de00fb7af6d"><div class="ttname"><a href="classProgAngularProjectionMatching.html#afa1d2a0ad80c2deae0e33de00fb7af6d">ProgAngularProjectionMatching::translationallyAlignOneImage</a></div><div class="ttdeci">void translationallyAlignOneImage(MultidimArray&lt; double &gt; &amp;img, const int &amp;samplenr, const double &amp;psi, const bool &amp;opt_flip, double &amp;opt_xoff, double &amp;opt_yoff, double &amp;maxcorr)</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8cpp_source.html#l00772">angular_projection_matching.cpp:772</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a6f0c8469a0fc03f6655791daba88a7a7"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a6f0c8469a0fc03f6655791daba88a7a7">ProgAngularProjectionMatching::DFo</a></div><div class="ttdeci">MetaData DFo</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00082">angular_projection_matching.h:82</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aa00715bc55b889ae05eeeafb17d51d38"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aa00715bc55b889ae05eeeafb17d51d38">ProgAngularProjectionMatching::getCurrentImage</a></div><div class="ttdeci">void getCurrentImage(size_t imgid, Image&lt; double &gt; &amp;img)</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8cpp_source.html#l01206">angular_projection_matching.cpp:1206</a></div></div>
<div class="ttc" id="classMetaData_html_adf4ee2ad1ad0964990a8a11a2109d578"><div class="ttname"><a href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">MetaData::setValue</a></div><div class="ttdeci">bool setValue(const MDLabel label, const T &amp;valueIn, size_t id)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00550">metadata.h:550</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a3637da3214664c45458ae3e56a92c88e"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a3637da3214664c45458ae3e56a92c88e">MDL_REF</a></div><div class="ttdoc">Class to which the image belongs (int) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00363">metadata_label.h:363</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_ac043b262d9dc89979be1587b43dbe937"><div class="ttname"><a href="classProgAngularProjectionMatching.html#ac043b262d9dc89979be1587b43dbe937">ProgAngularProjectionMatching::threads</a></div><div class="ttdeci">int threads</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00135">angular_projection_matching.h:135</a></div></div>
<div class="ttc" id="structstructThreadRotationallyAlignOneImage_html_a3f7961589328756580c04e12df0fc88e"><div class="ttname"><a href="structstructThreadRotationallyAlignOneImage.html#a3f7961589328756580c04e12df0fc88e">structThreadRotationallyAlignOneImage::prm</a></div><div class="ttdeci">ProgAngularProjectionMatching * prm</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00058">angular_projection_matching.h:58</a></div></div>
<div class="ttc" id="classSampling_html_aab3b11080881b21b6de327a8f86d5d71"><div class="ttname"><a href="classSampling.html#aab3b11080881b21b6de327a8f86d5d71">Sampling::no_redundant_sampling_points_angles</a></div><div class="ttdeci">std::vector&lt; Matrix1D&lt; double &gt; &gt; no_redundant_sampling_points_angles</div><div class="ttdef"><b>Definition:</b> <a href="sampling_8h_source.html#l00123">sampling.h:123</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_ac2959661621ae5d67cb604302bb91d74"><div class="ttname"><a href="classProgAngularProjectionMatching.html#ac2959661621ae5d67cb604302bb91d74">ProgAngularProjectionMatching::convert_refno_to_stack_position</a></div><div class="ttdeci">std::vector&lt; size_t &gt; convert_refno_to_stack_position</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00108">angular_projection_matching.h:108</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="classImageBase_html_a4f3c0fee82de6352f6d82d717e532a2b"><div class="ttname"><a href="classImageBase.html#a4f3c0fee82de6352f6d82d717e532a2b">ImageBase::name</a></div><div class="ttdeci">const FileName &amp; name() const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00471">xmipp_image_base.h:471</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a725039b9ec19e43bc45afc57bf8b711c"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a725039b9ec19e43bc45afc57bf8b711c">ProgAngularProjectionMatching::progress_bar_step</a></div><div class="ttdeci">int progress_bar_step</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00150">angular_projection_matching.h:150</a></div></div>
<div class="ttc" id="structstructThreadRotationallyAlignOneImage_html_a306e01fa086a78cde92c242c90d6ebf1"><div class="ttname"><a href="structstructThreadRotationallyAlignOneImage.html#a306e01fa086a78cde92c242c90d6ebf1">structThreadRotationallyAlignOneImage::numOrientations</a></div><div class="ttdeci">size_t numOrientations</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00065">angular_projection_matching.h:65</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab00882fc483e9a1a7e6af5829a6afb8e"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab00882fc483e9a1a7e6af5829a6afb8e">MDL_SHIFT_Y</a></div><div class="ttdoc">Shift for the image in the Y axis (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00415">metadata_label.h:415</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a></div><div class="ttdoc">Name of an image (std::string) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00235">metadata_label.h:235</a></div></div>
<div class="ttc" id="structstructThreadRotationallyAlignOneImage_html_ab9bcda7c32f743dbdc1e8104509774cf"><div class="ttname"><a href="structstructThreadRotationallyAlignOneImage.html#ab9bcda7c32f743dbdc1e8104509774cf">structThreadRotationallyAlignOneImage::opt_refno</a></div><div class="ttdeci">int * opt_refno</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00061">angular_projection_matching.h:61</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abf2390e35441f03aba73075a813e9e77"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProgAngularProjectionMatching::produceSideInfo </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Make shiftmask and calculate nr_psi </p>

<p>Reimplemented in <a class="el" href="classMpiProgAngularProjectionMatching.html#aff0322b0ea5bcfb2bcea8b69c623b0d1">MpiProgAngularProjectionMatching</a>.</p>

<p>Definition at line <a class="el" href="angular__projection__matching_8cpp_source.html#l00205">205</a> of file <a class="el" href="angular__projection__matching_8cpp_source.html">angular_projection_matching.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;{</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="classImage.html">Image&lt;double&gt;</a>    img,empty;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="classProjection.html">Projection</a>       proj;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="classMetaData.html">MetaData</a>         DF;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="classMetaData.html">MetaData</a>         SFr,emptySF;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="classSymList.html">SymList</a>          SL;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="classFileName.html">FileName</a>         fn_img;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Maux;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> dataline(3);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="classPolar.html">Polar&lt;double&gt;</a>    P;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="classPolar.html">Polar&lt;std::complex &lt;double&gt;</a> &gt; fP;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="comment">// Read Selfile and get dimensions</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="classMetaData.html">MetaData</a> MetaDataLeft;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="classMetaData.html">MetaData</a> MetaDataRight;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a> blockName = <span class="stringliteral">&quot;all_exp_images&quot;</span>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="classFileName.html">FileName</a> inputFn = <a class="code" href="classProgAngularProjectionMatching.html#a27562024b9dfcc0ff3c14927bcd2707f">fn_exp</a>.<a class="code" href="classFileName.html#a2a2be3f4433923ab61f426de1791a596">removeBlockName</a>();</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__MetaData.html#gabb2545c9b06cbee0d207b871a3ba5c63">existsBlockInMetaDataFile</a>(inputFn, blockName))</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <a class="code" href="classFileName.html">FileName</a> rightFn;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        rightFn.<a class="code" href="classFileName.html#ab10d5ada0f956aef14ae171f12587d56">compose</a>(blockName, inputFn);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        MetaDataRight.<a class="code" href="classMetaData.html#ab7f8d43d77647ade923e6cd63eafdd03">read</a>(rightFn);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        MetaDataLeft.<a class="code" href="classMetaData.html#ab7f8d43d77647ade923e6cd63eafdd03">read</a>(<a class="code" href="classProgAngularProjectionMatching.html#a27562024b9dfcc0ff3c14927bcd2707f">fn_exp</a>);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="comment">//Join with angles and shifhts</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#a9c3b2ace08c588a370b41162bd04a3ee">DFexp</a>.<a class="code" href="classMetaData.html#abefe17481ebbbed346fdfc185812cdf3">join1</a>(MetaDataLeft, MetaDataRight, <a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a>,<a class="code" href="group__MetaData.html#ggaef400c43b34e3ecc3f7b342aa821395dadb45120aafd37a973140edee24708065">LEFT</a>);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#a9c3b2ace08c588a370b41162bd04a3ee">DFexp</a>.<a class="code" href="classMetaData.html#ab7f8d43d77647ade923e6cd63eafdd03">read</a>(<a class="code" href="classProgAngularProjectionMatching.html#a27562024b9dfcc0ff3c14927bcd2707f">fn_exp</a>);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">//DFexp.removeDisabled();</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">// Thread barrier</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="group__Threads.html#ga3c4dbe1b06c40927ef9cb8be71b366e8">barrier_init</a>(&amp;<a class="code" href="classProgAngularProjectionMatching.html#a1c2f248db52457e702e7d626ba3e6547">thread_barrier</a>, <a class="code" href="classProgAngularProjectionMatching.html#ac043b262d9dc89979be1587b43dbe937">threads</a>);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// Read one image to get dim</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a9c3b2ace08c588a370b41162bd04a3ee">DFexp</a>.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a>,fn_img,<a class="code" href="classProgAngularProjectionMatching.html#a9c3b2ace08c588a370b41162bd04a3ee">DFexp</a>.<a class="code" href="classMetaData.html#a9f88f42faff8bfbc1952c50e2a6ffc42">firstObject</a>());</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    img.<a class="code" href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">read</a>(fn_img);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#ae5e360b3e048572819d48b76f11df5e9">dim</a> = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(img());</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">// Check that the reference and the experimental images are of the same</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">// size</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="classFileName.html">FileName</a> fnt;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    fnt.<a class="code" href="classFileName.html#ab10d5ada0f956aef14ae171f12587d56">compose</a>(<a class="code" href="xmipp__image__macros_8h.html#a351b4f5340ffda2f0414b8bbd9704347">FIRST_IMAGE</a>, <a class="code" href="classProgAngularProjectionMatching.html#aa225d6d9aa1a2349b3fe8bfac7c61be3">fn_ref</a>);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="classImage.html">Image&lt;double&gt;</a> imgRef;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    imgRef.<a class="code" href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">read</a>(fnt,<a class="code" href="group__Images.html#gga22f7d7ee058354c030d2b52a8f190543a2e57918a09d25b07a664e505d50a97f6">HEADER</a>);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">if</span> (!imgRef().sameShape(img()))</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aaba89018a8188da52ee900de49a93ed78">ERR_MULTIDIM_SIZE</a>,</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                     <span class="stringliteral">&quot;Check that the reference volume and the experimental images are of the same size&quot;</span>);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">// Set padding dimension</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#add0977a6148a63070a4c91eba71ee9cb">paddim</a>=<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="classProgAngularProjectionMatching.html#a723e4a9d596d440137c0a59a6582742b">pad</a>*<a class="code" href="classProgAngularProjectionMatching.html#ae5e360b3e048572819d48b76f11df5e9">dim</a>);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// Set max_shift</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgAngularProjectionMatching.html#a1658eaa42a37fdcd6bffdd72a34af947">max_shift</a>&lt;0)</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#a1658eaa42a37fdcd6bffdd72a34af947">max_shift</a> = <a class="code" href="classProgAngularProjectionMatching.html#ae5e360b3e048572819d48b76f11df5e9">dim</a>/2;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// Set ring defaults</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgAngularProjectionMatching.html#a60f6e7892e2cac3c25be6d46a4f9bdc5">Ri</a>&lt;1)</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#a60f6e7892e2cac3c25be6d46a4f9bdc5">Ri</a>=1;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgAngularProjectionMatching.html#ab67ae2242d1cd1fd2c1b106b1debff2d">Ro</a>&lt;0)</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#ab67ae2242d1cd1fd2c1b106b1debff2d">Ro</a>=(<a class="code" href="classProgAngularProjectionMatching.html#ae5e360b3e048572819d48b76f11df5e9">dim</a>/2)-1;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">// Calculate necessary memory per image</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga007f6aec56f2b0abdb6f4903a22cedf0">produceSplineCoefficients</a>(<a class="code" href="group__GeometricalTransformations.html#gab8a49d8335f45ebd2ba7d86d98322bc0">BSPLINE3</a>,Maux,img());</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    P.<a class="code" href="classPolar.html#a0ade05210836a466416ffcb85eb1dd4e">getPolarFromCartesianBSpline</a>(Maux,<a class="code" href="classProgAngularProjectionMatching.html#a60f6e7892e2cac3c25be6d46a4f9bdc5">Ri</a>,<a class="code" href="classProgAngularProjectionMatching.html#ab67ae2242d1cd1fd2c1b106b1debff2d">Ro</a>);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    P.<a class="code" href="classPolar.html#a67490e990718a2221935ca2c017db1fb">calculateFftwPlans</a>(<a class="code" href="classProgAngularProjectionMatching.html#aa27a6cf70fecb56ed13b384161bc5248">global_plans</a>);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="group__Polar.html#ga02e5b456ea900d6023ee4170514b9864">fourierTransformRings</a>(P,fP,<a class="code" href="classProgAngularProjectionMatching.html#aa27a6cf70fecb56ed13b384161bc5248">global_plans</a>,<span class="keyword">false</span>);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordtype">double</span> memory_per_ref = 0.;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; fP.<a class="code" href="classPolar.html#a471898c3d9ddca4db17d368cd583482a">getRingNo</a>(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        memory_per_ref += (double) fP.<a class="code" href="classPolar.html#acec5f869748f42d3b521f1db65fd8897">getSampleNo</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) * 2 * <span class="keyword">sizeof</span>(double);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    memory_per_ref += <a class="code" href="classProgAngularProjectionMatching.html#ae5e360b3e048572819d48b76f11df5e9">dim</a> * <a class="code" href="classProgAngularProjectionMatching.html#ae5e360b3e048572819d48b76f11df5e9">dim</a> * <span class="keyword">sizeof</span>(double);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a9562d86a126dcc1d8c50cd861f616d40">max_nr_imgs_in_memory</a> = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>( 1024 * 1024 * 1024 * <a class="code" href="classProgAngularProjectionMatching.html#a20cca02bbe41ebcdba66c9e358c98559">avail_memory</a> / memory_per_ref);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">// Set up angular sampling</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">mysampling</a>.<a class="code" href="classSampling.html#ac9f047f9c486e2d8797ee82a595ad3c9">readSamplingFile</a>(<a class="code" href="classProgAngularProjectionMatching.html#aa225d6d9aa1a2349b3fe8bfac7c61be3">fn_ref</a>.<a class="code" href="classFileName.html#a1344b1a98f95cbb83151ceb9e61884c0">removeAllExtensions</a>(),<span class="keyword">false</span>);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a85cb8e7d09221d99e44a8a2208fd4a22">total_nr_refs</a> = <a class="code" href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">mysampling</a>.<a class="code" href="classSampling.html#aab3b11080881b21b6de327a8f86d5d71">no_redundant_sampling_points_angles</a>.size();</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">//#define DEBUG</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;XXXXmysampling.no_redundant_sampling_points_indexXXXXXX&quot;</span> &lt;&lt;std::endl;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">for</span> (std::vector&lt;size_t&gt;::iterator <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> =</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;             <a class="code" href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">mysampling</a>.<a class="code" href="classSampling.html#a7d33097f53b734cdd8de3792d5134d1c">no_redundant_sampling_points_index</a>.begin();</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;         <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> != <a class="code" href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">mysampling</a>.<a class="code" href="classSampling.html#a7d33097f53b734cdd8de3792d5134d1c">no_redundant_sampling_points_index</a>.end();</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;         ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        std::cerr &lt;&lt; *<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    std::cerr &lt;&lt; std::endl;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;exit&quot;</span> &lt;&lt;std::endl;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="preprocessor">#undef DEBUG</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#ac2959661621ae5d67cb604302bb91d74">convert_refno_to_stack_position</a>.resize(<a class="code" href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">mysampling</a>.<a class="code" href="classSampling.html#a7aa0d4768d26e69305afbbb36e5eb797">numberSamplesAsymmetricUnit</a>, -1);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">mysampling</a>.<a class="code" href="classSampling.html#a7d33097f53b734cdd8de3792d5134d1c">no_redundant_sampling_points_index</a>.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#ac2959661621ae5d67cb604302bb91d74">convert_refno_to_stack_position</a>[<a class="code" href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">mysampling</a>.<a class="code" href="classSampling.html#a7d33097f53b734cdd8de3792d5134d1c">no_redundant_sampling_points_index</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]] = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">// Don&#39;t reserve more memory than necessary</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a5e8acf7bc77be451a429e9ae8af5c37b">max_nr_refs_in_memory</a> = <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(max_nr_imgs_in_memory, <a class="code" href="classProgAngularProjectionMatching.html#a85cb8e7d09221d99e44a8a2208fd4a22">total_nr_refs</a>);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">// Initialize pointers for reference retrieval</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#acd57f432b75da0e346c9c0df1b3e824f">pointer_allrefs2refsinmem</a>.resize(<a class="code" href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">mysampling</a>.<a class="code" href="classSampling.html#a7aa0d4768d26e69305afbbb36e5eb797">numberSamplesAsymmetricUnit</a>,-1);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#aeb35527c73b27e78c3ceb5cd3721f195">pointer_refsinmem2allrefs</a>.resize(<a class="code" href="classProgAngularProjectionMatching.html#a5e8acf7bc77be451a429e9ae8af5c37b">max_nr_refs_in_memory</a>,-1);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#ae9043a07e1507976fff101ec37eab8f2">counter_refs_in_memory</a> = 0;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a9ceadd76e62fefe80a4fc832fca2c00f">loop_forward_refs</a>=<span class="keyword">true</span>;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">// Initialize 5D search vectors</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a186aaabc17af38165deb81586e606cca">search5d_xoff</a>.clear();</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a8f71b2ce22933528a9f18e757ef6efac">search5d_yoff</a>.clear();</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">// Make sure origin is included</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classProgAngularProjectionMatching.html#a9ab38e7253df6c449dc6322e4c46b83b">search5d_step</a> == 0)</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        printf(<span class="stringliteral">&quot;***********************************************************\n&quot;</span>);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        printf(<span class="stringliteral">&quot;*   ERROR: search step should be different from 0\n&quot;</span>);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        printf(<span class="stringliteral">&quot;*   search step set to 1 \n&quot;</span>);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        printf(<span class="stringliteral">&quot;***********************************************************\n&quot;</span>);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#a9ab38e7253df6c449dc6322e4c46b83b">search5d_step</a> = 1;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordtype">int</span> myfinal=<a class="code" href="classProgAngularProjectionMatching.html#a989c2a0cdf20f2717d5e80baabfc40e5">search5d_shift</a> + <a class="code" href="classProgAngularProjectionMatching.html#a989c2a0cdf20f2717d5e80baabfc40e5">search5d_shift</a>%<a class="code" href="classProgAngularProjectionMatching.html#a9ab38e7253df6c449dc6322e4c46b83b">search5d_step</a>;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a037f376e933b93134ca3d6f117e3d756">nr_trans</a> = 0;<span class="comment">//number translations in 5D</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> xoff = -myfinal; xoff &lt;= myfinal; xoff+= <a class="code" href="classProgAngularProjectionMatching.html#a9ab38e7253df6c449dc6322e4c46b83b">search5d_step</a>)</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yoff = -myfinal; yoff &lt;= myfinal; yoff+= <a class="code" href="classProgAngularProjectionMatching.html#a9ab38e7253df6c449dc6322e4c46b83b">search5d_step</a>)</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        {</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="comment">// Only take a circle (not a square)</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <span class="keywordflow">if</span> ( xoff*xoff + yoff*yoff &lt;= <a class="code" href="classProgAngularProjectionMatching.html#a989c2a0cdf20f2717d5e80baabfc40e5">search5d_shift</a>*<a class="code" href="classProgAngularProjectionMatching.html#a989c2a0cdf20f2717d5e80baabfc40e5">search5d_shift</a>)</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                <a class="code" href="classProgAngularProjectionMatching.html#a186aaabc17af38165deb81586e606cca">search5d_xoff</a>.push_back(xoff);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                <a class="code" href="classProgAngularProjectionMatching.html#a8f71b2ce22933528a9f18e757ef6efac">search5d_yoff</a>.push_back(yoff);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                <a class="code" href="classProgAngularProjectionMatching.html#a037f376e933b93134ca3d6f117e3d756">nr_trans</a>++;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// Initialize all arrays</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">try</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    {</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#aadc634e170de9a09b2870fab90bd0dac">fP_ref</a> = <span class="keyword">new</span> <a class="code" href="classPolar.html">Polar&lt;std::complex&lt;double&gt;</a> &gt;[<a class="code" href="classProgAngularProjectionMatching.html#a5e8acf7bc77be451a429e9ae8af5c37b">max_nr_refs_in_memory</a>];</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#afc2430b6b28898178fb61bb50c1e39c8">proj_ref</a> = <span class="keyword">new</span> <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a>[<a class="code" href="classProgAngularProjectionMatching.html#a5e8acf7bc77be451a429e9ae8af5c37b">max_nr_refs_in_memory</a>];</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#aee78ecf7a18389e52940b9f4bf5dcff6">fP_img</a> = <span class="keyword">new</span> <a class="code" href="classPolar.html">Polar&lt;std::complex&lt;double&gt;</a> &gt;[<a class="code" href="classProgAngularProjectionMatching.html#a037f376e933b93134ca3d6f117e3d756">nr_trans</a>];</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#a450a2dfc609d2b3003e3e998878082dc">fPm_img</a> = <span class="keyword">new</span> <a class="code" href="classPolar.html">Polar&lt;std::complex&lt;double&gt;</a> &gt;[<a class="code" href="classProgAngularProjectionMatching.html#a037f376e933b93134ca3d6f117e3d756">nr_trans</a>];</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#a4840d3dcdfe64b6fd3a02096e6c83573">stddev_ref</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classProgAngularProjectionMatching.html#a5e8acf7bc77be451a429e9ae8af5c37b">max_nr_refs_in_memory</a>];</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#a4e644422e07a3dc04ffcc5dbdb34eb52">stddev_img</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classProgAngularProjectionMatching.html#a037f376e933b93134ca3d6f117e3d756">nr_trans</a>];</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">catch</span> (std::bad_alloc&amp;)</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    {</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa35785e227d66cac9143e107ce136b9df">ERR_MEM_BADREQUEST</a>,<span class="stringliteral">&quot;Error allocating memory in produceSideInfo&quot;</span>);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">// CTF stuff</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgAngularProjectionMatching.html#aca9eed5afc4442b6f6173b8d47046fe6">fn_ctf</a> != <span class="stringliteral">&quot;&quot;</span>)</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classProgAngularProjectionMatching.html#aca9eed5afc4442b6f6173b8d47046fe6">fn_ctf</a>.<a class="code" href="classFileName.html#a1a69f3a90c51e46490576d28f9eddfab">isMetaData</a>())</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        {</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            <a class="code" href="classImage.html">Image&lt;double&gt;</a> img;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            img.<a class="code" href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">read</a>(<a class="code" href="classProgAngularProjectionMatching.html#aca9eed5afc4442b6f6173b8d47046fe6">fn_ctf</a>);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <a class="code" href="classProgAngularProjectionMatching.html#a67bce09ceb3bada415d302b03613d3b9">Mctf</a>=img();</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(<a class="code" href="classProgAngularProjectionMatching.html#a67bce09ceb3bada415d302b03613d3b9">Mctf</a>) != <a class="code" href="classProgAngularProjectionMatching.html#add0977a6148a63070a4c91eba71ee9cb">paddim</a>)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            {</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                std::cerr&lt;&lt;<span class="stringliteral">&quot;image size= &quot;</span>&lt;&lt;<a class="code" href="classProgAngularProjectionMatching.html#ae5e360b3e048572819d48b76f11df5e9">dim</a>&lt;&lt;<span class="stringliteral">&quot; padding factor= &quot;</span>&lt;&lt;<a class="code" href="classProgAngularProjectionMatching.html#a723e4a9d596d440137c0a59a6582742b">pad</a>&lt;&lt;<span class="stringliteral">&quot; padded image size= &quot;</span>&lt;&lt;<a class="code" href="classProgAngularProjectionMatching.html#add0977a6148a63070a4c91eba71ee9cb">paddim</a>&lt;&lt;<span class="stringliteral">&quot; Wiener filter size= &quot;</span>&lt;&lt;<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(<a class="code" href="classProgAngularProjectionMatching.html#a67bce09ceb3bada415d302b03613d3b9">Mctf</a>)&lt;&lt;std::endl;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a>,</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                             <span class="stringliteral">&quot;Incompatible padding factor for this CTF filter&quot;</span>);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        }</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <a class="code" href="classCTFDescription.html">CTFDescription</a> ctf;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            <a class="code" href="classMultidimArray.html">MultidimArray&lt;std::complex&lt;double&gt;</a> &gt;  ctfmask;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            ctf.<a class="code" href="group__CTFSupport.html#ga3225da29d9d6bc5b4d43752660bfd10d">read</a>(<a class="code" href="classProgAngularProjectionMatching.html#aca9eed5afc4442b6f6173b8d47046fe6">fn_ctf</a>);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(ctf.<a class="code" href="group__CTFSupport.html#ga78c788d379d36da4590e556d36c8a31e">DeltafV</a> - ctf.<a class="code" href="group__CTFSupport.html#ga3cdc4a8beb7e3b37ee8089a5e474852d">DeltafU</a>) &gt;1.)</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            {</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a>,</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                             <span class="stringliteral">&quot;ERROR!! Only non-astigmatic CTFs are allowed!&quot;</span>);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            ctf.<a class="code" href="group__CTFSupport.html#ga05d00aaebfb6507b217c76b63ffb34a6">enable_CTF</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            ctf.<a class="code" href="group__CTFSupport.html#gaf7c2db081b566837a909634b8dba6caf">produceSideInfo</a>();</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            ctf.<a class="code" href="group__CTFSupport.html#ga827ec32b7dfce0e4b4b4f43013d4fc7c">generateCTF</a>(<a class="code" href="classProgAngularProjectionMatching.html#add0977a6148a63070a4c91eba71ee9cb">paddim</a>, <a class="code" href="classProgAngularProjectionMatching.html#add0977a6148a63070a4c91eba71ee9cb">paddim</a>, ctfmask);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            <a class="code" href="classProgAngularProjectionMatching.html#a67bce09ceb3bada415d302b03613d3b9">Mctf</a>.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="classProgAngularProjectionMatching.html#add0977a6148a63070a4c91eba71ee9cb">paddim</a>,<a class="code" href="classProgAngularProjectionMatching.html#add0977a6148a63070a4c91eba71ee9cb">paddim</a>);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a>(<a class="code" href="classProgAngularProjectionMatching.html#a67bce09ceb3bada415d302b03613d3b9">Mctf</a>)</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classProgAngularProjectionMatching.html#ac612a8a129d906023ff929ec80552f90">phase_flipped</a>)</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(<a class="code" href="classProgAngularProjectionMatching.html#a67bce09ceb3bada415d302b03613d3b9">Mctf</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = fabs(<a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(ctfmask, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>).real());</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(<a class="code" href="classProgAngularProjectionMatching.html#a67bce09ceb3bada415d302b03613d3b9">Mctf</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(ctfmask, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>).real();</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            }</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    }</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">//Store the id&#39;s of each experimental image from metadata</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a9c3b2ace08c588a370b41162bd04a3ee">DFexp</a>.<a class="code" href="classMetaData.html#a1a76384897857d639447524ff2f14ab3">findObjects</a>(<a class="code" href="classProgAngularProjectionMatching.html#a14edd79cd809aba3482bddff00f5e6b1">ids</a>);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;}</div><div class="ttc" id="classProgAngularProjectionMatching_html_ae5e360b3e048572819d48b76f11df5e9"><div class="ttname"><a href="classProgAngularProjectionMatching.html#ae5e360b3e048572819d48b76f11df5e9">ProgAngularProjectionMatching::dim</a></div><div class="ttdeci">size_t dim</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00084">angular_projection_matching.h:84</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a20cca02bbe41ebcdba66c9e358c98559"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a20cca02bbe41ebcdba66c9e358c98559">ProgAngularProjectionMatching::avail_memory</a></div><div class="ttdeci">double avail_memory</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00092">angular_projection_matching.h:92</a></div></div>
<div class="ttc" id="group__Threads_html_ga3c4dbe1b06c40927ef9cb8be71b366e8"><div class="ttname"><a href="group__Threads.html#ga3c4dbe1b06c40927ef9cb8be71b366e8">barrier_init</a></div><div class="ttdeci">int barrier_init(barrier_t *barrier, int needed)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8cpp_source.html#l00366">xmipp_threads.cpp:366</a></div></div>
<div class="ttc" id="classSymList_html"><div class="ttname"><a href="classSymList.html">SymList</a></div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2symmetries_8h_source.html#l00137">symmetries.h:137</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aa27a6cf70fecb56ed13b384161bc5248"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aa27a6cf70fecb56ed13b384161bc5248">ProgAngularProjectionMatching::global_plans</a></div><div class="ttdeci">Polar_fftw_plans global_plans</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00116">angular_projection_matching.h:116</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_acd57f432b75da0e346c9c0df1b3e824f"><div class="ttname"><a href="classProgAngularProjectionMatching.html#acd57f432b75da0e346c9c0df1b3e824f">ProgAngularProjectionMatching::pointer_allrefs2refsinmem</a></div><div class="ttdeci">std::vector&lt; int &gt; pointer_allrefs2refsinmem</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00105">angular_projection_matching.h:105</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a85cb8e7d09221d99e44a8a2208fd4a22"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a85cb8e7d09221d99e44a8a2208fd4a22">ProgAngularProjectionMatching::total_nr_refs</a></div><div class="ttdeci">int total_nr_refs</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00101">angular_projection_matching.h:101</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_ac612a8a129d906023ff929ec80552f90"><div class="ttname"><a href="classProgAngularProjectionMatching.html#ac612a8a129d906023ff929ec80552f90">ProgAngularProjectionMatching::phase_flipped</a></div><div class="ttdeci">bool phase_flipped</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00133">angular_projection_matching.h:133</a></div></div>
<div class="ttc" id="classFileName_html_a1344b1a98f95cbb83151ceb9e61884c0"><div class="ttname"><a href="classFileName.html#a1344b1a98f95cbb83151ceb9e61884c0">FileName::removeAllExtensions</a></div><div class="ttdeci">FileName removeAllExtensions() const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8cpp_source.html#l00379">xmipp_filename.cpp:379</a></div></div>
<div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga007f6aec56f2b0abdb6f4903a22cedf0"><div class="ttname"><a href="group__GeometricalTransformations.html#ga007f6aec56f2b0abdb6f4903a22cedf0">produceSplineCoefficients</a></div><div class="ttdeci">void produceSplineCoefficients(int SplineDegree, MultidimArray&lt; double &gt; &amp;coeffs, const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V1)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00576">transformations.cpp:576</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a33132687def0129f4c14fa9c068a0d19"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">ProgAngularProjectionMatching::mysampling</a></div><div class="ttdeci">Sampling mysampling</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00120">angular_projection_matching.h:120</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a9ab38e7253df6c449dc6322e4c46b83b"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a9ab38e7253df6c449dc6322e4c46b83b">ProgAngularProjectionMatching::search5d_step</a></div><div class="ttdeci">int search5d_step</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00127">angular_projection_matching.h:127</a></div></div>
<div class="ttc" id="group__Images_html_gga22f7d7ee058354c030d2b52a8f190543a2e57918a09d25b07a664e505d50a97f6"><div class="ttname"><a href="group__Images.html#gga22f7d7ee058354c030d2b52a8f190543a2e57918a09d25b07a664e505d50a97f6">HEADER</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00081">xmipp_image_base.h:81</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a186aaabc17af38165deb81586e606cca"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a186aaabc17af38165deb81586e606cca">ProgAngularProjectionMatching::search5d_xoff</a></div><div class="ttdeci">std::vector&lt; int &gt; search5d_xoff</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00129">angular_projection_matching.h:129</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="classFileName_html_a2a2be3f4433923ab61f426de1791a596"><div class="ttname"><a href="classFileName.html#a2a2be3f4433923ab61f426de1791a596">FileName::removeBlockName</a></div><div class="ttdeci">FileName removeBlockName() const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8cpp_source.html#l00497">xmipp_filename.cpp:497</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a27562024b9dfcc0ff3c14927bcd2707f"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a27562024b9dfcc0ff3c14927bcd2707f">ProgAngularProjectionMatching::fn_exp</a></div><div class="ttdeci">FileName fn_exp</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00078">angular_projection_matching.h:78</a></div></div>
<div class="ttc" id="group__CTFSupport_html_ga78c788d379d36da4590e556d36c8a31e"><div class="ttname"><a href="group__CTFSupport.html#ga78c788d379d36da4590e556d36c8a31e">CTFDescription::DeltafV</a></div><div class="ttdeci">double DeltafV</div><div class="ttdoc">Defocus in V (in Angstroms). Negative values are underfocused. </div><div class="ttdef"><b>Definition:</b> <a href="ctf_8h_source.html#l00829">ctf.h:829</a></div></div>
<div class="ttc" id="group__MetaData_html_gabb2545c9b06cbee0d207b871a3ba5c63"><div class="ttname"><a href="group__MetaData.html#gabb2545c9b06cbee0d207b871a3ba5c63">existsBlockInMetaDataFile</a></div><div class="ttdeci">bool existsBlockInMetaDataFile(const FileName &amp;inFileWithBlock)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00072">metadata.cpp:72</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a14edd79cd809aba3482bddff00f5e6b1"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a14edd79cd809aba3482bddff00f5e6b1">ProgAngularProjectionMatching::ids</a></div><div class="ttdeci">std::vector&lt; size_t &gt; ids</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00110">angular_projection_matching.h:110</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a8f71b2ce22933528a9f18e757ef6efac"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a8f71b2ce22933528a9f18e757ef6efac">ProgAngularProjectionMatching::search5d_yoff</a></div><div class="ttdeci">std::vector&lt; int &gt; search5d_yoff</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00129">angular_projection_matching.h:129</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_afc2430b6b28898178fb61bb50c1e39c8"><div class="ttname"><a href="classProgAngularProjectionMatching.html#afc2430b6b28898178fb61bb50c1e39c8">ProgAngularProjectionMatching::proj_ref</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * proj_ref</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00114">angular_projection_matching.h:114</a></div></div>
<div class="ttc" id="classFileName_html_ab10d5ada0f956aef14ae171f12587d56"><div class="ttname"><a href="classFileName.html#ab10d5ada0f956aef14ae171f12587d56">FileName::compose</a></div><div class="ttdeci">void compose(const String &amp;str, const size_t no, const String &amp;ext=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8cpp_source.html#l00049">xmipp_filename.cpp:49</a></div></div>
<div class="ttc" id="classMetaData_html"><div class="ttname"><a href="classMetaData.html">MetaData</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00234">metadata.h:234</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aadc634e170de9a09b2870fab90bd0dac"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aadc634e170de9a09b2870fab90bd0dac">ProgAngularProjectionMatching::fP_ref</a></div><div class="ttdeci">Polar&lt; std::complex&lt; double &gt; &gt; * fP_ref</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00112">angular_projection_matching.h:112</a></div></div>
<div class="ttc" id="classMetaData_html_ab7f8d43d77647ade923e6cd63eafdd03"><div class="ttname"><a href="classMetaData.html#ab7f8d43d77647ade923e6cd63eafdd03">MetaData::read</a></div><div class="ttdeci">void read(const FileName &amp;inFile, const std::vector&lt; MDLabel &gt; *desiredLabels=NULL, bool decomposeStack=true)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l01447">metadata.cpp:1447</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aaba89018a8188da52ee900de49a93ed78"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aaba89018a8188da52ee900de49a93ed78">ERR_MULTIDIM_SIZE</a></div><div class="ttdoc">Incorrect MultidimArray size. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00179">xmipp_error.h:179</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aca9eed5afc4442b6f6173b8d47046fe6"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aca9eed5afc4442b6f6173b8d47046fe6">ProgAngularProjectionMatching::fn_ctf</a></div><div class="ttdeci">FileName fn_ctf</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00078">angular_projection_matching.h:78</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00068">xmipp_filename.h:68</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa35785e227d66cac9143e107ce136b9df"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa35785e227d66cac9143e107ce136b9df">ERR_MEM_BADREQUEST</a></div><div class="ttdoc">Bad amount of memory requested. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00170">xmipp_error.h:170</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_add0977a6148a63070a4c91eba71ee9cb"><div class="ttname"><a href="classProgAngularProjectionMatching.html#add0977a6148a63070a4c91eba71ee9cb">ProgAngularProjectionMatching::paddim</a></div><div class="ttdeci">size_t paddim</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00084">angular_projection_matching.h:84</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aa225d6d9aa1a2349b3fe8bfac7c61be3"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aa225d6d9aa1a2349b3fe8bfac7c61be3">ProgAngularProjectionMatching::fn_ref</a></div><div class="ttdeci">FileName fn_ref</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00078">angular_projection_matching.h:78</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a037f376e933b93134ca3d6f117e3d756"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a037f376e933b93134ca3d6f117e3d756">ProgAngularProjectionMatching::nr_trans</a></div><div class="ttdeci">size_t nr_trans</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00139">angular_projection_matching.h:139</a></div></div>
<div class="ttc" id="group__CTFSupport_html_ga3225da29d9d6bc5b4d43752660bfd10d"><div class="ttname"><a href="group__CTFSupport.html#ga3225da29d9d6bc5b4d43752660bfd10d">CTFDescription::read</a></div><div class="ttdeci">void read(const FileName &amp;fn, bool disable_if_not_K=true)</div><div class="ttdef"><b>Definition:</b> <a href="ctf_8cpp_source.html#l01216">ctf.cpp:1216</a></div></div>
<div class="ttc" id="group__CTFSupport_html_ga3cdc4a8beb7e3b37ee8089a5e474852d"><div class="ttname"><a href="group__CTFSupport.html#ga3cdc4a8beb7e3b37ee8089a5e474852d">CTFDescription::DeltafU</a></div><div class="ttdeci">double DeltafU</div><div class="ttdoc">Global gain. By default, 1. </div><div class="ttdef"><b>Definition:</b> <a href="ctf_8h_source.html#l00827">ctf.h:827</a></div></div>
<div class="ttc" id="group__CTFSupport_html_ga05d00aaebfb6507b217c76b63ffb34a6"><div class="ttname"><a href="group__CTFSupport.html#ga05d00aaebfb6507b217c76b63ffb34a6">CTFDescription1D::enable_CTF</a></div><div class="ttdeci">bool enable_CTF</div><div class="ttdoc">Enable CTF part. </div><div class="ttdef"><b>Definition:</b> <a href="ctf_8h_source.html#l00278">ctf.h:278</a></div></div>
<div class="ttc" id="classMetaData_html_a2239fbb7e492654f1e2866ab27492a5d"><div class="ttname"><a href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">MetaData::getValue</a></div><div class="ttdeci">bool getValue(MDObject &amp;mdValueOut, size_t id) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00217">metadata.cpp:217</a></div></div>
<div class="ttc" id="classSampling_html_a7d33097f53b734cdd8de3792d5134d1c"><div class="ttname"><a href="classSampling.html#a7d33097f53b734cdd8de3792d5134d1c">Sampling::no_redundant_sampling_points_index</a></div><div class="ttdeci">std::vector&lt; size_t &gt; no_redundant_sampling_points_index</div><div class="ttdef"><b>Definition:</b> <a href="sampling_8h_source.html#l00125">sampling.h:125</a></div></div>
<div class="ttc" id="classSampling_html_a7aa0d4768d26e69305afbbb36e5eb797"><div class="ttname"><a href="classSampling.html#a7aa0d4768d26e69305afbbb36e5eb797">Sampling::numberSamplesAsymmetricUnit</a></div><div class="ttdeci">size_t numberSamplesAsymmetricUnit</div><div class="ttdef"><b>Definition:</b> <a href="sampling_8h_source.html#l00080">sampling.h:80</a></div></div>
<div class="ttc" id="classPolar_html_a0ade05210836a466416ffcb85eb1dd4e"><div class="ttname"><a href="classPolar.html#a0ade05210836a466416ffcb85eb1dd4e">Polar::getPolarFromCartesianBSpline</a></div><div class="ttdeci">void getPolarFromCartesianBSpline(const MultidimArray&lt; T &gt; &amp;M1, int first_ring, int last_ring, int BsplineOrder=3, double xoff=0., double yoff=0., double oversample1=1., int mode1=FULL_CIRCLES)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00615">polar.h:615</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a723e4a9d596d440137c0a59a6582742b"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a723e4a9d596d440137c0a59a6582742b">ProgAngularProjectionMatching::pad</a></div><div class="ttdeci">double pad</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00086">angular_projection_matching.h:86</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a9c3b2ace08c588a370b41162bd04a3ee"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a9c3b2ace08c588a370b41162bd04a3ee">ProgAngularProjectionMatching::DFexp</a></div><div class="ttdeci">MetaData DFexp</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00080">angular_projection_matching.h:80</a></div></div>
<div class="ttc" id="group__MetaData_html_ggaef400c43b34e3ecc3f7b342aa821395dadb45120aafd37a973140edee24708065"><div class="ttname"><a href="group__MetaData.html#ggaef400c43b34e3ecc3f7b342aa821395dadb45120aafd37a973140edee24708065">LEFT</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata__sql_8h_source.html#l00059">metadata_sql.h:59</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a4840d3dcdfe64b6fd3a02096e6c83573"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a4840d3dcdfe64b6fd3a02096e6c83573">ProgAngularProjectionMatching::stddev_ref</a></div><div class="ttdeci">double * stddev_ref</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00118">angular_projection_matching.h:118</a></div></div>
<div class="ttc" id="classCTFDescription_html"><div class="ttname"><a href="classCTFDescription.html">CTFDescription</a></div><div class="ttdef"><b>Definition:</b> <a href="ctf_8h_source.html#l00781">ctf.h:781</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gafa02b309a507bf04daf9f31fa828ce4f"><div class="ttname"><a href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a></div><div class="ttdeci">#define dAij(M, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00355">multidim_array.h:355</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gab8a49d8335f45ebd2ba7d86d98322bc0"><div class="ttname"><a href="group__GeometricalTransformations.html#gab8a49d8335f45ebd2ba7d86d98322bc0">BSPLINE3</a></div><div class="ttdeci">#define BSPLINE3</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00210">transformations.h:210</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a9ceadd76e62fefe80a4fc832fca2c00f"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a9ceadd76e62fefe80a4fc832fca2c00f">ProgAngularProjectionMatching::loop_forward_refs</a></div><div class="ttdeci">bool loop_forward_refs</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00123">angular_projection_matching.h:123</a></div></div>
<div class="ttc" id="classMetaData_html_a1a76384897857d639447524ff2f14ab3"><div class="ttname"><a href="classMetaData.html#a1a76384897857d639447524ff2f14ab3">MetaData::findObjects</a></div><div class="ttdeci">void findObjects(std::vector&lt; size_t &gt; &amp;objectsOut, const MDQuery &amp;query) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00868">metadata.cpp:868</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a450a2dfc609d2b3003e3e998878082dc"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a450a2dfc609d2b3003e3e998878082dc">ProgAngularProjectionMatching::fPm_img</a></div><div class="ttdeci">Polar&lt; std::complex&lt; double &gt; &gt; * fPm_img</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00112">angular_projection_matching.h:112</a></div></div>
<div class="ttc" id="group__Macros_html_gac9ae6a207f10c821b06a8c0df153a7d5"><div class="ttname"><a href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a></div><div class="ttdeci">#define XMIPP_MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00181">xmipp_macros.h:181</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a5e8acf7bc77be451a429e9ae8af5c37b"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a5e8acf7bc77be451a429e9ae8af5c37b">ProgAngularProjectionMatching::max_nr_refs_in_memory</a></div><div class="ttdeci">int max_nr_refs_in_memory</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00094">angular_projection_matching.h:94</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a9562d86a126dcc1d8c50cd861f616d40"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a9562d86a126dcc1d8c50cd861f616d40">ProgAngularProjectionMatching::max_nr_imgs_in_memory</a></div><div class="ttdeci">int max_nr_imgs_in_memory</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00099">angular_projection_matching.h:99</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classProjection_html"><div class="ttname"><a href="classProjection.html">Projection</a></div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00056">fourier_projection.h:56</a></div></div>
<div class="ttc" id="group__Polar_html_ga02e5b456ea900d6023ee4170514b9864"><div class="ttname"><a href="group__Polar.html#ga02e5b456ea900d6023ee4170514b9864">fourierTransformRings</a></div><div class="ttdeci">void fourierTransformRings(Polar&lt; double &gt; &amp;in, Polar&lt; std::complex&lt; double &gt; &gt; &amp;out, Polar_fftw_plans &amp;plans, bool conjugated)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8cpp_source.html#l00033">polar.cpp:33</a></div></div>
<div class="ttc" id="group__CTFSupport_html_ga827ec32b7dfce0e4b4b4f43013d4fc7c"><div class="ttname"><a href="group__CTFSupport.html#ga827ec32b7dfce0e4b4b4f43013d4fc7c">CTFDescription::generateCTF</a></div><div class="ttdeci">void generateCTF(const MultidimArray&lt; T1 &gt; &amp;sample_image, MultidimArray&lt; T2 &gt; &amp;CTF, double Ts=-1)</div><div class="ttdef"><b>Definition:</b> <a href="ctf_8h_source.html#l01218">ctf.h:1218</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a4e644422e07a3dc04ffcc5dbdb34eb52"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a4e644422e07a3dc04ffcc5dbdb34eb52">ProgAngularProjectionMatching::stddev_img</a></div><div class="ttdeci">double * stddev_img</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00118">angular_projection_matching.h:118</a></div></div>
<div class="ttc" id="classMetaData_html_abefe17481ebbbed346fdfc185812cdf3"><div class="ttname"><a href="classMetaData.html#abefe17481ebbbed346fdfc185812cdf3">MetaData::join1</a></div><div class="ttdeci">void join1(const MetaData &amp;mdInLeft, const MetaData &amp;mdInRight, const MDLabel label, JoinType type=LEFT)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l02106">metadata.cpp:2106</a></div></div>
<div class="ttc" id="classSampling_html_ac9f047f9c486e2d8797ee82a595ad3c9"><div class="ttname"><a href="classSampling.html#ac9f047f9c486e2d8797ee82a595ad3c9">Sampling::readSamplingFile</a></div><div class="ttdeci">void readSamplingFile(const FileName &amp;infilename, bool read_vectors=true, bool read_sampling_sphere=false)</div><div class="ttdef"><b>Definition:</b> <a href="sampling_8cpp_source.html#l01586">sampling.cpp:1586</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_ac043b262d9dc89979be1587b43dbe937"><div class="ttname"><a href="classProgAngularProjectionMatching.html#ac043b262d9dc89979be1587b43dbe937">ProgAngularProjectionMatching::threads</a></div><div class="ttdeci">int threads</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00135">angular_projection_matching.h:135</a></div></div>
<div class="ttc" id="classSampling_html_aab3b11080881b21b6de327a8f86d5d71"><div class="ttname"><a href="classSampling.html#aab3b11080881b21b6de327a8f86d5d71">Sampling::no_redundant_sampling_points_angles</a></div><div class="ttdeci">std::vector&lt; Matrix1D&lt; double &gt; &gt; no_redundant_sampling_points_angles</div><div class="ttdef"><b>Definition:</b> <a href="sampling_8h_source.html#l00123">sampling.h:123</a></div></div>
<div class="ttc" id="classPolar_html_acec5f869748f42d3b521f1db65fd8897"><div class="ttname"><a href="classPolar.html#acec5f869748f42d3b521f1db65fd8897">Polar::getSampleNo</a></div><div class="ttdeci">int getSampleNo(int iring) const </div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00367">polar.h:367</a></div></div>
<div class="ttc" id="classPolar_html"><div class="ttname"><a href="classPolar.html">Polar</a></div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00061">polar.h:61</a></div></div>
<div class="ttc" id="classFileName_html_a1a69f3a90c51e46490576d28f9eddfab"><div class="ttname"><a href="classFileName.html#a1a69f3a90c51e46490576d28f9eddfab">FileName::isMetaData</a></div><div class="ttdeci">bool isMetaData(bool failIfNotExists=true) const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8cpp_source.html#l00548">xmipp_filename.cpp:548</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4e8db4e5757ca2f6e233d0a1eec7ff1c"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00519">multidim_array.h:519</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_ab67ae2242d1cd1fd2c1b106b1debff2d"><div class="ttname"><a href="classProgAngularProjectionMatching.html#ab67ae2242d1cd1fd2c1b106b1debff2d">ProgAngularProjectionMatching::Ro</a></div><div class="ttdeci">int Ro</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00090">angular_projection_matching.h:90</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aee78ecf7a18389e52940b9f4bf5dcff6"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aee78ecf7a18389e52940b9f4bf5dcff6">ProgAngularProjectionMatching::fP_img</a></div><div class="ttdeci">Polar&lt; std::complex&lt; double &gt; &gt; * fP_img</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00112">angular_projection_matching.h:112</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aeb35527c73b27e78c3ceb5cd3721f195"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aeb35527c73b27e78c3ceb5cd3721f195">ProgAngularProjectionMatching::pointer_refsinmem2allrefs</a></div><div class="ttdeci">std::vector&lt; int &gt; pointer_refsinmem2allrefs</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00106">angular_projection_matching.h:106</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_ac2959661621ae5d67cb604302bb91d74"><div class="ttname"><a href="classProgAngularProjectionMatching.html#ac2959661621ae5d67cb604302bb91d74">ProgAngularProjectionMatching::convert_refno_to_stack_position</a></div><div class="ttdeci">std::vector&lt; size_t &gt; convert_refno_to_stack_position</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00108">angular_projection_matching.h:108</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="xmipp__strings_8h_html_afbeda3fd1bdc8c37d01bdf9f5c8274ff"><div class="ttname"><a href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a></div><div class="ttdeci">std::string String</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__strings_8h_source.html#l00034">xmipp_strings.h:34</a></div></div>
<div class="ttc" id="group__CTFSupport_html_gaf7c2db081b566837a909634b8dba6caf"><div class="ttname"><a href="group__CTFSupport.html#gaf7c2db081b566837a909634b8dba6caf">CTFDescription::produceSideInfo</a></div><div class="ttdeci">void produceSideInfo()</div><div class="ttdoc">Produce Side information. </div><div class="ttdef"><b>Definition:</b> <a href="ctf_8cpp_source.html#l01387">ctf.cpp:1387</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_ae9043a07e1507976fff101ec37eab8f2"><div class="ttname"><a href="classProgAngularProjectionMatching.html#ae9043a07e1507976fff101ec37eab8f2">ProgAngularProjectionMatching::counter_refs_in_memory</a></div><div class="ttdeci">int counter_refs_in_memory</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00103">angular_projection_matching.h:103</a></div></div>
<div class="ttc" id="classImageBase_html_a88636b7a7bd4e0e454877e691ee2da84"><div class="ttname"><a href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">ImageBase::read</a></div><div class="ttdeci">int read(const FileName &amp;name, DataMode datamode=DATA, size_t select_img=ALL_IMAGES, bool mapData=false, int mode=WRITE_READONLY)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00061">xmipp_image_base.cpp:61</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a989c2a0cdf20f2717d5e80baabfc40e5"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a989c2a0cdf20f2717d5e80baabfc40e5">ProgAngularProjectionMatching::search5d_shift</a></div><div class="ttdeci">int search5d_shift</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00125">angular_projection_matching.h:125</a></div></div>
<div class="ttc" id="xmipp__image__macros_8h_html_a351b4f5340ffda2f0414b8bbd9704347"><div class="ttname"><a href="xmipp__image__macros_8h.html#a351b4f5340ffda2f0414b8bbd9704347">FIRST_IMAGE</a></div><div class="ttdeci">#define FIRST_IMAGE</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__macros_8h_source.html#l00038">xmipp_image_macros.h:38</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a1658eaa42a37fdcd6bffdd72a34af947"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a1658eaa42a37fdcd6bffdd72a34af947">ProgAngularProjectionMatching::max_shift</a></div><div class="ttdeci">double max_shift</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00088">angular_projection_matching.h:88</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a67bce09ceb3bada415d302b03613d3b9"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a67bce09ceb3bada415d302b03613d3b9">ProgAngularProjectionMatching::Mctf</a></div><div class="ttdeci">MultidimArray&lt; double &gt; Mctf</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00131">angular_projection_matching.h:131</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a60f6e7892e2cac3c25be6d46a4f9bdc5"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a60f6e7892e2cac3c25be6d46a4f9bdc5">ProgAngularProjectionMatching::Ri</a></div><div class="ttdeci">int Ri</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00090">angular_projection_matching.h:90</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a1c2f248db52457e702e7d626ba3e6547"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a1c2f248db52457e702e7d626ba3e6547">ProgAngularProjectionMatching::thread_barrier</a></div><div class="ttdeci">barrier_t thread_barrier</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00141">angular_projection_matching.h:141</a></div></div>
<div class="ttc" id="classMetaData_html_a9f88f42faff8bfbc1952c50e2a6ffc42"><div class="ttname"><a href="classMetaData.html#a9f88f42faff8bfbc1952c50e2a6ffc42">MetaData::firstObject</a></div><div class="ttdeci">size_t firstObject() const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00849">metadata.cpp:849</a></div></div>
<div class="ttc" id="classPolar_html_a67490e990718a2221935ca2c017db1fb"><div class="ttname"><a href="classPolar.html#a67490e990718a2221935ca2c017db1fb">Polar::calculateFftwPlans</a></div><div class="ttdeci">void calculateFftwPlans(Polar_fftw_plans &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00724">polar.h:724</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a></div><div class="ttdoc">Incorrect value received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00200">xmipp_error.h:200</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a></div><div class="ttdoc">Name of an image (std::string) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00235">metadata_label.h:235</a></div></div>
<div class="ttc" id="classPolar_html_a471898c3d9ddca4db17d368cd583482a"><div class="ttname"><a href="classPolar.html#a471898c3d9ddca4db17d368cd583482a">Polar::getRingNo</a></div><div class="ttdeci">int getRingNo() const </div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00320">polar.h:320</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a991ca775d86372b59bfaa3bdaf13006a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProgAngularProjectionMatching::readParams </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read arguments from command line. </p>

<p>Reimplemented from <a class="el" href="classXmippProgram.html#a4f3c0b1ec483442cf6a2cba6666baa18">XmippProgram</a>.</p>

<p>Reimplemented in <a class="el" href="classMpiProgAngularProjectionMatching.html#a3afa14d9bbd3aa5a22ef4e400c4db81e">MpiProgAngularProjectionMatching</a>.</p>

<p>Definition at line <a class="el" href="angular__projection__matching_8cpp_source.html#l00040">40</a> of file <a class="el" href="angular__projection__matching_8cpp_source.html">angular_projection_matching.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;{</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a27562024b9dfcc0ff3c14927bcd2707f">fn_exp</a>  = <a class="code" href="classXmippProgram.html#a5d9e1f008822effa47814c59e9a3c797">getParam</a>(<span class="stringliteral">&quot;-i&quot;</span>);</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a0059ca01a9a2e534f234a86f1baa80cd">fn_out</a>  = <a class="code" href="classXmippProgram.html#a5d9e1f008822effa47814c59e9a3c797">getParam</a>(<span class="stringliteral">&quot;-o&quot;</span>);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#aa225d6d9aa1a2349b3fe8bfac7c61be3">fn_ref</a>  = <a class="code" href="classXmippProgram.html#a5d9e1f008822effa47814c59e9a3c797">getParam</a>(<span class="stringliteral">&quot;--ref&quot;</span>);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// Additional commands</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a723e4a9d596d440137c0a59a6582742b">pad</a>=<a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(1.,<a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--pad&quot;</span>));</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a60f6e7892e2cac3c25be6d46a4f9bdc5">Ri</a>=<a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--Ri&quot;</span>);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#ab67ae2242d1cd1fd2c1b106b1debff2d">Ro</a>=<a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--Ro&quot;</span>);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a989c2a0cdf20f2717d5e80baabfc40e5">search5d_shift</a>  = <a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--search5d_shift&quot;</span>);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a9ab38e7253df6c449dc6322e4c46b83b">search5d_step</a> = <a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--search5d_step&quot;</span>);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a1658eaa42a37fdcd6bffdd72a34af947">max_shift</a> = <a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--max_shift&quot;</span>);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">numOrientations</a> = <a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--number_orientations&quot;</span>);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a20cca02bbe41ebcdba66c9e358c98559">avail_memory</a> = <a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--mem&quot;</span>);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--ctf&quot;</span>))</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#aca9eed5afc4442b6f6173b8d47046fe6">fn_ctf</a>  = <a class="code" href="classXmippProgram.html#a5d9e1f008822effa47814c59e9a3c797">getParam</a>(<span class="stringliteral">&quot;--ctf&quot;</span>);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#ac612a8a129d906023ff929ec80552f90">phase_flipped</a> = <a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--phase_flipped&quot;</span>);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#ac043b262d9dc89979be1587b43dbe937">threads</a> = <a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--thr&quot;</span>);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#aed805df963ac159ce0e697ccdec2d976">do_scale</a> = <a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--scale&quot;</span>);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--append&quot;</span>))</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#a10583dbac123156edd53f645fe731461">do_overwrite</a> = <a class="code" href="group__MetaData.html#ggaf446b6aff4a8c034231bfa3e1484bc47ae658bd63b5c203ea5e350a42881a57ca">MD_APPEND</a>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#a10583dbac123156edd53f645fe731461">do_overwrite</a> = <a class="code" href="group__MetaData.html#ggaf446b6aff4a8c034231bfa3e1484bc47aca6136ade8aaab2a5da1a8f56f8c6dd0">MD_OVERWRITE</a>;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classProgAngularProjectionMatching.html#aed805df963ac159ce0e697ccdec2d976">do_scale</a>)</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#a173d1e4af96024b6af24100bb464d448">scale_step</a> = <a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--scale&quot;</span>,0);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="comment">//Scale Step can&#39;t be 0</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgAngularProjectionMatching.html#a173d1e4af96024b6af24100bb464d448">scale_step</a> == 0)</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <a class="code" href="classProgAngularProjectionMatching.html#a173d1e4af96024b6af24100bb464d448">scale_step</a> = 1;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#a59e923cfadebda6ca0585bb4982408fd">scale_nsteps</a> = <a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--scale&quot;</span>,1);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    }</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div><div class="ttc" id="classProgAngularProjectionMatching_html_a20cca02bbe41ebcdba66c9e358c98559"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a20cca02bbe41ebcdba66c9e358c98559">ProgAngularProjectionMatching::avail_memory</a></div><div class="ttdeci">double avail_memory</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00092">angular_projection_matching.h:92</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a59e923cfadebda6ca0585bb4982408fd"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a59e923cfadebda6ca0585bb4982408fd">ProgAngularProjectionMatching::scale_nsteps</a></div><div class="ttdeci">double scale_nsteps</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00147">angular_projection_matching.h:147</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_ac612a8a129d906023ff929ec80552f90"><div class="ttname"><a href="classProgAngularProjectionMatching.html#ac612a8a129d906023ff929ec80552f90">ProgAngularProjectionMatching::phase_flipped</a></div><div class="ttdeci">bool phase_flipped</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00133">angular_projection_matching.h:133</a></div></div>
<div class="ttc" id="group__Macros_html_gae0a4180e923e3ffca3989e20e441aa3c"><div class="ttname"><a href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a></div><div class="ttdeci">#define XMIPP_MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00193">xmipp_macros.h:193</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a10583dbac123156edd53f645fe731461"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a10583dbac123156edd53f645fe731461">ProgAngularProjectionMatching::do_overwrite</a></div><div class="ttdeci">WriteModeMetaData do_overwrite</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00145">angular_projection_matching.h:145</a></div></div>
<div class="ttc" id="classXmippProgram_html_a552e1ea4a84576d9149b965d9edb6277"><div class="ttname"><a href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">XmippProgram::getDoubleParam</a></div><div class="ttdeci">double getDoubleParam(const char *param, int arg=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00397">xmipp_program.cpp:397</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a0059ca01a9a2e534f234a86f1baa80cd"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a0059ca01a9a2e534f234a86f1baa80cd">ProgAngularProjectionMatching::fn_out</a></div><div class="ttdeci">FileName fn_out</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00078">angular_projection_matching.h:78</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a9ab38e7253df6c449dc6322e4c46b83b"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a9ab38e7253df6c449dc6322e4c46b83b">ProgAngularProjectionMatching::search5d_step</a></div><div class="ttdeci">int search5d_step</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00127">angular_projection_matching.h:127</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a27562024b9dfcc0ff3c14927bcd2707f"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a27562024b9dfcc0ff3c14927bcd2707f">ProgAngularProjectionMatching::fn_exp</a></div><div class="ttdeci">FileName fn_exp</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00078">angular_projection_matching.h:78</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a173d1e4af96024b6af24100bb464d448"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a173d1e4af96024b6af24100bb464d448">ProgAngularProjectionMatching::scale_step</a></div><div class="ttdeci">double scale_step</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00146">angular_projection_matching.h:146</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a7557dbd7c4833be2a957e4775d899ccc"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">ProgAngularProjectionMatching::numOrientations</a></div><div class="ttdeci">int numOrientations</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00137">angular_projection_matching.h:137</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aca9eed5afc4442b6f6173b8d47046fe6"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aca9eed5afc4442b6f6173b8d47046fe6">ProgAngularProjectionMatching::fn_ctf</a></div><div class="ttdeci">FileName fn_ctf</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00078">angular_projection_matching.h:78</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aa225d6d9aa1a2349b3fe8bfac7c61be3"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aa225d6d9aa1a2349b3fe8bfac7c61be3">ProgAngularProjectionMatching::fn_ref</a></div><div class="ttdeci">FileName fn_ref</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00078">angular_projection_matching.h:78</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aed805df963ac159ce0e697ccdec2d976"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aed805df963ac159ce0e697ccdec2d976">ProgAngularProjectionMatching::do_scale</a></div><div class="ttdeci">bool do_scale</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00144">angular_projection_matching.h:144</a></div></div>
<div class="ttc" id="classXmippProgram_html_a5d9e1f008822effa47814c59e9a3c797"><div class="ttname"><a href="classXmippProgram.html#a5d9e1f008822effa47814c59e9a3c797">XmippProgram::getParam</a></div><div class="ttdeci">const char * getParam(const char *param, int arg=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00377">xmipp_program.cpp:377</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a723e4a9d596d440137c0a59a6582742b"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a723e4a9d596d440137c0a59a6582742b">ProgAngularProjectionMatching::pad</a></div><div class="ttdeci">double pad</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00086">angular_projection_matching.h:86</a></div></div>
<div class="ttc" id="group__MetaData_html_ggaf446b6aff4a8c034231bfa3e1484bc47ae658bd63b5c203ea5e350a42881a57ca"><div class="ttname"><a href="group__MetaData.html#ggaf446b6aff4a8c034231bfa3e1484bc47ae658bd63b5c203ea5e350a42881a57ca">MD_APPEND</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00060">metadata.h:60</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_ac043b262d9dc89979be1587b43dbe937"><div class="ttname"><a href="classProgAngularProjectionMatching.html#ac043b262d9dc89979be1587b43dbe937">ProgAngularProjectionMatching::threads</a></div><div class="ttdeci">int threads</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00135">angular_projection_matching.h:135</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_ab67ae2242d1cd1fd2c1b106b1debff2d"><div class="ttname"><a href="classProgAngularProjectionMatching.html#ab67ae2242d1cd1fd2c1b106b1debff2d">ProgAngularProjectionMatching::Ro</a></div><div class="ttdeci">int Ro</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00090">angular_projection_matching.h:90</a></div></div>
<div class="ttc" id="classXmippProgram_html_a1a27c450de95c55d122be23e3fe89ac1"><div class="ttname"><a href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">XmippProgram::checkParam</a></div><div class="ttdeci">bool checkParam(const char *param)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00425">xmipp_program.cpp:425</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a989c2a0cdf20f2717d5e80baabfc40e5"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a989c2a0cdf20f2717d5e80baabfc40e5">ProgAngularProjectionMatching::search5d_shift</a></div><div class="ttdeci">int search5d_shift</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00125">angular_projection_matching.h:125</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a1658eaa42a37fdcd6bffdd72a34af947"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a1658eaa42a37fdcd6bffdd72a34af947">ProgAngularProjectionMatching::max_shift</a></div><div class="ttdeci">double max_shift</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00088">angular_projection_matching.h:88</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a60f6e7892e2cac3c25be6d46a4f9bdc5"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a60f6e7892e2cac3c25be6d46a4f9bdc5">ProgAngularProjectionMatching::Ri</a></div><div class="ttdeci">int Ri</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00090">angular_projection_matching.h:90</a></div></div>
<div class="ttc" id="classXmippProgram_html_a7b7ddf0836dc1079ea2622e2a420c39c"><div class="ttname"><a href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">XmippProgram::getIntParam</a></div><div class="ttdeci">int getIntParam(const char *param, int arg=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00387">xmipp_program.cpp:387</a></div></div>
<div class="ttc" id="group__MetaData_html_ggaf446b6aff4a8c034231bfa3e1484bc47aca6136ade8aaab2a5da1a8f56f8c6dd0"><div class="ttname"><a href="group__MetaData.html#ggaf446b6aff4a8c034231bfa3e1484bc47aca6136ade8aaab2a5da1a8f56f8c6dd0">MD_OVERWRITE</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00059">metadata.h:59</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a781a97d7cc14a3d012d0de7546f7f4f6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgAngularProjectionMatching::rotationallyAlignOneImage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>imgno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>opt_samplenr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>opt_psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>opt_flip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>maxcorr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Rotational alignment using polar coordinates The input image is assumed to be in FTs of polar rings </p>

</div>
</div>
<a class="anchor" id="a457f6dd4750dc5487c210046c01fd000"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProgAngularProjectionMatching::run </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Run. </p>

<p>Reimplemented from <a class="el" href="classXmippProgram.html#a1d64156309778b3416ba0a153db21447">XmippProgram</a>.</p>

<p>Definition at line <a class="el" href="angular__projection__matching_8cpp_source.html#l00178">178</a> of file <a class="el" href="angular__projection__matching_8cpp_source.html">angular_projection_matching.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;{</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#abf2390e35441f03aba73075a813e9e77">produceSideInfo</a>();</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a33ca91be8f4ac708b3d44f03e6bb9c64">show</a>();</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a7247ba61ac3387ec73ba05fbe9d5dfef">processAllImages</a>();</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#ac0215f85731724322fc3f33a89ce8014">writeOutputFiles</a>();</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#aa1fc871c4f2f0f90e1d4cf62d775c8c3">destroyAndClean</a>();</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a>)</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;done!&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div><div class="ttc" id="classProgAngularProjectionMatching_html_a33ca91be8f4ac708b3d44f03e6bb9c64"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a33ca91be8f4ac708b3d44f03e6bb9c64">ProgAngularProjectionMatching::show</a></div><div class="ttdeci">void show()</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8cpp_source.html#l00120">angular_projection_matching.cpp:120</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_ac0215f85731724322fc3f33a89ce8014"><div class="ttname"><a href="classProgAngularProjectionMatching.html#ac0215f85731724322fc3f33a89ce8014">ProgAngularProjectionMatching::writeOutputFiles</a></div><div class="ttdeci">virtual void writeOutputFiles()</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8cpp_source.html#l01250">angular_projection_matching.cpp:1250</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_abf2390e35441f03aba73075a813e9e77"><div class="ttname"><a href="classProgAngularProjectionMatching.html#abf2390e35441f03aba73075a813e9e77">ProgAngularProjectionMatching::produceSideInfo</a></div><div class="ttdeci">virtual void produceSideInfo()</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8cpp_source.html#l00205">angular_projection_matching.cpp:205</a></div></div>
<div class="ttc" id="classXmippProgram_html_aed62cfe3c074e69076bf348fc101a717"><div class="ttname"><a href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">XmippProgram::verbose</a></div><div class="ttdeci">int verbose</div><div class="ttdoc">Verbosity level. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8h_source.html#l00168">xmipp_program.h:168</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a7247ba61ac3387ec73ba05fbe9d5dfef"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a7247ba61ac3387ec73ba05fbe9d5dfef">ProgAngularProjectionMatching::processAllImages</a></div><div class="ttdeci">virtual void processAllImages()</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8cpp_source.html#l00974">angular_projection_matching.cpp:974</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aa1fc871c4f2f0f90e1d4cf62d775c8c3"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aa1fc871c4f2f0f90e1d4cf62d775c8c3">ProgAngularProjectionMatching::destroyAndClean</a></div><div class="ttdeci">void destroyAndClean()</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8cpp_source.html#l00193">angular_projection_matching.cpp:193</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a060fce387f382e53d5f216fdd4ed404a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgAngularProjectionMatching::scaleAlignOneImage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>samplenr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>opt_flip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>opt_xoff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>opt_yoff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>old_scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>opt_scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>maxcorr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Translational alignment using cartesian coordinates The optimal direction is re-projected from the volume </p>
<p>a </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8cpp_source.html#l00867">867</a> of file <a class="el" href="angular__projection__matching_8cpp_source.html">angular_projection_matching.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;{</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Mscale,Mtrans,Mref,Mimg;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keywordtype">int</span> refno;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    Mscale.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    Mtrans.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    Mref.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    Mimg.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="preprocessor">#ifdef TIMING</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <a class="code" href="group__GeneralFunctions.html#ga5de338a0f59b7f4fe678fadfeb1c0049">TimeStamp</a> t0,t1,t2;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <a class="code" href="group__GeneralFunctions.html#ga30c9706995a8be40c4b2dbe055cdaede">time_config</a>();</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <a class="code" href="group__GeneralFunctions.html#ga4c1f5b466a107f359a15279ca1781392">annotate_time</a>(&amp;t0);</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="comment">// ROTATE + SHIFT</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="comment">// Transformation matrix</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> A(3,3);</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    A.initIdentity();</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordtype">double</span> ang, cosine, sine;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    ang = <a class="code" href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a>(opt_psi);</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    cosine = cos(ang);</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    sine = sin(ang);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="comment">// Rotation</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A,0, 0) = cosine;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A,0, 1) = sine;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A,1, 0) = -sine;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A,1, 1) = cosine;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="comment">// Shift</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A,0, 2) = -opt_xoff;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A,1, 2) = -opt_yoff;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="comment">// Multiply shifts by old_scale</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keywordflow">if</span> (opt_flip)</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    {</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A,0, 2) = opt_xoff;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A,0, 0) *= -1.;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A,0, 1) *= -1.;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    }</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="comment">// Get pointer to the correct reference image in memory</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    refno = <a class="code" href="classProgAngularProjectionMatching.html#acd57f432b75da0e346c9c0df1b3e824f">pointer_allrefs2refsinmem</a>[opt_refno];</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="keywordflow">if</span> (refno == -1)</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    {</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <span class="comment">// Reference is not stored in memory (anymore): (re-)read from disc</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#a2a08cfec5754dfeaa806ea6874fc2139">getCurrentReference</a>(opt_refno,<a class="code" href="classProgAngularProjectionMatching.html#aa27a6cf70fecb56ed13b384161bc5248">global_plans</a>);</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        refno = <a class="code" href="classProgAngularProjectionMatching.html#acd57f432b75da0e346c9c0df1b3e824f">pointer_allrefs2refsinmem</a>[opt_refno];</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    }</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a>(<a class="code" href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a>, Mref, <a class="code" href="classProgAngularProjectionMatching.html#afc2430b6b28898178fb61bb50c1e39c8">proj_ref</a>[refno], A, <a class="code" href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a>, <a class="code" href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a>);</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    Mtrans = img;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="comment">// Scale search</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keywordtype">double</span> corr;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    opt_scale = 1;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="comment">//maxcorr = -999;</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="comment">// 1 (0.01 * scale_step * scale_nsteps)</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">double</span> scale = 1 - 0.01 * <a class="code" href="classProgAngularProjectionMatching.html#a173d1e4af96024b6af24100bb464d448">scale_step</a> * <a class="code" href="classProgAngularProjectionMatching.html#a59e923cfadebda6ca0585bb4982408fd">scale_nsteps</a> ;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        scale &lt;= 1 + 0.01 * <a class="code" href="classProgAngularProjectionMatching.html#a173d1e4af96024b6af24100bb464d448">scale_step</a> * <a class="code" href="classProgAngularProjectionMatching.html#a59e923cfadebda6ca0585bb4982408fd">scale_nsteps</a>;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        scale += 0.01 * <a class="code" href="classProgAngularProjectionMatching.html#a173d1e4af96024b6af24100bb464d448">scale_step</a>)</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    {</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <span class="keywordflow">if</span>(scale == 1.)</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        <span class="comment">// apply current scale</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        A.initIdentity();</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        A /= scale;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a>(<a class="code" href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a>, Mscale, Mtrans, A, <a class="code" href="transformations_8h.html#a855436c9d0ed5174df8917d5239d7597">IS_INV</a>, <a class="code" href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a>);</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <span class="comment">//Image spread correction (if scale != 1) for scale search</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        Mscale = Mscale / (scale * scale * old_scale * old_scale);</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        corr = <a class="code" href="group__MultidimensionalArrays.html#ga63cca7e01116967ff451df8b1f8b5a4e">correlationIndex</a>(Mref,Mscale);</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        <span class="comment">// best scale update</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        <span class="keywordflow">if</span>(corr &gt; maxcorr)</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        {</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            opt_scale = scale;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            maxcorr = corr;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        }</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    }</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="preprocessor">#ifdef TIMING</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keywordtype">float</span> total_trans = <a class="code" href="group__GeneralFunctions.html#gac09ae5f9feab6050f92ee446eb09a3d2">elapsed_time</a>(t0);</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    std::cerr&lt;&lt;<span class="stringliteral">&quot; trans%% &quot;</span>&lt;&lt;total_trans &lt;&lt;std::endl;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;}</div><div class="ttc" id="classProgAngularProjectionMatching_html_a59e923cfadebda6ca0585bb4982408fd"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a59e923cfadebda6ca0585bb4982408fd">ProgAngularProjectionMatching::scale_nsteps</a></div><div class="ttdeci">double scale_nsteps</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00147">angular_projection_matching.h:147</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aa27a6cf70fecb56ed13b384161bc5248"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aa27a6cf70fecb56ed13b384161bc5248">ProgAngularProjectionMatching::global_plans</a></div><div class="ttdeci">Polar_fftw_plans global_plans</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00116">angular_projection_matching.h:116</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_acd57f432b75da0e346c9c0df1b3e824f"><div class="ttname"><a href="classProgAngularProjectionMatching.html#acd57f432b75da0e346c9c0df1b3e824f">ProgAngularProjectionMatching::pointer_allrefs2refsinmem</a></div><div class="ttdeci">std::vector&lt; int &gt; pointer_allrefs2refsinmem</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00105">angular_projection_matching.h:105</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a2a08cfec5754dfeaa806ea6874fc2139"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a2a08cfec5754dfeaa806ea6874fc2139">ProgAngularProjectionMatching::getCurrentReference</a></div><div class="ttdeci">void getCurrentReference(int refno, Polar_fftw_plans &amp;local_plans)</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8cpp_source.html#l00404">angular_projection_matching.cpp:404</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Macros_html_gadec1e6bbd34c5cf8765a457da4876c91"><div class="ttname"><a href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a></div><div class="ttdeci">#define DEG2RAD(d)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00312">xmipp_macros.h:312</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga3cc15e5dda7c58b9cacb7eee440d6bdc"><div class="ttname"><a href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a></div><div class="ttdeci">void applyGeometry(int SplineDegree, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V2, const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V1, const Matrix2D&lt; double &gt; &amp;A, bool inv, bool wrap, std::complex&lt; double &gt; outside, MultidimArray&lt; double &gt; *BcoeffsPtr)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00517">transformations.cpp:517</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga63cca7e01116967ff451df8b1f8b5a4e"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga63cca7e01116967ff451df8b1f8b5a4e">correlationIndex</a></div><div class="ttdeci">double correlationIndex(const MultidimArray&lt; T &gt; &amp;x, const MultidimArray&lt; T &gt; &amp;y, const MultidimArray&lt; int &gt; *mask=NULL, MultidimArray&lt; double &gt; *Contributions=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05692">multidim_array.h:5692</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_afc2430b6b28898178fb61bb50c1e39c8"><div class="ttname"><a href="classProgAngularProjectionMatching.html#afc2430b6b28898178fb61bb50c1e39c8">ProgAngularProjectionMatching::proj_ref</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * proj_ref</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00114">angular_projection_matching.h:114</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a173d1e4af96024b6af24100bb464d448"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a173d1e4af96024b6af24100bb464d448">ProgAngularProjectionMatching::scale_step</a></div><div class="ttdeci">double scale_step</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00146">angular_projection_matching.h:146</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_gac09ae5f9feab6050f92ee446eb09a3d2"><div class="ttname"><a href="group__GeneralFunctions.html#gac09ae5f9feab6050f92ee446eb09a3d2">elapsed_time</a></div><div class="ttdeci">double elapsed_time(ProcessorTimeStamp &amp;time, bool _IN_SECS)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00730">xmipp_funcs.cpp:730</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga30c9706995a8be40c4b2dbe055cdaede"><div class="ttname"><a href="group__GeneralFunctions.html#ga30c9706995a8be40c4b2dbe055cdaede">time_config</a></div><div class="ttdeci">void time_config()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00619">xmipp_funcs.cpp:619</a></div></div>
<div class="ttc" id="group__Matrices_html_gab40746be05d4bbf352787018922ecc2e"><div class="ttname"><a href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a></div><div class="ttdeci">#define MAT_ELEM(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00117">matrix2d.h:117</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="transformations_8h_html_a855436c9d0ed5174df8917d5239d7597"><div class="ttname"><a href="transformations_8h.html#a855436c9d0ed5174df8917d5239d7597">IS_INV</a></div><div class="ttdeci">#define IS_INV</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00040">transformations.h:40</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gac645eb9a88619ee6f5e14c557ab8ef62"><div class="ttname"><a href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a></div><div class="ttdeci">#define LINEAR</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00208">transformations.h:208</a></div></div>
<div class="ttc" id="transformations_8h_html_a9fbfdbc149e55def0e63127fcb558d13"><div class="ttname"><a href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a></div><div class="ttdeci">#define DONT_WRAP</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00042">transformations.h:42</a></div></div>
<div class="ttc" id="transformations_8h_html_a3a4a05e15fc1cc8a66159304e4c33eb1"><div class="ttname"><a href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a></div><div class="ttdeci">#define IS_NOT_INV</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00041">transformations.h:41</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga4c1f5b466a107f359a15279ca1781392"><div class="ttname"><a href="group__GeneralFunctions.html#ga4c1f5b466a107f359a15279ca1781392">annotate_time</a></div><div class="ttdeci">void annotate_time(TimeStamp *time)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00637">xmipp_funcs.cpp:637</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga5de338a0f59b7f4fe678fadfeb1c0049"><div class="ttname"><a href="group__GeneralFunctions.html#ga5de338a0f59b7f4fe678fadfeb1c0049">TimeStamp</a></div><div class="ttdeci">size_t TimeStamp</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8h_source.html#l00837">xmipp_funcs.h:837</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a33ca91be8f4ac708b3d44f03e6bb9c64"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgAngularProjectionMatching::show </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Show. </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8cpp_source.html#l00120">120</a> of file <a class="el" href="angular__projection__matching_8cpp_source.html">angular_projection_matching.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;{</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a>)</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    std::cout</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;  Input images            : &quot;</span>&lt;&lt; <a class="code" href="classProgAngularProjectionMatching.html#a27562024b9dfcc0ff3c14927bcd2707f">fn_exp</a> &lt;&lt; std::endl</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;  Output file             : &quot;</span>&lt;&lt; <a class="code" href="classProgAngularProjectionMatching.html#a0059ca01a9a2e534f234a86f1baa80cd">fn_out</a> &lt;&lt; std::endl</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    ;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgAngularProjectionMatching.html#a60f6e7892e2cac3c25be6d46a4f9bdc5">Ri</a>&gt;0)</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;  Inner radius rot-search : &quot;</span> &lt;&lt; <a class="code" href="classProgAngularProjectionMatching.html#a60f6e7892e2cac3c25be6d46a4f9bdc5">Ri</a>&lt;&lt; std::endl;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgAngularProjectionMatching.html#ab67ae2242d1cd1fd2c1b106b1debff2d">Ro</a>&gt;0)</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;  Outer radius rot-search : &quot;</span> &lt;&lt; <a class="code" href="classProgAngularProjectionMatching.html#ab67ae2242d1cd1fd2c1b106b1debff2d">Ro</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgAngularProjectionMatching.html#a5e8acf7bc77be451a429e9ae8af5c37b">max_nr_refs_in_memory</a>&lt;<a class="code" href="classProgAngularProjectionMatching.html#a85cb8e7d09221d99e44a8a2208fd4a22">total_nr_refs</a>)</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;  Number of references    : &quot;</span> &lt;&lt; <a class="code" href="classProgAngularProjectionMatching.html#a85cb8e7d09221d99e44a8a2208fd4a22">total_nr_refs</a> &lt;&lt; std::endl</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;  Nr. refs in memory      : &quot;</span> &lt;&lt; <a class="code" href="classProgAngularProjectionMatching.html#a5e8acf7bc77be451a429e9ae8af5c37b">max_nr_refs_in_memory</a> &lt;&lt; <span class="stringliteral">&quot; (using &quot;</span> &lt;&lt; <a class="code" href="classProgAngularProjectionMatching.html#a20cca02bbe41ebcdba66c9e358c98559">avail_memory</a> &lt;&lt;<span class="stringliteral">&quot; Gb)&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        ;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;  Number of references    : &quot;</span> &lt;&lt; <a class="code" href="classProgAngularProjectionMatching.html#a85cb8e7d09221d99e44a8a2208fd4a22">total_nr_refs</a> &lt;&lt; <span class="stringliteral">&quot; (all stored in memory)&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;  Max. allowed shift      : +/- &quot;</span> &lt;&lt;<a class="code" href="classProgAngularProjectionMatching.html#a1658eaa42a37fdcd6bffdd72a34af947">max_shift</a>&lt;&lt;<span class="stringliteral">&quot; pixels&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgAngularProjectionMatching.html#a989c2a0cdf20f2717d5e80baabfc40e5">search5d_shift</a> &gt; 0)</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;  5D-search shift range   : &quot;</span>&lt;&lt;<a class="code" href="classProgAngularProjectionMatching.html#a989c2a0cdf20f2717d5e80baabfc40e5">search5d_shift</a>&lt;&lt;<span class="stringliteral">&quot; pixels (sampled &quot;</span>&lt;&lt;<a class="code" href="classProgAngularProjectionMatching.html#a037f376e933b93134ca3d6f117e3d756">nr_trans</a>&lt;&lt;<span class="stringliteral">&quot; times)&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    }</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgAngularProjectionMatching.html#aca9eed5afc4442b6f6173b8d47046fe6">fn_ctf</a>!=<span class="stringliteral">&quot;&quot;</span>)</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    {</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classProgAngularProjectionMatching.html#aca9eed5afc4442b6f6173b8d47046fe6">fn_ctf</a>.<a class="code" href="classFileName.html#a1a69f3a90c51e46490576d28f9eddfab">isMetaData</a>())</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;  CTF image               :  &quot;</span> &lt;&lt;<a class="code" href="classProgAngularProjectionMatching.html#aca9eed5afc4442b6f6173b8d47046fe6">fn_ctf</a>&lt;&lt;std::endl;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgAngularProjectionMatching.html#a723e4a9d596d440137c0a59a6582742b">pad</a> &gt; 1.)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;  Padding factor          : &quot;</span>&lt;&lt; <a class="code" href="classProgAngularProjectionMatching.html#a723e4a9d596d440137c0a59a6582742b">pad</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;  CTF parameter file      :  &quot;</span> &lt;&lt;<a class="code" href="classProgAngularProjectionMatching.html#aca9eed5afc4442b6f6173b8d47046fe6">fn_ctf</a>&lt;&lt;std::endl;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgAngularProjectionMatching.html#ac612a8a129d906023ff929ec80552f90">phase_flipped</a>)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;    + Assuming images have been phase flipped &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;    + Assuming images have not been phase flipped &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    }</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgAngularProjectionMatching.html#ac043b262d9dc89979be1587b43dbe937">threads</a>&gt;1)</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;  -&gt; Using &quot;</span>&lt;&lt;<a class="code" href="classProgAngularProjectionMatching.html#ac043b262d9dc89979be1587b43dbe937">threads</a>&lt;&lt;<span class="stringliteral">&quot; parallel threads&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    }</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">numOrientations</a> != 1)</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot;  -&gt; Using &quot;</span>&lt;&lt;<a class="code" href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">numOrientations</a>&lt;&lt;<span class="stringliteral">&quot; possible orientations for each particle&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot; =================================================================&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;}</div><div class="ttc" id="classProgAngularProjectionMatching_html_a20cca02bbe41ebcdba66c9e358c98559"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a20cca02bbe41ebcdba66c9e358c98559">ProgAngularProjectionMatching::avail_memory</a></div><div class="ttdeci">double avail_memory</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00092">angular_projection_matching.h:92</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a85cb8e7d09221d99e44a8a2208fd4a22"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a85cb8e7d09221d99e44a8a2208fd4a22">ProgAngularProjectionMatching::total_nr_refs</a></div><div class="ttdeci">int total_nr_refs</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00101">angular_projection_matching.h:101</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_ac612a8a129d906023ff929ec80552f90"><div class="ttname"><a href="classProgAngularProjectionMatching.html#ac612a8a129d906023ff929ec80552f90">ProgAngularProjectionMatching::phase_flipped</a></div><div class="ttdeci">bool phase_flipped</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00133">angular_projection_matching.h:133</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a0059ca01a9a2e534f234a86f1baa80cd"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a0059ca01a9a2e534f234a86f1baa80cd">ProgAngularProjectionMatching::fn_out</a></div><div class="ttdeci">FileName fn_out</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00078">angular_projection_matching.h:78</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a27562024b9dfcc0ff3c14927bcd2707f"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a27562024b9dfcc0ff3c14927bcd2707f">ProgAngularProjectionMatching::fn_exp</a></div><div class="ttdeci">FileName fn_exp</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00078">angular_projection_matching.h:78</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a7557dbd7c4833be2a957e4775d899ccc"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a7557dbd7c4833be2a957e4775d899ccc">ProgAngularProjectionMatching::numOrientations</a></div><div class="ttdeci">int numOrientations</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00137">angular_projection_matching.h:137</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aca9eed5afc4442b6f6173b8d47046fe6"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aca9eed5afc4442b6f6173b8d47046fe6">ProgAngularProjectionMatching::fn_ctf</a></div><div class="ttdeci">FileName fn_ctf</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00078">angular_projection_matching.h:78</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a037f376e933b93134ca3d6f117e3d756"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a037f376e933b93134ca3d6f117e3d756">ProgAngularProjectionMatching::nr_trans</a></div><div class="ttdeci">size_t nr_trans</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00139">angular_projection_matching.h:139</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a723e4a9d596d440137c0a59a6582742b"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a723e4a9d596d440137c0a59a6582742b">ProgAngularProjectionMatching::pad</a></div><div class="ttdeci">double pad</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00086">angular_projection_matching.h:86</a></div></div>
<div class="ttc" id="classXmippProgram_html_aed62cfe3c074e69076bf348fc101a717"><div class="ttname"><a href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">XmippProgram::verbose</a></div><div class="ttdeci">int verbose</div><div class="ttdoc">Verbosity level. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8h_source.html#l00168">xmipp_program.h:168</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a5e8acf7bc77be451a429e9ae8af5c37b"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a5e8acf7bc77be451a429e9ae8af5c37b">ProgAngularProjectionMatching::max_nr_refs_in_memory</a></div><div class="ttdeci">int max_nr_refs_in_memory</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00094">angular_projection_matching.h:94</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_ac043b262d9dc89979be1587b43dbe937"><div class="ttname"><a href="classProgAngularProjectionMatching.html#ac043b262d9dc89979be1587b43dbe937">ProgAngularProjectionMatching::threads</a></div><div class="ttdeci">int threads</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00135">angular_projection_matching.h:135</a></div></div>
<div class="ttc" id="classFileName_html_a1a69f3a90c51e46490576d28f9eddfab"><div class="ttname"><a href="classFileName.html#a1a69f3a90c51e46490576d28f9eddfab">FileName::isMetaData</a></div><div class="ttdeci">bool isMetaData(bool failIfNotExists=true) const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8cpp_source.html#l00548">xmipp_filename.cpp:548</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_ab67ae2242d1cd1fd2c1b106b1debff2d"><div class="ttname"><a href="classProgAngularProjectionMatching.html#ab67ae2242d1cd1fd2c1b106b1debff2d">ProgAngularProjectionMatching::Ro</a></div><div class="ttdeci">int Ro</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00090">angular_projection_matching.h:90</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a989c2a0cdf20f2717d5e80baabfc40e5"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a989c2a0cdf20f2717d5e80baabfc40e5">ProgAngularProjectionMatching::search5d_shift</a></div><div class="ttdeci">int search5d_shift</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00125">angular_projection_matching.h:125</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a1658eaa42a37fdcd6bffdd72a34af947"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a1658eaa42a37fdcd6bffdd72a34af947">ProgAngularProjectionMatching::max_shift</a></div><div class="ttdeci">double max_shift</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00088">angular_projection_matching.h:88</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a60f6e7892e2cac3c25be6d46a4f9bdc5"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a60f6e7892e2cac3c25be6d46a4f9bdc5">ProgAngularProjectionMatching::Ri</a></div><div class="ttdeci">int Ri</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00090">angular_projection_matching.h:90</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afa1d2a0ad80c2deae0e33de00fb7af6d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgAngularProjectionMatching::translationallyAlignOneImage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>samplenr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>opt_flip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>opt_xoff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>opt_yoff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>maxcorr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Translational alignment using cartesian coordinates The optimal direction is re-projected from the volume </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8cpp_source.html#l00772">772</a> of file <a class="el" href="angular__projection__matching_8cpp_source.html">angular_projection_matching.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;{</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Mtrans,Mimg,Mref;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordtype">int</span> refno;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    Mtrans.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    Mimg.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    Mref.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="preprocessor">#ifdef TIMING</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <a class="code" href="group__GeneralFunctions.html#ga5de338a0f59b7f4fe678fadfeb1c0049">TimeStamp</a> t0,t1,t2;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <a class="code" href="group__GeneralFunctions.html#ga30c9706995a8be40c4b2dbe055cdaede">time_config</a>();</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <a class="code" href="group__GeneralFunctions.html#ga4c1f5b466a107f359a15279ca1781392">annotate_time</a>(&amp;t0);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    std::cerr&lt;&lt;<span class="stringliteral">&quot;start trans: opt_refno= &quot;</span>&lt;&lt;opt_refno&lt;&lt;<span class="stringliteral">&quot; pointer= &quot;</span>&lt;&lt;<a class="code" href="classProgAngularProjectionMatching.html#acd57f432b75da0e346c9c0df1b3e824f">pointer_allrefs2refsinmem</a>[opt_refno]&lt;&lt;<span class="stringliteral">&quot; opt_psi= &quot;</span>&lt;&lt;opt_psi&lt;&lt;<span class="stringliteral">&quot;opt_flip= &quot;</span>&lt;&lt;opt_flip&lt;&lt;std::endl;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="comment">// Get pointer to the correct reference image in memory</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    refno = <a class="code" href="classProgAngularProjectionMatching.html#acd57f432b75da0e346c9c0df1b3e824f">pointer_allrefs2refsinmem</a>[opt_refno];</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="keywordflow">if</span> (refno == -1)</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    {</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <span class="comment">// Reference is not stored in memory (anymore): (re-)read from disc</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <a class="code" href="classProgAngularProjectionMatching.html#a2a08cfec5754dfeaa806ea6874fc2139">getCurrentReference</a>(opt_refno,<a class="code" href="classProgAngularProjectionMatching.html#aa27a6cf70fecb56ed13b384161bc5248">global_plans</a>);</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        refno = <a class="code" href="classProgAngularProjectionMatching.html#acd57f432b75da0e346c9c0df1b3e824f">pointer_allrefs2refsinmem</a>[opt_refno];</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    }</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="comment">// Rotate stored reference projection by phi degrees</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <a class="code" href="classification_2pca_8cpp.html#ae5e08c2a7a15204653d0fdaabbc890ac">rotate</a>(<a class="code" href="group__GeometricalTransformations.html#gab8a49d8335f45ebd2ba7d86d98322bc0">BSPLINE3</a>,Mref,<a class="code" href="classProgAngularProjectionMatching.html#afc2430b6b28898178fb61bb50c1e39c8">proj_ref</a>[refno],opt_psi,<a class="code" href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a>);</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="comment">//rotate(BSPLINE3,Mref,proj_ref[refno],-opt_psi,DONT_WRAP);</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    std::cerr&lt;&lt;<span class="stringliteral">&quot;rotated ref &quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordflow">if</span> (opt_flip)</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    {</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        <span class="comment">// Flip experimental image</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> A(3,3);</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        A.initIdentity();</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A,0, 0) = -1.;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="comment">//MAT_ELEM(A,0, 1) *= -1.;</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a>(<a class="code" href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a>, Mimg, img, A, <a class="code" href="transformations_8h.html#a855436c9d0ed5174df8917d5239d7597">IS_INV</a>, <a class="code" href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a>);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    }</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        Mimg = img;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="comment">// Perform the actual search for the optimal shift</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgAngularProjectionMatching.html#a1658eaa42a37fdcd6bffdd72a34af947">max_shift</a>&gt;0)</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    {</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <a class="code" href="classCorrelationAux.html">CorrelationAux</a> aux;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        <a class="code" href="filters_8cpp.html#aa3a842c1f195d82f091c896d33e4de46">bestShift</a>(Mref,Mimg,opt_xoff,opt_yoff,aux);</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    }</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        opt_xoff = opt_yoff = 0.;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="keywordflow">if</span> (opt_xoff * opt_xoff + opt_yoff * opt_yoff &gt; <a class="code" href="classProgAngularProjectionMatching.html#a1658eaa42a37fdcd6bffdd72a34af947">max_shift</a> * <a class="code" href="classProgAngularProjectionMatching.html#a1658eaa42a37fdcd6bffdd72a34af947">max_shift</a>)</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        opt_xoff = opt_yoff = 0.;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="comment">//#define DEBUG</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    std::cerr&lt;&lt;<span class="stringliteral">&quot;optimal shift &quot;</span>&lt;&lt;opt_xoff&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;opt_yoff&lt;&lt;std::endl;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="comment">// Calculate standard cross-correlation coefficient</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <a class="code" href="lib__pwk_8cpp.html#a1b33162134537b4be1f614f7e8094d35">translate</a>(<a class="code" href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a>,Mtrans,Mimg,<a class="code" href="group__Vectors.html#ga97ccb86b4c568b2271da21552034d504">vectorR2</a>(opt_xoff,opt_yoff),<span class="keyword">true</span>);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    maxcorr = <a class="code" href="group__MultidimensionalArrays.html#ga63cca7e01116967ff451df8b1f8b5a4e">correlationIndex</a>(Mref,Mtrans);</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    std::cerr&lt;&lt;<span class="stringliteral">&quot;optimal shift corr &quot;</span>&lt;&lt;maxcorr&lt;&lt;std::endl;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="preprocessor">#undef DEBUG</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="comment">// Correct X-shift for mirrored images</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordflow">if</span> (opt_flip)</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        opt_xoff *= -1.;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="preprocessor">#ifdef TIMING</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordtype">float</span> total_trans = <a class="code" href="group__GeneralFunctions.html#gac09ae5f9feab6050f92ee446eb09a3d2">elapsed_time</a>(t0);</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    std::cerr&lt;&lt;<span class="stringliteral">&quot; trans%% &quot;</span>&lt;&lt;total_trans &lt;&lt;std::endl;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;}</div><div class="ttc" id="classProgAngularProjectionMatching_html_aa27a6cf70fecb56ed13b384161bc5248"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aa27a6cf70fecb56ed13b384161bc5248">ProgAngularProjectionMatching::global_plans</a></div><div class="ttdeci">Polar_fftw_plans global_plans</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00116">angular_projection_matching.h:116</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_acd57f432b75da0e346c9c0df1b3e824f"><div class="ttname"><a href="classProgAngularProjectionMatching.html#acd57f432b75da0e346c9c0df1b3e824f">ProgAngularProjectionMatching::pointer_allrefs2refsinmem</a></div><div class="ttdeci">std::vector&lt; int &gt; pointer_allrefs2refsinmem</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00105">angular_projection_matching.h:105</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a2a08cfec5754dfeaa806ea6874fc2139"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a2a08cfec5754dfeaa806ea6874fc2139">ProgAngularProjectionMatching::getCurrentReference</a></div><div class="ttdeci">void getCurrentReference(int refno, Polar_fftw_plans &amp;local_plans)</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8cpp_source.html#l00404">angular_projection_matching.cpp:404</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga3cc15e5dda7c58b9cacb7eee440d6bdc"><div class="ttname"><a href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a></div><div class="ttdeci">void applyGeometry(int SplineDegree, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V2, const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V1, const Matrix2D&lt; double &gt; &amp;A, bool inv, bool wrap, std::complex&lt; double &gt; outside, MultidimArray&lt; double &gt; *BcoeffsPtr)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00517">transformations.cpp:517</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga63cca7e01116967ff451df8b1f8b5a4e"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga63cca7e01116967ff451df8b1f8b5a4e">correlationIndex</a></div><div class="ttdeci">double correlationIndex(const MultidimArray&lt; T &gt; &amp;x, const MultidimArray&lt; T &gt; &amp;y, const MultidimArray&lt; int &gt; *mask=NULL, MultidimArray&lt; double &gt; *Contributions=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05692">multidim_array.h:5692</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_afc2430b6b28898178fb61bb50c1e39c8"><div class="ttname"><a href="classProgAngularProjectionMatching.html#afc2430b6b28898178fb61bb50c1e39c8">ProgAngularProjectionMatching::proj_ref</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * proj_ref</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00114">angular_projection_matching.h:114</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_gac09ae5f9feab6050f92ee446eb09a3d2"><div class="ttname"><a href="group__GeneralFunctions.html#gac09ae5f9feab6050f92ee446eb09a3d2">elapsed_time</a></div><div class="ttdeci">double elapsed_time(ProcessorTimeStamp &amp;time, bool _IN_SECS)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00730">xmipp_funcs.cpp:730</a></div></div>
<div class="ttc" id="classification_2pca_8cpp_html_ae5e08c2a7a15204653d0fdaabbc890ac"><div class="ttname"><a href="classification_2pca_8cpp.html#ae5e08c2a7a15204653d0fdaabbc890ac">rotate</a></div><div class="ttdeci">#define rotate(a, i, j, k, l)</div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga30c9706995a8be40c4b2dbe055cdaede"><div class="ttname"><a href="group__GeneralFunctions.html#ga30c9706995a8be40c4b2dbe055cdaede">time_config</a></div><div class="ttdeci">void time_config()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00619">xmipp_funcs.cpp:619</a></div></div>
<div class="ttc" id="group__Matrices_html_gab40746be05d4bbf352787018922ecc2e"><div class="ttname"><a href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a></div><div class="ttdeci">#define MAT_ELEM(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00117">matrix2d.h:117</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="transformations_8h_html_a855436c9d0ed5174df8917d5239d7597"><div class="ttname"><a href="transformations_8h.html#a855436c9d0ed5174df8917d5239d7597">IS_INV</a></div><div class="ttdeci">#define IS_INV</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00040">transformations.h:40</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gac645eb9a88619ee6f5e14c557ab8ef62"><div class="ttname"><a href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a></div><div class="ttdeci">#define LINEAR</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00208">transformations.h:208</a></div></div>
<div class="ttc" id="classCorrelationAux_html"><div class="ttname"><a href="classCorrelationAux.html">CorrelationAux</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00551">xmipp_fftw.h:551</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gab8a49d8335f45ebd2ba7d86d98322bc0"><div class="ttname"><a href="group__GeometricalTransformations.html#gab8a49d8335f45ebd2ba7d86d98322bc0">BSPLINE3</a></div><div class="ttdeci">#define BSPLINE3</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00210">transformations.h:210</a></div></div>
<div class="ttc" id="group__Vectors_html_ga97ccb86b4c568b2271da21552034d504"><div class="ttname"><a href="group__Vectors.html#ga97ccb86b4c568b2271da21552034d504">vectorR2</a></div><div class="ttdeci">Matrix1D&lt; double &gt; vectorR2(double x, double y)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8cpp_source.html#l00028">matrix1d.cpp:28</a></div></div>
<div class="ttc" id="transformations_8h_html_a9fbfdbc149e55def0e63127fcb558d13"><div class="ttname"><a href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a></div><div class="ttdeci">#define DONT_WRAP</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00042">transformations.h:42</a></div></div>
<div class="ttc" id="lib__pwk_8cpp_html_a1b33162134537b4be1f614f7e8094d35"><div class="ttname"><a href="lib__pwk_8cpp.html#a1b33162134537b4be1f614f7e8094d35">translate</a></div><div class="ttdeci">void translate(PDB *pdb_original, PDB *pdb_move, unsigned num_atoms, double x0, double y0, double z0)</div><div class="ttdef"><b>Definition:</b> <a href="lib__pwk_8cpp_source.html#l00125">lib_pwk.cpp:125</a></div></div>
<div class="ttc" id="filters_8cpp_html_aa3a842c1f195d82f091c896d33e4de46"><div class="ttname"><a href="filters_8cpp.html#aa3a842c1f195d82f091c896d33e4de46">bestShift</a></div><div class="ttdeci">template float bestShift(MultidimArray&lt; float &gt; &amp;, float &amp;, float &amp;, const MultidimArray&lt; int &gt; *, int)</div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a1658eaa42a37fdcd6bffdd72a34af947"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a1658eaa42a37fdcd6bffdd72a34af947">ProgAngularProjectionMatching::max_shift</a></div><div class="ttdeci">double max_shift</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00088">angular_projection_matching.h:88</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga4c1f5b466a107f359a15279ca1781392"><div class="ttname"><a href="group__GeneralFunctions.html#ga4c1f5b466a107f359a15279ca1781392">annotate_time</a></div><div class="ttdeci">void annotate_time(TimeStamp *time)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00637">xmipp_funcs.cpp:637</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga5de338a0f59b7f4fe678fadfeb1c0049"><div class="ttname"><a href="group__GeneralFunctions.html#ga5de338a0f59b7f4fe678fadfeb1c0049">TimeStamp</a></div><div class="ttdeci">size_t TimeStamp</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8h_source.html#l00837">xmipp_funcs.h:837</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac0215f85731724322fc3f33a89ce8014"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProgAngularProjectionMatching::writeOutputFiles </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Write out results to disk This function should be override in MPI class, only master should write. </p>

<p>Reimplemented in <a class="el" href="classMpiProgAngularProjectionMatching.html#a65e527f4e52430f0fb583b9f2816ad00">MpiProgAngularProjectionMatching</a>.</p>

<p>Definition at line <a class="el" href="angular__projection__matching_8cpp_source.html#l01250">1250</a> of file <a class="el" href="angular__projection__matching_8cpp_source.html">angular_projection_matching.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;{</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html#a6f0c8469a0fc03f6655791daba88a7a7">DFo</a>.<a class="code" href="classMetaData.html#a163fee49247af4f55802e8480503b342">write</a>(<a class="code" href="classProgAngularProjectionMatching.html#a0059ca01a9a2e534f234a86f1baa80cd">fn_out</a>,<a class="code" href="classProgAngularProjectionMatching.html#a10583dbac123156edd53f645fe731461">do_overwrite</a>);</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;}</div><div class="ttc" id="classMetaData_html_a163fee49247af4f55802e8480503b342"><div class="ttname"><a href="classMetaData.html#a163fee49247af4f55802e8480503b342">MetaData::write</a></div><div class="ttdeci">void write(const FileName &amp;outFile, WriteModeMetaData mode=MD_OVERWRITE) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00907">metadata.cpp:907</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a10583dbac123156edd53f645fe731461"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a10583dbac123156edd53f645fe731461">ProgAngularProjectionMatching::do_overwrite</a></div><div class="ttdeci">WriteModeMetaData do_overwrite</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00145">angular_projection_matching.h:145</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a0059ca01a9a2e534f234a86f1baa80cd"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a0059ca01a9a2e534f234a86f1baa80cd">ProgAngularProjectionMatching::fn_out</a></div><div class="ttdeci">FileName fn_out</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00078">angular_projection_matching.h:78</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a6f0c8469a0fc03f6655791daba88a7a7"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a6f0c8469a0fc03f6655791daba88a7a7">ProgAngularProjectionMatching::DFo</a></div><div class="ttdeci">MetaData DFo</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00082">angular_projection_matching.h:82</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a20cca02bbe41ebcdba66c9e358c98559"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgAngularProjectionMatching::avail_memory</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Available memory for storage of all references (in Gb) </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00092">92</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac2959661621ae5d67cb604302bb91d74"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;size_t&gt; ProgAngularProjectionMatching::convert_refno_to_stack_position</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classVector.html">Vector</a> to assign reference number to stack positions </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00108">108</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae9043a07e1507976fff101ec37eab8f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgAngularProjectionMatching::counter_refs_in_memory</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Counter for current filling of memory with references </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00103">103</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9c3b2ace08c588a370b41162bd04a3ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMetaData.html">MetaData</a> ProgAngularProjectionMatching::DFexp</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Docfile with experimental images </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00080">80</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6f0c8469a0fc03f6655791daba88a7a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMetaData.html">MetaData</a> ProgAngularProjectionMatching::DFo</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Docfile with results </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00082">82</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae5e360b3e048572819d48b76f11df5e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t ProgAngularProjectionMatching::dim</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>dimension of the images and padded images </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00084">84</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a10583dbac123156edd53f645fe731461"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__MetaData.html#gaf446b6aff4a8c034231bfa3e1484bc47">WriteModeMetaData</a> ProgAngularProjectionMatching::do_overwrite</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00145">145</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="aed805df963ac159ce0e697ccdec2d976"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgAngularProjectionMatching::do_scale</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>scale params </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00144">144</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="aca9eed5afc4442b6f6173b8d47046fe6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classFileName.html">FileName</a> ProgAngularProjectionMatching::fn_ctf</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00078">78</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a27562024b9dfcc0ff3c14927bcd2707f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classFileName.html">FileName</a> ProgAngularProjectionMatching::fn_exp</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Filenames </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00078">78</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0059ca01a9a2e534f234a86f1baa80cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classFileName.html">FileName</a> ProgAngularProjectionMatching::fn_out</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00078">78</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa225d6d9aa1a2349b3fe8bfac7c61be3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classFileName.html">FileName</a> ProgAngularProjectionMatching::fn_ref</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00078">78</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="aee78ecf7a18389e52940b9f4bf5dcff6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPolar.html">Polar</a>&lt;std::complex&lt;double&gt; &gt; * ProgAngularProjectionMatching::fP_img</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00112">112</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="aadc634e170de9a09b2870fab90bd0dac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPolar.html">Polar</a>&lt;std::complex&lt;double&gt; &gt;* ProgAngularProjectionMatching::fP_ref</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Array with Polars of references and of translated images and their mirrors </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00112">112</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a450a2dfc609d2b3003e3e998878082dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPolar.html">Polar</a>&lt;std::complex&lt;double&gt; &gt; * ProgAngularProjectionMatching::fPm_img</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00112">112</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa27a6cf70fecb56ed13b384161bc5248"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPolar__fftw__plans.html">Polar_fftw_plans</a> ProgAngularProjectionMatching::global_plans</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Global plans for fftw transformers of all polar rings </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00116">116</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a14edd79cd809aba3482bddff00f5e6b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;size_t&gt; ProgAngularProjectionMatching::ids</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Array containing the images ids in metadata </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00110">110</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9ceadd76e62fefe80a4fc832fca2c00f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgAngularProjectionMatching::loop_forward_refs</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag whether to loop from low to high or from high to low through the references </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00123">123</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9562d86a126dcc1d8c50cd861f616d40"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgAngularProjectionMatching::max_nr_imgs_in_memory</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Maximum number of references that can be stored in memory The difference between this and the previous varible is that the previous one is the <a class="el" href="defines_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN(max_nr_refs_in_memory, number of references)</a> </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00099">99</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5e8acf7bc77be451a429e9ae8af5c37b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgAngularProjectionMatching::max_nr_refs_in_memory</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Maximum number of references to store in memory </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00094">94</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1658eaa42a37fdcd6bffdd72a34af947"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgAngularProjectionMatching::max_shift</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Maximum allowed shift </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00088">88</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a67bce09ceb3bada415d302b03613d3b9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt;double&gt; ProgAngularProjectionMatching::Mctf</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>CTF image </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00131">131</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a33132687def0129f4c14fa9c068a0d19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSampling.html">Sampling</a> ProgAngularProjectionMatching::mysampling</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>sampling object </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00120">120</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a037f376e933b93134ca3d6f117e3d756"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t ProgAngularProjectionMatching::nr_trans</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of translations in 5D search </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00139">139</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7557dbd7c4833be2a957e4775d899ccc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgAngularProjectionMatching::numOrientations</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00137">137</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a723e4a9d596d440137c0a59a6582742b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgAngularProjectionMatching::pad</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Padding factor (only for applying CTF to references) </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00086">86</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="add0977a6148a63070a4c91eba71ee9cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t ProgAngularProjectionMatching::paddim</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00084">84</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac612a8a129d906023ff929ec80552f90"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgAngularProjectionMatching::phase_flipped</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Are the experimental images phase flipped? </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00133">133</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="acd57f432b75da0e346c9c0df1b3e824f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; ProgAngularProjectionMatching::pointer_allrefs2refsinmem</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pointers for reference retrieval </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00105">105</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="aeb35527c73b27e78c3ceb5cd3721f195"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; ProgAngularProjectionMatching::pointer_refsinmem2allrefs</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00106">106</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a725039b9ec19e43bc45afc57bf8b711c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgAngularProjectionMatching::progress_bar_step</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Progress bar </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00150">150</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="afc2430b6b28898178fb61bb50c1e39c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt;double&gt;* ProgAngularProjectionMatching::proj_ref</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Array with reference images </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00114">114</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a60f6e7892e2cac3c25be6d46a4f9bdc5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgAngularProjectionMatching::Ri</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Inner and outer radii to limit the rotational search </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00090">90</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab67ae2242d1cd1fd2c1b106b1debff2d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgAngularProjectionMatching::Ro</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00090">90</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a59e923cfadebda6ca0585bb4982408fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgAngularProjectionMatching::scale_nsteps</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00147">147</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a173d1e4af96024b6af24100bb464d448"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgAngularProjectionMatching::scale_step</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00146">146</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a989c2a0cdf20f2717d5e80baabfc40e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgAngularProjectionMatching::search5d_shift</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>5D-search: maximum offsets (+/- pixels) </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00125">125</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9ab38e7253df6c449dc6322e4c46b83b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgAngularProjectionMatching::search5d_step</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>5D-search: offset step (pixels) </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00127">127</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a186aaabc17af38165deb81586e606cca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; ProgAngularProjectionMatching::search5d_xoff</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>5D-search: actual displacement vectors </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00129">129</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8f71b2ce22933528a9f18e757ef6efac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; ProgAngularProjectionMatching::search5d_yoff</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00129">129</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4e644422e07a3dc04ffcc5dbdb34eb52"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double * ProgAngularProjectionMatching::stddev_img</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00118">118</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4840d3dcdfe64b6fd3a02096e6c83573"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double* ProgAngularProjectionMatching::stddev_ref</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>vector with stddevs for all reference projections </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00118">118</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1c2f248db52457e702e7d626ba3e6547"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__Threads.html#ga0b86c483ccff385c24a8a278870af9f7">barrier_t</a> ProgAngularProjectionMatching::thread_barrier</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classThread.html">Thread</a> barrier </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00141">141</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac043b262d9dc89979be1587b43dbe937"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgAngularProjectionMatching::threads</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Threads </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00135">135</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<a class="anchor" id="a85cb8e7d09221d99e44a8a2208fd4a22"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgAngularProjectionMatching::total_nr_refs</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Total number of references </p>

<p>Definition at line <a class="el" href="angular__projection__matching_8h_source.html#l00101">101</a> of file <a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/yunior/Yunior/Projects/Scipion/COSS/xmipp-bundle/src/xmipp/libraries/reconstruction/<a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a></li>
<li>/home/yunior/Yunior/Projects/Scipion/COSS/xmipp-bundle/src/xmipp/libraries/reconstruction/<a class="el" href="angular__projection__matching_8cpp_source.html">angular_projection_matching.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
