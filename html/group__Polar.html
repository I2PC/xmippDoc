<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Xmipp: Polar coordinates</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Polar coordinates</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPolar__fftw__plans.html">Polar_fftw_plans</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPolar.html">Polar&lt; T &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga02e5b456ea900d6023ee4170514b9864"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Polar.html#ga02e5b456ea900d6023ee4170514b9864">fourierTransformRings</a> (<a class="el" href="classPolar.html">Polar</a>&lt; double &gt; &amp;<a class="el" href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a>, <a class="el" href="classPolar.html">Polar</a>&lt; std::complex&lt; double &gt; &gt; &amp;out, <a class="el" href="classPolar__fftw__plans.html">Polar_fftw_plans</a> &amp;plans, bool conjugated=<a class="el" href="polar_8h.html#a1f914e56393271644d01f6aa1a54dbaa">DONT_CONJUGATE</a>)</td></tr>
<tr class="separator:ga02e5b456ea900d6023ee4170514b9864"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga874ef793e14af9ce8dfaf4d676ce701e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Polar.html#ga874ef793e14af9ce8dfaf4d676ce701e">inverseFourierTransformRings</a> (<a class="el" href="classPolar.html">Polar</a>&lt; std::complex&lt; double &gt; &gt; &amp;<a class="el" href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a>, <a class="el" href="classPolar.html">Polar</a>&lt; double &gt; &amp;out, <a class="el" href="classPolar__fftw__plans.html">Polar_fftw_plans</a> &amp;plans, bool conjugated=<a class="el" href="polar_8h.html#a1f914e56393271644d01f6aa1a54dbaa">DONT_CONJUGATE</a>)</td></tr>
<tr class="separator:ga874ef793e14af9ce8dfaf4d676ce701e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga61e0a0f95b718c9957d51cfa6e91daf8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Polar.html#ga61e0a0f95b718c9957d51cfa6e91daf8">rotationalCorrelation</a> (const <a class="el" href="classPolar.html">Polar</a>&lt; std::complex&lt; double &gt; &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ac597abe7cf610f262f7aaec53ed1d413">M1</a>, const <a class="el" href="classPolar.html">Polar</a>&lt; std::complex&lt; double &gt; &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a2a187ef3afced0eb4c4cb99515e5429c">M2</a>, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;angles, <a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;aux)</td></tr>
<tr class="separator:ga61e0a0f95b718c9957d51cfa6e91daf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacaa27165654f87c7f78d3069d26a663c"><td class="memTemplParams" colspan="2">template&lt;bool NORMALIZE&gt; </td></tr>
<tr class="memitem:gacaa27165654f87c7f78d3069d26a663c"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Polar.html#gacaa27165654f87c7f78d3069d26a663c">polarFourierTransform</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;<a class="el" href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a>, <a class="el" href="classPolar.html">Polar</a>&lt; std::complex&lt; double &gt; &gt; &amp;out, bool <a class="el" href="numerical__recipes_8cpp.html#ad489592c06fec6c24859ec8d6e4ba1d9">flag</a>, int first_ring, int last_ring, <a class="el" href="classPolar__fftw__plans.html">Polar_fftw_plans</a> *&amp;plans, int BsplineOrder=3)</td></tr>
<tr class="separator:gacaa27165654f87c7f78d3069d26a663c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafc7e08d62f162cd32a235df1eba53208"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Polar.html#gafc7e08d62f162cd32a235df1eba53208">normalizedPolarFourierTransform</a> (<a class="el" href="classPolar.html">Polar</a>&lt; double &gt; &amp;polarIn, <a class="el" href="classPolar.html">Polar</a>&lt; std::complex&lt; double &gt; &gt; &amp;out, bool conjugated, <a class="el" href="classPolar__fftw__plans.html">Polar_fftw_plans</a> *&amp;plans)</td></tr>
<tr class="separator:gafc7e08d62f162cd32a235df1eba53208"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad480d0d51fe785a56c0173a9dfdc8d38"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Polar.html#gad480d0d51fe785a56c0173a9dfdc8d38">best_rotation</a> (const <a class="el" href="classPolar.html">Polar</a>&lt; std::complex&lt; double &gt; &gt; &amp;I1, const <a class="el" href="classPolar.html">Polar</a>&lt; std::complex&lt; double &gt; &gt; &amp;I2, <a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;aux)</td></tr>
<tr class="separator:gad480d0d51fe785a56c0173a9dfdc8d38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac09ded8ce87e2f4073d3a23d9e32fee8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Polar.html#gac09ded8ce87e2f4073d3a23d9e32fee8">alignRotationally</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I1, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I2, <a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;aux, int splineOrder=1, int wrap=<a class="el" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a>)</td></tr>
<tr class="separator:gac09ded8ce87e2f4073d3a23d9e32fee8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4a0e9c69e31ddb298d583f9cf44407ac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Polar.html#ga4a0e9c69e31ddb298d583f9cf44407ac">image_convertCartesianToPolar</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;<a class="el" href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a>, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;out, double Rmin, double Rmax, double deltaR, double angMin, double angMax, double deltaAng)</td></tr>
<tr class="separator:ga4a0e9c69e31ddb298d583f9cf44407ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga780f96736bd76c11b9e759519510a4fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Polar.html#ga780f96736bd76c11b9e759519510a4fd">image_convertCartesianToPolar_ZoomAtCenter</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;<a class="el" href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a>, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;out, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;R, double zoomFactor, double Rmin, double Rmax, int NRSteps, float angMin, double angMax, int NAngSteps)</td></tr>
<tr class="separator:ga780f96736bd76c11b9e759519510a4fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga191bbb2c43b0978de4379b80f81c42ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Polar.html#ga191bbb2c43b0978de4379b80f81c42ad">volume_convertCartesianToCylindrical</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;<a class="el" href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a>, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;out, double Rmin, double Rmax, double deltaR, float angMin, double angMax, float deltaAng, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="image__operate_8cpp.html#aae5e6d8d8a0b1792b5fc6fde13bc4a8c">axis</a>)</td></tr>
<tr class="separator:ga191bbb2c43b0978de4379b80f81c42ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga83a9d3893b304654735c75978a8802f9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Polar.html#ga83a9d3893b304654735c75978a8802f9">volume_convertCartesianToSpherical</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;<a class="el" href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a>, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;out, double Rmin, double Rmax, double deltaR=1., double deltaRot=2.*<a class="el" href="group__Macros.html#ga598a3330b3c21701223ee0ca14316eca">PI</a>/360., double deltaTilt=<a class="el" href="group__Macros.html#ga598a3330b3c21701223ee0ca14316eca">PI</a>/180.)</td></tr>
<tr class="separator:ga83a9d3893b304654735c75978a8802f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gac09ded8ce87e2f4073d3a23d9e32fee8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void alignRotationally </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>splineOrder</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wrap</em> = <code><a class="el" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Align I2 rotationally to I1 </p>

<p>Definition at line <a class="el" href="polar_8cpp_source.html#l00187">187</a> of file <a class="el" href="polar_8cpp_source.html">polar.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                                                  {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    I1.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    I2.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="classPolar__fftw__plans.html">Polar_fftw_plans</a> *plans = NULL;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="classPolar.html">Polar&lt;std::complex&lt;double&gt;</a> &gt; polarFourierI2, polarFourierI1;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="polar_8cpp.html#a29cae209c3de81e800a2dcf343a059c4">polarFourierTransform&lt;true&gt;</a>(I1, polarFourierI1, <span class="keyword">false</span>, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I1) / 5,</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I1) / 2, plans);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="polar_8cpp.html#a29cae209c3de81e800a2dcf343a059c4">polarFourierTransform&lt;true&gt;</a>(I2, polarFourierI2, <span class="keyword">true</span>, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I2) / 5,</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I2) / 2, plans);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> rotationalCorr;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    rotationalCorr.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(2 * polarFourierI2.getSampleNoOuterRing() - 1);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    aux.<a class="code" href="classRotationalCorrelationAux.html#ab6762c27fa075d4c124a5d33a286cd5a">local_transformer</a>.<a class="code" href="classFourierTransformer.html#a18bc840c781555b742d0185fb20925bf">setReal</a>(rotationalCorr);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordtype">double</span> bestRot = <a class="code" href="group__Polar.html#gad480d0d51fe785a56c0173a9dfdc8d38">best_rotation</a>(polarFourierI1, polarFourierI2, aux);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> tmp = I2;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="classification_2pca_8cpp.html#ae5e08c2a7a15204653d0fdaabbc890ac">rotate</a>(splineOrder, I2, tmp, -bestRot, <span class="charliteral">&#39;Z&#39;</span>, wrap);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="classification_2pca_8cpp_html_ae5e08c2a7a15204653d0fdaabbc890ac"><div class="ttname"><a href="classification_2pca_8cpp.html#ae5e08c2a7a15204653d0fdaabbc890ac">rotate</a></div><div class="ttdeci">#define rotate(a, i, j, k, l)</div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="group__Polar_html_gad480d0d51fe785a56c0173a9dfdc8d38"><div class="ttname"><a href="group__Polar.html#gad480d0d51fe785a56c0173a9dfdc8d38">best_rotation</a></div><div class="ttdeci">double best_rotation(const Polar&lt; std::complex&lt; double &gt; &gt; &amp;I1, const Polar&lt; std::complex&lt; double &gt; &gt; &amp;I2, RotationalCorrelationAux &amp;aux)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8cpp_source.html#l00165">polar.cpp:165</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a18bc840c781555b742d0185fb20925bf"><div class="ttname"><a href="classFourierTransformer.html#a18bc840c781555b742d0185fb20925bf">FourierTransformer::setReal</a></div><div class="ttdeci">void setReal(MultidimArray&lt; double &gt; &amp;img)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00129">xmipp_fftw.cpp:129</a></div></div>
<div class="ttc" id="classPolar__fftw__plans_html"><div class="ttname"><a href="classPolar__fftw__plans.html">Polar_fftw_plans</a></div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00051">polar.h:51</a></div></div>
<div class="ttc" id="classPolar_html"><div class="ttname"><a href="classPolar.html">Polar</a></div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00061">polar.h:61</a></div></div>
<div class="ttc" id="classRotationalCorrelationAux_html_ab6762c27fa075d4c124a5d33a286cd5a"><div class="ttname"><a href="classRotationalCorrelationAux.html#ab6762c27fa075d4c124a5d33a286cd5a">RotationalCorrelationAux::local_transformer</a></div><div class="ttdeci">FourierTransformer local_transformer</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00791">polar.h:791</a></div></div>
<div class="ttc" id="polar_8cpp_html_a29cae209c3de81e800a2dcf343a059c4"><div class="ttname"><a href="polar_8cpp.html#a29cae209c3de81e800a2dcf343a059c4">polarFourierTransform&lt; true &gt;</a></div><div class="ttdeci">template void polarFourierTransform&lt; true &gt;(const MultidimArray&lt; double &gt; &amp;in, Polar&lt; std::complex&lt; double &gt; &gt; &amp;out, bool conjugated, int first_ring, int last_ring, Polar_fftw_plans *&amp;plans, int BsplineOrder)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gad480d0d51fe785a56c0173a9dfdc8d38"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double best_rotation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classPolar.html">Polar</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>I1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classPolar.html">Polar</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>I2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Best rotation between two normalized polar Fourier transforms. </p>

<p>Definition at line <a class="el" href="polar_8cpp_source.html#l00165">165</a> of file <a class="el" href="polar_8cpp_source.html">polar.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                                                             {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> angles;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="group__Polar.html#ga61e0a0f95b718c9957d51cfa6e91daf8">rotationalCorrelation</a>(I1, I2, angles, aux);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">// Compute the maximum of correlation (inside local_transformer)</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keyword">const</span> <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;corr = aux.<a class="code" href="classRotationalCorrelationAux.html#ab6762c27fa075d4c124a5d33a286cd5a">local_transformer</a>.<a class="code" href="classFourierTransformer.html#af23ba51e51832b92788a49520a8baa46">getReal</a>();</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordtype">int</span> imax = 0;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordtype">double</span> maxval = <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(corr,0);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordtype">double</span>* ptr = NULL;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga26e3526530a71567390ed3d98c1654cf">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY_ptr</a>(corr,n,ptr)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (*ptr &gt; maxval) {</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            maxval = *ptr;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            imax = <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// Return the corresponding angle</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__MultidimensionalArrays.html#gaa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a>(angles,imax);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Polar_html_ga61e0a0f95b718c9957d51cfa6e91daf8"><div class="ttname"><a href="group__Polar.html#ga61e0a0f95b718c9957d51cfa6e91daf8">rotationalCorrelation</a></div><div class="ttdeci">void rotationalCorrelation(const Polar&lt; std::complex&lt; double &gt; &gt; &amp;M1, const Polar&lt; std::complex&lt; double &gt; &gt; &amp;M2, MultidimArray&lt; double &gt; &amp;angles, RotationalCorrelationAux &amp;aux)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8cpp_source.html#l00067">polar.cpp:67</a></div></div>
<div class="ttc" id="classFourierTransformer_html_af23ba51e51832b92788a49520a8baa46"><div class="ttname"><a href="classFourierTransformer.html#af23ba51e51832b92788a49520a8baa46">FourierTransformer::getReal</a></div><div class="ttdeci">const MultidimArray&lt; double &gt; &amp; getReal() const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00118">xmipp_fftw.cpp:118</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaa6b2513810dd91e11450be99106a2463"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a></div><div class="ttdeci">#define DIRECT_A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00536">multidim_array.h:536</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga26e3526530a71567390ed3d98c1654cf"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga26e3526530a71567390ed3d98c1654cf">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY_ptr</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY_ptr(v, n, ptr)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00243">multidim_array.h:243</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="classRotationalCorrelationAux_html_ab6762c27fa075d4c124a5d33a286cd5a"><div class="ttname"><a href="classRotationalCorrelationAux.html#ab6762c27fa075d4c124a5d33a286cd5a">RotationalCorrelationAux::local_transformer</a></div><div class="ttdeci">FourierTransformer local_transformer</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00791">polar.h:791</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga02e5b456ea900d6023ee4170514b9864"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fourierTransformRings </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPolar.html">Polar</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPolar.html">Polar</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPolar__fftw__plans.html">Polar_fftw_plans</a> &amp;&#160;</td>
          <td class="paramname"><em>plans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>conjugated</em> = <code><a class="el" href="polar_8h.html#a1f914e56393271644d01f6aa1a54dbaa">DONT_CONJUGATE</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate FourierTransform of all rings</p>
<p>This function returns a polar of complex&lt;double&gt; by calculating the FT of all rings</p>
<p>Note that the <a class="el" href="classPolar__fftw__plans.html">Polar_fftw_plans</a> may be re-used for polars of the same size They should initially be calculated as in the example below</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;MultidimArray&lt;double&gt; angles, corr;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Polar_fftw_plans plans;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Polar&lt;std::complex&lt;double&gt; &gt; F1, F2;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;M1.calculateFftwPlans(plans); // M1 is a Polar&lt;double&gt;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;fourierTransformRings(M1, F1, plans, false);</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;fourierTransformRings(M1, F2, plans, true);// complex conjugated</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="polar_8cpp_source.html#l00033">33</a> of file <a class="el" href="polar_8cpp_source.html">polar.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                         {</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;std::complex&lt;double&gt;</a> &gt; Fring;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    out.<a class="code" href="classPolar.html#aaa859bdf26c988f3432ab0d0c9301743">clear</a>();</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iring = 0; iring &lt; in.<a class="code" href="classPolar.html#a471898c3d9ddca4db17d368cd583482a">getRingNo</a>(); iring++) {</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        plans.<a class="code" href="classPolar__fftw__plans.html#ab130a0d95b962b4bf691e7d6742c0914">arrays</a>[iring] = in.<a class="code" href="classPolar.html#a7f0ac09b5f06f9b9830a894f94b8a324">rings</a>[iring];</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        (plans.<a class="code" href="classPolar__fftw__plans.html#a6c12bc6899b6370ccf8c56c7f2505469">transformers</a>[iring])-&gt;<a class="code" href="group__Fourier.html#ga5fddf4cf6da360abdc8fd7d2f21fcbb9">FourierTransform</a>();</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        (plans.<a class="code" href="classPolar__fftw__plans.html#a6c12bc6899b6370ccf8c56c7f2505469">transformers</a>[iring])-&gt;getFourierAlias(Fring);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="keywordflow">if</span> (conjugated) {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;            <span class="keywordtype">double</span> *ptrFring_i = (<span class="keywordtype">double</span>*) &amp;<a class="code" href="group__MultidimensionalArrays.html#gaa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a>(Fring,0);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            ++ptrFring_i;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Fring); ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, ptrFring_i += 2)</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                (*ptrFring_i) *= -1;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        }</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        out.<a class="code" href="classPolar.html#a7f0ac09b5f06f9b9830a894f94b8a324">rings</a>.push_back(Fring);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    }</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    out.<a class="code" href="classPolar.html#a271d06bd1cb1fb0f7eb242f73f79a4fa">mode</a> = in.<a class="code" href="classPolar.html#a271d06bd1cb1fb0f7eb242f73f79a4fa">mode</a>;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    out.<a class="code" href="classPolar.html#a94e6c5eebcf2775ecfedc1db9da356a3">ring_radius</a> = in.<a class="code" href="classPolar.html#a94e6c5eebcf2775ecfedc1db9da356a3">ring_radius</a>;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;}</div><div class="ttc" id="classPolar__fftw__plans_html_a6c12bc6899b6370ccf8c56c7f2505469"><div class="ttname"><a href="classPolar__fftw__plans.html#a6c12bc6899b6370ccf8c56c7f2505469">Polar_fftw_plans::transformers</a></div><div class="ttdeci">std::vector&lt; FourierTransformer * &gt; transformers</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00054">polar.h:54</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classPolar_html_a94e6c5eebcf2775ecfedc1db9da356a3"><div class="ttname"><a href="classPolar.html#a94e6c5eebcf2775ecfedc1db9da356a3">Polar::ring_radius</a></div><div class="ttdeci">std::vector&lt; double &gt; ring_radius</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00068">polar.h:68</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaa6b2513810dd91e11450be99106a2463"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a></div><div class="ttdeci">#define DIRECT_A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00536">multidim_array.h:536</a></div></div>
<div class="ttc" id="group__Fourier_html_ga5fddf4cf6da360abdc8fd7d2f21fcbb9"><div class="ttname"><a href="group__Fourier.html#ga5fddf4cf6da360abdc8fd7d2f21fcbb9">FourierTransform</a></div><div class="ttdeci">void FourierTransform(const MultidimArray&lt; double &gt; &amp;in, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8cpp_source.html#l00124">xmipp_fft.cpp:124</a></div></div>
<div class="ttc" id="classPolar_html_a271d06bd1cb1fb0f7eb242f73f79a4fa"><div class="ttname"><a href="classPolar.html#a271d06bd1cb1fb0f7eb242f73f79a4fa">Polar::mode</a></div><div class="ttdeci">int mode</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00066">polar.h:66</a></div></div>
<div class="ttc" id="classPolar_html_a7f0ac09b5f06f9b9830a894f94b8a324"><div class="ttname"><a href="classPolar.html#a7f0ac09b5f06f9b9830a894f94b8a324">Polar::rings</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; T &gt; &gt; rings</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00069">polar.h:69</a></div></div>
<div class="ttc" id="classPolar__fftw__plans_html_ab130a0d95b962b4bf691e7d6742c0914"><div class="ttname"><a href="classPolar__fftw__plans.html#ab130a0d95b962b4bf691e7d6742c0914">Polar_fftw_plans::arrays</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; double &gt; &gt; arrays</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00055">polar.h:55</a></div></div>
<div class="ttc" id="classPolar_html_aaa859bdf26c988f3432ab0d0c9301743"><div class="ttname"><a href="classPolar.html#aaa859bdf26c988f3432ab0d0c9301743">Polar::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00289">polar.h:289</a></div></div>
<div class="ttc" id="classPolar_html_a471898c3d9ddca4db17d368cd583482a"><div class="ttname"><a href="classPolar.html#a471898c3d9ddca4db17d368cd583482a">Polar::getRingNo</a></div><div class="ttdeci">int getRingNo() const </div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00320">polar.h:320</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga4a0e9c69e31ddb298d583f9cf44407ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void image_convertCartesianToPolar </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltaR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angMin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angMax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltaAng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Produce a polar image from a cartesian image. You can give the minimum and maximum radius for the interpolation, the delta radius and the delta angle. It is assumed that the input image has the Xmipp origin. Delta Ang must be in radians. </p>

</div>
</div>
<a class="anchor" id="ga780f96736bd76c11b9e759519510a4fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void image_convertCartesianToPolar_ZoomAtCenter </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>zoomFactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>NRSteps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>angMin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angMax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>NAngSteps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Produce a polar image from a cartesian image. Identical to the previous function. The Zoom factor must be &gt;=1 (==1 means no zoom). If R is with a 0 size, then it is assumed that this routine must compute the sampling radii. If it is not 0, then it is assumed that the sampling radii have already been calculated. </p>

<p>Definition at line <a class="el" href="polar_8cpp_source.html#l00228">228</a> of file <a class="el" href="polar_8cpp_source.html">polar.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                       {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">/* Octave</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">     * r=0:64;plot(r,d.^(r/d),r,r,d*((r/d).^2.8));</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordtype">float</span> deltaAng = (angMax - angMin + 1) / NAngSteps;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordtype">double</span> deltaR = (Rmax - Rmin + 1) / NRSteps;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    out.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(NAngSteps, NRSteps);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#gad6524c4e36da91aae3fb6f8564112364">VEC_XSIZE</a>(R) == 0) {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        R.<a class="code" href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">initZeros</a>(NRSteps);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordtype">double</span> Rrange = Rmax - Rmin;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; NRSteps; ++<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(R,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = Rmin</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                    + Rrange * pow(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> * deltaR / Rrange, zoomFactor);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NAngSteps; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordtype">float</span> angle = angMin + <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * deltaAng;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="keywordtype">float</span> s = sin(angle);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keywordtype">float</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> = cos(angle);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; NRSteps; ++<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="keywordtype">float</span> Rj = <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(R,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(out,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = in.<a class="code" href="classMultidimArray.html#a19114d7a0f50f08786a52c28624dc1d5">interpolatedElement2D</a>(Rj * c, Rj * s);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;}</div><div class="ttc" id="group__Vectors_html_ga58173d9430e8e68017e3698f30382d5d"><div class="ttname"><a href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a></div><div class="ttdeci">#define VEC_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00248">matrix1d.h:248</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00364">multidim_array.h:364</a></div></div>
<div class="ttc" id="group__Vectors_html_gad6524c4e36da91aae3fb6f8564112364"><div class="ttname"><a href="group__Vectors.html#gad6524c4e36da91aae3fb6f8564112364">VEC_XSIZE</a></div><div class="ttdeci">#define VEC_XSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00080">matrix1d.h:80</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMatrix1D_html_a203e2128d65fd2d51dc764f5e7c52a63"><div class="ttname"><a href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">Matrix1D::initZeros</a></div><div class="ttdeci">void initZeros()</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00646">matrix1d.h:646</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="classMultidimArray_html_a19114d7a0f50f08786a52c28624dc1d5"><div class="ttname"><a href="classMultidimArray.html#a19114d7a0f50f08786a52c28624dc1d5">MultidimArray::interpolatedElement2D</a></div><div class="ttdeci">T interpolatedElement2D(double x, double y, T outside_value=(T) 0) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02557">multidim_array.h:2557</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga874ef793e14af9ce8dfaf4d676ce701e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void inverseFourierTransformRings </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPolar.html">Polar</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPolar.html">Polar</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPolar__fftw__plans.html">Polar_fftw_plans</a> &amp;&#160;</td>
          <td class="paramname"><em>plans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>conjugated</em> = <code><a class="el" href="polar_8h.html#a1f914e56393271644d01f6aa1a54dbaa">DONT_CONJUGATE</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate inverse FourierTransform of all rings</p>
<p>This function returns a Polar&lt;double&gt; by calculating the inverse FT of all rings in a <a class="el" href="classPolar.html">Polar</a>&lt;std::complex&lt;double&gt; &gt;</p>
<p>Note that the <a class="el" href="classPolar__fftw__plans.html">Polar_fftw_plans</a> may be re-used for polars of the same size They should initially be calculated as in the example below</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;MultidimArray&lt;double&gt; angles, corr;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Polar_fftw_plans plans;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Polar&lt;std::complex&lt;double&gt; &gt; F1, F2;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;M1.calculateFftwPlans(plans); // M1 is a Polar&lt;double&gt;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;fourierTransformRings(M1, F1, plans);</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;inverseFourierTransformRings(F1, M1, plans);</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="polar_8cpp_source.html#l00055">55</a> of file <a class="el" href="polar_8cpp_source.html">polar.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                                                                      {</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    out.<a class="code" href="classPolar.html#aaa859bdf26c988f3432ab0d0c9301743">clear</a>();</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iring = 0; iring &lt; in.<a class="code" href="classPolar.html#a471898c3d9ddca4db17d368cd583482a">getRingNo</a>(); iring++) {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        (plans.<a class="code" href="classPolar__fftw__plans.html#a6c12bc6899b6370ccf8c56c7f2505469">transformers</a>[iring])-&gt;setFourier(in.<a class="code" href="classPolar.html#a7f0ac09b5f06f9b9830a894f94b8a324">rings</a>[iring]);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        (plans.<a class="code" href="classPolar__fftw__plans.html#a6c12bc6899b6370ccf8c56c7f2505469">transformers</a>[iring])-&gt;inverseFourierTransform(); <span class="comment">// fReal points to plans.arrays[iring]</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        out.<a class="code" href="classPolar.html#a7f0ac09b5f06f9b9830a894f94b8a324">rings</a>.push_back(plans.<a class="code" href="classPolar__fftw__plans.html#ab130a0d95b962b4bf691e7d6742c0914">arrays</a>[iring]);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    out.<a class="code" href="classPolar.html#a271d06bd1cb1fb0f7eb242f73f79a4fa">mode</a> = in.<a class="code" href="classPolar.html#a271d06bd1cb1fb0f7eb242f73f79a4fa">mode</a>;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    out.<a class="code" href="classPolar.html#a94e6c5eebcf2775ecfedc1db9da356a3">ring_radius</a> = in.<a class="code" href="classPolar.html#a94e6c5eebcf2775ecfedc1db9da356a3">ring_radius</a>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;}</div><div class="ttc" id="classPolar__fftw__plans_html_a6c12bc6899b6370ccf8c56c7f2505469"><div class="ttname"><a href="classPolar__fftw__plans.html#a6c12bc6899b6370ccf8c56c7f2505469">Polar_fftw_plans::transformers</a></div><div class="ttdeci">std::vector&lt; FourierTransformer * &gt; transformers</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00054">polar.h:54</a></div></div>
<div class="ttc" id="classPolar_html_a94e6c5eebcf2775ecfedc1db9da356a3"><div class="ttname"><a href="classPolar.html#a94e6c5eebcf2775ecfedc1db9da356a3">Polar::ring_radius</a></div><div class="ttdeci">std::vector&lt; double &gt; ring_radius</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00068">polar.h:68</a></div></div>
<div class="ttc" id="classPolar_html_a271d06bd1cb1fb0f7eb242f73f79a4fa"><div class="ttname"><a href="classPolar.html#a271d06bd1cb1fb0f7eb242f73f79a4fa">Polar::mode</a></div><div class="ttdeci">int mode</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00066">polar.h:66</a></div></div>
<div class="ttc" id="classPolar_html_a7f0ac09b5f06f9b9830a894f94b8a324"><div class="ttname"><a href="classPolar.html#a7f0ac09b5f06f9b9830a894f94b8a324">Polar::rings</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; T &gt; &gt; rings</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00069">polar.h:69</a></div></div>
<div class="ttc" id="classPolar__fftw__plans_html_ab130a0d95b962b4bf691e7d6742c0914"><div class="ttname"><a href="classPolar__fftw__plans.html#ab130a0d95b962b4bf691e7d6742c0914">Polar_fftw_plans::arrays</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; double &gt; &gt; arrays</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00055">polar.h:55</a></div></div>
<div class="ttc" id="classPolar_html_aaa859bdf26c988f3432ab0d0c9301743"><div class="ttname"><a href="classPolar.html#aaa859bdf26c988f3432ab0d0c9301743">Polar::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00289">polar.h:289</a></div></div>
<div class="ttc" id="classPolar_html_a471898c3d9ddca4db17d368cd583482a"><div class="ttname"><a href="classPolar.html#a471898c3d9ddca4db17d368cd583482a">Polar::getRingNo</a></div><div class="ttdeci">int getRingNo() const </div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00320">polar.h:320</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gafc7e08d62f162cd32a235df1eba53208"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void normalizedPolarFourierTransform </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPolar.html">Polar</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>polarIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPolar.html">Polar</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>conjugated</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPolar__fftw__plans.html">Polar_fftw_plans</a> *&amp;&#160;</td>
          <td class="paramname"><em>plans</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="polar_8cpp_source.html#l00151">151</a> of file <a class="el" href="polar_8cpp_source.html">polar.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                                  {</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordtype">double</span> mean, stddev;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    polarIn.<a class="code" href="classPolar.html#add7db3d3fc5cbfb787d71d802bf0af10">computeAverageAndStddev</a>(mean, stddev);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    polarIn.<a class="code" href="classPolar.html#a013f68460a9f0fbc977a9f10e1f9e7dd">normalize</a>(mean, stddev);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">if</span> (plans == NULL) {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        plans = <span class="keyword">new</span> <a class="code" href="classPolar__fftw__plans.html">Polar_fftw_plans</a>();</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        polarIn.<a class="code" href="classPolar.html#a67490e990718a2221935ca2c017db1fb">calculateFftwPlans</a>(*plans);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="group__Polar.html#ga02e5b456ea900d6023ee4170514b9864">fourierTransformRings</a>(polarIn, out, *plans, conjugated);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}</div><div class="ttc" id="classPolar__fftw__plans_html"><div class="ttname"><a href="classPolar__fftw__plans.html">Polar_fftw_plans</a></div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00051">polar.h:51</a></div></div>
<div class="ttc" id="classPolar_html_a013f68460a9f0fbc977a9f10e1f9e7dd"><div class="ttname"><a href="classPolar.html#a013f68460a9f0fbc977a9f10e1f9e7dd">Polar::normalize</a></div><div class="ttdeci">void normalize(double average, double stddev)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00526">polar.h:526</a></div></div>
<div class="ttc" id="group__Polar_html_ga02e5b456ea900d6023ee4170514b9864"><div class="ttname"><a href="group__Polar.html#ga02e5b456ea900d6023ee4170514b9864">fourierTransformRings</a></div><div class="ttdeci">void fourierTransformRings(Polar&lt; double &gt; &amp;in, Polar&lt; std::complex&lt; double &gt; &gt; &amp;out, Polar_fftw_plans &amp;plans, bool conjugated)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8cpp_source.html#l00033">polar.cpp:33</a></div></div>
<div class="ttc" id="classPolar_html_add7db3d3fc5cbfb787d71d802bf0af10"><div class="ttname"><a href="classPolar.html#add7db3d3fc5cbfb787d71d802bf0af10">Polar::computeAverageAndStddev</a></div><div class="ttdeci">void computeAverageAndStddev(double &amp;avg, double &amp;stddev, int mode=FULL_CIRCLES) const </div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00482">polar.h:482</a></div></div>
<div class="ttc" id="classPolar_html_a67490e990718a2221935ca2c017db1fb"><div class="ttname"><a href="classPolar.html#a67490e990718a2221935ca2c017db1fb">Polar::calculateFftwPlans</a></div><div class="ttdeci">void calculateFftwPlans(Polar_fftw_plans &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00724">polar.h:724</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gacaa27165654f87c7f78d3069d26a663c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool NORMALIZE&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void polarFourierTransform </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPolar.html">Polar</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>first_ring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>last_ring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPolar__fftw__plans.html">Polar_fftw_plans</a> *&amp;&#160;</td>
          <td class="paramname"><em>plans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>BsplineOrder</em> = <code>3</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute a polar Fourier transform (with/out normalization) of the input image. If plans is NULL, they are computed and returned. </p>

<p>Definition at line <a class="el" href="polar_8cpp_source.html#l00120">120</a> of file <a class="el" href="polar_8cpp_source.html">polar.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                                                   {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="classPolar.html">Polar&lt;double&gt;</a> polarIn;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">if</span> (BsplineOrder == 1)</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        polarIn.<a class="code" href="classPolar.html#a0ade05210836a466416ffcb85eb1dd4e">getPolarFromCartesianBSpline</a>(in, first_ring, last_ring, 1);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Maux;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga007f6aec56f2b0abdb6f4903a22cedf0">produceSplineCoefficients</a>(3, Maux, in);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        polarIn.<a class="code" href="classPolar.html#a0ade05210836a466416ffcb85eb1dd4e">getPolarFromCartesianBSpline</a>(Maux, first_ring, last_ring,</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                BsplineOrder);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">if</span> (NORMALIZE) {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordtype">double</span> mean, stddev;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        polarIn.<a class="code" href="classPolar.html#add7db3d3fc5cbfb787d71d802bf0af10">computeAverageAndStddev</a>(mean, stddev);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        polarIn.<a class="code" href="classPolar.html#a013f68460a9f0fbc977a9f10e1f9e7dd">normalize</a>(mean, stddev);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">if</span> (plans == NULL) {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        plans = <span class="keyword">new</span> <a class="code" href="classPolar__fftw__plans.html">Polar_fftw_plans</a>();</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        polarIn.<a class="code" href="classPolar.html#a67490e990718a2221935ca2c017db1fb">calculateFftwPlans</a>(*plans);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="group__Polar.html#ga02e5b456ea900d6023ee4170514b9864">fourierTransformRings</a>(polarIn, out, *plans, conjugated);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;}</div><div class="ttc" id="group__GeometricalTransformations_html_ga007f6aec56f2b0abdb6f4903a22cedf0"><div class="ttname"><a href="group__GeometricalTransformations.html#ga007f6aec56f2b0abdb6f4903a22cedf0">produceSplineCoefficients</a></div><div class="ttdeci">void produceSplineCoefficients(int SplineDegree, MultidimArray&lt; double &gt; &amp;coeffs, const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V1)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00576">transformations.cpp:576</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classPolar_html_a0ade05210836a466416ffcb85eb1dd4e"><div class="ttname"><a href="classPolar.html#a0ade05210836a466416ffcb85eb1dd4e">Polar::getPolarFromCartesianBSpline</a></div><div class="ttdeci">void getPolarFromCartesianBSpline(const MultidimArray&lt; T &gt; &amp;M1, int first_ring, int last_ring, int BsplineOrder=3, double xoff=0., double yoff=0., double oversample1=1., int mode1=FULL_CIRCLES)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00615">polar.h:615</a></div></div>
<div class="ttc" id="classPolar__fftw__plans_html"><div class="ttname"><a href="classPolar__fftw__plans.html">Polar_fftw_plans</a></div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00051">polar.h:51</a></div></div>
<div class="ttc" id="classPolar_html_a013f68460a9f0fbc977a9f10e1f9e7dd"><div class="ttname"><a href="classPolar.html#a013f68460a9f0fbc977a9f10e1f9e7dd">Polar::normalize</a></div><div class="ttdeci">void normalize(double average, double stddev)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00526">polar.h:526</a></div></div>
<div class="ttc" id="group__Polar_html_ga02e5b456ea900d6023ee4170514b9864"><div class="ttname"><a href="group__Polar.html#ga02e5b456ea900d6023ee4170514b9864">fourierTransformRings</a></div><div class="ttdeci">void fourierTransformRings(Polar&lt; double &gt; &amp;in, Polar&lt; std::complex&lt; double &gt; &gt; &amp;out, Polar_fftw_plans &amp;plans, bool conjugated)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8cpp_source.html#l00033">polar.cpp:33</a></div></div>
<div class="ttc" id="classPolar_html"><div class="ttname"><a href="classPolar.html">Polar</a></div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00061">polar.h:61</a></div></div>
<div class="ttc" id="classPolar_html_add7db3d3fc5cbfb787d71d802bf0af10"><div class="ttname"><a href="classPolar.html#add7db3d3fc5cbfb787d71d802bf0af10">Polar::computeAverageAndStddev</a></div><div class="ttdeci">void computeAverageAndStddev(double &amp;avg, double &amp;stddev, int mode=FULL_CIRCLES) const </div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00482">polar.h:482</a></div></div>
<div class="ttc" id="classPolar_html_a67490e990718a2221935ca2c017db1fb"><div class="ttname"><a href="classPolar.html#a67490e990718a2221935ca2c017db1fb">Polar::calculateFftwPlans</a></div><div class="ttdeci">void calculateFftwPlans(Polar_fftw_plans &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00724">polar.h:724</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga61e0a0f95b718c9957d51cfa6e91daf8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotationalCorrelation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classPolar.html">Polar</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>M1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classPolar.html">Polar</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>M2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>angles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fourier-space rotational Cross-Correlation Function</p>
<p>This function returns the rotational cross-correlation function of two complex Polars M1 and M2 using the cross-correlation convolution theorem.</p>
<p>Note that the local_transformer should have corr (with the right size) already in its fReal, and a Fourier Transform already calculated</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;MultidimArray&lt;double&gt; angles, corr;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;FourierTransformer local_transformer;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Polar_fftw_plans plans;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Polar&lt;std::complex&lt;double&gt; &gt; F1, F2;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;// M1 and M2 are already Polar&lt;double&gt;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;M1.calculateFftwPlans(plans);</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;fourierTransformRings(M1, F1, plans, false);</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;fourierTransformRings(M1, F2, plans, true);// complex conjugated</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;corr.resize(M1.getSampleNoOuterRing());</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;local_transformer.setReal(corr, true);</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;local_transformer.FourierTransform();</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;rotationalCorrelation(F1,F2,angles,corr,local_transformer);</div></div><!-- fragment --><p>Note that this function can be used for real-space and fourier-space correlations!! </p>

<p>Definition at line <a class="el" href="polar_8cpp_source.html#l00067">67</a> of file <a class="el" href="polar_8cpp_source.html">polar.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                                       {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordtype">int</span> nrings = M1.<a class="code" href="classPolar.html#a471898c3d9ddca4db17d368cd583482a">getRingNo</a>();</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">if</span> (nrings != M2.<a class="code" href="classPolar.html#a471898c3d9ddca4db17d368cd583482a">getRingNo</a>()) {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordtype">char</span> errorMsg[256];</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        sprintf(</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                errorMsg,</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                <span class="stringliteral">&quot;rotationalCorrelation: polar structures have unequal number of rings:\</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="stringliteral">        nrings %d and M2.getRingNo %d&quot;</span>,</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                nrings, M2.<a class="code" href="classPolar.html#a471898c3d9ddca4db17d368cd583482a">getRingNo</a>());</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        std::cerr &lt;&lt; errorMsg &lt;&lt; std::endl;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a>, errorMsg);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// Fsum should already be set with the right size in the local_transformer</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// (i.e. through a FourierTransform of corr)</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    aux.<a class="code" href="classRotationalCorrelationAux.html#ab6762c27fa075d4c124a5d33a286cd5a">local_transformer</a>.<a class="code" href="classFourierTransformer.html#a6335c9c01f240a8edf3b363cef43248b">getFourierAlias</a>(aux.<a class="code" href="classRotationalCorrelationAux.html#a4fcb34048dba9fd3facd3486e37cf6c3">Fsum</a>);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#ae6148da7d0bfbf264b8bcd89163b3b0f">memset</a>((<span class="keywordtype">double</span>*) <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(aux.<a class="code" href="classRotationalCorrelationAux.html#a4fcb34048dba9fd3facd3486e37cf6c3">Fsum</a>), 0,</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            2 * <a class="code" href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(aux.<a class="code" href="classRotationalCorrelationAux.html#a4fcb34048dba9fd3facd3486e37cf6c3">Fsum</a>) * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// Multiply M1 and M2 over all rings and sum</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// Assume M2 is already complex conjugated!</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    std::complex&lt;double&gt; auxC;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iring = 0; iring &lt; nrings; iring++) {</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a> = (2. * <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * M1.<a class="code" href="classPolar.html#a94e6c5eebcf2775ecfedc1db9da356a3">ring_radius</a>[iring]);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordtype">int</span> imax = M1.<a class="code" href="classPolar.html#acec5f869748f42d3b521f1db65fd8897">getSampleNo</a>(iring);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keyword">const</span> <a class="code" href="classMultidimArray.html">MultidimArray&lt;std::complex&lt;double&gt;</a> &gt; &amp;M1_iring = M1.<a class="code" href="classPolar.html#a7f0ac09b5f06f9b9830a894f94b8a324">rings</a>[iring];</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keyword">const</span> <a class="code" href="classMultidimArray.html">MultidimArray&lt;std::complex&lt;double&gt;</a> &gt; &amp;M2_iring = M2.<a class="code" href="classPolar.html#a7f0ac09b5f06f9b9830a894f94b8a324">rings</a>[iring];</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordtype">double</span> *ptr1 = (<span class="keywordtype">double</span>*) <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(M1_iring);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordtype">double</span> *ptr2 = (<span class="keywordtype">double</span>*) <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(M2_iring);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordtype">double</span> *ptrFsum = (<span class="keywordtype">double</span> *) <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(aux.<a class="code" href="classRotationalCorrelationAux.html#a4fcb34048dba9fd3facd3486e37cf6c3">Fsum</a>);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; imax; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a> = *ptr1++;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a> = *ptr1++;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> = *ptr2++;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a> = *ptr2++;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            *(ptrFsum++) += w * (a * c - b * d);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            *(ptrFsum++) += w * (b * c + a * d);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        }</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    }</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// Inverse FFT to get real-space correlations</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// The local_transformer should already have corr as setReal!!</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    aux.<a class="code" href="classRotationalCorrelationAux.html#ab6762c27fa075d4c124a5d33a286cd5a">local_transformer</a>.<a class="code" href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">inverseFourierTransform</a>();</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    angles.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux.<a class="code" href="classRotationalCorrelationAux.html#ab6762c27fa075d4c124a5d33a286cd5a">local_transformer</a>.<a class="code" href="classFourierTransformer.html#af23ba51e51832b92788a49520a8baa46">getReal</a>()));</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordtype">double</span> Kaux = 360. / <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(angles);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(angles); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gaa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a>(angles,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = (double) <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * Kaux;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a1c8297f634bb4f9d1235f6c4fa33d7e5"><div class="ttname"><a href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">FourierTransformer::inverseFourierTransform</a></div><div class="ttdeci">void inverseFourierTransform()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00329">xmipp_fftw.cpp:329</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gac87b223f03097d45f776b44b6aeea9f7"><div class="ttname"><a href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a></div><div class="ttdeci">#define MULTIDIM_ARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00136">multidim_array.h:136</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga027a630a86c277b71cda769268764fd1"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a></div><div class="ttdeci">#define MULTIDIM_SIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00125">multidim_array.h:125</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a2b83edee7677c7a2b0a4e5ac99baa586"><div class="ttname"><a href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a></div><div class="ttdeci">doublereal * w</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02494">numerical_recipes.cpp:2494</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3939496af6ccffe20d083935ebd3225b"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a></div><div class="ttdeci">doublereal * d</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="classFourierTransformer_html_af23ba51e51832b92788a49520a8baa46"><div class="ttname"><a href="classFourierTransformer.html#af23ba51e51832b92788a49520a8baa46">FourierTransformer::getReal</a></div><div class="ttdeci">const MultidimArray&lt; double &gt; &amp; getReal() const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00118">xmipp_fftw.cpp:118</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af090b2fbbd2916bfb2e493c5162969d6"><div class="ttname"><a href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a></div><div class="ttdeci">doublereal * b</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="classRotationalCorrelationAux_html_a4fcb34048dba9fd3facd3486e37cf6c3"><div class="ttname"><a href="classRotationalCorrelationAux.html#a4fcb34048dba9fd3facd3486e37cf6c3">RotationalCorrelationAux::Fsum</a></div><div class="ttdeci">MultidimArray&lt; std::complex&lt; double &gt; &gt; Fsum</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00792">polar.h:792</a></div></div>
<div class="ttc" id="classPolar_html_a94e6c5eebcf2775ecfedc1db9da356a3"><div class="ttname"><a href="classPolar.html#a94e6c5eebcf2775ecfedc1db9da356a3">Polar::ring_radius</a></div><div class="ttdeci">std::vector&lt; double &gt; ring_radius</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00068">polar.h:68</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaa6b2513810dd91e11450be99106a2463"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a></div><div class="ttdeci">#define DIRECT_A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00536">multidim_array.h:536</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae6148da7d0bfbf264b8bcd89163b3b0f"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae6148da7d0bfbf264b8bcd89163b3b0f">memset</a></div><div class="ttdeci">memset(wksp+1, 0, n *sizeof(double))</div></div>
<div class="ttc" id="classPolar_html_acec5f869748f42d3b521f1db65fd8897"><div class="ttname"><a href="classPolar.html#acec5f869748f42d3b521f1db65fd8897">Polar::getSampleNo</a></div><div class="ttdeci">int getSampleNo(int iring) const </div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00367">polar.h:367</a></div></div>
<div class="ttc" id="classRotationalCorrelationAux_html_ab6762c27fa075d4c124a5d33a286cd5a"><div class="ttname"><a href="classRotationalCorrelationAux.html#ab6762c27fa075d4c124a5d33a286cd5a">RotationalCorrelationAux::local_transformer</a></div><div class="ttdeci">FourierTransformer local_transformer</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00791">polar.h:791</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a6335c9c01f240a8edf3b363cef43248b"><div class="ttname"><a href="classFourierTransformer.html#a6335c9c01f240a8edf3b363cef43248b">FourierTransformer::getFourierAlias</a></div><div class="ttdeci">void getFourierAlias(T &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00207">xmipp_fftw.h:207</a></div></div>
<div class="ttc" id="classPolar_html_a7f0ac09b5f06f9b9830a894f94b8a324"><div class="ttname"><a href="classPolar.html#a7f0ac09b5f06f9b9830a894f94b8a324">Polar::rings</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; T &gt; &gt; rings</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00069">polar.h:69</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a></div><div class="ttdoc">Incorrect value received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00200">xmipp_error.h:200</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af2a333b1670df64a88d3a2f22210d155"><div class="ttname"><a href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a></div><div class="ttdeci">doublereal * a</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="classPolar_html_a471898c3d9ddca4db17d368cd583482a"><div class="ttname"><a href="classPolar.html#a471898c3d9ddca4db17d368cd583482a">Polar::getRingNo</a></div><div class="ttdeci">int getRingNo() const </div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00320">polar.h:320</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga191bbb2c43b0978de4379b80f81c42ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void volume_convertCartesianToCylindrical </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltaR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>angMin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angMax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>deltaAng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Produce a cylindrical volume from a cartesian volume. You can give the minimum and maximum radius for the interpolation, the delta radius and the delta angle. It is assumed that the input image has the Xmipp origin. Delta Ang must be in radians. </p>

<p>Definition at line <a class="el" href="polar_8cpp_source.html#l00257">257</a> of file <a class="el" href="polar_8cpp_source.html">polar.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                                                                             {</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">size_t</span> NAngSteps = (size_t)<a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>((angMax - angMin) / deltaAng);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordtype">size_t</span> NRSteps = (size_t)<a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>((Rmax - Rmin) / deltaR);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    out.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(in), NAngSteps, NRSteps);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(out) = <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(in);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(out) = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(out) = 0;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// Calculate rotation matrix</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> M;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(axis)!=0.0 || <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(axis)!=0.0)</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="comment">// 1) Calculate rotation axis v=(0,0,1) x axis</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> v(3);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(v)=-<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(axis);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(v)=<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(axis);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="comment">// 2) Calculate rotation angle (0,0,1).axis=module(axis).cos(ang)</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordtype">double</span> rotAng=acos(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(axis)/axis.<a class="code" href="classMatrix1D.html#a9ee6afb32720ca26450038def994af96">module</a>());</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="comment">// 3) Calculate matrix</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a>(<a class="code" href="group__Macros.html#ga18b5ff2c19b69c072069398c7a5520cd">RAD2DEG</a>(rotAng), v, M, <span class="keyword">false</span>);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    }</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> p(3), pc(3);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a>;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NAngSteps; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordtype">float</span> angle = angMin + <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * deltaAng;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keywordtype">float</span> s = sin(angle);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordtype">float</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> = cos(angle);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> = <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(in); <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> &lt;= <a class="code" href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(in); ++<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>) {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(p)=<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; NRSteps; ++<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                <span class="keywordtype">float</span> R = Rmin + <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> * deltaR;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p) = R * s;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p) = R * <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a>(M)&gt;0)</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                    <a class="code" href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a>(pc,M,p);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(out,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = in.<a class="code" href="classMultidimArray.html#afb23d4b42159a329b152ebb23f050b94">interpolatedElement3D</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(pc),<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(pc),<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(pc));</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(out,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = in.<a class="code" href="classMultidimArray.html#afb23d4b42159a329b152ebb23f050b94">interpolatedElement3D</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p),<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p),<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(p));</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    }</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;}</div><div class="ttc" id="cuda__basic__math_8h_html_a2065eb145275f878c1d045c9f3fb1cc7"><div class="ttname"><a href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a></div><div class="ttdeci">__host__ __device__ float2 floor(const float2 v)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__basic__math_8h_source.html#l00175">cuda_basic_math.h:175</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga706d2ce724d393d4d759a46225bbc6c1"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a></div><div class="ttdeci">#define FINISHINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00081">multidim_array.h:81</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gade7a7cd894f08efccc7d6b6410bbf891"><div class="ttname"><a href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a></div><div class="ttdeci">void rotation3DMatrix(double ang, char axis, Matrix2D&lt; double &gt; &amp;result, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00277">transformations.cpp:277</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="classMultidimArray_html_afb23d4b42159a329b152ebb23f050b94"><div class="ttname"><a href="classMultidimArray.html#afb23d4b42159a329b152ebb23f050b94">MultidimArray::interpolatedElement3D</a></div><div class="ttdeci">T interpolatedElement3D(double x, double y, double z, T outside_value=(T) 0) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02519">multidim_array.h:2519</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Matrices_html_gad159332322d687de886a720422e4b757"><div class="ttname"><a href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a></div><div class="ttdeci">#define M3x3_BY_V3x1(a, M, b)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00171">matrix2d.h:171</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Macros_html_ga18b5ff2c19b69c072069398c7a5520cd"><div class="ttname"><a href="group__Macros.html#ga18b5ff2c19b69c072069398c7a5520cd">RAD2DEG</a></div><div class="ttdeci">#define RAD2DEG(r)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00320">xmipp_macros.h:320</a></div></div>
<div class="ttc" id="group__Matrices_html_gacd5c6ac63f21fdbbd4343a9caf1ee9c6"><div class="ttname"><a href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a></div><div class="ttdeci">#define MAT_XSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00121">matrix2d.h:121</a></div></div>
<div class="ttc" id="classMatrix1D_html_a9ee6afb32720ca26450038def994af96"><div class="ttname"><a href="classMatrix1D.html#a9ee6afb32720ca26450038def994af96">Matrix1D::module</a></div><div class="ttdeci">double module() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01578">matrix1d.h:1578</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="group__Macros_html_ga20716e3da0ba25d3c4c9a2421573391f"><div class="ttname"><a href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a></div><div class="ttdeci">#define SPEED_UP_temps012</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00403">xmipp_macros.h:403</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga83a9d3893b304654735c75978a8802f9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void volume_convertCartesianToSpherical </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltaR</em> = <code>1.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltaRot</em> = <code>2.*<a class="el" href="group__Macros.html#ga598a3330b3c21701223ee0ca14316eca">PI</a>/360.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltaTilt</em> = <code><a class="el" href="group__Macros.html#ga598a3330b3c21701223ee0ca14316eca">PI</a>/180.</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Produce a spherical volume from a cartesian voume. You can give the minimum and maximum radii for the interpolation. It is assumed that the input image has the Xmipp origin. Delta Ang must be in radians. </p>

<p>Definition at line <a class="el" href="polar_8cpp_source.html#l00307">307</a> of file <a class="el" href="polar_8cpp_source.html">polar.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                                           {</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordtype">size_t</span> NRotSteps = (size_t)<a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(2*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> / deltaRot);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordtype">size_t</span> NTiltSteps = (size_t)<a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> / deltaRot);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordtype">size_t</span> NRSteps = (size_t)<a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>((Rmax - Rmin) / deltaR);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    out.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(NRSteps, NRotSteps, NTiltSteps);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(out) = <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(out) = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(out) = 0;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> p(3);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NRotSteps; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordtype">float</span> rot = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * deltaRot;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keywordtype">float</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> = cos(rot);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keywordtype">float</span> s = sin(rot);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; NRotSteps; ++<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <span class="keywordtype">float</span> tilt = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> * deltaTilt;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordtype">float</span> stilt = sin(tilt);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            <span class="keywordtype">float</span> ctilt = cos(tilt);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            <span class="keywordtype">float</span> sc = stilt * <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="keywordtype">float</span> ss = stilt * s;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> = 0; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>&lt;NRSteps; ++<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>) {</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                <span class="keywordtype">float</span> R = Rmin + <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> * deltaR;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(p)=R*ctilt;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p)=R*ss;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p)=R*sc;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(out,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = in.<a class="code" href="classMultidimArray.html#afb23d4b42159a329b152ebb23f050b94">interpolatedElement3D</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p),<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p),<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(p));</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    }</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;}</div><div class="ttc" id="cuda__basic__math_8h_html_a2065eb145275f878c1d045c9f3fb1cc7"><div class="ttname"><a href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a></div><div class="ttdeci">__host__ __device__ float2 floor(const float2 v)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__basic__math_8h_source.html#l00175">cuda_basic_math.h:175</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMultidimArray_html_afb23d4b42159a329b152ebb23f050b94"><div class="ttname"><a href="classMultidimArray.html#afb23d4b42159a329b152ebb23f050b94">MultidimArray::interpolatedElement3D</a></div><div class="ttdeci">T interpolatedElement3D(double x, double y, double z, T outside_value=(T) 0) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02519">multidim_array.h:2519</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
