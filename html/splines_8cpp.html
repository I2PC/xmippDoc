<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Xmipp: /home/yunior/Yunior/Projects/Scipion/COSS/xmipp-bundle/src/xmipp/libraries/data/splines.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_dbce2b2c1291334a9ade6207c7a262fa.html">xmipp-bundle</a></li><li class="navelem"><a class="el" href="dir_5ca4f3e8e51f1e22c724fe6427eb943c.html">src</a></li><li class="navelem"><a class="el" href="dir_51a4fe91bde3feaf0f23bad87d0144e4.html">xmipp</a></li><li class="navelem"><a class="el" href="dir_c1f8b3d1b5354b6c120dfc6668096234.html">libraries</a></li><li class="navelem"><a class="el" href="dir_f083b9d43eb51ff5c9ab4698ce0a19c4.html">data</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">splines.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="splines_8h_source.html">splines.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="libraries_2data_2integration_8h_source.html">integration.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for splines.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="splines_8cpp__incl.png" border="0" usemap="#_2home_2yunior_2Yunior_2Projects_2Scipion_2COSS_2xmipp-bundle_2src_2xmipp_2libraries_2data_2splines_8cpp" alt=""/></div>
<map name="_2home_2yunior_2Yunior_2Projects_2Scipion_2COSS_2xmipp-bundle_2src_2xmipp_2libraries_2data_2splines_8cpp" id="_2home_2yunior_2Yunior_2Projects_2Scipion_2COSS_2xmipp-bundle_2src_2xmipp_2libraries_2data_2splines_8cpp">
<area shape="rect" id="node2" href="splines_8h.html" title="splines.h" alt="" coords="1045,124,1120,151"/>
<area shape="rect" id="node48" href="libraries_2data_2integration_8h.html" title="integration.h" alt="" coords="1693,647,1787,673"/>
<area shape="rect" id="node3" href="kernel_8h.html" title="core/bilib/kernel.h" alt="" coords="246,796,370,823"/>
<area shape="rect" id="node4" href="grids_8h.html" title="grids.h" alt="" coords="1052,199,1113,225"/>
<area shape="rect" id="node6" href="xmipp__image_8h.html" title="core/xmipp_image.h" alt="" coords="468,273,607,300"/>
<area shape="rect" id="node34" href="geometry_8h.html" title="geometry.h" alt="" coords="1483,572,1570,599"/>
<area shape="rect" id="node47" href="args_8h.html" title="core/args.h" alt="" coords="446,945,533,972"/>
<area shape="rect" id="node7" href="xmipp__image__base_8h.html" title="xmipp_image_base.h" alt="" coords="767,423,913,449"/>
<area shape="rect" id="node9" href="multidim__array_8h.html" title="multidim_array.h" alt="" coords="845,721,963,748"/>
<area shape="rect" id="node45" href="xmipp__image__generic_8h.html" title="xmipp_image_generic.h" alt="" coords="458,348,617,375"/>
<area shape="rect" id="node46" href="xmipp__color_8h.html" title="xmipp_color.h" alt="" coords="94,423,197,449"/>
<area shape="rect" id="node8" href="xmipp__image__macros_8h.html" title="xmipp_image_macros.h" alt="" coords="920,497,1080,524"/>
<area shape="rect" id="node31" href="transformations_8h.html" title="transformations.h" alt="" coords="1467,497,1589,524"/>
<area shape="rect" id="node33" href="xmipp__datatype_8h.html" title="xmipp_datatype.h" alt="" coords="195,721,320,748"/>
<area shape="rect" id="node35" href="metadata_8h.html" title="metadata.h" alt="" coords="1375,871,1462,897"/>
<area shape="rect" id="node38" href="rwDM3_8h.html" title="rwDM3.h" alt="" coords="1269,497,1344,524"/>
<area shape="rect" id="node39" href="rwDM4_8h.html" title="rwDM4.h" alt="" coords="1368,497,1443,524"/>
<area shape="rect" id="node40" href="rwIMAGIC_8h.html" title="rwIMAGIC.h" alt="" coords="327,497,422,524"/>
<area shape="rect" id="node41" href="rwMRC_8h.html" title="rwMRC.h" alt="" coords="446,497,525,524"/>
<area shape="rect" id="node42" href="rwINF_8h.html" title="rwINF.h" alt="" coords="549,497,619,524"/>
<area shape="rect" id="node43" href="rwRAW_8h.html" title="rwRAW.h" alt="" coords="643,497,722,524"/>
<area shape="rect" id="node44" href="rwSPIDER_8h.html" title="rwSPIDER.h" alt="" coords="747,497,845,524"/>
<area shape="rect" id="node10" href="tsplinebasis_8h.html" title="bilib/tsplinebasis.h" alt="" coords="737,796,866,823"/>
<area shape="rect" id="node11" href="xmipp__strings_8h.html" title="xmipp_strings.h" alt="" coords="557,1095,672,1121"/>
<area shape="rect" id="node14" href="matrix1d_8h.html" title="matrix1d.h" alt="" coords="608,871,691,897"/>
<area shape="rect" id="node26" href="matrix2d_8h.html" title="matrix2d.h" alt="" coords="960,796,1043,823"/>
<area shape="rect" id="node18" href="xmipp__funcs_8h.html" title="xmipp_funcs.h" alt="" coords="1011,945,1117,972"/>
<area shape="rect" id="node25" href="numerical__recipes_8h.html" title="numerical_recipes.h" alt="" coords="848,945,987,972"/>
<area shape="rect" id="node20" href="xmipp__filename_8h.html" title="xmipp_filename.h" alt="" coords="955,1020,1079,1047"/>
<area shape="rect" id="node22" href="xmipp__macros_8h.html" title="xmipp_macros.h" alt="" coords="1103,1020,1222,1047"/>
<area shape="rect" id="node23" href="xmipp__error_8h.html" title="xmipp_error.h" alt="" coords="672,1020,773,1047"/>
<area shape="rect" id="node28" href="linearalgebra_8h.html" title="bilib/linearalgebra.h" alt="" coords="853,871,987,897"/>
<area shape="rect" id="node32" href="multidim__array__generic_8h.html" title="multidim_array_generic.h" alt="" coords="921,647,1087,673"/>
</map>
</div>
</div>
<p><a href="splines_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a94ec8a7a5cf5c289d292aef5777c4c14"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="splines_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(*vol_voxels)</td></tr>
<tr class="separator:a94ec8a7a5cf5c289d292aef5777c4c14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f613ddaea2048e3471a1f4f04ba4b79"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="splines_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(*vol_voxels)</td></tr>
<tr class="separator:a8f613ddaea2048e3471a1f4f04ba4b79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d9521fd31b2e16413d1b78836953d53"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="splines_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(*vol_voxels)</td></tr>
<tr class="separator:a0d9521fd31b2e16413d1b78836953d53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a132f3924593d07b0a1f55b3f22e92ba6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="splines_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a>&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(*vol_voxels)</td></tr>
<tr class="separator:a132f3924593d07b0a1f55b3f22e92ba6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f5c4dfb0dff56801752771f78265fbe"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="splines_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(*vol_voxels)</td></tr>
<tr class="separator:a3f5c4dfb0dff56801752771f78265fbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14105579fd3a215f98f182c2347fb774"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="splines_8cpp.html#a14105579fd3a215f98f182c2347fb774">zF</a>&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(*vol_voxels)</td></tr>
<tr class="separator:a14105579fd3a215f98f182c2347fb774"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gab7dafc89eb00274550d2066dfd345c09"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Splines.html#gab7dafc89eb00274550d2066dfd345c09">Bspline03LUT</a> (double <a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>)</td></tr>
<tr class="separator:gab7dafc89eb00274550d2066dfd345c09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04d7dbb3f88cf05e645ca971f72da415"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="splines_8cpp.html#a04d7dbb3f88cf05e645ca971f72da415">sum_spatial_Bspline03_SimpleGrid</a> (const <a class="el" href="classSimpleGrid.html">SimpleGrid</a> &amp;grid)</td></tr>
<tr class="separator:a04d7dbb3f88cf05e645ca971f72da415"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga474d9b73fd849e8c170d0270c9ece56a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Splines.html#ga474d9b73fd849e8c170d0270c9ece56a">sum_spatial_Bspline03_Grid</a> (const <a class="el" href="classGrid.html">Grid</a> &amp;grid)</td></tr>
<tr class="separator:ga474d9b73fd849e8c170d0270c9ece56a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c2ad3dc28c8478f4a6b1c33600185f1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="splines_8cpp.html#a3c2ad3dc28c8478f4a6b1c33600185f1">spatial_Bspline03_integralf</a> (double alpha)</td></tr>
<tr class="separator:a3c2ad3dc28c8478f4a6b1c33600185f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc7cfea82b49eae05616ec4b0ed5211e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="splines_8cpp.html#acc7cfea82b49eae05616ec4b0ed5211e">spatial_Bspline03_integral</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;r, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a>, double alpha0, double alphaF)</td></tr>
<tr class="separator:acc7cfea82b49eae05616ec4b0ed5211e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6539464d3b7e3011508c1952c4712f17"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Splines.html#ga6539464d3b7e3011508c1952c4712f17">spatial_Bspline03_proj</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;r, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a>)</td></tr>
<tr class="separator:ga6539464d3b7e3011508c1952c4712f17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae49a23d8bc315ec733a076db636edb19"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="splines_8cpp.html#ae49a23d8bc315ec733a076db636edb19">spatial_Bspline032voxels_SimpleGrid</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;vol_splines, const <a class="el" href="classSimpleGrid.html">SimpleGrid</a> &amp;grid, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *vol_voxels, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *vol_mask=NULL)</td></tr>
<tr class="separator:ae49a23d8bc315ec733a076db636edb19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8a051f6a2efecb133593bd206d050154"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Splines.html#ga8a051f6a2efecb133593bd206d050154">spatial_Bspline032voxels</a> (const <a class="el" href="group__Grids.html#gae3eeb15b316a9800a7c35372dfd57460">GridVolume</a> &amp;vol_splines, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *vol_voxels, int Zdim, int Ydim, int Xdim)</td></tr>
<tr class="separator:ga8a051f6a2efecb133593bd206d050154"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a94ec8a7a5cf5c289d292aef5777c4c14"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define x0&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(*vol_voxels)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a8f613ddaea2048e3471a1f4f04ba4b79"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define xF&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(*vol_voxels)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a0d9521fd31b2e16413d1b78836953d53"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define y0&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(*vol_voxels)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a132f3924593d07b0a1f55b3f22e92ba6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define yF&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(*vol_voxels)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3f5c4dfb0dff56801752771f78265fbe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define z0&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(*vol_voxels)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a14105579fd3a215f98f182c2347fb774"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define zF&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(*vol_voxels)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ae49a23d8bc315ec733a076db636edb19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spatial_Bspline032voxels_SimpleGrid </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>vol_splines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classSimpleGrid.html">SimpleGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>vol_voxels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>vol_mask</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="splines_8cpp_source.html#l00205">205</a> of file <a class="el" href="splines_8cpp_source.html">splines.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;{</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> act_coord(3);           <span class="comment">// Coord: Actual position inside</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">// the voxel volume without deforming</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> beginZ(3);              <span class="comment">// Coord: Voxel coordinates of the</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">// blob at the 3D point</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// (z0,YY(lowest),XX(lowest))</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> beginY(3);              <span class="comment">// Coord: Voxel coordinates of the</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">// blob at the 3D point</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">// (z0,y0,XX(lowest))</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> corner2(3), corner1(3); <span class="comment">// Coord: Corners of the</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="comment">// blob in the voxel volume</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> gcurrent(3);            <span class="comment">// Position in g of current point</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordtype">double</span>        intx, inty, intz;          <span class="comment">// Nearest integer voxel</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordtype">int</span>           <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>;                   <span class="comment">// Index within the blob volume</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordtype">bool</span>          process;                   <span class="comment">// True if this blob has to be</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">// processed</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordtype">double</span> spline_radius = 2 * <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(3.0);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">// Some aliases</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="preprocessor">#define x0 STARTINGX(*vol_voxels)</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="preprocessor">#define xF FINISHINGX(*vol_voxels)</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="preprocessor">#define y0 STARTINGY(*vol_voxels)</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="preprocessor">#define yF FINISHINGY(*vol_voxels)</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="preprocessor">#define z0 STARTINGZ(*vol_voxels)</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="preprocessor">#define zF FINISHINGZ(*vol_voxels)</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordtype">bool</span> condition = <span class="keyword">true</span>;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    (*vol_voxels)().printShape();</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;x0= &quot;</span> &lt;&lt; <a class="code" href="splines_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a> &lt;&lt; <span class="stringliteral">&quot; xF= &quot;</span> &lt;&lt; <a class="code" href="splines_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;y0= &quot;</span> &lt;&lt; <a class="code" href="splines_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a> &lt;&lt; <span class="stringliteral">&quot; yF= &quot;</span> &lt;&lt; <a class="code" href="splines_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;z0= &quot;</span> &lt;&lt; <a class="code" href="splines_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a> &lt;&lt; <span class="stringliteral">&quot; zF= &quot;</span> &lt;&lt; <a class="code" href="splines_8cpp.html#a14105579fd3a215f98f182c2347fb774">zF</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    std::cout &lt;&lt; grid;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">// Convert the whole grid ...............................................</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">// Corner of the plane defined by Z. These coordinates are in the</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">// universal coord. system</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    grid.<a class="code" href="classSimpleGrid.html#a1de43d3a6ae7166e119e56ff58a6c452">grid2universe</a>(grid.lowest, beginZ);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> grid_index(3);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">for</span> (k = (<span class="keywordtype">int</span>) <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(grid.lowest); k &lt;= (<span class="keywordtype">int</span>) <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(grid.highest); k++)</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    {</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="comment">// Corner of the row defined by Y</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        beginY = beginZ;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordflow">for</span> (i = (<span class="keywordtype">int</span>) <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(grid.lowest); i &lt;= (<span class="keywordtype">int</span>) <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(grid.highest); i++)</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="comment">// First point in the row</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            act_coord = beginY;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="keywordflow">for</span> (j = (<span class="keywordtype">int</span>) <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(grid.lowest); j &lt;= (<span class="keywordtype">int</span>) <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(grid.highest); j++)</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(grid_index, j, i, k);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    printf(<span class="stringliteral">&quot;Dealing spline at (%d,%d,%d) = %f\n&quot;</span>, j, i, k, <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(vol_splines, k, i, j));</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;Center of the blob      &quot;</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                    &lt;&lt; act_coord.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                <span class="comment">// These two corners are also real valued</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                process = <span class="keyword">true</span>;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(act_coord) &gt;= <a class="code" href="splines_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>) process = <span class="keyword">false</span>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(act_coord) &gt;= <a class="code" href="splines_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a>) process = <span class="keyword">false</span>;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(act_coord) &gt;= <a class="code" href="splines_8cpp.html#a14105579fd3a215f98f182c2347fb774">zF</a>) process = <span class="keyword">false</span>;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(act_coord) &lt;= <a class="code" href="splines_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>) process = <span class="keyword">false</span>;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(act_coord) &lt;= <a class="code" href="splines_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>) process = <span class="keyword">false</span>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(act_coord) &lt;= <a class="code" href="splines_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>) process = <span class="keyword">false</span>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                <span class="keywordflow">if</span> (!process &amp;&amp; condition) std::cout &lt;&lt; <span class="stringliteral">&quot;   It is outside output volume\n&quot;</span>;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                <span class="keywordflow">if</span> (!grid.is_interesting(act_coord))</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                    <span class="keywordflow">if</span> (process &amp;&amp; condition) std::cout &lt;&lt; <span class="stringliteral">&quot;   It is not interesting\n&quot;</span>;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                    process = <span class="keyword">false</span>;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                <span class="keywordflow">if</span> (process)</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                    <a class="code" href="group__Vectors.html#ga7daaf322a2ebcd0d3ede6f53d215f834">V3_PLUS_CT</a>(corner1, act_coord, -spline_radius);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                    <a class="code" href="group__Vectors.html#ga7daaf322a2ebcd0d3ede6f53d215f834">V3_PLUS_CT</a>(corner2, act_coord, spline_radius);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                    <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                    {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;Corner 1 for this point &quot;</span> &lt;&lt; corner1.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;Corner 2 for this point &quot;</span> &lt;&lt; corner2.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                    }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                    <span class="comment">// Clip the corners to the volume borders</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1) = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1), <a class="code" href="splines_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>, <a class="code" href="splines_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>));</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1) = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1), <a class="code" href="splines_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>, <a class="code" href="splines_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a>));</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner1) = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner1), <a class="code" href="splines_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>, <a class="code" href="splines_8cpp.html#a14105579fd3a215f98f182c2347fb774">zF</a>));</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2) = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2), <a class="code" href="splines_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>, <a class="code" href="splines_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>));</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2) = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2), <a class="code" href="splines_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>, <a class="code" href="splines_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a>));</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner2) = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner2), <a class="code" href="splines_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>, <a class="code" href="splines_8cpp.html#a14105579fd3a215f98f182c2347fb774">zF</a>));</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                    <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                    {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;Clipped and rounded Corner 1 &quot;</span> &lt;&lt; corner1.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;Clipped and rounded Corner 2 &quot;</span> &lt;&lt; corner2.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                    }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                    <span class="comment">// Effectively convert</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                    <span class="keywordflow">for</span> (intz = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner1); intz &lt;= <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner2); intz++)</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                        <span class="keywordflow">for</span> (inty = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1); inty &lt;= <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2); inty++)</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                            <span class="keywordflow">for</span> (intx = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1); intx &lt;= <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2); intx++)</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                            {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                                <span class="keywordtype">int</span> iz = (int)intz, iy = (<span class="keywordtype">int</span>)inty, ix = (int)intx;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                <span class="keywordflow">if</span> (vol_mask != NULL)</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                                    <span class="keywordflow">if</span> (!<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*vol_mask, iz, iy, ix)) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                                <span class="comment">// Compute the spline value at this point</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                                <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(gcurrent, intx, inty, intz);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                                <a class="code" href="group__Vectors.html#ga84bcbfeda75ac1ed822f6d92585e4fdf">V3_MINUS_V3</a>(gcurrent, act_coord, gcurrent);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                                <span class="keywordtype">double</span> spline_value = <a class="code" href="group__Splines.html#ga41a63def75258d0e8dd479c5348dfef1">spatial_Bspline03</a>(gcurrent);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="preprocessor">#ifdef DEBUG_MORE</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                                <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                                {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                                    std::cout &lt;&lt; <span class="stringliteral">&quot;At (&quot;</span> &lt;&lt; intx &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                                    &lt;&lt; inty &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; intz &lt;&lt; <span class="stringliteral">&quot;) value=&quot;</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                                    &lt;&lt; spline_value;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                                    std::cout.flush();</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                                }</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                                <span class="comment">// Add at that position the corresponding spline value</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                                <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*vol_voxels, iz, iy, ix) +=</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                                    <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(vol_splines, k, i, j) * spline_value;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="preprocessor">#ifdef DEBUG_MORE</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                                <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                {</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                    std::cout &lt;&lt; <span class="stringliteral">&quot; adding &quot;</span> &lt;&lt; <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(vol_splines, k, i, j)</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot; * &quot;</span> &lt;&lt; value_spline &lt;&lt; <span class="stringliteral">&quot; = &quot;</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                                    &lt;&lt; <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(vol_splines, k, i, j)*</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                                    value_spline &lt;&lt; std::endl;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                    std::cout.flush();</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                }</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                            }</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                <span class="comment">// Prepare for next iteration</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(act_coord) = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(act_coord) + grid.relative_size * grid.basis(0, 0);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(act_coord) = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(act_coord) + grid.relative_size * grid.basis(1, 0);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(act_coord) = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(act_coord) + grid.relative_size * grid.basis(2, 0);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            }</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(beginY) = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(beginY) + grid.relative_size * grid.basis(0, 1);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(beginY) = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(beginY) + grid.relative_size * grid.basis(1, 1);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(beginY) = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(beginY) + grid.relative_size * grid.basis(2, 1);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        }</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(beginZ) = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(beginZ) + grid.relative_size * grid.basis(0, 2);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(beginZ) = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(beginZ) + grid.relative_size * grid.basis(1, 2);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(beginZ) = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(beginZ) + grid.relative_size * grid.basis(2, 2);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    }</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="splines_8cpp_html_a14105579fd3a215f98f182c2347fb774"><div class="ttname"><a href="splines_8cpp.html#a14105579fd3a215f98f182c2347fb774">zF</a></div><div class="ttdeci">#define zF</div></div>
<div class="ttc" id="group__Vectors_html_ga7daaf322a2ebcd0d3ede6f53d215f834"><div class="ttname"><a href="group__Vectors.html#ga7daaf322a2ebcd0d3ede6f53d215f834">V3_PLUS_CT</a></div><div class="ttdeci">#define V3_PLUS_CT(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00223">matrix1d.h:223</a></div></div>
<div class="ttc" id="splines_8cpp_html_a0d9521fd31b2e16413d1b78836953d53"><div class="ttname"><a href="splines_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a></div><div class="ttdeci">#define y0</div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="splines_8cpp_html_a8f613ddaea2048e3471a1f4f04ba4b79"><div class="ttname"><a href="splines_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a></div><div class="ttdeci">#define xF</div></div>
<div class="ttc" id="classSimpleGrid_html_a1de43d3a6ae7166e119e56ff58a6c452"><div class="ttname"><a href="classSimpleGrid.html#a1de43d3a6ae7166e119e56ff58a6c452">SimpleGrid::grid2universe</a></div><div class="ttdeci">void grid2universe(const Matrix1D&lt; double &gt; &amp;gv, Matrix1D&lt; double &gt; &amp;uv) const </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00326">grids.h:326</a></div></div>
<div class="ttc" id="group__Vectors_html_ga84bcbfeda75ac1ed822f6d92585e4fdf"><div class="ttname"><a href="group__Vectors.html#ga84bcbfeda75ac1ed822f6d92585e4fdf">V3_MINUS_V3</a></div><div class="ttdeci">#define V3_MINUS_V3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00205">matrix1d.h:205</a></div></div>
<div class="ttc" id="group__Splines_html_ga41a63def75258d0e8dd479c5348dfef1"><div class="ttname"><a href="group__Splines.html#ga41a63def75258d0e8dd479c5348dfef1">spatial_Bspline03</a></div><div class="ttdeci">double spatial_Bspline03(const Matrix1D&lt; double &gt; &amp;r)</div><div class="ttdef"><b>Definition:</b> <a href="splines_8h_source.html#l00044">splines.h:44</a></div></div>
<div class="ttc" id="splines_8cpp_html_a3f5c4dfb0dff56801752771f78265fbe"><div class="ttname"><a href="splines_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a></div><div class="ttdeci">#define z0</div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Macros_html_gad4d08cca0a39849cc247072eaebe7726"><div class="ttname"><a href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a></div><div class="ttdeci">#define CLIP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00260">xmipp_macros.h:260</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="splines_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="splines_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_ga6c6b4d4f88daca5e1d8e171bec3b4af0"><div class="ttname"><a href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a></div><div class="ttdeci">#define VECTOR_R3(v, x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00127">matrix1d.h:127</a></div></div>
<div class="ttc" id="splines_8cpp_html_a132f3924593d07b0a1f55b3f22e92ba6"><div class="ttname"><a href="splines_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a></div><div class="ttdeci">#define yF</div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acc7cfea82b49eae05616ec4b0ed5211e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double spatial_Bspline03_integral </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alphaF</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="splines_8cpp_source.html#l00092">92</a> of file <a class="el" href="splines_8cpp_source.html">splines.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;{</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    global_r = r;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    global_u = <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a>;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__NumericalIntegration.html#ga0a538d4836e220c082f1edd1cc90f745">integrateNewtonCotes</a>(&amp;<a class="code" href="splines_8cpp.html#a3c2ad3dc28c8478f4a6b1c33600185f1">spatial_Bspline03_integralf</a>, alpha0, alphaF, 9);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div><div class="ttc" id="splines_8cpp_html_a3c2ad3dc28c8478f4a6b1c33600185f1"><div class="ttname"><a href="splines_8cpp.html#a3c2ad3dc28c8478f4a6b1c33600185f1">spatial_Bspline03_integralf</a></div><div class="ttdeci">double spatial_Bspline03_integralf(double alpha)</div><div class="ttdef"><b>Definition:</b> <a href="splines_8cpp_source.html#l00084">splines.cpp:84</a></div></div>
<div class="ttc" id="group__NumericalIntegration_html_ga0a538d4836e220c082f1edd1cc90f745"><div class="ttname"><a href="group__NumericalIntegration.html#ga0a538d4836e220c082f1edd1cc90f745">integrateNewtonCotes</a></div><div class="ttdeci">double integrateNewtonCotes(double(*f)(double), double a, double b, int N)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2integration_8cpp_source.html#l00029">integration.cpp:29</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a6277e2a7446059985dc9bcf0a4ac1a8f"><div class="ttname"><a href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a></div><div class="ttdeci">doublereal * u</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3c2ad3dc28c8478f4a6b1c33600185f1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double spatial_Bspline03_integralf </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="splines_8cpp_source.html#l00084">84</a> of file <a class="el" href="splines_8cpp_source.html">splines.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;{</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(global_aux) = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(global_r) + <a class="code" href="structblobtype.html#ae713f8fc66da6e18d0bc2ff381bda22f">alpha</a> * <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(global_u);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(global_aux) = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(global_r) + <a class="code" href="structblobtype.html#ae713f8fc66da6e18d0bc2ff381bda22f">alpha</a> * <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(global_u);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(global_aux) = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(global_r) + <a class="code" href="structblobtype.html#ae713f8fc66da6e18d0bc2ff381bda22f">alpha</a> * <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(global_u);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__Splines.html#ga7f7290c1542769e06a5a79b09cd676be">spatial_Bspline03LUT</a>(global_aux);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;}</div><div class="ttc" id="structblobtype_html_ae713f8fc66da6e18d0bc2ff381bda22f"><div class="ttname"><a href="structblobtype.html#ae713f8fc66da6e18d0bc2ff381bda22f">blobtype::alpha</a></div><div class="ttdeci">double alpha</div><div class="ttdoc">Smoothness parameter. </div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00122">blobs.h:122</a></div></div>
<div class="ttc" id="group__Splines_html_ga7f7290c1542769e06a5a79b09cd676be"><div class="ttname"><a href="group__Splines.html#ga7f7290c1542769e06a5a79b09cd676be">spatial_Bspline03LUT</a></div><div class="ttdeci">double spatial_Bspline03LUT(const Matrix1D&lt; double &gt; &amp;r)</div><div class="ttdef"><b>Definition:</b> <a href="splines_8h_source.html#l00060">splines.h:60</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a04d7dbb3f88cf05e645ca971f72da415"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double sum_spatial_Bspline03_SimpleGrid </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classSimpleGrid.html">SimpleGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="splines_8cpp_source.html#l00048">48</a> of file <a class="el" href="splines_8cpp_source.html">splines.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> gr(3), ur(3), corner1(3), corner2(3);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordtype">int</span>          <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordtype">double</span>        sum = 0.0;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">// Compute the limits of the spline in the grid coordinate system</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    grid.<a class="code" href="classSimpleGrid.html#aa9b2618b77cd696ee03117baab9a0162">universe2grid</a>(<a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(-2.0, -2.0, -2.0), corner1);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    grid.<a class="code" href="classSimpleGrid.html#aa9b2618b77cd696ee03117baab9a0162">universe2grid</a>(<a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(2.0, 2.0, 2.0), corner2);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">// Compute the sum in the points inside the grid</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">// The integer part of the vectors is taken for not picking points</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">// just in the border of the spline, which we know they are 0.</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">for</span> (i = (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1); i &lt;= (int)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2); i++)</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">for</span> (j = (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1); j &lt;= (int)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2); j++)</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            <span class="keywordflow">for</span> (k = (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner1); k &lt;= (int)<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner2); k++)</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            {</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(gr, i, j, k);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                grid.<a class="code" href="classSimpleGrid.html#a1de43d3a6ae7166e119e56ff58a6c452">grid2universe</a>(gr, ur);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                sum += <a class="code" href="group__Splines.html#ga41a63def75258d0e8dd479c5348dfef1">spatial_Bspline03</a>(ur);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            }</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">return</span> sum;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;}</div><div class="ttc" id="classSimpleGrid_html_aa9b2618b77cd696ee03117baab9a0162"><div class="ttname"><a href="classSimpleGrid.html#aa9b2618b77cd696ee03117baab9a0162">SimpleGrid::universe2grid</a></div><div class="ttdeci">void universe2grid(const Matrix1D&lt; double &gt; &amp;uv, Matrix1D&lt; double &gt; &amp;gv) const </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00357">grids.h:357</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8caf6673fdc30d0b6f4a529cb1f4e3ab"><div class="ttname"><a href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a></div><div class="ttdeci">Matrix1D&lt; double &gt; vectorR3(double x, double y, double z)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8cpp_source.html#l00036">matrix1d.cpp:36</a></div></div>
<div class="ttc" id="classSimpleGrid_html_a1de43d3a6ae7166e119e56ff58a6c452"><div class="ttname"><a href="classSimpleGrid.html#a1de43d3a6ae7166e119e56ff58a6c452">SimpleGrid::grid2universe</a></div><div class="ttdeci">void grid2universe(const Matrix1D&lt; double &gt; &amp;gv, Matrix1D&lt; double &gt; &amp;uv) const </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00326">grids.h:326</a></div></div>
<div class="ttc" id="group__Splines_html_ga41a63def75258d0e8dd479c5348dfef1"><div class="ttname"><a href="group__Splines.html#ga41a63def75258d0e8dd479c5348dfef1">spatial_Bspline03</a></div><div class="ttdeci">double spatial_Bspline03(const Matrix1D&lt; double &gt; &amp;r)</div><div class="ttdef"><b>Definition:</b> <a href="splines_8h_source.html#l00044">splines.h:44</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_ga6c6b4d4f88daca5e1d8e171bec3b4af0"><div class="ttname"><a href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a></div><div class="ttdeci">#define VECTOR_R3(v, x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00127">matrix1d.h:127</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
