<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Xmipp: project_xr (project for tilt series)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">project_xr (project for tilt series)</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structXrayThreadArgument.html">XrayThreadArgument</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data struct to be passed to threads.  <a href="structXrayThreadArgument.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXrayProjPhantom.html">XrayProjPhantom</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgXrayProject.html">ProgXrayProject</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCIGTArgument.html">CIGTArgument</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structPXSGTArgument.html">PXSGTArgument</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga71e111e722d03207ce9d763ab498995b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ProjectionXRProgram.html#ga71e111e722d03207ce9d763ab498995b">XrayRotateAndProjectVolumeOffCentered</a> (<a class="el" href="classXrayProjPhantom.html">XrayProjPhantom</a> &amp;side, <a class="el" href="classXRayPSF.html">XRayPSF</a> &amp;<a class="el" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>, <a class="el" href="classProjection.html">Projection</a> &amp;P, <a class="el" href="classProjection.html">Projection</a> &amp;standardP, int Ydim, int Xdim)</td></tr>
<tr class="separator:ga71e111e722d03207ce9d763ab498995b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafe1526d8c158a0c0b6c423541d13070a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ProjectionXRProgram.html#gafe1526d8c158a0c0b6c423541d13070a">projectXrayVolume</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;muVol, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;IgeoVol, <a class="el" href="classXRayPSF.html">XRayPSF</a> &amp;<a class="el" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>, <a class="el" href="classProjection.html">Projection</a> &amp;P, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *projNorm=NULL, <a class="el" href="classThreadManager.html">ThreadManager</a> *ThrMgr=NULL)</td></tr>
<tr class="separator:gafe1526d8c158a0c0b6c423541d13070a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae32293f062509911d4c48243872e8562"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ProjectionXRProgram.html#gae32293f062509911d4c48243872e8562">threadXrayProject</a> (<a class="el" href="classThreadArgument.html">ThreadArgument</a> &amp;thArg)</td></tr>
<tr class="memdesc:gae32293f062509911d4c48243872e8562"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classThread.html">Thread</a> Job to generate an X-ray microscope projection.  <a href="#gae32293f062509911d4c48243872e8562">More...</a><br /></td></tr>
<tr class="separator:gae32293f062509911d4c48243872e8562"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaf5ec249c52c38b846dca9c3d7c17759"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ProjectionXRProgram.html#gaaf5ec249c52c38b846dca9c3d7c17759">calculateIgeo</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;muVol, double <a class="el" href="spherical__harmonics_8h.html#a155dcdb9d4ce202cc937816a560c27ec">sampling</a>, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;IgeoVol, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;cumMu, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;IgeoZb, int nThreads=1, <a class="el" href="classThreadManager.html">ThreadManager</a> *ThrMgr=NULL)</td></tr>
<tr class="memdesc:gaaf5ec249c52c38b846dca9c3d7c17759"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the volume of the information of Igeometric at each plane of the phantom.  <a href="#gaaf5ec249c52c38b846dca9c3d7c17759">More...</a><br /></td></tr>
<tr class="separator:gaaf5ec249c52c38b846dca9c3d7c17759"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga438607b2a56c6739adb13c5744c0f59b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ProjectionXRProgram.html#ga438607b2a56c6739adb13c5744c0f59b">calculateIgeoThread</a> (<a class="el" href="classThreadArgument.html">ThreadArgument</a> &amp;thArg)</td></tr>
<tr class="separator:ga438607b2a56c6739adb13c5744c0f59b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga871e7ea72e2735a69565c7d312c580a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ProjectionXRProgram.html#ga871e7ea72e2735a69565c7d312c580a0">projectXrayGridVolume</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;muVol, <a class="el" href="classXRayPSF.html">XRayPSF</a> &amp;<a class="el" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;IgeoVol, <a class="el" href="classProjection.html">Projection</a> &amp;proj, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *projNorm, int FORW, <a class="el" href="classThreadManager.html">ThreadManager</a> *<a class="el" href="group__ProjectionXRProgram.html#gab6ca869b2467a1904a98f322868c6ba4">thMgr</a>)</td></tr>
<tr class="memdesc:ga871e7ea72e2735a69565c7d312c580a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Project as in an X-ray microscope using a grids and blobs.  <a href="#ga871e7ea72e2735a69565c7d312c580a0">More...</a><br /></td></tr>
<tr class="separator:ga871e7ea72e2735a69565c7d312c580a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadb3a0dcadf3f7c2ba15457421133d454"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ProjectionXRProgram.html#gadb3a0dcadf3f7c2ba15457421133d454">projectXraySimpleGrid</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *vol, const <a class="el" href="classXRayPSF.html">XRayPSF</a> &amp;<a class="el" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *IgeoVol, <a class="el" href="classProjection.html">Projection</a> *proj, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;projNorm, int FORW, int threadId=-1, int nThreads=1)</td></tr>
<tr class="separator:gadb3a0dcadf3f7c2ba15457421133d454"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac73a469f0c20412c5b0f9e0986db1c75"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ProjectionXRProgram.html#gac73a469f0c20412c5b0f9e0986db1c75">projectXraySimpleGridThread</a> (<a class="el" href="classThreadArgument.html">ThreadArgument</a> &amp;thArg)</td></tr>
<tr class="separator:gac73a469f0c20412c5b0f9e0986db1c75"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:gae8b85b4f519a4945ba9ea43e9b503531"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMutex.html">Mutex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ProjectionXRProgram.html#gae8b85b4f519a4945ba9ea43e9b503531">mutex</a></td></tr>
<tr class="separator:gae8b85b4f519a4945ba9ea43e9b503531"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa7d3601dfe4f1448143811e57bd9ca46"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classBarrier.html">Barrier</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ProjectionXRProgram.html#gaa7d3601dfe4f1448143811e57bd9ca46">barrier</a></td></tr>
<tr class="separator:gaa7d3601dfe4f1448143811e57bd9ca46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab6ca869b2467a1904a98f322868c6ba4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classThreadManager.html">ThreadManager</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ProjectionXRProgram.html#gab6ca869b2467a1904a98f322868c6ba4">thMgr</a></td></tr>
<tr class="separator:gab6ca869b2467a1904a98f322868c6ba4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gaaf5ec249c52c38b846dca9c3d7c17759"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calculateIgeo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>muVol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sampling</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>IgeoVol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>cumMu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>IgeoZb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nThreads</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadManager.html">ThreadManager</a> *&#160;</td>
          <td class="paramname"><em>ThrMgr</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the volume of the information of Igeometric at each plane of the phantom. </p>

<p>Definition at line <a class="el" href="project__xray_8cpp_source.html#l00621">621</a> of file <a class="el" href="project__xray_8cpp_source.html">project_xray.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;{</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="comment">// Checking sizes</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">if</span> ( (<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(muVol) != <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(IgeoZb)) || (<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(muVol) != <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(IgeoZb)) )</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aaba89018a8188da52ee900de49a93ed78">ERR_MULTIDIM_SIZE</a>, <span class="stringliteral">&quot;CalculateIgeo: IgeoZb size does not match muVol size.&quot;</span>);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    IgeoVol.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(muVol);</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    cumMu.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(muVol), <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(muVol));</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <a class="code" href="classThreadManager.html">ThreadManager</a> * myThMgr;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">if</span> (ThrMgr == NULL)</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        myThMgr = <span class="keyword">new</span> <a class="code" href="classThreadManager.html">ThreadManager</a>(nThreads);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        myThMgr = ThrMgr;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <a class="code" href="structCIGTArgument.html">CIGTArgument</a> iGeoArgs;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    iGeoArgs.<a class="code" href="structCIGTArgument.html#aa5987836f4d7315e36ffd97d1738534f">samplingZ</a> = <a class="code" href="spherical__harmonics_8h.html#a155dcdb9d4ce202cc937816a560c27ec">sampling</a>;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    iGeoArgs.<a class="code" href="structCIGTArgument.html#af3d5bdfbb2df67c9199670ab15807ed9">muVol</a> = &amp;muVol;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    iGeoArgs.<a class="code" href="structCIGTArgument.html#a3feff83531215aa3e21034d9768e32df">IgeoVol</a> = &amp;IgeoVol;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    iGeoArgs.<a class="code" href="structCIGTArgument.html#af6350c19badf742d5ea3750055ab6f43">cumMu</a> = &amp;cumMu;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    iGeoArgs.<a class="code" href="structCIGTArgument.html#a23777e016581f3dcfdfb80aa32db5434">IgeoZb</a> = &amp; IgeoZb;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    iGeoArgs.<a class="code" href="structCIGTArgument.html#acbae448b417207306643be0536a6f824">td</a> = <span class="keyword">new</span> <a class="code" href="classThreadTaskDistributor.html">ThreadTaskDistributor</a>(<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(muVol),<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(muVol)/nThreads/2);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    myThMgr-&gt;<a class="code" href="classThreadManager.html#afd48602d0778461e6bb6d4de4a98b3e9">run</a>(<a class="code" href="group__ProjectionXRProgram.html#ga438607b2a56c6739adb13c5744c0f59b">calculateIgeoThread</a>,&amp;iGeoArgs);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keyword">delete</span> iGeoArgs.<a class="code" href="structCIGTArgument.html#acbae448b417207306643be0536a6f824">td</a>;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordflow">if</span> (ThrMgr == NULL)</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <span class="keyword">delete</span> myThMgr;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;}</div><div class="ttc" id="classThreadManager_html_afd48602d0778461e6bb6d4de4a98b3e9"><div class="ttname"><a href="classThreadManager.html#afd48602d0778461e6bb6d4de4a98b3e9">ThreadManager::run</a></div><div class="ttdeci">void run(ThreadFunction function, void *data=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8cpp_source.html#l00264">xmipp_threads.cpp:264</a></div></div>
<div class="ttc" id="structCIGTArgument_html_aa5987836f4d7315e36ffd97d1738534f"><div class="ttname"><a href="structCIGTArgument.html#aa5987836f4d7315e36ffd97d1738534f">CIGTArgument::samplingZ</a></div><div class="ttdeci">double samplingZ</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00155">project_xray.h:155</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="classThreadManager_html"><div class="ttname"><a href="classThreadManager.html">ThreadManager</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8h_source.html#l00239">xmipp_threads.h:239</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aaba89018a8188da52ee900de49a93ed78"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aaba89018a8188da52ee900de49a93ed78">ERR_MULTIDIM_SIZE</a></div><div class="ttdoc">Incorrect MultidimArray size. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00179">xmipp_error.h:179</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="classThreadTaskDistributor_html"><div class="ttname"><a href="classThreadTaskDistributor.html">ThreadTaskDistributor</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8h_source.html#l00451">xmipp_threads.h:451</a></div></div>
<div class="ttc" id="structCIGTArgument_html_acbae448b417207306643be0536a6f824"><div class="ttname"><a href="structCIGTArgument.html#acbae448b417207306643be0536a6f824">CIGTArgument::td</a></div><div class="ttdeci">ParallelTaskDistributor * td</div><div class="ttdoc">Intensity in the beginning of the volume to project. </div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00160">project_xray.h:160</a></div></div>
<div class="ttc" id="spherical__harmonics_8h_html_a155dcdb9d4ce202cc937816a560c27ec"><div class="ttname"><a href="spherical__harmonics_8h.html#a155dcdb9d4ce202cc937816a560c27ec">sampling</a></div><div class="ttdeci">#define sampling</div><div class="ttdef"><b>Definition:</b> <a href="spherical__harmonics_8h_source.html#l00036">spherical_harmonics.h:36</a></div></div>
<div class="ttc" id="structCIGTArgument_html_af3d5bdfbb2df67c9199670ab15807ed9"><div class="ttname"><a href="structCIGTArgument.html#af3d5bdfbb2df67c9199670ab15807ed9">CIGTArgument::muVol</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * muVol</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00156">project_xray.h:156</a></div></div>
<div class="ttc" id="group__ProjectionXRProgram_html_ga438607b2a56c6739adb13c5744c0f59b"><div class="ttname"><a href="group__ProjectionXRProgram.html#ga438607b2a56c6739adb13c5744c0f59b">calculateIgeoThread</a></div><div class="ttdeci">void calculateIgeoThread(ThreadArgument &amp;thArg)</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8cpp_source.html#l00655">project_xray.cpp:655</a></div></div>
<div class="ttc" id="structCIGTArgument_html"><div class="ttname"><a href="structCIGTArgument.html">CIGTArgument</a></div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00153">project_xray.h:153</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="structCIGTArgument_html_a3feff83531215aa3e21034d9768e32df"><div class="ttname"><a href="structCIGTArgument.html#a3feff83531215aa3e21034d9768e32df">CIGTArgument::IgeoVol</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * IgeoVol</div><div class="ttdoc">Accumulated Mu == Standard EM projection used as reference for reconstruction. </div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00158">project_xray.h:158</a></div></div>
<div class="ttc" id="structCIGTArgument_html_a23777e016581f3dcfdfb80aa32db5434"><div class="ttname"><a href="structCIGTArgument.html#a23777e016581f3dcfdfb80aa32db5434">CIGTArgument::IgeoZb</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * IgeoZb</div><div class="ttdoc">Igeo accumulated along Z axis. </div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00159">project_xray.h:159</a></div></div>
<div class="ttc" id="structCIGTArgument_html_af6350c19badf742d5ea3750055ab6f43"><div class="ttname"><a href="structCIGTArgument.html#af6350c19badf742d5ea3750055ab6f43">CIGTArgument::cumMu</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * cumMu</div><div class="ttdoc">Phantom volume. </div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00157">project_xray.h:157</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga438607b2a56c6739adb13c5744c0f59b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calculateIgeoThread </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classThreadArgument.html">ThreadArgument</a> &amp;&#160;</td>
          <td class="paramname"><em>thArg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="project__xray_8cpp_source.html#l00655">655</a> of file <a class="el" href="project__xray_8cpp_source.html">project_xray.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;{</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <a class="code" href="structCIGTArgument.html">CIGTArgument</a> *dataThread = (<a class="code" href="structCIGTArgument.html">CIGTArgument</a>*) thArg.<a class="code" href="classThreadArgument.html#ab7b5ccbf2bd8f5229d65a11829eb5eda">data</a>;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="spherical__harmonics_8h.html#a155dcdb9d4ce202cc937816a560c27ec">sampling</a> = dataThread-&gt;<a class="code" href="structCIGTArgument.html#aa5987836f4d7315e36ffd97d1738534f">samplingZ</a>;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;muVol = *(dataThread-&gt;<a class="code" href="structCIGTArgument.html#af3d5bdfbb2df67c9199670ab15807ed9">muVol</a>);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;IgeoVol = *(dataThread-&gt;<a class="code" href="structCIGTArgument.html#a3feff83531215aa3e21034d9768e32df">IgeoVol</a>);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;cumMu = *(dataThread-&gt;<a class="code" href="structCIGTArgument.html#af6350c19badf742d5ea3750055ab6f43">cumMu</a>);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;IgeoZb = *(dataThread-&gt;<a class="code" href="structCIGTArgument.html#a23777e016581f3dcfdfb80aa32db5434">IgeoZb</a>);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="classParallelTaskDistributor.html">ParallelTaskDistributor</a> * td = dataThread-&gt;<a class="code" href="structCIGTArgument.html#acbae448b417207306643be0536a6f824">td</a>;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="comment">// Resizing</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="comment">//    IgeoVol.resize(muVol, false);</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#acaec38248b66cfba849985072bd311f6">first</a>, last;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordflow">while</span> (td-&gt;<a class="code" href="classParallelTaskDistributor.html#a28f70bcc333b8b06d7571db06c67bdc3">getTasks</a>(first, last))</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    {</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="comment">//        first--;</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <span class="comment">//        last--;</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = first; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= last; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        {</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            <span class="comment">//            for (int j=0; j&lt;XSIZE(muVol); ++j)</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            <span class="comment">//                dAkij(IgeoVol,0,i,j) = dAij(IgeoZb,i,j)*exp(-dAkij(muVol,0,i,j)*sampling);</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            <span class="comment">//            for (int k = 1; k &lt; ZSIZE(muVol); ++k)</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            <span class="comment">//                for (int j=0; j&lt;XSIZE(muVol); ++j)</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            <span class="comment">//                    dAkij(IgeoVol,k,i,j) = dAkij(IgeoVol,k-1,i,j)*exp(-dAkij(muVol,k,i,j)*sampling);</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> = 0; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(muVol); ++<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>)</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(muVol); ++<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                {</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(cumMu,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) += <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(muVol,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)*<a class="code" href="spherical__harmonics_8h.html#a155dcdb9d4ce202cc937816a560c27ec">sampling</a>;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(IgeoVol,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(IgeoZb,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)*exp(-<a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(cumMu,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                }</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        }</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    }</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;}</div><div class="ttc" id="structCIGTArgument_html_aa5987836f4d7315e36ffd97d1738534f"><div class="ttname"><a href="structCIGTArgument.html#aa5987836f4d7315e36ffd97d1738534f">CIGTArgument::samplingZ</a></div><div class="ttdeci">double samplingZ</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00155">project_xray.h:155</a></div></div>
<div class="ttc" id="classParallelTaskDistributor_html"><div class="ttname"><a href="classParallelTaskDistributor.html">ParallelTaskDistributor</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8h_source.html#l00366">xmipp_threads.h:366</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classParallelTaskDistributor_html_a28f70bcc333b8b06d7571db06c67bdc3"><div class="ttname"><a href="classParallelTaskDistributor.html#a28f70bcc333b8b06d7571db06c67bdc3">ParallelTaskDistributor::getTasks</a></div><div class="ttdeci">bool getTasks(size_t &amp;first, size_t &amp;last)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8cpp_source.html#l00318">xmipp_threads.cpp:318</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gafd91bd40ff4b515cade0323c37f21ac5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a></div><div class="ttdeci">#define dAkij(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00254">multidim_array.h:254</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classThreadArgument_html_ab7b5ccbf2bd8f5229d65a11829eb5eda"><div class="ttname"><a href="classThreadArgument.html#ab7b5ccbf2bd8f5229d65a11829eb5eda">ThreadArgument::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8h_source.html#l00345">xmipp_threads.h:345</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_acaec38248b66cfba849985072bd311f6"><div class="ttname"><a href="numerical__recipes_8cpp.html#acaec38248b66cfba849985072bd311f6">first</a></div><div class="ttdeci">glob_log first</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05218">numerical_recipes.cpp:5218</a></div></div>
<div class="ttc" id="structCIGTArgument_html_acbae448b417207306643be0536a6f824"><div class="ttname"><a href="structCIGTArgument.html#acbae448b417207306643be0536a6f824">CIGTArgument::td</a></div><div class="ttdeci">ParallelTaskDistributor * td</div><div class="ttdoc">Intensity in the beginning of the volume to project. </div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00160">project_xray.h:160</a></div></div>
<div class="ttc" id="spherical__harmonics_8h_html_a155dcdb9d4ce202cc937816a560c27ec"><div class="ttname"><a href="spherical__harmonics_8h.html#a155dcdb9d4ce202cc937816a560c27ec">sampling</a></div><div class="ttdeci">#define sampling</div><div class="ttdef"><b>Definition:</b> <a href="spherical__harmonics_8h_source.html#l00036">spherical_harmonics.h:36</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gafa02b309a507bf04daf9f31fa828ce4f"><div class="ttname"><a href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a></div><div class="ttdeci">#define dAij(M, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00355">multidim_array.h:355</a></div></div>
<div class="ttc" id="structCIGTArgument_html_af3d5bdfbb2df67c9199670ab15807ed9"><div class="ttname"><a href="structCIGTArgument.html#af3d5bdfbb2df67c9199670ab15807ed9">CIGTArgument::muVol</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * muVol</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00156">project_xray.h:156</a></div></div>
<div class="ttc" id="structCIGTArgument_html"><div class="ttname"><a href="structCIGTArgument.html">CIGTArgument</a></div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00153">project_xray.h:153</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="structCIGTArgument_html_a3feff83531215aa3e21034d9768e32df"><div class="ttname"><a href="structCIGTArgument.html#a3feff83531215aa3e21034d9768e32df">CIGTArgument::IgeoVol</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * IgeoVol</div><div class="ttdoc">Accumulated Mu == Standard EM projection used as reference for reconstruction. </div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00158">project_xray.h:158</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="structCIGTArgument_html_a23777e016581f3dcfdfb80aa32db5434"><div class="ttname"><a href="structCIGTArgument.html#a23777e016581f3dcfdfb80aa32db5434">CIGTArgument::IgeoZb</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * IgeoZb</div><div class="ttdoc">Igeo accumulated along Z axis. </div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00159">project_xray.h:159</a></div></div>
<div class="ttc" id="structCIGTArgument_html_af6350c19badf742d5ea3750055ab6f43"><div class="ttname"><a href="structCIGTArgument.html#af6350c19badf742d5ea3750055ab6f43">CIGTArgument::cumMu</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * cumMu</div><div class="ttdoc">Phantom volume. </div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00157">project_xray.h:157</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga871e7ea72e2735a69565c7d312c580a0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void projectXrayGridVolume </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>muVol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classXRayPSF.html">XRayPSF</a> &amp;&#160;</td>
          <td class="paramname"><em>psf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>IgeoVol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>proj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>projNorm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>FORW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadManager.html">ThreadManager</a> *&#160;</td>
          <td class="paramname"><em>thMgr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Project as in an X-ray microscope using a grids and blobs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">proj</td><td>Vol with the Igeometrical distribution along specimen volume </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="project__xray_8cpp_source.html#l00693">693</a> of file <a class="el" href="project__xray_8cpp_source.html">project_xray.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;{</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <a class="code" href="structXrayThreadArgument.html">XrayThreadArgument</a> projThrData;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <a class="code" href="classBarrier.html">Barrier</a> <a class="code" href="group__ProjectionXRProgram.html#gaa7d3601dfe4f1448143811e57bd9ca46">barrier</a>(thMgr-&gt;<a class="code" href="classThreadManager.html#a6525c2e9fcc12a9668c7145aaf92df4c">threads</a>);</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    projThrData.<a class="code" href="structXrayThreadArgument.html#a24b6e5181ed562fd3cf8cc7d37eab34a">psf</a> = &amp;<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    projThrData.<a class="code" href="structXrayThreadArgument.html#a96abf18442c57a655f44d2aa022e9371">muVol</a> = &amp;muVol;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    projThrData.<a class="code" href="structXrayThreadArgument.html#aa17021827b3fad4794879fc8a49dbdf2">IgeoVol</a> = &amp;IgeoVol;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    projThrData.<a class="code" href="structXrayThreadArgument.html#af16b9ed8413dc9279d416ca3bed369ee">projOut</a> = &amp;proj;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    projThrData.<a class="code" href="structXrayThreadArgument.html#a9f54451f1207dd7ef9e286e143bacc54">projNorm</a> = projNorm;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    projThrData.<a class="code" href="structXrayThreadArgument.html#aff083c032a06ec0f4ce8f6bc1e707048">forw</a> = FORW;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    projThrData.<a class="code" href="structXrayThreadArgument.html#a33c8e38b15a4baec5891929c696ff01b">phantomSlabIdx</a> = NULL;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    projThrData.<a class="code" href="structXrayThreadArgument.html#af7328ebcf8749a6c3f9df751f2baabbc">psfSlicesIdx</a> = NULL;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="comment">//    //Create the job handler to distribute thread jobs</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="comment">//    size_t blockSize, numberOfJobs = psfSlicesIdx.size() ;</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="comment">//    blockSize = 1;</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">//    ThreadTaskDistributor td(numberOfJobs, blockSize);</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="comment">//    projThrData.td = &amp;td;</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="comment">//    projThrData.barrier = &amp;barrier;</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="comment">//the really really final project routine, I swear by Snoopy.</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="comment">//    project_xr(psf,side.rotPhantomVol,P, idxSlice);</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    thMgr-&gt;<a class="code" href="classThreadManager.html#afd48602d0778461e6bb6d4de4a98b3e9">run</a>(<a class="code" href="group__ProjectionXRProgram.html#gac73a469f0c20412c5b0f9e0986db1c75">projectXraySimpleGridThread</a>,(<span class="keywordtype">void</span>*) &amp;projThrData);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;}</div><div class="ttc" id="classThreadManager_html_afd48602d0778461e6bb6d4de4a98b3e9"><div class="ttname"><a href="classThreadManager.html#afd48602d0778461e6bb6d4de4a98b3e9">ThreadManager::run</a></div><div class="ttdeci">void run(ThreadFunction function, void *data=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8cpp_source.html#l00264">xmipp_threads.cpp:264</a></div></div>
<div class="ttc" id="group__ProjectionXRProgram_html_gac73a469f0c20412c5b0f9e0986db1c75"><div class="ttname"><a href="group__ProjectionXRProgram.html#gac73a469f0c20412c5b0f9e0986db1c75">projectXraySimpleGridThread</a></div><div class="ttdeci">void projectXraySimpleGridThread(ThreadArgument &amp;thArg)</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8cpp_source.html#l00731">project_xray.cpp:731</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html"><div class="ttname"><a href="structXrayThreadArgument.html">XrayThreadArgument</a></div><div class="ttdoc">Data struct to be passed to threads. </div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00038">project_xray.h:38</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_aa17021827b3fad4794879fc8a49dbdf2"><div class="ttname"><a href="structXrayThreadArgument.html#aa17021827b3fad4794879fc8a49dbdf2">XrayThreadArgument::IgeoVol</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * IgeoVol</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00042">project_xray.h:42</a></div></div>
<div class="ttc" id="classThreadManager_html_a6525c2e9fcc12a9668c7145aaf92df4c"><div class="ttname"><a href="classThreadManager.html#a6525c2e9fcc12a9668c7145aaf92df4c">ThreadManager::threads</a></div><div class="ttdeci">int threads</div><div class="ttdoc">number of working threads. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8h_source.html#l00242">xmipp_threads.h:242</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_a9f54451f1207dd7ef9e286e143bacc54"><div class="ttname"><a href="structXrayThreadArgument.html#a9f54451f1207dd7ef9e286e143bacc54">XrayThreadArgument::projNorm</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * projNorm</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00045">project_xray.h:45</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_a33c8e38b15a4baec5891929c696ff01b"><div class="ttname"><a href="structXrayThreadArgument.html#a33c8e38b15a4baec5891929c696ff01b">XrayThreadArgument::phantomSlabIdx</a></div><div class="ttdeci">std::vector&lt; int &gt; * phantomSlabIdx</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00047">project_xray.h:47</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_af7328ebcf8749a6c3f9df751f2baabbc"><div class="ttname"><a href="structXrayThreadArgument.html#af7328ebcf8749a6c3f9df751f2baabbc">XrayThreadArgument::psfSlicesIdx</a></div><div class="ttdeci">std::vector&lt; int &gt; * psfSlicesIdx</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00048">project_xray.h:48</a></div></div>
<div class="ttc" id="group__ProjectionXRProgram_html_gaa7d3601dfe4f1448143811e57bd9ca46"><div class="ttname"><a href="group__ProjectionXRProgram.html#gaa7d3601dfe4f1448143811e57bd9ca46">barrier</a></div><div class="ttdeci">Barrier * barrier</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8cpp_source.html#l00082">project_xray.cpp:82</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab6da0ee1799087de018b8d62b8cc210e"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a></div><div class="ttdeci">double psf</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05183">numerical_recipes.cpp:5183</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_a24b6e5181ed562fd3cf8cc7d37eab34a"><div class="ttname"><a href="structXrayThreadArgument.html#a24b6e5181ed562fd3cf8cc7d37eab34a">XrayThreadArgument::psf</a></div><div class="ttdeci">XRayPSF * psf</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00040">project_xray.h:40</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_af16b9ed8413dc9279d416ca3bed369ee"><div class="ttname"><a href="structXrayThreadArgument.html#af16b9ed8413dc9279d416ca3bed369ee">XrayThreadArgument::projOut</a></div><div class="ttdeci">Projection * projOut</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00044">project_xray.h:44</a></div></div>
<div class="ttc" id="classBarrier_html"><div class="ttname"><a href="classBarrier.html">Barrier</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8h_source.html#l00150">xmipp_threads.h:150</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_aff083c032a06ec0f4ce8f6bc1e707048"><div class="ttname"><a href="structXrayThreadArgument.html#aff083c032a06ec0f4ce8f6bc1e707048">XrayThreadArgument::forw</a></div><div class="ttdeci">int forw</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00046">project_xray.h:46</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_a96abf18442c57a655f44d2aa022e9371"><div class="ttname"><a href="structXrayThreadArgument.html#a96abf18442c57a655f44d2aa022e9371">XrayThreadArgument::muVol</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * muVol</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00041">project_xray.h:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gadb3a0dcadf3f7c2ba15457421133d454"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void projectXraySimpleGrid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classXRayPSF.html">XRayPSF</a> &amp;&#160;</td>
          <td class="paramname"><em>psf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>IgeoVol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> *&#160;</td>
          <td class="paramname"><em>proj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>projNorm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>FORW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>threadId</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nThreads</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ARTK Equation mode </p>

<p>Definition at line <a class="el" href="project__xray_8cpp_source.html#l00752">752</a> of file <a class="el" href="project__xray_8cpp_source.html">project_xray.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;{</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> psfVol;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    psfVol.<a class="code" href="classMultidimArray.html#acaa2c55622a40cc09eb50577cb3aed39">alias</a>(psf.<a class="code" href="classXRayPSF.html#ae6f197304ed98f16410bbd3fc5b30ddf">psfVol</a>());</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#a67ed20364685ceb31947435119f4f9d9">zero</a>(3);                <span class="comment">// Origin (0,0,0)</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> prjPix(3);       <span class="comment">// Position of the pixel within the projection</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> prjX(3);         <span class="comment">// Coordinate: Projection of the</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> prjY(3);         <span class="comment">// 3 grid vectors</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> prjZ(3);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> prjOrigin(3);    <span class="comment">// Coordinate: Where in the 2D</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="comment">// projection plane the origin of</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="comment">// the grid projects</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> prjDir(3);       <span class="comment">// Projection direction</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> actprj(3);       <span class="comment">// Coord: Actual position inside</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="comment">// the projection plane</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> beginZ(3);       <span class="comment">// Coord: Plane coordinates of the</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="comment">// projection of the 3D point</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="comment">// (z0,YY(lowest),XX(lowest))</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> univ_beginY(3);  <span class="comment">// Coord: coordinates of the</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="comment">// grid point</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="comment">// (z0,y0,XX(lowest))</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> univ_beginZ(3);  <span class="comment">// Coord: coordinates of the</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="comment">// grid point</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="comment">// (z0,YY(lowest),XX(lowest))</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> beginY(3);       <span class="comment">// Coord: Plane coordinates of the</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="comment">// projection of the 3D point</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="comment">// (z0,y0,XX(lowest))</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keywordtype">double</span> XX_footprint_size;                <span class="comment">// The footprint is supposed</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="keywordtype">double</span> YY_footprint_size;                <span class="comment">// to be defined between</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="comment">// (-vmax,+vmax) in the Y axis,</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="comment">// and (-umax,+umax) in the X axis</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="comment">// This footprint size is the</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="comment">// R2 vector (umax,vmax).</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordtype">int</span> XX_corner2, XX_corner1;              <span class="comment">// Coord: Corners of the</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keywordtype">int</span> YY_corner2, YY_corner1;              <span class="comment">// footprint when it is projected</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="comment">// onto the projection plane</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="comment">// directions respectively</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="comment">// inside the blobprint</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordtype">double</span>        vol_corr=0.;               <span class="comment">// Correction for a volume element</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordtype">int</span>           N_eq;                      <span class="comment">// Number of equations in which</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="comment">// a blob is involved</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keywordtype">int</span>           <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>;                   <span class="comment">// volume element indexes</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="comment">// Project grid axis ....................................................</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="comment">// These vectors ((1,0,0),(0,1,0),...) are referred to the grid</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="comment">// coord. system and the result is a 2D vector in the image plane</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="comment">// The unit size within the image plane is 1, ie, the same as for</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="comment">// the universal grid.</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="comment">// actprj is reused with a different purpose</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="comment">//    VECTOR_R3(actprj, 1, 0, 0);</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="comment">//    Uproject_to_plane(actprj, proj-&gt;euler, prjX);</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="comment">//    VECTOR_R3(actprj, 0, 1, 0);</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="comment">//    Uproject_to_plane(actprj, proj-&gt;euler, prjY);</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="comment">//    VECTOR_R3(actprj, 0, 0, 1);</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="comment">//    Uproject_to_plane(actprj, proj-&gt;euler, prjZ);</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    proj-&gt;<a class="code" href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">euler</a>.<a class="code" href="classMatrix2D.html#ae95a10993555284a429c727a79207185">getCol</a>(0, prjX);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    proj-&gt;<a class="code" href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">euler</a>.<a class="code" href="classMatrix2D.html#ae95a10993555284a429c727a79207185">getCol</a>(1, prjY);</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    proj-&gt;<a class="code" href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">euler</a>.<a class="code" href="classMatrix2D.html#ae95a10993555284a429c727a79207185">getCol</a>(2, prjZ);</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="comment">// This time the origin of the grid is in the universal coord system</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="comment">//    Uproject_to_plane(grid-&gt;origin, proj-&gt;euler, prjOrigin);</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    prjOrigin.initZeros();</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="comment">// Get the projection direction .........................................</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    proj-&gt;<a class="code" href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">euler</a>.<a class="code" href="classMatrix2D.html#af11b96d9f1adce57692855f081f14760">getRow</a>(2, prjDir);</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="comment">// Footprint size .......................................................</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="comment">// The following vectors are integer valued vectors, but they are</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="comment">// stored as real ones to make easier operations with other vectors</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    XX_footprint_size = <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(psfVol) + <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    YY_footprint_size = <a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(psfVol) + <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="comment">// Project the whole grid ...............................................</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="comment">// Corner of the plane defined by Z. These coordinates try to be within</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="comment">// the valid indexes of the projection (defined between STARTING and</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="comment">// FINISHING values, but it could be that they may lie outside.</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="comment">// These coordinates need not to be integer, in general, they are</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="comment">// real vectors.</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="comment">// The vectors returned by the projection routines are R3 but we</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="comment">// are only interested in their first 2 components, ie, in the</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="comment">// in-plane components</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="comment">// This type conversion gives more speed</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordtype">int</span> ZZ_lowest = <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(*vol);</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordflow">if</span>( threadId != -1 )</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        ZZ_lowest += threadId;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordtype">int</span> YY_lowest = <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(*vol);</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordtype">int</span> XX_lowest = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(*vol);</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keywordtype">int</span> ZZ_highest = <a class="code" href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(*vol);</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordtype">int</span> YY_highest = <a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(*vol);</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordtype">int</span> XX_highest = <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(*vol);</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    beginZ = (double)XX_lowest * prjX + (<span class="keywordtype">double</span>)YY_lowest * prjY + (double)ZZ_lowest * prjZ + prjOrigin;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordtype">int</span> condition;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    condition = threadId==1;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordflow">if</span> (condition || numthreads==1)</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    {</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Equation mode &quot;</span> &lt;&lt; eq_mode &lt;&lt; std::endl;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Footprint size &quot;</span> &lt;&lt; YY_footprint_size &lt;&lt; <span class="stringliteral">&quot;x&quot;</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        &lt;&lt; XX_footprint_size &lt;&lt; std::endl;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;rot=&quot;</span> &lt;&lt; proj-&gt;<a class="code" href="classImageBase.html#a13fcf9a8cfa4f71952ec2fa8e65e1de3">rot</a>() &lt;&lt; <span class="stringliteral">&quot; tilt=&quot;</span> &lt;&lt; proj-&gt;<a class="code" href="classImageBase.html#a3782bd402af72b87daaf60b1ecedac5a">tilt</a>()</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; psi=&quot;</span> &lt;&lt; proj-&gt;<a class="code" href="classImageBase.html#a2a29e596597eb3fa6d1c185dfa14aa9e">psi</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Euler matrix &quot;</span> &lt;&lt; proj-&gt;<a class="code" href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">euler</a>;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Projection direction &quot;</span> &lt;&lt; prjDir &lt;&lt; std::endl;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        std::cout &lt;&lt; *grid;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;image limits (&quot;</span> &lt;&lt; <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a> &lt;&lt; <span class="stringliteral">&quot;) (&quot;</span> &lt;&lt; <a class="code" href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        &lt;&lt; <a class="code" href="blobs_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a> &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;prjX           &quot;</span> &lt;&lt; prjX.transpose()      &lt;&lt; std::endl;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;prjY           &quot;</span> &lt;&lt; prjY.transpose()      &lt;&lt; std::endl;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;prjZ           &quot;</span> &lt;&lt; prjZ.transpose()      &lt;&lt; std::endl;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;prjOrigin      &quot;</span> &lt;&lt; prjOrigin.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;beginZ(coord)  &quot;</span> &lt;&lt; beginZ.transpose()    &lt;&lt; std::endl;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;lowest         &quot;</span> &lt;&lt; XX_lowest  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; YY_lowest</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; XX_lowest  &lt;&lt; std::endl;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;highest        &quot;</span> &lt;&lt; XX_highest &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; YY_highest</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; XX_highest &lt;&lt; std::endl;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Stats of input basis volume &quot;</span>;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        (*vol)().printStats();</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        std::cout.flush();</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    }</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="keywordflow">for</span> (k = ZZ_lowest; k &lt;= ZZ_highest; k += numthreads)</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    {</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="comment">// Corner of the row defined by Y</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        beginY = beginZ;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <span class="keywordflow">for</span> (i = YY_lowest; i &lt;= YY_highest; i++)</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        {</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            <span class="comment">// First point in the row</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            actprj = beginY;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <span class="keywordflow">for</span> (j = XX_lowest; j &lt;= XX_highest; j++)</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            {</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                <span class="comment">// Ray length interesting</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                <span class="keywordtype">bool</span> ray_length_interesting = <span class="keyword">true</span>;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                <span class="comment">//                // Points out of 3DPSF</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                <span class="comment">//                ray_length_interesting = (ABS(zCenterDist) &lt;= ZZ_footprint_size);</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                <span class="comment">//                // There is still missing the shift of the volume from focal plane</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                <span class="keywordflow">if</span> (ray_length_interesting)</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                {</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                    <span class="comment">// Be careful that you cannot skip any basis, although its</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                    <span class="comment">// value be 0, because it is useful for norm_proj</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                    condition = threadId == 1;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                    <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                    {</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                        printf(<span class="stringliteral">&quot;\nProjecting grid coord (%d,%d,%d) &quot;</span>, j, i, k);</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;Vol there = &quot;</span> &lt;&lt; <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*vol, k, i, j) &lt;&lt; std::endl;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                        printf(<span class="stringliteral">&quot; 3D universal position (%f,%f,%f) \n&quot;</span>,</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                               <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(univ_position), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(univ_position), <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(univ_position));</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot; Center of the basis proj (2D) &quot;</span> &lt;&lt; <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(actprj) &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(actprj) &lt;&lt; std::endl;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                        <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> aux;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                        <a class="code" href="group__Geometry.html#gade8f7976e3d84a594d4728bf8f4c029e">Uproject_to_plane</a>(univ_position, proj-&gt;<a class="code" href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">euler</a>, aux);</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot; Center of the basis proj (more accurate) &quot;</span> &lt;&lt; aux.<a class="code" href="classMatrix1D.html#a8849e36416cde2a57914953a815d4b43">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                    }</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                    <span class="comment">// Search for integer corners for this basis</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                    XX_corner1 = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(<a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(<a class="code" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(*proj)), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(actprj) - XX_footprint_size));</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                    YY_corner1 = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(<a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(<a class="code" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(*proj)), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(actprj) - YY_footprint_size));</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                    XX_corner2 = <a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>(<a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(<a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(<a class="code" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(*proj)), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(actprj) + XX_footprint_size));</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                    YY_corner2 = <a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>(<a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(<a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(<a class="code" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(*proj)), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(actprj) + YY_footprint_size));</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                    <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                    {</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;Clipped and rounded Corner 1 &quot;</span> &lt;&lt; XX_corner1</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; YY_corner1 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;Clipped and rounded Corner 2 &quot;</span> &lt;&lt; XX_corner2</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; YY_corner2 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                    }</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                    <span class="comment">// Check if the voxel falls outside the projection plane</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                    <span class="comment">// COSS: I have changed here</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                    <span class="keywordflow">if</span> (XX_corner1 &lt;= XX_corner2 &amp;&amp; YY_corner1 &lt;= YY_corner2</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                        &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#ga7df2cbd5d7ffe0e8d5d8b9fe8d878b4d">INSIDEZ</a>(*IgeoVol,<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(actprj)))</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                    {</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                        <span class="keywordtype">double</span> IgeoValue = <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*IgeoVol, (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(actprj), (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(actprj), (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(actprj));</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                        <span class="keywordflow">if</span> (!FORW)</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                            vol_corr = 0;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                        N_eq = 0;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> = YY_corner1; <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> &lt;= YY_corner2; <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>++)</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                        {</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> = XX_corner1; <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> &lt;= XX_corner2; <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>++)</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                            {</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                                <span class="comment">//                                if (!((mask != NULL) &amp;&amp; A2D_ELEM(*mask,y,x)&lt;0.5))</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                                {</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                                    <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                                    {</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                                        std::cout &lt;&lt; <span class="stringliteral">&quot;Position in projection (&quot;</span> &lt;&lt; <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                                        &lt;&lt; <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> &lt;&lt; <span class="stringliteral">&quot;) &quot;</span>;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                                        <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                                        <span class="keywordflow">if</span> (basis-&gt;type == <a class="code" href="classBasis.html#aa73185836d4dd144f8591d827d8f952ca5e21d65cbd3255eed09cafb1d2ad0143">Basis::blobs</a>)</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                                        {</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                                            std::cout &lt;&lt; <span class="stringliteral">&quot;in footprint (&quot;</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                                            &lt;&lt; foot_U &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; foot_V &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                                            <a class="code" href="xmipp__image__over_8h.html#aec248f641411eee7c13d5eaf800366e3">IMG2OVER</a>(basis-&gt;blobprint, foot_V, foot_U, y, x);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                                            std::cout &lt;&lt; <span class="stringliteral">&quot; (d= &quot;</span> &lt;&lt; <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(y*y + x*x) &lt;&lt; <span class="stringliteral">&quot;) &quot;</span>;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                                            fflush(stdout);</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                                        }</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                                    }</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                                    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, a2;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                                    a = <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(psfVol, (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(actprj), y, x) * IgeoValue;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                                    a2 = a * <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                                    <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                                        std::cout &lt;&lt; <span class="stringliteral">&quot;=&quot;</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot; , &quot;</span> &lt;&lt; a2;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                                    <span class="keywordflow">if</span> (FORW)</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                                    {</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                                        <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(*proj, y, x) += <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*vol, k, i, j) * <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                                        <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(projNorm , y, x) += a2;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                                        <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                                        {</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                                            std::cout &lt;&lt; <span class="stringliteral">&quot; proj= &quot;</span> &lt;&lt; <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(*proj, y, x)</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                                            &lt;&lt; <span class="stringliteral">&quot; norm_proj=&quot;</span> &lt;&lt; <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(projNorm , y, x) &lt;&lt; std::endl;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                                            std::cout.flush();</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                                        }</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                                    }</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                                    <span class="keywordflow">else</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                                    {</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                                        vol_corr += <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(projNorm , y, x) * <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                                        <span class="keywordflow">if</span> (a != 0)</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                                            N_eq++;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                                        <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                                        {</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                                            std::cout &lt;&lt; <span class="stringliteral">&quot; corr_img= &quot;</span> &lt;&lt; <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(projNorm , y, x)</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                                            &lt;&lt; <span class="stringliteral">&quot; correction=&quot;</span> &lt;&lt; vol_corr &lt;&lt; std::endl;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                                            std::cout.flush();</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                                        }</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                                    }</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                                }<span class="comment">// close possible mask constraint</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                            }</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                        } <span class="comment">// Project this basis</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                        <span class="keywordflow">if</span> (!FORW)</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                        {</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                            <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*vol, k, i, j) += vol_corr;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                            <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                            {</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                                printf(<span class="stringliteral">&quot;\nFinal value at (%d,%d,%d) &quot;</span>, j, i, k);</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                                std::cout &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*vol, k, i, j) &lt;&lt; std::endl;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                                std::cout.flush();</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                            }</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                        }</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                    } <span class="comment">// If not collapsed</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                    <span class="comment">//                    number_of_basis++;</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                } <span class="comment">// If interesting</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                <span class="comment">// Prepare for next iteration</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                <a class="code" href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a>(actprj, actprj, prjX);</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;            }</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;            <a class="code" href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a>(beginY, beginY, prjY);</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        }</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <a class="code" href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a>(beginZ, beginZ, prjZ * numthreads );</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    }</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;}</div><div class="ttc" id="classMatrix1D_html_a8849e36416cde2a57914953a815d4b43"><div class="ttname"><a href="classMatrix1D.html#a8849e36416cde2a57914953a815d4b43">Matrix1D::transpose</a></div><div class="ttdeci">Matrix1D&lt; T &gt; transpose() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01466">matrix1d.h:1466</a></div></div>
<div class="ttc" id="group__Macros_html_gae0a4180e923e3ffca3989e20e441aa3c"><div class="ttname"><a href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a></div><div class="ttdeci">#define XMIPP_MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00193">xmipp_macros.h:193</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00364">multidim_array.h:364</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classBasis_html_aa73185836d4dd144f8591d827d8f952ca5e21d65cbd3255eed09cafb1d2ad0143"><div class="ttname"><a href="classBasis.html#aa73185836d4dd144f8591d827d8f952ca5e21d65cbd3255eed09cafb1d2ad0143">Basis::blobs</a></div><div class="ttdef"><b>Definition:</b> <a href="basis_8h_source.html#l00049">basis.h:49</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad919bbce6f061400a0bc5231a9cd1621"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a></div><div class="ttdeci">static double * y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08506">numerical_recipes.cpp:8506</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga706d2ce724d393d4d759a46225bbc6c1"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a></div><div class="ttdeci">#define FINISHINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00081">multidim_array.h:81</a></div></div>
<div class="ttc" id="group__FourierProjection_html_gabef83744f4e0571354f31586fb41d357"><div class="ttname"><a href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">Projection::euler</a></div><div class="ttdeci">Matrix2D&lt; double &gt; euler</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00074">fourier_projection.h:74</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00065">multidim_array.h:65</a></div></div>
<div class="ttc" id="classXRayPSF_html_ae6f197304ed98f16410bbd3fc5b30ddf"><div class="ttname"><a href="classXRayPSF.html#ae6f197304ed98f16410bbd3fc5b30ddf">XRayPSF::psfVol</a></div><div class="ttdeci">Image&lt; double &gt; psfVol</div><div class="ttdoc">3D PSF read from file </div><div class="ttdef"><b>Definition:</b> <a href="psf__xr_8h_source.html#l00123">psf_xr.h:123</a></div></div>
<div class="ttc" id="classImageBase_html_a3782bd402af72b87daaf60b1ecedac5a"><div class="ttname"><a href="classImageBase.html#a3782bd402af72b87daaf60b1ecedac5a">ImageBase::tilt</a></div><div class="ttdeci">double tilt(const size_t n=0) const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00296">xmipp_image_base.cpp:296</a></div></div>
<div class="ttc" id="group__Images_html_ga6096c97ad2ba182701f4877c206acb94"><div class="ttname"><a href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a></div><div class="ttdeci">#define IMGMATRIX(I)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00171">xmipp_image_base.h:171</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classImageBase_html_a13fcf9a8cfa4f71952ec2fa8e65e1de3"><div class="ttname"><a href="classImageBase.html#a13fcf9a8cfa4f71952ec2fa8e65e1de3">ImageBase::rot</a></div><div class="ttdeci">double rot(const size_t n=0) const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00283">xmipp_image_base.cpp:283</a></div></div>
<div class="ttc" id="classMatrix2D_html_ae95a10993555284a429c727a79207185"><div class="ttname"><a href="classMatrix2D.html#ae95a10993555284a429c727a79207185">Matrix2D::getCol</a></div><div class="ttdeci">void getCol(size_t j, Matrix1D&lt; T &gt; &amp;v) const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01424">matrix2d.h:1424</a></div></div>
<div class="ttc" id="group__Macros_html_ga2f0eecb0f7856721f56faff8f27b0dc1"><div class="ttname"><a href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a></div><div class="ttdeci">#define FLOOR(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00240">xmipp_macros.h:240</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a0d9521fd31b2e16413d1b78836953d53"><div class="ttname"><a href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a></div><div class="ttdeci">#define y0</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga7df2cbd5d7ffe0e8d5d8b9fe8d878b4d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga7df2cbd5d7ffe0e8d5d8b9fe8d878b4d">INSIDEZ</a></div><div class="ttdeci">#define INSIDEZ(v, z)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00091">multidim_array.h:91</a></div></div>
<div class="ttc" id="group__Macros_html_gad584f97e936242b173add43261376ba5"><div class="ttname"><a href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a></div><div class="ttdeci">#define XMIPP_EQUAL_ACCURACY</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00119">xmipp_macros.h:119</a></div></div>
<div class="ttc" id="xmipp__image__over_8h_html_aec248f641411eee7c13d5eaf800366e3"><div class="ttname"><a href="xmipp__image__over_8h.html#aec248f641411eee7c13d5eaf800366e3">IMG2OVER</a></div><div class="ttdeci">#define IMG2OVER(IO, iv, iu, v, u)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__over_8h_source.html#l00234">xmipp_image_over.h:234</a></div></div>
<div class="ttc" id="classImageBase_html_a2a29e596597eb3fa6d1c185dfa14aa9e"><div class="ttname"><a href="classImageBase.html#a2a29e596597eb3fa6d1c185dfa14aa9e">ImageBase::psi</a></div><div class="ttdeci">double psi(const size_t n=0) const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00309">xmipp_image_base.cpp:309</a></div></div>
<div class="ttc" id="classMultidimArray_html_acaa2c55622a40cc09eb50577cb3aed39"><div class="ttname"><a href="classMultidimArray.html#acaa2c55622a40cc09eb50577cb3aed39">MultidimArray::alias</a></div><div class="ttdeci">void alias(const MultidimArray&lt; T &gt; &amp;m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01466">multidim_array.h:1466</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a8f613ddaea2048e3471a1f4f04ba4b79"><div class="ttname"><a href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a></div><div class="ttdeci">#define xF</div></div>
<div class="ttc" id="group__Macros_html_gac9ae6a207f10c821b06a8c0df153a7d5"><div class="ttname"><a href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a></div><div class="ttdeci">#define XMIPP_MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00181">xmipp_macros.h:181</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a67ed20364685ceb31947435119f4f9d9"><div class="ttname"><a href="numerical__recipes_8cpp.html#a67ed20364685ceb31947435119f4f9d9">zero</a></div><div class="ttdeci">ql0001_ &amp; zero(ctemp+1),(cvec+1),(a+1),(b+1),(bl+1),(bu+1),(x+1),(w+1),&amp;iout, ifail,&amp;zero,(w+3),&amp;lwar2,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00073">multidim_array.h:73</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classMatrix2D_html_af11b96d9f1adce57692855f081f14760"><div class="ttname"><a href="classMatrix2D.html#af11b96d9f1adce57692855f081f14760">Matrix2D::getRow</a></div><div class="ttdeci">void getRow(size_t i, Matrix1D&lt; T &gt; &amp;v) const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01396">matrix2d.h:1396</a></div></div>
<div class="ttc" id="group__Geometry_html_gade8f7976e3d84a594d4728bf8f4c029e"><div class="ttname"><a href="group__Geometry.html#gade8f7976e3d84a594d4728bf8f4c029e">Uproject_to_plane</a></div><div class="ttdeci">void Uproject_to_plane(const Matrix1D&lt; double &gt; &amp;point, const Matrix1D&lt; double &gt; &amp;direction, double distance, Matrix1D&lt; double &gt; &amp;result)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00038">geometry.cpp:38</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a132f3924593d07b0a1f55b3f22e92ba6"><div class="ttname"><a href="blobs_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a></div><div class="ttdeci">#define yF</div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af2a333b1670df64a88d3a2f22210d155"><div class="ttname"><a href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a></div><div class="ttdeci">doublereal * a</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__Vectors_html_gafe748b92e8aeaa282eb7bafbd2baca37"><div class="ttname"><a href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a></div><div class="ttdeci">#define V3_PLUS_V3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00193">matrix1d.h:193</a></div></div>
<div class="ttc" id="group__Images_html_gaad11fc7e221702e9f1adeb445ba5db9c"><div class="ttname"><a href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a></div><div class="ttdeci">#define IMGPIXEL(I, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00176">xmipp_image_base.h:176</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gac73a469f0c20412c5b0f9e0986db1c75"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void projectXraySimpleGridThread </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classThreadArgument.html">ThreadArgument</a> &amp;&#160;</td>
          <td class="paramname"><em>thArg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="project__xray_8cpp_source.html#l00731">731</a> of file <a class="el" href="project__xray_8cpp_source.html">project_xray.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;{</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordtype">int</span> threadId = thArg.<a class="code" href="classThreadArgument.html#a214740d0defa218fb98ec336a221e467">thread_id</a>;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <a class="code" href="structXrayThreadArgument.html">XrayThreadArgument</a> *dataThread = (<a class="code" href="structXrayThreadArgument.html">XrayThreadArgument</a>*) thArg.<a class="code" href="classThreadArgument.html#ab7b5ccbf2bd8f5229d65a11829eb5eda">data</a>;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keyword">const</span> <a class="code" href="classXRayPSF.html">XRayPSF</a> &amp;<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a> = *(dataThread-&gt;<a class="code" href="structXrayThreadArgument.html#a24b6e5181ed562fd3cf8cc7d37eab34a">psf</a>);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> *muVol =  (dataThread-&gt;<a class="code" href="structXrayThreadArgument.html#a96abf18442c57a655f44d2aa022e9371">muVol</a>);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> *IgeoVol =  (dataThread-&gt;<a class="code" href="structXrayThreadArgument.html#aa17021827b3fad4794879fc8a49dbdf2">IgeoVol</a>);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <a class="code" href="classProjection.html">Projection</a> *proj = (dataThread-&gt;<a class="code" href="structXrayThreadArgument.html#af16b9ed8413dc9279d416ca3bed369ee">projOut</a>);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;projNorm = *(dataThread-&gt;<a class="code" href="structXrayThreadArgument.html#a9f54451f1207dd7ef9e286e143bacc54">projNorm</a>);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="keywordtype">int</span> forw = dataThread-&gt;<a class="code" href="structXrayThreadArgument.html#aff083c032a06ec0f4ce8f6bc1e707048">forw</a>;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <a class="code" href="group__ProjectionXRProgram.html#gadb3a0dcadf3f7c2ba15457421133d454">projectXraySimpleGrid</a>(muVol, <a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>, IgeoVol, proj, projNorm , forw,</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                          threadId, thArg.<a class="code" href="classThreadArgument.html#a77db3e005b31a201958d1ea8f3293da5">threads</a>);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html"><div class="ttname"><a href="structXrayThreadArgument.html">XrayThreadArgument</a></div><div class="ttdoc">Data struct to be passed to threads. </div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00038">project_xray.h:38</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_aa17021827b3fad4794879fc8a49dbdf2"><div class="ttname"><a href="structXrayThreadArgument.html#aa17021827b3fad4794879fc8a49dbdf2">XrayThreadArgument::IgeoVol</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * IgeoVol</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00042">project_xray.h:42</a></div></div>
<div class="ttc" id="classXRayPSF_html"><div class="ttname"><a href="classXRayPSF.html">XRayPSF</a></div><div class="ttdef"><b>Definition:</b> <a href="psf__xr_8h_source.html#l00103">psf_xr.h:103</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_a9f54451f1207dd7ef9e286e143bacc54"><div class="ttname"><a href="structXrayThreadArgument.html#a9f54451f1207dd7ef9e286e143bacc54">XrayThreadArgument::projNorm</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * projNorm</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00045">project_xray.h:45</a></div></div>
<div class="ttc" id="classThreadArgument_html_ab7b5ccbf2bd8f5229d65a11829eb5eda"><div class="ttname"><a href="classThreadArgument.html#ab7b5ccbf2bd8f5229d65a11829eb5eda">ThreadArgument::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8h_source.html#l00345">xmipp_threads.h:345</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab6da0ee1799087de018b8d62b8cc210e"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a></div><div class="ttdeci">double psf</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05183">numerical_recipes.cpp:5183</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_a24b6e5181ed562fd3cf8cc7d37eab34a"><div class="ttname"><a href="structXrayThreadArgument.html#a24b6e5181ed562fd3cf8cc7d37eab34a">XrayThreadArgument::psf</a></div><div class="ttdeci">XRayPSF * psf</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00040">project_xray.h:40</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_af16b9ed8413dc9279d416ca3bed369ee"><div class="ttname"><a href="structXrayThreadArgument.html#af16b9ed8413dc9279d416ca3bed369ee">XrayThreadArgument::projOut</a></div><div class="ttdeci">Projection * projOut</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00044">project_xray.h:44</a></div></div>
<div class="ttc" id="group__ProjectionXRProgram_html_gadb3a0dcadf3f7c2ba15457421133d454"><div class="ttname"><a href="group__ProjectionXRProgram.html#gadb3a0dcadf3f7c2ba15457421133d454">projectXraySimpleGrid</a></div><div class="ttdeci">void projectXraySimpleGrid(MultidimArray&lt; double &gt; *vol, const XRayPSF &amp;psf, MultidimArray&lt; double &gt; *IgeoVol, Projection *proj, MultidimArray&lt; double &gt; &amp;projNorm, int FORW, int threadId, int numthreads)</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8cpp_source.html#l00752">project_xray.cpp:752</a></div></div>
<div class="ttc" id="classThreadArgument_html_a77db3e005b31a201958d1ea8f3293da5"><div class="ttname"><a href="classThreadArgument.html#a77db3e005b31a201958d1ea8f3293da5">ThreadArgument::threads</a></div><div class="ttdeci">int threads</div><div class="ttdoc">Number of threads. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8h_source.html#l00343">xmipp_threads.h:343</a></div></div>
<div class="ttc" id="classProjection_html"><div class="ttname"><a href="classProjection.html">Projection</a></div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00056">fourier_projection.h:56</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_aff083c032a06ec0f4ce8f6bc1e707048"><div class="ttname"><a href="structXrayThreadArgument.html#aff083c032a06ec0f4ce8f6bc1e707048">XrayThreadArgument::forw</a></div><div class="ttdeci">int forw</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00046">project_xray.h:46</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_a96abf18442c57a655f44d2aa022e9371"><div class="ttname"><a href="structXrayThreadArgument.html#a96abf18442c57a655f44d2aa022e9371">XrayThreadArgument::muVol</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * muVol</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00041">project_xray.h:41</a></div></div>
<div class="ttc" id="classThreadArgument_html_a214740d0defa218fb98ec336a221e467"><div class="ttname"><a href="classThreadArgument.html#a214740d0defa218fb98ec336a221e467">ThreadArgument::thread_id</a></div><div class="ttdeci">int thread_id</div><div class="ttdoc">The thread id. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8h_source.html#l00342">xmipp_threads.h:342</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gafe1526d8c158a0c0b6c423541d13070a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void projectXrayVolume </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>muVol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>IgeoVol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classXRayPSF.html">XRayPSF</a> &amp;&#160;</td>
          <td class="paramname"><em>psf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>projNorm</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadManager.html">ThreadManager</a> *&#160;</td>
          <td class="paramname"><em>ThrMgr</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="project__xray_8cpp_source.html#l00339">339</a> of file <a class="el" href="project__xray_8cpp_source.html">project_xray.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;{</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">/* Now we have to split the phantom rotated volume into slabs, taking into</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">     * account the possible different resolution and Z size.</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">     * PhantomSlabIdx are the indexes of rotVol defining the slabs according to</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">     * the splitting done to PSFVol.</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">     * psfSlicesIdx are the indexes of the z planes of rotVol whose psf are</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">     * used for the slabs.</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    std::vector&lt;int&gt; phantomSlabIdx, psfSlicesIdx;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// Search for the PSFslab of the beginning of the volume</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordtype">int</span> firstSlab = (int)(<a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(muVol)*psf.<a class="code" href="classXRayPSF.html#a5a777d2f8a39be40df31c50aa01e82af">dzo</a>/psf.<a class="code" href="classXRayPSF.html#afb8c6b83be04eb7ed13b131fcd7b3c2d">dzoPSF</a>);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="group__Macros.html#gaa411dfe44bddb4ce8cce9468359407f2">XMIPP_EQUAL_ZERO</a>(psf.<a class="code" href="classXRayPSF.html#a1aaae6254cf3e26c0a0d622e8ac09d4a">slabThr</a>))</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    {</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> kk = 0; kk &lt; psf.<a class="code" href="classXRayPSF.html#a3bbb0e160c07b8f2af053c78dcfac3b5">slabIndex</a>.size(); ++kk)</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        {</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="keywordflow">if</span> (firstSlab &lt; psf.<a class="code" href="classXRayPSF.html#a3bbb0e160c07b8f2af053c78dcfac3b5">slabIndex</a>[kk])</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                firstSlab = kk-1;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="comment">// Searching the equivalent index in rotvol for the indexes for the Slabs of PSFVol</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        phantomSlabIdx.push_back(<a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(muVol));</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> kk = firstSlab+1; kk &lt; psf.<a class="code" href="classXRayPSF.html#a3bbb0e160c07b8f2af053c78dcfac3b5">slabIndex</a>.size(); ++kk)</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <span class="keywordtype">int</span> tempK = (int)(psf.<a class="code" href="classXRayPSF.html#a3bbb0e160c07b8f2af053c78dcfac3b5">slabIndex</a>[kk] * psf.<a class="code" href="classXRayPSF.html#afb8c6b83be04eb7ed13b131fcd7b3c2d">dzoPSF</a> / psf.<a class="code" href="classXRayPSF.html#a5a777d2f8a39be40df31c50aa01e82af">dzo</a>);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            <span class="keywordflow">if</span> (tempK &lt;= <a class="code" href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(muVol))</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                phantomSlabIdx.push_back(tempK);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                <span class="keywordtype">int</span> tempKK = psf.<a class="code" href="classXRayPSF.html#a3bbb0e160c07b8f2af053c78dcfac3b5">slabIndex</a>[kk-1];</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                <span class="keywordtype">int</span> psfMeanSlice = (int)((tempK + tempKK)*0.5 * psf.<a class="code" href="classXRayPSF.html#afb8c6b83be04eb7ed13b131fcd7b3c2d">dzoPSF</a> / psf.<a class="code" href="classXRayPSF.html#a5a777d2f8a39be40df31c50aa01e82af">dzo</a>);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                psfSlicesIdx.push_back(psfMeanSlice);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            {</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                phantomSlabIdx.push_back(<a class="code" href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(muVol));</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                <span class="keywordtype">int</span> psfMeanSlice = (tempK + phantomSlabIdx[kk-1])/2;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                psfSlicesIdx.push_back(psfMeanSlice);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            }</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        }</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    }</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> = <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(muVol); <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> &lt;= <a class="code" href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(muVol); ++<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>)</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        {</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            phantomSlabIdx.push_back(<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            psfSlicesIdx.push_back(<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        }</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="comment">// To define the last range</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        phantomSlabIdx.push_back(<a class="code" href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(muVol)+1);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    }</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <a class="code" href="structXrayThreadArgument.html">XrayThreadArgument</a> projThrData;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <a class="code" href="classBarrier.html">Barrier</a> <a class="code" href="group__ProjectionXRProgram.html#gaa7d3601dfe4f1448143811e57bd9ca46">barrier</a>(<a class="code" href="group__ProjectionXRProgram.html#gab6ca869b2467a1904a98f322868c6ba4">thMgr</a>-&gt;<a class="code" href="classThreadManager.html#a6525c2e9fcc12a9668c7145aaf92df4c">threads</a>);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    projThrData.<a class="code" href="structXrayThreadArgument.html#a24b6e5181ed562fd3cf8cc7d37eab34a">psf</a> = &amp;<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    projThrData.<a class="code" href="structXrayThreadArgument.html#a96abf18442c57a655f44d2aa022e9371">muVol</a> = &amp;muVol;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    projThrData.<a class="code" href="structXrayThreadArgument.html#aa17021827b3fad4794879fc8a49dbdf2">IgeoVol</a> = &amp;IgeoVol;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    projThrData.<a class="code" href="structXrayThreadArgument.html#af16b9ed8413dc9279d416ca3bed369ee">projOut</a> = &amp;P;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    projThrData.<a class="code" href="structXrayThreadArgument.html#a9f54451f1207dd7ef9e286e143bacc54">projNorm</a> = projNorm;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    projThrData.<a class="code" href="structXrayThreadArgument.html#a33c8e38b15a4baec5891929c696ff01b">phantomSlabIdx</a> = &amp; phantomSlabIdx;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    projThrData.<a class="code" href="structXrayThreadArgument.html#af7328ebcf8749a6c3f9df751f2baabbc">psfSlicesIdx</a> = &amp; psfSlicesIdx;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">//Create the job handler to distribute thread jobs</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordtype">size_t</span> blockSize, numberOfJobs = psfSlicesIdx.size() ;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    blockSize = 1;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <a class="code" href="classThreadTaskDistributor.html">ThreadTaskDistributor</a> td(numberOfJobs, blockSize);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    projThrData.<a class="code" href="structXrayThreadArgument.html#a4e4488263758643dd953502d87ee93df">td</a> = &amp;td;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    projThrData.<a class="code" href="structXrayThreadArgument.html#a57644abac55cad78c68e788be8e33457">barrier</a> = &amp;<a class="code" href="group__ProjectionXRProgram.html#gaa7d3601dfe4f1448143811e57bd9ca46">barrier</a>;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">//the really really final project routine, I swear by Snoopy.</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">//    project_xr(psf,side.rotPhantomVol,P, idxSlice);</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <a class="code" href="group__ProjectionXRProgram.html#gab6ca869b2467a1904a98f322868c6ba4">thMgr</a>-&gt;<a class="code" href="classThreadManager.html#afd48602d0778461e6bb6d4de4a98b3e9">run</a>(<a class="code" href="group__ProjectionXRProgram.html#gae32293f062509911d4c48243872e8562">threadXrayProject</a>,(<span class="keywordtype">void</span>*) &amp;projThrData);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">//    P.write(&quot;projection_after_threads.spi&quot;);</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;}</div><div class="ttc" id="classThreadManager_html_afd48602d0778461e6bb6d4de4a98b3e9"><div class="ttname"><a href="classThreadManager.html#afd48602d0778461e6bb6d4de4a98b3e9">ThreadManager::run</a></div><div class="ttdeci">void run(ThreadFunction function, void *data=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8cpp_source.html#l00264">xmipp_threads.cpp:264</a></div></div>
<div class="ttc" id="group__ProjectionXRProgram_html_gae32293f062509911d4c48243872e8562"><div class="ttname"><a href="group__ProjectionXRProgram.html#gae32293f062509911d4c48243872e8562">threadXrayProject</a></div><div class="ttdeci">void threadXrayProject(ThreadArgument &amp;thArg)</div><div class="ttdoc">Generate an X-ray microscope projection for volume vol using the microscope configuration psf...</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8cpp_source.html#l00445">project_xray.cpp:445</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html"><div class="ttname"><a href="structXrayThreadArgument.html">XrayThreadArgument</a></div><div class="ttdoc">Data struct to be passed to threads. </div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00038">project_xray.h:38</a></div></div>
<div class="ttc" id="group__ProjectionXRProgram_html_gab6ca869b2467a1904a98f322868c6ba4"><div class="ttname"><a href="group__ProjectionXRProgram.html#gab6ca869b2467a1904a98f322868c6ba4">thMgr</a></div><div class="ttdeci">ThreadManager * thMgr</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8cpp_source.html#l00083">project_xray.cpp:83</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_aa17021827b3fad4794879fc8a49dbdf2"><div class="ttname"><a href="structXrayThreadArgument.html#aa17021827b3fad4794879fc8a49dbdf2">XrayThreadArgument::IgeoVol</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * IgeoVol</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00042">project_xray.h:42</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga706d2ce724d393d4d759a46225bbc6c1"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a></div><div class="ttdeci">#define FINISHINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00081">multidim_array.h:81</a></div></div>
<div class="ttc" id="classThreadManager_html_a6525c2e9fcc12a9668c7145aaf92df4c"><div class="ttname"><a href="classThreadManager.html#a6525c2e9fcc12a9668c7145aaf92df4c">ThreadManager::threads</a></div><div class="ttdeci">int threads</div><div class="ttdoc">number of working threads. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8h_source.html#l00242">xmipp_threads.h:242</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_a4e4488263758643dd953502d87ee93df"><div class="ttname"><a href="structXrayThreadArgument.html#a4e4488263758643dd953502d87ee93df">XrayThreadArgument::td</a></div><div class="ttdeci">ParallelTaskDistributor * td</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00049">project_xray.h:49</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_a9f54451f1207dd7ef9e286e143bacc54"><div class="ttname"><a href="structXrayThreadArgument.html#a9f54451f1207dd7ef9e286e143bacc54">XrayThreadArgument::projNorm</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * projNorm</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00045">project_xray.h:45</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_a33c8e38b15a4baec5891929c696ff01b"><div class="ttname"><a href="structXrayThreadArgument.html#a33c8e38b15a4baec5891929c696ff01b">XrayThreadArgument::phantomSlabIdx</a></div><div class="ttdeci">std::vector&lt; int &gt; * phantomSlabIdx</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00047">project_xray.h:47</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_af7328ebcf8749a6c3f9df751f2baabbc"><div class="ttname"><a href="structXrayThreadArgument.html#af7328ebcf8749a6c3f9df751f2baabbc">XrayThreadArgument::psfSlicesIdx</a></div><div class="ttdeci">std::vector&lt; int &gt; * psfSlicesIdx</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00048">project_xray.h:48</a></div></div>
<div class="ttc" id="group__ProjectionXRProgram_html_gaa7d3601dfe4f1448143811e57bd9ca46"><div class="ttname"><a href="group__ProjectionXRProgram.html#gaa7d3601dfe4f1448143811e57bd9ca46">barrier</a></div><div class="ttdeci">Barrier * barrier</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8cpp_source.html#l00082">project_xray.cpp:82</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab6da0ee1799087de018b8d62b8cc210e"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a></div><div class="ttdeci">double psf</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05183">numerical_recipes.cpp:5183</a></div></div>
<div class="ttc" id="classThreadTaskDistributor_html"><div class="ttname"><a href="classThreadTaskDistributor.html">ThreadTaskDistributor</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8h_source.html#l00451">xmipp_threads.h:451</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="classXRayPSF_html_a3bbb0e160c07b8f2af053c78dcfac3b5"><div class="ttname"><a href="classXRayPSF.html#a3bbb0e160c07b8f2af053c78dcfac3b5">XRayPSF::slabIndex</a></div><div class="ttdeci">std::vector&lt; int &gt; slabIndex</div><div class="ttdoc">Z positions in the original PSF Volume to determine de slabs. </div><div class="ttdef"><b>Definition:</b> <a href="psf__xr_8h_source.html#l00131">psf_xr.h:131</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_a57644abac55cad78c68e788be8e33457"><div class="ttname"><a href="structXrayThreadArgument.html#a57644abac55cad78c68e788be8e33457">XrayThreadArgument::barrier</a></div><div class="ttdeci">Barrier * barrier</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00050">project_xray.h:50</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_a24b6e5181ed562fd3cf8cc7d37eab34a"><div class="ttname"><a href="structXrayThreadArgument.html#a24b6e5181ed562fd3cf8cc7d37eab34a">XrayThreadArgument::psf</a></div><div class="ttdeci">XRayPSF * psf</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00040">project_xray.h:40</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_af16b9ed8413dc9279d416ca3bed369ee"><div class="ttname"><a href="structXrayThreadArgument.html#af16b9ed8413dc9279d416ca3bed369ee">XrayThreadArgument::projOut</a></div><div class="ttdeci">Projection * projOut</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00044">project_xray.h:44</a></div></div>
<div class="ttc" id="classXRayPSF_html_a1aaae6254cf3e26c0a0d622e8ac09d4a"><div class="ttname"><a href="classXRayPSF.html#a1aaae6254cf3e26c0a0d622e8ac09d4a">XRayPSF::slabThr</a></div><div class="ttdeci">double slabThr</div><div class="ttdoc">Threshold to separate The volume into slabs to use the same PSF. </div><div class="ttdef"><b>Definition:</b> <a href="psf__xr_8h_source.html#l00129">psf_xr.h:129</a></div></div>
<div class="ttc" id="group__Macros_html_gaa411dfe44bddb4ce8cce9468359407f2"><div class="ttname"><a href="group__Macros.html#gaa411dfe44bddb4ce8cce9468359407f2">XMIPP_EQUAL_ZERO</a></div><div class="ttdeci">#define XMIPP_EQUAL_ZERO(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00123">xmipp_macros.h:123</a></div></div>
<div class="ttc" id="classBarrier_html"><div class="ttname"><a href="classBarrier.html">Barrier</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8h_source.html#l00150">xmipp_threads.h:150</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="structXrayThreadArgument_html_a96abf18442c57a655f44d2aa022e9371"><div class="ttname"><a href="structXrayThreadArgument.html#a96abf18442c57a655f44d2aa022e9371">XrayThreadArgument::muVol</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * muVol</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00041">project_xray.h:41</a></div></div>
<div class="ttc" id="classXRayPSF_html_a5a777d2f8a39be40df31c50aa01e82af"><div class="ttname"><a href="classXRayPSF.html#a5a777d2f8a39be40df31c50aa01e82af">XRayPSF::dzo</a></div><div class="ttdeci">double dzo</div><div class="ttdoc">object space Z sampling rate </div><div class="ttdef"><b>Definition:</b> <a href="psf__xr_8h_source.html#l00199">psf_xr.h:199</a></div></div>
<div class="ttc" id="classXRayPSF_html_afb8c6b83be04eb7ed13b131fcd7b3c2d"><div class="ttname"><a href="classXRayPSF.html#afb8c6b83be04eb7ed13b131fcd7b3c2d">XRayPSF::dzoPSF</a></div><div class="ttdeci">double dzoPSF</div><div class="ttdoc">object space Z sampling rate of the PSF Volume </div><div class="ttdef"><b>Definition:</b> <a href="psf__xr_8h_source.html#l00206">psf_xr.h:206</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gae32293f062509911d4c48243872e8562"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void threadXrayProject </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classThreadArgument.html">ThreadArgument</a> &amp;&#160;</td>
          <td class="paramname"><em>thArg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="classThread.html">Thread</a> Job to generate an X-ray microscope projection. </p>
<p><a class="el" href="classThread.html">Thread</a> Job to generate an X-ray microscope projection. </p>
<p>Calculate projNorm </p>

<p>Definition at line <a class="el" href="project__xray_8cpp_source.html#l00445">445</a> of file <a class="el" href="project__xray_8cpp_source.html">project_xray.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;{</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordtype">int</span> thread_id = thArg.<a class="code" href="classThreadArgument.html#a214740d0defa218fb98ec336a221e467">thread_id</a>;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="structXrayThreadArgument.html">XrayThreadArgument</a> *dataThread = (<a class="code" href="structXrayThreadArgument.html">XrayThreadArgument</a>*) thArg.<a class="code" href="classThreadArgument.html#ab7b5ccbf2bd8f5229d65a11829eb5eda">data</a>;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keyword">const</span> <a class="code" href="classXRayPSF.html">XRayPSF</a> &amp;<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a> = *(dataThread-&gt;<a class="code" href="structXrayThreadArgument.html#a24b6e5181ed562fd3cf8cc7d37eab34a">psf</a>);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;muVol =  *(dataThread-&gt;<a class="code" href="structXrayThreadArgument.html#a96abf18442c57a655f44d2aa022e9371">muVol</a>);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;IgeoVol =  *(dataThread-&gt;<a class="code" href="structXrayThreadArgument.html#aa17021827b3fad4794879fc8a49dbdf2">IgeoVol</a>);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <a class="code" href="classImage.html">Image&lt;double&gt;</a> &amp;imOutGlobal = *(dataThread-&gt;<a class="code" href="structXrayThreadArgument.html#af16b9ed8413dc9279d416ca3bed369ee">projOut</a>);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> * projNorm = dataThread-&gt;<a class="code" href="structXrayThreadArgument.html#a9f54451f1207dd7ef9e286e143bacc54">projNorm</a>;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    std::vector&lt;int&gt; &amp;phantomSlabIdx = *(dataThread-&gt;<a class="code" href="structXrayThreadArgument.html#a33c8e38b15a4baec5891929c696ff01b">phantomSlabIdx</a>);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    std::vector&lt;int&gt; &amp;psfSlicesIdx = *(dataThread-&gt;<a class="code" href="structXrayThreadArgument.html#af7328ebcf8749a6c3f9df751f2baabbc">psfSlicesIdx</a>);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <a class="code" href="classParallelTaskDistributor.html">ParallelTaskDistributor</a> * td = dataThread-&gt;<a class="code" href="structXrayThreadArgument.html#a4e4488263758643dd953502d87ee93df">td</a>;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <a class="code" href="classBarrier.html">Barrier</a> * <a class="code" href="group__ProjectionXRProgram.html#gaa7d3601dfe4f1448143811e57bd9ca46">barrier</a> = dataThread-&gt;<a class="code" href="structXrayThreadArgument.html#a57644abac55cad78c68e788be8e33457">barrier</a>;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#acaec38248b66cfba849985072bd311f6">first</a> = 0, last = 0;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">if</span> (thread_id == 0)</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    {</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        muVol.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(imOutGlobal).resizeNoCopy(<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Niy, <a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Nix);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(imOutGlobal).initZeros();</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(imOutGlobal).setXmippOrigin();</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    barrier-&gt;<a class="code" href="classBarrier.html#a83a9d2e85e98b3d2081538bf0da29b60">wait</a>();</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> imOut(<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Niy, <a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Nix), projNormTemp(<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Niy, <a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Nix);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    imOut.setXmippOrigin();</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    projNormTemp.setXmippOrigin();</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> imTemp(<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Noy, <a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Nox),intExp(<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Noy, <a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Nox),imTempSc(imOut),*imTempP=NULL;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    intExp.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    imTemp.setXmippOrigin();</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    imTempSc.setXmippOrigin();</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">// Parallel thread jobs</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordflow">while</span> (td-&gt;<a class="code" href="classParallelTaskDistributor.html#a28f70bcc333b8b06d7571db06c67bdc3">getTasks</a>(first, last))</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    {</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <span class="comment">//#define DEBUG</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <a class="code" href="classImage.html">Image&lt;double&gt;</a> _Im;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordtype">int</span> kini = phantomSlabIdx[<a class="code" href="numerical__recipes_8cpp.html#acaec38248b66cfba849985072bd311f6">first</a>];</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="keywordtype">int</span> kend = phantomSlabIdx[last + 1] - 1 ;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="comment">//        double deltaZSlab =  psf.dzo*(kend-kini+1);</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        intExp.initZeros();</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(intExp)</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        {</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> = kini; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> &lt;= kend; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>++)</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                <span class="keywordtype">double</span> tempValue = <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(muVol,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(intExp,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) += tempValue;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            }</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(imTemp,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(IgeoVol,kini,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)*(1 - exp( -<a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(intExp,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) * <a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.dzo));</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        _Im().alias(intExp);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        _Im.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;projectXR-intExp.spi&quot;</span>);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        _Im().alias(imTemp);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        _Im.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;projectXR-imTemp.spi&quot;</span>);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.AdjustType)</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__PSFXRSupport.html#ggae3bbda676920405fa092adc742c58e23ae9aa3dee411524afb7102c8c42e3eb0c">PSFXR_INT</a>:</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            imTempP = &amp;imTempSc;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#gafc49d813bd3c47ca193e504888d78b2a">scaleToSize</a>(<a class="code" href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a>,*imTempP,imTemp,<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Nix,<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Niy);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__PSFXRSupport.html#ggae3bbda676920405fa092adc742c58e23a0ceba147a66b64f7fb7b5a92dc62de62">PSFXR_STD</a>:</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            imTempP = &amp;imTemp;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__PSFXRSupport.html#ggae3bbda676920405fa092adc742c58e23ae7bdb7bd7245e8b28b26f9d374e7a6e5">PSFXR_ZPAD</a>:</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <span class="comment">//    (*imTempSc).resize(imTemp);</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            imTempP = &amp;imTempSc;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            imTemp.<a class="code" href="classMultidimArray.html#a989ec8f5584750a4ac84a9020ad3744c">window</a>(*imTempP,-<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Niy/2)+1,-<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Nix/2)+1,<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Niy/2)-1,<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Nix/2)-1);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        _Im().alias(*imTempP);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        _Im.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;projectXR-imTempEsc_before.spi&quot;</span>);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.applyOTF(*imTempP, imOutGlobal.<a class="code" href="classImageBase.html#a3fc6cf99cf3a78d88ede07fc906abe5a">Zoff</a>()- psfSlicesIdx[<a class="code" href="numerical__recipes_8cpp.html#acaec38248b66cfba849985072bd311f6">first</a>]*<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.dzo);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        _Im.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;projectXR-imTempEsc_after.spi&quot;</span>);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="comment">// Adding to the thread temporal imOut</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a>(*imTempP)</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(imOut,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) += <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(*imTempP,i,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        _Im().alias(imOut);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        _Im.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;projectXR-imout.spi&quot;</span>);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="keywordflow">if</span> (projNorm != NULL)</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        {</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(imTemp)</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(imTemp,i,j) = <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(IgeoVol,kini,i,j) * <a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.dzo;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            <span class="comment">//            IgeoVol.getSlice(kini, imTemp);</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            <a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.applyOTF(imTemp, imOutGlobal.Zoff()- psfSlicesIdx[first]*<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.dzo);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a>(imTemp)</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(projNormTemp,i,j) += <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(imTemp,i,j)*<a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(imTemp,i,j);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        }</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    }</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="comment">//Lock to update the total addition and multiply for the pixel width (to avoid multiply several times)</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <a class="code" href="group__ProjectionXRProgram.html#gae8b85b4f519a4945ba9ea43e9b503531">mutex</a>.lock();</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a>(imOut)</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(<a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(imOutGlobal),i,j) += <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(imOut,i,j);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (projNorm != NULL)</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    {</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a>(projNormTemp)</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(*projNorm,i,j) += <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(projNormTemp,i,j);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    }</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <a class="code" href="group__ProjectionXRProgram.html#gae8b85b4f519a4945ba9ea43e9b503531">mutex</a>.unlock();</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    imOutGlobal.write(<span class="stringliteral">&quot;projectXR-imoutGlobal.spi&quot;</span>);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    barrier-&gt;<a class="code" href="classBarrier.html#a83a9d2e85e98b3d2081538bf0da29b60">wait</a>();</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">if</span> (thread_id==0)</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    {</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="comment">// The output is the addition of the  accumulated differences, the real projection is background illumination minus this</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="comment">//        MULTIDIM_ARRAY(imOutGlobal) = 1.0- MULTIDIM_ARRAY(imOutGlobal);</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.AdjustType)</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        {</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__PSFXRSupport.html#ggae3bbda676920405fa092adc742c58e23a0ceba147a66b64f7fb7b5a92dc62de62">PSFXR_STD</a>:</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            <span class="comment">// Do nothing;</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__PSFXRSupport.html#ggae3bbda676920405fa092adc742c58e23ae9aa3dee411524afb7102c8c42e3eb0c">PSFXR_INT</a>:</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#ga04c547130530ebaa6ce754df5b0ae089">selfScaleToSize</a>(<a class="code" href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a>,imOutGlobal(), <a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Nox, <a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Noy);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__PSFXRSupport.html#ggae3bbda676920405fa092adc742c58e23ae7bdb7bd7245e8b28b26f9d374e7a6e5">PSFXR_ZPAD</a>:</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(imOutGlobal).selfWindow(-<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Noy/2)+1,-<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Nox/2)+1,<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Noy/2)-1,<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a>.Nox/2)-1);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        }</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(imOutGlobal).setXmippOrigin();</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        imOutGlobal.write(<span class="stringliteral">&quot;projectXR-imoutGlobal_negative.spi&quot;</span>);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    }</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="comment">//    std::cerr &lt;&lt; &quot;th&quot; &lt;&lt; thread_id &lt;&lt; &quot;: Thread Finished&quot; &lt;&lt;std::endl;</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="preprocessor">#undef DEBUG</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;}</div><div class="ttc" id="group__ProjectionXRProgram_html_gae8b85b4f519a4945ba9ea43e9b503531"><div class="ttname"><a href="group__ProjectionXRProgram.html#gae8b85b4f519a4945ba9ea43e9b503531">mutex</a></div><div class="ttdeci">Mutex mutex</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8cpp_source.html#l00081">project_xray.cpp:81</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00364">multidim_array.h:364</a></div></div>
<div class="ttc" id="classParallelTaskDistributor_html"><div class="ttname"><a href="classParallelTaskDistributor.html">ParallelTaskDistributor</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8h_source.html#l00366">xmipp_threads.h:366</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gac87b223f03097d45f776b44b6aeea9f7"><div class="ttname"><a href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a></div><div class="ttdeci">#define MULTIDIM_ARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00136">multidim_array.h:136</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html"><div class="ttname"><a href="structXrayThreadArgument.html">XrayThreadArgument</a></div><div class="ttdoc">Data struct to be passed to threads. </div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00038">project_xray.h:38</a></div></div>
<div class="ttc" id="classImageBase_html_a3fc6cf99cf3a78d88ede07fc906abe5a"><div class="ttname"><a href="classImageBase.html#a3fc6cf99cf3a78d88ede07fc906abe5a">ImageBase::Zoff</a></div><div class="ttdeci">double Zoff(const size_t n=0) const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00348">xmipp_image_base.cpp:348</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_aa17021827b3fad4794879fc8a49dbdf2"><div class="ttname"><a href="structXrayThreadArgument.html#aa17021827b3fad4794879fc8a49dbdf2">XrayThreadArgument::IgeoVol</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * IgeoVol</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00042">project_xray.h:42</a></div></div>
<div class="ttc" id="classParallelTaskDistributor_html_a28f70bcc333b8b06d7571db06c67bdc3"><div class="ttname"><a href="classParallelTaskDistributor.html#a28f70bcc333b8b06d7571db06c67bdc3">ParallelTaskDistributor::getTasks</a></div><div class="ttdeci">bool getTasks(size_t &amp;first, size_t &amp;last)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8cpp_source.html#l00318">xmipp_threads.cpp:318</a></div></div>
<div class="ttc" id="classImageBase_html_ae81a8c11a832924c2bda0909882c3168"><div class="ttname"><a href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">ImageBase::write</a></div><div class="ttdeci">void write(const FileName &amp;name=&quot;&quot;, size_t select_img=ALL_IMAGES, bool isStack=false, int mode=WRITE_OVERWRITE, CastWriteMode castMode=CW_CAST, int _swapWrite=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00210">xmipp_image_base.cpp:210</a></div></div>
<div class="ttc" id="classXRayPSF_html"><div class="ttname"><a href="classXRayPSF.html">XRayPSF</a></div><div class="ttdef"><b>Definition:</b> <a href="psf__xr_8h_source.html#l00103">psf_xr.h:103</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_a4e4488263758643dd953502d87ee93df"><div class="ttname"><a href="structXrayThreadArgument.html#a4e4488263758643dd953502d87ee93df">XrayThreadArgument::td</a></div><div class="ttdeci">ParallelTaskDistributor * td</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00049">project_xray.h:49</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_a9f54451f1207dd7ef9e286e143bacc54"><div class="ttname"><a href="structXrayThreadArgument.html#a9f54451f1207dd7ef9e286e143bacc54">XrayThreadArgument::projNorm</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * projNorm</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00045">project_xray.h:45</a></div></div>
<div class="ttc" id="group__PSFXRSupport_html_ggae3bbda676920405fa092adc742c58e23a0ceba147a66b64f7fb7b5a92dc62de62"><div class="ttname"><a href="group__PSFXRSupport.html#ggae3bbda676920405fa092adc742c58e23a0ceba147a66b64f7fb7b5a92dc62de62">PSFXR_STD</a></div><div class="ttdef"><b>Definition:</b> <a href="psf__xr_8h_source.html#l00043">psf_xr.h:43</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classThreadArgument_html_ab7b5ccbf2bd8f5229d65a11829eb5eda"><div class="ttname"><a href="classThreadArgument.html#ab7b5ccbf2bd8f5229d65a11829eb5eda">ThreadArgument::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8h_source.html#l00345">xmipp_threads.h:345</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga04c547130530ebaa6ce754df5b0ae089"><div class="ttname"><a href="group__GeometricalTransformations.html#ga04c547130530ebaa6ce754df5b0ae089">selfScaleToSize</a></div><div class="ttdeci">void selfScaleToSize(int SplineDegree, MultidimArrayGeneric &amp;V1, int Xdim, int Ydim, int Zdim)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00585">transformations.cpp:585</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_a33c8e38b15a4baec5891929c696ff01b"><div class="ttname"><a href="structXrayThreadArgument.html#a33c8e38b15a4baec5891929c696ff01b">XrayThreadArgument::phantomSlabIdx</a></div><div class="ttdeci">std::vector&lt; int &gt; * phantomSlabIdx</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00047">project_xray.h:47</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_af7328ebcf8749a6c3f9df751f2baabbc"><div class="ttname"><a href="structXrayThreadArgument.html#af7328ebcf8749a6c3f9df751f2baabbc">XrayThreadArgument::psfSlicesIdx</a></div><div class="ttdeci">std::vector&lt; int &gt; * psfSlicesIdx</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00048">project_xray.h:48</a></div></div>
<div class="ttc" id="group__PSFXRSupport_html_ggae3bbda676920405fa092adc742c58e23ae9aa3dee411524afb7102c8c42e3eb0c"><div class="ttname"><a href="group__PSFXRSupport.html#ggae3bbda676920405fa092adc742c58e23ae9aa3dee411524afb7102c8c42e3eb0c">PSFXR_INT</a></div><div class="ttdoc">Standard mode, image size does not changes. </div><div class="ttdef"><b>Definition:</b> <a href="psf__xr_8h_source.html#l00044">psf_xr.h:44</a></div></div>
<div class="ttc" id="classMultidimArray_html_a989ec8f5584750a4ac84a9020ad3744c"><div class="ttname"><a href="classMultidimArray.html#a989ec8f5584750a4ac84a9020ad3744c">MultidimArray::window</a></div><div class="ttdeci">void window(MultidimArray&lt; T1 &gt; &amp;result, int n0, int z0, int y0, int x0, int nF, int zF, int yF, int xF, T1 init_value=0) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01762">multidim_array.h:1762</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_acaec38248b66cfba849985072bd311f6"><div class="ttname"><a href="numerical__recipes_8cpp.html#acaec38248b66cfba849985072bd311f6">first</a></div><div class="ttdeci">glob_log first</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05218">numerical_recipes.cpp:5218</a></div></div>
<div class="ttc" id="group__ProjectionXRProgram_html_gaa7d3601dfe4f1448143811e57bd9ca46"><div class="ttname"><a href="group__ProjectionXRProgram.html#gaa7d3601dfe4f1448143811e57bd9ca46">barrier</a></div><div class="ttdeci">Barrier * barrier</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8cpp_source.html#l00082">project_xray.cpp:82</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab6da0ee1799087de018b8d62b8cc210e"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab6da0ee1799087de018b8d62b8cc210e">psf</a></div><div class="ttdeci">double psf</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05183">numerical_recipes.cpp:5183</a></div></div>
<div class="ttc" id="classBarrier_html_a83a9d2e85e98b3d2081538bf0da29b60"><div class="ttname"><a href="classBarrier.html#a83a9d2e85e98b3d2081538bf0da29b60">Barrier::wait</a></div><div class="ttdeci">void wait()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8cpp_source.html#l00109">xmipp_threads.cpp:109</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_a57644abac55cad78c68e788be8e33457"><div class="ttname"><a href="structXrayThreadArgument.html#a57644abac55cad78c68e788be8e33457">XrayThreadArgument::barrier</a></div><div class="ttdeci">Barrier * barrier</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00050">project_xray.h:50</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_a24b6e5181ed562fd3cf8cc7d37eab34a"><div class="ttname"><a href="structXrayThreadArgument.html#a24b6e5181ed562fd3cf8cc7d37eab34a">XrayThreadArgument::psf</a></div><div class="ttdeci">XRayPSF * psf</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00040">project_xray.h:40</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00400">multidim_array.h:400</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_af16b9ed8413dc9279d416ca3bed369ee"><div class="ttname"><a href="structXrayThreadArgument.html#af16b9ed8413dc9279d416ca3bed369ee">XrayThreadArgument::projOut</a></div><div class="ttdeci">Projection * projOut</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00044">project_xray.h:44</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gac645eb9a88619ee6f5e14c557ab8ef62"><div class="ttname"><a href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a></div><div class="ttdeci">#define LINEAR</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00208">transformations.h:208</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gafa02b309a507bf04daf9f31fa828ce4f"><div class="ttname"><a href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a></div><div class="ttdeci">#define dAij(M, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00355">multidim_array.h:355</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="classBarrier_html"><div class="ttname"><a href="classBarrier.html">Barrier</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8h_source.html#l00150">xmipp_threads.h:150</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gafc49d813bd3c47ca193e504888d78b2a"><div class="ttname"><a href="group__GeometricalTransformations.html#gafc49d813bd3c47ca193e504888d78b2a">scaleToSize</a></div><div class="ttdeci">void scaleToSize(int SplineDegree, MultidimArrayGeneric &amp;V2, const MultidimArrayGeneric &amp;V1, int Xdim, int Ydim, int Zdim)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00595">transformations.cpp:595</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="group__PSFXRSupport_html_ggae3bbda676920405fa092adc742c58e23ae7bdb7bd7245e8b28b26f9d374e7a6e5"><div class="ttname"><a href="group__PSFXRSupport.html#ggae3bbda676920405fa092adc742c58e23ae7bdb7bd7245e8b28b26f9d374e7a6e5">PSFXR_ZPAD</a></div><div class="ttdoc">Increasing the image size by Interpolating. </div><div class="ttdef"><b>Definition:</b> <a href="psf__xr_8h_source.html#l00045">psf_xr.h:45</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4e8db4e5757ca2f6e233d0a1eec7ff1c"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00519">multidim_array.h:519</a></div></div>
<div class="ttc" id="structXrayThreadArgument_html_a96abf18442c57a655f44d2aa022e9371"><div class="ttname"><a href="structXrayThreadArgument.html#a96abf18442c57a655f44d2aa022e9371">XrayThreadArgument::muVol</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * muVol</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8h_source.html#l00041">project_xray.h:41</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="classThreadArgument_html_a214740d0defa218fb98ec336a221e467"><div class="ttname"><a href="classThreadArgument.html#a214740d0defa218fb98ec336a221e467">ThreadArgument::thread_id</a></div><div class="ttdeci">int thread_id</div><div class="ttdoc">The thread id. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8h_source.html#l00342">xmipp_threads.h:342</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga71e111e722d03207ce9d763ab498995b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void XrayRotateAndProjectVolumeOffCentered </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classXrayProjPhantom.html">XrayProjPhantom</a> &amp;&#160;</td>
          <td class="paramname"><em>side</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classXRayPSF.html">XRayPSF</a> &amp;&#160;</td>
          <td class="paramname"><em>psf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>standardP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>From voxel volumes, off-centered tilt axis. This routine projects a volume that is rotating (angle) degrees around the axis defined by the two angles (axisRot,axisTilt) and that passes through the point raxis. The projection can be further inplane rotated and shifted through the parameters (inplaneRot) and (rinplane).</p>
<p>All vectors involved must be 3D.</p>
<p>The projection model is rproj=H Rinplane Raxis r + Rinplane (I-Raxis) raxis + rinplane</p>
<p>Where Raxis is the 3D rotation matrix given by the axis and the angle.</p>
<p>Off-centered not implemented. Rotations are around volume center </p>
<p>Calculation of IgeoVol to optimize process </p>

<p>Definition at line <a class="el" href="project__xray_8cpp_source.html#l00215">215</a> of file <a class="el" href="project__xray_8cpp_source.html">project_xray.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;{</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">int</span> iniXdim, iniYdim, iniZdim, newXdim, newYdim, newZdim, rotXdim, rotZdim;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    iniXdim = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(<a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(phantom.iniVol));</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    iniYdim = <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(<a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(phantom.iniVol));</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    iniZdim = <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(<a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(phantom.iniVol));</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">// Projection offset in pixels</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> offsetNV(3);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    P.<a class="code" href="classImageBase.html#a3964353e84f19595f0f14fb34561e31e">getShifts</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(offsetNV), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(offsetNV), <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(offsetNV));</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">//    xOffsetN = P.Xoff()/psf.dxo;</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">//    yOffsetN = P.Yoff()/psf.dxo;</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">/* If Xdim is greater than Zdim, then as we rotate the volume the rotated Zdim must be</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">     * great enough to cover all the volume.</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">/* By now, we are going to keep it unused */</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">//    if (true)</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">//    {</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">//        double radi, theta0, theta, tilt;</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">//        radi = sqrt(iniZdim*iniZdim + iniXdim*iniXdim);</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">//        theta0 = atan2(iniZdim, iniXdim);</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">//        tilt = ((P.tilt() &lt; 90)? P.tilt(): 180 - P.tilt())* PI / 180;</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">//        rotZdim = XMIPP_MAX(ROUND(radi * sin(ABS(tilt) + ABS(theta0))), iniZdim);</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">//        rotXdim = XMIPP_MAX(ROUND(radi * cos(ABS(tilt) - ABS(theta0))), iniXdim);</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">//        rotYdim = iniYdim;</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">//        //    rotZdim = iniZdim;</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">//        //    rotXdim = iniXdim;</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">//        newXdim = rotXdim + 2*ABS(XX(offsetNV));</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">//        newYdim = iniYdim + 2*ABS(YY(offsetNV));</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">//        newZdim = rotZdim;</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">//    }</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">//    else</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    rotXdim = iniXdim;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    rotZdim = iniZdim;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    newXdim = (int)(rotXdim + 2*fabs(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(offsetNV)));</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    newYdim = (int)(iniYdim + 2*fabs(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(offsetNV)));</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    newZdim = rotZdim;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">// We set the dimensions only to obtain the values of starting X,Y,Z</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">//    phantom.rotVol.setDimensions(rotXdim, rotYdim, rotZdim, 1);</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    phantom.rotVol.setDimensions(newXdim, newYdim, newZdim, 1);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    phantom.rotVol.setXmippOrigin();</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">if</span> (psf.<a class="code" href="classXRayPSF.html#ad49274e04ac074cee0e510c3ea01b56d">verbose</a> &gt; 1)</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">if</span> (newXdim != iniXdim || newYdim != iniYdim)</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;--------------------------------&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;XrayProject::Volume_offCentered:&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;--------------------------------&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;(X,Y,Z) shifts = (&quot;</span> &lt;&lt; <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(offsetNV) &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(offsetNV) &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            &lt;&lt; <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(offsetNV) &lt;&lt; <span class="stringliteral">&quot;) um&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Image resize (Nx,Ny): (&quot;</span> &lt;&lt; iniXdim &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; iniYdim &lt;&lt; <span class="stringliteral">&quot;) --&gt; (&quot;</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            &lt;&lt; newXdim &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; newYdim &lt;&lt; <span class="stringliteral">&quot;) &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        std::cout &lt;&lt;<span class="stringliteral">&quot;yoffsetN &quot;</span>&lt;&lt; <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(offsetNV) &lt;&lt;std::endl;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        std::cout &lt;&lt;<span class="stringliteral">&quot;xoffsetN &quot;</span>&lt;&lt; <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(offsetNV) &lt;&lt;std::endl;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        std::cout &lt;&lt;<span class="stringliteral">&quot;yinit    &quot;</span> &lt;&lt; yinit  &lt;&lt;std::endl;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        std::cout &lt;&lt;<span class="stringliteral">&quot;yend     &quot;</span>    &lt;&lt; yend  &lt;&lt;std::endl;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        std::cout &lt;&lt;<span class="stringliteral">&quot;xinit    &quot;</span>   &lt;&lt; xinit  &lt;&lt;std::endl;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        std::cout &lt;&lt;<span class="stringliteral">&quot;xend     &quot;</span>    &lt;&lt; xend  &lt;&lt;std::endl;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        std::cout &lt;&lt;<span class="stringliteral">&quot;zinit    &quot;</span>   &lt;&lt; zinit  &lt;&lt;std::endl;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        std::cout &lt;&lt;<span class="stringliteral">&quot;zend     &quot;</span>    &lt;&lt; zend  &lt;&lt;std::endl;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">//    phantom.rotVol.setMmap(true);</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    phantom.rotVol.resizeNoCopy(newZdim, newYdim, newXdim);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    phantom.rotVol.setXmippOrigin();</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">// Rotate volume ....................................................</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> R, T;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(offsetNV) = 0; <span class="comment">// We are not interested in apply this Zshift</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="transformations_8cpp.html#aadef44358397c2d16a78f83fe5302964">translation3DMatrix</a>(offsetNV, T);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a>(P.<a class="code" href="classImageBase.html#a13fcf9a8cfa4f71952ec2fa8e65e1de3">rot</a>(), P.<a class="code" href="classImageBase.html#a3782bd402af72b87daaf60b1ecedac5a">tilt</a>(), P.<a class="code" href="classImageBase.html#a2a29e596597eb3fa6d1c185dfa14aa9e">psi</a>(), R, <span class="keyword">true</span>);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordtype">double</span> outside = 0; <span class="comment">//phantom.iniVol.getPixel(0,0,0,0);</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(phantom.iniVol).setXmippOrigin();</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a>(1, phantom.rotVol, <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(phantom.iniVol), T*R, <a class="code" href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a>, <a class="code" href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a>, outside);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    psf.<a class="code" href="classXRayPSF.html#ac0894fec711232bb400493f14623217d">adjustParam</a>(phantom.rotVol);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> IgeoVol, IgeoZb;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    IgeoZb.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(1, 1, <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(phantom.rotVol), <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(phantom.rotVol),<span class="keyword">false</span>);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    IgeoZb.<a class="code" href="classMultidimArray.html#a239f45b043ed7715dec4d44ceef74dce">initConstant</a>(1.);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="group__ProjectionXRProgram.html#gaaf5ec249c52c38b846dca9c3d7c17759">calculateIgeo</a>(phantom.rotVol, psf.<a class="code" href="classXRayPSF.html#a5a777d2f8a39be40df31c50aa01e82af">dzo</a>, IgeoVol, <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(standardP), IgeoZb, psf.<a class="code" href="classXRayPSF.html#a0de167fe2a9d2d1081826366ceeea600">nThr</a>, <a class="code" href="group__ProjectionXRProgram.html#gab6ca869b2467a1904a98f322868c6ba4">thMgr</a>);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="group__ProjectionXRProgram.html#gafe1526d8c158a0c0b6c423541d13070a">projectXrayVolume</a>(phantom.rotVol, IgeoVol, psf, P, NULL, <a class="code" href="group__ProjectionXRProgram.html#gab6ca869b2467a1904a98f322868c6ba4">thMgr</a>);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordtype">int</span> outXDim = <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(Xdim,iniXdim);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordtype">int</span> outYDim = <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(Ydim,iniYdim);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    P().selfWindow(-<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(outYDim/2),</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                   -<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(outXDim/2),</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                   -<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(outYDim/2) + outYDim -1,</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                   -<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(outXDim/2) + outXDim -1);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;}<span class="comment">//XrayRotateAndProjectVolumeOffCentered</span></div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gac87b223f03097d45f776b44b6aeea9f7"><div class="ttname"><a href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a></div><div class="ttdeci">#define MULTIDIM_ARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00136">multidim_array.h:136</a></div></div>
<div class="ttc" id="group__Geometry_html_gaf67a2d233e3fbf038d111a91197fa759"><div class="ttname"><a href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a></div><div class="ttdeci">void Euler_angles2matrix(T alpha, T beta, T gamma, Matrix2D&lt; T &gt; &amp;A, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00621">geometry.cpp:621</a></div></div>
<div class="ttc" id="group__ProjectionXRProgram_html_gab6ca869b2467a1904a98f322868c6ba4"><div class="ttname"><a href="group__ProjectionXRProgram.html#gab6ca869b2467a1904a98f322868c6ba4">thMgr</a></div><div class="ttdeci">ThreadManager * thMgr</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8cpp_source.html#l00083">project_xray.cpp:83</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga3cc15e5dda7c58b9cacb7eee440d6bdc"><div class="ttname"><a href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a></div><div class="ttdeci">void applyGeometry(int SplineDegree, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V2, const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V1, const Matrix2D&lt; double &gt; &amp;A, bool inv, bool wrap, std::complex&lt; double &gt; outside, MultidimArray&lt; double &gt; *BcoeffsPtr)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00517">transformations.cpp:517</a></div></div>
<div class="ttc" id="classMultidimArray_html_a239f45b043ed7715dec4d44ceef74dce"><div class="ttname"><a href="classMultidimArray.html#a239f45b043ed7715dec4d44ceef74dce">MultidimArray::initConstant</a></div><div class="ttdeci">void initConstant(T val)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04309">multidim_array.h:4309</a></div></div>
<div class="ttc" id="classImageBase_html_a3782bd402af72b87daaf60b1ecedac5a"><div class="ttname"><a href="classImageBase.html#a3782bd402af72b87daaf60b1ecedac5a">ImageBase::tilt</a></div><div class="ttdeci">double tilt(const size_t n=0) const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00296">xmipp_image_base.cpp:296</a></div></div>
<div class="ttc" id="classXRayPSF_html_a0de167fe2a9d2d1081826366ceeea600"><div class="ttname"><a href="classXRayPSF.html#a0de167fe2a9d2d1081826366ceeea600">XRayPSF::nThr</a></div><div class="ttdeci">int nThr</div><div class="ttdef"><b>Definition:</b> <a href="psf__xr_8h_source.html#l00212">psf_xr.h:212</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="classImageBase_html_a13fcf9a8cfa4f71952ec2fa8e65e1de3"><div class="ttname"><a href="classImageBase.html#a13fcf9a8cfa4f71952ec2fa8e65e1de3">ImageBase::rot</a></div><div class="ttdeci">double rot(const size_t n=0) const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00283">xmipp_image_base.cpp:283</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="transformations_8cpp_html_aadef44358397c2d16a78f83fe5302964"><div class="ttname"><a href="transformations_8cpp.html#aadef44358397c2d16a78f83fe5302964">translation3DMatrix</a></div><div class="ttdeci">template void translation3DMatrix(const Matrix1D&lt; float &gt; &amp;translation, Matrix2D&lt; float &gt; &amp;resMatrix, bool inverse)</div></div>
<div class="ttc" id="classImageBase_html_a2a29e596597eb3fa6d1c185dfa14aa9e"><div class="ttname"><a href="classImageBase.html#a2a29e596597eb3fa6d1c185dfa14aa9e">ImageBase::psi</a></div><div class="ttdeci">double psi(const size_t n=0) const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00309">xmipp_image_base.cpp:309</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="classXRayPSF_html_ad49274e04ac074cee0e510c3ea01b56d"><div class="ttname"><a href="classXRayPSF.html#ad49274e04ac074cee0e510c3ea01b56d">XRayPSF::verbose</a></div><div class="ttdeci">int verbose</div><div class="ttdoc">Switch to control verbose mode. </div><div class="ttdef"><b>Definition:</b> <a href="psf__xr_8h_source.html#l00209">psf_xr.h:209</a></div></div>
<div class="ttc" id="group__Macros_html_gac9ae6a207f10c821b06a8c0df153a7d5"><div class="ttname"><a href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a></div><div class="ttdeci">#define XMIPP_MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00181">xmipp_macros.h:181</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="transformations_8h_html_a9fbfdbc149e55def0e63127fcb558d13"><div class="ttname"><a href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a></div><div class="ttdeci">#define DONT_WRAP</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00042">transformations.h:42</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="classXRayPSF_html_ac0894fec711232bb400493f14623217d"><div class="ttname"><a href="classXRayPSF.html#ac0894fec711232bb400493f14623217d">XRayPSF::adjustParam</a></div><div class="ttdeci">void adjustParam()</div><div class="ttdoc">Calculate if a resize of the X-Y plane is needed to avoid the Nyquist Limit. </div><div class="ttdef"><b>Definition:</b> <a href="psf__xr_8cpp_source.html#l00666">psf_xr.cpp:666</a></div></div>
<div class="ttc" id="classImageBase_html_a3964353e84f19595f0f14fb34561e31e"><div class="ttname"><a href="classImageBase.html#a3964353e84f19595f0f14fb34561e31e">ImageBase::getShifts</a></div><div class="ttdeci">void getShifts(double &amp;xoff, double &amp;yoff, double &amp;zoff, const size_t n=0) const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00455">xmipp_image_base.cpp:455</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classXRayPSF_html_a5a777d2f8a39be40df31c50aa01e82af"><div class="ttname"><a href="classXRayPSF.html#a5a777d2f8a39be40df31c50aa01e82af">XRayPSF::dzo</a></div><div class="ttdeci">double dzo</div><div class="ttdoc">object space Z sampling rate </div><div class="ttdef"><b>Definition:</b> <a href="psf__xr_8h_source.html#l00199">psf_xr.h:199</a></div></div>
<div class="ttc" id="transformations_8h_html_a3a4a05e15fc1cc8a66159304e4c33eb1"><div class="ttname"><a href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a></div><div class="ttdeci">#define IS_NOT_INV</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00041">transformations.h:41</a></div></div>
<div class="ttc" id="group__ProjectionXRProgram_html_gafe1526d8c158a0c0b6c423541d13070a"><div class="ttname"><a href="group__ProjectionXRProgram.html#gafe1526d8c158a0c0b6c423541d13070a">projectXrayVolume</a></div><div class="ttdeci">void projectXrayVolume(MultidimArray&lt; double &gt; &amp;muVol, MultidimArray&lt; double &gt; &amp;IgeoVol, XRayPSF &amp;psf, Projection &amp;P, MultidimArray&lt; double &gt; *projNorm, ThreadManager *thMgr)</div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8cpp_source.html#l00339">project_xray.cpp:339</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="group__ProjectionXRProgram_html_gaaf5ec249c52c38b846dca9c3d7c17759"><div class="ttname"><a href="group__ProjectionXRProgram.html#gaaf5ec249c52c38b846dca9c3d7c17759">calculateIgeo</a></div><div class="ttdeci">void calculateIgeo(MultidimArray&lt; double &gt; &amp;muVol, double sampling, MultidimArray&lt; double &gt; &amp;IgeoVol, MultidimArray&lt; double &gt; &amp;cumMu, MultidimArray&lt; double &gt; &amp;IgeoZb, int nThreads, ThreadManager *ThrMgr)</div><div class="ttdoc">Calculate the volume of the information of Igeometric at each plane of the phantom. </div><div class="ttdef"><b>Definition:</b> <a href="project__xray_8cpp_source.html#l00621">project_xray.cpp:621</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="gaa7d3601dfe4f1448143811e57bd9ca46"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classBarrier.html">Barrier</a>* barrier</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="project__xray_8cpp_source.html#l00082">82</a> of file <a class="el" href="project__xray_8cpp_source.html">project_xray.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="gae8b85b4f519a4945ba9ea43e9b503531"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMutex.html">Mutex</a> mutex</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="project__xray_8cpp_source.html#l00081">81</a> of file <a class="el" href="project__xray_8cpp_source.html">project_xray.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="gab6ca869b2467a1904a98f322868c6ba4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classThreadManager.html">ThreadManager</a>* thMgr</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="project__xray_8cpp_source.html#l00083">83</a> of file <a class="el" href="project__xray_8cpp_source.html">project_xray.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
