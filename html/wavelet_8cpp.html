<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Xmipp: xmipp/libraries/data/wavelet.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5bce755d3f27cf36e7d1a940cfd4182d.html">xmipp</a></li><li class="navelem"><a class="el" href="dir_29dba3f3840f20df3b04d1972e99046b.html">libraries</a></li><li class="navelem"><a class="el" href="dir_02b15c2011e26cf58f557fc966b9a0d4.html">data</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">wavelet.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="ore_2core_2bilib_2wavelet_8h_source.html">core/bilib/wavelet.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="args_8h_source.html">core/args.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="histogram_8h_source.html">core/histogram.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="xmipp__image_8h_source.html">core/xmipp_image.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="xmipp__fftw_8h_source.html">core/xmipp_fftw.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="libraries_2data_2wavelet_8h_source.html">wavelet.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="numerical__tools_8h_source.html">numerical_tools.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mask_8h_source.html">mask.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for wavelet.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="wavelet_8cpp__incl.png" border="0" usemap="#xmipp_2libraries_2data_2wavelet_8cpp" alt=""/></div>
<map name="xmipp_2libraries_2data_2wavelet_8cpp" id="xmipp_2libraries_2data_2wavelet_8cpp">
</map>
</div>
</div>
<p><a href="wavelet_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a536ed8e9cf3446976e5563c845efd9cd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wavelet_8cpp.html#a536ed8e9cf3446976e5563c845efd9cd">DWT_Scale</a>(<a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,  smax)&#160;&#160;&#160;((int)((<a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>==0)?smax-1:(<a class="el" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>((<a class="el" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="el" href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a>((double)(<a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+1))/<a class="el" href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a>(2.0))-smax)))))</td></tr>
<tr class="separator:a536ed8e9cf3446976e5563c845efd9cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa38633e5f68848a9dd49afc5366ac0cc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wavelet_8cpp.html#aa38633e5f68848a9dd49afc5366ac0cc">DWT_Quadrant1D</a>(<a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,  s,  smax)&#160;&#160;&#160;((s!=smax-1)?'1':((<a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>==0)?'0':'1'))</td></tr>
<tr class="separator:aa38633e5f68848a9dd49afc5366ac0cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8be326d13e961f1d08019c50f158e2a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wavelet_8cpp.html#aa8be326d13e961f1d08019c50f158e2a">DWT_QuadrantnD</a>(<a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,  s,  sp,  smax)&#160;&#160;&#160;((s!=sp)?'0':<a class="el" href="wavelet_8cpp.html#aa38633e5f68848a9dd49afc5366ac0cc">DWT_Quadrant1D</a>(<a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,s,smax))</td></tr>
<tr class="separator:aa8be326d13e961f1d08019c50f158e2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7aa25c1be9c69c1b6b348f56528b5f0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wavelet_8cpp.html#ae7aa25c1be9c69c1b6b348f56528b5f0">DWT_icoef1D</a>(<a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,  s,  smax)&#160;&#160;&#160;()</td></tr>
<tr class="separator:ae7aa25c1be9c69c1b6b348f56528b5f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaf95d660c27fe984d219a81c419c7ddba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#gaf95d660c27fe984d219a81c419c7ddba">Bilib_DWT</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;input, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;result, int iterations, int isign)</td></tr>
<tr class="separator:gaf95d660c27fe984d219a81c419c7ddba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5cb8eeb7258f5d05a5a9b1fdae7b2491"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga5cb8eeb7258f5d05a5a9b1fdae7b2491">set_DWT_type</a> (int DWT_type)</td></tr>
<tr class="separator:ga5cb8eeb7258f5d05a5a9b1fdae7b2491"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6da81c27c1780c116902bb6e720dc52d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga6da81c27c1780c116902bb6e720dc52d">IDWT</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;v, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;result)</td></tr>
<tr class="separator:ga6da81c27c1780c116902bb6e720dc52d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad8943a584c4fe3eafe22190effbd6c50"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#gad8943a584c4fe3eafe22190effbd6c50">DWT_lowpass2D</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;v, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;result)</td></tr>
<tr class="separator:gad8943a584c4fe3eafe22190effbd6c50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab7d31fd1de9a5f5f709bdaa36f93030e"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#gab7d31fd1de9a5f5f709bdaa36f93030e">Quadrant2D</a> (int q)</td></tr>
<tr class="separator:gab7d31fd1de9a5f5f709bdaa36f93030e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0faa94d9847d48812e86f1b12ef348f2"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga0faa94d9847d48812e86f1b12ef348f2">Quadrant3D</a> (int q)</td></tr>
<tr class="separator:ga0faa94d9847d48812e86f1b12ef348f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga70aa9e2ca9a52462e739fede341d4b39"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga70aa9e2ca9a52462e739fede341d4b39">Get_Scale_Quadrant</a> (int size_x, int <a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, int &amp;scale, std::string &amp;quadrant)</td></tr>
<tr class="separator:ga70aa9e2ca9a52462e739fede341d4b39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5c65dfc02483da15312800eeb3f8b89b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga5c65dfc02483da15312800eeb3f8b89b">Get_Scale_Quadrant</a> (int size_x, int size_y, int <a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, int <a class="el" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, int &amp;scale, std::string &amp;quadrant)</td></tr>
<tr class="separator:ga5c65dfc02483da15312800eeb3f8b89b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaae9117cdf458df110d3e3158b9866ddc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#gaae9117cdf458df110d3e3158b9866ddc">Get_Scale_Quadrant</a> (int size_x, int size_y, int size_z, int <a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, int <a class="el" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, int <a class="el" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>, int &amp;scale, std::string &amp;quadrant)</td></tr>
<tr class="separator:gaae9117cdf458df110d3e3158b9866ddc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga87edb7b030a5b4f23e7deae8fd10d5fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga87edb7b030a5b4f23e7deae8fd10d5fd">clean_quadrant2D</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, int scale, const std::string &amp;quadrant)</td></tr>
<tr class="separator:ga87edb7b030a5b4f23e7deae8fd10d5fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab6cadb2b7dc1f584fa7a21325afce42d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#gab6cadb2b7dc1f584fa7a21325afce42d">clean_quadrant3D</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, int scale, const std::string &amp;quadrant)</td></tr>
<tr class="separator:gab6cadb2b7dc1f584fa7a21325afce42d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7ef836dca787274c0373a761b81fe1a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga7ef836dca787274c0373a761b81fe1a2">soft_thresholding</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, double th)</td></tr>
<tr class="separator:ga7ef836dca787274c0373a761b81fe1a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9aa764f54f159cea5c74f5f5197eabf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wavelet_8cpp.html#ac9aa764f54f159cea5c74f5f5197eabf">adaptive_soft_thresholding_block2D</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, int scale, const std::string &amp;quadrant, double sigma)</td></tr>
<tr class="separator:ac9aa764f54f159cea5c74f5f5197eabf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15dff8de7870f9015b077ab8a926993f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wavelet_8cpp.html#a15dff8de7870f9015b077ab8a926993f">compute_noise_power</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I)</td></tr>
<tr class="separator:a15dff8de7870f9015b077ab8a926993f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad7bc4d37d37162733246058d13c67a15"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#gad7bc4d37d37162733246058d13c67a15">adaptive_soft_thresholding2D</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, int scale)</td></tr>
<tr class="separator:gad7bc4d37d37162733246058d13c67a15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3dc33f1f3c3aafa00e7ef0f54ebc4e58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga3dc33f1f3c3aafa00e7ef0f54ebc4e58">DWT_keep_central_part</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, double R)</td></tr>
<tr class="separator:ga3dc33f1f3c3aafa00e7ef0f54ebc4e58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac03b7215e7a3c5ed2a314bc96f709191"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wavelet_8cpp.html#ac03b7215e7a3c5ed2a314bc96f709191">DWT_Bijaoui_denoise_LL2D</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;WI, int scale, const std::string &amp;orientation, double <a class="el" href="image__find__center_8cpp.html#a22f64139a5ad2efe7d615cbf014e88d5">mu</a>, double S, double N)</td></tr>
<tr class="separator:ac03b7215e7a3c5ed2a314bc96f709191"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43a3b141e5b0d9d8cc445394e80943b5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wavelet_8cpp.html#a43a3b141e5b0d9d8cc445394e80943b5">DWT_Bijaoui_denoise_LL3D</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;WI, int scale, const std::string &amp;orientation, double <a class="el" href="image__find__center_8cpp.html#a22f64139a5ad2efe7d615cbf014e88d5">mu</a>, double S, double N)</td></tr>
<tr class="separator:a43a3b141e5b0d9d8cc445394e80943b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a069185c6e489066fd85f3d047d635f2c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wavelet_8cpp.html#a069185c6e489066fd85f3d047d635f2c">bayesian_solve_eq_system</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="cuda__basic__math_8h.html#a97ed7d326ec1c05bdd2dc3bb1f1adbeb">power</a>, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;Ncoefs, double SNR0, double SNRF, double powerI, double power_rest, bool white_noise, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;estimatedS)</td></tr>
<tr class="separator:a069185c6e489066fd85f3d047d635f2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga39537529673de4a9f59eef92b0a7566a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga39537529673de4a9f59eef92b0a7566a">bayesian_wiener_filtering2D</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;WI, int allowed_scale, double SNR0, double SNRF, bool white_noise, int tell, bool denoise)</td></tr>
<tr class="separator:ga39537529673de4a9f59eef92b0a7566a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaea47bb1e655d9b5cf0beb1e7efb177f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#gaea47bb1e655d9b5cf0beb1e7efb177f8">bayesian_wiener_filtering2D</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;WI, int allowed_scale, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;estimatedS)</td></tr>
<tr class="separator:gaea47bb1e655d9b5cf0beb1e7efb177f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5375a4011e66bb37f9e6e636e05e1f5f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga5375a4011e66bb37f9e6e636e05e1f5f">bayesian_wiener_filtering3D</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;WI, int allowed_scale, double SNR0, double SNRF, bool white_noise, int tell, bool denoise)</td></tr>
<tr class="separator:ga5375a4011e66bb37f9e6e636e05e1f5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga65e0a5f8c712feea7cd4f83e0ade9996"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga65e0a5f8c712feea7cd4f83e0ade9996">bayesian_wiener_filtering3D</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;WI, int allowed_scale, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;estimatedS)</td></tr>
<tr class="separator:ga65e0a5f8c712feea7cd4f83e0ade9996"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4b7cad67c1ce07b14f17b03089b1bdad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga4b7cad67c1ce07b14f17b03089b1bdad">phaseCongMono</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Ph, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Or, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Energy, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;lowPass, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Radius, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;H, int nScale, double minWaveLength, double <a class="el" href="image__operate_8cpp.html#aea075da3cfca2b6f88b09cd441a6dc5e">mult</a>, double sigmaOnf)</td></tr>
<tr class="separator:ga4b7cad67c1ce07b14f17b03089b1bdad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ae7aa25c1be9c69c1b6b348f56528b5f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7aa25c1be9c69c1b6b348f56528b5f0">&#9670;&nbsp;</a></span>DWT_icoef1D</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DWT_icoef1D</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">smax&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wavelet_8cpp_source.html#l00246">246</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>

</div>
</div>
<a id="aa38633e5f68848a9dd49afc5366ac0cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa38633e5f68848a9dd49afc5366ac0cc">&#9670;&nbsp;</a></span>DWT_Quadrant1D</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DWT_Quadrant1D</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">smax&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;((s!=smax-1)?'1':((<a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>==0)?'0':'1'))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wavelet_8cpp_source.html#l00243">243</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>

</div>
</div>
<a id="aa8be326d13e961f1d08019c50f158e2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8be326d13e961f1d08019c50f158e2a">&#9670;&nbsp;</a></span>DWT_QuadrantnD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DWT_QuadrantnD</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">sp, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">smax&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;((s!=sp)?'0':<a class="el" href="wavelet_8cpp.html#aa38633e5f68848a9dd49afc5366ac0cc">DWT_Quadrant1D</a>(<a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,s,smax))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wavelet_8cpp_source.html#l00244">244</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>

</div>
</div>
<a id="a536ed8e9cf3446976e5563c845efd9cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a536ed8e9cf3446976e5563c845efd9cd">&#9670;&nbsp;</a></span>DWT_Scale</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DWT_Scale</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">smax&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;((int)((<a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>==0)?smax-1:(<a class="el" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>((<a class="el" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="el" href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a>((double)(<a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+1))/<a class="el" href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a>(2.0))-smax)))))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wavelet_8cpp_source.html#l00242">242</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac9aa764f54f159cea5c74f5f5197eabf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9aa764f54f159cea5c74f5f5197eabf">&#9670;&nbsp;</a></span>adaptive_soft_thresholding_block2D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adaptive_soft_thresholding_block2D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>quadrant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wavelet_8cpp_source.html#l00321">321</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;{</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">// Compute block variance</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a> corner1(2), corner2(2);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> r(2);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a>(scale, I, quadrant,</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                   <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2));</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a>, avg, stddev;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    I.<a class="code" href="classMultidimArray.html#ae9bd257abe5fd4fea6839fab62305f55">computeStats</a>(avg, stddev, dummy, dummy, corner1, corner2);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">// Now denoise</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordtype">double</span> th = sigma * sigma / stddev;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a366fce7e331049c17c918db413f1f471">FOR_ALL_ELEMENTS_IN_ARRAY2D_BETWEEN</a>(corner1, corner2)</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(I(r)) &gt; th)</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <span class="keywordflow">if</span> (I(r) &gt; 0)</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                I(r) -= th;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                I(r) += th;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            I(r) = 0;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_ae9bd257abe5fd4fea6839fab62305f55"><div class="ttname"><a href="classMultidimArray.html#ae9bd257abe5fd4fea6839fab62305f55">MultidimArray::computeStats</a></div><div class="ttdeci">void computeStats(double &amp;avg, double &amp;stddev, T &amp;minval, T &amp;maxval) const</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01791">multidim_array.h:1791</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00085">matrix1d.h:85</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad03d014386c050f947b2903e44f3b383"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a></div><div class="ttdeci">double dummy</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04653">numerical_recipes.cpp:4653</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00093">matrix1d.h:93</a></div></div>
<div class="ttc" id="group__Wavelets_html_gaf3291e2f171b751e81d86aaef7d24541"><div class="ttname"><a href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a></div><div class="ttdeci">void SelectDWTBlock(int scale, const MultidimArray&lt; T &gt; &amp;I, const std::string &amp;quadrant, int &amp;x1, int &amp;x2)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00134">wavelet.h:134</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; int &gt;</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a366fce7e331049c17c918db413f1f471"><div class="ttname"><a href="multidim__array__base_8h.html#a366fce7e331049c17c918db413f1f471">FOR_ALL_ELEMENTS_IN_ARRAY2D_BETWEEN</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D_BETWEEN(corner1, corner2)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00472">multidim_array_base.h:472</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a069185c6e489066fd85f3d047d635f2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a069185c6e489066fd85f3d047d635f2c">&#9670;&nbsp;</a></span>bayesian_solve_eq_system()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bayesian_solve_eq_system </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>power</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Ncoefs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>SNR0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>SNRF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>powerI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>power_rest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>white_noise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>estimatedS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wavelet_8cpp_source.html#l00476">476</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;{</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordtype">int</span> scale_dim = power.<a class="code" href="classMatrix1D.html#afee3e8e4391cb2a57591a97895e6988e">size</a>();</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> A;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordtype">int</span> extra_constraints = 0;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordflow">if</span> (white_noise)</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        extra_constraints += (scale_dim - 1);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    A.<a class="code" href="classMatrix2D.html#a35921c37b27282bac3b3868cce8feb26">initZeros</a>(2*(scale_dim - 1) + 2*scale_dim + 2 + extra_constraints, 2*scale_dim);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1;<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; scale_dim;<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        A(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1) = 1;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        A(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = -1;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        A(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1 + scale_dim - 1, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1 + scale_dim) = 1;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        A(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1 + scale_dim - 1, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + scale_dim) = -1;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0;<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 2*scale_dim;<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        A(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 2*(scale_dim - 1), <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = -1;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="comment">// Constraints on the SNR</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> aux0coefs(scale_dim);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 0;<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; scale_dim;<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        aux0coefs(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = Ncoefs(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) * SNR0;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> auxFcoefs(scale_dim);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 0;<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; scale_dim;<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        auxFcoefs(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = Ncoefs(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) * SNRF;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="comment">//initializing the second last row of A</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 0;<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; scale_dim;<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        A(2*(scale_dim - 1) + 2*scale_dim, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = (-1) * auxFcoefs(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = scale_dim;<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; 2*scale_dim;<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        A(2*(scale_dim - 1) + 2*scale_dim, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = Ncoefs(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - scale_dim);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="comment">//initializing the last row of A</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 0;<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; scale_dim;<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        A(2*(scale_dim - 1) + 2*scale_dim + 1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = aux0coefs(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = scale_dim;<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; 2*scale_dim;<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        A(2*(scale_dim - 1) + 2*scale_dim + 1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = (-1) * Ncoefs(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - scale_dim);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="comment">// White noise constraints</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">if</span> (white_noise)</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; scale_dim - 1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        {</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            A(A.<a class="code" href="classMatrix2D.html#a94ad82d742f99604da666ec5c702c727">mdimy</a> - (scale_dim - 1) + <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)  = -1.01;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            A(A.<a class="code" href="classMatrix2D.html#a94ad82d742f99604da666ec5c702c727">mdimy</a> - (scale_dim - 1) + <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1) = 1;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="comment">//initialize the matrix b</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>(<a class="code" href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a>(A));</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">// Initialize Aeq matrix</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> Aeq;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    Aeq.<a class="code" href="classMatrix2D.html#a35921c37b27282bac3b3868cce8feb26">initZeros</a>(1, 2*scale_dim);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 0;<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; scale_dim;<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        Aeq(0, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = Ncoefs(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        Aeq(0, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + scale_dim) = Ncoefs(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    }</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">//initialize beq matrix</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> beq;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    beq.<a class="code" href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">initZeros</a>(1);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    beq(0) = powerI - power_rest;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">//initialization of Matrix C (cost matrix)</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> C;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    C.<a class="code" href="classMatrix2D.html#a35921c37b27282bac3b3868cce8feb26">initZeros</a>(scale_dim, 2*scale_dim);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 0;<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; scale_dim;<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    {</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        C(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 1;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        C(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + scale_dim) = 1;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    }</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">// initialise the estimatedS which will contain the solution vector</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    estimatedS.<a class="code" href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">initZeros</a>(2*scale_dim);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">//Writing the matrices to ASCII files for comparing with matlab</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    C.<a class="code" href="classMatrix2D.html#af238e5151690362d87396628207b949b">write</a>(<span class="stringliteral">&quot;./matrices/C.txt&quot;</span>);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    power.<a class="code" href="classMatrix1D.html#af857f22d3df6443bd423a49894f0f7a4">write</a>(<span class="stringliteral">&quot;./matrices/power.txt&quot;</span>);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    A.<a class="code" href="classMatrix2D.html#af238e5151690362d87396628207b949b">write</a>(<span class="stringliteral">&quot;./matrices/A.txt&quot;</span>);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>.write(<span class="stringliteral">&quot;./matrices/b.txt&quot;</span>);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    Aeq.<a class="code" href="classMatrix2D.html#af238e5151690362d87396628207b949b">write</a>(<span class="stringliteral">&quot;./matrices/Aeq.txt&quot;</span>);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    beq.<a class="code" href="classMatrix1D.html#af857f22d3df6443bd423a49894f0f7a4">write</a>(<span class="stringliteral">&quot;./matrices/beq.txt&quot;</span>);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Equation system Cx=d\n&quot;</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;C=\n&quot;</span> &lt;&lt; C &lt;&lt; std::endl</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;d=&quot;</span> &lt;&lt; (power / Ncoefs).<a class="code" href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a>() &lt;&lt; std::endl</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Constraints\n&quot;</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Ax&lt;=b\n&quot;</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;A=\n&quot;</span> &lt;&lt; A &lt;&lt; std::endl</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;b=&quot;</span> &lt;&lt; <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>.transpose() &lt;&lt; std::endl</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Aeq x=beq\n&quot;</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Aeq=\n&quot;</span> &lt;&lt; Aeq &lt;&lt; std::endl</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;beq=&quot;</span> &lt;&lt; beq.<a class="code" href="classMatrix1D.html#a028505ebdeaf6f62d884c31dcd5127a8">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="comment">// Solve the system</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#a8ddb3706f7f0da780fedfff3731d60e7">bl</a>, <a class="code" href="numerical__recipes_8cpp.html#ab2cca56863d1f94c7e54807e4506ffde">bu</a>;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <a class="code" href="group__NumericalTools.html#gaaff06baf46401c09d999ae2dc0971a1f">leastSquare</a>(C, power / Ncoefs, A, <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, Aeq, beq, bl, bu, estimatedS);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="comment">// COSS</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    estimatedS /= 2;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;scale_dim :: &quot;</span> &lt;&lt; scale_dim &lt;&lt; std::endl;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;--------estimatedS -------- \n&quot;</span>;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    std::cout &lt;&lt; estimatedS;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;--------------------------- \n&quot;</span>;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Inequality constraints agreement&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    &lt;&lt; (A*estimatedS).<a class="code" href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Equality constraints agreement&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    &lt;&lt; (Aeq*estimatedS).<a class="code" href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Goal function value: &quot;</span> &lt;&lt; (C*estimatedS).<a class="code" href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;}</div><div class="ttc" id="group__Matrices_html_ga43e28f6079b3652588d5b76ff199ff1e"><div class="ttname"><a href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a></div><div class="ttdeci">#define MAT_YSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00124">matrix2d.h:124</a></div></div>
<div class="ttc" id="classMatrix1D_html_afee3e8e4391cb2a57591a97895e6988e"><div class="ttname"><a href="classMatrix1D.html#afee3e8e4391cb2a57591a97895e6988e">Matrix1D::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00508">matrix1d.h:508</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a8ddb3706f7f0da780fedfff3731d60e7"><div class="ttname"><a href="numerical__recipes_8cpp.html#a8ddb3706f7f0da780fedfff3731d60e7">bl</a></div><div class="ttdeci">double * bl</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04432">numerical_recipes.cpp:4432</a></div></div>
<div class="ttc" id="classMatrix1D_html_af857f22d3df6443bd423a49894f0f7a4"><div class="ttname"><a href="classMatrix1D.html#af857f22d3df6443bd423a49894f0f7a4">Matrix1D::write</a></div><div class="ttdeci">void write(const FileName &amp;fn) const</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8cpp_source.html#l00775">matrix1d.cpp:775</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="classMatrix1D_html_a028505ebdeaf6f62d884c31dcd5127a8"><div class="ttname"><a href="classMatrix1D.html#a028505ebdeaf6f62d884c31dcd5127a8">Matrix1D::transpose</a></div><div class="ttdeci">Matrix1D&lt; T &gt; transpose() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8cpp_source.html#l00631">matrix1d.cpp:631</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab2cca56863d1f94c7e54807e4506ffde"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab2cca56863d1f94c7e54807e4506ffde">bu</a></div><div class="ttdeci">double * bu</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04432">numerical_recipes.cpp:4432</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af090b2fbbd2916bfb2e493c5162969d6"><div class="ttname"><a href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a></div><div class="ttdeci">doublereal * b</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02248">numerical_recipes.cpp:2248</a></div></div>
<div class="ttc" id="primitive__FST_8cpp_html_af9ecdf0e10481a405f601d27aafd8599"><div class="ttname"><a href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a></div><div class="ttdeci">void transpose(double *array, int size)</div><div class="ttdef"><b>Definition:</b> <a href="primitive__FST_8cpp_source.html#l00121">primitive_FST.cpp:121</a></div></div>
<div class="ttc" id="classMatrix2D_html_a94ad82d742f99604da666ec5c702c727"><div class="ttname"><a href="classMatrix2D.html#a94ad82d742f99604da666ec5c702c727">Matrix2D::mdimy</a></div><div class="ttdeci">size_t mdimy</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00413">matrix2d.h:413</a></div></div>
<div class="ttc" id="classMatrix1D_html_a203e2128d65fd2d51dc764f5e7c52a63"><div class="ttname"><a href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">Matrix1D::initZeros</a></div><div class="ttdeci">void initZeros()</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00592">matrix1d.h:592</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classMatrix2D_html_af238e5151690362d87396628207b949b"><div class="ttname"><a href="classMatrix2D.html#af238e5151690362d87396628207b949b">Matrix2D::write</a></div><div class="ttdeci">void write(const FileName &amp;fn) const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l00113">matrix2d.cpp:113</a></div></div>
<div class="ttc" id="classMatrix2D_html_a35921c37b27282bac3b3868cce8feb26"><div class="ttname"><a href="classMatrix2D.html#a35921c37b27282bac3b3868cce8feb26">Matrix2D::initZeros</a></div><div class="ttdeci">void initZeros()</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00626">matrix2d.h:626</a></div></div>
<div class="ttc" id="group__NumericalTools_html_gaaff06baf46401c09d999ae2dc0971a1f"><div class="ttname"><a href="group__NumericalTools.html#gaaff06baf46401c09d999ae2dc0971a1f">leastSquare</a></div><div class="ttdeci">void leastSquare(const Matrix2D&lt; double &gt; &amp;C, const Matrix1D&lt; double &gt; &amp;d, const Matrix2D&lt; double &gt; &amp;A, const Matrix1D&lt; double &gt; &amp;b, const Matrix2D&lt; double &gt; &amp;Aeq, const Matrix1D&lt; double &gt; &amp;beq, Matrix1D&lt; double &gt; &amp;bl, Matrix1D&lt; double &gt; &amp;bu, Matrix1D&lt; double &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__tools_8cpp_source.html#l00327">numerical_tools.cpp:327</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a15dff8de7870f9015b077ab8a926993f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15dff8de7870f9015b077ab8a926993f">&#9670;&nbsp;</a></span>compute_noise_power()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double compute_noise_power </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wavelet_8cpp_source.html#l00346">346</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;{</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">// Compute histogram of the absolute values of the DWT coefficients</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// at scale=0</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <a class="code" href="classHistogram1D.html">Histogram1D</a> hist;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordtype">double</span> avg, stddev, min_val=0., max_val=0.;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    I.<a class="code" href="classMultidimArray.html#ae9bd257abe5fd4fea6839fab62305f55">computeStats</a>(avg, stddev, min_val, max_val);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    hist.<a class="code" href="classHistogram1D.html#ac40dd6aedb6ee53598b7bcc05ab27db5">init</a>(0, <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(min_val), <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(max_val)), 100);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a> corner1(2), corner2(2);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> r(2);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a>(0, I, <span class="stringliteral">&quot;01&quot;</span>,</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                   <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2));</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a366fce7e331049c17c918db413f1f471">FOR_ALL_ELEMENTS_IN_ARRAY2D_BETWEEN</a>(corner1, corner2)</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    {</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordtype">double</span> value=fabs(I(r));</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <a class="code" href="histogram_8h.html#a259a7773c997783e3a2a141038d93e40">INSERT_VALUE</a>(hist,value);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a>(0, I, <span class="stringliteral">&quot;10&quot;</span>,</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                   <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2));</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a366fce7e331049c17c918db413f1f471">FOR_ALL_ELEMENTS_IN_ARRAY2D_BETWEEN</a>(corner1, corner2)</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordtype">double</span> value=fabs(I(r));</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <a class="code" href="histogram_8h.html#a259a7773c997783e3a2a141038d93e40">INSERT_VALUE</a>(hist,value);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a>(0, I, <span class="stringliteral">&quot;11&quot;</span>,</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                   <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2));</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a366fce7e331049c17c918db413f1f471">FOR_ALL_ELEMENTS_IN_ARRAY2D_BETWEEN</a>(corner1, corner2)</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    {</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keywordtype">double</span> value=fabs(I(r));</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <a class="code" href="histogram_8h.html#a259a7773c997783e3a2a141038d93e40">INSERT_VALUE</a>(hist,value);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    }</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">return</span> hist.<a class="code" href="classHistogram1D.html#a2ffd1bbd9aa8bd3807d09c7b352a1ee3">percentil</a>(50) / 0.6745;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;}</div><div class="ttc" id="group__Macros_html_gae0a4180e923e3ffca3989e20e441aa3c"><div class="ttname"><a href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a></div><div class="ttdeci">#define XMIPP_MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00193">xmipp_macros.h:193</a></div></div>
<div class="ttc" id="histogram_8h_html_a259a7773c997783e3a2a141038d93e40"><div class="ttname"><a href="histogram_8h.html#a259a7773c997783e3a2a141038d93e40">INSERT_VALUE</a></div><div class="ttdeci">#define INSERT_VALUE(histogram, value)</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00205">histogram.h:205</a></div></div>
<div class="ttc" id="classMultidimArray_html_ae9bd257abe5fd4fea6839fab62305f55"><div class="ttname"><a href="classMultidimArray.html#ae9bd257abe5fd4fea6839fab62305f55">MultidimArray::computeStats</a></div><div class="ttdeci">void computeStats(double &amp;avg, double &amp;stddev, T &amp;minval, T &amp;maxval) const</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01791">multidim_array.h:1791</a></div></div>
<div class="ttc" id="classHistogram1D_html"><div class="ttname"><a href="classHistogram1D.html">Histogram1D</a></div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00121">histogram.h:121</a></div></div>
<div class="ttc" id="classHistogram1D_html_a2ffd1bbd9aa8bd3807d09c7b352a1ee3"><div class="ttname"><a href="classHistogram1D.html#a2ffd1bbd9aa8bd3807d09c7b352a1ee3">Histogram1D::percentil</a></div><div class="ttdeci">double percentil(double percent_mass)</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00160">histogram.cpp:160</a></div></div>
<div class="ttc" id="classHistogram1D_html_ac40dd6aedb6ee53598b7bcc05ab27db5"><div class="ttname"><a href="classHistogram1D.html#ac40dd6aedb6ee53598b7bcc05ab27db5">Histogram1D::init</a></div><div class="ttdeci">void init(double min_val, double max_val, int n_steps)</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00071">histogram.cpp:71</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00085">matrix1d.h:85</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00093">matrix1d.h:93</a></div></div>
<div class="ttc" id="group__Wavelets_html_gaf3291e2f171b751e81d86aaef7d24541"><div class="ttname"><a href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a></div><div class="ttdeci">void SelectDWTBlock(int scale, const MultidimArray&lt; T &gt; &amp;I, const std::string &amp;quadrant, int &amp;x1, int &amp;x2)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00134">wavelet.h:134</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; int &gt;</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a366fce7e331049c17c918db413f1f471"><div class="ttname"><a href="multidim__array__base_8h.html#a366fce7e331049c17c918db413f1f471">FOR_ALL_ELEMENTS_IN_ARRAY2D_BETWEEN</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D_BETWEEN(corner1, corner2)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00472">multidim_array_base.h:472</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac03b7215e7a3c5ed2a314bc96f709191"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac03b7215e7a3c5ed2a314bc96f709191">&#9670;&nbsp;</a></span>DWT_Bijaoui_denoise_LL2D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DWT_Bijaoui_denoise_LL2D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>WI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>orientation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wavelet_8cpp_source.html#l00414">414</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;{</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a> <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>(2), <a class="code" href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>(2), r(2);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a>(scale, WI, orientation, <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(<a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(<a class="code" href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(<a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(<a class="code" href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>));</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordtype">double</span> SN = S + N;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordtype">double</span> S_N = S / SN;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">if</span> (S &lt; 1e-6 &amp;&amp; N &lt; 1e-6)</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    {</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a366fce7e331049c17c918db413f1f471">FOR_ALL_ELEMENTS_IN_ARRAY2D_BETWEEN</a>(<a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>, <a class="code" href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>)</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(WI,<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r),<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r)) = 0;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    }</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordtype">double</span> iSN=1.0/SN;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keywordtype">double</span> iN=1.0/N;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a366fce7e331049c17c918db413f1f471">FOR_ALL_ELEMENTS_IN_ARRAY2D_BETWEEN</a>(<a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>, <a class="code" href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>)</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        {</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            <span class="keywordtype">double</span> &amp;WI_r=<a class="code" href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(WI,<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r),<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r));</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> = WI_r;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <span class="keywordtype">double</span> ymu = y - <a class="code" href="image__find__center_8cpp.html#a22f64139a5ad2efe7d615cbf014e88d5">mu</a>;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <span class="keywordtype">double</span> ymu2 = -0.5 * ymu * ymu;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            <span class="keywordtype">double</span> expymu2SN = exp(ymu2 * iSN);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <span class="keywordtype">double</span> den = exp(ymu2 * iN) + expymu2SN;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            <span class="keywordflow">if</span> (den &gt; 1e-10)</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                WI_r *= S_N * expymu2SN / den;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        }</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    }</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;}</div><div class="ttc" id="multidim__array__base_8h_html_a9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00354">multidim_array_base.h:354</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad919bbce6f061400a0bc5231a9cd1621"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a></div><div class="ttdeci">static double * y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08507">numerical_recipes.cpp:8507</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00085">matrix1d.h:85</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a8f613ddaea2048e3471a1f4f04ba4b79"><div class="ttname"><a href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a></div><div class="ttdeci">#define xF</div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00093">matrix1d.h:93</a></div></div>
<div class="ttc" id="group__Wavelets_html_gaf3291e2f171b751e81d86aaef7d24541"><div class="ttname"><a href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a></div><div class="ttdeci">void SelectDWTBlock(int scale, const MultidimArray&lt; T &gt; &amp;I, const std::string &amp;quadrant, int &amp;x1, int &amp;x2)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00134">wavelet.h:134</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; int &gt;</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a22f64139a5ad2efe7d615cbf014e88d5"><div class="ttname"><a href="image__find__center_8cpp.html#a22f64139a5ad2efe7d615cbf014e88d5">mu</a></div><div class="ttdeci">int mu</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00056">image_find_center.cpp:56</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a366fce7e331049c17c918db413f1f471"><div class="ttname"><a href="multidim__array__base_8h.html#a366fce7e331049c17c918db413f1f471">FOR_ALL_ELEMENTS_IN_ARRAY2D_BETWEEN</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D_BETWEEN(corner1, corner2)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00472">multidim_array_base.h:472</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a43a3b141e5b0d9d8cc445394e80943b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43a3b141e5b0d9d8cc445394e80943b5">&#9670;&nbsp;</a></span>DWT_Bijaoui_denoise_LL3D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DWT_Bijaoui_denoise_LL3D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>WI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>orientation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wavelet_8cpp_source.html#l00446">446</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;{</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a> <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>(3), <a class="code" href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>(3), r(3);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <a class="code" href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a>(scale, WI, orientation, <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(<a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(<a class="code" href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(<a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(<a class="code" href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>),</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                   <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(<a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>), <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(<a class="code" href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>));</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordtype">double</span> SN = S + N;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordtype">double</span> S_N = S / SN;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">if</span> (S &lt; 1e-6 &amp;&amp; N &lt; 1e-6)</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <a class="code" href="multidim__array__base_8h.html#acf49ec8e8432f65baabc829653497e12">FOR_ALL_ELEMENTS_IN_ARRAY3D_BETWEEN</a>(<a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>, <a class="code" href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>) WI(r) = 0;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    }</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    {</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <a class="code" href="multidim__array__base_8h.html#acf49ec8e8432f65baabc829653497e12">FOR_ALL_ELEMENTS_IN_ARRAY3D_BETWEEN</a>(<a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>, <a class="code" href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>)</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> = WI(r);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            <span class="keywordtype">double</span> ymu = y - <a class="code" href="image__find__center_8cpp.html#a22f64139a5ad2efe7d615cbf014e88d5">mu</a>;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <span class="keywordtype">double</span> ymu2 = -0.5 * ymu * ymu;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            <span class="keywordtype">double</span> expymu2SN = exp(ymu2 / SN);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            <span class="keywordtype">double</span> den = exp(ymu2 / N) + expymu2SN;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <span class="keywordflow">if</span> (den &gt; 1e-10)</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                WI(r) = S_N * expymu2SN / den * <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        }</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    }</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_ad919bbce6f061400a0bc5231a9cd1621"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a></div><div class="ttdeci">static double * y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08507">numerical_recipes.cpp:8507</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00085">matrix1d.h:85</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a8f613ddaea2048e3471a1f4f04ba4b79"><div class="ttname"><a href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a></div><div class="ttdeci">#define xF</div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00093">matrix1d.h:93</a></div></div>
<div class="ttc" id="group__Wavelets_html_gaf3291e2f171b751e81d86aaef7d24541"><div class="ttname"><a href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a></div><div class="ttdeci">void SelectDWTBlock(int scale, const MultidimArray&lt; T &gt; &amp;I, const std::string &amp;quadrant, int &amp;x1, int &amp;x2)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00134">wavelet.h:134</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; int &gt;</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a22f64139a5ad2efe7d615cbf014e88d5"><div class="ttname"><a href="image__find__center_8cpp.html#a22f64139a5ad2efe7d615cbf014e88d5">mu</a></div><div class="ttdeci">int mu</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00056">image_find_center.cpp:56</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00101">matrix1d.h:101</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_acf49ec8e8432f65baabc829653497e12"><div class="ttname"><a href="multidim__array__base_8h.html#acf49ec8e8432f65baabc829653497e12">FOR_ALL_ELEMENTS_IN_ARRAY3D_BETWEEN</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D_BETWEEN(corner1, corner2)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00445">multidim_array_base.h:445</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
