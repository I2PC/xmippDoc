<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Xmipp: Filters</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Filters</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga95d26655a427c11f6980246d08dfc6d2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga95d26655a427c11f6980246d08dfc6d2">denoiseTVenergy</a> (double <a class="el" href="image__find__center_8cpp.html#a22f64139a5ad2efe7d615cbf014e88d5">mu</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;X, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Y, double s, double q, double <a class="el" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>, double sigmag, double <a class="el" href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a>)</td></tr>
<tr class="separator:ga95d26655a427c11f6980246d08dfc6d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa6e7ec16d48ed8b56d7182bdb3ca6bbf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gaa6e7ec16d48ed8b56d7182bdb3ca6bbf">denoiseTVgradient</a> (double <a class="el" href="image__find__center_8cpp.html#a22f64139a5ad2efe7d615cbf014e88d5">mu</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;X, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Y, double s, double q, double <a class="el" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>, double sigmag, double <a class="el" href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a>, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;gradientI)</td></tr>
<tr class="separator:gaa6e7ec16d48ed8b56d7182bdb3ca6bbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga984ebe4f19447b7fe6e0ceaf1c70e2df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga984ebe4f19447b7fe6e0ceaf1c70e2df">denoiseTVproj</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;X, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Y, double <a class="el" href="numerical__recipes_8cpp.html#aca81c35c21e3a5f7f3a8d24504e76664">theta</a>, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;dold)</td></tr>
<tr class="separator:ga984ebe4f19447b7fe6e0ceaf1c70e2df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1f9ae594e89b728ac95ed415c00f937d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga1f9ae594e89b728ac95ed415c00f937d">denoiseTVFilter</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a9459fc814da4e9b187efc77baecf1c07">xnew</a>, int maxIter)</td></tr>
<tr class="separator:ga1f9ae594e89b728ac95ed415c00f937d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga11b22ba5fdb8431cb8c534ae4a91d554"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga11b22ba5fdb8431cb8c534ae4a91d554">substractBackgroundPlane</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I)</td></tr>
<tr class="separator:ga11b22ba5fdb8431cb8c534ae4a91d554"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa6c14e5ee97aee4c8c4a0db657d610e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gaa6c14e5ee97aee4c8c4a0db657d610e0">substractBackgroundRollingBall</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, int radius)</td></tr>
<tr class="separator:gaa6c14e5ee97aee4c8c4a0db657d610e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad6a9f8505bb986b25457d7e4b91819d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gad6a9f8505bb986b25457d7e4b91819d7">detectBackground</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;vol, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;mask, double alpha, double &amp;final_mean)</td></tr>
<tr class="separator:gad6a9f8505bb986b25457d7e4b91819d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga74734334175800271ab600d627beb04d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga74734334175800271ab600d627beb04d">contrastEnhancement</a> (<a class="el" href="classImage.html">Image</a>&lt; double &gt; *I)</td></tr>
<tr class="separator:ga74734334175800271ab600d627beb04d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa67ede8a062ce8e0c34b4323bb2ca082"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gaa67ede8a062ce8e0c34b4323bb2ca082">regionGrowing2D</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I_in, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I_out, int <a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, int <a class="el" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, float stop_colour=1, float filling_colour=1, bool less=true, int neighbourhood=8)</td></tr>
<tr class="separator:gaa67ede8a062ce8e0c34b4323bb2ca082"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaedfae28239982fe610a700b1365a919f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gaedfae28239982fe610a700b1365a919f">distanceTransform</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;<a class="el" href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a>, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;out, bool wrap=false)</td></tr>
<tr class="separator:gaedfae28239982fe610a700b1365a919f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga206a93c383ad7f6ba43c67f18486cc21"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga206a93c383ad7f6ba43c67f18486cc21">labelImage2D</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;label, int neighbourhood=8)</td></tr>
<tr class="separator:ga206a93c383ad7f6ba43c67f18486cc21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaad2c4bf9d2a76b096825a3c7b9e23b1a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gaad2c4bf9d2a76b096825a3c7b9e23b1a">labelImage3D</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;label)</td></tr>
<tr class="separator:gaad2c4bf9d2a76b096825a3c7b9e23b1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0c5d971c2f1b8bfc8b21c70e3956fef2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga0c5d971c2f1b8bfc8b21c70e3956fef2">removeSmallComponents</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, int size, int neighbourhood=8)</td></tr>
<tr class="separator:ga0c5d971c2f1b8bfc8b21c70e3956fef2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga59afc9cfbaf887703547ec198600d92d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga59afc9cfbaf887703547ec198600d92d">keepBiggestComponent</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, double percentage=0, int neighbourhood=8)</td></tr>
<tr class="separator:ga59afc9cfbaf887703547ec198600d92d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac791e3efb9f9ee463b182ad5400cf748"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gac791e3efb9f9ee463b182ad5400cf748">fillBinaryObject</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, int neighbourhood=8)</td></tr>
<tr class="separator:gac791e3efb9f9ee463b182ad5400cf748"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga10453d42eeb9ec81876fc0e12bb4b978"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga10453d42eeb9ec81876fc0e12bb4b978">varianceFilter</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, int kernelSize=10, bool relative=false)</td></tr>
<tr class="separator:ga10453d42eeb9ec81876fc0e12bb4b978"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac36280d6ded9846f347577939ae33859"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gac36280d6ded9846f347577939ae33859">noisyZonesFilter</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, int kernelSize=10)</td></tr>
<tr class="separator:gac36280d6ded9846f347577939ae33859"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0d47bf9f39db4d2e7e6422f015cab5b5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga0d47bf9f39db4d2e7e6422f015cab5b5">giniCoeff</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, int varKernelSize=50)</td></tr>
<tr class="separator:ga0d47bf9f39db4d2e7e6422f015cab5b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae4711a70816fcb6f8b6f72bb1b7dc8e5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gae4711a70816fcb6f8b6f72bb1b7dc8e5">OtsuSegmentation</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V)</td></tr>
<tr class="separator:gae4711a70816fcb6f8b6f72bb1b7dc8e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad571370cecac06c79cfe09ee681c134e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gad571370cecac06c79cfe09ee681c134e">EntropySegmentation</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V)</td></tr>
<tr class="separator:gad571370cecac06c79cfe09ee681c134e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa3fef57b51522c9a6b9534ee50a3ed68"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gaa3fef57b51522c9a6b9534ee50a3ed68">EntropyOtsuSegmentation</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V, double percentil=0.05, bool binarizeVolume=true)</td></tr>
<tr class="separator:gaa3fef57b51522c9a6b9534ee50a3ed68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa17e6426905f990a4e82d73e1e0a337c"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:gaa17e6426905f990a4e82d73e1e0a337c"><td class="memTemplItemLeft" align="right" valign="top">double&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Filters.html#gaa17e6426905f990a4e82d73e1e0a337c">correlation</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask=NULL, int l=0, int <a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>=0, int q=0)</td></tr>
<tr class="separator:gaa17e6426905f990a4e82d73e1e0a337c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaddc3b1a64352caf229f19d303638cdab"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:gaddc3b1a64352caf229f19d303638cdab"><td class="memTemplItemLeft" align="right" valign="top">double&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Filters.html#gaddc3b1a64352caf229f19d303638cdab">fastMaskedCorrelation</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask)</td></tr>
<tr class="separator:gaddc3b1a64352caf229f19d303638cdab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga934a0edcfafeb2ddcb4cbe6984232174"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga934a0edcfafeb2ddcb4cbe6984232174"><td class="memTemplItemLeft" align="right" valign="top">double&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga934a0edcfafeb2ddcb4cbe6984232174">fastCorrentropy</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, double sigma, const <a class="el" href="classGaussianInterpolator.html">GaussianInterpolator</a> &amp;G)</td></tr>
<tr class="separator:ga934a0edcfafeb2ddcb4cbe6984232174"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga89a3805023d9281763bddaf660c4fa9f"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga89a3805023d9281763bddaf660c4fa9f"><td class="memTemplItemLeft" align="right" valign="top">double&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga89a3805023d9281763bddaf660c4fa9f">correntropy</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, double sigma)</td></tr>
<tr class="separator:ga89a3805023d9281763bddaf660c4fa9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga14f1374af7f27a45531362d95574a84e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga14f1374af7f27a45531362d95574a84e">bestShift</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I1, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I2, double &amp;shiftX, double &amp;shiftY, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask=NULL, int maxShift=-1)</td></tr>
<tr class="separator:ga14f1374af7f27a45531362d95574a84e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga08ab699813e8c2feb0cd4526941ec9ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga08ab699813e8c2feb0cd4526941ec9ee">bestShift</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I1, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I2, double &amp;shiftX, double &amp;shiftY, double &amp;shiftZ, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask=NULL)</td></tr>
<tr class="separator:ga08ab699813e8c2feb0cd4526941ec9ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5aae1ce90626f1f1401defcb6f5d6411"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga5aae1ce90626f1f1401defcb6f5d6411">bestNonwrappingShift</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I1, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I2, double &amp;shiftX, double &amp;shiftY, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux)</td></tr>
<tr class="separator:ga5aae1ce90626f1f1401defcb6f5d6411"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga940d7a3dda260c479d250eaf1f844057"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga940d7a3dda260c479d250eaf1f844057">bestShiftRealSpace</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I1, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I2, double &amp;shiftX, double &amp;shiftY, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask=NULL, int maxShift=5, double shiftStep=1.0)</td></tr>
<tr class="separator:ga940d7a3dda260c479d250eaf1f844057"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab9510a1208ace75e1526652928340408"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gab9510a1208ace75e1526652928340408">alignImages</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Iref, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;M, bool wrap=<a class="el" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a>)</td></tr>
<tr class="separator:gab9510a1208ace75e1526652928340408"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5d6ee7828e9b39286928b59987624bbb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga5d6ee7828e9b39286928b59987624bbb">alignImages</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Iref, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;M, bool wrap, <a class="el" href="classAlignmentAux.html">AlignmentAux</a> &amp;aux, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux2, <a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;aux3)</td></tr>
<tr class="separator:ga5d6ee7828e9b39286928b59987624bbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5442f275245a9a7c2b8ae4c2a7c6ec1d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga5442f275245a9a7c2b8ae4c2a7c6ec1d">bestRotationAroundZ</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Iref, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux, <a class="el" href="classVolumeAlignmentAux.html">VolumeAlignmentAux</a> &amp;aux2)</td></tr>
<tr class="separator:ga5442f275245a9a7c2b8ae4c2a7c6ec1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac6334758831a66345a55bcc98a59bad8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gac6334758831a66345a55bcc98a59bad8">alignImagesConsideringMirrors</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Iref, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;M, <a class="el" href="classAlignmentAux.html">AlignmentAux</a> &amp;aux, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux2, <a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;aux3, bool wrap=<a class="el" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask=NULL)</td></tr>
<tr class="separator:gac6334758831a66345a55bcc98a59bad8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafdda1375d500638b811466a209b1e7d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gafdda1375d500638b811466a209b1e7d7">estimateGaussian2D</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, double &amp;<a class="el" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, double &amp;<a class="el" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="image__find__center_8cpp.html#a22f64139a5ad2efe7d615cbf014e88d5">mu</a>, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;sigma, bool estimateMu=true, int iterations=10)</td></tr>
<tr class="separator:gafdda1375d500638b811466a209b1e7d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae47fe945bf87f1eadce22969939ffefd"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:gae47fe945bf87f1eadce22969939ffefd"><td class="memTemplItemLeft" align="right" valign="top">double&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Filters.html#gae47fe945bf87f1eadce22969939ffefd">euclidianDistance</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask=NULL)</td></tr>
<tr class="separator:gae47fe945bf87f1eadce22969939ffefd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga009d8221d8bb4238281094fed2d5de26"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga009d8221d8bb4238281094fed2d5de26"><td class="memTemplItemLeft" align="right" valign="top">double&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga009d8221d8bb4238281094fed2d5de26">mutualInformation</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, int nx=0, int ny=0, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask=NULL)</td></tr>
<tr class="separator:ga009d8221d8bb4238281094fed2d5de26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga21987af66fc45fb745dcfde4c095c95a"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga21987af66fc45fb745dcfde4c095c95a"><td class="memTemplItemLeft" align="right" valign="top">double&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga21987af66fc45fb745dcfde4c095c95a">rms</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask=NULL, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *Contributions=NULL)</td></tr>
<tr class="separator:ga21987af66fc45fb745dcfde4c095c95a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacea6e9b7dc8fc68250563b670b2f9550"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gacea6e9b7dc8fc68250563b670b2f9550">fourierBesselDecomposition</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img_in, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;m_out, double <a class="el" href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a>, double <a class="el" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a>, int k1, int k2)</td></tr>
<tr class="separator:gacea6e9b7dc8fc68250563b670b2f9550"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa2d7ee82ca1e88ae849446fb4392c484"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gaa2d7ee82ca1e88ae849446fb4392c484">harmonicDecomposition</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img_in, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;v_out)</td></tr>
<tr class="separator:gaa2d7ee82ca1e88ae849446fb4392c484"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga879cec5ab86ea8c47829ed9c3c12c133"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga879cec5ab86ea8c47829ed9c3c12c133"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga879cec5ab86ea8c47829ed9c3c12c133">medianFilter3x3</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;out)</td></tr>
<tr class="separator:ga879cec5ab86ea8c47829ed9c3c12c133"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga998cbed84978df5207b2fe4b245bf3f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga998cbed84978df5207b2fe4b245bf3f3">smoothingShah</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;surface_strength, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;edge_strength, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;W, int OuterLoops, int InnerLoops, int RefinementLoops, bool adjust_range=true)</td></tr>
<tr class="separator:ga998cbed84978df5207b2fe4b245bf3f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6d8d88ce2ecf79280b949eeddf6305bf"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga6d8d88ce2ecf79280b949eeddf6305bf">tomographicDiffusion</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;alpha, double <a class="el" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>)</td></tr>
<tr class="separator:ga6d8d88ce2ecf79280b949eeddf6305bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga38f91d2b897842c80561364893f45101"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga38f91d2b897842c80561364893f45101">rotationalInvariantMoments</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;v_out)</td></tr>
<tr class="separator:ga38f91d2b897842c80561364893f45101"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5e7945db841993a933e1383687c303bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga5e7945db841993a933e1383687c303bf">inertiaMoments</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;v_out, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a>)</td></tr>
<tr class="separator:ga5e7945db841993a933e1383687c303bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0503708238bfaf63a342376631e915c0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga0503708238bfaf63a342376631e915c0">fillTriangle</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img, int *tx, int *ty, double color)</td></tr>
<tr class="separator:ga0503708238bfaf63a342376631e915c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga10e4035c55461690348a131999433fe2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga10e4035c55461690348a131999433fe2">localThresholding</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img, double C, double dimLocal, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;result, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask=NULL)</td></tr>
<tr class="separator:ga10e4035c55461690348a131999433fe2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8552ad520aa2e2a78bcb29f7bca80f51"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga8552ad520aa2e2a78bcb29f7bca80f51">centerImageTranslationally</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux)</td></tr>
<tr class="separator:ga8552ad520aa2e2a78bcb29f7bca80f51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5265e64d6f938b25dd3c82ad9f889a30"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga5265e64d6f938b25dd3c82ad9f889a30">centerImageRotationally</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;aux)</td></tr>
<tr class="separator:ga5265e64d6f938b25dd3c82ad9f889a30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6690cfb805eb563bfb5edcfd53b13051"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga6690cfb805eb563bfb5edcfd53b13051">centerImage</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux, <a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;aux2, int Niter=10, bool limitShift=true)</td></tr>
<tr class="separator:ga6690cfb805eb563bfb5edcfd53b13051"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga952148fe1e27177ebcd5ce943191b474"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga952148fe1e27177ebcd5ce943191b474">forcePositive</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V)</td></tr>
<tr class="separator:ga952148fe1e27177ebcd5ce943191b474"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1f7a9b2af2b245a586167a1d469a2bdd"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga1f7a9b2af2b245a586167a1d469a2bdd"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga1f7a9b2af2b245a586167a1d469a2bdd">boundMedianFilter</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; char &gt; &amp;mask, int <a class="el" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>=0)</td></tr>
<tr class="separator:ga1f7a9b2af2b245a586167a1d469a2bdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf221b35f63812b98fbf7b5afc31ceb22"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:gaf221b35f63812b98fbf7b5afc31ceb22"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Filters.html#gaf221b35f63812b98fbf7b5afc31ceb22">pixelDesvFilter</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V, double thresFactor)</td></tr>
<tr class="separator:gaf221b35f63812b98fbf7b5afc31ceb22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3fa8d451a013398c53c7b655b4220c83"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga3fa8d451a013398c53c7b655b4220c83"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga3fa8d451a013398c53c7b655b4220c83">logFilter</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V, double <a class="el" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, double <a class="el" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, double <a class="el" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>)</td></tr>
<tr class="separator:ga3fa8d451a013398c53c7b655b4220c83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaab5fc6c34e0dca5113d45b65bf9e4d3d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gaab5fc6c34e0dca5113d45b65bf9e4d3d">SmoothResize</a> (<a class="el" href="xvsmooth_8cpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *srcpic8, <a class="el" href="xvsmooth_8cpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *destpic8, size_t swide, size_t shigh, size_t dwide, size_t dhigh)</td></tr>
<tr class="separator:gaab5fc6c34e0dca5113d45b65bf9e4d3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Functions for all multidimensional arrays</h2></td></tr>
<tr class="memitem:ga63cca7e01116967ff451df8b1f8b5a4e"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga63cca7e01116967ff451df8b1f8b5a4e"><td class="memTemplItemLeft" align="right" valign="top">double&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__MultidimensionalArrays.html#ga63cca7e01116967ff451df8b1f8b5a4e">correlationIndex</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask=NULL, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *Contributions=NULL)</td></tr>
<tr class="separator:ga63cca7e01116967ff451df8b1f8b5a4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gab9510a1208ace75e1526652928340408"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double alignImages </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Iref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wrap</em> = <code><a class="el" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Align two images</p>
<p>This function modifies I to be aligned with Iref. Translational and rotational alignments are both considered. The matrix transforming I into Iref is returned.</p>
<p>The function returns the correlation between the two aligned images. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02053">2053</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;{</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    <a class="code" href="classAlignmentAux.html">AlignmentAux</a> aux;</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    <a class="code" href="classCorrelationAux.html">CorrelationAux</a> aux2;</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <a class="code" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> aux3;</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="filters_8cpp.html#a36c35628e0011847e73d801180599cff">alignImages</a>(Iref, I, M, wrap, aux, aux2, aux3);</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;}</div><div class="ttc" id="filters_8cpp_html_a36c35628e0011847e73d801180599cff"><div class="ttname"><a href="filters_8cpp.html#a36c35628e0011847e73d801180599cff">alignImages</a></div><div class="ttdeci">double alignImages(const MultidimArray&lt; double &gt; &amp;Iref, const AlignmentTransforms &amp;IrefTransforms, MultidimArray&lt; double &gt; &amp;I, Matrix2D&lt; double &gt; &amp;M, bool wrap, AlignmentAux &amp;aux, CorrelationAux &amp;aux2, RotationalCorrelationAux &amp;aux3)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l01963">filters.cpp:1963</a></div></div>
<div class="ttc" id="classCorrelationAux_html"><div class="ttname"><a href="classCorrelationAux.html">CorrelationAux</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00551">xmipp_fftw.h:551</a></div></div>
<div class="ttc" id="classRotationalCorrelationAux_html"><div class="ttname"><a href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a></div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00788">polar.h:788</a></div></div>
<div class="ttc" id="classAlignmentAux_html"><div class="ttname"><a href="classAlignmentAux.html">AlignmentAux</a></div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00499">filters.h:499</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga5d6ee7828e9b39286928b59987624bbb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double alignImages </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Iref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wrap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAlignmentAux.html">AlignmentAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fast version of align two images </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02043">2043</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;{</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    Iref.checkDimension(2);</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <a class="code" href="classAlignmentTransforms.html">AlignmentTransforms</a> IrefTransforms;</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <a class="code" href="filters_8cpp.html#afb3985709c3203698f5794da11150d3d">computeAlignmentTransforms</a>(Iref,IrefTransforms, aux, aux2);</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="filters_8cpp.html#a36c35628e0011847e73d801180599cff">alignImages</a>(Iref, IrefTransforms, I, M, wrap, aux, aux2, aux3);</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;}</div><div class="ttc" id="filters_8cpp_html_a36c35628e0011847e73d801180599cff"><div class="ttname"><a href="filters_8cpp.html#a36c35628e0011847e73d801180599cff">alignImages</a></div><div class="ttdeci">double alignImages(const MultidimArray&lt; double &gt; &amp;Iref, const AlignmentTransforms &amp;IrefTransforms, MultidimArray&lt; double &gt; &amp;I, Matrix2D&lt; double &gt; &amp;M, bool wrap, AlignmentAux &amp;aux, CorrelationAux &amp;aux2, RotationalCorrelationAux &amp;aux3)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l01963">filters.cpp:1963</a></div></div>
<div class="ttc" id="filters_8cpp_html_afb3985709c3203698f5794da11150d3d"><div class="ttname"><a href="filters_8cpp.html#afb3985709c3203698f5794da11150d3d">computeAlignmentTransforms</a></div><div class="ttdeci">void computeAlignmentTransforms(const MultidimArray&lt; double &gt; &amp;I, AlignmentTransforms &amp;ITransforms, AlignmentAux &amp;aux, CorrelationAux &amp;aux2)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l01950">filters.cpp:1950</a></div></div>
<div class="ttc" id="classAlignmentTransforms_html"><div class="ttname"><a href="classAlignmentTransforms.html">AlignmentTransforms</a></div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00510">filters.h:510</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gac6334758831a66345a55bcc98a59bad8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double alignImagesConsideringMirrors </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Iref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAlignmentAux.html">AlignmentAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wrap</em> = <code><a class="el" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>mask</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Align two images considering also the mirrors</p>
<p>This function modifies I to be aligned with Iref. Translational and rotational alignments are both considered. The correlation coefficient between I transformed and Iref is returned. A mask can be supplied for computing this correlation. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02101">2101</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;{</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    <a class="code" href="classAlignmentTransforms.html">AlignmentTransforms</a> IrefTransforms;</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    <a class="code" href="filters_8cpp.html#afb3985709c3203698f5794da11150d3d">computeAlignmentTransforms</a>(Iref,IrefTransforms, aux, aux2);</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="filters_8cpp.html#acfc8d89899b538e61a9fa3c3f8955f39">alignImagesConsideringMirrors</a>(Iref, IrefTransforms, I, M, aux, aux2, aux3, wrap, mask);</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;}</div><div class="ttc" id="filters_8cpp_html_afb3985709c3203698f5794da11150d3d"><div class="ttname"><a href="filters_8cpp.html#afb3985709c3203698f5794da11150d3d">computeAlignmentTransforms</a></div><div class="ttdeci">void computeAlignmentTransforms(const MultidimArray&lt; double &gt; &amp;I, AlignmentTransforms &amp;ITransforms, AlignmentAux &amp;aux, CorrelationAux &amp;aux2)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l01950">filters.cpp:1950</a></div></div>
<div class="ttc" id="classAlignmentTransforms_html"><div class="ttname"><a href="classAlignmentTransforms.html">AlignmentTransforms</a></div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00510">filters.h:510</a></div></div>
<div class="ttc" id="filters_8cpp_html_acfc8d89899b538e61a9fa3c3f8955f39"><div class="ttname"><a href="filters_8cpp.html#acfc8d89899b538e61a9fa3c3f8955f39">alignImagesConsideringMirrors</a></div><div class="ttdeci">double alignImagesConsideringMirrors(const MultidimArray&lt; double &gt; &amp;Iref, const AlignmentTransforms &amp;IrefTransforms, MultidimArray&lt; double &gt; &amp;I, Matrix2D&lt; double &gt; &amp;M, AlignmentAux &amp;aux, CorrelationAux &amp;aux2, RotationalCorrelationAux &amp;aux3, bool wrap, const MultidimArray&lt; int &gt; *mask)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l02062">filters.cpp:2062</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga5aae1ce90626f1f1401defcb6f5d6411"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bestNonwrappingShift </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>shiftX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>shiftY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Translational search (non-wrapping)</p>
<p>This function returns the best interpolated shift for the alignment of two images. You can restrict the shift to a region defined by a mask (the maximum will be sought where the mask is 1). </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01812">1812</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;{</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    aux.<a class="code" href="classCorrelationAux.html#ad6fc21194291fb961fd936ebe3a64a35">transformer1</a>.<a class="code" href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransform</a>((<a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;)I1, aux.<a class="code" href="classCorrelationAux.html#a502e4e706f06acdbeed51c02e18752f4">FFT1</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <a class="code" href="group__Filters.html#ga5aae1ce90626f1f1401defcb6f5d6411">bestNonwrappingShift</a>(I1,aux.<a class="code" href="classCorrelationAux.html#a502e4e706f06acdbeed51c02e18752f4">FFT1</a>,I2,shiftX,shiftY,aux);</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;}</div><div class="ttc" id="classCorrelationAux_html_ad6fc21194291fb961fd936ebe3a64a35"><div class="ttname"><a href="classCorrelationAux.html#ad6fc21194291fb961fd936ebe3a64a35">CorrelationAux::transformer1</a></div><div class="ttdeci">FourierTransformer transformer1</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00555">xmipp_fftw.h:555</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Filters_html_ga5aae1ce90626f1f1401defcb6f5d6411"><div class="ttname"><a href="group__Filters.html#ga5aae1ce90626f1f1401defcb6f5d6411">bestNonwrappingShift</a></div><div class="ttdeci">void bestNonwrappingShift(const MultidimArray&lt; double &gt; &amp;I1, const MultidimArray&lt; double &gt; &amp;I2, double &amp;shiftX, double &amp;shiftY, CorrelationAux &amp;aux)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l01812">filters.cpp:1812</a></div></div>
<div class="ttc" id="classCorrelationAux_html_a502e4e706f06acdbeed51c02e18752f4"><div class="ttname"><a href="classCorrelationAux.html#a502e4e706f06acdbeed51c02e18752f4">CorrelationAux::FFT1</a></div><div class="ttdeci">MultidimArray&lt; std::complex&lt; double &gt; &gt; FFT1</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00554">xmipp_fftw.h:554</a></div></div>
<div class="ttc" id="classFourierTransformer_html_abfdc5699d3c579a26bba39ec679b5adc"><div class="ttname"><a href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransformer::FourierTransform</a></div><div class="ttdeci">void FourierTransform(T &amp;v, T1 &amp;V, bool getCopy=true)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00166">xmipp_fftw.h:166</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga5442f275245a9a7c2b8ae4c2a7c6ec1d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double bestRotationAroundZ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Iref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classVolumeAlignmentAux.html">VolumeAlignmentAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Align two volumes by applying a rotation around Z. The rotation must be applied on I to get Iref. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02263">2263</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;{</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;    Iref.checkDimension(3);</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;    I.checkDimension(3);</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    <span class="keywordflow">if</span> (!I.<a class="code" href="classMultidimArrayBase.html#a15e046b6c4b203b8a52a6acff9f1665b">sameShape</a>(Iref))</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aaba89018a8188da52ee900de49a93ed78">ERR_MULTIDIM_SIZE</a>,</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;                     <span class="stringliteral">&quot;Both volumes should be of the same shape&quot;</span>);</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    <span class="keywordtype">double</span> deltaAng = atan(2.0 / <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I));</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> v(3);</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(v) = 0;</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(v) = 0;</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(v) = 1;</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    <a class="code" href="group__Polar.html#ga191bbb2c43b0978de4379b80f81c42ad">volume_convertCartesianToCylindrical</a>(Iref, aux2.<a class="code" href="classVolumeAlignmentAux.html#a28da0ba8b50867dba7b28bb26ae487e7">IrefCyl</a>, 3, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I) / 2, 1,</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;                                         0, 2 * <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>, deltaAng, v);</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="filters_8cpp.html#a4ff4e1bd1c1d5b8af552e2d5edc86e6e">fastBestRotationAroundZ</a>(aux2.<a class="code" href="classVolumeAlignmentAux.html#a28da0ba8b50867dba7b28bb26ae487e7">IrefCyl</a>, I, aux, aux2);</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="filters_8cpp_html_a4ff4e1bd1c1d5b8af552e2d5edc86e6e"><div class="ttname"><a href="filters_8cpp.html#a4ff4e1bd1c1d5b8af552e2d5edc86e6e">fastBestRotationAroundZ</a></div><div class="ttdeci">double fastBestRotationAroundZ(const MultidimArray&lt; double &gt; &amp;IrefCyl, const MultidimArray&lt; double &gt; &amp;I, CorrelationAux &amp;aux, VolumeAlignmentAux &amp;aux2)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l02183">filters.cpp:2183</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aaba89018a8188da52ee900de49a93ed78"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aaba89018a8188da52ee900de49a93ed78">ERR_MULTIDIM_SIZE</a></div><div class="ttdoc">Incorrect MultidimArray size. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00179">xmipp_error.h:179</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="classVolumeAlignmentAux_html_a28da0ba8b50867dba7b28bb26ae487e7"><div class="ttname"><a href="classVolumeAlignmentAux.html#a28da0ba8b50867dba7b28bb26ae487e7">VolumeAlignmentAux::IrefCyl</a></div><div class="ttdeci">MultidimArray&lt; double &gt; IrefCyl</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00558">filters.h:558</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a15e046b6c4b203b8a52a6acff9f1665b"><div class="ttname"><a href="classMultidimArrayBase.html#a15e046b6c4b203b8a52a6acff9f1665b">MultidimArrayBase::sameShape</a></div><div class="ttdeci">bool sameShape(const MultidimArrayBase &amp;op) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00945">multidim_array.h:945</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="group__Polar_html_ga191bbb2c43b0978de4379b80f81c42ad"><div class="ttname"><a href="group__Polar.html#ga191bbb2c43b0978de4379b80f81c42ad">volume_convertCartesianToCylindrical</a></div><div class="ttdeci">void volume_convertCartesianToCylindrical(const MultidimArray&lt; double &gt; &amp;in, MultidimArray&lt; double &gt; &amp;out, double Rmin, double Rmax, double deltaR, float angMin, double angMax, float deltaAng, Matrix1D&lt; double &gt; &amp;axis)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8cpp_source.html#l00257">polar.cpp:257</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga14f1374af7f27a45531362d95574a84e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double bestShift </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>shiftX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>shiftY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>mask</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxShift</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Translational search</p>
<p>This function returns the best interpolated shift for the alignment of two images. You can restrict the shift to a region defined by a mask (the maximum will be sought where the mask is 1).</p>
<p>To apply these results you must shift I1 by (-shiftX,-shiftY) or I2 by (shiftX, shiftY).</p>
<p>You can limit the maximum achievable shift by using maxShift. If it is set to -1, any shift is valid.</p>
<p>The function returns the maximum correlation found. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01664">1664</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;{</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    aux.<a class="code" href="classCorrelationAux.html#ad6fc21194291fb961fd936ebe3a64a35">transformer1</a>.<a class="code" href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransform</a>((<a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;)I1, aux.<a class="code" href="classCorrelationAux.html#a502e4e706f06acdbeed51c02e18752f4">FFT1</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="filters_8cpp.html#aa3a842c1f195d82f091c896d33e4de46">bestShift</a>(I1,aux.<a class="code" href="classCorrelationAux.html#a502e4e706f06acdbeed51c02e18752f4">FFT1</a>,I2,shiftX,shiftY,aux,mask,maxShift);</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;}</div><div class="ttc" id="classCorrelationAux_html_ad6fc21194291fb961fd936ebe3a64a35"><div class="ttname"><a href="classCorrelationAux.html#ad6fc21194291fb961fd936ebe3a64a35">CorrelationAux::transformer1</a></div><div class="ttdeci">FourierTransformer transformer1</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00555">xmipp_fftw.h:555</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classCorrelationAux_html_a502e4e706f06acdbeed51c02e18752f4"><div class="ttname"><a href="classCorrelationAux.html#a502e4e706f06acdbeed51c02e18752f4">CorrelationAux::FFT1</a></div><div class="ttdeci">MultidimArray&lt; std::complex&lt; double &gt; &gt; FFT1</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00554">xmipp_fftw.h:554</a></div></div>
<div class="ttc" id="classFourierTransformer_html_abfdc5699d3c579a26bba39ec679b5adc"><div class="ttname"><a href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransformer::FourierTransform</a></div><div class="ttdeci">void FourierTransform(T &amp;v, T1 &amp;V, bool getCopy=true)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00166">xmipp_fftw.h:166</a></div></div>
<div class="ttc" id="filters_8cpp_html_aa3a842c1f195d82f091c896d33e4de46"><div class="ttname"><a href="filters_8cpp.html#aa3a842c1f195d82f091c896d33e4de46">bestShift</a></div><div class="ttdeci">template float bestShift(MultidimArray&lt; float &gt; &amp;, float &amp;, float &amp;, const MultidimArray&lt; int &gt; *, int)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga08ab699813e8c2feb0cd4526941ec9ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bestShift </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>shiftX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>shiftY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>shiftZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>mask</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Translational search (3D)</p>
<p>This function returns the best interpolated shift for the alignment of two volumes. You can restrict the shift to a region defined by a mask (the maximum will be sought where the mask is 1).</p>
<p>To apply these results you must shift I1 by (-shiftX,-shiftY,-shiftZ) or I2 by (shiftX, shiftY,shiftZ). </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01684">1684</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;{</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    I1.checkDimension(3);</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    I2.checkDimension(3);</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    <span class="keywordtype">int</span> imax, jmax, kmax, i_actual, j_actual, k_actual;</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">max</a>, xmax, ymax, zmax, sumcorr, avecorr, stdcorr, <a class="code" href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a>;</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <span class="keywordtype">bool</span> neighbourhood = <span class="keyword">true</span>;</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Mcorr;</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <a class="code" href="group__FourierW.html#ga6e15438efefae23b564ff2106af3ae29">correlation_matrix</a>(I1, I2, Mcorr, aux);</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;<span class="comment">     Warning: for masks with a small number of non-zero pixels, this routine is NOT reliable...</span></div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="comment">     Anyway, maybe using a mask is not a good idea at al...</span></div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <span class="comment">// Adjust statistics within shiftmask to average 0 and stddev 1</span></div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <span class="keywordflow">if</span> (mask != NULL)</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    {</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        <span class="keywordflow">if</span> ((*mask).sum() &lt; 2)</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        {</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;            shiftX = shiftY = shiftZ = 0.;</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;        }</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        {</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;            <a class="code" href="group__Masks.html#ga5bd552c32d3d6b6abd6ddf18677cf647">computeStats_within_binary_mask</a>(*mask, Mcorr, dummy, dummy, avecorr,</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                                            stdcorr);</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;            <span class="keywordtype">double</span> istdcorr = 1.0 / stdcorr;</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(Mcorr)</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;            <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(*mask, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>))</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(Mcorr, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>) =</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                    (<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(Mcorr, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>) - avecorr)</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                    * istdcorr;</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;            <a class="code" href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(Mcorr, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>) = 0.;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        }</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    }</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        Mcorr.statisticsAdjust(0., 1.);</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    Mcorr.maxIndex(kmax, imax, jmax);</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    max = <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(Mcorr, kmax, imax, jmax);</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="comment">// Estimate n_max around the maximum</span></div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <span class="keywordtype">int</span> n_max = -1;</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a534830be6064ca71ebeb3ee95e3a95d3">while</a> (neighbourhood)</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    {</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        n_max++;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> = -n_max; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> &lt;= n_max &amp;&amp; neighbourhood; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>++)</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        {</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;            k_actual = <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> + kmax;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;            <span class="keywordflow">if</span> (k_actual &lt; <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(Mcorr) || k_actual &gt; <a class="code" href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(Mcorr))</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;            {</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                neighbourhood = <span class="keyword">false</span>;</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;            }</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = -n_max; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= n_max &amp;&amp; neighbourhood; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;            {</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;                i_actual = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + imax;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;                <span class="keywordflow">if</span> (i_actual &lt; <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(Mcorr) || i_actual &gt; <a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(Mcorr))</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;                {</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;                    neighbourhood = <span class="keyword">false</span>;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;                }</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = -n_max; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt;= n_max &amp;&amp; neighbourhood; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                {</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                    j_actual = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + jmax;</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;                    <span class="keywordflow">if</span> (j_actual &lt; <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(Mcorr)</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;                        || j_actual &gt; <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(Mcorr))</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;                    {</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                        neighbourhood = <span class="keyword">false</span>;</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                    }</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (max</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;                             / 1.414 &gt; <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(Mcorr, k_actual, i_actual, j_actual))</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                    {</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;                        neighbourhood = <span class="keyword">false</span>;</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;                    }</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                }</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;            }</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;        }</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    }</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    <span class="comment">// We have the neighbourhood =&gt; looking for the gravity centre</span></div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    zmax = xmax = ymax = sumcorr = 0.;</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <span class="keywordflow">if</span> (kmax-n_max&lt;<a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(Mcorr))</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;        n_max=<a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(kmax-<a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(Mcorr),n_max);</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="keywordflow">if</span> (kmax+n_max&gt;<a class="code" href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(Mcorr))</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;        n_max=<a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(<a class="code" href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(Mcorr)-kmax,n_max);</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    <span class="keywordflow">if</span> (imax-n_max&lt;<a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(Mcorr))</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;        n_max=<a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(imax-<a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(Mcorr),n_max);</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    <span class="keywordflow">if</span> (imax+n_max&gt;<a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(Mcorr))</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;        n_max=<a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(<a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(Mcorr)-imax,n_max);</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    <span class="keywordflow">if</span> (jmax-n_max&lt;<a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(Mcorr))</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        n_max=<a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(jmax-<a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(Mcorr),n_max);</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <span class="keywordflow">if</span> (jmax+n_max&gt;<a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(Mcorr))</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;        n_max=<a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(<a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(Mcorr)-jmax,n_max);</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> = -n_max; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> &lt;= n_max; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>++)</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    {</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;        k_actual = <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> + kmax;</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = -n_max; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= n_max; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;        {</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;            i_actual = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + imax;</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = -n_max; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt;= n_max; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;            {</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                j_actual = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + jmax;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                <span class="keywordtype">double</span> val = <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(Mcorr, k_actual, i_actual, j_actual);</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                zmax += k_actual * val;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                ymax += i_actual * val;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                xmax += j_actual * val;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                sumcorr += val;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;            }</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;        }</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    }</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    <span class="keywordflow">if</span> (sumcorr != 0)</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    {</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        shiftX = xmax / sumcorr;</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        shiftY = ymax / sumcorr;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;        shiftZ = zmax / sumcorr;</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    }</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_a0544c3fe466e421738dae463968b70ba"><div class="ttname"><a href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="ttdeci">else</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02919">numerical_recipes.cpp:2919</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_afbbd36781c10524238c70745c6f6f35d"><div class="ttname"><a href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">min</a></div><div class="ttdeci">void min(Image&lt; double &gt; &amp;op1, const Image&lt; double &gt; &amp;op2)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00115">image_operate.cpp:115</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a534830be6064ca71ebeb3ee95e3a95d3"><div class="ttname"><a href="numerical__recipes_8cpp.html#a534830be6064ca71ebeb3ee95e3a95d3">while</a></div><div class="ttdeci">while(mm &gt; nfs) mm-</div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga706d2ce724d393d4d759a46225bbc6c1"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a></div><div class="ttdeci">#define FINISHINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00081">multidim_array.h:81</a></div></div>
<div class="ttc" id="group__FourierW_html_ga6e15438efefae23b564ff2106af3ae29"><div class="ttname"><a href="group__FourierW.html#ga6e15438efefae23b564ff2106af3ae29">correlation_matrix</a></div><div class="ttdeci">void correlation_matrix(const MultidimArray&lt; double &gt; &amp;m1, const MultidimArray&lt; double &gt; &amp;m2, MultidimArray&lt; double &gt; &amp;R, CorrelationAux &amp;aux, bool center)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00869">xmipp_fftw.cpp:869</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00065">multidim_array.h:65</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Masks_html_ga5bd552c32d3d6b6abd6ddf18677cf647"><div class="ttname"><a href="group__Masks.html#ga5bd552c32d3d6b6abd6ddf18677cf647">computeStats_within_binary_mask</a></div><div class="ttdeci">void computeStats_within_binary_mask(const MultidimArray&lt; T1 &gt; &amp;mask, const MultidimArray&lt; T &gt; &amp;m, double &amp;min_val, double &amp;max_val, double &amp;avg, double &amp;stddev)</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00804">mask.h:804</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_ac5474a01d203d14c046620266b2f1954"><div class="ttname"><a href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">max</a></div><div class="ttdeci">void max(Image&lt; double &gt; &amp;op1, const Image&lt; double &gt; &amp;op2)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00125">image_operate.cpp:125</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad03d014386c050f947b2903e44f3b383"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a></div><div class="ttdeci">double dummy</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04652">numerical_recipes.cpp:4652</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00073">multidim_array.h:73</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga940d7a3dda260c479d250eaf1f844057"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double bestShiftRealSpace </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>shiftX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>shiftY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>mask</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxShift</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shiftStep</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Translational search (non-wrapping).</p>
<p>Search is performed in real-space </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01905">1905</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;{</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    I1.checkDimension(2);</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    I2.checkDimension(2);</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="keywordtype">double</span> bestCorr=-1e38;</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> alignedI2, bestI2;</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <span class="keywordtype">int</span> maxShift2=maxShift*maxShift;</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> shift(2);</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>=-maxShift; <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>&lt;=maxShift; <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>+=shiftStep)</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>=-maxShift; <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>&lt;=maxShift; <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>+=shiftStep)</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;        {</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>*<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>+<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>*<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>&gt;maxShift2)</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;            <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(shift)=<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>;</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;            <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(shift)=<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>;</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;            <a class="code" href="lib__pwk_8cpp.html#a1b33162134537b4be1f614f7e8094d35">translate</a>(<a class="code" href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a>,alignedI2,I2,shift,<a class="code" href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a>,0.0);</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;            <span class="keywordtype">double</span> corr=<a class="code" href="group__MultidimensionalArrays.html#ga63cca7e01116967ff451df8b1f8b5a4e">correlationIndex</a>(I1,alignedI2,mask);</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;            <span class="keywordflow">if</span> (corr&gt;bestCorr)</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;            {</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;                bestI2=alignedI2;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;                bestCorr=corr;</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;                shiftY=<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>;</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;                shiftX=<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>;</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;            }</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;        }</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    I2=bestI2;</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    <span class="keywordflow">return</span> bestCorr;</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad919bbce6f061400a0bc5231a9cd1621"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a></div><div class="ttdeci">static double * y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08506">numerical_recipes.cpp:8506</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga63cca7e01116967ff451df8b1f8b5a4e"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga63cca7e01116967ff451df8b1f8b5a4e">correlationIndex</a></div><div class="ttdeci">double correlationIndex(const MultidimArray&lt; T &gt; &amp;x, const MultidimArray&lt; T &gt; &amp;y, const MultidimArray&lt; int &gt; *mask=NULL, MultidimArray&lt; double &gt; *Contributions=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05692">multidim_array.h:5692</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gac645eb9a88619ee6f5e14c557ab8ef62"><div class="ttname"><a href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a></div><div class="ttdeci">#define LINEAR</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00208">transformations.h:208</a></div></div>
<div class="ttc" id="transformations_8h_html_a9fbfdbc149e55def0e63127fcb558d13"><div class="ttname"><a href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a></div><div class="ttdeci">#define DONT_WRAP</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00042">transformations.h:42</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="lib__pwk_8cpp_html_a1b33162134537b4be1f614f7e8094d35"><div class="ttname"><a href="lib__pwk_8cpp.html#a1b33162134537b4be1f614f7e8094d35">translate</a></div><div class="ttdeci">void translate(PDB *pdb_original, PDB *pdb_move, unsigned num_atoms, double x0, double y0, double z0)</div><div class="ttdef"><b>Definition:</b> <a href="lib__pwk_8cpp_source.html#l00125">lib_pwk.cpp:125</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga1f7a9b2af2b245a586167a1d469a2bdd"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void boundMedianFilter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; char &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove bad pixels.</p><ul>
<li></li>
</ul>
<p>A boundaries median filter is applied at those pixels given by the mask. The mask is set to zeros in the process of the tiltering. Keep a copy in case you further use it. </p>

<p>Definition at line <a class="el" href="filters_8h_source.html#l01355">1355</a> of file <a class="el" href="filters_8h_source.html">filters.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;{</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="keywordtype">bool</span> badRemaining;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    T neighbours[125];</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    T aux;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    <span class="keywordtype">int</span> N = 0, <a class="code" href="numerical__recipes_8cpp.html#ad2289c67cc7ca1c54d70d173b37d8820">index</a>;</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <span class="keywordflow">do</span></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    {</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        badRemaining=<span class="keyword">false</span>;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga46aa4ed12bd8706cfe1456ec6a8ab768">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D</a>(V)</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (<a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) != 0)</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        {</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;            N = 0;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk=-2; kk&lt;=2; kk++)</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;            {</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                <span class="keywordtype">size_t</span> kkk=k+kk;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                <span class="keywordflow">if</span> (kkk&lt;0 || kkk&gt;=<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(V))</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=-2; ii&lt;=2; ii++)</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                {</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                    <span class="keywordtype">size_t</span> iii=i+ii;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                    <span class="keywordflow">if</span> (iii&lt;0 || iii&gt;=<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(V))</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj=-2; jj&lt;=2; jj++)</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                    {</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                        <span class="keywordtype">size_t</span> jjj=j+jj;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                        <span class="keywordflow">if</span> (jjj&lt;0 || jjj&gt;=<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V))</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(mask, kkk, iii, jjj) == 0)</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                        {</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                            <a class="code" href="numerical__recipes_8cpp.html#ad2289c67cc7ca1c54d70d173b37d8820">index</a> = N++;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                            neighbours[<a class="code" href="numerical__recipes_8cpp.html#ad2289c67cc7ca1c54d70d173b37d8820">index</a>] = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V, kkk,iii,jjj);</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                            <span class="comment">//insertion sort</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                            <span class="keywordflow">while</span> (<a class="code" href="numerical__recipes_8cpp.html#ad2289c67cc7ca1c54d70d173b37d8820">index</a> &gt; 0 &amp;&amp; neighbours[<a class="code" href="numerical__recipes_8cpp.html#ad2289c67cc7ca1c54d70d173b37d8820">index</a>-1] &gt; neighbours[<a class="code" href="numerical__recipes_8cpp.html#ad2289c67cc7ca1c54d70d173b37d8820">index</a>])</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                            {</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                                <a class="code" href="group__Macros.html#ga2bd154f0d54e3b3bfaae12a8d8384519">SWAP</a>(neighbours[index-1], neighbours[index], aux);</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                                --<a class="code" href="numerical__recipes_8cpp.html#ad2289c67cc7ca1c54d70d173b37d8820">index</a>;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                            }</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                        }</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                    }</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                }</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                <span class="keywordflow">if</span> (N == 0)</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                    badRemaining = <span class="keyword">true</span>;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                {</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                    <span class="comment">//std::sort(neighbours.begin(),neighbours.end());</span></div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                    <span class="keywordflow">if</span> (N % 2 == 0)</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                        <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V, k, i, j) = (T)(0.5*(neighbours[N/2-1]+ neighbours[N/2]));</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                        <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V, k, i, j) = neighbours[N/2];</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(mask, k, i, j) = <span class="keyword">false</span>;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                }</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;            }</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        }</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    }</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <span class="keywordflow">while</span> (badRemaining);</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_gacac7be97c37bd2e4f801976749de839c"><div class="ttname"><a href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a></div><div class="ttdeci">#define DIRECT_A3D_ELEM(v, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00249">multidim_array.h:249</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad2289c67cc7ca1c54d70d173b37d8820"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad2289c67cc7ca1c54d70d173b37d8820">index</a></div><div class="ttdeci">viol index</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05214">numerical_recipes.cpp:5214</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga46aa4ed12bd8706cfe1456ec6a8ab768"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga46aa4ed12bd8706cfe1456ec6a8ab768">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00332">multidim_array.h:332</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="group__Macros_html_ga2bd154f0d54e3b3bfaae12a8d8384519"><div class="ttname"><a href="group__Macros.html#ga2bd154f0d54e3b3bfaae12a8d8384519">SWAP</a></div><div class="ttdeci">#define SWAP(a, b, tmp)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00428">xmipp_macros.h:428</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga6690cfb805eb563bfb5edcfd53b13051"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt;double&gt; centerImage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Niter</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>limitShift</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Center an image both translationally and rotationally</p>
<p>Given an image, this function returns the image that has been centered rotationally and translationally. For doing so, it compares this image with its mirrored (X, Y, XY) versions. The image is aligned translationally and then rotationally Niter times. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l03156">3156</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;{</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;    I.checkDimension(2);</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;    I.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;    <span class="keywordtype">double</span> avg = I.<a class="code" href="classMultidimArray.html#ac03a790d43ff768b7cc7f8cd6d3038ad">computeAvg</a>();</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;    I -= avg;</div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;</div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Ix, Iy, Ixy, Iaux;</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> A;</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;    A.<a class="code" href="classMatrix2D.html#a1b0afdb4a10ad1857db3db8b64715ba3">initIdentity</a>(3);</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;    Iaux = I;</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;int&gt;</a> mask;</div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;    mask.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(I);</div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;    <a class="code" href="group__Masks.html#ga1f835f6611a65877b172c170a555f869">BinaryCircularMask</a>(mask, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I) / 2);</div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;</div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> lineY, lineX;</div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;    lineY.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I));</div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(lineY) = <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(I);</div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;    lineX.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I));</div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(lineX) = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(I);</div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;</div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;    <a class="code" href="classPolar__fftw__plans.html">Polar_fftw_plans</a> *plans = NULL;</div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;    <a class="code" href="classPolar.html">Polar&lt;std::complex&lt;double&gt;</a> &gt; polarFourierI, polarFourierIx;</div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> rotationalCorr;</div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> R;</div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; Niter; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;    {</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;        <span class="comment">// Mask Iaux</span></div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(mask)</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (!<a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(mask,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>))</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Iaux,i,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 0;</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;</div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;        <span class="comment">// Center translationally</span></div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;        Ix = Iaux;</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;        Ix.selfReverseX();</div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;        Ix.setXmippOrigin();</div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;        Iy = Iaux;</div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;        Iy.selfReverseY();</div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;        Iy.setXmippOrigin();</div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;        Ixy = Ix;</div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;        Ixy.selfReverseY();</div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;        Ixy.setXmippOrigin();</div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;</div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;        <span class="keywordtype">double</span> meanShiftX = 0, meanShiftY = 0, shiftX, shiftY, Nx = 0, Ny = 0;</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;        <a class="code" href="group__Filters.html#ga5aae1ce90626f1f1401defcb6f5d6411">bestNonwrappingShift</a>(Iaux, Ix, shiftX, shiftY, aux);</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;</div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;        ImageXmipp save;</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;        save()=Ix;</div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;        save.write(<span class="stringliteral">&quot;PPPx.xmp&quot;</span>);</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;con Ix: &quot;</span> &lt;&lt; shiftX &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; shiftY &lt;&lt; std::endl;</div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;</div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;        <span class="keywordflow">if</span> (fabs(shiftX) &lt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I) / 3 || !limitShift)</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;        {</div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;            meanShiftX += shiftX;</div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;            Nx++;</div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;        }</div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;        <span class="keywordflow">if</span> (fabs(shiftY) &lt; <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I) / 3 || !limitShift)</div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;        {</div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;            meanShiftY += shiftY;</div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;            Ny++;</div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;        }</div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;        <a class="code" href="group__Filters.html#ga5aae1ce90626f1f1401defcb6f5d6411">bestNonwrappingShift</a>(Iaux, Iy, shiftX, shiftY, aux);</div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;</div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;        save()=Iy;</div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;        save.<a class="code" href="classMultidimArray.html#a4a4e45352f73539481de04cbda5f3f3d">write</a>(<span class="stringliteral">&quot;PPPy.xmp&quot;</span>);</div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;con Iy: &quot;</span> &lt;&lt; shiftX &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; shiftY &lt;&lt; std::endl;</div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;</div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;        <span class="keywordflow">if</span> (fabs(shiftX) &lt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I) / 3 || !limitShift)</div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;        {</div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;            meanShiftX += shiftX;</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;            Nx++;</div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;        }</div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;        <span class="keywordflow">if</span> (fabs(shiftY) &lt; <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I) / 3 || !limitShift)</div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;        {</div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;            meanShiftY += shiftY;</div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;            Ny++;</div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;        }</div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;        <a class="code" href="group__Filters.html#ga5aae1ce90626f1f1401defcb6f5d6411">bestNonwrappingShift</a>(Iaux, Ixy, shiftX, shiftY, aux);</div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;</div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;        save()=Ixy;</div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;        save.<a class="code" href="classMultidimArray.html#a4a4e45352f73539481de04cbda5f3f3d">write</a>(<span class="stringliteral">&quot;PPPxy.xmp&quot;</span>);</div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;con Ixy: &quot;</span> &lt;&lt; shiftX &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; shiftY &lt;&lt; std::endl;</div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;        <span class="keywordflow">if</span> (fabs(shiftX) &lt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I) / 3 || !limitShift)</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;        {</div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;            meanShiftX += shiftX;</div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;            Nx++;</div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;        }</div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;        <span class="keywordflow">if</span> (fabs(shiftY) &lt; <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I) / 3 || !limitShift)</div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;        {</div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;            meanShiftY += shiftY;</div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;            Ny++;</div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;        }</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;        <span class="keywordflow">if</span> (Nx &gt; 0)</div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;            meanShiftX /= Nx;</div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;        <span class="keywordflow">if</span> (Ny &gt; 0)</div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;            meanShiftY /= Ny;</div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;</div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;        <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A,0,2) += -meanShiftX / 2;</div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;        <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A,1,2) += -meanShiftY / 2;</div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;        Iaux.initZeros();</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a>(<a class="code" href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a>, Iaux, I, A, <a class="code" href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a>, <a class="code" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a>);</div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(mask)</div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (!<a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(mask,i,j))</div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Iaux,i,j) = 0;</div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;</div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Iter &quot;</span> &lt;&lt; i &lt;&lt; std::endl;</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;shift=&quot;</span> &lt;&lt; -meanShiftX &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; -meanShiftY &lt;&lt; std::endl;</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;        save()=I;</div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;        save.<a class="code" href="classMultidimArray.html#a4a4e45352f73539481de04cbda5f3f3d">write</a>(<span class="stringliteral">&quot;PPP.xmp&quot;</span>);</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;        save()=Iaux;</div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;        save.write(<span class="stringliteral">&quot;PPPshift.xmp&quot;</span>);</div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;</div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;        <span class="comment">// Center rotationally</span></div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;        Ix = Iaux;</div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;        Ix.selfReverseX();</div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;        Ix.setXmippOrigin();</div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;</div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;        <a class="code" href="polar_8cpp.html#a29cae209c3de81e800a2dcf343a059c4">polarFourierTransform&lt;true&gt;</a>(Iaux, polarFourierI, <span class="keyword">true</span>, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I) / 5,</div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;                                        <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I) / 2, plans);</div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;        rotationalCorr.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(</div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;            2 * polarFourierI.getSampleNoOuterRing() - 1);</div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;        aux2.<a class="code" href="classRotationalCorrelationAux.html#ab6762c27fa075d4c124a5d33a286cd5a">local_transformer</a>.<a class="code" href="classFourierTransformer.html#a18bc840c781555b742d0185fb20925bf">setReal</a>(rotationalCorr);</div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;</div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;        <a class="code" href="polar_8cpp.html#a29cae209c3de81e800a2dcf343a059c4">polarFourierTransform&lt;true&gt;</a>(Ix, polarFourierIx, <span class="keyword">false</span>,</div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;                                        <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Ix) / 5, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Ix) / 2, plans);</div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;        <span class="keywordtype">double</span> bestRot = <a class="code" href="group__Polar.html#gad480d0d51fe785a56c0173a9dfdc8d38">best_rotation</a>(polarFourierIx, polarFourierI, aux2);</div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;        bestRot = <a class="code" href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a>(bestRot,0,180);</div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;        <span class="keywordflow">if</span> (bestRot &gt; 90)</div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;            bestRot = bestRot - 180;</div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;</div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga93598c1cf08f43c7a58a096003b2d718">rotation2DMatrix</a>(bestRot / 2, R);</div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;        A = R * A;</div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;        Iaux.<a class="code" href="classMatrix2D.html#a35921c37b27282bac3b3868cce8feb26">initZeros</a>();</div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a>(<a class="code" href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a>, Iaux, I, A, <a class="code" href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a>, <a class="code" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a>);</div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(mask)</div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (!<a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(mask,i,j))</div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Iaux,i,j) = 0;</div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;</div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;rot=&quot;</span> &lt;&lt; -bestRot/2 &lt;&lt; std::endl;</div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;        save()=Iaux;</div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;        save.write(<span class="stringliteral">&quot;PPProt.xmp&quot;</span>);</div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;        <span class="comment">// Remove horizontal/vertical ambiguity</span></div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;        lineX.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;        lineY.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(Iaux)</div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;        {</div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;            <span class="keywordtype">double</span> val = <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Iaux,i,j);</div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;            <span class="keywordflow">if</span> (j == 0)</div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;                lineY(i) = val;</div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lineY(i) &lt; val)</div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;                lineY(i) = val;</div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;            <span class="keywordflow">if</span> (i == 0)</div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;                lineX(j) = val;</div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lineX(j) &lt; val)</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;                lineX(j) = val;</div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;        }</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;        <span class="keywordtype">double</span> thX = lineX.<a class="code" href="classMultidimArray.html#a0e7a7881ec242da8ee392f465b3e3b28">computeMin</a>()</div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;                     + 0.75 * (lineX.<a class="code" href="classMultidimArray.html#a0f2229bfbeb30bc5b5b8a9b83c08279c">computeMax</a>() - lineX.<a class="code" href="classMultidimArray.html#a0e7a7881ec242da8ee392f465b3e3b28">computeMin</a>());</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;        <span class="keywordtype">double</span> thY = lineY.<a class="code" href="classMultidimArray.html#a0e7a7881ec242da8ee392f465b3e3b28">computeMin</a>()</div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;                     + 0.75 * (lineY.<a class="code" href="classMultidimArray.html#a0f2229bfbeb30bc5b5b8a9b83c08279c">computeMax</a>() - lineY.<a class="code" href="classMultidimArray.html#a0e7a7881ec242da8ee392f465b3e3b28">computeMin</a>());</div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a> = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(lineX);</div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;        <span class="keywordflow">while</span> (lineX(x0) &lt; thX)</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;            x0++;</div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a> = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(lineY);</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;        <span class="keywordflow">while</span> (lineY(y0) &lt; thY)</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;            y0++;</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a> = <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(lineX);</div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;        <span class="keywordflow">while</span> (lineX(xF) &lt; thX)</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;            xF--;</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="blobs_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a> = <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(lineY);</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;        <span class="keywordflow">while</span> (lineY(yF) &lt; thY)</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;            yF--;</div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;        <span class="keywordflow">if</span> ((xF - x0) &gt; (yF - y0))</div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;        {</div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#ga93598c1cf08f43c7a58a096003b2d718">rotation2DMatrix</a>(-90., R);</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;            A = R * A;</div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;        }</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a>(<a class="code" href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a>, Iaux, I, A, <a class="code" href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a>, <a class="code" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a>);</div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;</div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;        lineX.<a class="code" href="classMultidimArray.html#a4a4e45352f73539481de04cbda5f3f3d">write</a>(<span class="stringliteral">&quot;PPPlineX.txt&quot;</span>);</div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;        lineY.<a class="code" href="classMultidimArray.html#a4a4e45352f73539481de04cbda5f3f3d">write</a>(<span class="stringliteral">&quot;PPPlineY.txt&quot;</span>);</div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;dev X=&quot;</span> &lt;&lt; xF-x0 &lt;&lt; std::endl;</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;dev Y=&quot;</span> &lt;&lt; yF-y0 &lt;&lt; std::endl;</div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;        save()=Iaux;</div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;        save.write(<span class="stringliteral">&quot;PPPhorver.xmp&quot;</span>);</div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Press any key\n&quot;</span>;</div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;        <span class="keywordtype">char</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;        std::cin &gt;&gt; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;</div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;    }</div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a>(<a class="code" href="group__GeometricalTransformations.html#gab8a49d8335f45ebd2ba7d86d98322bc0">BSPLINE3</a>, Iaux, I, A, <a class="code" href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a>, <a class="code" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a>);</div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;    I = Iaux;</div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;    I += avg;</div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;    <span class="keyword">delete</span> plans;</div><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;    <span class="keywordflow">return</span> A;</div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00364">multidim_array.h:364</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="classMultidimArray_html_ac0efebfb32ab4e37cf33efca3349aa9b"><div class="ttname"><a href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">MultidimArray::resizeNoCopy</a></div><div class="ttdeci">void resizeNoCopy(const MultidimArray&lt; T1 &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01702">multidim_array.h:1702</a></div></div>
<div class="ttc" id="group__Masks_html_ga1f835f6611a65877b172c170a555f869"><div class="ttname"><a href="group__Masks.html#ga1f835f6611a65877b172c170a555f869">BinaryCircularMask</a></div><div class="ttdeci">void BinaryCircularMask(MultidimArray&lt; int &gt; &amp;mask, double radius, int mode, double x0, double y0, double z0)</div><div class="ttdef"><b>Definition:</b> <a href="mask_8cpp_source.html#l00189">mask.cpp:189</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga3cc15e5dda7c58b9cacb7eee440d6bdc"><div class="ttname"><a href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a></div><div class="ttdeci">void applyGeometry(int SplineDegree, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V2, const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V1, const Matrix2D&lt; double &gt; &amp;A, bool inv, bool wrap, std::complex&lt; double &gt; outside, MultidimArray&lt; double &gt; *BcoeffsPtr)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00517">transformations.cpp:517</a></div></div>
<div class="ttc" id="transformations_8h_html_a43c1de45dbd91827a260224c9c40221b"><div class="ttname"><a href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a></div><div class="ttdeci">#define WRAP</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00043">transformations.h:43</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00065">multidim_array.h:65</a></div></div>
<div class="ttc" id="classMultidimArray_html_a4a4e45352f73539481de04cbda5f3f3d"><div class="ttname"><a href="classMultidimArray.html#a4a4e45352f73539481de04cbda5f3f3d">MultidimArray::write</a></div><div class="ttdeci">void write(const FileName &amp;fn) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05329">multidim_array.h:5329</a></div></div>
<div class="ttc" id="group__Filters_html_ga5aae1ce90626f1f1401defcb6f5d6411"><div class="ttname"><a href="group__Filters.html#ga5aae1ce90626f1f1401defcb6f5d6411">bestNonwrappingShift</a></div><div class="ttdeci">void bestNonwrappingShift(const MultidimArray&lt; double &gt; &amp;I1, const MultidimArray&lt; double &gt; &amp;I2, double &amp;shiftX, double &amp;shiftY, CorrelationAux &amp;aux)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l01812">filters.cpp:1812</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="group__Matrices_html_gab40746be05d4bbf352787018922ecc2e"><div class="ttname"><a href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a></div><div class="ttdeci">#define MAT_ELEM(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00117">matrix2d.h:117</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Polar_html_gad480d0d51fe785a56c0173a9dfdc8d38"><div class="ttname"><a href="group__Polar.html#gad480d0d51fe785a56c0173a9dfdc8d38">best_rotation</a></div><div class="ttdeci">double best_rotation(const Polar&lt; std::complex&lt; double &gt; &gt; &amp;I1, const Polar&lt; std::complex&lt; double &gt; &gt; &amp;I2, RotationalCorrelationAux &amp;aux)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8cpp_source.html#l00165">polar.cpp:165</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a0d9521fd31b2e16413d1b78836953d53"><div class="ttname"><a href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a></div><div class="ttdeci">#define y0</div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a18bc840c781555b742d0185fb20925bf"><div class="ttname"><a href="classFourierTransformer.html#a18bc840c781555b742d0185fb20925bf">FourierTransformer::setReal</a></div><div class="ttdeci">void setReal(MultidimArray&lt; double &gt; &amp;img)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00129">xmipp_fftw.cpp:129</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00400">multidim_array.h:400</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gac645eb9a88619ee6f5e14c557ab8ef62"><div class="ttname"><a href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a></div><div class="ttdeci">#define LINEAR</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00208">transformations.h:208</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gab8a49d8335f45ebd2ba7d86d98322bc0"><div class="ttname"><a href="group__GeometricalTransformations.html#gab8a49d8335f45ebd2ba7d86d98322bc0">BSPLINE3</a></div><div class="ttdeci">#define BSPLINE3</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00210">transformations.h:210</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a8f613ddaea2048e3471a1f4f04ba4b79"><div class="ttname"><a href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a></div><div class="ttdeci">#define xF</div></div>
<div class="ttc" id="classMultidimArray_html_a0e7a7881ec242da8ee392f465b3e3b28"><div class="ttname"><a href="classMultidimArray.html#a0e7a7881ec242da8ee392f465b3e3b28">MultidimArray::computeMin</a></div><div class="ttdeci">T computeMin() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03154">multidim_array.h:3154</a></div></div>
<div class="ttc" id="classPolar__fftw__plans_html"><div class="ttname"><a href="classPolar__fftw__plans.html">Polar_fftw_plans</a></div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00051">polar.h:51</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga93598c1cf08f43c7a58a096003b2d718"><div class="ttname"><a href="group__GeometricalTransformations.html#ga93598c1cf08f43c7a58a096003b2d718">rotation2DMatrix</a></div><div class="ttdeci">void rotation2DMatrix(T ang, Matrix2D&lt; T &gt; &amp;result, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00212">transformations.cpp:212</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classPolar_html"><div class="ttname"><a href="classPolar.html">Polar</a></div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00061">polar.h:61</a></div></div>
<div class="ttc" id="classRotationalCorrelationAux_html_ab6762c27fa075d4c124a5d33a286cd5a"><div class="ttname"><a href="classRotationalCorrelationAux.html#ab6762c27fa075d4c124a5d33a286cd5a">RotationalCorrelationAux::local_transformer</a></div><div class="ttdeci">FourierTransformer local_transformer</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00791">polar.h:791</a></div></div>
<div class="ttc" id="classMultidimArray_html_a0f2229bfbeb30bc5b5b8a9b83c08279c"><div class="ttname"><a href="classMultidimArray.html#a0f2229bfbeb30bc5b5b8a9b83c08279c">MultidimArray::computeMax</a></div><div class="ttdeci">T computeMax() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03123">multidim_array.h:3123</a></div></div>
<div class="ttc" id="classMultidimArray_html_ac03a790d43ff768b7cc7f8cd6d3038ad"><div class="ttname"><a href="classMultidimArray.html#ac03a790d43ff768b7cc7f8cd6d3038ad">MultidimArray::computeAvg</a></div><div class="ttdeci">double computeAvg() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03325">multidim_array.h:3325</a></div></div>
<div class="ttc" id="classMatrix2D_html_a35921c37b27282bac3b3868cce8feb26"><div class="ttname"><a href="classMatrix2D.html#a35921c37b27282bac3b3868cce8feb26">Matrix2D::initZeros</a></div><div class="ttdeci">void initZeros()</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00779">matrix2d.h:779</a></div></div>
<div class="ttc" id="group__Macros_html_ga25935c2309abe02cff60809c4d7d9b9e"><div class="ttname"><a href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a></div><div class="ttdeci">#define realWRAP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00304">xmipp_macros.h:304</a></div></div>
<div class="ttc" id="transformations_8h_html_a3a4a05e15fc1cc8a66159304e4c33eb1"><div class="ttname"><a href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a></div><div class="ttdeci">#define IS_NOT_INV</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00041">transformations.h:41</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a132f3924593d07b0a1f55b3f22e92ba6"><div class="ttname"><a href="blobs_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a></div><div class="ttdeci">#define yF</div></div>
<div class="ttc" id="classMatrix2D_html_a1b0afdb4a10ad1857db3db8b64715ba3"><div class="ttname"><a href="classMatrix2D.html#a1b0afdb4a10ad1857db3db8b64715ba3">Matrix2D::initIdentity</a></div><div class="ttdeci">void initIdentity()</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00835">matrix2d.h:835</a></div></div>
<div class="ttc" id="polar_8cpp_html_a29cae209c3de81e800a2dcf343a059c4"><div class="ttname"><a href="polar_8cpp.html#a29cae209c3de81e800a2dcf343a059c4">polarFourierTransform&lt; true &gt;</a></div><div class="ttdeci">template void polarFourierTransform&lt; true &gt;(const MultidimArray&lt; double &gt; &amp;in, Polar&lt; std::complex&lt; double &gt; &gt; &amp;out, bool conjugated, int first_ring, int last_ring, Polar_fftw_plans *&amp;plans, int BsplineOrder)</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga5265e64d6f938b25dd3c82ad9f889a30"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void centerImageRotationally </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Center an image rotationally</p>
<p>Given an image, this function returns the image that has been centered rotationally. For doing so, it compares this image with its mirrored (X) version. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l03128">3128</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;{</div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;    I.checkDimension(2);</div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;</div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Ix = I;</div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;    Ix.<a class="code" href="classMultidimArray.html#a6db384c048f3f89a1a8d5c36cec07fbc">selfReverseX</a>();</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;    Ix.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;    <a class="code" href="classPolar__fftw__plans.html">Polar_fftw_plans</a> *plans = NULL;</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;    <a class="code" href="classPolar.html">Polar&lt;std::complex&lt;double&gt;</a> &gt; polarFourierI, polarFourierIx;</div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;    <a class="code" href="polar_8cpp.html#a29cae209c3de81e800a2dcf343a059c4">polarFourierTransform&lt;true&gt;</a>(Ix, polarFourierIx, <span class="keyword">false</span>, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Ix) / 5,</div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;                                    <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Ix) / 2, plans);</div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;    <a class="code" href="polar_8cpp.html#a29cae209c3de81e800a2dcf343a059c4">polarFourierTransform&lt;true&gt;</a>(I, polarFourierI, <span class="keyword">true</span>, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I) / 5,</div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;                                    <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I) / 2, plans);</div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;</div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> rotationalCorr;</div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;    rotationalCorr.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(2 * polarFourierI.getSampleNoOuterRing() - 1);</div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;    aux.<a class="code" href="classRotationalCorrelationAux.html#ab6762c27fa075d4c124a5d33a286cd5a">local_transformer</a>.<a class="code" href="classFourierTransformer.html#a18bc840c781555b742d0185fb20925bf">setReal</a>(rotationalCorr);</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;    <span class="keywordtype">double</span> bestRot = <a class="code" href="group__Polar.html#gad480d0d51fe785a56c0173a9dfdc8d38">best_rotation</a>(polarFourierIx, polarFourierI, aux);</div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;</div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> auxI = I;</div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;    <a class="code" href="classification_2pca_8cpp.html#ae5e08c2a7a15204653d0fdaabbc890ac">rotate</a>(3, I, auxI, -bestRot / 2, <a class="code" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a>);</div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;    <span class="comment">//I.selfRotateBSpline(3,-bestRot/2,WRAP);</span></div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="transformations_8h_html_a43c1de45dbd91827a260224c9c40221b"><div class="ttname"><a href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a></div><div class="ttdeci">#define WRAP</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00043">transformations.h:43</a></div></div>
<div class="ttc" id="classMultidimArray_html_a6db384c048f3f89a1a8d5c36cec07fbc"><div class="ttname"><a href="classMultidimArray.html#a6db384c048f3f89a1a8d5c36cec07fbc">MultidimArray::selfReverseX</a></div><div class="ttdeci">void selfReverseX()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05191">multidim_array.h:5191</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="classification_2pca_8cpp_html_ae5e08c2a7a15204653d0fdaabbc890ac"><div class="ttname"><a href="classification_2pca_8cpp.html#ae5e08c2a7a15204653d0fdaabbc890ac">rotate</a></div><div class="ttdeci">#define rotate(a, i, j, k, l)</div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="group__Polar_html_gad480d0d51fe785a56c0173a9dfdc8d38"><div class="ttname"><a href="group__Polar.html#gad480d0d51fe785a56c0173a9dfdc8d38">best_rotation</a></div><div class="ttdeci">double best_rotation(const Polar&lt; std::complex&lt; double &gt; &gt; &amp;I1, const Polar&lt; std::complex&lt; double &gt; &gt; &amp;I2, RotationalCorrelationAux &amp;aux)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8cpp_source.html#l00165">polar.cpp:165</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a18bc840c781555b742d0185fb20925bf"><div class="ttname"><a href="classFourierTransformer.html#a18bc840c781555b742d0185fb20925bf">FourierTransformer::setReal</a></div><div class="ttdeci">void setReal(MultidimArray&lt; double &gt; &amp;img)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00129">xmipp_fftw.cpp:129</a></div></div>
<div class="ttc" id="classPolar__fftw__plans_html"><div class="ttname"><a href="classPolar__fftw__plans.html">Polar_fftw_plans</a></div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00051">polar.h:51</a></div></div>
<div class="ttc" id="classPolar_html"><div class="ttname"><a href="classPolar.html">Polar</a></div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00061">polar.h:61</a></div></div>
<div class="ttc" id="classRotationalCorrelationAux_html_ab6762c27fa075d4c124a5d33a286cd5a"><div class="ttname"><a href="classRotationalCorrelationAux.html#ab6762c27fa075d4c124a5d33a286cd5a">RotationalCorrelationAux::local_transformer</a></div><div class="ttdeci">FourierTransformer local_transformer</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00791">polar.h:791</a></div></div>
<div class="ttc" id="polar_8cpp_html_a29cae209c3de81e800a2dcf343a059c4"><div class="ttname"><a href="polar_8cpp.html#a29cae209c3de81e800a2dcf343a059c4">polarFourierTransform&lt; true &gt;</a></div><div class="ttdeci">template void polarFourierTransform&lt; true &gt;(const MultidimArray&lt; double &gt; &amp;in, Polar&lt; std::complex&lt; double &gt; &gt; &amp;out, bool conjugated, int first_ring, int last_ring, Polar_fftw_plans *&amp;plans, int BsplineOrder)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga8552ad520aa2e2a78bcb29f7bca80f51"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void centerImageTranslationally </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Center an image translationally</p>
<p>Given an image, this function returns the image that has been centered translationally. For doing so, it compares this image with its mirrored (X, Y, XY) versions. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l03095">3095</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;{</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;    I.checkDimension(2);</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Ix = I;</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;    Ix.<a class="code" href="classMultidimArray.html#a6db384c048f3f89a1a8d5c36cec07fbc">selfReverseX</a>();</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;    Ix.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Iy = I;</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;    Iy.<a class="code" href="classMultidimArray.html#adf722e075c6fa2aa1d0429b1ee16e326">selfReverseY</a>();</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;    Iy.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Ixy = Ix;</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;    Ixy.<a class="code" href="classMultidimArray.html#adf722e075c6fa2aa1d0429b1ee16e326">selfReverseY</a>();</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;    Ixy.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;    <span class="keywordtype">double</span> meanShiftX = 0, meanShiftY = 0, shiftX, shiftY;</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;    <a class="code" href="group__Filters.html#ga5aae1ce90626f1f1401defcb6f5d6411">bestNonwrappingShift</a>(I, Ix, meanShiftX, meanShiftY, aux);</div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;    <a class="code" href="group__Filters.html#ga5aae1ce90626f1f1401defcb6f5d6411">bestNonwrappingShift</a>(I, Iy, shiftX, shiftY, aux);</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;    meanShiftX += shiftX;</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;    meanShiftY += shiftY;</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;    <a class="code" href="group__Filters.html#ga5aae1ce90626f1f1401defcb6f5d6411">bestNonwrappingShift</a>(I, Ixy, shiftX, shiftY, aux);</div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;    meanShiftX += shiftX;</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;    meanShiftY += shiftY;</div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;    meanShiftX /= 3;</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;    meanShiftY /= 3;</div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;</div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> shift(2);</div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;    <a class="code" href="group__Vectors.html#gaf35071e3863333ef9ff847bb85615bb4">VECTOR_R2</a>(shift, -meanShiftX, -meanShiftY);</div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> aux2 = I;</div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;    <a class="code" href="lib__pwk_8cpp.html#a1b33162134537b4be1f614f7e8094d35">translate</a>(3, I, aux2, shift);</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;    <span class="comment">//I.selfTranslateBSpline(3,shift);</span></div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;}</div><div class="ttc" id="group__Vectors_html_gaf35071e3863333ef9ff847bb85615bb4"><div class="ttname"><a href="group__Vectors.html#gaf35071e3863333ef9ff847bb85615bb4">VECTOR_R2</a></div><div class="ttdeci">#define VECTOR_R2(v, x, y)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00115">matrix1d.h:115</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classMultidimArray_html_adf722e075c6fa2aa1d0429b1ee16e326"><div class="ttname"><a href="classMultidimArray.html#adf722e075c6fa2aa1d0429b1ee16e326">MultidimArray::selfReverseY</a></div><div class="ttdeci">void selfReverseY()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05221">multidim_array.h:5221</a></div></div>
<div class="ttc" id="classMultidimArray_html_a6db384c048f3f89a1a8d5c36cec07fbc"><div class="ttname"><a href="classMultidimArray.html#a6db384c048f3f89a1a8d5c36cec07fbc">MultidimArray::selfReverseX</a></div><div class="ttdeci">void selfReverseX()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05191">multidim_array.h:5191</a></div></div>
<div class="ttc" id="group__Filters_html_ga5aae1ce90626f1f1401defcb6f5d6411"><div class="ttname"><a href="group__Filters.html#ga5aae1ce90626f1f1401defcb6f5d6411">bestNonwrappingShift</a></div><div class="ttdeci">void bestNonwrappingShift(const MultidimArray&lt; double &gt; &amp;I1, const MultidimArray&lt; double &gt; &amp;I2, double &amp;shiftX, double &amp;shiftY, CorrelationAux &amp;aux)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l01812">filters.cpp:1812</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="lib__pwk_8cpp_html_a1b33162134537b4be1f614f7e8094d35"><div class="ttname"><a href="lib__pwk_8cpp.html#a1b33162134537b4be1f614f7e8094d35">translate</a></div><div class="ttdeci">void translate(PDB *pdb_original, PDB *pdb_move, unsigned num_atoms, double x0, double y0, double z0)</div><div class="ttdef"><b>Definition:</b> <a href="lib__pwk_8cpp_source.html#l00125">lib_pwk.cpp:125</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga74734334175800271ab600d627beb04d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void contrastEnhancement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classImage.html">Image</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>I</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constrast enhancement</p>
<p>The minimum density value is brought to 0 and the maximum to 255. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l00320">320</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;{</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    (*I)().rangeAdjust(0, 255);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaa17e6426905f990a4e82d73e1e0a337c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">double correlation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>mask</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>l</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>q</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Correlation nD </p>

<p>Definition at line <a class="el" href="filters_8h_source.html#l00250">250</a> of file <a class="el" href="filters_8h_source.html">filters.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;{</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="group__Macros.html#ga536d5c60e25ce994a433d115ca6de5c9">SPEED_UP_temps</a>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordtype">double</span> retval = 0; <span class="comment">// returned value</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, ip, jp, kp; <span class="comment">// indexes</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordtype">int</span> Rows, Cols, Slices; <span class="comment">// of the volumes</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// do the computation</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    Cols = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(x);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    Rows = <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(x);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    Slices = <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(x);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordtype">long</span> N = 0;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; Slices; k++)</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        kp = k - q;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">if</span> (kp &lt; 0 || kp &gt;= Slices)</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; Rows; i++)</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        {</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            ip = i - l;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="keywordflow">if</span> (ip &lt; 0 || ip &gt;= Rows)</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; Cols; j++)</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            {</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                jp = j - <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                <span class="keywordflow">if</span> (jp &gt;= 0 &amp;&amp; jp &lt; Cols)</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                {</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                    <span class="keywordflow">if</span> (mask != NULL)</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                        <span class="keywordflow">if</span> (!<a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>((*mask), k, i, j))</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                    retval += <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(x, k, i, j) *</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                              <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(y, kp, ip, jp);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                    ++N;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                }</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            }</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">return</span> retval / N;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_gacac7be97c37bd2e4f801976749de839c"><div class="ttname"><a href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a></div><div class="ttdeci">#define DIRECT_A3D_ELEM(v, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00249">multidim_array.h:249</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="group__Macros_html_ga536d5c60e25ce994a433d115ca6de5c9"><div class="ttname"><a href="group__Macros.html#ga536d5c60e25ce994a433d115ca6de5c9">SPEED_UP_temps</a></div><div class="ttdeci">#define SPEED_UP_temps</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00419">xmipp_macros.h:419</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a438c75002165fed58970c95d67a268c1"><div class="ttname"><a href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a></div><div class="ttdeci">int m</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga63cca7e01116967ff451df8b1f8b5a4e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">double correlationIndex </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>mask</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>Contributions</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>correlationIndex nD </p>

<p>Definition at line <a class="el" href="multidim__array_8h_source.html#l05692">5692</a> of file <a class="el" href="multidim__array_8h_source.html">multidim_array.h</a>.</p>
<div class="fragment"><div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;{</div><div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;    <a class="code" href="group__Macros.html#ga4c9386c11dfbaac4b99d2f7799dbc0c1">SPEED_UP_tempsInt</a>;</div><div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;</div><div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;    <span class="keywordtype">double</span> retval = 0, aux;</div><div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;    <span class="keywordtype">double</span> mean_x, mean_y;</div><div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;    <span class="keywordtype">double</span> stddev_x, stddev_y;</div><div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;</div><div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;    <span class="keywordtype">long</span> N = 0;</div><div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;</div><div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;    <span class="keywordflow">if</span> (mask == NULL)</div><div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;    {</div><div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;        x.<a class="code" href="classMultidimArray.html#a3e6470485fbdde47cb3238520568c28d">computeAvgStdev</a>(mean_x, stddev_x);</div><div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;        y.<a class="code" href="classMultidimArray.html#a3e6470485fbdde47cb3238520568c28d">computeAvgStdev</a>(mean_y, stddev_y);</div><div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;    }</div><div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;    {</div><div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;        x.<a class="code" href="classMultidimArray.html#a9e0cf9e48e99338f7698c6018a0e7ee3">computeAvgStdev_within_binary_mask</a>(*mask, mean_x,stddev_x);</div><div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;        y.<a class="code" href="classMultidimArray.html#a9e0cf9e48e99338f7698c6018a0e7ee3">computeAvgStdev_within_binary_mask</a>(*mask, mean_y,stddev_y);</div><div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;    }</div><div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(stddev_x)&lt;<a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a> ||</div><div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;        <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(stddev_y)&lt;<a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>)</div><div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;</div><div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;    <span class="comment">// If contributions are desired. Please, be careful interpreting individual</span></div><div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;    <span class="comment">// contributions to the covariance! One pixel value afect others.</span></div><div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;    <span class="keywordflow">if</span> (Contributions != NULL)</div><div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;    {</div><div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gaaee6e163d8f7e358c38d3fcfe935b6fc">FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D</a>(x, y)</div><div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;        {</div><div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;            <span class="keywordflow">if</span> (mask != NULL)</div><div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*mask,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>))</div><div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;</div><div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;            aux = (<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(x, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) - mean_x) * (<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(y, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) -</div><div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;                    mean_y);</div><div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*Contributions, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = aux;</div><div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;            retval += aux;</div><div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;            ++N;</div><div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;        }</div><div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;</div><div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(*Contributions)</div><div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*Contributions, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) /= ((stddev_x * stddev_y) * N);</div><div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;    }</div><div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;    {</div><div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;        <span class="keywordflow">if</span> (mask==NULL &amp;&amp; x.<a class="code" href="classMultidimArrayBase.html#a15e046b6c4b203b8a52a6acff9f1665b">sameShape</a>(y))</div><div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;        {</div><div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(x)</div><div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;                retval += <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(x, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)*<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(y, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;            N=<a class="code" href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(x);</div><div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;            retval-=N*mean_x*mean_y;</div><div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;        }</div><div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;        {</div><div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gaaee6e163d8f7e358c38d3fcfe935b6fc">FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D</a>(x, y)</div><div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;            {</div><div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;                <span class="keywordflow">if</span> (mask != NULL)</div><div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*mask,k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>))</div><div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;</div><div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;                retval += (<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(x, k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) - mean_x) *</div><div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;                          (<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(y, k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) - mean_y);</div><div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;                ++N;</div><div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;            }</div><div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;        }</div><div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;    }</div><div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;</div><div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;    <span class="keywordflow">if</span> (N != 0)</div><div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;        <span class="keywordflow">return</span> retval / ((stddev_x * stddev_y) * N);</div><div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_a0544c3fe466e421738dae463968b70ba"><div class="ttname"><a href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="ttdeci">else</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02919">numerical_recipes.cpp:2919</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00279">multidim_array.h:279</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="classMultidimArray_html_a3e6470485fbdde47cb3238520568c28d"><div class="ttname"><a href="classMultidimArray.html#a3e6470485fbdde47cb3238520568c28d">MultidimArray::computeAvgStdev</a></div><div class="ttdeci">void computeAvgStdev(U &amp;avg, U &amp;stddev) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03422">multidim_array.h:3422</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaaee6e163d8f7e358c38d3fcfe935b6fc"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaaee6e163d8f7e358c38d3fcfe935b6fc">FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D(V1, V2)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00308">multidim_array.h:308</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga027a630a86c277b71cda769268764fd1"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a></div><div class="ttdeci">#define MULTIDIM_SIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00125">multidim_array.h:125</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Macros_html_gad584f97e936242b173add43261376ba5"><div class="ttname"><a href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a></div><div class="ttdeci">#define XMIPP_EQUAL_ACCURACY</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00119">xmipp_macros.h:119</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="classMultidimArray_html_a9e0cf9e48e99338f7698c6018a0e7ee3"><div class="ttname"><a href="classMultidimArray.html#a9e0cf9e48e99338f7698c6018a0e7ee3">MultidimArray::computeAvgStdev_within_binary_mask</a></div><div class="ttdeci">void computeAvgStdev_within_binary_mask(const MultidimArray&lt; int &gt; &amp;mask, double &amp;avg, double &amp;stddev) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03459">multidim_array.h:3459</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="group__Macros_html_ga4c9386c11dfbaac4b99d2f7799dbc0c1"><div class="ttname"><a href="group__Macros.html#ga4c9386c11dfbaac4b99d2f7799dbc0c1">SPEED_UP_tempsInt</a></div><div class="ttdeci">#define SPEED_UP_tempsInt</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00408">xmipp_macros.h:408</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a15e046b6c4b203b8a52a6acff9f1665b"><div class="ttname"><a href="classMultidimArrayBase.html#a15e046b6c4b203b8a52a6acff9f1665b">MultidimArrayBase::sameShape</a></div><div class="ttdeci">bool sameShape(const MultidimArrayBase &amp;op) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00945">multidim_array.h:945</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga89a3805023d9281763bddaf660c4fa9f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">double correntropy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Correntropy nD </p>

<p>Definition at line <a class="el" href="filters_8h_source.html#l00375">375</a> of file <a class="el" href="filters_8h_source.html">filters.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;{</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordtype">double</span> retval=0;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="libraries_2data_2integration_8cpp.html#a97d832ae23af4f215e801e37e4f94254">K</a>=-0.5/(sigma*sigma);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(x)</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    {</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keywordtype">double</span> diff=<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(x,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)-<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(y,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        retval+=exp(K*diff*diff);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    }</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    retval/=<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(x)*<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(x)*<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(x);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">return</span> retval;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="libraries_2data_2integration_8cpp_html_a97d832ae23af4f215e801e37e4f94254"><div class="ttname"><a href="libraries_2data_2integration_8cpp.html#a97d832ae23af4f215e801e37e4f94254">K</a></div><div class="ttdeci">#define K</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2integration_8cpp_source.html#l00118">integration.cpp:118</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga95d26655a427c11f6980246d08dfc6d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double denoiseTVenergy </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigmag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>g</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute energy.</p><ul>
<li>energy function 0.5*|vst(X)-Y|^2 + mu*TV(X) = data_term + mu*TV</li>
</ul>
<p>X=current image Y=sensed image mu=regularization weight (on TV norm) </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l03826">3826</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;{</div><div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;    <span class="comment">// parameter beta which role is to prevent division with zeros</span></div><div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a> = 0.00001;</div><div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> beta2 = beta*<a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>;</div><div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;</div><div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> = 0;</div><div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;    <span class="keywordtype">double</span> tv = 0;</div><div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> K1 = ((3.0/8.0)*<a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>*<a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a> + sigmag*sigmag - <a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>*<a class="code" href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a>) / (s*s);</div><div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> K2 = <a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a> * (q/(s*s));</div><div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> K3 = 2.0 / <a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>;</div><div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;    <span class="keywordtype">double</span> Xij, Yij, dXx, dXy, <a class="code" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a>, msqrt;</div><div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;    <span class="keywordtype">int</span> i1, j1;</div><div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;</div><div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a>(X)</div><div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;    {</div><div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;        Xij = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(X,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;        Yij = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(Y,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;        i1 = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1;</div><div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;        <span class="keywordflow">if</span> (i1==<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(X))</div><div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;           i1 = 0;</div><div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;        j1 = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + 1;</div><div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;        <span class="keywordflow">if</span> (j1==<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(X))</div><div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;           j1 = 0;</div><div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;</div><div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;        dXx = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(X,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,j1) - Xij;</div><div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;        dXy = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(X,i1,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) - Xij;</div><div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;        tv += <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(dXx*dXx + dXy*dXy + beta2);</div><div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;</div><div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;        d = K2*Xij + K1;</div><div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;        msqrt = K3 * <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(<a class="code" href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">std::max</a>(0.0, d)) - Yij;</div><div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;        m += msqrt*msqrt;</div><div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;    }</div><div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;    <span class="keywordflow">return</span> 0.5*m + <a class="code" href="image__find__center_8cpp.html#a22f64139a5ad2efe7d615cbf014e88d5">mu</a>*tv;</div><div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga9ed4376d9ad511e963caf118a6640b28"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a></div><div class="ttdeci">#define DIRECT_A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00351">multidim_array.h:351</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af72286acf4184005499476fbc853146f"><div class="ttname"><a href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a></div><div class="ttdeci">doublereal * g</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02490">numerical_recipes.cpp:2490</a></div></div>
<div class="ttc" id="namespacealglib_html_a038c39f3bfe0dff667a2cb6bebfed764"><div class="ttname"><a href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">alglib::beta</a></div><div class="ttdeci">double beta(const double a, const double b)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l00962">specialfunctions.cpp:962</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3939496af6ccffe20d083935ebd3225b"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a></div><div class="ttdeci">doublereal * d</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca36b09d6e71a60cfa3837d7e24c07ca"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a></div><div class="ttdeci">double * lambda</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04431">numerical_recipes.cpp:4431</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_ac5474a01d203d14c046620266b2f1954"><div class="ttname"><a href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">max</a></div><div class="ttdeci">void max(Image&lt; double &gt; &amp;op1, const Image&lt; double &gt; &amp;op2)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00125">image_operate.cpp:125</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a438c75002165fed58970c95d67a268c1"><div class="ttname"><a href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a></div><div class="ttdeci">int m</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4e8db4e5757ca2f6e233d0a1eec7ff1c"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00519">multidim_array.h:519</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a22f64139a5ad2efe7d615cbf014e88d5"><div class="ttname"><a href="image__find__center_8cpp.html#a22f64139a5ad2efe7d615cbf014e88d5">mu</a></div><div class="ttdeci">int mu</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00053">image_find_center.cpp:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga1f9ae594e89b728ac95ed415c00f937d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void denoiseTVFilter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>xnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxIter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute denoising.</p><ul>
<li></li>
</ul>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l03975">3975</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;{</div><div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;    <span class="comment">// parameters for denoising</span></div><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a> = 1.0;    <span class="comment">// Poisson scaling factor</span></div><div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;    <span class="keywordtype">double</span> sigmag = 5.8;  <span class="comment">// Gaussian component N(g,sigma^2)</span></div><div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a> = 0.0;</div><div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;</div><div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;    <span class="comment">// *** Anscombe transformation of input image ***</span></div><div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;    <span class="keywordtype">double</span> q = 255.0;</div><div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;</div><div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;    <span class="keywordtype">double</span> xnewmin = xnew.<a class="code" href="classMultidimArray.html#a0e7a7881ec242da8ee392f465b3e3b28">computeMin</a>();</div><div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;    <span class="keywordtype">double</span> xnewscale = 255.0 / (xnew.<a class="code" href="classMultidimArray.html#a0f2229bfbeb30bc5b5b8a9b83c08279c">computeMax</a>() - xnewmin);</div><div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;</div><div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;    <span class="comment">// apply generalized Anscombe VST tranformation</span></div><div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;    <span class="keywordtype">double</span> K1 = ((3.0/8.0)*lambda*lambda + sigmag*sigmag - lambda*<a class="code" href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a>);</div><div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(xnew)</div><div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;    {</div><div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(xnew, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>) = (<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(xnew, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>) - xnewmin) * xnewscale;</div><div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(xnew, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>) = 2.0 / lambda * <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(<a class="code" href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">std::max</a>(0.0, lambda*<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(xnew, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>) + K1));</div><div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;    }</div><div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;</div><div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;    <span class="keywordtype">double</span> mx = xnew.<a class="code" href="classMultidimArray.html#a0f2229bfbeb30bc5b5b8a9b83c08279c">computeMax</a>();</div><div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;</div><div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;    <span class="comment">// xold = initial degraded image</span></div><div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> xold = <a class="code" href="numerical__recipes_8cpp.html#a9459fc814da4e9b187efc77baecf1c07">xnew</a>;</div><div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> grold = <a class="code" href="numerical__recipes_8cpp.html#a9459fc814da4e9b187efc77baecf1c07">xnew</a>;</div><div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> grnew = <a class="code" href="numerical__recipes_8cpp.html#a9459fc814da4e9b187efc77baecf1c07">xnew</a>;</div><div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> dold = <a class="code" href="numerical__recipes_8cpp.html#a9459fc814da4e9b187efc77baecf1c07">xnew</a>;</div><div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a>(xnew)</div><div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;    {</div><div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(xold,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(xnew,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) / mx;</div><div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;    }</div><div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> origInput = xold;</div><div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;</div><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;    <span class="comment">// *** Spectral Projected Gradient (SPG) optimization ***</span></div><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;    <span class="comment">// parameters of optimization</span></div><div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;    <span class="keywordtype">double</span> tol = 0;</div><div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#aca81c35c21e3a5f7f3a8d24504e76664">theta</a>;</div><div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;    <span class="keywordtype">double</span> thetamin = 0.001;</div><div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;    <span class="keywordtype">double</span> thetamax = 1000;</div><div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a> = 0.0001;</div><div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;    <span class="keywordtype">double</span> sigma1 = 0.1;</div><div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;    <span class="keywordtype">double</span> sigma2 = 0.9;</div><div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="image__find__center_8cpp.html#a22f64139a5ad2efe7d615cbf014e88d5">mu</a> = 0.03;</div><div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;</div><div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;    <span class="comment">// initial objective function value of xold</span></div><div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;    <span class="keywordtype">double</span> fold = <a class="code" href="group__Filters.html#ga95d26655a427c11f6980246d08dfc6d2">denoiseTVenergy</a>(mu, xold, origInput, mx, q, lambda, sigmag, g);</div><div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;</div><div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;    <span class="comment">// gradient of objective function</span></div><div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;    <a class="code" href="group__Filters.html#gaa6e7ec16d48ed8b56d7182bdb3ca6bbf">denoiseTVgradient</a>(mu, xold, origInput, mx, q, lambda, sigmag, g, grold);</div><div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;</div><div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;    <a class="code" href="group__Filters.html#ga984ebe4f19447b7fe6e0ceaf1c70e2df">denoiseTVproj</a>(xold, grold, 1.0, dold);</div><div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;</div><div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a>, ksi, fnew, s_norm, p, s2, xij;</div><div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk=1; kk &lt;= maxIter; kk++)</div><div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;    {</div><div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;        delta = 0;</div><div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;</div><div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;        <span class="comment">// make a step</span></div><div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a>(xnew)</div><div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;        {</div><div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(xnew,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(xold,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) + <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(dold,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;            delta += <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(grold,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) * <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(dold,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;        }</div><div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;</div><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;        <span class="comment">// objective function of xnew</span></div><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;        fnew = <a class="code" href="group__Filters.html#ga95d26655a427c11f6980246d08dfc6d2">denoiseTVenergy</a>(mu, xnew, origInput, mx, q, lambda, sigmag, g);</div><div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;</div><div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;        ksi = 1.0;</div><div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;</div><div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;        <span class="keywordflow">while</span> (fnew &gt; fold + gamma*ksi*delta)</div><div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;        {</div><div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;            <span class="keywordtype">double</span> ksitsl = -0.5 * (ksi*ksi) * delta / (fnew - fold - ksi*delta);</div><div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;            <span class="keywordflow">if</span> ((ksitsl &gt;= sigma1)  &amp;&amp; (ksitsl &lt;= sigma2*ksi))</div><div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;                ksi = ksitsl;</div><div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;                ksi = ksi / 2.0;</div><div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;</div><div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a>(xnew)</div><div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;            {</div><div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(xnew,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(xold,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) + ksi*<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(dold,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;            }</div><div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;</div><div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;            <span class="comment">// because we updated xnew, update also function value</span></div><div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;            fnew = <a class="code" href="group__Filters.html#ga95d26655a427c11f6980246d08dfc6d2">denoiseTVenergy</a>(mu, xnew, origInput, mx, q, lambda, sigmag, g);</div><div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;        }</div><div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;</div><div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;        <a class="code" href="group__Filters.html#gaa6e7ec16d48ed8b56d7182bdb3ca6bbf">denoiseTVgradient</a>(mu, xnew, origInput, mx, q, lambda, sigmag, g, grnew);</div><div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;</div><div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;        s_norm = -100;</div><div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;        p = 0;</div><div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;        s2 = 0;</div><div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a>(xnew)</div><div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;        {</div><div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;            xij = (<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(xnew,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) - <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(xold,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;            p += xij * (<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(grnew,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) - <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(grold,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;            s2 += xij * xij;</div><div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;            <span class="keywordflow">if</span> (xij &gt; s_norm) s_norm = xij;</div><div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;        }</div><div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;</div><div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;        <span class="keywordflow">if</span> (s_norm &lt; tol)</div><div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;</div><div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;        <span class="keywordflow">if</span> (p &lt;= 0)</div><div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;            theta = thetamax;</div><div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;            theta = <a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(thetamax, <a class="code" href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">std::max</a>(thetamin, s2/p));</div><div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;</div><div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;        <a class="code" href="group__Filters.html#ga984ebe4f19447b7fe6e0ceaf1c70e2df">denoiseTVproj</a>(xnew, grnew, theta, dold);</div><div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;</div><div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a>(xold)</div><div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;        {</div><div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(xold,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(xnew,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(grold,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(grnew,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;        }</div><div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;</div><div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;        <span class="comment">// we already computed it, let&#39;s use it for next round</span></div><div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;        fold = fnew;</div><div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;    }</div><div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;}</div><div class="ttc" id="image__operate_8cpp_html_afbbd36781c10524238c70745c6f6f35d"><div class="ttname"><a href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">min</a></div><div class="ttdeci">void min(Image&lt; double &gt; &amp;op1, const Image&lt; double &gt; &amp;op2)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00115">image_operate.cpp:115</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9ed4376d9ad511e963caf118a6640b28"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a></div><div class="ttdeci">#define DIRECT_A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00351">multidim_array.h:351</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af72286acf4184005499476fbc853146f"><div class="ttname"><a href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a></div><div class="ttdeci">doublereal * g</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02490">numerical_recipes.cpp:2490</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_acf097d43154f3f002dbb9692ce4c55f7"><div class="ttname"><a href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a></div><div class="ttdeci">double * gamma</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07616">numerical_recipes.cpp:7616</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca81c35c21e3a5f7f3a8d24504e76664"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca81c35c21e3a5f7f3a8d24504e76664">theta</a></div><div class="ttdeci">double theta</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l06233">numerical_recipes.cpp:6233</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca36b09d6e71a60cfa3837d7e24c07ca"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a></div><div class="ttdeci">double * lambda</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04431">numerical_recipes.cpp:4431</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_ac5474a01d203d14c046620266b2f1954"><div class="ttname"><a href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">max</a></div><div class="ttdeci">void max(Image&lt; double &gt; &amp;op1, const Image&lt; double &gt; &amp;op2)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00125">image_operate.cpp:125</a></div></div>
<div class="ttc" id="group__Filters_html_ga984ebe4f19447b7fe6e0ceaf1c70e2df"><div class="ttname"><a href="group__Filters.html#ga984ebe4f19447b7fe6e0ceaf1c70e2df">denoiseTVproj</a></div><div class="ttdeci">void denoiseTVproj(const MultidimArray&lt; double &gt; &amp;X, const MultidimArray&lt; double &gt; &amp;Y, double theta, MultidimArray&lt; double &gt; &amp;dold)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l03954">filters.cpp:3954</a></div></div>
<div class="ttc" id="classMultidimArray_html_a0e7a7881ec242da8ee392f465b3e3b28"><div class="ttname"><a href="classMultidimArray.html#a0e7a7881ec242da8ee392f465b3e3b28">MultidimArray::computeMin</a></div><div class="ttdeci">T computeMin() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03154">multidim_array.h:3154</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4e8db4e5757ca2f6e233d0a1eec7ff1c"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00519">multidim_array.h:519</a></div></div>
<div class="ttc" id="classMultidimArray_html_a0f2229bfbeb30bc5b5b8a9b83c08279c"><div class="ttname"><a href="classMultidimArray.html#a0f2229bfbeb30bc5b5b8a9b83c08279c">MultidimArray::computeMax</a></div><div class="ttdeci">T computeMax() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03123">multidim_array.h:3123</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a22f64139a5ad2efe7d615cbf014e88d5"><div class="ttname"><a href="image__find__center_8cpp.html#a22f64139a5ad2efe7d615cbf014e88d5">mu</a></div><div class="ttdeci">int mu</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00053">image_find_center.cpp:53</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="group__Filters_html_gaa6e7ec16d48ed8b56d7182bdb3ca6bbf"><div class="ttname"><a href="group__Filters.html#gaa6e7ec16d48ed8b56d7182bdb3ca6bbf">denoiseTVgradient</a></div><div class="ttdeci">void denoiseTVgradient(double mu, const MultidimArray&lt; double &gt; &amp;X, const MultidimArray&lt; double &gt; &amp;Y, double s, double q, double lambda, double sigmag, double g, MultidimArray&lt; double &gt; &amp;gradientI)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l03878">filters.cpp:3878</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="group__Filters_html_ga95d26655a427c11f6980246d08dfc6d2"><div class="ttname"><a href="group__Filters.html#ga95d26655a427c11f6980246d08dfc6d2">denoiseTVenergy</a></div><div class="ttdeci">double denoiseTVenergy(double mu, const MultidimArray&lt; double &gt; &amp;X, const MultidimArray&lt; double &gt; &amp;Y, double s, double q, double lambda, double sigmag, double g)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l03826">filters.cpp:3826</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a9459fc814da4e9b187efc77baecf1c07"><div class="ttname"><a href="numerical__recipes_8cpp.html#a9459fc814da4e9b187efc77baecf1c07">xnew</a></div><div class="ttdeci">double * xnew</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07206">numerical_recipes.cpp:7206</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a9ea1a8f5ef3e6d20b362385e1288c72c"><div class="ttname"><a href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a></div><div class="ttdeci">double * delta</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07616">numerical_recipes.cpp:7616</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaa6e7ec16d48ed8b56d7182bdb3ca6bbf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void denoiseTVgradient </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigmag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>gradientI</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute gradient.</p><ul>
<li>Jacobian of Energy_TV 0.5*|vst(X)-Y|^2 + mu*TV(X)</li>
</ul>
<p>X=current image Y=sensed image mu=regularization weight (on TV norm) </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l03878">3878</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;{</div><div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;    <span class="comment">// parameter beta which role is to prevent division with zeros</span></div><div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a> = 0.00001;</div><div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> beta2 = beta*<a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>;</div><div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;</div><div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a> = X;</div><div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;    <span class="keywordtype">double</span> K1 = ((3.0/8.0)*<a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>*<a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a> + sigmag*sigmag - <a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>*<a class="code" href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a>) / (s*s);</div><div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;    <span class="keywordtype">double</span> K2 = <a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a> * (q/s*s);</div><div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;    <span class="keywordtype">double</span> K3 = (2.0 / (<a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>*<a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>)) * (q / (s*s)) * <a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>;</div><div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;    <span class="keywordtype">double</span> Xij, Yij, dXx, dXy, dij, d_left, d_up, X_left, X_right, X_up, X_down, dTV, dE;</div><div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;    <span class="keywordtype">int</span> i1, j1, i_1, j_1;</div><div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;</div><div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a>(X)</div><div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;    {</div><div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;        Xij = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(X,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;        i1 = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1;</div><div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;        <span class="keywordflow">if</span> (i1==<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(X))</div><div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;           i1 = 0;</div><div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;        j1 = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + 1;</div><div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;        <span class="keywordflow">if</span> (j1==<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(X))</div><div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;           j1 = 0;</div><div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;</div><div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;        dXx = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(X,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,j1) - Xij;</div><div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;        dXy = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(X,i1,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) - Xij;</div><div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(d,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 1.0 / <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(dXx*dXx + dXy*dXy + beta2);</div><div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;    }</div><div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;</div><div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a>(d)</div><div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;    {</div><div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;        dij = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(d,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;        Xij = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(X,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;        Yij = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(Y,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;        i1 = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1;</div><div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;        <span class="keywordflow">if</span> (i1==<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(d))</div><div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;           i1 = 0;</div><div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;        j1 = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + 1;</div><div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;        <span class="keywordflow">if</span> (j1==<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(d))</div><div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;           j1 = 0;</div><div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;        i_1 = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1;</div><div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;        <span class="keywordflow">if</span> (i_1==-1)</div><div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;           i_1 = <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(d) - 1;</div><div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;        j_1 = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - 1;</div><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;        <span class="keywordflow">if</span> (j_1==-1)</div><div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;           j_1 = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(d) - 1;</div><div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;</div><div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;        d_left = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(d,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,j_1);</div><div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;        d_up = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(d,i_1,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;        X_left = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(X,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,j_1);</div><div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;        X_right = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(X,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,j1);</div><div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;        X_up = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(X,i_1,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;        X_down = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(X,i1,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;</div><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;        dTV = Xij * (2.0*dij + d_left + d_up) - X_left*d_left - X_up*d_up - dij*(X_right + X_down);</div><div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;</div><div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;        <span class="keywordflow">if</span> (K2*Xij + K1 &gt; 0)</div><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;            dE = K3 - (q / (s*s)) * Yij / <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>((Xij * (q / (s*s)) * <a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a> + K1));</div><div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;            dE = 0;</div><div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;</div><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(gradientI,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = dE + <a class="code" href="image__find__center_8cpp.html#a22f64139a5ad2efe7d615cbf014e88d5">mu</a>*dTV;</div><div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;    }</div><div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9ed4376d9ad511e963caf118a6640b28"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a></div><div class="ttdeci">#define DIRECT_A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00351">multidim_array.h:351</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af72286acf4184005499476fbc853146f"><div class="ttname"><a href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a></div><div class="ttdeci">doublereal * g</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02490">numerical_recipes.cpp:2490</a></div></div>
<div class="ttc" id="namespacealglib_html_a038c39f3bfe0dff667a2cb6bebfed764"><div class="ttname"><a href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">alglib::beta</a></div><div class="ttdeci">double beta(const double a, const double b)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l00962">specialfunctions.cpp:962</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3939496af6ccffe20d083935ebd3225b"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a></div><div class="ttdeci">doublereal * d</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca36b09d6e71a60cfa3837d7e24c07ca"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a></div><div class="ttdeci">double * lambda</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04431">numerical_recipes.cpp:4431</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4e8db4e5757ca2f6e233d0a1eec7ff1c"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00519">multidim_array.h:519</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a22f64139a5ad2efe7d615cbf014e88d5"><div class="ttname"><a href="image__find__center_8cpp.html#a22f64139a5ad2efe7d615cbf014e88d5">mu</a></div><div class="ttdeci">int mu</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00053">image_find_center.cpp:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga984ebe4f19447b7fe6e0ceaf1c70e2df"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void denoiseTVproj </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>dold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function which makes projections on feasible set.</p><ul>
<li></li>
</ul>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l03954">3954</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;{</div><div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;    <span class="keywordtype">double</span> div;</div><div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a>(X)</div><div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;    {</div><div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;        div = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(X,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) - (<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(Y,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)*<a class="code" href="numerical__recipes_8cpp.html#aca81c35c21e3a5f7f3a8d24504e76664">theta</a>);</div><div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;        <span class="keywordflow">if</span> (div &lt; 0)</div><div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;           <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(dold,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 0 - <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(X,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (div &gt; 1)</div><div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;           <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(dold,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 1 - <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(X,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;           <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(dold,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = div - <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(X,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;    }</div><div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga9ed4376d9ad511e963caf118a6640b28"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a></div><div class="ttdeci">#define DIRECT_A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00351">multidim_array.h:351</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca81c35c21e3a5f7f3a8d24504e76664"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca81c35c21e3a5f7f3a8d24504e76664">theta</a></div><div class="ttdeci">double theta</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l06233">numerical_recipes.cpp:6233</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4e8db4e5757ca2f6e233d0a1eec7ff1c"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00519">multidim_array.h:519</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gad6a9f8505bb986b25457d7e4b91819d7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void detectBackground </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>final_mean</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Detect background</p>
<p>This function receives a Matrix3D vol, and try to find the background assuming that all the outside planes contain background, and apply interval confidence, were alpha is the probabity to fail. <a class="el" href="classMask.html">Mask</a> is of the same size of vol, and is the solution, mask have value 1 if background else value 0 </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l00191">191</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;{</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">// 2.1.-Background detection------------------------------------------</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> bg; <span class="comment">// We create the volumen with</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    bg.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(vol); <span class="comment">// -1:not visited 0:mol 1:background</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    bg.<a class="code" href="classMultidimArray.html#a239f45b043ed7715dec4d44ceef74dce">initConstant</a>(-1); <span class="comment">// -2:in the list</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// Ponemos las seis caras de esta variable como visitadas e inicializamos</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// la cola de pixeles por visitar</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    std::queue&lt;int&gt; list_for_compute; <span class="comment">// Lista del modo [x1,y1,z1,...,xi,yi,zi]</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// que contiene los pixeles por procesar</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    std::vector&lt;double&gt; bg_values; <span class="comment">// Vector con los valores del background</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordtype">size_t</span> xdim = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(bg);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordtype">size_t</span> ydim = <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(bg);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordtype">size_t</span> zdim = <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(bg);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga46aa4ed12bd8706cfe1456ec6a8ab768">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D</a>(bg)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    {</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> == 0 || <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> == xdim - 1 || <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> == 0 || <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> == ydim - 1 || <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> == 0</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            || <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> == zdim - 1)</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        { <span class="comment">// Visited coord</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(bg,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 1;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <span class="comment">// We introduce the values of the background</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            bg_values.push_back(<a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(vol,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> == 1 || <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> == xdim - 2) &amp;&amp; (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> != 0) &amp;&amp; (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> != ydim - 1) &amp;&amp; (<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> != 0)</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            &amp;&amp; (<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> != zdim - 1))</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        { <span class="comment">// Coord for compute for x</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            list_for_compute.push(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            list_for_compute.push(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            list_for_compute.push(<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> == 1 || <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> == ydim - 2) &amp;&amp; (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &gt; 1) &amp;&amp; (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; xdim - 2) &amp;&amp; (<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> != 0)</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            &amp;&amp; (<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> != zdim - 1))</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        { <span class="comment">// Coord for compute for y</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            list_for_compute.push(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            list_for_compute.push(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            list_for_compute.push(<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> == 1 || <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> == zdim - 2) &amp;&amp; (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &gt; 1) &amp;&amp; (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; xdim - 2) &amp;&amp; (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt; 1)</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            &amp;&amp; (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ydim - 2))</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        { <span class="comment">// Coord for compute for y</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            list_for_compute.push(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            list_for_compute.push(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            list_for_compute.push(<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    } <span class="comment">// end of FOR_ALL_ELEMENTS</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">// We work until the list_for_compute is empty</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = 250; <span class="comment">//each 250 pixels renew stats</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordtype">int</span> cont = 250; <span class="comment">//We start here for compute stat for first time</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordtype">double</span> A=0; <span class="comment">// A and B are numbers such the interval of confidence is [A,B]</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordtype">double</span> B=0; <span class="comment">//</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> = <a class="code" href="group__GeneralFunctions.html#gacc51978aefbb0697039a15c6a37c429f">icdf_gauss</a>(1 - alpha / 2);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">while</span> (!list_for_compute.empty())</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="comment">//We compute stat when is needed</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">if</span> (cont == n)</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        {</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="comment">// Compute statistics</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <span class="keywordtype">double</span> avg=0, stddev=0;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <a class="code" href="group__GeneralFunctions.html#ga876dec7720e0f464ba2edc037771fe74">computeAvgStddev</a>(bg_values, avg, stddev);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            final_mean = avg;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="comment">// Compute confidence interval</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            A = avg - (z * stddev);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            B = avg + (z * stddev);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            cont = 0;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        } <span class="comment">// end of if</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="comment">// Now we start to take coords from the list_for_compute</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordtype">int</span> x_coord = list_for_compute.front();</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        list_for_compute.pop();</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordtype">int</span> y_coord = list_for_compute.front();</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        list_for_compute.pop();</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keywordtype">int</span> z_coord = list_for_compute.front();</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        list_for_compute.pop();</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="comment">// Is visited</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(bg,z_coord,y_coord,x_coord) = -2;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="comment">//We take the value</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordtype">double</span> value = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(vol,z_coord,y_coord,x_coord);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment">// We see if is background or not</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">if</span> (A &lt;= value &amp;&amp; value &lt;= B)</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        {</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <span class="comment">// We now is background</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(bg,z_coord,y_coord,x_coord) = 1;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="comment">// We introduce the values of the background</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            bg_values.push_back(value);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="comment">// We update the cont variable</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            cont++;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="comment">// We add his neighbours in the list_for_compute</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> xx = x_coord - 1; xx &lt;= x_coord + 1; xx++)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy = y_coord - 1; yy &lt;= y_coord + 1; yy++)</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> zz = z_coord - 1; zz &lt;= z_coord + 1; zz++)</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                        <span class="comment">//We see if it has been visited</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(bg,zz,yy,xx) == -1) <span class="comment">// not visited</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                        {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                            <span class="comment">// So we include it in the list</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                            list_for_compute.push(xx);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                            list_for_compute.push(yy);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                            list_for_compute.push(zz);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                            <span class="comment">// Is in the list</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                            <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(bg,zz,yy,xx) = -2;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                        }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        } <span class="comment">// end of if</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        {</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="comment">// Isn&#39;t background</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(bg,z_coord,y_coord,x_coord) = 0;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    } <span class="comment">// end of while</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">// Now we change not visited for mol</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga46aa4ed12bd8706cfe1456ec6a8ab768">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D</a>(bg)</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (<a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(bg,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) == -1)</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(bg,k,i,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 0;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">// End of 2.1-----------------------------------------------------------</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">// 2.2.-Matematical Morphology</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray</a>&lt;<span class="keywordtype">double</span>&gt; bg_mm; <span class="comment">// We create the output volumen</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    bg_mm.initZeros(vol);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="group__MathematicalMorphology.html#ga2ae3cc5e483a9e07b85a54c46dde40fb">closing3D</a>(bg, bg_mm, 26, 0, 1);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">// Output</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">//typeCast(bg_mm,mask);</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    mask = bg_mm;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classMultidimArray_html_ac0efebfb32ab4e37cf33efca3349aa9b"><div class="ttname"><a href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">MultidimArray::resizeNoCopy</a></div><div class="ttdeci">void resizeNoCopy(const MultidimArray&lt; T1 &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01702">multidim_array.h:1702</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gacac7be97c37bd2e4f801976749de839c"><div class="ttname"><a href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a></div><div class="ttdeci">#define DIRECT_A3D_ELEM(v, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00249">multidim_array.h:249</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_gacc51978aefbb0697039a15c6a37c429f"><div class="ttname"><a href="group__GeneralFunctions.html#gacc51978aefbb0697039a15c6a37c429f">icdf_gauss</a></div><div class="ttdeci">double icdf_gauss(double p)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00203">xmipp_funcs.cpp:203</a></div></div>
<div class="ttc" id="classMultidimArray_html_a239f45b043ed7715dec4d44ceef74dce"><div class="ttname"><a href="classMultidimArray.html#a239f45b043ed7715dec4d44ceef74dce">MultidimArray::initConstant</a></div><div class="ttdeci">void initConstant(T val)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04309">multidim_array.h:4309</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="group__MathematicalMorphology_html_ga2ae3cc5e483a9e07b85a54c46dde40fb"><div class="ttname"><a href="group__MathematicalMorphology.html#ga2ae3cc5e483a9e07b85a54c46dde40fb">closing3D</a></div><div class="ttdeci">void closing3D(const MultidimArray&lt; double &gt; &amp;in, MultidimArray&lt; double &gt; &amp;out, int neig, int count, int size)</div><div class="ttdef"><b>Definition:</b> <a href="morphology_8cpp_source.html#l00420">morphology.cpp:420</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga46aa4ed12bd8706cfe1456ec6a8ab768"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga46aa4ed12bd8706cfe1456ec6a8ab768">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00332">multidim_array.h:332</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga876dec7720e0f464ba2edc037771fe74"><div class="ttname"><a href="group__GeneralFunctions.html#ga876dec7720e0f464ba2edc037771fe74">computeAvgStddev</a></div><div class="ttdeci">void computeAvgStddev(const std::vector&lt; T &gt; &amp;V, double &amp;avg, double &amp;stddev)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8h_source.html#l00372">xmipp_funcs.h:372</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aa508e3dbd0e86258b5c69e8a8b6b8295"><div class="ttname"><a href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08509">numerical_recipes.cpp:8509</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaedfae28239982fe610a700b1365a919f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void distanceTransform </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wrap</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>L1 distance transform</p>
<p>If wrap is set, the image borders are wrapped around. This is useful if the image coordinates represent angles </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l00572">572</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;{</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    std::list&lt;int&gt; toExplore; <span class="comment">/* A list of points to explore */</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    in.checkDimension(2);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    out.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(in);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    out.<a class="code" href="classMultidimArray.html#a239f45b043ed7715dec4d44ceef74dce">initConstant</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(in) + <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(in));</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="preprocessor">#define CHECK_POINT_DIST(i,j,proposedDistance) \</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="preprocessor">    { \</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="preprocessor">        int ip=i; \</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="preprocessor">        int jp=j; \</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="preprocessor">        if (wrap) \</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="preprocessor">        { \</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="preprocessor">            ip=intWRAP(ip,STARTINGY(out),FINISHINGY(out));\</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="preprocessor">            jp=intWRAP(jp,STARTINGX(out),FINISHINGX(out));\</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="preprocessor">        } \</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="preprocessor">        if (ip&gt;=STARTINGY(out) &amp;&amp; ip&lt;=FINISHINGY(out) &amp;&amp; \</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="preprocessor">            jp&gt;=STARTINGX(out) &amp;&amp; jp&lt;=FINISHINGX(out)) \</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="preprocessor">            if (out(ip,jp)&gt;proposedDistance) \</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="preprocessor">            { \</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="preprocessor">                out(ip,jp)=proposedDistance; \</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="preprocessor">                toExplore.push_back(ip); \</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="preprocessor">                toExplore.push_back(jp); \</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="preprocessor">                toExplore.push_back(proposedDistance); \</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="preprocessor">            } \</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="preprocessor">    }</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="comment">// Look for all elements in the binary mask and set the corresponding</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="comment">// distance to 0</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(in)</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (in(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>))</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    {</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        out(i, j) = 0;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <a class="code" href="filters_8cpp.html#acb31dfe59b3610a058f15e7e56af5f66">CHECK_POINT_DIST</a>(i-1, j, 1);</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <a class="code" href="filters_8cpp.html#acb31dfe59b3610a058f15e7e56af5f66">CHECK_POINT_DIST</a>(i+1, j, 1);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <a class="code" href="filters_8cpp.html#acb31dfe59b3610a058f15e7e56af5f66">CHECK_POINT_DIST</a>(i, j-1, 1);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <a class="code" href="filters_8cpp.html#acb31dfe59b3610a058f15e7e56af5f66">CHECK_POINT_DIST</a>(i, j+1, 1);</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    }</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordflow">while</span> (!toExplore.empty())</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    {</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = toExplore.front();</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        toExplore.pop_front();</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = toExplore.front();</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        toExplore.pop_front();</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="keywordtype">int</span> proposedDistance = toExplore.front();</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        toExplore.pop_front();</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="keywordflow">if</span> (proposedDistance == out(i, j))</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        {</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            <span class="comment">// If this is the current distance (i.e., it has not</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <span class="comment">// been supersceded by a later value</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <a class="code" href="filters_8cpp.html#acb31dfe59b3610a058f15e7e56af5f66">CHECK_POINT_DIST</a>(i-1, j, proposedDistance+1);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            <a class="code" href="filters_8cpp.html#acb31dfe59b3610a058f15e7e56af5f66">CHECK_POINT_DIST</a>(i+1, j, proposedDistance+1);</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            <a class="code" href="filters_8cpp.html#acb31dfe59b3610a058f15e7e56af5f66">CHECK_POINT_DIST</a>(i, j-1, proposedDistance+1);</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            <a class="code" href="filters_8cpp.html#acb31dfe59b3610a058f15e7e56af5f66">CHECK_POINT_DIST</a>(i, j+1, proposedDistance+1);</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        }</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    }</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="classMultidimArray_html_a239f45b043ed7715dec4d44ceef74dce"><div class="ttname"><a href="classMultidimArray.html#a239f45b043ed7715dec4d44ceef74dce">MultidimArray::initConstant</a></div><div class="ttdeci">void initConstant(T val)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04309">multidim_array.h:4309</a></div></div>
<div class="ttc" id="filters_8cpp_html_acb31dfe59b3610a058f15e7e56af5f66"><div class="ttname"><a href="filters_8cpp.html#acb31dfe59b3610a058f15e7e56af5f66">CHECK_POINT_DIST</a></div><div class="ttdeci">#define CHECK_POINT_DIST(i, j, proposedDistance)</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00400">multidim_array.h:400</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaa3fef57b51522c9a6b9534ee50a3ed68"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double EntropyOtsuSegmentation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>percentil</em> = <code>0.05</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>binarizeVolume</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Segment an object using a combination of Otsu and Entropy method</p>
<p>The combination aims at minimizing Z(t)=-log10(sigma2B(t))/H(t) Minimizing the intraclass variance in Otsu is the same as maximizing sigma2B. H is the entropy of the two classes in the entropy method.</p>
<p>Then, the lowest percentil of Z is computed. The threshold applied to the volume is the first value in the curve Z(t) falling below this percentil.</p>
<p>The binarization threshold is returned </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01111">1111</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;{</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <span class="comment">//V.checkDimension(3);</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="comment">// Compute the probability density function</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <a class="code" href="classHistogram1D.html">Histogram1D</a> hist;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    hist.<a class="code" href="classHistogram1D.html#a2612603a91b3722d943f56d983903870">clear</a>();</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <a class="code" href="group__Histograms.html#gaaa3501212e9e03d46c6e7aba56dd6c21">compute_hist</a>(V, hist, 300);</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    hist /= hist.<a class="code" href="classMultidimArray.html#a2917347534008460dd52e90049e4257f">sum</a>();</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="comment">// Compute the cumulative 0th and 1st order moments</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> mom0, mom1;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    mom0.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(hist));</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    mom1.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(hist));</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    mom0(0) = hist(0);</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    hist.<a class="code" href="classHistogram1D.html#a5b24f78917ecda9d47e420b3a6c4cbd7">index2val</a>(0, x);</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    mom1(0) = hist(0) * <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(mom0); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    {</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        mom0(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = mom0(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1) + hist(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        hist.<a class="code" href="classHistogram1D.html#a5b24f78917ecda9d47e420b3a6c4cbd7">index2val</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, x);</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        mom1(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = mom1(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1) + hist(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) * <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    }</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="comment">// Entropy for black and white parts of the histogram</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#aa571c8173dde514963e974e8c1da1945">epsilon</a> = 1e-15;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> h1, h2;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    h1.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(hist));</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    h2.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(hist));</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(hist); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    {</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        <span class="comment">// Entropy h1</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        <span class="keywordtype">double</span> w1 = mom0(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="keywordflow">if</span> (w1 &gt; epsilon)</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ii = 0; ii &lt;= <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; ii++)</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                <span class="keywordflow">if</span> (hist(ii) &gt; epsilon)</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                {</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                    <span class="keywordtype">double</span> aux = hist(ii) / w1;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                    h1(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) -= aux * <a class="code" href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a>(aux);</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                }</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        <span class="comment">// Entropy h2</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        <span class="keywordtype">double</span> w2 = 1 - mom0(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        <span class="keywordflow">if</span> (w2 &gt; epsilon)</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ii = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1; ii &lt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(hist); ii++)</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                <span class="keywordflow">if</span> (hist(ii) &gt; <a class="code" href="numerical__recipes_8cpp.html#aa571c8173dde514963e974e8c1da1945">epsilon</a>)</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                {</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                    <span class="keywordtype">double</span> aux = hist(ii) / w2;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                    h2(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) -= aux * <a class="code" href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a>(aux);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                }</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    }</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="comment">// Compute sigma2B and H</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> sigma2B, H, HSigma2B;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    sigma2B.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(hist) - 1);</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    H.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(hist) - 1);</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    HSigma2B.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(hist) - 1);</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(hist) - 1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    {</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;        <span class="keywordtype">double</span> w1 = mom0(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;        <span class="keywordtype">double</span> w2 = 1 - mom0(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="image__find__center_8cpp.html#aa79b8200b59d9c1ab483f97752ffa5e7">mu1</a> = mom1(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        <span class="keywordtype">double</span> mu2 = mom1(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(mom1) - 1) - mom1(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        sigma2B(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = w1 * w2 * (mu1 - mu2) * (mu1 - mu2);</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;        H(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = h1(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) + h2(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        HSigma2B(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = -<a class="code" href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a>(sigma2B(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)) / H(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;        <span class="comment">// The logic behind this expression is</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        <span class="comment">// Otsu:    max sigma2B -&gt; max log10(sigma2B) -&gt; min -log10(sigma2B)</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        <span class="comment">// Entropy: max H       -&gt; max H              -&gt; min 1/H</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    }</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="comment">// Sort HSigma2B and take a given percentage of it</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> HSigma2Bsorted;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    HSigma2B.<a class="code" href="classMultidimArray.html#a403f14f21a01a4a29c632a85a8ebea14">sort</a>(HSigma2Bsorted);</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="keywordtype">int</span> iTh = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(HSigma2B)*percentil);</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="lib__vwk_8cpp.html#a2834b5125eb5ac411feb578af1fac2ea">threshold</a> = HSigma2Bsorted(iTh);</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="comment">// Find the first value within HSigma2B falling below this threshold</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    iTh = 0;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(HSigma2B,iTh) &gt;= threshold)</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        iTh++;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    iTh--;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="keywordflow">if</span> (iTh &lt;= 0)</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        x = <a class="code" href="lib__vwk_8cpp.html#a2834b5125eb5ac411feb578af1fac2ea">threshold</a>;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        hist.<a class="code" href="classHistogram1D.html#a5b24f78917ecda9d47e420b3a6c4cbd7">index2val</a>(iTh, x);</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="keywordflow">if</span> (binarizeVolume)</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        V.<a class="code" href="classMultidimArray.html#a5bb8c617896c704c673d270308e4c012">binarize</a>(x);</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;}</div><div class="ttc" id="classHistogram1D_html_a2612603a91b3722d943f56d983903870"><div class="ttname"><a href="classHistogram1D.html#a2612603a91b3722d943f56d983903870">Histogram1D::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00038">histogram.cpp:38</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga97809f7244a28aaa1c26e29e6e3204ef"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a></div><div class="ttdeci">#define A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00549">multidim_array.h:549</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classHistogram1D_html"><div class="ttname"><a href="classHistogram1D.html">Histogram1D</a></div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00121">histogram.h:121</a></div></div>
<div class="ttc" id="classHistogram1D_html_a5b24f78917ecda9d47e420b3a6c4cbd7"><div class="ttname"><a href="classHistogram1D.html#a5b24f78917ecda9d47e420b3a6c4cbd7">Histogram1D::index2val</a></div><div class="ttdeci">void index2val(double i, double &amp;v) const </div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00295">histogram.h:295</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="lib__vwk_8cpp_html_a2834b5125eb5ac411feb578af1fac2ea"><div class="ttname"><a href="lib__vwk_8cpp.html#a2834b5125eb5ac411feb578af1fac2ea">threshold</a></div><div class="ttdeci">void threshold(double *phi, unsigned long nvox, double limit)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vwk_8cpp_source.html#l00524">lib_vwk.cpp:524</a></div></div>
<div class="ttc" id="group__Histograms_html_gaaa3501212e9e03d46c6e7aba56dd6c21"><div class="ttname"><a href="group__Histograms.html#gaaa3501212e9e03d46c6e7aba56dd6c21">compute_hist</a></div><div class="ttdeci">void compute_hist(const MultidimArrayGeneric &amp;array, Histogram1D &amp;hist, int no_steps)</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00570">histogram.cpp:570</a></div></div>
<div class="ttc" id="classMultidimArray_html_a403f14f21a01a4a29c632a85a8ebea14"><div class="ttname"><a href="classMultidimArray.html#a403f14f21a01a4a29c632a85a8ebea14">MultidimArray::sort</a></div><div class="ttdeci">void sort(MultidimArray&lt; T &gt; &amp;result) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04657">multidim_array.h:4657</a></div></div>
<div class="ttc" id="classMultidimArray_html_a5bb8c617896c704c673d270308e4c012"><div class="ttname"><a href="classMultidimArray.html#a5bb8c617896c704c673d270308e4c012">MultidimArray::binarize</a></div><div class="ttdeci">void binarize(double val=0, double accuracy=XMIPP_EQUAL_ACCURACY, MultidimArray&lt; int &gt; *mask=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04924">multidim_array.h:4924</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_aa79b8200b59d9c1ab483f97752ffa5e7"><div class="ttname"><a href="image__find__center_8cpp.html#aa79b8200b59d9c1ab483f97752ffa5e7">mu1</a></div><div class="ttdeci">int mu1</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="classMultidimArray_html_a2917347534008460dd52e90049e4257f"><div class="ttname"><a href="classMultidimArray.html#a2917347534008460dd52e90049e4257f">MultidimArray::sum</a></div><div class="ttdeci">double sum() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05095">multidim_array.h:5095</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_a3aadc7a86770372bb401fbcb4c05a252"><div class="ttname"><a href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a></div><div class="ttdeci">void log10(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00234">image_operate.cpp:234</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aa571c8173dde514963e974e8c1da1945"><div class="ttname"><a href="numerical__recipes_8cpp.html#aa571c8173dde514963e974e8c1da1945">epsilon</a></div><div class="ttdeci">double epsilon</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05721">numerical_recipes.cpp:5721</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gad571370cecac06c79cfe09ee681c134e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double EntropySegmentation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Segment an object using Entropy method</p>
<p>Entropy method determines a threshold such that the entropy of the two classes is maximized</p>
<p><a href="http://rsbweb.nih.gov/ij/plugins/download/Entropy_Threshold.java">http://rsbweb.nih.gov/ij/plugins/download/Entropy_Threshold.java</a> </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01045">1045</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;{</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="comment">// V.checkDimension(3);</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="comment">// Compute the probability density function</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <a class="code" href="classHistogram1D.html">Histogram1D</a> hist;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    hist.<a class="code" href="classHistogram1D.html#a2612603a91b3722d943f56d983903870">clear</a>();</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <a class="code" href="group__Histograms.html#gaaa3501212e9e03d46c6e7aba56dd6c21">compute_hist</a>(V, hist, 200);</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    hist /= hist.<a class="code" href="classMultidimArray.html#a2917347534008460dd52e90049e4257f">sum</a>();</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="comment">// Compute the cumulative 0th and 1st order moments</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> mom0;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    mom0.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(hist));</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    mom0(0) = hist(0);</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(mom0); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        mom0(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = mom0(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1) + hist(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="comment">// Entropy for black and white parts of the histogram</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#aa571c8173dde514963e974e8c1da1945">epsilon</a> = 1e-15;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> h1, h2;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    h1.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(hist));</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    h2.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(hist));</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(hist); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    {</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="comment">// Entropy h1</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <span class="keywordtype">double</span> w1 = mom0(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        <span class="keywordflow">if</span> (w1 &gt; epsilon)</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ii = 0; ii &lt;= <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; ii++)</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                <span class="keywordflow">if</span> (hist(ii) &gt; epsilon)</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                {</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                    <span class="keywordtype">double</span> aux = hist(ii) / w1;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                    h1(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) -= aux * <a class="code" href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a>(aux);</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                }</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        <span class="comment">// Entropy h2</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        <span class="keywordtype">double</span> w2 = 1 - mom0(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        <span class="keywordflow">if</span> (w2 &gt; epsilon)</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ii = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1; ii &lt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(hist); ii++)</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                <span class="keywordflow">if</span> (hist(ii) &gt; <a class="code" href="numerical__recipes_8cpp.html#aa571c8173dde514963e974e8c1da1945">epsilon</a>)</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                {</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                    <span class="keywordtype">double</span> aux = hist(ii) / w2;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                    h2(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) -= aux * <a class="code" href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a>(aux);</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                }</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    }</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <span class="comment">// Find histogram index with maximum entropy</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="keywordtype">double</span> Hmax = h1(0) + h2(0);</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="keywordtype">size_t</span> iHmax = 0;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(hist) - 1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    {</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <span class="keywordtype">double</span> H = h1(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) + h2(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        <span class="keywordflow">if</span> (H &gt; Hmax)</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        {</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;            Hmax = H;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;            iHmax = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        }</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    }</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    hist.<a class="code" href="classHistogram1D.html#a5b24f78917ecda9d47e420b3a6c4cbd7">index2val</a>(iHmax, x);</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    V.<a class="code" href="classMultidimArray.html#a5bb8c617896c704c673d270308e4c012">binarize</a>(x);</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;}</div><div class="ttc" id="classHistogram1D_html_a2612603a91b3722d943f56d983903870"><div class="ttname"><a href="classHistogram1D.html#a2612603a91b3722d943f56d983903870">Histogram1D::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00038">histogram.cpp:38</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classHistogram1D_html"><div class="ttname"><a href="classHistogram1D.html">Histogram1D</a></div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00121">histogram.h:121</a></div></div>
<div class="ttc" id="classHistogram1D_html_a5b24f78917ecda9d47e420b3a6c4cbd7"><div class="ttname"><a href="classHistogram1D.html#a5b24f78917ecda9d47e420b3a6c4cbd7">Histogram1D::index2val</a></div><div class="ttdeci">void index2val(double i, double &amp;v) const </div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00295">histogram.h:295</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Histograms_html_gaaa3501212e9e03d46c6e7aba56dd6c21"><div class="ttname"><a href="group__Histograms.html#gaaa3501212e9e03d46c6e7aba56dd6c21">compute_hist</a></div><div class="ttdeci">void compute_hist(const MultidimArrayGeneric &amp;array, Histogram1D &amp;hist, int no_steps)</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00570">histogram.cpp:570</a></div></div>
<div class="ttc" id="classMultidimArray_html_a5bb8c617896c704c673d270308e4c012"><div class="ttname"><a href="classMultidimArray.html#a5bb8c617896c704c673d270308e4c012">MultidimArray::binarize</a></div><div class="ttdeci">void binarize(double val=0, double accuracy=XMIPP_EQUAL_ACCURACY, MultidimArray&lt; int &gt; *mask=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04924">multidim_array.h:4924</a></div></div>
<div class="ttc" id="classMultidimArray_html_a2917347534008460dd52e90049e4257f"><div class="ttname"><a href="classMultidimArray.html#a2917347534008460dd52e90049e4257f">MultidimArray::sum</a></div><div class="ttdeci">double sum() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05095">multidim_array.h:5095</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_a3aadc7a86770372bb401fbcb4c05a252"><div class="ttname"><a href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a></div><div class="ttdeci">void log10(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00234">image_operate.cpp:234</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aa571c8173dde514963e974e8c1da1945"><div class="ttname"><a href="numerical__recipes_8cpp.html#aa571c8173dde514963e974e8c1da1945">epsilon</a></div><div class="ttdeci">double epsilon</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05721">numerical_recipes.cpp:5721</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gafdda1375d500638b811466a209b1e7d7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void estimateGaussian2D </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>mu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>estimateMu</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iterations</em> = <code>10</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fit <a class="el" href="classGaussian.html">Gaussian</a> spot to an image.</p>
<p>The fitted <a class="el" href="classGaussian.html">Gaussian</a> is a*G(r,mu,sigma)+b where G(r,mu,sigma)=exp(-0.5 * (r-mu)^t sigma^-1 (r-mu))</p>
<p>You can choose if the center is estimated or it is assumed to be 0. You can choose the number of iterations for the estiamtion. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02297">2297</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;{</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    I.checkDimension(2);</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>(I);</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;    <span class="comment">// Estimate b</span></div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    <a class="code" href="classHistogram1D.html">Histogram1D</a> hist;</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;    <a class="code" href="group__Histograms.html#gaaa3501212e9e03d46c6e7aba56dd6c21">compute_hist</a>(<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>, hist, 100);</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a> = hist.<a class="code" href="classHistogram1D.html#a2ffd1bbd9aa8bd3807d09c7b352a1ee3">percentil</a>(5);</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    <span class="comment">// Iteratively estimate all parameters</span></div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = 0; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> &lt; iterations; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>++)</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;    {</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;        <span class="comment">// Reestimate z</span></div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>)</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(I(i,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)-<a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>,0);</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;        <span class="comment">// Sum of z</span></div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;        <span class="keywordtype">double</span> T = <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>.sum();</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;        <span class="comment">// Estimate center</span></div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;        mu.initZeros(2);</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (estimateMu)</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;        {</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>)</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;            {</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;                <span class="keywordtype">double</span> val = <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>(i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;                <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(mu) += val * <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;                <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(mu) += val * <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;            }</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;            mu /= T;</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;        }</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;        <span class="comment">// Estimate sigma</span></div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        sigma.<a class="code" href="classMatrix2D.html#a35921c37b27282bac3b3868cce8feb26">initZeros</a>(2, 2);</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>)</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;        {</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;            <span class="keywordtype">double</span> val = <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;            <span class="keywordtype">double</span> j_mu = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(mu);</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;            <span class="keywordtype">double</span> i_mu = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(mu);</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;            sigma(0, 0) += val * j_mu * j_mu;</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;            sigma(0, 1) += val * i_mu * j_mu;</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;            sigma(1, 1) += val * i_mu * i_mu;</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;        }</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;        sigma(1, 0) = sigma(0, 1);</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;        sigma /= T;</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        <span class="comment">// Estimate amplitude</span></div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;        <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> sigmainv = sigma.<a class="code" href="classMatrix2D.html#add8d2052c53fcf6689908614f67b9ee6">inv</a>();</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> r(2);</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;        <span class="keywordtype">double</span> G2 = 0;</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a> = 0;</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>)</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;        {</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;            <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r) = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;            <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r) = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;            <span class="keywordtype">double</span> G = <a class="code" href="filters_8cpp.html#ac0d6795838f8d1daa7fb7f01deba9424">unnormalizedGaussian2D</a>(r, mu, sigmainv);</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;            <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a> += <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) * G;</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;            G2 += G * G;</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;        }</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a> /= G2;</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;        <span class="comment">// Reestimate b</span></div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>)</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;        {</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;            <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r) = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;            <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r) = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;            <span class="keywordtype">double</span> G = <a class="code" href="filters_8cpp.html#ac0d6795838f8d1daa7fb7f01deba9424">unnormalizedGaussian2D</a>(r, mu, sigmainv);</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;            <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = I(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) - <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a> * G;</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;        }</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;        <a class="code" href="group__Histograms.html#gaaa3501212e9e03d46c6e7aba56dd6c21">compute_hist</a>(<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>, hist, 100);</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a> = hist.<a class="code" href="classHistogram1D.html#a2ffd1bbd9aa8bd3807d09c7b352a1ee3">percentil</a>(5);</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;    }</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;}</div><div class="ttc" id="group__Macros_html_gae0a4180e923e3ffca3989e20e441aa3c"><div class="ttname"><a href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a></div><div class="ttdeci">#define XMIPP_MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00193">xmipp_macros.h:193</a></div></div>
<div class="ttc" id="classMatrix2D_html_add8d2052c53fcf6689908614f67b9ee6"><div class="ttname"><a href="classMatrix2D.html#add8d2052c53fcf6689908614f67b9ee6">Matrix2D::inv</a></div><div class="ttdeci">void inv(Matrix2D&lt; T &gt; &amp;result) const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01648">matrix2d.h:1648</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classHistogram1D_html"><div class="ttname"><a href="classHistogram1D.html">Histogram1D</a></div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00121">histogram.h:121</a></div></div>
<div class="ttc" id="classHistogram1D_html_a2ffd1bbd9aa8bd3807d09c7b352a1ee3"><div class="ttname"><a href="classHistogram1D.html#a2ffd1bbd9aa8bd3807d09c7b352a1ee3">Histogram1D::percentil</a></div><div class="ttdeci">double percentil(double percent_mass)</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00158">histogram.cpp:158</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af090b2fbbd2916bfb2e493c5162969d6"><div class="ttname"><a href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a></div><div class="ttdeci">doublereal * b</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__Histograms_html_gaaa3501212e9e03d46c6e7aba56dd6c21"><div class="ttname"><a href="group__Histograms.html#gaaa3501212e9e03d46c6e7aba56dd6c21">compute_hist</a></div><div class="ttdeci">void compute_hist(const MultidimArrayGeneric &amp;array, Histogram1D &amp;hist, int no_steps)</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00570">histogram.cpp:570</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="filters_8cpp_html_ac0d6795838f8d1daa7fb7f01deba9424"><div class="ttname"><a href="filters_8cpp.html#ac0d6795838f8d1daa7fb7f01deba9424">unnormalizedGaussian2D</a></div><div class="ttdeci">double unnormalizedGaussian2D(const Matrix1D&lt; double &gt; &amp;r, const Matrix1D&lt; double &gt; &amp;mu, const Matrix2D&lt; double &gt; &amp;sigmainv)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l02286">filters.cpp:2286</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00400">multidim_array.h:400</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aa508e3dbd0e86258b5c69e8a8b6b8295"><div class="ttname"><a href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08509">numerical_recipes.cpp:8509</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classMatrix2D_html_a35921c37b27282bac3b3868cce8feb26"><div class="ttname"><a href="classMatrix2D.html#a35921c37b27282bac3b3868cce8feb26">Matrix2D::initZeros</a></div><div class="ttdeci">void initZeros()</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00779">matrix2d.h:779</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af2a333b1670df64a88d3a2f22210d155"><div class="ttname"><a href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a></div><div class="ttdeci">doublereal * a</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gae47fe945bf87f1eadce22969939ffefd"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">double euclidianDistance </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>mask</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>euclidian distance nD </p>

<p>Definition at line <a class="el" href="filters_8h_source.html#l00653">653</a> of file <a class="el" href="filters_8h_source.html">filters.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;{</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <a class="code" href="group__Macros.html#ga536d5c60e25ce994a433d115ca6de5c9">SPEED_UP_temps</a>;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keywordtype">double</span> retval = 0;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordtype">long</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = 0;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gaaee6e163d8f7e358c38d3fcfe935b6fc">FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D</a>(x, y)</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    {</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <span class="keywordflow">if</span> (mask != NULL)</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            <span class="keywordflow">if</span> (!(*mask)(<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>))</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        retval += (<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(x, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) - <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(y, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)) *</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                  (<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(x, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) - <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(y, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        n++;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    }</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keywordflow">if</span> (n != 0)</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(retval);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaaee6e163d8f7e358c38d3fcfe935b6fc"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaaee6e163d8f7e358c38d3fcfe935b6fc">FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D(V1, V2)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00308">multidim_array.h:308</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Macros_html_ga536d5c60e25ce994a433d115ca6de5c9"><div class="ttname"><a href="group__Macros.html#ga536d5c60e25ce994a433d115ca6de5c9">SPEED_UP_temps</a></div><div class="ttdeci">#define SPEED_UP_temps</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00419">xmipp_macros.h:419</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga934a0edcfafeb2ddcb4cbe6984232174"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">double fastCorrentropy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classGaussianInterpolator.html">GaussianInterpolator</a> &amp;&#160;</td>
          <td class="paramname"><em>G</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fast Correntropy 1D </p>

<p>Definition at line <a class="el" href="filters_8h_source.html#l00355">355</a> of file <a class="el" href="filters_8h_source.html">filters.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;{</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordtype">double</span> retval=0;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordtype">double</span> isigma=1.0/sigma;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(x)</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    retval+=G.getValue(isigma*(<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(x,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)-</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                               <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(y,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)));</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    retval/=<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(x);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a5ea9a6a7bd724d30070df9316ccc8199">return</a> retval;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a5ea9a6a7bd724d30070df9316ccc8199"><div class="ttname"><a href="numerical__recipes_8cpp.html#a5ea9a6a7bd724d30070df9316ccc8199">return</a></div><div class="ttdeci">return</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02411">numerical_recipes.cpp:2411</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaddc3b1a64352caf229f19d303638cdab"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">double fastMaskedCorrelation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Correlation nD </p>

<p>Definition at line <a class="el" href="filters_8h_source.html#l00304">304</a> of file <a class="el" href="filters_8h_source.html">filters.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;{</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordtype">double</span> retval = 0; <span class="comment">// returned value</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordtype">long</span> N = 0;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(x)</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(mask,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>))</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        {</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            retval += <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(x, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>) * <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(y, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            ++N;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    }</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">return</span> retval / N;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gac791e3efb9f9ee463b182ad5400cf748"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fillBinaryObject </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>neighbourhood</em> = <code>8</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fill object</p>
<p>Everything that is not background is assumed to be object. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l00748">748</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;{</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    I.checkDimension(2);</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> label;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(I)</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    I(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 1 - I(i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <a class="code" href="group__Filters.html#ga206a93c383ad7f6ba43c67f18486cc21">labelImage2D</a>(I, label, neighbourhood);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordtype">double</span> l0 = label(<a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(I), <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(I));</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(label)</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (label(i, j) == l0)</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        I(i, j) = 0;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        I(i, j) = 1;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_a0544c3fe466e421738dae463968b70ba"><div class="ttname"><a href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="ttdeci">else</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02919">numerical_recipes.cpp:2919</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00400">multidim_array.h:400</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Filters_html_ga206a93c383ad7f6ba43c67f18486cc21"><div class="ttname"><a href="group__Filters.html#ga206a93c383ad7f6ba43c67f18486cc21">labelImage2D</a></div><div class="ttdeci">int labelImage2D(const MultidimArray&lt; double &gt; &amp;I, MultidimArray&lt; double &gt; &amp;label, int neighbourhood)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00636">filters.cpp:636</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga0503708238bfaf63a342376631e915c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fillTriangle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>tx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>color</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fill a triangle defined by three points</p>
<p>The points are supplied as a pointer to three integer positions. They can be negative </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02899">2899</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;{</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;    img.checkDimension(2);</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;<span class="comment">     * Order in y values</span></div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;    <span class="keywordtype">int</span> y1 = 0;</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    <span class="keywordflow">while</span> (!y1)</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;    {</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;        y1 = 1;</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y2 = 0; y2 &lt; 2; y2++)</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;        {</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;            <span class="keywordflow">if</span> (ty[y2] &gt; ty[y2 + 1]</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;                || (ty[y2] == ty[y2 + 1] &amp;&amp; tx[y2] &lt; tx[y2 + 1]))</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;            {</div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;                <span class="keywordtype">int</span> x1 = ty[y2];</div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;                ty[y2] = ty[y2 + 1];</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;                ty[y2 + 1] = x1;</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;                x1 = tx[y2];</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;                tx[y2] = tx[y2 + 1];</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;                tx[y2 + 1] = x1;</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;                y1 = 0;</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;            }</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;        }</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;    }</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;</div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;    <span class="keywordtype">int</span> dx1 = tx[1] - tx[0];</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;    <span class="keywordtype">int</span> dx2 = tx[2] - tx[0];</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;    <span class="keywordtype">int</span> dy1 = ty[1] - ty[0];</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;    <span class="keywordtype">int</span> dy2 = ty[2] - ty[0];</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;    <span class="keywordtype">int</span> sx1 = <a class="code" href="group__Macros.html#ga734979f161228483e36cea562161f48c">SGN0</a>(dx1);</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;    <span class="keywordtype">int</span> sx2 = <a class="code" href="group__Macros.html#ga734979f161228483e36cea562161f48c">SGN0</a>(dx2);</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;    <span class="keywordtype">int</span> sy1 = <a class="code" href="group__Macros.html#ga734979f161228483e36cea562161f48c">SGN0</a>(dy1);</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;    <span class="keywordtype">int</span> ix1 = <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(dx1);</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;    <span class="keywordtype">int</span> ix2 = <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(dx2);</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;    <span class="keywordtype">int</span> iy1 = <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(dy1);</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;    <span class="keywordtype">int</span> iy2 = <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(dy2);</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;    <span class="keywordtype">int</span> inc1 = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(ix1, iy1);</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;    <span class="keywordtype">int</span> inc2 = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(ix2, iy2);</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;    <span class="keywordtype">int</span> x1, x2, y2, <a class="code" href="numerical__recipes_8cpp.html#a76fe173a467838b35f53955f0a20a311">xl</a>, xr;</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;    x1 = x2 = y1 = y2 = 0;</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;    xl = xr = tx[0];</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> = ty[0];</div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;    <span class="keywordflow">while</span> (y != ty[1])</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;    {</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;        <span class="keywordtype">int</span> doit1 = 0;</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;        <span class="keywordtype">int</span> doit2 = 0;</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;</div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;        <span class="keywordflow">while</span> (!doit1)</div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;        { <span class="comment">/* Wait until y changes */</span></div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;            x1 += ix1;</div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;            y1 += iy1;</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;            <span class="keywordflow">if</span> (x1 &gt; inc1)</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;            {</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;                x1 -= inc1;</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;                xl += sx1;</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;            }</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;            <span class="keywordflow">if</span> (y1 &gt; inc1)</div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;            {</div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;                y1 -= inc1;</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;                y += sy1;</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;                doit1 = 1;</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;            }</div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;        }</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;        <span class="keywordflow">while</span> (!doit2)</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;        { <span class="comment">/* Wait until y changes */</span></div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;            x2 += ix2;</div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;            y2 += iy2;</div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;            <span class="keywordflow">if</span> (x2 &gt; inc2)</div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;            {</div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;                x2 -= inc2;</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;                xr += sx2;</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;            }</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;            <span class="keywordflow">if</span> (y2 &gt; inc2)</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;            {</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;                y2 -= inc2;</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;                doit2 = 1;</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;            }</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;        }</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> myx = xl; myx &lt;= xr; myx++)</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;            img(y, myx) = color;</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;    }</div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;</div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;    dx1 = tx[2] - tx[1];</div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;    dy1 = ty[2] - ty[1];</div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;    sx1 = <a class="code" href="group__Macros.html#ga734979f161228483e36cea562161f48c">SGN0</a>(dx1);</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;    sy1 = <a class="code" href="group__Macros.html#ga734979f161228483e36cea562161f48c">SGN0</a>(dy1);</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;    ix1 = <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(dx1);</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;    iy1 = <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(dy1);</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;    inc1 = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(ix1, iy1);</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;    xl = tx[1];</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;    x1 = 0;</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;    <span class="keywordflow">while</span> (y != ty[2])</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;    {</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;        <span class="keywordtype">int</span> doit1 = 0;</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;        <span class="keywordtype">int</span> doit2 = 0;</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;        <span class="keywordflow">while</span> (!doit1)</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;        { <span class="comment">/* Wait until y changes */</span></div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;            x1 += ix1;</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;            y1 += iy1;</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;            <span class="keywordflow">if</span> (x1 &gt; inc1)</div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;            {</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;                x1 -= inc1;</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;                xl += sx1;</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;            }</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;            <span class="keywordflow">if</span> (y1 &gt; inc1)</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;            {</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;                y1 -= inc1;</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;                y += sy1;</div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;                doit1 = 1;</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;            }</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;        }</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;        <span class="keywordflow">while</span> (!doit2)</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;        { <span class="comment">/* Wait until y changes */</span></div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;            x2 += ix2;</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;            y2 += iy2;</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;            <span class="keywordflow">if</span> (x2 &gt; inc2)</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;            {</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;                x2 -= inc2;</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;                xr += sx2;</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;            }</div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;            <span class="keywordflow">if</span> (y2 &gt; inc2)</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;            {</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;                y2 -= inc2;</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;                doit2 = 1;</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;            }</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;        }</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> myx = xl; myx &lt;= xr; myx++)</div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;            img(y, myx) = color;</div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;    }</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;}</div><div class="ttc" id="group__Macros_html_gae0a4180e923e3ffca3989e20e441aa3c"><div class="ttname"><a href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a></div><div class="ttdeci">#define XMIPP_MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00193">xmipp_macros.h:193</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76fe173a467838b35f53955f0a20a311"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76fe173a467838b35f53955f0a20a311">xl</a></div><div class="ttdeci">doublereal * xl</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__Macros_html_ga734979f161228483e36cea562161f48c"><div class="ttname"><a href="group__Macros.html#ga734979f161228483e36cea562161f48c">SGN0</a></div><div class="ttdeci">#define SGN0(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00169">xmipp_macros.h:169</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad919bbce6f061400a0bc5231a9cd1621"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a></div><div class="ttdeci">static double * y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08506">numerical_recipes.cpp:8506</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga952148fe1e27177ebcd5ce943191b474"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void forcePositive </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Force positive.</p><ul>
<li></li>
</ul>
<p>A median filter is applied at those negative values. Positive values are untouched.</p>
<p>Force positive -----------------------------------------------------&mdash; </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l03375">3375</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;{</div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;char&gt;</a> mask(<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(V), <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(V), <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V));</div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(V)</div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;    {</div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> = <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(V, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>) = (x &lt;= 0);</div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;    }</div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;    <a class="code" href="group__Filters.html#ga1f7a9b2af2b245a586167a1d469a2bdd">boundMedianFilter</a>(V, mask);</div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; char &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="group__Filters_html_ga1f7a9b2af2b245a586167a1d469a2bdd"><div class="ttname"><a href="group__Filters.html#ga1f7a9b2af2b245a586167a1d469a2bdd">boundMedianFilter</a></div><div class="ttdeci">void boundMedianFilter(MultidimArray&lt; T &gt; &amp;V, const MultidimArray&lt; char &gt; &amp;mask, int n=0)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l01355">filters.h:1355</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gacea6e9b7dc8fc68250563b670b2f9550"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fourierBesselDecomposition </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>img_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>m_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fourier-Bessel decomposition</p>
<p>The Fourier-Bessel decomposition of those pixels in img_in whose radius is between r1 and r2 is computed. r1 and r2 are supposed to fit in the image shape, and the image logical origin is used for the decomposition. k1 and k2 determines the harmonic coefficients to be computed. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02376">2376</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;{</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;    img_in.checkDimension(2);</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> = k1; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> &lt;= k2; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>++)</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    {</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;        <span class="keywordtype">int</span> k_1 = <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> - 1;</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;        <span class="comment">// Compute h and a,b coefficients</span></div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;        <span class="keywordtype">double</span> h = 0, my5 = 0;</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;        <span class="keywordflow">if</span> (k_1 != 0)</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;        {</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;            <span class="keywordtype">double</span> my = 1 + <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * <a class="code" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a> / 2 / k_1;</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;            <span class="keywordtype">double</span> my4 = my * k_1;</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="image__find__center_8cpp.html#a06e50f3fc20c3d51aa8a3c5e43438c87">ntot</a> = 4 * my4;</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;            h = 2 * <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> / <a class="code" href="image__find__center_8cpp.html#a06e50f3fc20c3d51aa8a3c5e43438c87">ntot</a>;</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;        }</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;        {</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;            <span class="keywordtype">double</span> my = 1 + <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * <a class="code" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a> / 2;</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;            <span class="keywordtype">double</span> my4 = my;</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="image__find__center_8cpp.html#a06e50f3fc20c3d51aa8a3c5e43438c87">ntot</a> = 4 * my4;</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;            h = 2 * <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> / <a class="code" href="image__find__center_8cpp.html#a06e50f3fc20c3d51aa8a3c5e43438c87">ntot</a>;</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;        }</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;        <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> sine(<a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(my5));</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gaa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(sine)</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;        sine(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = sin((<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1) * h);</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    }</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaa924a84ae5fbf0ba6b4052eb9d92ef60"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00564">multidim_array.h:564</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a06e50f3fc20c3d51aa8a3c5e43438c87"><div class="ttname"><a href="image__find__center_8cpp.html#a06e50f3fc20c3d51aa8a3c5e43438c87">ntot</a></div><div class="ttdeci">int ntot</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="image__find__center_8cpp_html_ab7a69dabaa7151dae4d7a3998167e2f3"><div class="ttname"><a href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a></div><div class="ttdeci">float r2</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00051">image_find_center.cpp:51</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga0d47bf9f39db4d2e7e6422f015cab5b5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double giniCoeff </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>varKernelSize</em> = <code>50</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the Gini coefficient of an image. This is related to the Entropy. It also applies a variance filter to the input <a class="el" href="classImage.html">Image</a> </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l00941">941</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;{</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> im = I;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot; - Starting fft filtering &quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <a class="code" href="classFourierFilter.html">FourierFilter</a> filter;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    filter.<a class="code" href="classFourierFilter.html#af5ced7144d0587c416bdac7d705aed45">FilterShape</a> = <a class="code" href="fourier__filter_8h.html#a61be564955992f0d12432f88997c56d2">REALGAUSSIAN</a>;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    filter.<a class="code" href="classFourierFilter.html#a7e847d4cdbf21e78ef474a42bd2da833">FilterBand</a> = <a class="code" href="fourier__filter_8h.html#ab88b316b336dadc6e77f04d6f035d86e">LOWPASS</a>;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    filter.<a class="code" href="classFourierFilter.html#a6b96657901248fdd1b4c7af47dc9c88d">w1</a> = 4;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    filter.<a class="code" href="classFourierFilter.html#a628762260d6099753fa4b55adc4cfbb0">applyMaskSpace</a>(im);</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;   </div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">// Image&lt;double&gt; imG(im);</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="comment">// imG.write(&quot;I_Gauss.mrc&quot;);</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot; - Calling varianceFilter() &quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <a class="code" href="group__Filters.html#ga10453d42eeb9ec81876fc0e12bb4b978">varianceFilter</a>(I, varKernelSize, <span class="keyword">true</span>);</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    im = I;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot; - Starting 2nd fft filtering &quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    filter.<a class="code" href="classFourierFilter.html#a6b96657901248fdd1b4c7af47dc9c88d">w1</a> = varKernelSize/8;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    filter.<a class="code" href="classFourierFilter.html#a628762260d6099753fa4b55adc4cfbb0">applyMaskSpace</a>(I);</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="comment">// Image&lt;double&gt; imGV(im);</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="comment">// imGV.write(&quot;I_Gauss_Var.mrc&quot;);</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;   </div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    im -= im.<a class="code" href="classMultidimArray.html#a0e7a7881ec242da8ee392f465b3e3b28">computeMin</a>();</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    im /= im.<a class="code" href="classMultidimArray.html#a0f2229bfbeb30bc5b5b8a9b83c08279c">computeMax</a>();</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="comment">// Image&lt;double&gt; imGVN(im);</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="comment">// imGVN.write(&quot;I_Gauss_Var_Norm.mrc&quot;);</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;   </div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot; - Starting histogram analysis &quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <a class="code" href="classHistogram1D.html">Histogram1D</a> hist;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    hist.<a class="code" href="classHistogram1D.html#a2612603a91b3722d943f56d983903870">clear</a>();</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <a class="code" href="group__Histograms.html#gaaa3501212e9e03d46c6e7aba56dd6c21">compute_hist</a>(im, hist, 256);</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot; - Computing Gini coeff &quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> sortedList=hist;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    hist.<a class="code" href="classMultidimArray.html#a403f14f21a01a4a29c632a85a8ebea14">sort</a>(sortedList);</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keywordtype">double</span> height=0, area=0;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(sortedList); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    {</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        height += <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(sortedList,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        area += height - <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(sortedList,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)/2.0;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    }</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        </div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordtype">double</span> fair_area = height*<a class="code" href="ctf_8h.html#abf4936ae2557c5a607e2ec4f9fd51313">convertSizeTToDouble</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(hist))/2.0;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="keywordtype">double</span> giniValue = (fair_area-area)/fair_area;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="keywordflow">return</span> giniValue;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;}</div><div class="ttc" id="classHistogram1D_html_a2612603a91b3722d943f56d983903870"><div class="ttname"><a href="classHistogram1D.html#a2612603a91b3722d943f56d983903870">Histogram1D::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00038">histogram.cpp:38</a></div></div>
<div class="ttc" id="classFourierFilter_html_a6b96657901248fdd1b4c7af47dc9c88d"><div class="ttname"><a href="classFourierFilter.html#a6b96657901248fdd1b4c7af47dc9c88d">FourierFilter::w1</a></div><div class="ttdeci">double w1</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00106">fourier_filter.h:106</a></div></div>
<div class="ttc" id="ctf_8h_html_abf4936ae2557c5a607e2ec4f9fd51313"><div class="ttname"><a href="ctf_8h.html#abf4936ae2557c5a607e2ec4f9fd51313">convertSizeTToDouble</a></div><div class="ttdeci">double convertSizeTToDouble(size_t data)</div><div class="ttdef"><b>Definition:</b> <a href="ctf_8h_source.html#l00059">ctf.h:59</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classHistogram1D_html"><div class="ttname"><a href="classHistogram1D.html">Histogram1D</a></div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00121">histogram.h:121</a></div></div>
<div class="ttc" id="classFourierFilter_html_a7e847d4cdbf21e78ef474a42bd2da833"><div class="ttname"><a href="classFourierFilter.html#a7e847d4cdbf21e78ef474a42bd2da833">FourierFilter::FilterBand</a></div><div class="ttdeci">int FilterBand</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00102">fourier_filter.h:102</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Filters_html_ga10453d42eeb9ec81876fc0e12bb4b978"><div class="ttname"><a href="group__Filters.html#ga10453d42eeb9ec81876fc0e12bb4b978">varianceFilter</a></div><div class="ttdeci">void varianceFilter(MultidimArray&lt; double &gt; &amp;I, int kernelSize, bool relative)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00765">filters.cpp:765</a></div></div>
<div class="ttc" id="group__Histograms_html_gaaa3501212e9e03d46c6e7aba56dd6c21"><div class="ttname"><a href="group__Histograms.html#gaaa3501212e9e03d46c6e7aba56dd6c21">compute_hist</a></div><div class="ttdeci">void compute_hist(const MultidimArrayGeneric &amp;array, Histogram1D &amp;hist, int no_steps)</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00570">histogram.cpp:570</a></div></div>
<div class="ttc" id="classMultidimArray_html_a403f14f21a01a4a29c632a85a8ebea14"><div class="ttname"><a href="classMultidimArray.html#a403f14f21a01a4a29c632a85a8ebea14">MultidimArray::sort</a></div><div class="ttdeci">void sort(MultidimArray&lt; T &gt; &amp;result) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04657">multidim_array.h:4657</a></div></div>
<div class="ttc" id="classMultidimArray_html_a0e7a7881ec242da8ee392f465b3e3b28"><div class="ttname"><a href="classMultidimArray.html#a0e7a7881ec242da8ee392f465b3e3b28">MultidimArray::computeMin</a></div><div class="ttdeci">T computeMin() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03154">multidim_array.h:3154</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="classMultidimArray_html_a0f2229bfbeb30bc5b5b8a9b83c08279c"><div class="ttname"><a href="classMultidimArray.html#a0f2229bfbeb30bc5b5b8a9b83c08279c">MultidimArray::computeMax</a></div><div class="ttdeci">T computeMax() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03123">multidim_array.h:3123</a></div></div>
<div class="ttc" id="classFourierFilter_html"><div class="ttname"><a href="classFourierFilter.html">FourierFilter</a></div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00070">fourier_filter.h:70</a></div></div>
<div class="ttc" id="fourier__filter_8h_html_a61be564955992f0d12432f88997c56d2"><div class="ttname"><a href="fourier__filter_8h.html#a61be564955992f0d12432f88997c56d2">REALGAUSSIAN</a></div><div class="ttdeci">#define REALGAUSSIAN</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00088">fourier_filter.h:88</a></div></div>
<div class="ttc" id="fourier__filter_8h_html_ab88b316b336dadc6e77f04d6f035d86e"><div class="ttname"><a href="fourier__filter_8h.html#ab88b316b336dadc6e77f04d6f035d86e">LOWPASS</a></div><div class="ttdeci">#define LOWPASS</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00078">fourier_filter.h:78</a></div></div>
<div class="ttc" id="classFourierFilter_html_a628762260d6099753fa4b55adc4cfbb0"><div class="ttname"><a href="classFourierFilter.html#a628762260d6099753fa4b55adc4cfbb0">FourierFilter::applyMaskSpace</a></div><div class="ttdeci">void applyMaskSpace(MultidimArray&lt; double &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8cpp_source.html#l00651">fourier_filter.cpp:651</a></div></div>
<div class="ttc" id="classFourierFilter_html_af5ced7144d0587c416bdac7d705aed45"><div class="ttname"><a href="classFourierFilter.html#af5ced7144d0587c416bdac7d705aed45">FourierFilter::FilterShape</a></div><div class="ttdeci">int FilterShape</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00076">fourier_filter.h:76</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaa2d7ee82ca1e88ae849446fb4392c484"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void harmonicDecomposition </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>img_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Harmonic decomposition </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02410">2410</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;{}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga5e7945db841993a933e1383687c303bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void inertiaMoments </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Inertia moments</p>
<p>They are measured with respect to the center of the image, and not with respect to the center of mass. For an image there are only two inertia moments. v_out contains the inertia moments while the columns of u contain the directions of the principal axes. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02859">2859</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;{</div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;    img.checkDimension(2);</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;    <span class="comment">// Prepare some variables</span></div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;    <span class="keywordtype">double</span> m_11 = 0, m_02 = 0, m_20 = 0;</div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;    <span class="keywordtype">double</span> normalize_x = 2.0 / <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(img);</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;    <span class="keywordtype">double</span> normalize_y = 2.0 / <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(img);</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;    <span class="comment">// Compute low-level moments</span></div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(img)</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;    {</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;        <span class="keywordflow">if</span> (mask != NULL)</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;            <span class="keywordflow">if</span> (!(*mask)(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>))</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;        <span class="keywordtype">double</span> val = img(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#a229d11aff11a7482259d1296b9b70b8a">dx</a> = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> * normalize_x;</div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;        <span class="keywordtype">double</span> dy = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * normalize_y;</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;        <span class="keywordtype">double</span> dx2 = dx * <a class="code" href="numerical__recipes_8cpp.html#a229d11aff11a7482259d1296b9b70b8a">dx</a>;</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;        <span class="keywordtype">double</span> dy2 = dy * dy;</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;        m_11 += val * dx * dy;</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;        m_02 += val * dy2;</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;        m_20 += val * dx2;</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;    }</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;    <span class="comment">// Compute the eigen values of the inertia matrix</span></div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;    <span class="comment">// [m_02 m_11</span></div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;    <span class="comment">//  m_11 m_20]</span></div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> A(2, 2);</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;    A(0, 0) = m_02;</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;    A(0, 1) = A(1, 0) = m_11;</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;    A(1, 1) = m_20;</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> v;</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;    <a class="code" href="group__Matrices.html#ga46eb206e2830820e657b26bf82969b85">svdcmp</a>(A, u, v_out, v);</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;    v_out = v_out.<a class="code" href="classMatrix1D.html#aea6e2e86f633090edd173e59bb24cd88">sort</a>();</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;}</div><div class="ttc" id="classMatrix1D_html_aea6e2e86f633090edd173e59bb24cd88"><div class="ttname"><a href="classMatrix1D.html#aea6e2e86f633090edd173e59bb24cd88">Matrix1D::sort</a></div><div class="ttdeci">Matrix1D&lt; T &gt; sort() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01301">matrix1d.h:1301</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00400">multidim_array.h:400</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a229d11aff11a7482259d1296b9b70b8a"><div class="ttname"><a href="numerical__recipes_8cpp.html#a229d11aff11a7482259d1296b9b70b8a">dx</a></div><div class="ttdeci">double dx</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l06229">numerical_recipes.cpp:6229</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__Matrices_html_ga46eb206e2830820e657b26bf82969b85"><div class="ttname"><a href="group__Matrices.html#ga46eb206e2830820e657b26bf82969b85">svdcmp</a></div><div class="ttdeci">void svdcmp(const Matrix2D&lt; T &gt; &amp;a, Matrix2D&lt; double &gt; &amp;u, Matrix1D&lt; double &gt; &amp;w, Matrix2D&lt; double &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01827">matrix2d.h:1827</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga59afc9cfbaf887703547ec198600d92d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void keepBiggestComponent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>percentage</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>neighbourhood</em> = <code>8</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Keep the biggest connected component</p>
<p>If the biggest component does not cover the percentage required (by default, 0), more big components are taken until this is accomplished. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l00703">703</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;{</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> label;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordtype">int</span> imax;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(I)==1)</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        imax=<a class="code" href="group__Filters.html#ga206a93c383ad7f6ba43c67f18486cc21">labelImage2D</a>(I, label, neighbourhood);</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        imax=<a class="code" href="group__Filters.html#gaad2c4bf9d2a76b096825a3c7b9e23b1a">labelImage3D</a>(I, label);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;int&gt;</a> nlabel(imax + 1);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(label)</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    {</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keywordtype">int</span> l=(int)<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(label,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="keywordflow">if</span> (l&gt;0)</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(nlabel,l)++;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    }</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray &lt;int&gt;</a> best;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    nlabel.<a class="code" href="classMultidimArray.html#a78ad19f8c3be788b7c09bf18f699bbe2">indexSort</a>(best);</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    best -= 1;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="keywordtype">int</span> nbest = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(best) - 1;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keywordtype">double</span> total = nlabel.sum();</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="keywordtype">double</span> explained = nlabel(best(nbest));</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keywordflow">while</span> (explained &lt; percentage * total)</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    {</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        nbest--;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        explained += nlabel(best(nbest));</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    }</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(label)</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    {</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        <span class="keywordtype">int</span> l=(int)<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(label,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="keywordtype">bool</span> among_the_best = <span class="keyword">false</span>;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> = nbest; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> &lt; imax + 1; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>++)</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            <span class="keywordflow">if</span> (l == <a class="code" href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(best,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>))</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            {</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                among_the_best = <span class="keyword">true</span>;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            }</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="keywordflow">if</span> (!among_the_best)</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(I,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)=0;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    }</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga97809f7244a28aaa1c26e29e6e3204ef"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a></div><div class="ttdeci">#define A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00549">multidim_array.h:549</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="group__Filters_html_ga206a93c383ad7f6ba43c67f18486cc21"><div class="ttname"><a href="group__Filters.html#ga206a93c383ad7f6ba43c67f18486cc21">labelImage2D</a></div><div class="ttdeci">int labelImage2D(const MultidimArray&lt; double &gt; &amp;I, MultidimArray&lt; double &gt; &amp;label, int neighbourhood)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00636">filters.cpp:636</a></div></div>
<div class="ttc" id="classMultidimArray_html_a78ad19f8c3be788b7c09bf18f699bbe2"><div class="ttname"><a href="classMultidimArray.html#a78ad19f8c3be788b7c09bf18f699bbe2">MultidimArray::indexSort</a></div><div class="ttdeci">void indexSort(MultidimArray&lt; int &gt; &amp;indx) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04677">multidim_array.h:4677</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="group__Filters_html_gaad2c4bf9d2a76b096825a3c7b9e23b1a"><div class="ttname"><a href="group__Filters.html#gaad2c4bf9d2a76b096825a3c7b9e23b1a">labelImage3D</a></div><div class="ttdeci">int labelImage3D(const MultidimArray&lt; double &gt; &amp;V, MultidimArray&lt; double &gt; &amp;label)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00658">filters.cpp:658</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga206a93c383ad7f6ba43c67f18486cc21"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int labelImage2D </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>neighbourhood</em> = <code>8</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Label a binary image</p>
<p>This function receives a binary volume and labels all its connected components. The background is labeled as 0, and the components as 1, 2, 3 ... </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l00636">636</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;{</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    I.checkDimension(2);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    label = I;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordtype">int</span> colour = 32000;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(label)</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    {</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="keywordflow">if</span> (label(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) != 1)</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <a class="code" href="group__Filters.html#gaa67ede8a062ce8e0c34b4323bb2ca082">regionGrowing2D</a>(label, label, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, 0, static_cast&lt;float&gt;(colour),</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                <span class="keyword">false</span>, neighbourhood);</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        colour++;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    }</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(label)</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (label(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) != 0)</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        label(i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = label(i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) - 31999;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a5ea9a6a7bd724d30070df9316ccc8199">return</a> colour - 32000;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;}</div><div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00400">multidim_array.h:400</a></div></div>
<div class="ttc" id="group__Filters_html_gaa67ede8a062ce8e0c34b4323bb2ca082"><div class="ttname"><a href="group__Filters.html#gaa67ede8a062ce8e0c34b4323bb2ca082">regionGrowing2D</a></div><div class="ttdeci">void regionGrowing2D(const MultidimArray&lt; double &gt; &amp;I_in, MultidimArray&lt; double &gt; &amp;I_out, int i, int j, float stop_colour, float filling_colour, bool less, int neighbourhood)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00333">filters.cpp:333</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a5ea9a6a7bd724d30070df9316ccc8199"><div class="ttname"><a href="numerical__recipes_8cpp.html#a5ea9a6a7bd724d30070df9316ccc8199">return</a></div><div class="ttdeci">return</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02411">numerical_recipes.cpp:2411</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaad2c4bf9d2a76b096825a3c7b9e23b1a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int labelImage3D </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>label</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Label a binary volume</p>
<p>This function receives a binary image and labels all its connected components. The background is labeled as 0, and the components as 1, 2, 3 ... </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l00658">658</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;{</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    V.checkDimension(3);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    label = V;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordtype">int</span> colour = 32000;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(label)</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    {</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="keywordflow">if</span> (label(<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) != 1)</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <a class="code" href="filters_8cpp.html#aad85078fda0532473e1cc86b983a12ae">regionGrowing3D</a>(label, label, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, 0, static_cast&lt;float&gt;(colour),</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                <span class="keyword">false</span>);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        colour++;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    }</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(label)</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(label,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) != 0)</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(label,k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(label,k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) - 31999;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a5ea9a6a7bd724d30070df9316ccc8199">return</a> colour - 32000;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00279">multidim_array.h:279</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="filters_8cpp_html_aad85078fda0532473e1cc86b983a12ae"><div class="ttname"><a href="filters_8cpp.html#aad85078fda0532473e1cc86b983a12ae">regionGrowing3D</a></div><div class="ttdeci">void regionGrowing3D(const MultidimArray&lt; double &gt; &amp;V_in, MultidimArray&lt; double &gt; &amp;V_out, int k, int i, int j, float stop_colour, float filling_colour, bool less)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00404">filters.cpp:404</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a5ea9a6a7bd724d30070df9316ccc8199"><div class="ttname"><a href="numerical__recipes_8cpp.html#a5ea9a6a7bd724d30070df9316ccc8199">return</a></div><div class="ttdeci">return</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02411">numerical_recipes.cpp:2411</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga10e4035c55461690348a131999433fe2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void localThresholding </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dimLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>mask</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Local thresholding</p>
<p>This function implements the local thresholding as described in <a href="http://homepages.inf.ed.ac.uk/rbf/HIPR2/adpthrsh.htm">http://homepages.inf.ed.ac.uk/rbf/HIPR2/adpthrsh.htm</a> A mask can be supplied to limit the image area.</p>
<p>The procedure employed is the following:</p><ul>
<li>Convolving the image with the statistical operator, i.e. the mean or median (the size of the convolution kernel is dimLocal)</li>
<li>Subtracting the original from the convolved image.</li>
<li>Thresholding the difference image with C.</li>
<li>Inverting the thresholded image. </li>
</ul>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l03047">3047</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;{</div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;</div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;    <span class="comment">// Convolve the input image with the kernel</span></div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> convolved;</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;    convolved.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(img);</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(convolved)</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;    {</div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;        <span class="keywordflow">if</span> (mask != NULL)</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;            <span class="keywordflow">if</span> (!(*mask)(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>))</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;        <span class="keywordtype">int</span> ii0 = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(<a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(convolved), <a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - dimLocal));</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;        <span class="keywordtype">int</span> jj0 = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(<a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(convolved), <a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - dimLocal));</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;        <span class="keywordtype">int</span> iiF = <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(<a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(convolved), <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + dimLocal));</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;        <span class="keywordtype">int</span> jjF = <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(<a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(convolved), <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + dimLocal));</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;        <span class="keywordtype">double</span> N = 0;</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = ii0; ii &lt;= iiF; ii++)</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = jj0; jj &lt;= jjF; jj++)</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;            {</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;                <span class="keywordflow">if</span> (mask == NULL)</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;                {</div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;                    convolved(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) += img(ii, jj);</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;                    ++N;</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;                }</div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((*mask)(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>))</div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;                {</div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;                    convolved(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) += img(ii, jj);</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;                    ++N;</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;                }</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;            }</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;        <span class="keywordflow">if</span> (N != 0)</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;            convolved(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) /= N;</div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;    }</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;    <span class="comment">// Subtract the original from the convolved image and threshold</span></div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;    result.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(img);</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(convolved)</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;    {</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;        <span class="keywordflow">if</span> (mask != NULL)</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;            <span class="keywordflow">if</span> (!(*mask)(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>))</div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;        <span class="keywordflow">if</span> (img(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) - convolved(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) &gt; C)</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;            result(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 1;</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;    }</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;}</div><div class="ttc" id="group__Macros_html_gae0a4180e923e3ffca3989e20e441aa3c"><div class="ttname"><a href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a></div><div class="ttdeci">#define XMIPP_MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00193">xmipp_macros.h:193</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00065">multidim_array.h:65</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Macros_html_ga2f0eecb0f7856721f56faff8f27b0dc1"><div class="ttname"><a href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a></div><div class="ttdeci">#define FLOOR(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00240">xmipp_macros.h:240</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00400">multidim_array.h:400</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="group__Macros_html_gac9ae6a207f10c821b06a8c0df153a7d5"><div class="ttname"><a href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a></div><div class="ttdeci">#define XMIPP_MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00181">xmipp_macros.h:181</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00073">multidim_array.h:73</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga3fa8d451a013398c53c7b655b4220c83"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void logFilter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute logarithm.</p><ul>
<li></li>
</ul>
<p>apply transformation a+b*ln(x+c). i.e: 4.431-0.4018*LN(P1+336.6) </p>

<p>Definition at line <a class="el" href="filters_8h_source.html#l01453">1453</a> of file <a class="el" href="filters_8h_source.html">filters.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;{</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(V)</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    {</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> = <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(V, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        <span class="comment">//this casting is kind of risky</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(V, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>) = (T)(<a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>-<a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>*<a class="code" href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a>(x+<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>));</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    }</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af090b2fbbd2916bfb2e493c5162969d6"><div class="ttname"><a href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a></div><div class="ttdeci">doublereal * b</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_a0994f8f1ab050711112683b89fb90b0b"><div class="ttname"><a href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a></div><div class="ttdeci">void log(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00225">image_operate.cpp:225</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af2a333b1670df64a88d3a2f22210d155"><div class="ttname"><a href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a></div><div class="ttdeci">doublereal * a</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga879cec5ab86ea8c47829ed9c3c12c133"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void medianFilter3x3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Median_filter with a 3x3 selfWindow </p>

<p>Definition at line <a class="el" href="filters_8h_source.html#l01138">1138</a> of file <a class="el" href="filters_8h_source.html">filters.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;{</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="keywordtype">int</span> backup_startingx = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(m);</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <span class="keywordtype">int</span> backup_startingy = <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(m);</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(m) = <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(m) = 0;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; T &gt;</a> <a class="code" href="numerical__recipes_8cpp.html#a9f954d5f5402aa3e24d96406b24f27a7">v1</a>(3), v2(3), v3(3), v4(3);</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; T &gt;</a> v(6);</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="comment">// Set the output matrix size</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    out.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(m);</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="comment">// Set the initial and final matrix indices to explore</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordtype">int</span> initialY = 1, initialX = 1;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="keywordtype">int</span> finalY = <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(m) - 2;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="keywordtype">int</span> finalX = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(m) - 2;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="comment">// For every row</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = initialY; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= finalY; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    {</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        <span class="comment">// For every pair of pixels (mean is computed obtaining</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        <span class="comment">// two means at the same time using an efficient method)</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = initialX; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt;= finalX; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> += 2)</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        {</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;            <span class="comment">// If we are in the border case</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> == 1)</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            {</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                <span class="comment">// Order the first and second vectors of 3 elements</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                <a class="code" href="filters_8h.html#aeb313334179f936e382ea693bdd9efc8">sort</a>(<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(m, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - 1), <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(m, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - 1),</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                     <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(m, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - 1), <a class="code" href="numerical__recipes_8cpp.html#a9f954d5f5402aa3e24d96406b24f27a7">v1</a>);</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                <a class="code" href="filters_8h.html#aeb313334179f936e382ea693bdd9efc8">sort</a>(<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(m, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>), <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(m, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>),</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                     <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(m, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>), v2);</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;            }</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;            {</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                <span class="comment">// Simply take ordered vectors from previous</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                <a class="code" href="numerical__recipes_8cpp.html#a9f954d5f5402aa3e24d96406b24f27a7">v1</a> = v3;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                v2 = v4;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;            }</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;            <span class="comment">// As we are computing 2 medians at the same time, if the matrix has</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            <span class="comment">// an odd number of columns, the last column isn&#39;t calculated. It is</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;            <span class="comment">// done here</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> == finalX)</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            {</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                <a class="code" href="numerical__recipes_8cpp.html#a9f954d5f5402aa3e24d96406b24f27a7">v1</a> = v3;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                v2 = v4;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                <a class="code" href="filters_8h.html#aeb313334179f936e382ea693bdd9efc8">sort</a>(<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(m, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + 1), <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(m, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + 1),</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                     <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(m, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + 1), v3);</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                <a class="code" href="filters_8h.html#a1593c098df7c373a32ccd38ecc54ff81">fastMergeSort</a>(v2, v3, v);</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                <a class="code" href="filters_8h.html#aaabf75ee4bbe8d04482c4cd8bc9dcde9">median</a>(<a class="code" href="numerical__recipes_8cpp.html#a9f954d5f5402aa3e24d96406b24f27a7">v1</a>, v, <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(out,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;            }</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;            {</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                <span class="comment">// Order the third and fourth vectors of 3 elements</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                <a class="code" href="filters_8h.html#aeb313334179f936e382ea693bdd9efc8">sort</a>(<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(m, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + 1), <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(m, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + 1),</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                     <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(m, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + 1), v3);</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                <a class="code" href="filters_8h.html#aeb313334179f936e382ea693bdd9efc8">sort</a>(<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(m, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + 2), <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(m, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + 2),</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                     <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(m, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + 2), v4);</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                <span class="comment">// Merge sort the second and third vectors</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                <a class="code" href="filters_8h.html#a1593c098df7c373a32ccd38ecc54ff81">fastMergeSort</a>(v2, v3, v);</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                <span class="comment">// Find the first median and assign it to the output</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                <a class="code" href="filters_8h.html#aaabf75ee4bbe8d04482c4cd8bc9dcde9">median</a>(<a class="code" href="numerical__recipes_8cpp.html#a9f954d5f5402aa3e24d96406b24f27a7">v1</a>, v, <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(out, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                <span class="comment">// Find the second median and assign it to the output</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                <a class="code" href="filters_8h.html#aaabf75ee4bbe8d04482c4cd8bc9dcde9">median</a>(v4, v, <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(out, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + 1));</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;            }</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        }</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    }</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(m) = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(out) = backup_startingx;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(m) = <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(out) = backup_startingy;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9ed4376d9ad511e963caf118a6640b28"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a></div><div class="ttdeci">#define DIRECT_A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00351">multidim_array.h:351</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="filters_8h_html_aaabf75ee4bbe8d04482c4cd8bc9dcde9"><div class="ttname"><a href="filters_8h.html#aaabf75ee4bbe8d04482c4cd8bc9dcde9">median</a></div><div class="ttdeci">void median(MultidimArray&lt; T &gt; &amp;x, MultidimArray&lt; T &gt; &amp;y, T &amp;m)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l01105">filters.h:1105</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a9f954d5f5402aa3e24d96406b24f27a7"><div class="ttname"><a href="numerical__recipes_8cpp.html#a9f954d5f5402aa3e24d96406b24f27a7">v1</a></div><div class="ttdeci">double v1</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l06229">numerical_recipes.cpp:6229</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="filters_8h_html_aeb313334179f936e382ea693bdd9efc8"><div class="ttname"><a href="filters_8h.html#aeb313334179f936e382ea693bdd9efc8">sort</a></div><div class="ttdeci">void sort(T a, T b, T c, MultidimArray&lt; T &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00850">filters.h:850</a></div></div>
<div class="ttc" id="filters_8h_html_a1593c098df7c373a32ccd38ecc54ff81"><div class="ttname"><a href="filters_8h.html#a1593c098df7c373a32ccd38ecc54ff81">fastMergeSort</a></div><div class="ttdeci">void fastMergeSort(MultidimArray&lt; T &gt; &amp;x, MultidimArray&lt; T &gt; &amp;y, MultidimArray&lt; T &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00917">filters.h:917</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga009d8221d8bb4238281094fed2d5de26"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">double mutualInformation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nx</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ny</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>mask</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>mutual information nD</p>
<p>Return the mutual information: MI = sum [ P(x,y)*log2{P(x,y)/(P(x)*P(y))} ] in the common positions. P(x), P(y) are 1D-histograms of the values of matrix x and y. P(x,y) is the 2D-histogram, i.e. the count of times that a certain combination of values in matrices x and y has occurred. The sum runs over all histogram bins.</p>
<p>The histograms are calculated using the number of bins nx and ny. If no values (or zeros) are given, a <a class="el" href="classGaussian.html">Gaussian</a> distribution of the values in the matrices is assumed, and the number of bins is calculated as: log2(n)+1. (according to: Tourassi et al. (2001) Med. Phys. 28 pp. 2394-2402.) </p>

<p>Definition at line <a class="el" href="filters_8h_source.html#l00696">696</a> of file <a class="el" href="filters_8h_source.html">filters.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;{</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <a class="code" href="group__Macros.html#ga536d5c60e25ce994a433d115ca6de5c9">SPEED_UP_temps</a>;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordtype">long</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = 0;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <a class="code" href="classHistogram1D.html">Histogram1D</a> histx, histy;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <a class="code" href="classHistogram2D.html">Histogram2D</a> histxy;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; T &gt;</a> aux_x, aux_y;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; double &gt;</a> mx, my;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; double &gt;</a> mxy;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordtype">int</span> xdim, ydim, zdim;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordtype">double</span> retval = 0.0;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    xdim=<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(x);</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    ydim=<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(x);</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    zdim=<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(x);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    aux_x.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(xdim * ydim * zdim);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    xdim=<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(y);</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    ydim=<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(y);</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    zdim=<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(y);</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    aux_y.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(xdim * ydim * zdim);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gaaee6e163d8f7e358c38d3fcfe935b6fc">FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D</a>(x, y)</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    {</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="keywordflow">if</span> (mask != NULL)</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            <span class="keywordflow">if</span> (!(*mask)(<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>))</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        aux_x(n) = <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(x, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        aux_y(n) = <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(y, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        n++;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    }</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    aux_x.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(n);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    aux_y.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(n);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="keywordflow">if</span> (n != 0)</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    {</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <span class="keywordflow">if</span> (nx == 0)</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            <span class="comment">//Assume Gaussian distribution</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            nx = (int)((<a class="code" href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a>((<span class="keywordtype">double</span>) n) / <a class="code" href="filters_8h.html#a07267dcd6834194cfed517197ab1e2ad">LOG2</a>) + 1);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="keywordflow">if</span> (ny == 0)</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            <span class="comment">//Assume Gaussian distribution</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            ny = (int)((<a class="code" href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a>((<span class="keywordtype">double</span>) n) / <a class="code" href="filters_8h.html#a07267dcd6834194cfed517197ab1e2ad">LOG2</a>) + 1);</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <a class="code" href="group__Histograms.html#gaaa3501212e9e03d46c6e7aba56dd6c21">compute_hist</a>(aux_x, histx, nx);</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <a class="code" href="group__Histograms.html#gaaa3501212e9e03d46c6e7aba56dd6c21">compute_hist</a>(aux_y, histy, ny);</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <a class="code" href="group__Histograms.html#gaaa3501212e9e03d46c6e7aba56dd6c21">compute_hist</a>(aux_x, aux_y, histxy, nx, ny);</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        mx = histx;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        my = histy;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        mxy = histxy;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nx; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        {</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            <span class="keywordtype">double</span> histxi = (histx(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)) / n;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; ny; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            {</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                <span class="keywordtype">double</span> histyj = (histy(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)) / n;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                <span class="keywordtype">double</span> histxyij = (histxy(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)) / n;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                <span class="keywordflow">if</span> (histxyij &gt; 0)</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                    retval += histxyij * <a class="code" href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a>(histxyij / (histxi * histyj)) /</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                              <a class="code" href="filters_8h.html#a07267dcd6834194cfed517197ab1e2ad">LOG2</a>;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            }</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        }</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="keywordflow">return</span> retval;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    }</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaaee6e163d8f7e358c38d3fcfe935b6fc"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaaee6e163d8f7e358c38d3fcfe935b6fc">FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D(V1, V2)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00308">multidim_array.h:308</a></div></div>
<div class="ttc" id="classHistogram1D_html"><div class="ttname"><a href="classHistogram1D.html">Histogram1D</a></div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00121">histogram.h:121</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_a0994f8f1ab050711112683b89fb90b0b"><div class="ttname"><a href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a></div><div class="ttdeci">void log(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00225">image_operate.cpp:225</a></div></div>
<div class="ttc" id="group__Histograms_html_gaaa3501212e9e03d46c6e7aba56dd6c21"><div class="ttname"><a href="group__Histograms.html#gaaa3501212e9e03d46c6e7aba56dd6c21">compute_hist</a></div><div class="ttdeci">void compute_hist(const MultidimArrayGeneric &amp;array, Histogram1D &amp;hist, int no_steps)</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00570">histogram.cpp:570</a></div></div>
<div class="ttc" id="filters_8h_html_a07267dcd6834194cfed517197ab1e2ad"><div class="ttname"><a href="filters_8h.html#a07267dcd6834194cfed517197ab1e2ad">LOG2</a></div><div class="ttdeci">#define LOG2</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00029">filters.h:29</a></div></div>
<div class="ttc" id="group__Macros_html_ga536d5c60e25ce994a433d115ca6de5c9"><div class="ttname"><a href="group__Macros.html#ga536d5c60e25ce994a433d115ca6de5c9">SPEED_UP_temps</a></div><div class="ttdeci">#define SPEED_UP_temps</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00419">xmipp_macros.h:419</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classHistogram2D_html"><div class="ttname"><a href="classHistogram2D.html">Histogram2D</a></div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00699">histogram.h:699</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gac36280d6ded9846f347577939ae33859"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void noisyZonesFilter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kernelSize</em> = <code>10</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Transforms I to a binary mask with 0 where both variance and mean are high. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l00851">851</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;{</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordtype">int</span> kernelSize_2 = kernelSize/2;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> kernel;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    kernel.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(kernelSize,kernelSize);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    kernel.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> mAvg=I, mVar=I;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordtype">double</span> stdKernel, varKernel, avgKernel, min_val, max_val;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>, <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>, <a class="code" href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>, <a class="code" href="blobs_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a>;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    </div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=kernelSize_2; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;(int)<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+=kernelSize_2)</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=kernelSize_2; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;(int)<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>+=kernelSize_2)</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            {</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                x0 = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>-kernelSize_2;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                y0 = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-kernelSize_2;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                xF = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>+kernelSize_2-1;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                yF = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+kernelSize_2-1;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                <span class="keywordflow">if</span> (x0 &lt; 0)</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                    x0 = 0;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                <span class="keywordflow">if</span> (xF &gt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I))</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                    xF = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I);</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                <span class="keywordflow">if</span> (y0 &lt; 0)</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                    y0 = 0;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                <span class="keywordflow">if</span> (yF &gt; <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I))</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                    yF = <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I);</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                I.<a class="code" href="classMultidimArray.html#a989ec8f5584750a4ac84a9020ad3744c">window</a>(kernel, y0, x0, yF, xF);</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                kernel.<a class="code" href="classMultidimArray.html#ab648c97e18d063ce966db9c61b68f066">computeStats</a>(avgKernel, stdKernel, min_val, max_val);</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                varKernel = stdKernel*stdKernel;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(mAvg, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = avgKernel*avgKernel;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(mVar, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = varKernel;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            }</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="comment">// filtering to fill the matrices (convolving with a Gaussian)</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <a class="code" href="classFourierFilter.html">FourierFilter</a> filter;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    filter.<a class="code" href="classFourierFilter.html#af5ced7144d0587c416bdac7d705aed45">FilterShape</a> = <a class="code" href="fourier__filter_8h.html#a61be564955992f0d12432f88997c56d2">REALGAUSSIAN</a>;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    filter.<a class="code" href="classFourierFilter.html#a7e847d4cdbf21e78ef474a42bd2da833">FilterBand</a> = <a class="code" href="fourier__filter_8h.html#ab88b316b336dadc6e77f04d6f035d86e">LOWPASS</a>;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    filter.<a class="code" href="classFourierFilter.html#a6b96657901248fdd1b4c7af47dc9c88d">w1</a> = kernelSize_2;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    filter.<a class="code" href="classFourierFilter.html#a628762260d6099753fa4b55adc4cfbb0">applyMaskSpace</a>(mAvg);</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    filter.<a class="code" href="classFourierFilter.html#a628762260d6099753fa4b55adc4cfbb0">applyMaskSpace</a>(mVar);</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="comment">// // Draw to debug</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="comment">// Image&lt;double&gt; imAvg(mAvg), imVar(mVar);</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="comment">// imAvg.write(&quot;AvgFilter.mrc&quot;);</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="comment">// imVar.write(&quot;VarFilter.mrc&quot;);</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="comment">// Working in a auxilary windows to avoid borders bad defined</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> mAvgAux(<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I)-kernelSize,<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I)-kernelSize),</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                          mVarAux(<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I)-kernelSize,<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I)-kernelSize);</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    mAvgAux.setXmippOrigin();</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    mVarAux.setXmippOrigin();</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    mAvg.<a class="code" href="classMultidimArray.html#a989ec8f5584750a4ac84a9020ad3744c">window</a>(mAvgAux,<a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(mAvg)+kernelSize_2, <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(mAvg)+kernelSize_2,</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                       <a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(mAvg)-kernelSize_2, <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(mAvg)-kernelSize_2);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    mVar.window(mVarAux,<a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(mVar)+kernelSize_2, <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(mVar)+kernelSize_2,</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                       <a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(mVar)-kernelSize_2, <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(mVar)-kernelSize_2);</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="comment">// Refiltering to get a smoother distribution</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="comment">// filter.w1 = XSIZE(I)/40;</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="comment">// filter.applyMaskSpace(mAvgAux);</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="comment">// filter.applyMaskSpace(mVarAux);</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="comment">// Binarization</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> mAvgAuxBin = mAvgAux, mVarAuxBin = mVarAux;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <a class="code" href="group__Filters.html#gad571370cecac06c79cfe09ee681c134e">EntropySegmentation</a>(mVarAuxBin);</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="comment">// EntropySegmentation(mAvgAuxBin);</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordtype">float</span> th = <a class="code" href="group__Filters.html#gad571370cecac06c79cfe09ee681c134e">EntropySegmentation</a>(mAvgAuxBin);</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    mAvgAuxBin.<a class="code" href="classMultidimArray.html#a5bb8c617896c704c673d270308e4c012">binarize</a>(th*0.92);</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    mAvgAuxBin = 1-mAvgAuxBin;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;binarize threshold = &quot; &lt;&lt; th &lt;&lt; std::endl;</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="comment">// Returning to the previous windows size</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> mAvgBin = mAvg, mVarBin = mVar;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    mAvgAuxBin.<a class="code" href="classMultidimArray.html#a989ec8f5584750a4ac84a9020ad3744c">window</a>(mAvgBin, <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(mVar), <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(mVar),</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                              <a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(mVar), <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(mVar));</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    mVarAuxBin.window(mVarBin, <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(mVar), <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(mVar),</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                              <a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(mVar), <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(mVar));</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="comment">// // Draw to debug</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="comment">// Image&lt;double&gt; imAvgBin(mAvgBin), imVarBin(mVarBin);</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="comment">// imAvgBin.write(&quot;noisyZoneFilter_AVGmask.mrc&quot;);</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="comment">// imVarBin.write(&quot;noisyZoneFilter_VARmask.mrc&quot;);</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="comment">// Combining both masks</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    I = 1-(mVarBin*mAvgBin);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;}</div><div class="ttc" id="classFourierFilter_html_a6b96657901248fdd1b4c7af47dc9c88d"><div class="ttname"><a href="classFourierFilter.html#a6b96657901248fdd1b4c7af47dc9c88d">FourierFilter::w1</a></div><div class="ttdeci">double w1</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00106">fourier_filter.h:106</a></div></div>
<div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9ed4376d9ad511e963caf118a6640b28"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a></div><div class="ttdeci">#define DIRECT_A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00351">multidim_array.h:351</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00065">multidim_array.h:65</a></div></div>
<div class="ttc" id="classFourierFilter_html_a7e847d4cdbf21e78ef474a42bd2da833"><div class="ttname"><a href="classFourierFilter.html#a7e847d4cdbf21e78ef474a42bd2da833">FourierFilter::FilterBand</a></div><div class="ttdeci">int FilterBand</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00102">fourier_filter.h:102</a></div></div>
<div class="ttc" id="classMultidimArray_html_ab648c97e18d063ce966db9c61b68f066"><div class="ttname"><a href="classMultidimArray.html#ab648c97e18d063ce966db9c61b68f066">MultidimArray::computeStats</a></div><div class="ttdeci">void computeStats(double &amp;avg, double &amp;stddev, T &amp;minval, T &amp;maxval) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03377">multidim_array.h:3377</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="classMultidimArray_html_a989ec8f5584750a4ac84a9020ad3744c"><div class="ttname"><a href="classMultidimArray.html#a989ec8f5584750a4ac84a9020ad3744c">MultidimArray::window</a></div><div class="ttdeci">void window(MultidimArray&lt; T1 &gt; &amp;result, int n0, int z0, int y0, int x0, int nF, int zF, int yF, int xF, T1 init_value=0) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01762">multidim_array.h:1762</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a0d9521fd31b2e16413d1b78836953d53"><div class="ttname"><a href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a></div><div class="ttdeci">#define y0</div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="classMultidimArray_html_a5bb8c617896c704c673d270308e4c012"><div class="ttname"><a href="classMultidimArray.html#a5bb8c617896c704c673d270308e4c012">MultidimArray::binarize</a></div><div class="ttdeci">void binarize(double val=0, double accuracy=XMIPP_EQUAL_ACCURACY, MultidimArray&lt; int &gt; *mask=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04924">multidim_array.h:4924</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a8f613ddaea2048e3471a1f4f04ba4b79"><div class="ttname"><a href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a></div><div class="ttdeci">#define xF</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00073">multidim_array.h:73</a></div></div>
<div class="ttc" id="classFourierFilter_html"><div class="ttname"><a href="classFourierFilter.html">FourierFilter</a></div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00070">fourier_filter.h:70</a></div></div>
<div class="ttc" id="fourier__filter_8h_html_a61be564955992f0d12432f88997c56d2"><div class="ttname"><a href="fourier__filter_8h.html#a61be564955992f0d12432f88997c56d2">REALGAUSSIAN</a></div><div class="ttdeci">#define REALGAUSSIAN</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00088">fourier_filter.h:88</a></div></div>
<div class="ttc" id="group__Filters_html_gad571370cecac06c79cfe09ee681c134e"><div class="ttname"><a href="group__Filters.html#gad571370cecac06c79cfe09ee681c134e">EntropySegmentation</a></div><div class="ttdeci">double EntropySegmentation(MultidimArray&lt; double &gt; &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l01045">filters.cpp:1045</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a132f3924593d07b0a1f55b3f22e92ba6"><div class="ttname"><a href="blobs_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a></div><div class="ttdeci">#define yF</div></div>
<div class="ttc" id="fourier__filter_8h_html_ab88b316b336dadc6e77f04d6f035d86e"><div class="ttname"><a href="fourier__filter_8h.html#ab88b316b336dadc6e77f04d6f035d86e">LOWPASS</a></div><div class="ttdeci">#define LOWPASS</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00078">fourier_filter.h:78</a></div></div>
<div class="ttc" id="classFourierFilter_html_a628762260d6099753fa4b55adc4cfbb0"><div class="ttname"><a href="classFourierFilter.html#a628762260d6099753fa4b55adc4cfbb0">FourierFilter::applyMaskSpace</a></div><div class="ttdeci">void applyMaskSpace(MultidimArray&lt; double &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8cpp_source.html#l00651">fourier_filter.cpp:651</a></div></div>
<div class="ttc" id="classFourierFilter_html_af5ced7144d0587c416bdac7d705aed45"><div class="ttname"><a href="classFourierFilter.html#af5ced7144d0587c416bdac7d705aed45">FourierFilter::FilterShape</a></div><div class="ttdeci">int FilterShape</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00076">fourier_filter.h:76</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gae4711a70816fcb6f8b6f72bb1b7dc8e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double OtsuSegmentation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Segment an object using Otsu's method</p>
<p>Otsu's method determines a threshold such that the variance of the two classes is minimized</p>
<p><a href="http://www.biomecardio.com/matlab/otsu.html">http://www.biomecardio.com/matlab/otsu.html</a> </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l00996">996</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;{</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="comment">// V.checkDimension(3);</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="comment">// Compute the probability density function</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <a class="code" href="classHistogram1D.html">Histogram1D</a> hist;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    hist.<a class="code" href="classHistogram1D.html#a2612603a91b3722d943f56d983903870">clear</a>();</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <a class="code" href="group__Histograms.html#gaaa3501212e9e03d46c6e7aba56dd6c21">compute_hist</a>(V, hist, 200);</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    hist /= hist.<a class="code" href="classMultidimArray.html#a2917347534008460dd52e90049e4257f">sum</a>();</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="comment">// Compute the cumulative 0th and 1st order moments</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> mom0, mom1;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    mom0.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(hist));</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    mom1.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(hist));</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    mom0(0) = hist(0);</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    hist.<a class="code" href="classHistogram1D.html#a5b24f78917ecda9d47e420b3a6c4cbd7">index2val</a>(0, x);</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    mom1(0) = hist(0) * <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(mom0); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    {</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        mom0(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = mom0(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1) + hist(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        hist.<a class="code" href="classHistogram1D.html#a5b24f78917ecda9d47e420b3a6c4cbd7">index2val</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, x);</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        mom1(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = mom1(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1) + hist(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) * <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    }</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="comment">// Maximize sigma2B</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keywordtype">double</span> bestSigma2B = -1;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="keywordtype">int</span> ibestSigma2B = -1;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(hist) - 1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    {</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        <span class="keywordtype">double</span> w1 = mom0(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        <span class="keywordtype">double</span> w2 = 1 - mom0(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="image__find__center_8cpp.html#aa79b8200b59d9c1ab483f97752ffa5e7">mu1</a> = mom1(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        <span class="keywordtype">double</span> mu2 = mom1(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(mom1) - 1) - mom1(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <span class="keywordtype">double</span> sigma2B = w1 * w2 * (mu1 - mu2) * (mu1 - mu2);</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        <span class="keywordflow">if</span> (sigma2B &gt; bestSigma2B)</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        {</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            bestSigma2B = sigma2B;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            ibestSigma2B = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        }</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    }</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    hist.<a class="code" href="classHistogram1D.html#a5b24f78917ecda9d47e420b3a6c4cbd7">index2val</a>(ibestSigma2B, x);</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    V.<a class="code" href="classMultidimArray.html#a5bb8c617896c704c673d270308e4c012">binarize</a>(x);</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;}</div><div class="ttc" id="classHistogram1D_html_a2612603a91b3722d943f56d983903870"><div class="ttname"><a href="classHistogram1D.html#a2612603a91b3722d943f56d983903870">Histogram1D::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00038">histogram.cpp:38</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classHistogram1D_html"><div class="ttname"><a href="classHistogram1D.html">Histogram1D</a></div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00121">histogram.h:121</a></div></div>
<div class="ttc" id="classHistogram1D_html_a5b24f78917ecda9d47e420b3a6c4cbd7"><div class="ttname"><a href="classHistogram1D.html#a5b24f78917ecda9d47e420b3a6c4cbd7">Histogram1D::index2val</a></div><div class="ttdeci">void index2val(double i, double &amp;v) const </div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00295">histogram.h:295</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Histograms_html_gaaa3501212e9e03d46c6e7aba56dd6c21"><div class="ttname"><a href="group__Histograms.html#gaaa3501212e9e03d46c6e7aba56dd6c21">compute_hist</a></div><div class="ttdeci">void compute_hist(const MultidimArrayGeneric &amp;array, Histogram1D &amp;hist, int no_steps)</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00570">histogram.cpp:570</a></div></div>
<div class="ttc" id="classMultidimArray_html_a5bb8c617896c704c673d270308e4c012"><div class="ttname"><a href="classMultidimArray.html#a5bb8c617896c704c673d270308e4c012">MultidimArray::binarize</a></div><div class="ttdeci">void binarize(double val=0, double accuracy=XMIPP_EQUAL_ACCURACY, MultidimArray&lt; int &gt; *mask=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04924">multidim_array.h:4924</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_aa79b8200b59d9c1ab483f97752ffa5e7"><div class="ttname"><a href="image__find__center_8cpp.html#aa79b8200b59d9c1ab483f97752ffa5e7">mu1</a></div><div class="ttdeci">int mu1</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="classMultidimArray_html_a2917347534008460dd52e90049e4257f"><div class="ttname"><a href="classMultidimArray.html#a2917347534008460dd52e90049e4257f">MultidimArray::sum</a></div><div class="ttdeci">double sum() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05095">multidim_array.h:5095</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaf221b35f63812b98fbf7b5afc31ceb22"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void pixelDesvFilter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>thresFactor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove bad pixels.</p><ul>
<li></li>
</ul>
<p>A boundaries median filter is applied at those pixels whose value is out of range given by thresFactor * std. </p>

<p>Definition at line <a class="el" href="filters_8h_source.html#l01423">1423</a> of file <a class="el" href="filters_8h_source.html">filters.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;{</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="keywordflow">if</span> (thresFactor &gt; 0 )</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    {</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;        <span class="keywordtype">double</span> avg, stddev, high, low;</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        T <a class="code" href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a>;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        <a class="code" href="classMultidimArray.html">MultidimArray&lt;char&gt;</a> mask(<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(V), <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(V), <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V));</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        avg = stddev = low = high = 0;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        V.<a class="code" href="classMultidimArray.html#ab648c97e18d063ce966db9c61b68f066">computeStats</a>(avg, stddev, dummy, dummy);<span class="comment">//min and max not used</span></div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        low  = (avg - thresFactor * stddev);</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        high = (avg + thresFactor * stddev);</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(V)</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        {</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> = <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(V, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>) = (x &lt; low || x &gt; high) ? 1 : 0;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        }</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;        <a class="code" href="group__Filters.html#ga1f7a9b2af2b245a586167a1d469a2bdd">boundMedianFilter</a>(V, mask);</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    }</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; char &gt;</a></div></div>
<div class="ttc" id="classMultidimArray_html_ab648c97e18d063ce966db9c61b68f066"><div class="ttname"><a href="classMultidimArray.html#ab648c97e18d063ce966db9c61b68f066">MultidimArray::computeStats</a></div><div class="ttdeci">void computeStats(double &amp;avg, double &amp;stddev, T &amp;minval, T &amp;maxval) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03377">multidim_array.h:3377</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad03d014386c050f947b2903e44f3b383"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a></div><div class="ttdeci">double dummy</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04652">numerical_recipes.cpp:4652</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="group__Filters_html_ga1f7a9b2af2b245a586167a1d469a2bdd"><div class="ttname"><a href="group__Filters.html#ga1f7a9b2af2b245a586167a1d469a2bdd">boundMedianFilter</a></div><div class="ttdeci">void boundMedianFilter(MultidimArray&lt; T &gt; &amp;V, const MultidimArray&lt; char &gt; &amp;mask, int n=0)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l01355">filters.h:1355</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaa67ede8a062ce8e0c34b4323bb2ca082"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void regionGrowing2D </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>stop_colour</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>filling_colour</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>less</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>neighbourhood</em> = <code>8</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Region growing for images</p>
<p>Given a position inside an image, this function grows a region with (filling_colour) until it finds a border of value (stop_colour). If the point is outside the image then nothing is done.</p>
<p>If less is true the region is grown in sucha a way that all voxels in its border are greater than the region voxels. If less is false the region is grown so that all voxels on its border are smaller than the region voxels.</p>
<p>Valid neighbourhoods are 4 or 8. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l00333">333</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;{</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    I_in.checkDimension(2);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    std::list&lt;Coordinate2D&gt; iNeighbours; <span class="comment">/* A list for neighbour pixels */</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordtype">int</span> iCurrenti, iCurrentj; <span class="comment">/* Coordinates of the current pixel considered */</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">/* First task is copying the input image into the output one */</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    I_out = I_in;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">/**** Then the region growing is done ****/</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">/* Insert at the beginning of the list the seed coordinates */</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <a class="code" href="structCoordinate2D.html">Coordinate2D</a> coord;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    coord.<a class="code" href="structCoordinate2D.html#a4b9b297a1bd2891dd27ade2bf8cbdad1">ii</a> = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    coord.<a class="code" href="structCoordinate2D.html#a87cc174af5b72e6b7bfa63b03b2a4345">jj</a> = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    iNeighbours.push_front(coord);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">/* Fill the seed coordinates */</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(I_out, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = filling_colour;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">while</span> (!iNeighbours.empty())</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="comment">/* Take the current pixel to explore */</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        coord = iNeighbours.front();</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        iNeighbours.pop_front();</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        iCurrenti = coord.<a class="code" href="structCoordinate2D.html#a4b9b297a1bd2891dd27ade2bf8cbdad1">ii</a>;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        iCurrentj = coord.<a class="code" href="structCoordinate2D.html#a87cc174af5b72e6b7bfa63b03b2a4345">jj</a>;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">#define CHECK_POINT(i,j) \</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="preprocessor">    { \</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="preprocessor">  int I=i; \</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="preprocessor">        int J=j; \</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="preprocessor">  if (INSIDEXY(I_out,J,I))  { \</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="preprocessor">   double pixel=A2D_ELEM(I_out,I,J);\</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="preprocessor">   if (pixel!=filling_colour) \</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="preprocessor">    if ((less &amp;&amp; pixel &lt; stop_colour) || \</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="preprocessor">     (!less &amp;&amp; pixel &gt; stop_colour)) { \</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="preprocessor">     coord.ii=I; \</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="preprocessor">     coord.jj=J; \</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="preprocessor">     A2D_ELEM (I_out,coord.ii,coord.jj)=filling_colour; \</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="preprocessor">     iNeighbours.push_front(coord); \</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor">    } \</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="preprocessor">  } \</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="preprocessor">    }</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="comment">/* Make the exploration of the pixel&#39;s neighbours */</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <a class="code" href="filters_8cpp.html#a83027de735085322bd4cd7d5bcd166d4">CHECK_POINT</a>(iCurrenti, iCurrentj - 1);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <a class="code" href="filters_8cpp.html#a83027de735085322bd4cd7d5bcd166d4">CHECK_POINT</a>(iCurrenti, iCurrentj + 1);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <a class="code" href="filters_8cpp.html#a83027de735085322bd4cd7d5bcd166d4">CHECK_POINT</a>(iCurrenti - 1, iCurrentj);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <a class="code" href="filters_8cpp.html#a83027de735085322bd4cd7d5bcd166d4">CHECK_POINT</a>(iCurrenti + 1, iCurrentj);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="keywordflow">if</span> (neighbourhood == 8)</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        {</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            <a class="code" href="filters_8cpp.html#a83027de735085322bd4cd7d5bcd166d4">CHECK_POINT</a>(iCurrenti - 1, iCurrentj - 1);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            <a class="code" href="filters_8cpp.html#a83027de735085322bd4cd7d5bcd166d4">CHECK_POINT</a>(iCurrenti - 1, iCurrentj + 1);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            <a class="code" href="filters_8cpp.html#a83027de735085322bd4cd7d5bcd166d4">CHECK_POINT</a>(iCurrenti + 1, iCurrentj - 1);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            <a class="code" href="filters_8cpp.html#a83027de735085322bd4cd7d5bcd166d4">CHECK_POINT</a>(iCurrenti + 1, iCurrentj + 1);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        }</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;}</div><div class="ttc" id="structCoordinate2D_html_a87cc174af5b72e6b7bfa63b03b2a4345"><div class="ttname"><a href="structCoordinate2D.html#a87cc174af5b72e6b7bfa63b03b2a4345">Coordinate2D::jj</a></div><div class="ttdeci">int jj</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00329">filters.cpp:329</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00364">multidim_array.h:364</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="filters_8cpp_html_a83027de735085322bd4cd7d5bcd166d4"><div class="ttname"><a href="filters_8cpp.html#a83027de735085322bd4cd7d5bcd166d4">CHECK_POINT</a></div><div class="ttdeci">#define CHECK_POINT(i, j)</div></div>
<div class="ttc" id="structCoordinate2D_html"><div class="ttname"><a href="structCoordinate2D.html">Coordinate2D</a></div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00326">filters.cpp:326</a></div></div>
<div class="ttc" id="structCoordinate2D_html_a4b9b297a1bd2891dd27ade2bf8cbdad1"><div class="ttname"><a href="structCoordinate2D.html#a4b9b297a1bd2891dd27ade2bf8cbdad1">Coordinate2D::ii</a></div><div class="ttdeci">int ii</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00328">filters.cpp:328</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga0c5d971c2f1b8bfc8b21c70e3956fef2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void removeSmallComponents </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>neighbourhood</em> = <code>8</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove connected components</p>
<p>Remove connected components smaller than a given size. They are set to 0. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l00679">679</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;{</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> label;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="keywordtype">int</span> imax;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(I)==1)</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        imax=<a class="code" href="group__Filters.html#ga206a93c383ad7f6ba43c67f18486cc21">labelImage2D</a>(I, label, neighbourhood);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        imax=<a class="code" href="group__Filters.html#gaad2c4bf9d2a76b096825a3c7b9e23b1a">labelImage3D</a>(I, label);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;int&gt;</a> nlabel(imax + 1);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(label)</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    {</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        <span class="keywordtype">int</span> l=(int)<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(label,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(nlabel,l)++;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    }</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(label)</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    {</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keywordtype">int</span> l=(int)<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(label,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(nlabel,l)&lt;size)</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(I,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)=0;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    }</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga97809f7244a28aaa1c26e29e6e3204ef"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a></div><div class="ttdeci">#define A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00549">multidim_array.h:549</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="group__Filters_html_ga206a93c383ad7f6ba43c67f18486cc21"><div class="ttname"><a href="group__Filters.html#ga206a93c383ad7f6ba43c67f18486cc21">labelImage2D</a></div><div class="ttdeci">int labelImage2D(const MultidimArray&lt; double &gt; &amp;I, MultidimArray&lt; double &gt; &amp;label, int neighbourhood)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00636">filters.cpp:636</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="group__Filters_html_gaad2c4bf9d2a76b096825a3c7b9e23b1a"><div class="ttname"><a href="group__Filters.html#gaad2c4bf9d2a76b096825a3c7b9e23b1a">labelImage3D</a></div><div class="ttdeci">int labelImage3D(const MultidimArray&lt; double &gt; &amp;V, MultidimArray&lt; double &gt; &amp;label)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00658">filters.cpp:658</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga21987af66fc45fb745dcfde4c095c95a"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">double rms </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>mask</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>Contributions</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>RMS nD </p>

<p>Definition at line <a class="el" href="filters_8h_source.html#l00776">776</a> of file <a class="el" href="filters_8h_source.html">filters.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;{</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <a class="code" href="group__Macros.html#ga4c9386c11dfbaac4b99d2f7799dbc0c1">SPEED_UP_tempsInt</a>;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="keywordtype">double</span> retval = 0;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="keywordtype">double</span> aux;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = 0;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="comment">// If contributions are desired</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="keywordflow">if</span> (Contributions != NULL)</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    {</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gaaee6e163d8f7e358c38d3fcfe935b6fc">FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D</a>(x, y)</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        {</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            <span class="keywordflow">if</span> (mask != NULL)</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                <span class="keywordflow">if</span> (!(*mask)(<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>))</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            aux = (<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(x, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) - <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(y, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)) *</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                  (<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(x, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) - <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(y, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*Contributions, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = aux;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            retval += aux;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            n++;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        }</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(*Contributions)</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*Contributions, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(*Contributions,</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                                            k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) / n);</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    }</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    {</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gaaee6e163d8f7e358c38d3fcfe935b6fc">FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D</a>(x, y)</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        {</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            <span class="keywordflow">if</span> (mask != NULL)</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                <span class="keywordflow">if</span> (!(*mask)(k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>))</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            retval += (<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(x, k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) - <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(y, k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)) *</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                      (<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(x, k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) - <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(y, k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            n++;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        }</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    }</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keywordflow">if</span> (n != 0)</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(retval / n);</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_a0544c3fe466e421738dae463968b70ba"><div class="ttname"><a href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="ttdeci">else</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02919">numerical_recipes.cpp:2919</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00279">multidim_array.h:279</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaaee6e163d8f7e358c38d3fcfe935b6fc"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaaee6e163d8f7e358c38d3fcfe935b6fc">FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D(V1, V2)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00308">multidim_array.h:308</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="group__Macros_html_ga4c9386c11dfbaac4b99d2f7799dbc0c1"><div class="ttname"><a href="group__Macros.html#ga4c9386c11dfbaac4b99d2f7799dbc0c1">SPEED_UP_tempsInt</a></div><div class="ttdeci">#define SPEED_UP_tempsInt</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00408">xmipp_macros.h:408</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga38f91d2b897842c80561364893f45101"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotationalInvariantMoments </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Rotational invariant moments</p>
<p>The mask and the image are supposed to be of the same shape. If no mask is provided, the moments are computed on the whole image. The moments are measured with respect to the origin of the image.</p>
<p>These moments have been taken from <a href="http://www.cs.cf.ac.uk/Dave/Vision_lecture/node36.html">http://www.cs.cf.ac.uk/Dave/Vision_lecture/node36.html</a> (moments 1 to 5). </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02797">2797</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;{</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;    img.checkDimension(2);</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;    <span class="comment">// Prepare some variables</span></div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;    <span class="keywordtype">double</span> m_11 = 0, m_02 = 0, m_20 = 0, m_12 = 0, m_21 = 0, m_03 = 0, m_30 = 0; <span class="comment">//, m_00=0;</span></div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;    <span class="keywordtype">double</span> normalize_x = 2.0 / <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(img);</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;    <span class="keywordtype">double</span> normalize_y = 2.0 / <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(img);</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    <span class="comment">// Compute low-level moments</span></div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(img)</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;    {</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;        <span class="keywordflow">if</span> (mask != NULL)</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;            <span class="keywordflow">if</span> (!(*mask)(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>))</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;        <span class="keywordtype">double</span> val = img(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#a229d11aff11a7482259d1296b9b70b8a">dx</a> = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> * normalize_x;</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;        <span class="keywordtype">double</span> dy = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * normalize_y;</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;        <span class="keywordtype">double</span> dx2 = dx * <a class="code" href="numerical__recipes_8cpp.html#a229d11aff11a7482259d1296b9b70b8a">dx</a>, dx3 = dx2 * <a class="code" href="numerical__recipes_8cpp.html#a229d11aff11a7482259d1296b9b70b8a">dx</a>;</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;        <span class="keywordtype">double</span> dy2 = dy * dy, dy3 = dy2 * dy;</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;        <span class="comment">// m_00+=val;</span></div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;        m_11 += val * dx * dy;</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;        m_02 += val * dy2;</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;        m_20 += val * dx2;</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;        m_12 += val * dx * dy2;</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;        m_21 += val * dx2 * dy;</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;        m_03 += val * dy3;</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;        m_30 += val * dx3;</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;    }</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;    <span class="comment">//m_11/=m_00; m_02/=m_00; m_20/=m_00;</span></div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;    <span class="comment">//m_12/=m_00; m_21/=m_00; m_03/=m_00; m_30/=m_00;</span></div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;    <span class="comment">// Compute high-level rotational invariant moments</span></div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;    v_out.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(5);</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;    v_out(0) = m_20 + m_02;</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;    v_out(1) = (m_20 - m_02) * (m_20 - m_02) + 4 * m_11 * m_11;</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;    v_out(2) = (m_30 - 3 * m_12) * (m_30 - 3 * m_12)</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;               + (3 * m_21 - m_03) * (3 * m_21 - m_03);</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    v_out(3) = (m_30 + m_12) * (m_30 + m_12) + (m_21 + m_03) * (m_21 + m_03);</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;    v_out(4) =</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;        (m_30 - 3 * m_12) * (m_30 + m_12)</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;        * ((m_30 + m_12) * (m_30 + m_12)</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;           - 3 * (m_21 + m_03) * (m_21 + m_03))</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;        + (3 * m_21 - m_03) * (m_21 + m_03)</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;        * (3 * (m_30 + m_12) * (m_30 + m_12)</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;           - (m_21 + m_03) * (m_21 + m_03));</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;<span class="comment">     v_out( 5)=(m_20+m_02)*(</span></div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;<span class="comment">     (m_30+m_12)*(m_30+m_12)</span></div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;<span class="comment">     -3*(m_21+m_03)*(m_21+m_03))</span></div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;<span class="comment">     +4*m_11*(m_30+m_12)*(m_03+m_21);</span></div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;<span class="comment">     v_out( 6)=(3*m_21-m_03)*(m_12+m_30)*(</span></div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;<span class="comment">     (m_30+m_12)*(m_30+m_12)</span></div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;<span class="comment">     -3*(m_21+m_03)*(m_21+m_03))</span></div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;<span class="comment">     -(m_30-3*m_12)*(m_12+m_03)*(</span></div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;<span class="comment">     3*(m_30+m_12)*(m_30+m_12)</span></div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;<span class="comment">     -(m_21+m_03)*(m_21+m_03));</span></div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00400">multidim_array.h:400</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a229d11aff11a7482259d1296b9b70b8a"><div class="ttname"><a href="numerical__recipes_8cpp.html#a229d11aff11a7482259d1296b9b70b8a">dx</a></div><div class="ttdeci">double dx</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l06229">numerical_recipes.cpp:6229</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga998cbed84978df5207b2fe4b245bf3f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void smoothingShah </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>surface_strength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>edge_strength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>OuterLoops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>InnerLoops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>RefinementLoops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>adjust_range</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Mumford-Shah smoothing</p>
<p>This function simultaneously smooths and segments an image using non-linear diffusion. Mumford-&amp;-Shah's functional minimization algorithm is used to detect region boundaries and relax image smoothness constraints near these discontinuities. The functional minimized is:</p>
<p>E = W0*(f-d)*(f-d) (data matching)</p><ul>
<li>W1*(fx*fx + fy*fy)*(1-s)*(1-s) (1st deriv smooth)</li>
<li>W2*(s*s) (edge strengths)</li>
<li>W3*(sx*sx + sy*sy) (edge smoothness)</li>
</ul>
<p>The program diffusion from KUIM (developed by J. Gaush, U. Kansas) was used as the "seed".</p>
<p>Paper: Teboul, et al. IEEE-Trans. on <a class="el" href="classImage.html">Image</a> Proc. Vol. 7, 387-397. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02619">2619</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;{</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    img.checkDimension(2);</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;    <a class="code" href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a>(img, surface_strength);</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    <span class="keywordflow">if</span> (adjust_range)</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;        surface_strength.<a class="code" href="classMultidimArray.html#a440e7bebcbc257bb20b045f9ff272197">rangeAdjust</a>(0, 1);</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;    edge_strength.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(img);</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> = 1; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> &lt;= RefinementLoops; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>++)</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    {</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;        <span class="comment">// Initialize Edge Image.</span></div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;        edge_strength.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;        <span class="keywordtype">double</span> diffsurface = <a class="code" href="data__types_8h.html#a5e9e29217f6ec61105a4520ec5942225">MAXFLOAT</a>; <span class="comment">// Reset surface difference</span></div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0;</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;             ((<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; OuterLoops) &amp;&amp; OuterLoops)</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;             || ((diffsurface &gt; <a class="code" href="filters_8cpp.html#a83f10ea672c60fccf3e6e9ae53a70be4">SHAH_CONVERGENCE_THRESHOLD</a>)</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;                 &amp;&amp; !OuterLoops); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;        {</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;            <span class="comment">/* std::cout &lt;&lt; &quot;Iteration ...&quot; &lt;&lt; i+1;*/</span></div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;            <span class="comment">/* Iteratively update surface estimate */</span></div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; InnerLoops; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;                diffsurface = <a class="code" href="filters_8cpp.html#a0b74d4db0a2342e875b5532a3a3da091">Update_surface_Shah</a>(img, surface_strength,</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;                                                  edge_strength, W);</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;            <span class="comment">/* Iteratively update edge estimate */</span></div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; InnerLoops; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;                <a class="code" href="filters_8cpp.html#ab28b4aeb1c2a70160e9ee6a586f079b2">Update_edge_Shah</a>(img, surface_strength, edge_strength, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, W);</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;            <span class="comment">/* Calculate new functional energy */</span></div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;            <a class="code" href="filters_8cpp.html#ae0aa8a7a56c678bf69497aa682d14599">Shah_energy</a>(img, surface_strength, edge_strength, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, W);</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;        }</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;    }</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;}</div><div class="ttc" id="filters_8cpp_html_ae0aa8a7a56c678bf69497aa682d14599"><div class="ttname"><a href="filters_8cpp.html#ae0aa8a7a56c678bf69497aa682d14599">Shah_energy</a></div><div class="ttdeci">double Shah_energy(const MultidimArray&lt; double &gt; &amp;img, const MultidimArray&lt; double &gt; &amp;surface_strength, const MultidimArray&lt; double &gt; &amp;edge_strength, double K, const Matrix1D&lt; double &gt; &amp;W)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l02416">filters.cpp:2416</a></div></div>
<div class="ttc" id="classMultidimArray_html_ac0efebfb32ab4e37cf33efca3349aa9b"><div class="ttname"><a href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">MultidimArray::resizeNoCopy</a></div><div class="ttdeci">void resizeNoCopy(const MultidimArray&lt; T1 &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01702">multidim_array.h:1702</a></div></div>
<div class="ttc" id="classMultidimArray_html_a440e7bebcbc257bb20b045f9ff272197"><div class="ttname"><a href="classMultidimArray.html#a440e7bebcbc257bb20b045f9ff272197">MultidimArray::rangeAdjust</a></div><div class="ttdeci">void rangeAdjust(T minF, T maxF)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03586">multidim_array.h:3586</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="filters_8cpp_html_ab28b4aeb1c2a70160e9ee6a586f079b2"><div class="ttname"><a href="filters_8cpp.html#ab28b4aeb1c2a70160e9ee6a586f079b2">Update_edge_Shah</a></div><div class="ttdeci">double Update_edge_Shah(MultidimArray&lt; double &gt; &amp;img, MultidimArray&lt; double &gt; &amp;surface_strength, MultidimArray&lt; double &gt; &amp;edge_strength, double K, const Matrix1D&lt; double &gt; &amp;W)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l02557">filters.cpp:2557</a></div></div>
<div class="ttc" id="data__types_8h_html_a5e9e29217f6ec61105a4520ec5942225"><div class="ttname"><a href="data__types_8h.html#a5e9e29217f6ec61105a4520ec5942225">MAXFLOAT</a></div><div class="ttdeci">#define MAXFLOAT</div><div class="ttdef"><b>Definition:</b> <a href="data__types_8h_source.html#l00047">data_types.h:47</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="filters_8cpp_html_a0b74d4db0a2342e875b5532a3a3da091"><div class="ttname"><a href="filters_8cpp.html#a0b74d4db0a2342e875b5532a3a3da091">Update_surface_Shah</a></div><div class="ttdeci">double Update_surface_Shah(MultidimArray&lt; double &gt; &amp;img, MultidimArray&lt; double &gt; &amp;surface_strength, MultidimArray&lt; double &gt; &amp;edge_strength, const Matrix1D&lt; double &gt; &amp;W)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l02479">filters.cpp:2479</a></div></div>
<div class="ttc" id="group__Vectors_html_gaf36b657319bb585c75cfa14744dab275"><div class="ttname"><a href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a></div><div class="ttdeci">void typeCast(const Matrix1D&lt; T1 &gt; &amp;v1, Matrix1D&lt; T2 &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01904">matrix1d.h:1904</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="filters_8cpp_html_a83f10ea672c60fccf3e6e9ae53a70be4"><div class="ttname"><a href="filters_8cpp.html#a83f10ea672c60fccf3e6e9ae53a70be4">SHAH_CONVERGENCE_THRESHOLD</a></div><div class="ttdeci">#define SHAH_CONVERGENCE_THRESHOLD</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l02618">filters.cpp:2618</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaab5fc6c34e0dca5113d45b65bf9e4d3d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SmoothResize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="xvsmooth_8cpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&#160;</td>
          <td class="paramname"><em>srcpic8</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="xvsmooth_8cpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&#160;</td>
          <td class="paramname"><em>destpic8</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>swide</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>shigh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>dwide</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>dhigh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Resize of a 8-bit image </p>

<p>Definition at line <a class="el" href="xvsmooth_8cpp_source.html#l00093">93</a> of file <a class="el" href="xvsmooth_8cpp_source.html">xvsmooth.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                                                                                                         {</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">/* generic interface to Smooth and ColorDither code.</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">     given an 8-bit-per, swide * shigh image with colormap rmap,gmap,bmap,</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">     will generate a new 8-bit-per, dwide * dhigh image, which is dithered</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">     using colors found in rdmap, gdmap, bdmap arrays */</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">/* returns ptr to a dwide*dhigh array of bytes, or NULL on failure */</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="xvsmooth_8cpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> * picSmooth = <a class="code" href="xvsmooth_8cpp.html#a770b05dfee85f855f36726121fc7912c">Smooth</a>(picSrc8, swide, shigh, dwide, dhigh);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">if</span> (picSmooth) {</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <a class="code" href="xvsmooth_8cpp.html#ae140afbdd65d846997912c9958924356">DoColorDither</a>(picSmooth, destpic8, dwide, dhigh);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a>(picSmooth);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;}</div><div class="ttc" id="xvsmooth_8cpp_html_ae140afbdd65d846997912c9958924356"><div class="ttname"><a href="xvsmooth_8cpp.html#ae140afbdd65d846997912c9958924356">DoColorDither</a></div><div class="ttdeci">void DoColorDither(byte *picSmooth, byte *&amp;picDithered, size_t w, size_t h)</div><div class="ttdef"><b>Definition:</b> <a href="xvsmooth_8cpp_source.html#l00297">xvsmooth.cpp:297</a></div></div>
<div class="ttc" id="xvsmooth_8cpp_html_a770b05dfee85f855f36726121fc7912c"><div class="ttname"><a href="xvsmooth_8cpp.html#a770b05dfee85f855f36726121fc7912c">Smooth</a></div><div class="ttdeci">byte * Smooth(byte *picSrc8, size_t swide, size_t shigh, size_t dwide, size_t dhigh)</div><div class="ttdef"><b>Definition:</b> <a href="xvsmooth_8cpp_source.html#l00108">xvsmooth.cpp:108</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a32927ba57ddc0c409fd40fe79cad9982"><div class="ttname"><a href="numerical__recipes_8cpp.html#a32927ba57ddc0c409fd40fe79cad9982">free</a></div><div class="ttdeci">free((char *) ob)</div></div>
<div class="ttc" id="xvsmooth_8cpp_html_a0c8186d9b9b7880309c27230bbb5e69d"><div class="ttname"><a href="xvsmooth_8cpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a></div><div class="ttdeci">unsigned char byte</div><div class="ttdef"><b>Definition:</b> <a href="xvsmooth_8cpp_source.html#l00073">xvsmooth.cpp:73</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga11b22ba5fdb8431cb8c534ae4a91d554"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void substractBackgroundPlane </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Subtract background</p>
<p>The background is computed as the plane which best fits all density values, then this plane is subtracted from the image. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l00035">35</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;{</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    I.checkDimension(2);</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> A(3, 3);</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>(3), <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>(3);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// Solve the plane &#39;x&#39;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    A.initZeros();</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>.initZeros();</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(I)</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    {</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        A(0, 0) += <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> * <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        A(0, 1) += j * <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        A(0, 2) += <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        A(1, 1) += i * <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        A(1, 2) += <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        A(2, 2) += 1;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>(0) += j * <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(I, i, j);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>(1) += i * <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(I, i, j);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>(2) += <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(I, i, j);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    A(1, 0) = A(0, 1);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    A(2, 0) = A(0, 2);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    A(2, 1) = A(1, 2);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="group__NumericalTools.html#ga97aa59ea3c2ed976c363510ea8c251d7">solve</a>(A, <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// Now subtract the plane</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(I)</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(I, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) -= <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>(0) * i + <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>(1) * <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>(2);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00364">multidim_array.h:364</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af090b2fbbd2916bfb2e493c5162969d6"><div class="ttname"><a href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a></div><div class="ttdeci">doublereal * b</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00400">multidim_array.h:400</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__NumericalTools_html_ga97aa59ea3c2ed976c363510ea8c251d7"><div class="ttname"><a href="group__NumericalTools.html#ga97aa59ea3c2ed976c363510ea8c251d7">solve</a></div><div class="ttdeci">void solve(const Matrix2D&lt; T &gt; &amp;A, const Matrix1D&lt; T &gt; &amp;b, Matrix1D&lt; T &gt; &amp;result)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__tools_8h_source.html#l00221">numerical_tools.h:221</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaa6c14e5ee97aee4c8c4a0db657d610e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void substractBackgroundRollingBall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>radius</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Subtract background</p>
<p>The background is computed as a rolling ball operation with a ball with this radius. The radius is typically Xdim/10.</p>
<p>This code has been implemented after the one of "Subtract background" in ImageJ. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l00069">69</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;{</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    I.checkDimension(2);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// Build the ball</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">int</span> arcTrimPer;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordtype">int</span> shrinkFactor;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">if</span> (radius &lt;= 10)</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        shrinkFactor = 1;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        arcTrimPer = 24; <span class="comment">// trim 24% in x and y</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (radius &lt;= 30)</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    {</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        shrinkFactor = 2;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        arcTrimPer = 24; <span class="comment">// trim 24% in x and y</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (radius &lt;= 100)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        shrinkFactor = 4;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        arcTrimPer = 32; <span class="comment">// trim 32% in x and y</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    }</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    {</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        shrinkFactor = 8;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        arcTrimPer = 40; <span class="comment">// trim 40% in x and y</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordtype">double</span> smallballradius = radius / shrinkFactor;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">if</span> (smallballradius &lt; 1)</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        smallballradius = 1;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a> = smallballradius * smallballradius;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordtype">int</span> xtrim = (int) (arcTrimPer * smallballradius) / 100; <span class="comment">// only use a patch of the rolling ball</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">int</span> halfWidth = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(smallballradius - xtrim);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">int</span> ballWidth = 2 * halfWidth + 1;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> ball(ballWidth, ballWidth);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    ball.setXmippOrigin();</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(ball)</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordtype">double</span> temp = r2 - <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> * <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        ball(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j) = temp &gt; 0. ? <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(temp) : 0.;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">// Shrink the image: each point in the shrinked image is the</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// minimum of its neighbourhood</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">int</span> sXdim = (<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I) + shrinkFactor - 1) / shrinkFactor;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordtype">int</span> sYdim = (<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I) + shrinkFactor - 1) / shrinkFactor;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> shrinkI(sYdim, sXdim);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    shrinkI.setXmippOrigin();</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ySmall = 0; ySmall &lt; sYdim; ySmall++)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> xSmall = 0; xSmall &lt; sXdim; xSmall++)</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keywordtype">double</span> minVal = 1e38;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0, <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> = shrinkFactor * ySmall;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                 j &lt; shrinkFactor &amp;&amp; <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> &lt; (int)<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I); j++, <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>++)</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> = 0, <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> = shrinkFactor * xSmall;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                     <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> &lt; shrinkFactor &amp;&amp; <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> &lt; (int)<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I); <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>++, <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>++)</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                    <span class="keywordtype">double</span> thispixel = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(I,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                    <span class="keywordflow">if</span> (thispixel &lt; minVal)</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                        minVal = thispixel;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                }</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(shrinkI,ySmall,xSmall) = minVal;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        }</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// Now roll the ball</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    radius = ballWidth / 2;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Irolled;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    Irolled.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(shrinkI);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    Irolled.<a class="code" href="classMultidimArray.html#a239f45b043ed7715dec4d44ceef74dce">initConstant</a>(-500);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yb = -radius; yb &lt; (int)<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(shrinkI) + radius; yb++)</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    {</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="comment">// Limits of the ball</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a> = yb - radius;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">if</span> (y0 &lt; 0)</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            y0 = 0;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordtype">int</span> y0b = y0 - yb + radius; <span class="comment">//y coordinate in the ball corresponding to y0</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="blobs_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a> = yb + radius;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">if</span> (yF &gt;= (<span class="keywordtype">int</span>)<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(shrinkI))</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            yF = (<span class="keywordtype">int</span>)<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(shrinkI) - 1;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> xb = -radius; xb &lt; (int)<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(shrinkI) + radius; xb++)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="comment">// Limits of the ball</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a> = xb - radius;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="keywordflow">if</span> (x0 &lt; 0)</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                x0 = 0;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <span class="keywordtype">int</span> x0b = x0 - xb + radius;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a> = xb + radius;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="keywordflow">if</span> (xF &gt;= (<span class="keywordtype">int</span>)<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(shrinkI))</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                xF = (<span class="keywordtype">int</span>)<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(shrinkI) - 1;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> = 1e38;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yp = y0, ybp = y0b; yp &lt;= <a class="code" href="blobs_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a>; yp++, ybp++)</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> xp = x0, xbp = x0b; xp &lt;= <a class="code" href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>; xp++, xbp++)</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                    <span class="keywordtype">double</span> zReduced = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(shrinkI,yp,xp)</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                      - <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(ball,ybp,xbp);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                    <span class="keywordflow">if</span> (z &gt; zReduced)</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                        z = zReduced;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yp = y0, ybp = y0b; yp &lt;= <a class="code" href="blobs_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a>; yp++, ybp++)</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> xp = x0, xbp = x0b; xp &lt;= <a class="code" href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>; xp++, xbp++)</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                {</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                    <span class="keywordtype">double</span> zMin = z + <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(ball,ybp,xbp);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(Irolled,yp,xp) &lt; zMin)</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                        <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(Irolled,yp,xp) = zMin;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                }</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// Now rescale the background</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> bgEnlarged;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#gafc49d813bd3c47ca193e504888d78b2a">scaleToSize</a>(<a class="code" href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a>, bgEnlarged, Irolled, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I), <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I));</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    bgEnlarged.<a class="code" href="classMultidimArrayBase.html#a181ca86d77fd52d934ccc2263623b564">copyShape</a>(I);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    I -= bgEnlarged;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9ed4376d9ad511e963caf118a6640b28"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a></div><div class="ttdeci">#define DIRECT_A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00351">multidim_array.h:351</a></div></div>
<div class="ttc" id="classMultidimArray_html_ac0efebfb32ab4e37cf33efca3349aa9b"><div class="ttname"><a href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">MultidimArray::resizeNoCopy</a></div><div class="ttdeci">void resizeNoCopy(const MultidimArray&lt; T1 &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01702">multidim_array.h:1702</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad919bbce6f061400a0bc5231a9cd1621"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a></div><div class="ttdeci">static double * y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08506">numerical_recipes.cpp:8506</a></div></div>
<div class="ttc" id="classMultidimArray_html_a239f45b043ed7715dec4d44ceef74dce"><div class="ttname"><a href="classMultidimArray.html#a239f45b043ed7715dec4d44ceef74dce">MultidimArray::initConstant</a></div><div class="ttdeci">void initConstant(T val)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04309">multidim_array.h:4309</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a0d9521fd31b2e16413d1b78836953d53"><div class="ttname"><a href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a></div><div class="ttdeci">#define y0</div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00400">multidim_array.h:400</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gac645eb9a88619ee6f5e14c557ab8ef62"><div class="ttname"><a href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a></div><div class="ttdeci">#define LINEAR</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00208">transformations.h:208</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aa508e3dbd0e86258b5c69e8a8b6b8295"><div class="ttname"><a href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08509">numerical_recipes.cpp:8509</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a8f613ddaea2048e3471a1f4f04ba4b79"><div class="ttname"><a href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a></div><div class="ttdeci">#define xF</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gafc49d813bd3c47ca193e504888d78b2a"><div class="ttname"><a href="group__GeometricalTransformations.html#gafc49d813bd3c47ca193e504888d78b2a">scaleToSize</a></div><div class="ttdeci">void scaleToSize(int SplineDegree, MultidimArrayGeneric &amp;V2, const MultidimArrayGeneric &amp;V1, int Xdim, int Ydim, int Zdim)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00595">transformations.cpp:595</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a181ca86d77fd52d934ccc2263623b564"><div class="ttname"><a href="classMultidimArrayBase.html#a181ca86d77fd52d934ccc2263623b564">MultidimArrayBase::copyShape</a></div><div class="ttdeci">void copyShape(const MultidimArrayBase &amp;m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00183">multidim_array.cpp:183</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="image__find__center_8cpp_html_ab7a69dabaa7151dae4d7a3998167e2f3"><div class="ttname"><a href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a></div><div class="ttdeci">float r2</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00051">image_find_center.cpp:51</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a132f3924593d07b0a1f55b3f22e92ba6"><div class="ttname"><a href="blobs_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a></div><div class="ttdeci">#define yF</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga6d8d88ce2ecf79280b949eeddf6305bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double tomographicDiffusion </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lambda</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tomographic diffusion</p>
<p>The direction of the tilt axis must be taken into account in the definition of the diffusion constants alpha.</p>
<p>The function returns the value of the regularization term. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02663">2663</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;{</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    V.checkDimension(3);</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;    <span class="keywordtype">double</span> alphax = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(alpha);</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;    <span class="keywordtype">double</span> alphay = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(alpha);</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;    <span class="keywordtype">double</span> alphaz = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(alpha);</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;    <span class="keywordtype">double</span> diffx, diffy, diffz;</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;    <span class="comment">// Compute regularization error</span></div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    <span class="keywordtype">double</span> regError = 0;</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> = 1; <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(V) - 1; <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>++)</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> = 1; <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(V) - 1; <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>++)</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> = 1; <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V) - 1; <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>++)</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;            {</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;                diffx = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>+1) - <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>-1);</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;                diffy = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>+1,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>) - <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>-1,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>);</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;                diffz = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>+1,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>) - <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>-1,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>);</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;                regError += <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;                                alphax * diffx * diffx + alphay * diffy * diffy</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;                                + alphaz * diffz * diffz);</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;            }</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;    regError *= 0.5;</div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    <span class="comment">// Compute the gradient of the regularization error</span></div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> gradient;</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    gradient.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(V);</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> = 2; <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(V) - 2; <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>++)</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> = 2; <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(V) - 2; <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>++)</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> = 2; <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V) - 2; <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>++)</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;            {</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;                <span class="comment">// First term</span></div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;                <span class="keywordtype">double</span> V000 = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>);</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;                <span class="keywordtype">double</span> V_200 = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>-2);</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;                <span class="keywordtype">double</span> V_110 = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>+1,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>-1);</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;                <span class="keywordtype">double</span> V_1_10 = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>-1,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>-1);</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;                <span class="keywordtype">double</span> V_101 = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>+1,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>-1);</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;                <span class="keywordtype">double</span> V_10_1 = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>-1,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>-1);</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;                diffx = V000 - V_200;</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;                diffy = V_110 - V_1_10;</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;                diffz = V_101 - V_10_1;</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;                <span class="keywordtype">double</span> t1 = diffx</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;                            / <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;                                alphax * diffx * diffx + alphay * diffy * diffy</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;                                + alphaz * diffz * diffz);</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;                <span class="comment">// Second term</span></div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;                <span class="keywordtype">double</span> V200 = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>+2);</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;                <span class="keywordtype">double</span> V110 = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>+1,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>+1);</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;                <span class="keywordtype">double</span> V1_10 = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>-1,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>+1);</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;                <span class="keywordtype">double</span> V101 = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>+1,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>+1);</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;                <span class="keywordtype">double</span> V10_1 = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>-1,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>+1);</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;                diffx = V200 - V000;</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;                diffy = V110 - V1_10;</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;                diffz = V101 - V10_1;</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;                <span class="keywordtype">double</span> t2 = diffx</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;                            / <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;                                alphax * diffx * diffx + alphay * diffy * diffy</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;                                + alphaz * diffz * diffz);</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;                <span class="comment">// Third term</span></div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;                <span class="keywordtype">double</span> V0_20 = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>-2,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>);</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;                <span class="keywordtype">double</span> V0_11 = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>+1,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>-1,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>);</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;                <span class="keywordtype">double</span> V0_1_1 = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>-1,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>-1,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>);</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;                diffx = V1_10 - V_1_10;</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;                diffy = V000 - V0_20;</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;                diffz = V0_11 - V0_1_1;</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;                <span class="keywordtype">double</span> t3 = diffy</div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;                            / <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;                                alphax * diffx * diffx + alphay * diffy * diffy</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;                                + alphaz * diffz * diffz);</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;                <span class="comment">// Fourth term</span></div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;                <span class="keywordtype">double</span> V020 = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>+2,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>);</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;                <span class="keywordtype">double</span> V011 = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>+1,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>+1,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>);</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;                <span class="keywordtype">double</span> V01_1 = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>-1,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>+1,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>);</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;                diffx = V110 - V_110;</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;                diffy = V020 - V000;</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;                diffz = V011 - V01_1;</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;                <span class="keywordtype">double</span> t4 = diffy</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;                            / <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;                                alphax * diffx * diffx + alphay * diffy * diffy</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;                                + alphaz * diffz * diffz);</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;                <span class="comment">// Fifth term</span></div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;                <span class="keywordtype">double</span> V00_2 = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>-2,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>);</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;                diffx = V10_1 - V_10_1;</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;                diffy = V01_1 - V0_1_1;</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;                diffz = V000 - V00_2;</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;                <span class="keywordtype">double</span> t5 = diffz</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;                            / <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;                                alphax * diffx * diffx + alphay * diffy * diffy</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;                                + alphaz * diffz * diffz);</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;                <span class="comment">// Sixth term</span></div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;                <span class="keywordtype">double</span> V002 = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>+2,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>);</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;                diffx = V101 - V_101;</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;                diffy = V011 - V0_11;</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;                diffz = V002 - V000;</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;                <span class="keywordtype">double</span> t6 = diffz</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;                            / <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;                                alphax * diffx * diffx + alphay * diffy * diffy</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;                                + alphaz * diffz * diffz);</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;                <span class="comment">// Compute gradient</span></div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(gradient,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>) = 0.5</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;                                                  * (alphax * (t1 - t2) + alphay * (t3 - t4)</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;                                                     + alphaz * (t5 - t6));</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;            }</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;    VolumeXmipp save;</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;    save()=V;</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;    save.<a class="code" href="classMultidimArray.html#a4a4e45352f73539481de04cbda5f3f3d">write</a>(<span class="stringliteral">&quot;PPPvolume.vol&quot;</span>);</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;    save()=gradient;</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;    save.<a class="code" href="classMultidimArray.html#a4a4e45352f73539481de04cbda5f3f3d">write</a>(<span class="stringliteral">&quot;PPPgradient.vol&quot;</span>);</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Press any key\n&quot;</span>;</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;    <span class="keywordtype">char</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;    std::cin &gt;&gt; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;    <span class="comment">// Update volume</span></div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> = 2; <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(V) - 2; <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>++)</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> = 2; <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(V) - 2; <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>++)</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> = 2; <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V) - 2; <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>++)</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>) -= <a class="code" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a></div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;                                            * <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(gradient,<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>,<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>,<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>);</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;    <span class="comment">// Finish</span></div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;    <span class="keywordflow">return</span> regError;</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad919bbce6f061400a0bc5231a9cd1621"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a></div><div class="ttdeci">static double * y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08506">numerical_recipes.cpp:8506</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gacac7be97c37bd2e4f801976749de839c"><div class="ttname"><a href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a></div><div class="ttdeci">#define DIRECT_A3D_ELEM(v, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00249">multidim_array.h:249</a></div></div>
<div class="ttc" id="classMultidimArray_html_a4a4e45352f73539481de04cbda5f3f3d"><div class="ttname"><a href="classMultidimArray.html#a4a4e45352f73539481de04cbda5f3f3d">MultidimArray::write</a></div><div class="ttdeci">void write(const FileName &amp;fn) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05329">multidim_array.h:5329</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca36b09d6e71a60cfa3837d7e24c07ca"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a></div><div class="ttdeci">double * lambda</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04431">numerical_recipes.cpp:4431</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aa508e3dbd0e86258b5c69e8a8b6b8295"><div class="ttname"><a href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08509">numerical_recipes.cpp:8509</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga10453d42eeb9ec81876fc0e12bb4b978"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void varianceFilter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kernelSize</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>relative</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Applays a variance filter to an image</p>
<p>If relative=True, the filter is normalized to the mean (coeficient of variation) </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l00765">765</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;{</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keywordtype">int</span> kernelSize_2 = kernelSize/2;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> kernel;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    kernel.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(kernelSize,kernelSize);</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    kernel.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot; Creating the variance matrix &quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> mVar(<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I),<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I));</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    mVar.setXmippOrigin();</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="keywordtype">double</span> stdKernel, avgKernel, min_val, max_val;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>, <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>, <a class="code" href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>, <a class="code" href="blobs_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a>;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="comment">// I.computeStats(avgImg, stdImg, min_im, max_im);    </span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    </div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=kernelSize_2; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;=(int)<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I)-kernelSize_2; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+=kernelSize_2)</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=kernelSize_2; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;=(int)<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I)-kernelSize_2; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>+=kernelSize_2)</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            {</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                x0 = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>-kernelSize_2;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                y0 = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-kernelSize_2;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                xF = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>+kernelSize_2-1;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                yF = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+kernelSize_2-1;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                <span class="keywordflow">if</span> (x0 &lt; 0)</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                    x0 = 0;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                <span class="keywordflow">if</span> (xF &gt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I))</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                    xF = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                <span class="keywordflow">if</span> (y0 &lt; 0)</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                    y0 = 0;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                <span class="keywordflow">if</span> (yF &gt; <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I))</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                    yF = <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I);</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                I.<a class="code" href="classMultidimArray.html#a989ec8f5584750a4ac84a9020ad3744c">window</a>(kernel, y0, x0, yF, xF);</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                kernel.<a class="code" href="classMultidimArray.html#ab648c97e18d063ce966db9c61b68f066">computeStats</a>(avgKernel, stdKernel, min_val, max_val);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                </div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(mVar, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = stdKernel;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            }</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="comment">// filtering to fill the matrices (convolving with a Gaussian)</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <a class="code" href="classFourierFilter.html">FourierFilter</a> filter;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    filter.<a class="code" href="classFourierFilter.html#af5ced7144d0587c416bdac7d705aed45">FilterShape</a> = <a class="code" href="fourier__filter_8h.html#a61be564955992f0d12432f88997c56d2">REALGAUSSIAN</a>;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    filter.<a class="code" href="classFourierFilter.html#a7e847d4cdbf21e78ef474a42bd2da833">FilterBand</a> = <a class="code" href="fourier__filter_8h.html#ab88b316b336dadc6e77f04d6f035d86e">LOWPASS</a>;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    filter.<a class="code" href="classFourierFilter.html#a6b96657901248fdd1b4c7af47dc9c88d">w1</a> = kernelSize_2;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    filter.<a class="code" href="classFourierFilter.html#a628762260d6099753fa4b55adc4cfbb0">applyMaskSpace</a>(mVar);</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">if</span> (relative) <span class="comment">// normalize to the mean of the variance</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    {    </div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="keywordtype">double</span> avgVar, stdVar, minVar, maxVar;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        mVar.computeStats(avgVar, stdVar, minVar, maxVar);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        mVar = mVar/avgVar;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    }</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    I = mVar;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="comment">// filling the borders with the nearest variance value</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="comment">// the corners only are filled once (with Ycoord)</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I); ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;kernelSize; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        {</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;kernelSize)</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(I, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(mVar, kernelSize, kernelSize);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&gt;<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I)-kernelSize)</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(I, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(mVar, <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I)-kernelSize, kernelSize);</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(I, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(mVar, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, kernelSize);</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        }</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I); ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I)-kernelSize; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        {</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;kernelSize)</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(I, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(mVar, kernelSize, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I)-kernelSize);</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&gt;<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I)-kernelSize)</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(I, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(mVar, <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I)-kernelSize, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I)-kernelSize);</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(I, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(mVar, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I)-kernelSize);</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        }</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=kernelSize; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I)-kernelSize; ++<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;kernelSize; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(I, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(mVar, kernelSize, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=kernelSize; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I)-kernelSize; ++<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I)-kernelSize; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(I, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(mVar, <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I)-kernelSize, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    </div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;}</div><div class="ttc" id="classFourierFilter_html_a6b96657901248fdd1b4c7af47dc9c88d"><div class="ttname"><a href="classFourierFilter.html#a6b96657901248fdd1b4c7af47dc9c88d">FourierFilter::w1</a></div><div class="ttdeci">double w1</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00106">fourier_filter.h:106</a></div></div>
<div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9ed4376d9ad511e963caf118a6640b28"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a></div><div class="ttdeci">#define DIRECT_A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00351">multidim_array.h:351</a></div></div>
<div class="ttc" id="classFourierFilter_html_a7e847d4cdbf21e78ef474a42bd2da833"><div class="ttname"><a href="classFourierFilter.html#a7e847d4cdbf21e78ef474a42bd2da833">FourierFilter::FilterBand</a></div><div class="ttdeci">int FilterBand</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00102">fourier_filter.h:102</a></div></div>
<div class="ttc" id="classMultidimArray_html_ab648c97e18d063ce966db9c61b68f066"><div class="ttname"><a href="classMultidimArray.html#ab648c97e18d063ce966db9c61b68f066">MultidimArray::computeStats</a></div><div class="ttdeci">void computeStats(double &amp;avg, double &amp;stddev, T &amp;minval, T &amp;maxval) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03377">multidim_array.h:3377</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="classMultidimArray_html_a989ec8f5584750a4ac84a9020ad3744c"><div class="ttname"><a href="classMultidimArray.html#a989ec8f5584750a4ac84a9020ad3744c">MultidimArray::window</a></div><div class="ttdeci">void window(MultidimArray&lt; T1 &gt; &amp;result, int n0, int z0, int y0, int x0, int nF, int zF, int yF, int xF, T1 init_value=0) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01762">multidim_array.h:1762</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a0d9521fd31b2e16413d1b78836953d53"><div class="ttname"><a href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a></div><div class="ttdeci">#define y0</div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="blobs_8cpp_html_a8f613ddaea2048e3471a1f4f04ba4b79"><div class="ttname"><a href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a></div><div class="ttdeci">#define xF</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classFourierFilter_html"><div class="ttname"><a href="classFourierFilter.html">FourierFilter</a></div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00070">fourier_filter.h:70</a></div></div>
<div class="ttc" id="fourier__filter_8h_html_a61be564955992f0d12432f88997c56d2"><div class="ttname"><a href="fourier__filter_8h.html#a61be564955992f0d12432f88997c56d2">REALGAUSSIAN</a></div><div class="ttdeci">#define REALGAUSSIAN</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00088">fourier_filter.h:88</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a132f3924593d07b0a1f55b3f22e92ba6"><div class="ttname"><a href="blobs_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a></div><div class="ttdeci">#define yF</div></div>
<div class="ttc" id="fourier__filter_8h_html_ab88b316b336dadc6e77f04d6f035d86e"><div class="ttname"><a href="fourier__filter_8h.html#ab88b316b336dadc6e77f04d6f035d86e">LOWPASS</a></div><div class="ttdeci">#define LOWPASS</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00078">fourier_filter.h:78</a></div></div>
<div class="ttc" id="classFourierFilter_html_a628762260d6099753fa4b55adc4cfbb0"><div class="ttname"><a href="classFourierFilter.html#a628762260d6099753fa4b55adc4cfbb0">FourierFilter::applyMaskSpace</a></div><div class="ttdeci">void applyMaskSpace(MultidimArray&lt; double &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8cpp_source.html#l00651">fourier_filter.cpp:651</a></div></div>
<div class="ttc" id="classFourierFilter_html_af5ced7144d0587c416bdac7d705aed45"><div class="ttname"><a href="classFourierFilter.html#af5ced7144d0587c416bdac7d705aed45">FourierFilter::FilterShape</a></div><div class="ttdeci">int FilterShape</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00076">fourier_filter.h:76</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
