<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Xmipp: Geometrical transformations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Geometrical transformations</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga153124fa134b442214760945ffb542eb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga153124fa134b442214760945ffb542eb">NEAREST</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:ga153124fa134b442214760945ffb542eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac645eb9a88619ee6f5e14c557ab8ef62"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:gac645eb9a88619ee6f5e14c557ab8ef62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad932e3ae68d899eccc1d0de0881b4d03"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#gad932e3ae68d899eccc1d0de0881b4d03">BSPLINE2</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:gad932e3ae68d899eccc1d0de0881b4d03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab8a49d8335f45ebd2ba7d86d98322bc0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#gab8a49d8335f45ebd2ba7d86d98322bc0">BSPLINE3</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:gab8a49d8335f45ebd2ba7d86d98322bc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga75e47f41b0585cd122530ea47f096372"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga75e47f41b0585cd122530ea47f096372">BSPLINE4</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:ga75e47f41b0585cd122530ea47f096372"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gac6e28a37ef482c451a17cea4d8530746"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#gac6e28a37ef482c451a17cea4d8530746">geo2TransformationMatrix</a> (const <a class="el" href="classMDRow.html">MDRow</a> &amp;imageHeader, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A, bool only_apply_shifts=false)</td></tr>
<tr class="separator:gac6e28a37ef482c451a17cea4d8530746"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8b05c2e355f50c6441d653a8e2bcb4ef"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga8b05c2e355f50c6441d653a8e2bcb4ef">getLoopRange</a> (double value, double <a class="el" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">min</a>, double <a class="el" href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">max</a>, double <a class="el" href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a>, int loopLimit, int &amp;minIter, int &amp;maxIter)</td></tr>
<tr class="separator:ga8b05c2e355f50c6441d653a8e2bcb4ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2623912568cc54d33c74f63f445a1d26"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga2623912568cc54d33c74f63f445a1d26">string2TransformationMatrix</a> (const <a class="el" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a> &amp;matrixStr, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;matrix, size_t dim=4)</td></tr>
<tr class="separator:ga2623912568cc54d33c74f63f445a1d26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab70aa0d1b7ed21012af53afc71b13930"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:gab70aa0d1b7ed21012af53afc71b13930"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#gab70aa0d1b7ed21012af53afc71b13930">transformationMatrix2Parameters2D</a> (const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;A, bool &amp;flip, T &amp;scale, T &amp;shiftX, T &amp;shiftY, T &amp;psi)</td></tr>
<tr class="separator:gab70aa0d1b7ed21012af53afc71b13930"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8d2783cc5053c7ed71d61a5044e16abd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga8d2783cc5053c7ed71d61a5044e16abd">transformationMatrix2Parameters3D</a> (const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A, bool &amp;flip, double &amp;scale, double &amp;shiftX, double &amp;shiftY, double &amp;shiftZ, double &amp;rot, double &amp;tilt, double &amp;psi)</td></tr>
<tr class="separator:ga8d2783cc5053c7ed71d61a5044e16abd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga460d3da338c37f4a55b631b8e9e327c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga460d3da338c37f4a55b631b8e9e327c1">transformationMatrix2Geo</a> (const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A, <a class="el" href="classMDRow.html">MDRow</a> &amp;imageGeo)</td></tr>
<tr class="separator:ga460d3da338c37f4a55b631b8e9e327c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga93598c1cf08f43c7a58a096003b2d718"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga93598c1cf08f43c7a58a096003b2d718"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga93598c1cf08f43c7a58a096003b2d718">rotation2DMatrix</a> (T ang, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, bool homogeneous=true)</td></tr>
<tr class="separator:ga93598c1cf08f43c7a58a096003b2d718"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga85214d9ca1caaac30f8cb0b838339536"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga85214d9ca1caaac30f8cb0b838339536"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga85214d9ca1caaac30f8cb0b838339536">translation2DMatrix</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; T &gt; &amp;translation, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;resMatrix, bool inverse=false)</td></tr>
<tr class="separator:ga85214d9ca1caaac30f8cb0b838339536"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gade7a7cd894f08efccc7d6b6410bbf891"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a> (double ang, char <a class="el" href="image__operate_8cpp.html#aae5e6d8d8a0b1792b5fc6fde13bc4a8c">axis</a>, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, bool homogeneous=true)</td></tr>
<tr class="separator:gade7a7cd894f08efccc7d6b6410bbf891"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga23125465e6cfa723f07e35ed78d42be9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga23125465e6cfa723f07e35ed78d42be9">rotation3DMatrix</a> (double ang, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="image__operate_8cpp.html#aae5e6d8d8a0b1792b5fc6fde13bc4a8c">axis</a>, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, bool homogeneous=true)</td></tr>
<tr class="separator:ga23125465e6cfa723f07e35ed78d42be9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae1017da8a3705e6a6aeffd6c0a2af38f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#gae1017da8a3705e6a6aeffd6c0a2af38f">alignWithZ</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="image__operate_8cpp.html#aae5e6d8d8a0b1792b5fc6fde13bc4a8c">axis</a>, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, bool homogeneous=true)</td></tr>
<tr class="separator:gae1017da8a3705e6a6aeffd6c0a2af38f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga93d35b9f379a9cf966f6aff6c7c216c5"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga93d35b9f379a9cf966f6aff6c7c216c5"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga93d35b9f379a9cf966f6aff6c7c216c5">translation3DMatrix</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; T &gt; &amp;translation, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;resMatrix, bool inverse=false)</td></tr>
<tr class="separator:ga93d35b9f379a9cf966f6aff6c7c216c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3b1fdfbbfbd9315cdb3b9f432911eb70"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga3b1fdfbbfbd9315cdb3b9f432911eb70">scale3DMatrix</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;sc, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, bool homogeneous=true)</td></tr>
<tr class="separator:ga3b1fdfbbfbd9315cdb3b9f432911eb70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3889b5e4274c3765f42cb62cd35fe33f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga3889b5e4274c3765f42cb62cd35fe33f">rotation3DMatrixFromIcoOrientations</a> (const char *icoFrom, const char *icoTo, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;R)</td></tr>
<tr class="separator:ga3889b5e4274c3765f42cb62cd35fe33f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga667bc7e15d5132db020732ef87e9acb2"><td class="memTemplParams" colspan="2">template&lt;typename T1 , typename T , typename T2 &gt; </td></tr>
<tr class="memitem:ga667bc7e15d5132db020732ef87e9acb2"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga667bc7e15d5132db020732ef87e9acb2">applyGeometry</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;__restrict__ V2, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T1 &gt; &amp;__restrict__ V1, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T2 &gt; &amp;At, bool inv, bool wrap, T outside=0, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *BcoeffsPtr=NULL)</td></tr>
<tr class="separator:ga667bc7e15d5132db020732ef87e9acb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8728c9650f6eef6812c24ee82ffb70ea"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga8728c9650f6eef6812c24ee82ffb70ea"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga8728c9650f6eef6812c24ee82ffb70ea">applyGeometry</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V2, const <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;V1, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A, bool inv, bool wrap, T outside=0)</td></tr>
<tr class="separator:ga8728c9650f6eef6812c24ee82ffb70ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga15a4c13ffed0695f09ea5340d27ff5c1"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga15a4c13ffed0695f09ea5340d27ff5c1"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga15a4c13ffed0695f09ea5340d27ff5c1">selfApplyGeometry</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V1, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A, bool inv, bool wrap, T outside=0)</td></tr>
<tr class="separator:ga15a4c13ffed0695f09ea5340d27ff5c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3cc15e5dda7c58b9cacb7eee440d6bdc"><td class="memTemplParams" colspan="2">template&lt;&gt; </td></tr>
<tr class="memitem:ga3cc15e5dda7c58b9cacb7eee440d6bdc"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;V2, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;V1, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A, bool inv, bool wrap, std::complex&lt; double &gt; outside, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *BcoeffsPtr)</td></tr>
<tr class="separator:ga3cc15e5dda7c58b9cacb7eee440d6bdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga22035972f95a4f2bf79416b5ebf9d44e"><td class="memTemplParams" colspan="2">template&lt;&gt; </td></tr>
<tr class="memitem:ga22035972f95a4f2bf79416b5ebf9d44e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga22035972f95a4f2bf79416b5ebf9d44e">selfApplyGeometry</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;V1, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A, bool inv, bool wrap, std::complex&lt; double &gt; outside)</td></tr>
<tr class="separator:ga22035972f95a4f2bf79416b5ebf9d44e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf8c063f9b9edef4d2ced7b44fe9182ff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#gaf8c063f9b9edef4d2ced7b44fe9182ff">applyGeometry</a> (int SplineDegree, <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;V2, const <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;V1, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A, bool inv, bool wrap, double outside)</td></tr>
<tr class="separator:gaf8c063f9b9edef4d2ced7b44fe9182ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga098f5c8e7e9c010a3bf7ab82e31828a8"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga098f5c8e7e9c010a3bf7ab82e31828a8"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga098f5c8e7e9c010a3bf7ab82e31828a8">produceSplineCoefficients</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;coeffs, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V1)</td></tr>
<tr class="separator:ga098f5c8e7e9c010a3bf7ab82e31828a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga007f6aec56f2b0abdb6f4903a22cedf0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga007f6aec56f2b0abdb6f4903a22cedf0">produceSplineCoefficients</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;coeffs, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;V1)</td></tr>
<tr class="separator:ga007f6aec56f2b0abdb6f4903a22cedf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga030ed19c9f38989bbec4eb4c24ee89c1"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga030ed19c9f38989bbec4eb4c24ee89c1"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga030ed19c9f38989bbec4eb4c24ee89c1">produceImageFromSplineCoefficients</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;img, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;coeffs)</td></tr>
<tr class="separator:ga030ed19c9f38989bbec4eb4c24ee89c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4ae3c62d556580964f40a41304b5e0fe"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga4ae3c62d556580964f40a41304b5e0fe"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga4ae3c62d556580964f40a41304b5e0fe">rotate</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V2, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V1, double ang, char <a class="el" href="image__operate_8cpp.html#aae5e6d8d8a0b1792b5fc6fde13bc4a8c">axis</a>= 'Z', bool wrap=<a class="el" href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a>, T outside=0)</td></tr>
<tr class="separator:ga4ae3c62d556580964f40a41304b5e0fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacbdf0682a5d446110f6a0932d2101e02"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:gacbdf0682a5d446110f6a0932d2101e02"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#gacbdf0682a5d446110f6a0932d2101e02">selfRotate</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V1, double ang, char <a class="el" href="image__operate_8cpp.html#aae5e6d8d8a0b1792b5fc6fde13bc4a8c">axis</a>= 'Z', bool wrap=<a class="el" href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a>, T outside=0)</td></tr>
<tr class="separator:gacbdf0682a5d446110f6a0932d2101e02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga055e247ebfb6905fd478fa0dc73f382e"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga055e247ebfb6905fd478fa0dc73f382e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga055e247ebfb6905fd478fa0dc73f382e">translate</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V2, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V1, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;v, bool wrap=<a class="el" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a>, T outside=0)</td></tr>
<tr class="separator:ga055e247ebfb6905fd478fa0dc73f382e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae9f9e35557a7659baf5a1bdbe62e3afc"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:gae9f9e35557a7659baf5a1bdbe62e3afc"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#gae9f9e35557a7659baf5a1bdbe62e3afc">selfTranslate</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V1, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;v, bool wrap=<a class="el" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a>, T outside=0)</td></tr>
<tr class="separator:gae9f9e35557a7659baf5a1bdbe62e3afc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga735401e4b0f0a7ba162379cd9d79d6ce"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga735401e4b0f0a7ba162379cd9d79d6ce"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga735401e4b0f0a7ba162379cd9d79d6ce">translateCenterOfMassToCenter</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V2, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V1, bool wrap=<a class="el" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a>)</td></tr>
<tr class="separator:ga735401e4b0f0a7ba162379cd9d79d6ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga360426b8d752570a9001671712665d69"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga360426b8d752570a9001671712665d69"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga360426b8d752570a9001671712665d69">selfTranslateCenterOfMassToCenter</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V1, bool wrap=<a class="el" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a>)</td></tr>
<tr class="separator:ga360426b8d752570a9001671712665d69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacc8574b3660c08bf34e97dfafa390ee0"><td class="memTemplParams" colspan="2">template&lt;typename T1 , typename T &gt; </td></tr>
<tr class="memitem:gacc8574b3660c08bf34e97dfafa390ee0"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#gacc8574b3660c08bf34e97dfafa390ee0">scaleToSize</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V2, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T1 &gt; &amp;V1, size_t Xdim, size_t Ydim, size_t Zdim=1)</td></tr>
<tr class="separator:gacc8574b3660c08bf34e97dfafa390ee0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga61730930931511f402f6b8af417d3b88"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga61730930931511f402f6b8af417d3b88"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga61730930931511f402f6b8af417d3b88">scaleToSize</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V2, const <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;V1, int Xdim, int Ydim, int Zdim=1)</td></tr>
<tr class="separator:ga61730930931511f402f6b8af417d3b88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaee7fbda1e25b15feff604ab93203f91d"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:gaee7fbda1e25b15feff604ab93203f91d"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#gaee7fbda1e25b15feff604ab93203f91d">scaleToSize</a> (int SplineDegree, <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;V2, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V1, int Xdim, int Ydim, int Zdim=1)</td></tr>
<tr class="separator:gaee7fbda1e25b15feff604ab93203f91d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafc49d813bd3c47ca193e504888d78b2a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#gafc49d813bd3c47ca193e504888d78b2a">scaleToSize</a> (int SplineDegree, <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;V2, const <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;V1, int Xdim, int Ydim, int Zdim=1)</td></tr>
<tr class="separator:gafc49d813bd3c47ca193e504888d78b2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8cc329115cf649b839ab2dd9829a64b2"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga8cc329115cf649b839ab2dd9829a64b2"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga8cc329115cf649b839ab2dd9829a64b2">selfScaleToSize</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V1, int Xdim, int Ydim, int Zdim=1)</td></tr>
<tr class="separator:ga8cc329115cf649b839ab2dd9829a64b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga04c547130530ebaa6ce754df5b0ae089"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga04c547130530ebaa6ce754df5b0ae089">selfScaleToSize</a> (int SplineDegree, <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;V1, int Xdim, int Ydim, int Zdim=1)</td></tr>
<tr class="separator:ga04c547130530ebaa6ce754df5b0ae089"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7c05f0285d9099f2e94c37ae9d192253"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga7c05f0285d9099f2e94c37ae9d192253">scaleToSize</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;V2, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;V1, int Xdim, int Ydim, int Zdim=1)</td></tr>
<tr class="separator:ga7c05f0285d9099f2e94c37ae9d192253"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacf1576f9d76ad69fefb0fb2ee77a8bb1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#gacf1576f9d76ad69fefb0fb2ee77a8bb1">selfScaleToSize</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;V1, int Xdim, int Ydim, int Zdim=1)</td></tr>
<tr class="separator:gacf1576f9d76ad69fefb0fb2ee77a8bb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0231e8c22c93bfa84df99d95527b7cbc"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga0231e8c22c93bfa84df99d95527b7cbc"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga0231e8c22c93bfa84df99d95527b7cbc">reduceBSpline</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V2, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V1)</td></tr>
<tr class="separator:ga0231e8c22c93bfa84df99d95527b7cbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga87de8035e86a51972bdf358690e427a9"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga87de8035e86a51972bdf358690e427a9"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga87de8035e86a51972bdf358690e427a9">expandBSpline</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V2, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V1)</td></tr>
<tr class="separator:ga87de8035e86a51972bdf358690e427a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa6664b10a8446559d382f093905d3dbd"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:gaa6664b10a8446559d382f093905d3dbd"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#gaa6664b10a8446559d382f093905d3dbd">pyramidReduce</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V2, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V1, int levels=1)</td></tr>
<tr class="separator:gaa6664b10a8446559d382f093905d3dbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2d6b094c319191119a3b8516be6cffbf"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga2d6b094c319191119a3b8516be6cffbf"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga2d6b094c319191119a3b8516be6cffbf">selfPyramidReduce</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V1, int levels=1)</td></tr>
<tr class="separator:ga2d6b094c319191119a3b8516be6cffbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6a293c497c0d2892a529cefa8cab3d03"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga6a293c497c0d2892a529cefa8cab3d03">selfPyramidReduce</a> (int SplineDegree, <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;V1, int levels=1)</td></tr>
<tr class="separator:ga6a293c497c0d2892a529cefa8cab3d03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4244b45bd0344100b4e2e868a2b403af"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga4244b45bd0344100b4e2e868a2b403af"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga4244b45bd0344100b4e2e868a2b403af">pyramidExpand</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V2, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V1, int levels=1)</td></tr>
<tr class="separator:ga4244b45bd0344100b4e2e868a2b403af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0f9e6b3f1bd59388f7e5db78a37fa298"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga0f9e6b3f1bd59388f7e5db78a37fa298">pyramidExpand</a> (int SplineDegree, <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;V2, const <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;V1, int levels=1)</td></tr>
<tr class="separator:ga0f9e6b3f1bd59388f7e5db78a37fa298"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga232bc24b37c34befde0505a9dfefaca4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga232bc24b37c34befde0505a9dfefaca4">pyramidReduce</a> (int SplineDegree, <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;V2, const <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;V1, int levels=1)</td></tr>
<tr class="separator:ga232bc24b37c34befde0505a9dfefaca4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf7119c6e78f80419f2bca98c6599d514"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:gaf7119c6e78f80419f2bca98c6599d514"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#gaf7119c6e78f80419f2bca98c6599d514">selfPyramidExpand</a> (int SplineDegree, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;V1, int levels=1)</td></tr>
<tr class="separator:gaf7119c6e78f80419f2bca98c6599d514"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga48c82b941f9e97e6c629b6ecda579995"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga48c82b941f9e97e6c629b6ecda579995">selfPyramidExpand</a> (int SplineDegree, <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;V1, int levels=1)</td></tr>
<tr class="separator:ga48c82b941f9e97e6c629b6ecda579995"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga82c19639b510d33894fe268664130410"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga82c19639b510d33894fe268664130410"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga82c19639b510d33894fe268664130410">radialAverage</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; int &gt; &amp;center_of_rot, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;radial_mean, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;radial_count, const bool &amp;rounding=false)</td></tr>
<tr class="separator:ga82c19639b510d33894fe268664130410"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga83ea1646b86f859b5bb17f3783fed2a3"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga83ea1646b86f859b5bb17f3783fed2a3"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga83ea1646b86f859b5bb17f3783fed2a3">radialAveragePrecomputeDistance</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; int &gt; &amp;center_of_rot, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;<a class="el" href="external_2delaunay_2point_8h.html#adb0abda300c610b969c8be89ed30a4f6">distance</a>, int &amp;dim, const bool &amp;rounding=false)</td></tr>
<tr class="separator:ga83ea1646b86f859b5bb17f3783fed2a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga458542f12eb6e607d932ded467a283b8"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga458542f12eb6e607d932ded467a283b8"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga458542f12eb6e607d932ded467a283b8">fastRadialAverage</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;<a class="el" href="external_2delaunay_2point_8h.html#adb0abda300c610b969c8be89ed30a4f6">distance</a>, int dim, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;radial_mean, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;radial_count)</td></tr>
<tr class="separator:ga458542f12eb6e607d932ded467a283b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga76da3279dcd1977351b97b95db52b543"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga76da3279dcd1977351b97b95db52b543">radiallySymmetrize</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;radialImg)</td></tr>
<tr class="separator:ga76da3279dcd1977351b97b95db52b543"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga14f44acb983d41b79d09756b8bee4f4a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga14f44acb983d41b79d09756b8bee4f4a">interpolatedElementBSplineDiffX</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;vol, double <a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, double <a class="el" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, double <a class="el" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>, int SplineDegree=3)</td></tr>
<tr class="separator:ga14f44acb983d41b79d09756b8bee4f4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga466e6163a69aba9fd7c3f10177b3d6ad"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga466e6163a69aba9fd7c3f10177b3d6ad">interpolatedElementBSplineDiffY</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;vol, double <a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, double <a class="el" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, double <a class="el" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>, int SplineDegree=3)</td></tr>
<tr class="separator:ga466e6163a69aba9fd7c3f10177b3d6ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3fea9b979171920f6d72ceb1317220f0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeometricalTransformations.html#ga3fea9b979171920f6d72ceb1317220f0">interpolatedElementBSplineDiffZ</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;vol, double <a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, double <a class="el" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, double <a class="el" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>, int SplineDegree=3)</td></tr>
<tr class="separator:ga3fea9b979171920f6d72ceb1317220f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="gad932e3ae68d899eccc1d0de0881b4d03"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSPLINE2&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="transformations_8h_source.html#l00209">209</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>

</div>
</div>
<a class="anchor" id="gab8a49d8335f45ebd2ba7d86d98322bc0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSPLINE3&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="transformations_8h_source.html#l00210">210</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga75e47f41b0585cd122530ea47f096372"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSPLINE4&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="transformations_8h_source.html#l00211">211</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>

</div>
</div>
<a class="anchor" id="gac645eb9a88619ee6f5e14c557ab8ef62"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LINEAR&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="transformations_8h_source.html#l00208">208</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga153124fa134b442214760945ffb542eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NEAREST&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="transformations_8h_source.html#l00207">207</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gae1017da8a3705e6a6aeffd6c0a2af38f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void alignWithZ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>axis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>homogeneous</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classMatrix.html">Matrix</a> which transforms the given axis into Z</p>
<p>A geometrical transformation matrix (4x4) is returned such that the given axis is rotated until it is aligned with the Z axis. This is very useful in order to produce rotational matrices, for instance, around any axis.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Matrix2D&lt; double &gt; A = alignWithZ(axis);</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;return A.transpose() * rotation3DMatrix(ang, &#39;Z&#39;) * A;</div></div><!-- fragment --><p>The returned matrix is such that A*axis=Z, where Z and axis are column vectors. </p>

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00322">322</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;{</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">if</span> (axis.<a class="code" href="classMatrix1D.html#ace0d77b8d838032f071e18e450fc04e4">size</a>() != 3)</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a>, <span class="stringliteral">&quot;alignWithZ: Axis is not in R3&quot;</span>);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">if</span> (homogeneous)</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    {</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        result.initZeros(4,4);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,3, 3) = 1;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    }</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        result.initZeros(3,3);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a>  Axis(axis);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    Axis.selfNormalize();</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">// Compute length of the projection on YZ plane</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordtype">double</span> proj_mod = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(Axis) * <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(Axis) + <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(Axis) * <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(Axis));</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">if</span> (proj_mod &gt; <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>)</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    {   <span class="comment">// proj_mod!=0</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="comment">// Build Matrix result, which makes the turning axis coincident with Z</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,0, 0) = proj_mod;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,0, 1) = -<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(Axis) * <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(Axis) / proj_mod;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,0, 2) = -<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(Axis) * <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(Axis) / proj_mod;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,1, 0) = 0;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,1, 1) = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(Axis) / proj_mod;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,1, 2) = -<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(Axis) / proj_mod;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,2, 0) = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(Axis);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,2, 1) = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(Axis);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,2, 2) = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(Axis);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    }</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    {</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="comment">// I know that the Axis is the X axis, EITHER POSITIVE OR NEGATIVE!!</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,0, 0) = 0;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,0, 1) = 0;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,0, 2) = (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(Axis) &gt; 0)? -1 : 1;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,1, 0) = 0;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,1, 1) = 1;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,1, 2) = 0;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,2, 0) = (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(Axis) &gt; 0)? 1 : -1;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,2, 1) = 0;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,2, 2) = 0;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    }</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;}</div><div class="ttc" id="classMatrix1D_html_ace0d77b8d838032f071e18e450fc04e4"><div class="ttname"><a href="classMatrix1D.html#ace0d77b8d838032f071e18e450fc04e4">Matrix1D::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00549">matrix1d.h:549</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a></div><div class="ttdoc">Problem with matrix size. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00157">xmipp_error.h:157</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Matrices_html_gaf0f6abe0342cabe025337d656f034e87"><div class="ttname"><a href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a></div><div class="ttdeci">#define dMij(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00140">matrix2d.h:140</a></div></div>
<div class="ttc" id="group__Macros_html_gad584f97e936242b173add43261376ba5"><div class="ttname"><a href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a></div><div class="ttdeci">#define XMIPP_EQUAL_ACCURACY</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00119">xmipp_macros.h:119</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga667bc7e15d5132db020732ef87e9acb2"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T1 , typename T , typename T2 &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void applyGeometry </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;__restrict__&#160;</td>
          <td class="paramname"><em>V2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T1 &gt; &amp;__restrict__&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T2 &gt; &amp;&#160;</td>
          <td class="paramname"><em>At</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wrap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>outside</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>BcoeffsPtr</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Applies a geometrical transformation.</p>
<p>Any geometrical transformation defined by the matrix A (double (4x4)!! ie, in homogeneous R3 coordinates) is applied to the volume V1. The result is stored in V2 (it cannot be the same as the input volume). An exception is thrown if the transformation matrix is not 4x4.</p>
<p>Structure of the transformation matrix: It should have the following components</p>
<p>r11 r12 r13 x r21 r22 r23 y r31 r32 r33 z 0 0 0 1</p>
<p>where (x,y,z) is the translation desired, and Rij are the components of the rotation matrix R. If you want to apply a scaling factor to the transformation, then multiply r11, r22 and r33 by it.</p>
<p>The result volume (with ndim=1) is resized to the same dimensions as V1 if V2 is empty (0x0) at the beginning, if it is not, ie, if V2 has got some size then only those values in the volume are filled, this is very useful for resizing the volume, then you manually resize the output volume to the desired size and then call this routine.</p>
<p>The relationship between the output coordinates and the input ones are</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;out = A * in</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;(x, y, z) = A * (x&#39;, y&#39;, z&#39;)</div></div><!-- fragment --><p>This function works independently from the logical indexing of each matrix, it sets the logical center and the physical center of the image and work with these 2 coordinate spaces. At the end the original logical indexing of each matrix is kept.</p>
<p>The procedure followed goes from coordinates in the output volume to the ones in the input one, so the inverse of the A matrix is needed. There is a flag telling if the given matrix is already the inverse one or the normal one. If it is the normal one internally the matrix is inversed. If you are to do many "rotations" then some time is spent in inverting the matrix. Normally the matrix is the normal one.</p>
<p>There is something else to tell about the geometrical tranformation. The value of the voxel in the output volume is computed via bilinear interpolation in the input volume. If any of the voxels participating in the interpolation falls outside the input volume, then automatically the corresponding output voxel is set to 0, unless that the wrap flag has been set to 1. In this case if the voxel falls out by the right hand then it is "wrapped" and the corresponding voxel in the left hand is used. The same is appliable to top-bottom. Usually wrap mode is off. Wrap mode is interesting for translations but not for rotations, for example.</p>
<p>The inverse mode and wrapping mode should be taken by default by the routine, g++ seems to have problems with template functions outside a class with default parameters. So, I'm sorry, you will have to put them always. The usual combination is</p>
<p>applyGeometry(..., IS_NOT_INV, DONT_WRAP).</p>
<p>Although you can also use the constants IS_INV, or WRAP.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Matrix2D&lt; double &gt; A(4,4);</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;A.initIdentity;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;applyGeometry(V2, A, V1);</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="transformations_8h_source.html#l00287">287</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;{</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="preprocessor">#ifndef RELEASE_MODE</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">if</span> (&amp;V1 == (<a class="code" href="classMultidimArray.html">MultidimArray&lt;T1&gt;</a>*)&amp;V2)</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a>,<span class="stringliteral">&quot;ApplyGeometry: Input array cannot be the same as output array&quot;</span>);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">if</span> ( V1.<a class="code" href="classMultidimArrayBase.html#afbb6b0117ab2bbad5949e688d32a7c0d">getDim</a>()==2 &amp;&amp; ((<a class="code" href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a>(At) != 3) || (<a class="code" href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a>(At) != 3)) )</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a>,<span class="stringliteral">&quot;ApplyGeometry: 2D transformation matrix is not 3x3&quot;</span>);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">if</span> ( V1.<a class="code" href="classMultidimArrayBase.html#afbb6b0117ab2bbad5949e688d32a7c0d">getDim</a>()==3 &amp;&amp; ((<a class="code" href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a>(At) != 4) || (<a class="code" href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a>(At) != 4)) )</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a>,<span class="stringliteral">&quot;ApplyGeometry: 3D transformation matrix is not 4x4&quot;</span>);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">if</span> (At.<a class="code" href="classMatrix2D.html#aa4b62ee9cbc7a16d480d2a9b90df2758">isIdentity</a>() &amp;&amp; ( <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V2) == 0 || <a class="code" href="group__MultidimensionalArrays.html#gae8a719ac2323461b466a10050383e947">SAME_SHAPE3D</a>(V1,V2) ) )</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <a class="code" href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a>(V1,V2);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V1) == 0)</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        V2.<a class="code" href="classMultidimArray.html#ad198844075bf06ecf3bb66fd5c6b5695">clear</a>();</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Bcoeffs;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> *BcoeffsToUse=NULL;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> A, Ainv;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a>(At, A);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keyword">const</span> <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> * Aptr=&amp;A;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">if</span> (!inv)</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    {</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        Ainv = A.<a class="code" href="classMatrix2D.html#add8d2052c53fcf6689908614f67b9ee6">inv</a>();</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        Aptr=&amp;Ainv;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keyword">const</span> <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> &amp;Aref=*Aptr;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">// For scalings the output matrix is resized outside to the final</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">// size instead of being resized inside the routine with the</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">// same size as the input matrix</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V2) == 0)</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        V2.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(V1);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">if</span> (outside != 0.)</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="comment">// Initialize output matrix with value=outside</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(V2)</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(V2, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>) = outside;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        V2.initZeros();</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (V1.getDim() == 2)</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="comment">// 2D transformation</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordtype">double</span> Aref00=<a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref,0,0);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordtype">double</span> Aref10=<a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref,1,0);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="comment">// Find center and limits of image</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordtype">double</span> cen_y  = (int)(<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(V2) / 2);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordtype">double</span> cen_x  = (int)(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V2) / 2);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keywordtype">double</span> cen_yp = (int)(<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(V1) / 2);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="keywordtype">double</span> cen_xp = (int)(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V1) / 2);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordtype">double</span> minxp  = -cen_xp;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keywordtype">double</span> minyp  = -cen_yp;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keywordtype">double</span> minxpp = minxp-<a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordtype">double</span> minypp = minyp-<a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordtype">double</span> maxxp  = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V1) - cen_xp - 1;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keywordtype">double</span> maxyp  = <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(V1) - cen_yp - 1;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordtype">double</span> maxxpp = maxxp+<a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordtype">double</span> maxypp = maxyp+<a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordtype">size_t</span> Xdim   = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V1);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordtype">size_t</span> Ydim   = <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(V1);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">if</span> (SplineDegree &gt; 1)</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <span class="comment">// Build the B-spline coefficients</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="keywordflow">if</span> (BcoeffsPtr!=NULL)</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                BcoeffsToUse=BcoeffsPtr;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                <a class="code" href="group__GeometricalTransformations.html#ga098f5c8e7e9c010a3bf7ab82e31828a8">produceSplineCoefficients</a>(SplineDegree, Bcoeffs, V1); <span class="comment">//Bcoeffs is a single image</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                BcoeffsToUse = &amp;Bcoeffs;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(*BcoeffsToUse) = (int) minxp;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(*BcoeffsToUse) = (int) minyp;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        }</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="comment">// Now we go from the output image to the input image, ie, for any pixel</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="comment">// in the output image we calculate which are the corresponding ones in</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="comment">// the original image, make an interpolation with them and put this value</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="comment">// at the output pixel</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="preprocessor">#ifdef DEBUG_APPLYGEO</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;A\n&quot;</span> &lt;&lt; Aref &lt;&lt; std::endl</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;(cen_x ,cen_y )=(&quot;</span> &lt;&lt; cen_x  &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; cen_y  &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;(cen_xp,cen_yp)=(&quot;</span> &lt;&lt; cen_xp &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; cen_yp &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;(min_xp,min_yp)=(&quot;</span> &lt;&lt; minxp  &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; minyp  &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;(max_xp,max_yp)=(&quot;</span> &lt;&lt; maxxp  &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; maxyp  &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="comment">// Calculate position of the beginning of the row in the output image</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> = -cen_x;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> = -cen_y;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(V2); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        {</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <span class="comment">// Calculate this position in the input image according to the</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="comment">// geometrical transformation</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="comment">// they are related by</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <span class="comment">// coords_output(=x,y) = A * coords_input (=xp,yp)</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            <span class="keywordtype">double</span> xp = x * <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref, 0, 0) + y * <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref, 0, 1) + <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref, 0, 2);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            <span class="keywordtype">double</span> yp = x * <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref, 1, 0) + y * <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref, 1, 1) + <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref, 1, 2);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <span class="comment">// Inner loop boundaries.</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="keywordtype">int</span> globalMin=0, globalMax=<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V2);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <span class="keywordflow">if</span> (!wrap)</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                <span class="comment">// First and last iteration with valid values for x and y coordinates.</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                <span class="keywordtype">int</span> minX, maxX, minY, maxY;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                <span class="comment">// Compute valid iterations in x and y coordinates. If one of them is always out</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                <span class="comment">// of boundaries then the inner loop is not executed this iteration.</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="group__GeometricalTransformations.html#ga8b05c2e355f50c6441d653a8e2bcb4ef">getLoopRange</a>( xp, minxpp, maxxpp, Aref00, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V2), minX, maxX) ||</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                    !<a class="code" href="group__GeometricalTransformations.html#ga8b05c2e355f50c6441d653a8e2bcb4ef">getLoopRange</a>( yp, minypp, maxypp, Aref10, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V2), minY, maxY))</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                    y++;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                {</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                    <span class="comment">// Compute initial iteration.</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                    globalMin = minX;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                    <span class="keywordflow">if</span> (minX &lt; minY)</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                    {</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                        globalMin = minY;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                    }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                    <span class="comment">// Compute last iteration.</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                    globalMax = maxX;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                    <span class="keywordflow">if</span> (maxX &gt; maxY)</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                    {</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                        globalMax = maxY;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                    }</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                    globalMax++;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                    <span class="comment">// Check max iteration is not higher than image.</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                    <span class="keywordflow">if</span> ((globalMax &gt;= 0) &amp;&amp; ((<span class="keywordtype">size_t</span>)globalMax &gt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V2)))</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                    {</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                        globalMax = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V2);</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                    }</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                    xp += globalMin*Aref00;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                    yp += globalMin*Aref10;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                }</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            }</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            <span class="comment">// Loop over j is splitted according to wrap (wrap==true is not</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            <span class="comment">// vectorizable) and also according to SplineDegree value</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            <span class="comment">// (I have not fully analyzed vector dependences for </span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <span class="comment">// SplineDegree==3 and else branch)</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            <span class="keywordflow">if</span> (wrap) </div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                <span class="comment">// This is original implementation</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=globalMin; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;globalMax ;<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                {</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="preprocessor">#ifdef DEBUG_APPLYGEO</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;Computing (&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;   (y, x) =(&quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;   before wrapping (y&#39;,x&#39;)=(&quot;</span> &lt;&lt; yp &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; xp &lt;&lt; <span class="stringliteral">&quot;) &quot;</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                    &lt;&lt; std::endl;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                    <span class="keywordtype">bool</span> x_isOut = <a class="code" href="group__Macros.html#gad1e8225913883a6887c786d6d44c8f48">XMIPP_RANGE_OUTSIDE_FAST</a>(xp, minxpp, maxxpp);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                    <span class="keywordtype">bool</span> y_isOut = <a class="code" href="group__Macros.html#gad1e8225913883a6887c786d6d44c8f48">XMIPP_RANGE_OUTSIDE_FAST</a>(yp, minypp, maxypp);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                    <span class="keywordflow">if</span> (x_isOut)</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                    {</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                        xp = <a class="code" href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a>(xp, minxp - 0.5, maxxp + 0.5);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                    }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                    <span class="keywordflow">if</span> (y_isOut)</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                    {</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                        yp = <a class="code" href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a>(yp, minyp - 0.5, maxyp + 0.5);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                    }</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="preprocessor">#ifdef DEBUG_APPLYGEO</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;   after wrapping (y&#39;,x&#39;)=(&quot;</span> &lt;&lt; yp &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; xp &lt;&lt; <span class="stringliteral">&quot;) &quot;</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                    &lt;&lt; std::endl;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;   Interp = &quot;</span> &lt;&lt; interp &lt;&lt; std::endl;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                    <span class="comment">// The following line sounds dangerous...</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                    <span class="comment">//x++;</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                    <span class="keywordflow">if</span> (SplineDegree==1)</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                    {</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                        <span class="comment">// Linear interpolation</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                        <span class="comment">// Calculate the integer position in input image, be </span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                        <span class="comment">// careful that it is not the nearest but the one </span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                        <span class="comment">// at the top left corner of the interpolation square. </span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                        <span class="comment">// Ie, (0.7,0.7) would give (0,0)</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                        <span class="comment">// Calculate also weights for point m1+1,n1+1</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                        <span class="keywordtype">double</span> wx = xp + cen_xp;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                        <span class="keywordtype">int</span> m1 = (int) wx;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                        wx = wx - m1;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                        <span class="keywordtype">int</span> m2 = m1 + 1;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                        <span class="keywordtype">double</span> wy = yp + cen_yp;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                        <span class="keywordtype">int</span> n1 = (int) wy;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                        wy = wy - n1;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                        <span class="keywordtype">int</span> n2 = n1 + 1;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                        <span class="comment">// m2 and n2 can be out by 1 so wrap must be check here</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                        <span class="keywordflow">if</span> ((m2 &gt;= 0) &amp;&amp; ((size_t)m2 &gt;= Xdim))</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                            m2 = 0;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                        <span class="keywordflow">if</span> ((n2 &gt;=0) &amp;&amp; ((size_t)n2 &gt;= Ydim))</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                            n2 = 0;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="preprocessor">#ifdef DEBUG_APPLYGEO</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;   From (&quot;</span> &lt;&lt; n1 &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; m1 &lt;&lt; <span class="stringliteral">&quot;) and (&quot;</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                                &lt;&lt; n2 &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; m2 &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;   wx= &quot;</span> &lt;&lt; wx &lt;&lt; <span class="stringliteral">&quot; wy= &quot;</span> &lt;&lt; wy </div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                                &lt;&lt; std::endl;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                        <span class="comment">// Perform interpolation</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                        <span class="comment">// if wx == 0 means that the rightest point is useless </span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                        <span class="comment">// for this interpolation, and even it might not be </span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                        <span class="comment">// defined if m1=xdim-1</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                        <span class="comment">// The same can be said for wy.</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                        <span class="keywordtype">double</span> wx_1 = (1-wx);</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                        <span class="keywordtype">double</span> wy_1 = (1-wy);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                        <span class="keywordtype">double</span> aux2=wy_1* wx_1 ;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                        <span class="keywordtype">double</span> tmp  = aux2 * <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(V1, n1, m1);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                        <span class="keywordflow">if</span> ((wx != 0) &amp;&amp; ((m2 &lt; 0) || ((<span class="keywordtype">size_t</span>)m2 &lt; V1.<a class="code" href="classMultidimArrayBase.html#a6d50e69638ce9965ce56fbefa0840f2a">xdim</a>)))</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                            tmp += (wy_1-aux2) * <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(V1, n1, m2);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                        <span class="keywordflow">if</span> ((wy != 0) &amp;&amp; ((n2 &lt; 0) || ((<span class="keywordtype">size_t</span>)n2 &lt; V1.<a class="code" href="classMultidimArrayBase.html#a239bae0a69ae7de31ed5627bdb65bda4">ydim</a>)))</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                        {</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                            aux2=wy * wx_1;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                            tmp += aux2 * <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(V1, n2, m1);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                            <span class="keywordflow">if</span> ((wx != 0) &amp;&amp; ((m2 &lt; 0) || ((<span class="keywordtype">size_t</span>)m2 &lt; V1.<a class="code" href="classMultidimArrayBase.html#a6d50e69638ce9965ce56fbefa0840f2a">xdim</a>)))</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                                tmp += (wy-aux2) * <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(V1, n2, m2);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                        }</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                        <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(V2, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j) = (T) tmp;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                    }</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SplineDegree==0)</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                    {</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                        <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(V2, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j) = (T) <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(V1,(<span class="keywordtype">int</span>)<a class="code" href="namespacealglib.html#a9ce7bf988dffc5f65c6db31e8c426a78">trunc</a>(yp),(int)<a class="code" href="namespacealglib.html#a9ce7bf988dffc5f65c6db31e8c426a78">trunc</a>(xp));</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                    }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SplineDegree==3)</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                    {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                        <span class="comment">// B-spline interpolation</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                        <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(V2, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j) = (T) BcoeffsToUse-&gt;<a class="code" href="classMultidimArray.html#aa86b71453e23d0a973b6f89ca7d9df0f">interpolatedElementBSpline2D_Degree3</a>(xp, yp);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                    }</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                    {</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                        <span class="comment">// B-spline interpolation</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                        <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(V2, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j) = (T) BcoeffsToUse-&gt;<a class="code" href="classMultidimArray.html#abc6240fbe88ed0aaacede9fd9ad78051">interpolatedElementBSpline2D</a>(xp, yp, SplineDegree);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                    }</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="preprocessor">#ifdef DEBUG_APPYGEO</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;   val= &quot;</span> &lt;&lt; <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(V2, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j) &lt;&lt; std::endl;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                    <span class="comment">// Compute new point inside input image</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                    xp += Aref00;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                    yp += Aref10;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            } <span class="comment">/* wrap == true */</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            {</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                <span class="keywordflow">if</span> (SplineDegree==1)</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                {</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="preprocessor">                    #pragma simd reduction (+:xp,yp)</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=globalMin; j&lt;globalMax ;j++)</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                    {</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="preprocessor">#ifdef DEBUG_APPLYGEO</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;Computing (&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;   (y, x) =(&quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;   before wrapping (y&#39;,x&#39;)=(&quot;</span> &lt;&lt; yp &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; xp &lt;&lt; <span class="stringliteral">&quot;) &quot;</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                        &lt;&lt; std::endl;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;   after wrapping (y&#39;,x&#39;)=(&quot;</span> &lt;&lt; yp &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; xp &lt;&lt; <span class="stringliteral">&quot;) &quot;</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                        &lt;&lt; std::endl;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;   Interp = &quot;</span> &lt;&lt; interp &lt;&lt; std::endl;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                        <span class="comment">// The following line sounds dangerous...</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                        <span class="comment">//x++;</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                        <span class="comment">// Linear interpolation</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                        <span class="comment">// Calculate the integer position in input image, be careful</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                        <span class="comment">// that it is not the nearest but the one at the top left corner</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                        <span class="comment">// of the interpolation square. Ie, (0.7,0.7) would give (0,0)</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                        <span class="comment">// Calculate also weights for point m1+1,n1+1</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                        <span class="keywordtype">double</span> wx = xp + cen_xp;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                        <span class="keywordtype">int</span> m1 = (int) wx;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                        wx = wx - m1;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                        <span class="keywordtype">int</span> m2 = m1 + 1;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                        <span class="keywordtype">double</span> wy = yp + cen_yp;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                        <span class="keywordtype">int</span> n1 = (int) wy;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                        wy = wy - n1;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                        <span class="keywordtype">int</span> n2 = n1 + 1;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="preprocessor">#ifdef DEBUG_APPLYGEO</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;   From (&quot;</span> &lt;&lt; n1 &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; m1 &lt;&lt; <span class="stringliteral">&quot;) and (&quot;</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                            &lt;&lt; n2 &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; m2 &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;   wx= &quot;</span> &lt;&lt; wx &lt;&lt; <span class="stringliteral">&quot; wy= &quot;</span> &lt;&lt; wy &lt;&lt; std::endl;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                        <span class="comment">// Perform interpolation</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                        <span class="comment">// if wx == 0 means that the rightest point is useless for this</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                        <span class="comment">// interpolation, and even it might not be defined if m1=xdim-1</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                        <span class="comment">// The same can be said for wy.</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                        <span class="keywordtype">double</span> wx_1 = (1-wx);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                        <span class="keywordtype">double</span> wy_1 = (1-wy);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                        <span class="keywordtype">double</span> aux2=wy_1* wx_1 ;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                        <span class="keywordtype">double</span> tmp  = aux2 * <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(V1, n1, m1);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                        <span class="keywordflow">if</span> ((wx != 0) &amp;&amp; ((m2 &lt; 0) || ((<span class="keywordtype">size_t</span>)m2 &lt; V1.<a class="code" href="classMultidimArrayBase.html#a6d50e69638ce9965ce56fbefa0840f2a">xdim</a>)))</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                            tmp += (wy_1-aux2) * <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(V1, n1, m2);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                        <span class="keywordflow">if</span> ((wy != 0) &amp;&amp; ((n2 &lt; 0) || ((<span class="keywordtype">size_t</span>)n2 &lt; V1.<a class="code" href="classMultidimArrayBase.html#a239bae0a69ae7de31ed5627bdb65bda4">ydim</a>)))</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                        {</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                            aux2=wy * wx_1;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                            tmp += aux2 * <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(V1, n2, m1);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    </div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                            <span class="keywordflow">if</span> ((wx != 0) &amp;&amp; ((m2 &lt; 0) || ((<span class="keywordtype">size_t</span>)m2 &lt; V1.<a class="code" href="classMultidimArrayBase.html#a6d50e69638ce9965ce56fbefa0840f2a">xdim</a>)))</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                                tmp += (wy-aux2) * <a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(V1, n2, m2);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                        }</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                        <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(V2, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j) = (T) tmp;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="preprocessor">#ifdef DEBUG_APPYGEO</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;   val= &quot;</span> &lt;&lt; <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(V2, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j) &lt;&lt; std::endl;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                        <span class="comment">// Compute new point inside input image</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                        xp += Aref00;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                        yp += Aref10;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                    }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                }</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SplineDegree==0)</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                {</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="preprocessor">                    #pragma simd reduction (+:xp,yp)</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=globalMin; j&lt;globalMax ;j++) </div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                    {</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="preprocessor">#ifdef DEBUG_APPLYGEO</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;Computing (&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;   (y, x) =(&quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;   before wrapping (y&#39;,x&#39;)=(&quot;</span> &lt;&lt; yp &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; xp &lt;&lt; <span class="stringliteral">&quot;) &quot;</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                        &lt;&lt; std::endl;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;   after wrapping (y&#39;,x&#39;)=(&quot;</span> &lt;&lt; yp &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; xp &lt;&lt; <span class="stringliteral">&quot;) &quot;</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                        &lt;&lt; std::endl;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;   Interp = &quot;</span> &lt;&lt; interp &lt;&lt; std::endl;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                        <span class="comment">// The following line sounds dangerous...</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                        <span class="comment">//x++;</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                        <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(V2, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j) = (T) <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(V1,(<span class="keywordtype">int</span>)<a class="code" href="namespacealglib.html#a9ce7bf988dffc5f65c6db31e8c426a78">trunc</a>(yp),(int)<a class="code" href="namespacealglib.html#a9ce7bf988dffc5f65c6db31e8c426a78">trunc</a>(xp));</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="preprocessor">#ifdef DEBUG_APPYGEO</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;   val= &quot;</span> &lt;&lt; <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(V2, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j) &lt;&lt; std::endl;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                        <span class="comment">// Compute new point inside input image</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                        xp += Aref00;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                        yp += Aref10;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                    }</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                }</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SplineDegree==3)</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                {</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=globalMin; j&lt;globalMax ;j++)</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                    {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="preprocessor">#ifdef DEBUG_APPLYGEO</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;Computing (&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;   (y, x) =(&quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;   before wrapping (y&#39;,x&#39;)=(&quot;</span> &lt;&lt; yp &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; xp &lt;&lt; <span class="stringliteral">&quot;) &quot;</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                        &lt;&lt; std::endl;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;   after wrapping (y&#39;,x&#39;)=(&quot;</span> &lt;&lt; yp &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; xp &lt;&lt; <span class="stringliteral">&quot;) &quot;</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                        &lt;&lt; std::endl;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;   Interp = &quot;</span> &lt;&lt; interp &lt;&lt; std::endl;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                        <span class="comment">// The following line sounds dangerous...</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                        <span class="comment">//x++;</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                        <span class="comment">// B-spline interpolation</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                        <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(V2, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j) = (T) BcoeffsToUse-&gt;<a class="code" href="classMultidimArray.html#aa86b71453e23d0a973b6f89ca7d9df0f">interpolatedElementBSpline2D_Degree3</a>(xp, yp);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="preprocessor">#ifdef DEBUG_APPYGEO</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;   val= &quot;</span> &lt;&lt; <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(V2, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j) &lt;&lt; std::endl;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                        <span class="comment">// Compute new point inside input image</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                        xp += Aref00;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                        yp += Aref10;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                    }</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                }</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                {</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=globalMin; j&lt;globalMax ;j++)</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                    {</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="preprocessor">#ifdef DEBUG_APPLYGEO</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;Computing (&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;   (y, x) =(&quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;   before wrapping (y&#39;,x&#39;)=(&quot;</span> &lt;&lt; yp &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; xp &lt;&lt; <span class="stringliteral">&quot;) &quot;</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                        &lt;&lt; std::endl;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;   after wrapping (y&#39;,x&#39;)=(&quot;</span> &lt;&lt; yp &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; xp &lt;&lt; <span class="stringliteral">&quot;) &quot;</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                        &lt;&lt; std::endl;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;   Interp = &quot;</span> &lt;&lt; interp &lt;&lt; std::endl;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                        <span class="comment">// The following line sounds dangerous...</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                        <span class="comment">//x++;</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                        <span class="comment">// B-spline interpolation</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                        <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(V2, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j) = (T) BcoeffsToUse-&gt;<a class="code" href="classMultidimArray.html#abc6240fbe88ed0aaacede9fd9ad78051">interpolatedElementBSpline2D</a>(xp, yp, SplineDegree);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="preprocessor">#ifdef DEBUG_APPYGEO</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;   val= &quot;</span> &lt;&lt; <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(V2, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j) &lt;&lt; std::endl;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                        <span class="comment">// Compute new point inside input image</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                        xp += Aref00;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                        yp += Aref10;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                    }</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                }</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            } <span class="comment">/* wrap == false */</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            y++;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        }</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    }</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    {</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="comment">// 3D transformation</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <span class="keywordtype">size_t</span> m1, n1, o1, m2, n2, o2;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>, xp, yp, zp;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="keywordtype">double</span> minxp, minyp, maxxp, maxyp, minzp, maxzp;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <span class="keywordtype">double</span> cen_x, cen_y, cen_z, cen_xp, cen_yp, cen_zp;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <span class="keywordtype">double</span> wx, wy, wz;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <span class="keywordtype">double</span> Aref00=<a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref,0,0);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="keywordtype">double</span> Aref10=<a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref,1,0);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <span class="keywordtype">double</span> Aref20=<a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref,2,0);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="comment">// Find center of MultidimArray</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        cen_z = (int)(V2.zdim / 2);</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        cen_y = (int)(V2.ydim / 2);</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        cen_x = (int)(V2.xdim / 2);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        cen_zp = (int)(V1.<a class="code" href="classMultidimArrayBase.html#ac51e2cd5a0f23b34bc903626fbe56ffd">zdim</a> / 2);</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        cen_yp = (int)(V1.<a class="code" href="classMultidimArrayBase.html#a239bae0a69ae7de31ed5627bdb65bda4">ydim</a> / 2);</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        cen_xp = (int)(V1.<a class="code" href="classMultidimArrayBase.html#a6d50e69638ce9965ce56fbefa0840f2a">xdim</a> / 2);</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        minxp = -cen_xp;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        minyp = -cen_yp;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        minzp = -cen_zp;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        maxxp = V1.<a class="code" href="classMultidimArrayBase.html#a6d50e69638ce9965ce56fbefa0840f2a">xdim</a> - cen_xp - 1;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        maxyp = V1.<a class="code" href="classMultidimArrayBase.html#a239bae0a69ae7de31ed5627bdb65bda4">ydim</a> - cen_yp - 1;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        maxzp = V1.<a class="code" href="classMultidimArrayBase.html#ac51e2cd5a0f23b34bc903626fbe56ffd">zdim</a> - cen_zp - 1;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Geometry 2 center=(&quot;</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        &lt;&lt; cen_z  &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; cen_y  &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; cen_x  &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Geometry 1 center=(&quot;</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        &lt;&lt; cen_zp &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; cen_yp &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; cen_xp &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;           min=(&quot;</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        &lt;&lt; minzp  &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; minyp  &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; minxp  &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;           max=(&quot;</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        &lt;&lt; maxzp  &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; maxyp  &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; maxxp  &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        ;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="keywordflow">if</span> (SplineDegree &gt; 1)</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        {</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            <span class="comment">// Build the B-spline coefficients</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            <span class="keywordflow">if</span> (BcoeffsPtr!=NULL)</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                BcoeffsToUse=BcoeffsPtr;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            {</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                <a class="code" href="group__GeometricalTransformations.html#ga098f5c8e7e9c010a3bf7ab82e31828a8">produceSplineCoefficients</a>(SplineDegree, Bcoeffs, V1); <span class="comment">//Bcoeffs is a single image</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                BcoeffsToUse = &amp;Bcoeffs;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            }</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(*BcoeffsToUse) = (int) minxp;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(*BcoeffsToUse) = (int) minyp;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(*BcoeffsToUse) = (int) minzp;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        }</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <span class="comment">// Now we go from the output MultidimArray to the input MultidimArray, ie, for any</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="comment">// voxel in the output MultidimArray we calculate which are the corresponding</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <span class="comment">// ones in the original MultidimArray, make an interpolation with them and put</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="comment">// this value at the output voxel</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <span class="comment">// V2 is not initialised to 0 because all its pixels are rewritten</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> = 0; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> &lt; V2.zdim; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>++)</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; V2.ydim; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            {</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                <span class="comment">// Calculate position of the beginning of the row in the output</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                <span class="comment">// MultidimArray</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                x = -cen_x;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                y = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - cen_y;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                z = <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> - cen_z;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                <span class="comment">// Calculate this position in the input image according to the</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                <span class="comment">// geometrical transformation they are related by</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                <span class="comment">// coords_output(=x,y) = A * coords_input (=xp,yp)</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                xp = x * <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref, 0, 0) + y * <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref, 0, 1) + z * <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref, 0, 2) + <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref, 0, 3);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                yp = x * <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref, 1, 0) + y * <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref, 1, 1) + z * <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref, 1, 2) + <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref, 1, 3);</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                zp = x * <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref, 2, 0) + y * <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref, 2, 1) + z * <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref, 2, 2) + <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(Aref, 2, 3);</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; V2.xdim; j++)</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                {</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                    <span class="keywordtype">bool</span> interp;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                    <span class="keywordtype">double</span> tmp;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                    <span class="keywordtype">bool</span> show_debug = <span class="keyword">false</span>;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                    <span class="keywordflow">if</span> ((<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> == 0 &amp;&amp; j == 0 &amp;&amp; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> == 0) ||</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                        (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> == V2.ydim - 1 &amp;&amp; j == V2.xdim - 1 &amp;&amp; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> == V2.zdim - 1))</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                        show_debug = <span class="keyword">true</span>;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                    <span class="keywordflow">if</span> (show_debug)</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;(x,y,z)--&gt;(xp,yp,zp)= &quot;</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; x  &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; y  &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; z  &lt;&lt; <span class="stringliteral">&quot;) &quot;</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; xp &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; yp &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; zp &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                    <span class="comment">// If the point is outside the volume, apply a periodic</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                    <span class="comment">// extension of the volume, what exits by one side enters by</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                    <span class="comment">// the other</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                    interp  = <span class="keyword">true</span>;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                    <span class="keywordtype">bool</span> x_isOut = <a class="code" href="group__Macros.html#gaa55c0ac94d4814102fceaa4bf761bb10">XMIPP_RANGE_OUTSIDE</a>(xp, minxp, maxxp);</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                    <span class="keywordtype">bool</span> y_isOut = <a class="code" href="group__Macros.html#gaa55c0ac94d4814102fceaa4bf761bb10">XMIPP_RANGE_OUTSIDE</a>(yp, minyp, maxyp);</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                    <span class="keywordtype">bool</span> z_isOut = <a class="code" href="group__Macros.html#gaa55c0ac94d4814102fceaa4bf761bb10">XMIPP_RANGE_OUTSIDE</a>(zp, minzp, maxzp);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                    <span class="keywordflow">if</span> (wrap)</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                    {</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                        <span class="keywordflow">if</span> (x_isOut)</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                            xp = <a class="code" href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a>(xp, minxp - 0.5, maxxp + 0.5);</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                        <span class="keywordflow">if</span> (y_isOut)</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                            yp = <a class="code" href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a>(yp, minyp - 0.5, maxyp + 0.5);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                        <span class="keywordflow">if</span> (z_isOut)</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                            zp = <a class="code" href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a>(zp, minzp - 0.5, maxzp + 0.5);</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                    }</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x_isOut || y_isOut || z_isOut)</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                        interp = <span class="keyword">false</span>;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                    <span class="keywordflow">if</span> (interp)</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                    {</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                        <span class="keywordflow">if</span> (SplineDegree == 1)</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                        {</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                            <span class="comment">// Linear interpolation</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                            <span class="comment">// Calculate the integer position in input volume, be</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                            <span class="comment">// careful that it is not the nearest but the one at the</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                            <span class="comment">// top left corner of the interpolation square. Ie,</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                            <span class="comment">// (0.7,0.7) would give (0,0)</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                            <span class="comment">// Calculate also weights for point m1+1,n1+1</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                            wx = xp + cen_xp;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                            m1 = (int) wx;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                            wx = wx - m1;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                            m2 = m1 + 1;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                            wy = yp + cen_yp;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                            n1 = (int) wy;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                            wy = wy - n1;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                            n2 = n1 + 1;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                            wz = zp + cen_zp;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                            o1 = (int) wz;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                            wz = wz - o1;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                            o2 = o1 + 1;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                            <span class="keywordflow">if</span> (show_debug)</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                            {</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                                std::cout &lt;&lt; <span class="stringliteral">&quot;After wrapping(xp,yp,zp)= &quot;</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; xp &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; yp &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; zp &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                                std::cout &lt;&lt; <span class="stringliteral">&quot;(m1,n1,o1)--&gt;(m2,n2,o2)=&quot;</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; m1 &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; n1 &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; o1 &lt;&lt; <span class="stringliteral">&quot;) &quot;</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; m2 &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; n2 &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; o2 &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                                std::cout &lt;&lt; <span class="stringliteral">&quot;(wx,wy,wz)=&quot;</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; wx &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; wy &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; wz &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                            }</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                            <span class="comment">// Perform interpolation</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                            <span class="comment">// if wx == 0 means that the rightest point is useless for</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                            <span class="comment">// this interpolation, and even it might not be defined if</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                            <span class="comment">// m1=xdim-1</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                            <span class="comment">// The same can be said for wy.</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                            <span class="keywordtype">double</span> wx_1=1-wx;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                            <span class="keywordtype">double</span> wy_1=1-wy;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                            <span class="keywordtype">double</span> wz_1=1-wz;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                            <span class="keywordtype">double</span> aux1=wz_1 * wy_1;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                            <span class="keywordtype">double</span> aux2=aux1*wx_1;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                            tmp  =  aux2 * <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o1, n1, m1);</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                            <span class="keywordflow">if</span> (wx != 0 &amp;&amp; m2 &lt; V1.<a class="code" href="classMultidimArrayBase.html#a6d50e69638ce9965ce56fbefa0840f2a">xdim</a>)</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                                tmp += (aux1-aux2)* <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o1, n1, m2);</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                            <span class="keywordflow">if</span> (wy != 0 &amp;&amp; n2 &lt; V1.<a class="code" href="classMultidimArrayBase.html#a239bae0a69ae7de31ed5627bdb65bda4">ydim</a>)</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                            {</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                                aux1=wz_1 * wy;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                                aux2=aux1*wx_1;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                                tmp += aux2 * <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o1, n2, m1);</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                                <span class="keywordflow">if</span> (wx != 0 &amp;&amp; m2 &lt; V1.<a class="code" href="classMultidimArrayBase.html#a6d50e69638ce9965ce56fbefa0840f2a">xdim</a>)</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                                    tmp += (aux1-aux2) * <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o1, n2, m2);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                            }</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                            <span class="keywordflow">if</span> (wz != 0 &amp;&amp; o2 &lt; V1.<a class="code" href="classMultidimArrayBase.html#ac51e2cd5a0f23b34bc903626fbe56ffd">zdim</a>)</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                            {</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                                aux1=wz * wy_1;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                                aux2=aux1*wx_1;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                                tmp += aux2 * <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o2, n1, m1);</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                                <span class="keywordflow">if</span> (wx != 0 &amp;&amp; m2 &lt; V1.<a class="code" href="classMultidimArrayBase.html#a6d50e69638ce9965ce56fbefa0840f2a">xdim</a>)</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                                    tmp += (aux1-aux2) * <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o2, n1, m2);</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                                <span class="keywordflow">if</span> (wy != 0 &amp;&amp; n2 &lt; V1.<a class="code" href="classMultidimArrayBase.html#a239bae0a69ae7de31ed5627bdb65bda4">ydim</a>)</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                                {</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                                    aux1=wz * wy;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                                    aux2=aux1*wx_1;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                                    tmp += aux2 * <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o2, n2, m1);</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                                    <span class="keywordflow">if</span> (wx != 0 &amp;&amp; m2 &lt; V1.<a class="code" href="classMultidimArrayBase.html#a6d50e69638ce9965ce56fbefa0840f2a">xdim</a>)</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                                        tmp += (aux1-aux2) * <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o2, n2, m2);</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                                }</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                            }</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                            <span class="keywordflow">if</span> (show_debug)</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                                std::cout &lt;&lt;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                                <span class="stringliteral">&quot;tmp1=&quot;</span> &lt;&lt; <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o1, n1, m1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                                &lt;&lt; (T)(wz_1 *wy_1 *wx_1 * <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o1, n1, m1))</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                                &lt;&lt; std::endl &lt;&lt;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                                <span class="stringliteral">&quot;tmp2=&quot;</span> &lt;&lt; <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o1, n1, m2) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                                &lt;&lt; (T)(wz_1 *wy_1 * wx * <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o1, n1, m2))</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                                &lt;&lt; std::endl &lt;&lt;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                                <span class="stringliteral">&quot;tmp3=&quot;</span> &lt;&lt; <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o1, n2, m1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                                &lt;&lt; (T)(wz_1 * wy *wx_1 * <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o1, n2, m1))</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                                &lt;&lt; std::endl &lt;&lt;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                                <span class="stringliteral">&quot;tmp4=&quot;</span> &lt;&lt; <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o1, n2, m2) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                                &lt;&lt; (T)(wz_1 * wy * wx * <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o2, n1, m1))</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                                &lt;&lt; std::endl &lt;&lt;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                                <span class="stringliteral">&quot;tmp6=&quot;</span> &lt;&lt; <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o2, n1, m2) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                                &lt;&lt; (T)(wz * wy_1 * wx * <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o2, n1, m2))</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                                &lt;&lt; std::endl &lt;&lt;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                                <span class="stringliteral">&quot;tmp7=&quot;</span> &lt;&lt; <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o2, n2, m1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                                &lt;&lt; (T)(wz * wy *wx_1 * <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o2, n2, m1))</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                                &lt;&lt; std::endl &lt;&lt;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                                <span class="stringliteral">&quot;tmp8=&quot;</span> &lt;&lt; <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o2, n2, m2) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                                &lt;&lt; (T)(wz * wy * wx * <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(V1, o2, n2, m2))</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                                &lt;&lt; std::endl &lt;&lt;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                                <span class="stringliteral">&quot;tmp= &quot;</span> &lt;&lt; tmp &lt;&lt; std::endl;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                            <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(V2 , <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j) = (T)tmp;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                        }</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SplineDegree==0)</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                        {</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                            <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(V2, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j)=(T)<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(V1,(<span class="keywordtype">int</span>)<a class="code" href="namespacealglib.html#a9ce7bf988dffc5f65c6db31e8c426a78">trunc</a>(zp),(int)<a class="code" href="namespacealglib.html#a9ce7bf988dffc5f65c6db31e8c426a78">trunc</a>(yp),(int)<a class="code" href="namespacealglib.html#a9ce7bf988dffc5f65c6db31e8c426a78">trunc</a>(xp));</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                        }</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                        {</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                            <span class="comment">// B-spline interpolation</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                            <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(V2, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j) =</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                                (T) BcoeffsToUse-&gt;<a class="code" href="classMultidimArray.html#abfb267790ac8ce750ea98a20f01727d9">interpolatedElementBSpline3D</a>(xp, yp, zp, SplineDegree);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                        }</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                    }</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                        <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(V2, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j) = outside;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                    <span class="comment">// Compute new point inside input image</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                    xp += Aref00;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                    yp += Aref10;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                    zp += Aref20;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                }</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            }</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    }</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_aa86b71453e23d0a973b6f89ca7d9df0f"><div class="ttname"><a href="classMultidimArray.html#aa86b71453e23d0a973b6f89ca7d9df0f">MultidimArray::interpolatedElementBSpline2D_Degree3</a></div><div class="ttdeci">T interpolatedElementBSpline2D_Degree3(double x, double y) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02926">multidim_array.h:2926</a></div></div>
<div class="ttc" id="classMultidimArray_html_abfb267790ac8ce750ea98a20f01727d9"><div class="ttname"><a href="classMultidimArray.html#abfb267790ac8ce750ea98a20f01727d9">MultidimArray::interpolatedElementBSpline3D</a></div><div class="ttdeci">T interpolatedElementBSpline3D(double x, double y, double z, int SplineDegree=3) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02654">multidim_array.h:2654</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a0544c3fe466e421738dae463968b70ba"><div class="ttname"><a href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="ttdeci">else</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02919">numerical_recipes.cpp:2919</a></div></div>
<div class="ttc" id="group__Matrices_html_ga43e28f6079b3652588d5b76ff199ff1e"><div class="ttname"><a href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a></div><div class="ttdeci">#define MAT_YSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00125">matrix2d.h:125</a></div></div>
<div class="ttc" id="classMatrix2D_html_add8d2052c53fcf6689908614f67b9ee6"><div class="ttname"><a href="classMatrix2D.html#add8d2052c53fcf6689908614f67b9ee6">Matrix2D::inv</a></div><div class="ttdeci">void inv(Matrix2D&lt; T &gt; &amp;result) const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01648">matrix2d.h:1648</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00364">multidim_array.h:364</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9ed4376d9ad511e963caf118a6640b28"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a></div><div class="ttdeci">#define DIRECT_A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00351">multidim_array.h:351</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gae8a719ac2323461b466a10050383e947"><div class="ttname"><a href="group__MultidimensionalArrays.html#gae8a719ac2323461b466a10050383e947">SAME_SHAPE3D</a></div><div class="ttdeci">#define SAME_SHAPE3D(v1, v2)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00378">multidim_array.h:378</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a></div><div class="ttdoc">Problem with matrix size. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00157">xmipp_error.h:157</a></div></div>
<div class="ttc" id="classMultidimArray_html_ac0efebfb32ab4e37cf33efca3349aa9b"><div class="ttname"><a href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">MultidimArray::resizeNoCopy</a></div><div class="ttdeci">void resizeNoCopy(const MultidimArray&lt; T1 &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01702">multidim_array.h:1702</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad919bbce6f061400a0bc5231a9cd1621"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a></div><div class="ttdeci">static double * y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08506">numerical_recipes.cpp:8506</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gacac7be97c37bd2e4f801976749de839c"><div class="ttname"><a href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a></div><div class="ttdeci">#define DIRECT_A3D_ELEM(v, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00249">multidim_array.h:249</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gafd91bd40ff4b515cade0323c37f21ac5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a></div><div class="ttdeci">#define dAkij(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00254">multidim_array.h:254</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a239bae0a69ae7de31ed5627bdb65bda4"><div class="ttname"><a href="classMultidimArrayBase.html#a239bae0a69ae7de31ed5627bdb65bda4">MultidimArrayBase::ydim</a></div><div class="ttdeci">size_t ydim</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00726">multidim_array.h:726</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Matrices_html_gab40746be05d4bbf352787018922ecc2e"><div class="ttname"><a href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a></div><div class="ttdeci">#define MAT_ELEM(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00117">matrix2d.h:117</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a6d50e69638ce9965ce56fbefa0840f2a"><div class="ttname"><a href="classMultidimArrayBase.html#a6d50e69638ce9965ce56fbefa0840f2a">MultidimArrayBase::xdim</a></div><div class="ttdeci">size_t xdim</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00729">multidim_array.h:729</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_ac51e2cd5a0f23b34bc903626fbe56ffd"><div class="ttname"><a href="classMultidimArrayBase.html#ac51e2cd5a0f23b34bc903626fbe56ffd">MultidimArrayBase::zdim</a></div><div class="ttdeci">size_t zdim</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00723">multidim_array.h:723</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__Macros_html_gad584f97e936242b173add43261376ba5"><div class="ttname"><a href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a></div><div class="ttdeci">#define XMIPP_EQUAL_ACCURACY</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00119">xmipp_macros.h:119</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga098f5c8e7e9c010a3bf7ab82e31828a8"><div class="ttname"><a href="group__GeometricalTransformations.html#ga098f5c8e7e9c010a3bf7ab82e31828a8">produceSplineCoefficients</a></div><div class="ttdeci">void produceSplineCoefficients(int SplineDegree, MultidimArray&lt; double &gt; &amp;coeffs, const MultidimArray&lt; T &gt; &amp;V1)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01039">transformations.h:1039</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gafa02b309a507bf04daf9f31fa828ce4f"><div class="ttname"><a href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a></div><div class="ttdeci">#define dAij(M, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00355">multidim_array.h:355</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aa508e3dbd0e86258b5c69e8a8b6b8295"><div class="ttname"><a href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08509">numerical_recipes.cpp:8509</a></div></div>
<div class="ttc" id="classMatrix2D_html_aa4b62ee9cbc7a16d480d2a9b90df2758"><div class="ttname"><a href="classMatrix2D.html#aa4b62ee9cbc7a16d480d2a9b90df2758">Matrix2D::isIdentity</a></div><div class="ttdeci">bool isIdentity() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01759">matrix2d.h:1759</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__Macros_html_gaa55c0ac94d4814102fceaa4bf761bb10"><div class="ttname"><a href="group__Macros.html#gaa55c0ac94d4814102fceaa4bf761bb10">XMIPP_RANGE_OUTSIDE</a></div><div class="ttdeci">#define XMIPP_RANGE_OUTSIDE(x, min, max)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00126">xmipp_macros.h:126</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="namespacealglib_html_a9ce7bf988dffc5f65c6db31e8c426a78"><div class="ttname"><a href="namespacealglib.html#a9ce7bf988dffc5f65c6db31e8c426a78">alglib::trunc</a></div><div class="ttdeci">int trunc(double x)</div><div class="ttdef"><b>Definition:</b> <a href="ap_8cpp_source.html#l07248">ap.cpp:7248</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="group__Vectors_html_gaf36b657319bb585c75cfa14744dab275"><div class="ttname"><a href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a></div><div class="ttdeci">void typeCast(const Matrix1D&lt; T1 &gt; &amp;v1, Matrix1D&lt; T2 &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01904">matrix1d.h:1904</a></div></div>
<div class="ttc" id="group__Matrices_html_gacd5c6ac63f21fdbbd4343a9caf1ee9c6"><div class="ttname"><a href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a></div><div class="ttdeci">#define MAT_XSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00121">matrix2d.h:121</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_afbb6b0117ab2bbad5949e688d32a7c0d"><div class="ttname"><a href="classMultidimArrayBase.html#afbb6b0117ab2bbad5949e688d32a7c0d">MultidimArrayBase::getDim</a></div><div class="ttdeci">int getDim() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01098">multidim_array.h:1098</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga8b05c2e355f50c6441d653a8e2bcb4ef"><div class="ttname"><a href="group__GeometricalTransformations.html#ga8b05c2e355f50c6441d653a8e2bcb4ef">getLoopRange</a></div><div class="ttdeci">bool getLoopRange(double value, double min, double max, double delta, int loopLimit, int &amp;minIter, int &amp;maxIter)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00452">transformations.cpp:452</a></div></div>
<div class="ttc" id="group__Macros_html_ga25935c2309abe02cff60809c4d7d9b9e"><div class="ttname"><a href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a></div><div class="ttdeci">#define realWRAP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00304">xmipp_macros.h:304</a></div></div>
<div class="ttc" id="group__Macros_html_gad1e8225913883a6887c786d6d44c8f48"><div class="ttname"><a href="group__Macros.html#gad1e8225913883a6887c786d6d44c8f48">XMIPP_RANGE_OUTSIDE_FAST</a></div><div class="ttdeci">#define XMIPP_RANGE_OUTSIDE_FAST(x, min, max)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00128">xmipp_macros.h:128</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="classMultidimArray_html_ad198844075bf06ecf3bb66fd5c6b5695"><div class="ttname"><a href="classMultidimArray.html#ad198844075bf06ecf3bb66fd5c6b5695">MultidimArray::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01302">multidim_array.h:1302</a></div></div>
<div class="ttc" id="classMultidimArray_html_abc6240fbe88ed0aaacede9fd9ad78051"><div class="ttname"><a href="classMultidimArray.html#abc6240fbe88ed0aaacede9fd9ad78051">MultidimArray::interpolatedElementBSpline2D</a></div><div class="ttdeci">T interpolatedElementBSpline2D(double x, double y, int SplineDegree=3) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02815">multidim_array.h:2815</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a></div><div class="ttdoc">Incorrect value received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00200">xmipp_error.h:200</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga8728c9650f6eef6812c24ee82ffb70ea"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void applyGeometry </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wrap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>outside</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="transformations_8h_source.html#l00980">980</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;{</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="preprocessor">#define APPLYGEO(type)  applyGeometry(SplineDegree,V2, (*(MultidimArray&lt;type&gt;*)(V1.im)), A, inv, wrap, outside);</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <a class="code" href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a>(V1.<a class="code" href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">datatype</a>, <a class="code" href="transformations_8h.html#acaf9f281bf871227874ac97ea3b2badb">APPLYGEO</a>)</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="preprocessor">#undef APPLYGEO</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;}</div><div class="ttc" id="transformations_8h_html_acaf9f281bf871227874ac97ea3b2badb"><div class="ttname"><a href="transformations_8h.html#acaf9f281bf871227874ac97ea3b2badb">APPLYGEO</a></div><div class="ttdeci">#define APPLYGEO(type)</div></div>
<div class="ttc" id="classMultidimArrayGeneric_html_a0b74b17fe8d2f77c90b1513bd795c224"><div class="ttname"><a href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">MultidimArrayGeneric::datatype</a></div><div class="ttdeci">DataType datatype</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00110">multidim_array_generic.h:110</a></div></div>
<div class="ttc" id="multidim__array__generic_8h_html_ada27bedba7f65b4ad8fca3eb7f5ad65e"><div class="ttname"><a href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a></div><div class="ttdeci">#define SWITCHDATATYPE(datatype, OP)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00044">multidim_array_generic.h:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga3cc15e5dda7c58b9cacb7eee440d6bdc"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void applyGeometry </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>V2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wrap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::complex&lt; double &gt;&#160;</td>
          <td class="paramname"><em>outside</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>BcoeffsPtr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00517">517</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;{</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">if</span> (SplineDegree &gt; 1)</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    {</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> re, im, rotre, rotim;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <a class="code" href="classMultidimArray.html">MultidimArray&lt;std::complex&lt;double&gt;</a> &gt; oneImg;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="keywordtype">double</span> outre, outim;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        re.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(V1), <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(V1), <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V1));</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        im.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(V1), <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(V1), <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V1));</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        outre = outside.real();</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        outim = outside.imag();</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        oneImg=V1;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <a class="code" href="group__Fourier.html#gaecc9ea04e2c2d93f8da933157abdc473">Complex2RealImag</a>(<a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(oneImg),</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                         <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(re), <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(im),</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                         <a class="code" href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(oneImg));</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a>(SplineDegree, rotre, re, A, inv, wrap, outre);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a>(SplineDegree, rotim, im, A, inv, wrap, outim);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        V2.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(oneImg);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <a class="code" href="group__Fourier.html#ga33c7ec60c621eb0d58a4d23981b84793">RealImag2Complex</a>(<a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(rotre), <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(rotim),</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                         <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(V2), <a class="code" href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(re));</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    { <span class="comment">//FIXME I do not think you want to recall your self</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa5bed3f42a08e195b307cf8622e913327">ERR_NOT_IMPLEMENTED</a>,<span class="stringliteral">&quot;I do not think you want to recall your self&quot;</span>);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a>(SplineDegree, V2, V1, A, inv, wrap, outside);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    }</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa5bed3f42a08e195b307cf8622e913327"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa5bed3f42a08e195b307cf8622e913327">ERR_NOT_IMPLEMENTED</a></div><div class="ttdoc">Case or algorithm not implemented yet. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00182">xmipp_error.h:182</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gac87b223f03097d45f776b44b6aeea9f7"><div class="ttname"><a href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a></div><div class="ttdeci">#define MULTIDIM_ARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00136">multidim_array.h:136</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga027a630a86c277b71cda769268764fd1"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a></div><div class="ttdeci">#define MULTIDIM_SIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00125">multidim_array.h:125</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga3cc15e5dda7c58b9cacb7eee440d6bdc"><div class="ttname"><a href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a></div><div class="ttdeci">void applyGeometry(int SplineDegree, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V2, const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V1, const Matrix2D&lt; double &gt; &amp;A, bool inv, bool wrap, std::complex&lt; double &gt; outside, MultidimArray&lt; double &gt; *BcoeffsPtr)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00517">transformations.cpp:517</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="group__Fourier_html_ga33c7ec60c621eb0d58a4d23981b84793"><div class="ttname"><a href="group__Fourier.html#ga33c7ec60c621eb0d58a4d23981b84793">RealImag2Complex</a></div><div class="ttdeci">void RealImag2Complex(const MultidimArray&lt; double &gt; &amp;real, const MultidimArray&lt; double &gt; &amp;imag, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8cpp_source.html#l00114">xmipp_fft.cpp:114</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__Fourier_html_gaecc9ea04e2c2d93f8da933157abdc473"><div class="ttname"><a href="group__Fourier.html#gaecc9ea04e2c2d93f8da933157abdc473">Complex2RealImag</a></div><div class="ttdeci">void Complex2RealImag(const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;in, MultidimArray&lt; double &gt; &amp;real, MultidimArray&lt; double &gt; &amp;imag)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8cpp_source.html#l00103">xmipp_fft.cpp:103</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaf8c063f9b9edef4d2ced7b44fe9182ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void applyGeometry </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;&#160;</td>
          <td class="paramname"><em>V2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wrap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>outside</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00562">562</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;{</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="preprocessor">#define APPLYGEO(type)  applyGeometry(SplineDegree,(*(MultidimArray&lt;type&gt;*)(V2.im)), \</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="preprocessor">                        (*(MultidimArray&lt;type&gt;*)(V1.im)), A, inv, wrap, (type) outside);</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <a class="code" href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a>(V1.<a class="code" href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">datatype</a>, <a class="code" href="transformations_8cpp.html#acaf9f281bf871227874ac97ea3b2badb">APPLYGEO</a>)</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="preprocessor">#undef APPLYGEO</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;}</div><div class="ttc" id="transformations_8cpp_html_acaf9f281bf871227874ac97ea3b2badb"><div class="ttname"><a href="transformations_8cpp.html#acaf9f281bf871227874ac97ea3b2badb">APPLYGEO</a></div><div class="ttdeci">#define APPLYGEO(type)</div></div>
<div class="ttc" id="classMultidimArrayGeneric_html_a0b74b17fe8d2f77c90b1513bd795c224"><div class="ttname"><a href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">MultidimArrayGeneric::datatype</a></div><div class="ttdeci">DataType datatype</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00110">multidim_array_generic.h:110</a></div></div>
<div class="ttc" id="multidim__array__generic_8h_html_ada27bedba7f65b4ad8fca3eb7f5ad65e"><div class="ttname"><a href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a></div><div class="ttdeci">#define SWITCHDATATYPE(datatype, OP)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00044">multidim_array_generic.h:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga87de8035e86a51972bdf358690e427a9"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void expandBSpline </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Expand a set of B-spline coefficients.</p>
<p>Knowing that V1 is a (single image of) B-spline coefficients, produce the expanded set of B-spline coefficients using the two-scale relationship. </p>

<p>Definition at line <a class="el" href="transformations_8h_source.html#l01423">1423</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;{</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a>[200]; <span class="comment">// Coefficients of the reduce filter</span></div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <span class="keywordtype">long</span> ng; <span class="comment">// Number of coefficients of the reduce filter</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <span class="keywordtype">double</span> h[200]; <span class="comment">// Coefficients of the expansion filter</span></div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="keywordtype">long</span> nh; <span class="comment">// Number of coefficients of the expansion filter</span></div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="keywordtype">short</span> IsCentered; <span class="comment">// Equal TRUE if the filter is a centered spline, FALSE otherwise */</span></div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="comment">// Get the filter</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__PyramidTools.html#ga4333a698029811c9b24fb452a53a1286">GetPyramidFilter</a>(<span class="stringliteral">&quot;Centered Spline&quot;</span>, SplineDegree, g, &amp;ng, h, &amp;nh,</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                         &amp;IsCentered))</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa60458766acaafb3722c0234011bbdbf8">ERR_UNCLASSIFIED</a>, <span class="stringliteral">&quot;Unable to load the filter coefficients&quot;</span>);</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; double &gt;</a> aux;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <a class="code" href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a>(V1, aux);</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="keywordflow">if</span> (V1.<a class="code" href="classMultidimArrayBase.html#afbb6b0117ab2bbad5949e688d32a7c0d">getDim</a>() == 2)</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    {</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        V2.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(2 * <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux), 2 * <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux));</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        <a class="code" href="group__PyramidTools.html#ga1edaa9683f2776a61c9a2e27e949061e">Expand_2D</a>(<a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(aux), <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux), <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux),</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                  <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(V2), h, nh, IsCentered);</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    }</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (V1.<a class="code" href="classMultidimArrayBase.html#afbb6b0117ab2bbad5949e688d32a7c0d">getDim</a>() == 3)</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    {</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        V2.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(2 * <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(aux), 2 * <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux), 2 * <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux));</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        <a class="code" href="group__PyramidTools.html#ga758219a753dfa2af79a8985fd2c7d822">Expand_3D</a>(<a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(aux), <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux), <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux), <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(aux),</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                  <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(V2), h, nh, IsCentered);</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    }</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa24918e77d512d272bc38188b58f78ac2">ERR_MULTIDIM_DIM</a>,<span class="stringliteral">&quot;expandBSpline ERROR: only valid for 2D or 3D arrays&quot;</span>);</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa60458766acaafb3722c0234011bbdbf8"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa60458766acaafb3722c0234011bbdbf8">ERR_UNCLASSIFIED</a></div><div class="ttdoc">Just to locate unclassified errors. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00197">xmipp_error.h:197</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gac87b223f03097d45f776b44b6aeea9f7"><div class="ttname"><a href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a></div><div class="ttdeci">#define MULTIDIM_ARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00136">multidim_array.h:136</a></div></div>
<div class="ttc" id="group__PyramidTools_html_ga758219a753dfa2af79a8985fd2c7d822"><div class="ttname"><a href="group__PyramidTools.html#ga758219a753dfa2af79a8985fd2c7d822">Expand_3D</a></div><div class="ttdeci">int Expand_3D(double *In, long int NxIn, long int NyIn, long int NzIn, double *Out, double h[], long int nh, short FlagCentered)</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af72286acf4184005499476fbc853146f"><div class="ttname"><a href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a></div><div class="ttdeci">doublereal * g</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02490">numerical_recipes.cpp:2490</a></div></div>
<div class="ttc" id="group__PyramidTools_html_ga1edaa9683f2776a61c9a2e27e949061e"><div class="ttname"><a href="group__PyramidTools.html#ga1edaa9683f2776a61c9a2e27e949061e">Expand_2D</a></div><div class="ttdeci">int Expand_2D(double *In, long int NxIn, long int NyIn, double *Out, double h[], long int nh, short FlagCentered)</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__Vectors_html_gaf36b657319bb585c75cfa14744dab275"><div class="ttname"><a href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a></div><div class="ttdeci">void typeCast(const Matrix1D&lt; T1 &gt; &amp;v1, Matrix1D&lt; T2 &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01904">matrix1d.h:1904</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_afbb6b0117ab2bbad5949e688d32a7c0d"><div class="ttname"><a href="classMultidimArrayBase.html#afbb6b0117ab2bbad5949e688d32a7c0d">MultidimArrayBase::getDim</a></div><div class="ttdeci">int getDim() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01098">multidim_array.h:1098</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa24918e77d512d272bc38188b58f78ac2"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa24918e77d512d272bc38188b58f78ac2">ERR_MULTIDIM_DIM</a></div><div class="ttdoc">Incorrect MultidimArray dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00178">xmipp_error.h:178</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="group__PyramidTools_html_ga4333a698029811c9b24fb452a53a1286"><div class="ttname"><a href="group__PyramidTools.html#ga4333a698029811c9b24fb452a53a1286">GetPyramidFilter</a></div><div class="ttdeci">int GetPyramidFilter(const char *Filter, long int Order, double g[], long int *ng, double h[], long int *nh, short *FlagCentered)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga458542f12eb6e607d932ded467a283b8"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void fastRadialAverage </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>distance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>radial_mean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>radial_count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="transformations_8h_source.html#l01718">1718</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;{</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    <span class="comment">// Define the vectors</span></div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    radial_mean.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(dim);</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    radial_count.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(dim);</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    <span class="comment">// Perform the radial sum and count pixels that contribute to every</span></div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="comment">// distance</span></div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(m)</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    {</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a>=<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(distance,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(radial_mean,d) += <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(m,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        ++<a class="code" href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(radial_count,d);</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    }</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    <span class="comment">// Perform the mean</span></div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gaceb4070c83bd0e86e3adc96e07a32c31">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY1D</a>(radial_mean)</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;      <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(radial_count,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &gt; 0)</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(radial_mean,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) /= <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(radial_count,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga97809f7244a28aaa1c26e29e6e3204ef"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a></div><div class="ttdeci">#define A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00549">multidim_array.h:549</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3939496af6ccffe20d083935ebd3225b"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a></div><div class="ttdeci">doublereal * d</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaceb4070c83bd0e86e3adc96e07a32c31"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaceb4070c83bd0e86e3adc96e07a32c31">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY1D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00603">multidim_array.h:603</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gac6e28a37ef482c451a17cea4d8530746"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void geo2TransformationMatrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMDRow.html">MDRow</a> &amp;&#160;</td>
          <td class="paramname"><em>imageHeader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>only_apply_shifts</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get geometric transformation matrix from image geometry Now this info is stored in metadata The order is: first flip (if necessary), then rotate, then shift A=Translation*Rotation*(Mirror) </p>

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00029">29</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;{</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">// This has only been implemented for 2D images...</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a> = 0, shiftX = 0., shiftY = 0., scale = 1.;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordtype">bool</span> flip = <span class="keyword">false</span>;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    imageGeo.getValue(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a114e3414dd216e4308946a016b5cc46f">MDL_ANGLE_PSI</a>, psi);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    imageGeo.getValue(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acb3aa7acca32f4524608635e2e09650e">MDL_SHIFT_X</a>, shiftX);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    imageGeo.getValue(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab00882fc483e9a1a7e6af5829a6afb8e">MDL_SHIFT_Y</a>, shiftY);</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    imageGeo.getValue(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aad487c1de68c3a3b8f44773ee776d87c">MDL_SCALE</a>, scale);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    imageGeo.getValue(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af6495a877b8c80b9c45b8156b406b183">MDL_FLIP</a>, flip);</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    psi = <a class="code" href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a>(psi, 0., 360.);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordtype">int</span> dim = A.<a class="code" href="classMatrix2D.html#aba34255aa8d181d565014abf744c5dd1">Xdim</a>() - 1;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">//This check the case when matrix A is not initialized with correct size</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">if</span> (dim &lt; 2 || dim &gt; 3)</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    {</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        dim = 3;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        A.<a class="code" href="classMatrix2D.html#a6928f78d5ccff2c21a26811702fa4d82">resizeNoCopy</a>(dim + 1, dim + 1);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    }</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">if</span> (only_apply_shifts)</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        A.<a class="code" href="classMatrix2D.html#a1b0afdb4a10ad1857db3db8b64715ba3">initIdentity</a>();</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 2) <span class="comment">//2D geometry</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga93598c1cf08f43c7a58a096003b2d718">rotation2DMatrix</a>(psi, A, <span class="keyword">true</span>);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 3)<span class="comment">//3D geometry</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordtype">double</span> rot = 0., tilt = 0., shiftZ = 0.;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        imageGeo.getValue(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a59fffce298c0f99a1d592544d3d39a08">MDL_ANGLE_ROT</a>, rot);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        imageGeo.getValue(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac15f836e18a2035d2923ecf76c6e8c7f">MDL_ANGLE_TILT</a>, tilt);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        imageGeo.getValue(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aa66f1aad407cfbd08f582453ffa68c3e">MDL_SHIFT_Z</a>, shiftZ);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <a class="code" href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a>(rot, tilt, psi, A, <span class="keyword">true</span>);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(A, 2, dim) = shiftZ;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(A, 0, dim) = shiftX;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(A, 1, dim) = shiftY;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">if</span> (scale != 1.)</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">if</span> (scale==0.) <span class="comment">// Protection against badly formed metadatas</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            scale=1.0;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">if</span> (dim == 2)</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        {</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <a class="code" href="group__Matrices.html#ga858f5450da1fdd355414d3bc25e48885">M3x3_BY_CT</a>(A, A, scale);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        }</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 3)</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <a class="code" href="group__Matrices.html#ga9322b16bc590b58c44a2c92ba58fe805">M4x4_BY_CT</a>(A, A, scale);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(A, dim, dim) = 1.;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">if</span> (flip)</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(A, 0, 0) *= -1.;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(A, 0, 1) *= -1.;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">if</span> (dim == 3)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(A, 0, 2) *= -1.;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;}</div><div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a59fffce298c0f99a1d592544d3d39a08"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a59fffce298c0f99a1d592544d3d39a08">MDL_ANGLE_ROT</a></div><div class="ttdoc">Rotation angle of an image (double,degrees) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00057">metadata_label.h:57</a></div></div>
<div class="ttc" id="group__Geometry_html_gaf67a2d233e3fbf038d111a91197fa759"><div class="ttname"><a href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a></div><div class="ttdeci">void Euler_angles2matrix(T alpha, T beta, T gamma, Matrix2D&lt; T &gt; &amp;A, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00621">geometry.cpp:621</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac15f836e18a2035d2923ecf76c6e8c7f"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac15f836e18a2035d2923ecf76c6e8c7f">MDL_ANGLE_TILT</a></div><div class="ttdoc">Tilting angle of an image (double,degrees) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00060">metadata_label.h:60</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78acb3aa7acca32f4524608635e2e09650e"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acb3aa7acca32f4524608635e2e09650e">MDL_SHIFT_X</a></div><div class="ttdoc">Shift for the image in the X axis (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00412">metadata_label.h:412</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a114e3414dd216e4308946a016b5cc46f"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a114e3414dd216e4308946a016b5cc46f">MDL_ANGLE_PSI</a></div><div class="ttdoc">Special label to be used when gathering MDs in MpiMetadataPrograms. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00054">metadata_label.h:54</a></div></div>
<div class="ttc" id="classMatrix2D_html_a6928f78d5ccff2c21a26811702fa4d82"><div class="ttname"><a href="classMatrix2D.html#a6928f78d5ccff2c21a26811702fa4d82">Matrix2D::resizeNoCopy</a></div><div class="ttdeci">void resizeNoCopy(int Ydim, int Xdim)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00664">matrix2d.h:664</a></div></div>
<div class="ttc" id="group__Matrices_html_gaf0f6abe0342cabe025337d656f034e87"><div class="ttname"><a href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a></div><div class="ttdeci">#define dMij(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00140">matrix2d.h:140</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af6495a877b8c80b9c45b8156b406b183"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af6495a877b8c80b9c45b8156b406b183">MDL_FLIP</a></div><div class="ttdoc">Flip the image? (bool) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00231">metadata_label.h:231</a></div></div>
<div class="ttc" id="group__Matrices_html_ga858f5450da1fdd355414d3bc25e48885"><div class="ttname"><a href="group__Matrices.html#ga858f5450da1fdd355414d3bc25e48885">M3x3_BY_CT</a></div><div class="ttdeci">#define M3x3_BY_CT(M2, M1, k)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00249">matrix2d.h:249</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78aad487c1de68c3a3b8f44773ee776d87c"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aad487c1de68c3a3b8f44773ee776d87c">MDL_SCALE</a></div><div class="ttdoc">scaling factor for an image or volume (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00385">metadata_label.h:385</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga93598c1cf08f43c7a58a096003b2d718"><div class="ttname"><a href="group__GeometricalTransformations.html#ga93598c1cf08f43c7a58a096003b2d718">rotation2DMatrix</a></div><div class="ttdeci">void rotation2DMatrix(T ang, Matrix2D&lt; T &gt; &amp;result, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00212">transformations.cpp:212</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="classMatrix2D_html_aba34255aa8d181d565014abf744c5dd1"><div class="ttname"><a href="classMatrix2D.html#aba34255aa8d181d565014abf744c5dd1">Matrix2D::Xdim</a></div><div class="ttdeci">size_t Xdim() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00728">matrix2d.h:728</a></div></div>
<div class="ttc" id="group__Matrices_html_ga9322b16bc590b58c44a2c92ba58fe805"><div class="ttname"><a href="group__Matrices.html#ga9322b16bc590b58c44a2c92ba58fe805">M4x4_BY_CT</a></div><div class="ttdeci">#define M4x4_BY_CT(M2, M1, k)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00264">matrix2d.h:264</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78aa66f1aad407cfbd08f582453ffa68c3e"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aa66f1aad407cfbd08f582453ffa68c3e">MDL_SHIFT_Z</a></div><div class="ttdoc">Shift for the image in the Z axis (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00418">metadata_label.h:418</a></div></div>
<div class="ttc" id="group__Macros_html_ga25935c2309abe02cff60809c4d7d9b9e"><div class="ttname"><a href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a></div><div class="ttdeci">#define realWRAP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00304">xmipp_macros.h:304</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab00882fc483e9a1a7e6af5829a6afb8e"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab00882fc483e9a1a7e6af5829a6afb8e">MDL_SHIFT_Y</a></div><div class="ttdoc">Shift for the image in the Y axis (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00415">metadata_label.h:415</a></div></div>
<div class="ttc" id="classMatrix2D_html_a1b0afdb4a10ad1857db3db8b64715ba3"><div class="ttname"><a href="classMatrix2D.html#a1b0afdb4a10ad1857db3db8b64715ba3">Matrix2D::initIdentity</a></div><div class="ttdeci">void initIdentity()</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00835">matrix2d.h:835</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga8b05c2e355f50c6441d653a8e2bcb4ef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool getLoopRange </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>loopLimit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>minIter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>maxIter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00452">452</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;{</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordtype">bool</span> validRange=<span class="keyword">true</span>;<span class="comment">// Return value. TRUE if input value is into range boundaries.</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="comment">// Value is under lower boundary.</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">if</span> (value &lt; <a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">min</a>)</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="comment">// If delta is negative -&gt; moving to lower values and never into valid range.</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a> &lt;= <a class="code" href="transformations_8cpp.html#a002f2fd9fd796d082a11fd6b0ad394c4">DELTA_THRESHOLD</a>)</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            validRange = <span class="keyword">false</span>;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        }</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="comment">// Compute first and last iterations into valid values.</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        {</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            minIter = (int) (fabs(<a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">min</a> - value) / <a class="code" href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a>);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            minIter++;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            maxIter = (int) (fabs(<a class="code" href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">max</a> - value) / <a class="code" href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a>);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        }</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    }</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">// Value is over upper boundary.</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (value &gt;= <a class="code" href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">max</a>)</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    {</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="comment">// If delta is negative -&gt; moving to lower values and never into valid range.</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a> &gt;= -<a class="code" href="transformations_8cpp.html#a002f2fd9fd796d082a11fd6b0ad394c4">DELTA_THRESHOLD</a>)</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        {</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            validRange = <span class="keyword">false</span>;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        }</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="comment">// Compute first and last iterations into valid values.</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        {</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            minIter = (int) (fabs(value - <a class="code" href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">max</a>) / -<a class="code" href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a>);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            minIter++;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            maxIter = (int) (fabs(value - <a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">min</a>) / -<a class="code" href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a>);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        }</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    }</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">// First value into valid range.</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    {</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="comment">// Compute first and last iterations into valid values.</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a> &gt; <a class="code" href="transformations_8cpp.html#a002f2fd9fd796d082a11fd6b0ad394c4">DELTA_THRESHOLD</a>)</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        {</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            minIter = 0;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            maxIter = (int) (fabs(<a class="code" href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">max</a> - value) / <a class="code" href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a>);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        }</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="comment">// Compute first and last iterations into valid values.</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a> &lt; -<a class="code" href="transformations_8cpp.html#a002f2fd9fd796d082a11fd6b0ad394c4">DELTA_THRESHOLD</a>)</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            minIter = 0;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            maxIter = (int) (fabs(value - <a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">min</a>) / -<a class="code" href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a>);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        }</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="comment">// If delta is zero then always in valid range.</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        {</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            minIter = 0;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            maxIter = loopLimit;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        }</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    }</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">return</span>(validRange);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;}</div><div class="ttc" id="image__operate_8cpp_html_afbbd36781c10524238c70745c6f6f35d"><div class="ttname"><a href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">min</a></div><div class="ttdeci">void min(Image&lt; double &gt; &amp;op1, const Image&lt; double &gt; &amp;op2)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00115">image_operate.cpp:115</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_ac5474a01d203d14c046620266b2f1954"><div class="ttname"><a href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">max</a></div><div class="ttdeci">void max(Image&lt; double &gt; &amp;op1, const Image&lt; double &gt; &amp;op2)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00125">image_operate.cpp:125</a></div></div>
<div class="ttc" id="transformations_8cpp_html_a002f2fd9fd796d082a11fd6b0ad394c4"><div class="ttname"><a href="transformations_8cpp.html#a002f2fd9fd796d082a11fd6b0ad394c4">DELTA_THRESHOLD</a></div><div class="ttdeci">#define DELTA_THRESHOLD</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00451">transformations.cpp:451</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a9ea1a8f5ef3e6d20b362385e1288c72c"><div class="ttname"><a href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a></div><div class="ttdeci">double * delta</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07616">numerical_recipes.cpp:7616</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga14f44acb983d41b79d09756b8bee4f4a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double interpolatedElementBSplineDiffX </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Interpolates the value of the 3D matrix M at the point (x,y,z) knowing that this image is a set of B-spline coefficients. And making the diff of x, such-&gt; V=sum(Coef diff(Bx) By Bz) Only for BSplines of degree 3!!</p>
<p>(x,y,z) are in logical coordinates. </p>

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00702">702</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;{</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordtype">int</span> SplineDegree_1 = SplineDegree - 1;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordtype">double</span> aux;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="comment">// Logical to physical</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> -= <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(vol);</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> -= <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(vol);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> -= <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(vol);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordtype">int</span> l1 = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> - SplineDegree_1);</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordtype">int</span> l2 = l1 + SplineDegree;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordtype">int</span> m1 = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> - SplineDegree_1);</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordtype">int</span> m2 = m1 + SplineDegree;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="keywordtype">int</span> n1 = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> - SplineDegree_1);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordtype">int</span> n2 = n1 + SplineDegree;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="keywordtype">double</span> zyxsum = 0.0;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keywordtype">int</span> Zdim=(int)<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(vol);</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="keywordtype">int</span> Ydim=(int)<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(vol);</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keywordtype">int</span> Xdim=(int)<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(vol);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = n1; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> &lt;= n2; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>++)</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    {</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <span class="keywordtype">int</span> equivalent_n=<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <span class="keywordflow">if</span>      (<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>&lt;0)</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            equivalent_n=-<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>-1;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>&gt;=Zdim)</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            equivalent_n=2*Zdim-<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>-1;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        <span class="keywordtype">double</span> yxsum = 0.0;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> = m1; <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> &lt;= m2; <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>++)</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        {</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            <span class="keywordtype">int</span> equivalent_m=<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            <span class="keywordflow">if</span>      (<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>&lt;0)</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                equivalent_m=-<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>-1;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>&gt;=Ydim)</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                equivalent_m=2*Ydim-<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>-1;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            <span class="keywordtype">double</span> xsum = 0.0;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = l1; l &lt;= l2; l++)</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            {</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                <span class="keywordtype">double</span> xminusl = <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> - (double) l;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                <span class="keywordtype">int</span> equivalent_l=l;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                <span class="keywordflow">if</span>      (l&lt;0)</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                    equivalent_l=-l-1;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (l&gt;=Xdim)</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                    equivalent_l=2*Xdim-l-1;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                <span class="keywordtype">double</span> Coeff = (double) <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(vol, equivalent_n,</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                                                             equivalent_m,</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                                                             equivalent_l );</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                <span class="keywordflow">switch</span> (SplineDegree)</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                {</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                    xsum += Coeff * <a class="code" href="group__KernelDefinition.html#gaa92a7fe60e1322678e95722660710dde">Bspline02</a>(xminusl);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                    <a class="code" href="kerneldiff1_8h.html#a4756f1cc0a8d4379b8d31df7abdc322a">BSPLINE03DIFF1</a>(aux,xminusl);</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                    xsum += Coeff * aux;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                    xsum += Coeff * <a class="code" href="group__KernelDefinition.html#ga7735a4dada77ad119562083b16b65523">Bspline04</a>(xminusl);</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                    xsum += Coeff * <a class="code" href="group__KernelDefinition.html#gaf4b9554342b12659737e4ed7130eaa7b">Bspline05</a>(xminusl);</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                    xsum += Coeff * <a class="code" href="group__KernelDefinition.html#ga2ea30a01ce9a0bea67dc6a116be4d90f">Bspline06</a>(xminusl);</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                    xsum += Coeff * <a class="code" href="group__KernelDefinition.html#gac15ac191df9734bd90df659e98284f41">Bspline07</a>(xminusl);</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                    xsum += Coeff * <a class="code" href="group__KernelDefinition.html#ga38406ca5c4cd9600f103dbaa34171390">Bspline08</a>(xminusl);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                <span class="keywordflow">case</span> 9:</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                    xsum += Coeff * <a class="code" href="group__KernelDefinition.html#ga32d62f1a4548fa42a191f36e14116a5a">Bspline09</a>(xminusl);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                }</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            }</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            <span class="keywordtype">double</span> yminusm = <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> - (double) m;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            <span class="keywordflow">switch</span> (SplineDegree)</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            {</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                yxsum += xsum * <a class="code" href="group__KernelDefinition.html#gaa92a7fe60e1322678e95722660710dde">Bspline02</a>(yminusm);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                <a class="code" href="group__KernelDefinition.html#ga3edb5be6b31f9ddc44ef4f4ce1e419d8">BSPLINE03</a>(aux,yminusm);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                yxsum += xsum * aux;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                yxsum += xsum * <a class="code" href="group__KernelDefinition.html#ga7735a4dada77ad119562083b16b65523">Bspline04</a>(yminusm);</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                yxsum += xsum * <a class="code" href="group__KernelDefinition.html#gaf4b9554342b12659737e4ed7130eaa7b">Bspline05</a>(yminusm);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                yxsum += xsum * <a class="code" href="group__KernelDefinition.html#ga2ea30a01ce9a0bea67dc6a116be4d90f">Bspline06</a>(yminusm);</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                yxsum += xsum * <a class="code" href="group__KernelDefinition.html#gac15ac191df9734bd90df659e98284f41">Bspline07</a>(yminusm);</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                yxsum += xsum * <a class="code" href="group__KernelDefinition.html#ga38406ca5c4cd9600f103dbaa34171390">Bspline08</a>(yminusm);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            <span class="keywordflow">case</span> 9:</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                yxsum += xsum * <a class="code" href="group__KernelDefinition.html#ga32d62f1a4548fa42a191f36e14116a5a">Bspline09</a>(yminusm);</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            }</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        }</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <span class="keywordtype">double</span> zminusn = <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> - (double) n;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <span class="keywordflow">switch</span> (SplineDegree)</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        {</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            zyxsum += yxsum * <a class="code" href="group__KernelDefinition.html#gaa92a7fe60e1322678e95722660710dde">Bspline02</a>(zminusn);</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            <a class="code" href="group__KernelDefinition.html#ga3edb5be6b31f9ddc44ef4f4ce1e419d8">BSPLINE03</a>(aux,zminusn);</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            zyxsum += yxsum * aux;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            zyxsum += yxsum * <a class="code" href="group__KernelDefinition.html#ga7735a4dada77ad119562083b16b65523">Bspline04</a>(zminusn);</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            zyxsum += yxsum * <a class="code" href="group__KernelDefinition.html#gaf4b9554342b12659737e4ed7130eaa7b">Bspline05</a>(zminusn);</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            zyxsum += yxsum * <a class="code" href="group__KernelDefinition.html#ga2ea30a01ce9a0bea67dc6a116be4d90f">Bspline06</a>(zminusn);</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            zyxsum += yxsum * <a class="code" href="group__KernelDefinition.html#gac15ac191df9734bd90df659e98284f41">Bspline07</a>(zminusn);</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            zyxsum += yxsum * <a class="code" href="group__KernelDefinition.html#ga38406ca5c4cd9600f103dbaa34171390">Bspline08</a>(zminusn);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <span class="keywordflow">case</span> 9:</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            zyxsum += yxsum * <a class="code" href="group__KernelDefinition.html#ga32d62f1a4548fa42a191f36e14116a5a">Bspline09</a>(zminusn);</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        }</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    }</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">return</span> zyxsum;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;}</div><div class="ttc" id="group__KernelDefinition_html_gaf4b9554342b12659737e4ed7130eaa7b"><div class="ttname"><a href="group__KernelDefinition.html#gaf4b9554342b12659737e4ed7130eaa7b">Bspline05</a></div><div class="ttdeci">double Bspline05(double Argument)</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad919bbce6f061400a0bc5231a9cd1621"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a></div><div class="ttdeci">static double * y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08506">numerical_recipes.cpp:8506</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gacac7be97c37bd2e4f801976749de839c"><div class="ttname"><a href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a></div><div class="ttdeci">#define DIRECT_A3D_ELEM(v, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00249">multidim_array.h:249</a></div></div>
<div class="ttc" id="kerneldiff1_8h_html_a4756f1cc0a8d4379b8d31df7abdc322a"><div class="ttname"><a href="kerneldiff1_8h.html#a4756f1cc0a8d4379b8d31df7abdc322a">BSPLINE03DIFF1</a></div><div class="ttdeci">#define BSPLINE03DIFF1(y, x)</div><div class="ttdef"><b>Definition:</b> <a href="kerneldiff1_8h_source.html#l00060">kerneldiff1.h:60</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__KernelDefinition_html_ga7735a4dada77ad119562083b16b65523"><div class="ttname"><a href="group__KernelDefinition.html#ga7735a4dada77ad119562083b16b65523">Bspline04</a></div><div class="ttdeci">double Bspline04(double Argument)</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="group__KernelDefinition_html_gac15ac191df9734bd90df659e98284f41"><div class="ttname"><a href="group__KernelDefinition.html#gac15ac191df9734bd90df659e98284f41">Bspline07</a></div><div class="ttdeci">double Bspline07(double Argument)</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aa508e3dbd0e86258b5c69e8a8b6b8295"><div class="ttname"><a href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08509">numerical_recipes.cpp:8509</a></div></div>
<div class="ttc" id="group__KernelDefinition_html_ga38406ca5c4cd9600f103dbaa34171390"><div class="ttname"><a href="group__KernelDefinition.html#ga38406ca5c4cd9600f103dbaa34171390">Bspline08</a></div><div class="ttdeci">double Bspline08(double Argument)</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a438c75002165fed58970c95d67a268c1"><div class="ttname"><a href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a></div><div class="ttdeci">int m</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="group__KernelDefinition_html_gaa92a7fe60e1322678e95722660710dde"><div class="ttname"><a href="group__KernelDefinition.html#gaa92a7fe60e1322678e95722660710dde">Bspline02</a></div><div class="ttdeci">double Bspline02(double Argument)</div></div>
<div class="ttc" id="group__KernelDefinition_html_ga32d62f1a4548fa42a191f36e14116a5a"><div class="ttname"><a href="group__KernelDefinition.html#ga32d62f1a4548fa42a191f36e14116a5a">Bspline09</a></div><div class="ttdeci">double Bspline09(double Argument)</div></div>
<div class="ttc" id="group__KernelDefinition_html_ga2ea30a01ce9a0bea67dc6a116be4d90f"><div class="ttname"><a href="group__KernelDefinition.html#ga2ea30a01ce9a0bea67dc6a116be4d90f">Bspline06</a></div><div class="ttdeci">double Bspline06(double Argument)</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="group__KernelDefinition_html_ga3edb5be6b31f9ddc44ef4f4ce1e419d8"><div class="ttname"><a href="group__KernelDefinition.html#ga3edb5be6b31f9ddc44ef4f4ce1e419d8">BSPLINE03</a></div><div class="ttdeci">#define BSPLINE03(y, x)</div><div class="ttdef"><b>Definition:</b> <a href="kernel_8h_source.html#l00083">kernel.h:83</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga466e6163a69aba9fd7c3f10177b3d6ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double interpolatedElementBSplineDiffY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Interpolates the value of the 3D matrix M at the point (x,y,z) knowing that this image is a set of B-spline coefficients. And making the diff of y, such-&gt; V=sum(Coef Bx diff(By) Bz) Only for BSplines of degree 3!!</p>
<p>(x,y,z) are in logical coordinates. </p>

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00857">857</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;{</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="keywordtype">int</span> SplineDegree_1 = SplineDegree - 1;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keywordtype">double</span> aux;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="comment">// Logical to physical</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> -= <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(vol);</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> -= <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(vol);</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> -= <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(vol);</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordtype">int</span> l1 = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> - SplineDegree_1);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="keywordtype">int</span> l2 = l1 + SplineDegree;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keywordtype">int</span> m1 = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> - SplineDegree_1);</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keywordtype">int</span> m2 = m1 + SplineDegree;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="keywordtype">int</span> n1 = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> - SplineDegree_1);</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordtype">int</span> n2 = n1 + SplineDegree;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keywordtype">double</span> zyxsum = 0.0;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordtype">int</span> Zdim=(int)<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(vol);</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordtype">int</span> Ydim=(int)<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(vol);</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="keywordtype">int</span> Xdim=(int)<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(vol);</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = n1; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> &lt;= n2; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>++)</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    {</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <span class="keywordtype">int</span> equivalent_n=<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <span class="keywordflow">if</span>      (<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>&lt;0)</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            equivalent_n=-<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>-1;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>&gt;=Zdim)</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            equivalent_n=2*Zdim-<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>-1;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <span class="keywordtype">double</span> yxsum = 0.0;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> = m1; <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> &lt;= m2; <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>++)</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        {</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;            <span class="keywordtype">int</span> equivalent_m=<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            <span class="keywordflow">if</span>      (<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>&lt;0)</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                equivalent_m=-<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>-1;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>&gt;=Ydim)</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                equivalent_m=2*Ydim-<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>-1;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            <span class="keywordtype">double</span> xsum = 0.0;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = l1; l &lt;= l2; l++)</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            {</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                <span class="keywordtype">double</span> xminusl = <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> - (double) l;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                <span class="keywordtype">int</span> equivalent_l=l;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                <span class="keywordflow">if</span>      (l&lt;0)</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                    equivalent_l=-l-1;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (l&gt;=Xdim)</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                    equivalent_l=2*Xdim-l-1;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                <span class="keywordtype">double</span> Coeff = (double) <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(vol, equivalent_n,</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                                                             equivalent_m,</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                                                             equivalent_l );</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                <span class="keywordtype">double</span> aux;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                <span class="keywordflow">switch</span> (SplineDegree)</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                {</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                    xsum += Coeff * <a class="code" href="group__KernelDefinition.html#gaa92a7fe60e1322678e95722660710dde">Bspline02</a>(xminusl);</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                    <a class="code" href="group__KernelDefinition.html#ga3edb5be6b31f9ddc44ef4f4ce1e419d8">BSPLINE03</a>(aux,xminusl);</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                    xsum += Coeff * aux;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                    xsum += Coeff * <a class="code" href="group__KernelDefinition.html#ga7735a4dada77ad119562083b16b65523">Bspline04</a>(xminusl);</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                    xsum += Coeff * <a class="code" href="group__KernelDefinition.html#gaf4b9554342b12659737e4ed7130eaa7b">Bspline05</a>(xminusl);</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                    xsum += Coeff * <a class="code" href="group__KernelDefinition.html#ga2ea30a01ce9a0bea67dc6a116be4d90f">Bspline06</a>(xminusl);</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                    xsum += Coeff * <a class="code" href="group__KernelDefinition.html#gac15ac191df9734bd90df659e98284f41">Bspline07</a>(xminusl);</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                    xsum += Coeff * <a class="code" href="group__KernelDefinition.html#ga38406ca5c4cd9600f103dbaa34171390">Bspline08</a>(xminusl);</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                <span class="keywordflow">case</span> 9:</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                    xsum += Coeff * <a class="code" href="group__KernelDefinition.html#ga32d62f1a4548fa42a191f36e14116a5a">Bspline09</a>(xminusl);</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                }</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            }</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            <span class="keywordtype">double</span> yminusm = <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> - (double) m;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            <span class="keywordflow">switch</span> (SplineDegree)</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            {</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                yxsum += xsum * <a class="code" href="group__KernelDefinition.html#gaa92a7fe60e1322678e95722660710dde">Bspline02</a>(yminusm);</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                <a class="code" href="kerneldiff1_8h.html#a4756f1cc0a8d4379b8d31df7abdc322a">BSPLINE03DIFF1</a>(aux,yminusm);</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                yxsum += xsum * aux;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                yxsum += xsum * <a class="code" href="group__KernelDefinition.html#ga7735a4dada77ad119562083b16b65523">Bspline04</a>(yminusm);</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;            <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                yxsum += xsum * <a class="code" href="group__KernelDefinition.html#gaf4b9554342b12659737e4ed7130eaa7b">Bspline05</a>(yminusm);</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                yxsum += xsum * <a class="code" href="group__KernelDefinition.html#ga2ea30a01ce9a0bea67dc6a116be4d90f">Bspline06</a>(yminusm);</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                yxsum += xsum * <a class="code" href="group__KernelDefinition.html#gac15ac191df9734bd90df659e98284f41">Bspline07</a>(yminusm);</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                yxsum += xsum * <a class="code" href="group__KernelDefinition.html#ga38406ca5c4cd9600f103dbaa34171390">Bspline08</a>(yminusm);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            <span class="keywordflow">case</span> 9:</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                yxsum += xsum * <a class="code" href="group__KernelDefinition.html#ga32d62f1a4548fa42a191f36e14116a5a">Bspline09</a>(yminusm);</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            }</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        }</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="keywordtype">double</span> zminusn = <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> - (double) n;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="keywordflow">switch</span> (SplineDegree)</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        {</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            zyxsum += yxsum * <a class="code" href="group__KernelDefinition.html#gaa92a7fe60e1322678e95722660710dde">Bspline02</a>(zminusn);</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            <a class="code" href="group__KernelDefinition.html#ga3edb5be6b31f9ddc44ef4f4ce1e419d8">BSPLINE03</a>(aux,zminusn);</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            zyxsum += yxsum * aux;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            zyxsum += yxsum * <a class="code" href="group__KernelDefinition.html#ga7735a4dada77ad119562083b16b65523">Bspline04</a>(zminusn);</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            zyxsum += yxsum * <a class="code" href="group__KernelDefinition.html#gaf4b9554342b12659737e4ed7130eaa7b">Bspline05</a>(zminusn);</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            zyxsum += yxsum * <a class="code" href="group__KernelDefinition.html#ga2ea30a01ce9a0bea67dc6a116be4d90f">Bspline06</a>(zminusn);</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            zyxsum += yxsum * <a class="code" href="group__KernelDefinition.html#gac15ac191df9734bd90df659e98284f41">Bspline07</a>(zminusn);</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            zyxsum += yxsum * <a class="code" href="group__KernelDefinition.html#ga38406ca5c4cd9600f103dbaa34171390">Bspline08</a>(zminusn);</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <span class="keywordflow">case</span> 9:</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            zyxsum += yxsum * <a class="code" href="group__KernelDefinition.html#ga32d62f1a4548fa42a191f36e14116a5a">Bspline09</a>(zminusn);</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        }</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    }</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keywordflow">return</span> zyxsum;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;}</div><div class="ttc" id="group__KernelDefinition_html_gaf4b9554342b12659737e4ed7130eaa7b"><div class="ttname"><a href="group__KernelDefinition.html#gaf4b9554342b12659737e4ed7130eaa7b">Bspline05</a></div><div class="ttdeci">double Bspline05(double Argument)</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad919bbce6f061400a0bc5231a9cd1621"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a></div><div class="ttdeci">static double * y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08506">numerical_recipes.cpp:8506</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gacac7be97c37bd2e4f801976749de839c"><div class="ttname"><a href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a></div><div class="ttdeci">#define DIRECT_A3D_ELEM(v, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00249">multidim_array.h:249</a></div></div>
<div class="ttc" id="kerneldiff1_8h_html_a4756f1cc0a8d4379b8d31df7abdc322a"><div class="ttname"><a href="kerneldiff1_8h.html#a4756f1cc0a8d4379b8d31df7abdc322a">BSPLINE03DIFF1</a></div><div class="ttdeci">#define BSPLINE03DIFF1(y, x)</div><div class="ttdef"><b>Definition:</b> <a href="kerneldiff1_8h_source.html#l00060">kerneldiff1.h:60</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__KernelDefinition_html_ga7735a4dada77ad119562083b16b65523"><div class="ttname"><a href="group__KernelDefinition.html#ga7735a4dada77ad119562083b16b65523">Bspline04</a></div><div class="ttdeci">double Bspline04(double Argument)</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="group__KernelDefinition_html_gac15ac191df9734bd90df659e98284f41"><div class="ttname"><a href="group__KernelDefinition.html#gac15ac191df9734bd90df659e98284f41">Bspline07</a></div><div class="ttdeci">double Bspline07(double Argument)</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aa508e3dbd0e86258b5c69e8a8b6b8295"><div class="ttname"><a href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08509">numerical_recipes.cpp:8509</a></div></div>
<div class="ttc" id="group__KernelDefinition_html_ga38406ca5c4cd9600f103dbaa34171390"><div class="ttname"><a href="group__KernelDefinition.html#ga38406ca5c4cd9600f103dbaa34171390">Bspline08</a></div><div class="ttdeci">double Bspline08(double Argument)</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a438c75002165fed58970c95d67a268c1"><div class="ttname"><a href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a></div><div class="ttdeci">int m</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="group__KernelDefinition_html_gaa92a7fe60e1322678e95722660710dde"><div class="ttname"><a href="group__KernelDefinition.html#gaa92a7fe60e1322678e95722660710dde">Bspline02</a></div><div class="ttdeci">double Bspline02(double Argument)</div></div>
<div class="ttc" id="group__KernelDefinition_html_ga32d62f1a4548fa42a191f36e14116a5a"><div class="ttname"><a href="group__KernelDefinition.html#ga32d62f1a4548fa42a191f36e14116a5a">Bspline09</a></div><div class="ttdeci">double Bspline09(double Argument)</div></div>
<div class="ttc" id="group__KernelDefinition_html_ga2ea30a01ce9a0bea67dc6a116be4d90f"><div class="ttname"><a href="group__KernelDefinition.html#ga2ea30a01ce9a0bea67dc6a116be4d90f">Bspline06</a></div><div class="ttdeci">double Bspline06(double Argument)</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="group__KernelDefinition_html_ga3edb5be6b31f9ddc44ef4f4ce1e419d8"><div class="ttname"><a href="group__KernelDefinition.html#ga3edb5be6b31f9ddc44ef4f4ce1e419d8">BSPLINE03</a></div><div class="ttdeci">#define BSPLINE03(y, x)</div><div class="ttdef"><b>Definition:</b> <a href="kernel_8h_source.html#l00083">kernel.h:83</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga3fea9b979171920f6d72ceb1317220f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double interpolatedElementBSplineDiffZ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Interpolates the value of the 3D matrix M at the point (x,y,z) knowing that this image is a set of B-spline coefficients. And making the diff of z, such-&gt; V=sum(Coef Bx By diff(Bz)) Only for BSplines of degree 3!!</p>
<p>(x,y,z) are in logical coordinates. </p>

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l01013">1013</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;{</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="keywordtype">int</span> SplineDegree_1 = SplineDegree - 1;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="keywordtype">double</span> aux;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="comment">// Logical to physical</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> -= <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(vol);</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> -= <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(vol);</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> -= <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(vol);</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keywordtype">int</span> l1 = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> - SplineDegree_1);</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="keywordtype">int</span> l2 = l1 + SplineDegree;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keywordtype">int</span> m1 = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> - SplineDegree_1);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="keywordtype">int</span> m2 = m1 + SplineDegree;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordtype">int</span> n1 = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> - SplineDegree_1);</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="keywordtype">int</span> n2 = n1 + SplineDegree;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="keywordtype">double</span> zyxsum = 0.0;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="keywordtype">int</span> Zdim=(int)<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(vol);</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="keywordtype">int</span> Ydim=(int)<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(vol);</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordtype">int</span> Xdim=(int)<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(vol);</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = n1; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> &lt;= n2; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>++)</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    {</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        <span class="keywordtype">int</span> equivalent_n=<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <span class="keywordflow">if</span>      (<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>&lt;0)</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            equivalent_n=-<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>-1;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>&gt;=Zdim)</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;            equivalent_n=2*Zdim-<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>-1;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <span class="keywordtype">double</span> yxsum = 0.0;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> = m1; <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> &lt;= m2; <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>++)</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        {</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;            <span class="keywordtype">int</span> equivalent_m=<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;            <span class="keywordflow">if</span>      (<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>&lt;0)</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                equivalent_m=-<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>-1;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>&gt;=Ydim)</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                equivalent_m=2*Ydim-<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>-1;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;            <span class="keywordtype">double</span> xsum = 0.0;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = l1; l &lt;= l2; l++)</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;            {</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                <span class="keywordtype">double</span> xminusl = <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> - (double) l;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                <span class="keywordtype">int</span> equivalent_l=l;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                <span class="keywordflow">if</span>      (l&lt;0)</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                    equivalent_l=-l-1;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (l&gt;=Xdim)</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                    equivalent_l=2*Xdim-l-1;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                <span class="keywordtype">double</span> Coeff = (double) <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(vol, equivalent_n,</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                                                             equivalent_m,</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                                                             equivalent_l );</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                <span class="keywordtype">double</span> aux;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                <span class="keywordflow">switch</span> (SplineDegree)</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                {</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                    xsum += Coeff * <a class="code" href="group__KernelDefinition.html#gaa92a7fe60e1322678e95722660710dde">Bspline02</a>(xminusl);</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                    <a class="code" href="group__KernelDefinition.html#ga3edb5be6b31f9ddc44ef4f4ce1e419d8">BSPLINE03</a>(aux,xminusl);</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                    xsum += Coeff * aux;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                    xsum += Coeff * <a class="code" href="group__KernelDefinition.html#ga7735a4dada77ad119562083b16b65523">Bspline04</a>(xminusl);</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                    xsum += Coeff * <a class="code" href="group__KernelDefinition.html#gaf4b9554342b12659737e4ed7130eaa7b">Bspline05</a>(xminusl);</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                    xsum += Coeff * <a class="code" href="group__KernelDefinition.html#ga2ea30a01ce9a0bea67dc6a116be4d90f">Bspline06</a>(xminusl);</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                    xsum += Coeff * <a class="code" href="group__KernelDefinition.html#gac15ac191df9734bd90df659e98284f41">Bspline07</a>(xminusl);</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                    xsum += Coeff * <a class="code" href="group__KernelDefinition.html#ga38406ca5c4cd9600f103dbaa34171390">Bspline08</a>(xminusl);</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                <span class="keywordflow">case</span> 9:</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                    xsum += Coeff * <a class="code" href="group__KernelDefinition.html#ga32d62f1a4548fa42a191f36e14116a5a">Bspline09</a>(xminusl);</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                }</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            }</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            <span class="keywordtype">double</span> yminusm = <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> - (double) m;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            <span class="keywordflow">switch</span> (SplineDegree)</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            {</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;            <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                yxsum += xsum * <a class="code" href="group__KernelDefinition.html#gaa92a7fe60e1322678e95722660710dde">Bspline02</a>(yminusm);</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                <a class="code" href="group__KernelDefinition.html#ga3edb5be6b31f9ddc44ef4f4ce1e419d8">BSPLINE03</a>(aux,yminusm);</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                yxsum += xsum * aux;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                yxsum += xsum * <a class="code" href="group__KernelDefinition.html#ga7735a4dada77ad119562083b16b65523">Bspline04</a>(yminusm);</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                yxsum += xsum * <a class="code" href="group__KernelDefinition.html#gaf4b9554342b12659737e4ed7130eaa7b">Bspline05</a>(yminusm);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;            <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                yxsum += xsum * <a class="code" href="group__KernelDefinition.html#ga2ea30a01ce9a0bea67dc6a116be4d90f">Bspline06</a>(yminusm);</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                yxsum += xsum * <a class="code" href="group__KernelDefinition.html#gac15ac191df9734bd90df659e98284f41">Bspline07</a>(yminusm);</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                yxsum += xsum * <a class="code" href="group__KernelDefinition.html#ga38406ca5c4cd9600f103dbaa34171390">Bspline08</a>(yminusm);</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            <span class="keywordflow">case</span> 9:</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                yxsum += xsum * <a class="code" href="group__KernelDefinition.html#ga32d62f1a4548fa42a191f36e14116a5a">Bspline09</a>(yminusm);</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;            }</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        }</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <span class="keywordtype">double</span> zminusn = <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> - (double) n;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        <span class="keywordflow">switch</span> (SplineDegree)</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        {</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            zyxsum += yxsum * <a class="code" href="group__KernelDefinition.html#gaa92a7fe60e1322678e95722660710dde">Bspline02</a>(zminusn);</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;            <a class="code" href="kerneldiff1_8h.html#a4756f1cc0a8d4379b8d31df7abdc322a">BSPLINE03DIFF1</a>(aux,zminusn);</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;            zyxsum += yxsum * aux;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            zyxsum += yxsum * <a class="code" href="group__KernelDefinition.html#ga7735a4dada77ad119562083b16b65523">Bspline04</a>(zminusn);</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;            zyxsum += yxsum * <a class="code" href="group__KernelDefinition.html#gaf4b9554342b12659737e4ed7130eaa7b">Bspline05</a>(zminusn);</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            zyxsum += yxsum * <a class="code" href="group__KernelDefinition.html#ga2ea30a01ce9a0bea67dc6a116be4d90f">Bspline06</a>(zminusn);</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            zyxsum += yxsum * <a class="code" href="group__KernelDefinition.html#gac15ac191df9734bd90df659e98284f41">Bspline07</a>(zminusn);</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;            zyxsum += yxsum * <a class="code" href="group__KernelDefinition.html#ga38406ca5c4cd9600f103dbaa34171390">Bspline08</a>(zminusn);</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        <span class="keywordflow">case</span> 9:</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;            zyxsum += yxsum * <a class="code" href="group__KernelDefinition.html#ga32d62f1a4548fa42a191f36e14116a5a">Bspline09</a>(zminusn);</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        }</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    }</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="keywordflow">return</span> zyxsum;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;}</div><div class="ttc" id="group__KernelDefinition_html_gaf4b9554342b12659737e4ed7130eaa7b"><div class="ttname"><a href="group__KernelDefinition.html#gaf4b9554342b12659737e4ed7130eaa7b">Bspline05</a></div><div class="ttdeci">double Bspline05(double Argument)</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad919bbce6f061400a0bc5231a9cd1621"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a></div><div class="ttdeci">static double * y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08506">numerical_recipes.cpp:8506</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gacac7be97c37bd2e4f801976749de839c"><div class="ttname"><a href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a></div><div class="ttdeci">#define DIRECT_A3D_ELEM(v, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00249">multidim_array.h:249</a></div></div>
<div class="ttc" id="kerneldiff1_8h_html_a4756f1cc0a8d4379b8d31df7abdc322a"><div class="ttname"><a href="kerneldiff1_8h.html#a4756f1cc0a8d4379b8d31df7abdc322a">BSPLINE03DIFF1</a></div><div class="ttdeci">#define BSPLINE03DIFF1(y, x)</div><div class="ttdef"><b>Definition:</b> <a href="kerneldiff1_8h_source.html#l00060">kerneldiff1.h:60</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__KernelDefinition_html_ga7735a4dada77ad119562083b16b65523"><div class="ttname"><a href="group__KernelDefinition.html#ga7735a4dada77ad119562083b16b65523">Bspline04</a></div><div class="ttdeci">double Bspline04(double Argument)</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="group__KernelDefinition_html_gac15ac191df9734bd90df659e98284f41"><div class="ttname"><a href="group__KernelDefinition.html#gac15ac191df9734bd90df659e98284f41">Bspline07</a></div><div class="ttdeci">double Bspline07(double Argument)</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aa508e3dbd0e86258b5c69e8a8b6b8295"><div class="ttname"><a href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08509">numerical_recipes.cpp:8509</a></div></div>
<div class="ttc" id="group__KernelDefinition_html_ga38406ca5c4cd9600f103dbaa34171390"><div class="ttname"><a href="group__KernelDefinition.html#ga38406ca5c4cd9600f103dbaa34171390">Bspline08</a></div><div class="ttdeci">double Bspline08(double Argument)</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a438c75002165fed58970c95d67a268c1"><div class="ttname"><a href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a></div><div class="ttdeci">int m</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="group__KernelDefinition_html_gaa92a7fe60e1322678e95722660710dde"><div class="ttname"><a href="group__KernelDefinition.html#gaa92a7fe60e1322678e95722660710dde">Bspline02</a></div><div class="ttdeci">double Bspline02(double Argument)</div></div>
<div class="ttc" id="group__KernelDefinition_html_ga32d62f1a4548fa42a191f36e14116a5a"><div class="ttname"><a href="group__KernelDefinition.html#ga32d62f1a4548fa42a191f36e14116a5a">Bspline09</a></div><div class="ttdeci">double Bspline09(double Argument)</div></div>
<div class="ttc" id="group__KernelDefinition_html_ga2ea30a01ce9a0bea67dc6a116be4d90f"><div class="ttname"><a href="group__KernelDefinition.html#ga2ea30a01ce9a0bea67dc6a116be4d90f">Bspline06</a></div><div class="ttdeci">double Bspline06(double Argument)</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="group__KernelDefinition_html_ga3edb5be6b31f9ddc44ef4f4ce1e419d8"><div class="ttname"><a href="group__KernelDefinition.html#ga3edb5be6b31f9ddc44ef4f4ce1e419d8">BSPLINE03</a></div><div class="ttdeci">#define BSPLINE03(y, x)</div><div class="ttdef"><b>Definition:</b> <a href="kernel_8h_source.html#l00083">kernel.h:83</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga030ed19c9f38989bbec4eb4c24ee89c1"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void produceImageFromSplineCoefficients </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>coeffs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Produce image from B-spline coefficients.</p>
<p>Note that the coeffs and img are only single images! </p>

<p>Definition at line <a class="el" href="transformations_8h_source.html#l01071">1071</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;{</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; double &gt;</a> imgD;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    imgD.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(coeffs), <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(coeffs), <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(coeffs));</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(img) = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(coeffs);</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(img) = <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(coeffs);</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(img) = <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(coeffs);</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordtype">int</span> Status;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; double &gt;</a> aux(coeffs);</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <a class="code" href="group__SplineTransform.html#gaf907a9485caaa67d3acdd3589027b997">ChangeBasisVolume</a>(<a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(aux), <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(imgD),</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                      <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(coeffs), <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(coeffs), <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(coeffs),</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                      <a class="code" href="tsplinebasis_8h.html#ad96eae98eadf5f9a917db20a01f3adcfadcbb18860ce3e167218aea7208733c47">BasicSpline</a>, <a class="code" href="tsplinebasis_8h.html#ad96eae98eadf5f9a917db20a01f3adcfaa5df2d839669e9b5cab078253a59ab86">CardinalSpline</a>, SplineDegree,</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                      <a class="code" href="tboundaryconvention_8h.html#af25f266c9d72869e10586cdf8d2259c9a042af3d148879796cf09929b3bdd0961">MirrorOnBounds</a>, <a class="code" href="transformations_8h.html#ab701824136346377b44fc3adb8050b29">DBL_EPSILON</a>, &amp;Status);</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="keywordflow">if</span> (Status)</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa60458766acaafb3722c0234011bbdbf8">ERR_UNCLASSIFIED</a>, <span class="stringliteral">&quot;Error in ImageFromSplineCoefficients...&quot;</span>);</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <a class="code" href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a>(imgD, img);</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa60458766acaafb3722c0234011bbdbf8"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa60458766acaafb3722c0234011bbdbf8">ERR_UNCLASSIFIED</a></div><div class="ttdoc">Just to locate unclassified errors. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00197">xmipp_error.h:197</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gac87b223f03097d45f776b44b6aeea9f7"><div class="ttname"><a href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a></div><div class="ttdeci">#define MULTIDIM_ARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00136">multidim_array.h:136</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="tsplinebasis_8h_html_ad96eae98eadf5f9a917db20a01f3adcfadcbb18860ce3e167218aea7208733c47"><div class="ttname"><a href="tsplinebasis_8h.html#ad96eae98eadf5f9a917db20a01f3adcfadcbb18860ce3e167218aea7208733c47">BasicSpline</a></div><div class="ttdef"><b>Definition:</b> <a href="tsplinebasis_8h_source.html#l00009">tsplinebasis.h:9</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="tboundaryconvention_8h_html_af25f266c9d72869e10586cdf8d2259c9a042af3d148879796cf09929b3bdd0961"><div class="ttname"><a href="tboundaryconvention_8h.html#af25f266c9d72869e10586cdf8d2259c9a042af3d148879796cf09929b3bdd0961">MirrorOnBounds</a></div><div class="ttdef"><b>Definition:</b> <a href="tboundaryconvention_8h_source.html#l00013">tboundaryconvention.h:13</a></div></div>
<div class="ttc" id="transformations_8h_html_ab701824136346377b44fc3adb8050b29"><div class="ttname"><a href="transformations_8h.html#ab701824136346377b44fc3adb8050b29">DBL_EPSILON</a></div><div class="ttdeci">#define DBL_EPSILON</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00045">transformations.h:45</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="group__Vectors_html_gaf36b657319bb585c75cfa14744dab275"><div class="ttname"><a href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a></div><div class="ttdeci">void typeCast(const Matrix1D&lt; T1 &gt; &amp;v1, Matrix1D&lt; T2 &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01904">matrix1d.h:1904</a></div></div>
<div class="ttc" id="tsplinebasis_8h_html_ad96eae98eadf5f9a917db20a01f3adcfaa5df2d839669e9b5cab078253a59ab86"><div class="ttname"><a href="tsplinebasis_8h.html#ad96eae98eadf5f9a917db20a01f3adcfaa5df2d839669e9b5cab078253a59ab86">CardinalSpline</a></div><div class="ttdef"><b>Definition:</b> <a href="tsplinebasis_8h_source.html#l00010">tsplinebasis.h:10</a></div></div>
<div class="ttc" id="group__SplineTransform_html_gaf907a9485caaa67d3acdd3589027b997"><div class="ttname"><a href="group__SplineTransform.html#gaf907a9485caaa67d3acdd3589027b997">ChangeBasisVolume</a></div><div class="ttdeci">int ChangeBasisVolume(double *VolumeSource, double *VolumeDestination, long Nx, long Ny, long Nz, enum TSplineBasis FromBasis, enum TSplineBasis ToBasis, long Degree, enum TBoundaryConvention Convention, double Tolerance, int *Status)</div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga098f5c8e7e9c010a3bf7ab82e31828a8"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void produceSplineCoefficients </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>coeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Produce spline coefficients.</p>
<p>Create a single image with spline coefficients for the nth image </p>

<p>Definition at line <a class="el" href="transformations_8h_source.html#l01039">1039</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;{</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    coeffs.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(V1), <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(V1), <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V1));</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(coeffs) = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(V1);</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(coeffs) = <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(V1);</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(coeffs) = <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(V1);</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="keywordtype">int</span> Status;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; double &gt;</a> aux;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <a class="code" href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a>(V1, aux); <span class="comment">// This will create a single volume!</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <a class="code" href="group__SplineTransform.html#gaf907a9485caaa67d3acdd3589027b997">ChangeBasisVolume</a>(<a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(aux), <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(coeffs),</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                      <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V1), <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(V1), <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(V1),</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                      <a class="code" href="tsplinebasis_8h.html#ad96eae98eadf5f9a917db20a01f3adcfaa5df2d839669e9b5cab078253a59ab86">CardinalSpline</a>, <a class="code" href="tsplinebasis_8h.html#ad96eae98eadf5f9a917db20a01f3adcfadcbb18860ce3e167218aea7208733c47">BasicSpline</a>, SplineDegree,</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                      <a class="code" href="tboundaryconvention_8h.html#af25f266c9d72869e10586cdf8d2259c9a7b091f41d7873c43ea6778c42d16c98c">MirrorOffBounds</a>, <a class="code" href="transformations_8h.html#ab701824136346377b44fc3adb8050b29">DBL_EPSILON</a>, &amp;Status);</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="keywordflow">if</span> (Status)</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa60458766acaafb3722c0234011bbdbf8">ERR_UNCLASSIFIED</a>, <span class="stringliteral">&quot;Error in produceSplineCoefficients...&quot;</span>);</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa60458766acaafb3722c0234011bbdbf8"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa60458766acaafb3722c0234011bbdbf8">ERR_UNCLASSIFIED</a></div><div class="ttdoc">Just to locate unclassified errors. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00197">xmipp_error.h:197</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gac87b223f03097d45f776b44b6aeea9f7"><div class="ttname"><a href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a></div><div class="ttdeci">#define MULTIDIM_ARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00136">multidim_array.h:136</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="tsplinebasis_8h_html_ad96eae98eadf5f9a917db20a01f3adcfadcbb18860ce3e167218aea7208733c47"><div class="ttname"><a href="tsplinebasis_8h.html#ad96eae98eadf5f9a917db20a01f3adcfadcbb18860ce3e167218aea7208733c47">BasicSpline</a></div><div class="ttdef"><b>Definition:</b> <a href="tsplinebasis_8h_source.html#l00009">tsplinebasis.h:9</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="transformations_8h_html_ab701824136346377b44fc3adb8050b29"><div class="ttname"><a href="transformations_8h.html#ab701824136346377b44fc3adb8050b29">DBL_EPSILON</a></div><div class="ttdeci">#define DBL_EPSILON</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00045">transformations.h:45</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="group__Vectors_html_gaf36b657319bb585c75cfa14744dab275"><div class="ttname"><a href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a></div><div class="ttdeci">void typeCast(const Matrix1D&lt; T1 &gt; &amp;v1, Matrix1D&lt; T2 &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01904">matrix1d.h:1904</a></div></div>
<div class="ttc" id="tsplinebasis_8h_html_ad96eae98eadf5f9a917db20a01f3adcfaa5df2d839669e9b5cab078253a59ab86"><div class="ttname"><a href="tsplinebasis_8h.html#ad96eae98eadf5f9a917db20a01f3adcfaa5df2d839669e9b5cab078253a59ab86">CardinalSpline</a></div><div class="ttdef"><b>Definition:</b> <a href="tsplinebasis_8h_source.html#l00010">tsplinebasis.h:10</a></div></div>
<div class="ttc" id="tboundaryconvention_8h_html_af25f266c9d72869e10586cdf8d2259c9a7b091f41d7873c43ea6778c42d16c98c"><div class="ttname"><a href="tboundaryconvention_8h.html#af25f266c9d72869e10586cdf8d2259c9a7b091f41d7873c43ea6778c42d16c98c">MirrorOffBounds</a></div><div class="ttdef"><b>Definition:</b> <a href="tboundaryconvention_8h_source.html#l00012">tboundaryconvention.h:12</a></div></div>
<div class="ttc" id="group__SplineTransform_html_gaf907a9485caaa67d3acdd3589027b997"><div class="ttname"><a href="group__SplineTransform.html#gaf907a9485caaa67d3acdd3589027b997">ChangeBasisVolume</a></div><div class="ttdeci">int ChangeBasisVolume(double *VolumeSource, double *VolumeDestination, long Nx, long Ny, long Nz, enum TSplineBasis FromBasis, enum TSplineBasis ToBasis, long Degree, enum TBoundaryConvention Convention, double Tolerance, int *Status)</div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga007f6aec56f2b0abdb6f4903a22cedf0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void produceSplineCoefficients </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>coeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00576">576</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;{</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">// TODO Implement</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa5bed3f42a08e195b307cf8622e913327">ERR_NOT_IMPLEMENTED</a>,<span class="stringliteral">&quot;Spline coefficients of a complex matrix is not implemented.&quot;</span>);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa5bed3f42a08e195b307cf8622e913327"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa5bed3f42a08e195b307cf8622e913327">ERR_NOT_IMPLEMENTED</a></div><div class="ttdoc">Case or algorithm not implemented yet. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00182">xmipp_error.h:182</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga4244b45bd0344100b4e2e868a2b403af"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void pyramidExpand </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>levels</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Expand the nth volume by 2 using a BSpline pyramid. </p>

<p>Definition at line <a class="el" href="transformations_8h_source.html#l01504">1504</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;{</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; double &gt;</a> coeffs, coeffs2;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga098f5c8e7e9c010a3bf7ab82e31828a8">produceSplineCoefficients</a>(SplineDegree, coeffs, V1);</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; levels; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    {</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga87de8035e86a51972bdf358690e427a9">expandBSpline</a>(SplineDegree, coeffs2, coeffs);</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        coeffs = coeffs2;</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    }</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga030ed19c9f38989bbec4eb4c24ee89c1">produceImageFromSplineCoefficients</a>(SplineDegree, V2, coeffs);</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga87de8035e86a51972bdf358690e427a9"><div class="ttname"><a href="group__GeometricalTransformations.html#ga87de8035e86a51972bdf358690e427a9">expandBSpline</a></div><div class="ttdeci">void expandBSpline(int SplineDegree, MultidimArray&lt; double &gt; &amp;V2, const MultidimArray&lt; T &gt; &amp;V1)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01423">transformations.h:1423</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga098f5c8e7e9c010a3bf7ab82e31828a8"><div class="ttname"><a href="group__GeometricalTransformations.html#ga098f5c8e7e9c010a3bf7ab82e31828a8">produceSplineCoefficients</a></div><div class="ttdeci">void produceSplineCoefficients(int SplineDegree, MultidimArray&lt; double &gt; &amp;coeffs, const MultidimArray&lt; T &gt; &amp;V1)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01039">transformations.h:1039</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga030ed19c9f38989bbec4eb4c24ee89c1"><div class="ttname"><a href="group__GeometricalTransformations.html#ga030ed19c9f38989bbec4eb4c24ee89c1">produceImageFromSplineCoefficients</a></div><div class="ttdeci">void produceImageFromSplineCoefficients(int SplineDegree, MultidimArray&lt; T &gt; &amp;img, const MultidimArray&lt; double &gt; &amp;coeffs)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01071">transformations.h:1071</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga0f9e6b3f1bd59388f7e5db78a37fa298"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pyramidExpand </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;&#160;</td>
          <td class="paramname"><em>V2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>levels</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00668">668</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;{</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="keywordflow">if</span> (V1.<a class="code" href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">datatype</a> != V2.<a class="code" href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">datatype</a>)</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aac2c1f1c6c03ba33fc7530b58babe0ed5">ERR_PARAM_INCORRECT</a>, <span class="stringliteral">&quot;pyramidExpand: MultidimArrayGeneric requires same datatype&quot;</span>);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="preprocessor">#define PYRAMIDEXPAND(type) pyramidExpand(SplineDegree,MULTIDIM_ARRAY_TYPE(V2,type),\</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="preprocessor">                                              MULTIDIM_ARRAY_TYPE(V1,type), levels);</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <a class="code" href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a>(V1.<a class="code" href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">datatype</a>, <a class="code" href="transformations_8cpp.html#a108d268af36aef64aa47b57698466c1e">PYRAMIDEXPAND</a>)</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="preprocessor">#undef PYRAMIDEXPAND</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aac2c1f1c6c03ba33fc7530b58babe0ed5"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aac2c1f1c6c03ba33fc7530b58babe0ed5">ERR_PARAM_INCORRECT</a></div><div class="ttdoc">Parameter incorrect. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00186">xmipp_error.h:186</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="classMultidimArrayGeneric_html_a0b74b17fe8d2f77c90b1513bd795c224"><div class="ttname"><a href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">MultidimArrayGeneric::datatype</a></div><div class="ttdeci">DataType datatype</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00110">multidim_array_generic.h:110</a></div></div>
<div class="ttc" id="transformations_8cpp_html_a108d268af36aef64aa47b57698466c1e"><div class="ttname"><a href="transformations_8cpp.html#a108d268af36aef64aa47b57698466c1e">PYRAMIDEXPAND</a></div><div class="ttdeci">#define PYRAMIDEXPAND(type)</div></div>
<div class="ttc" id="multidim__array__generic_8h_html_ada27bedba7f65b4ad8fca3eb7f5ad65e"><div class="ttname"><a href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a></div><div class="ttdeci">#define SWITCHDATATYPE(datatype, OP)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00044">multidim_array_generic.h:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaa6664b10a8446559d382f093905d3dbd"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void pyramidReduce </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>levels</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reduce the nth volume by 2 using a BSpline pyramid. </p>

<p>Definition at line <a class="el" href="transformations_8h_source.html#l01461">1461</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;{</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; double &gt;</a> coeffs, coeffs2;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga098f5c8e7e9c010a3bf7ab82e31828a8">produceSplineCoefficients</a>(SplineDegree, coeffs, V1);</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; levels; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    {</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga0231e8c22c93bfa84df99d95527b7cbc">reduceBSpline</a>(SplineDegree, coeffs2, coeffs);</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        coeffs = coeffs2;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    }</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga030ed19c9f38989bbec4eb4c24ee89c1">produceImageFromSplineCoefficients</a>(SplineDegree, V2, coeffs);</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga098f5c8e7e9c010a3bf7ab82e31828a8"><div class="ttname"><a href="group__GeometricalTransformations.html#ga098f5c8e7e9c010a3bf7ab82e31828a8">produceSplineCoefficients</a></div><div class="ttdeci">void produceSplineCoefficients(int SplineDegree, MultidimArray&lt; double &gt; &amp;coeffs, const MultidimArray&lt; T &gt; &amp;V1)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01039">transformations.h:1039</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga0231e8c22c93bfa84df99d95527b7cbc"><div class="ttname"><a href="group__GeometricalTransformations.html#ga0231e8c22c93bfa84df99d95527b7cbc">reduceBSpline</a></div><div class="ttdeci">void reduceBSpline(int SplineDegree, MultidimArray&lt; double &gt; &amp;V2, const MultidimArray&lt; T &gt; &amp;V1)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01360">transformations.h:1360</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga030ed19c9f38989bbec4eb4c24ee89c1"><div class="ttname"><a href="group__GeometricalTransformations.html#ga030ed19c9f38989bbec4eb4c24ee89c1">produceImageFromSplineCoefficients</a></div><div class="ttdeci">void produceImageFromSplineCoefficients(int SplineDegree, MultidimArray&lt; T &gt; &amp;img, const MultidimArray&lt; double &gt; &amp;coeffs)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01071">transformations.h:1071</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga232bc24b37c34befde0505a9dfefaca4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pyramidReduce </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;&#160;</td>
          <td class="paramname"><em>V2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>levels</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00681">681</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;{</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <span class="keywordflow">if</span> (V1.<a class="code" href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">datatype</a> != V2.<a class="code" href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">datatype</a>)</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aac2c1f1c6c03ba33fc7530b58babe0ed5">ERR_PARAM_INCORRECT</a>, <span class="stringliteral">&quot;pyramidReduce: MultidimArrayGeneric requires same datatype&quot;</span>);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="preprocessor">#define PYRAMIDREDUCE(type) pyramidReduce(SplineDegree,MULTIDIM_ARRAY_TYPE(V2,type),\</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="preprocessor">                                              MULTIDIM_ARRAY_TYPE(V1,type), levels);</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <a class="code" href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a>(V1.<a class="code" href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">datatype</a>, <a class="code" href="transformations_8cpp.html#a564fdaccbbdf060ecb99615836ef9fcb">PYRAMIDREDUCE</a>)</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="preprocessor">#undef PYRAMIDREDUCE</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aac2c1f1c6c03ba33fc7530b58babe0ed5"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aac2c1f1c6c03ba33fc7530b58babe0ed5">ERR_PARAM_INCORRECT</a></div><div class="ttdoc">Parameter incorrect. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00186">xmipp_error.h:186</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="classMultidimArrayGeneric_html_a0b74b17fe8d2f77c90b1513bd795c224"><div class="ttname"><a href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">MultidimArrayGeneric::datatype</a></div><div class="ttdeci">DataType datatype</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00110">multidim_array_generic.h:110</a></div></div>
<div class="ttc" id="transformations_8cpp_html_a564fdaccbbdf060ecb99615836ef9fcb"><div class="ttname"><a href="transformations_8cpp.html#a564fdaccbbdf060ecb99615836ef9fcb">PYRAMIDREDUCE</a></div><div class="ttdeci">#define PYRAMIDREDUCE(type)</div></div>
<div class="ttc" id="multidim__array__generic_8h_html_ada27bedba7f65b4ad8fca3eb7f5ad65e"><div class="ttname"><a href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a></div><div class="ttdeci">#define SWITCHDATATYPE(datatype, OP)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00044">multidim_array_generic.h:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga82c19639b510d33894fe268664130410"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void radialAverage </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>center_of_rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>radial_mean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>radial_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>rounding</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Does a radial average of a 2D/3D image, around the voxel where is the origin.</p>
<p>A vector radial_mean is returned where:</p><ul>
<li>the first element is the mean of the voxels whose distance to the origin is (0-1),</li>
<li>the second element is the mean of the voxels whose distance to the origin is (1-2)</li>
<li>and so on.</li>
</ul>
<p>A second vector radial_count is returned containing the number of voxels over which each radial average was calculated.</p>
<p>Sjors nov2003: if rounding=true, element=round(distance);</p><ul>
<li>so the first element is the mean of the voxels whose distance to the origin is (0.5-1.5),</li>
<li>the second element is the mean of the voxels whose distance to the origin is (1.5-2.5)</li>
<li>and so on. </li>
</ul>

<p>Definition at line <a class="el" href="transformations_8h_source.html#l01575">1575</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;{</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt; double &gt;</a> idx(3);</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    <span class="comment">// If center_of_rot was written for 2D image</span></div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    <span class="keywordflow">if</span> (center_of_rot.<a class="code" href="classMatrix1D.html#ace0d77b8d838032f071e18e450fc04e4">size</a>() &lt; 3)</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        center_of_rot.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(3);</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <span class="comment">// First determine the maximum distance that one should expect, to set the</span></div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <span class="comment">// dimension of the radial average vector</span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; int &gt;</a> distances(8);</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> = <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(m) - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(center_of_rot);</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> = <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(m) - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(center_of_rot);</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(m) - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(center_of_rot);</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    distances(0) = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(x * x + y * y + z * z));</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    x = <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(m) - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(center_of_rot);</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    distances(1) = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(x * x + y * y + z * z));</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    y = <a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(m) - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(center_of_rot);</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    distances(2) = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(x * x + y * y + z * z));</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    x = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(m) - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(center_of_rot);</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    distances(3) = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(x * x + y * y + z * z));</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    z = <a class="code" href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(m) - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(center_of_rot);</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    distances(4) = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(x * x + y * y + z * z));</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    x = <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(m) - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(center_of_rot);</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    distances(5) = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(x * x + y * y + z * z));</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    y = <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(m) - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(center_of_rot);</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    distances(6) = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(x * x + y * y + z * z));</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    x = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(m) - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(center_of_rot);</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    distances(7) = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(x * x + y * y + z * z));</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <span class="keywordtype">int</span> dim = (int) <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(distances.computeMax()) + 1;</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    <span class="keywordflow">if</span> (rounding)</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;        dim++;</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <span class="comment">// Define the vectors</span></div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    radial_mean.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(dim);</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    radial_count.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(dim);</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="comment">// Perform the radial sum and count pixels that contribute to every</span></div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="comment">// distance</span></div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(m)</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    {</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;        <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(idx) = <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(center_of_rot);</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(idx) = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(center_of_rot);</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(idx) = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(center_of_rot);</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;        <span class="comment">// Determine distance to the center</span></div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;        ;</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        <span class="keywordtype">double</span> module = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(idx)*<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(idx)+<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(idx)*<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(idx)+<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(idx)*<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(idx));</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="point_8cpp.html#adb0abda300c610b969c8be89ed30a4f6">distance</a> = (rounding) ? (<span class="keywordtype">int</span>) <a class="code" href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">round</a>(module) : (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(module);</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;        <span class="comment">// Sum te value to the pixels with the same distance</span></div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(radial_mean,distance) += <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(m, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;        <span class="comment">// Count the pixel</span></div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(radial_count,distance)++;</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    }</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <span class="comment">// Perform the mean</span></div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gaceb4070c83bd0e86e3adc96e07a32c31">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY1D</a>(radial_mean)</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;      <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(radial_count,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &gt; 0)</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(radial_mean,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) /= <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(radial_count,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;}</div><div class="ttc" id="classMatrix1D_html_ace0d77b8d838032f071e18e450fc04e4"><div class="ttname"><a href="classMatrix1D.html#ace0d77b8d838032f071e18e450fc04e4">Matrix1D::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00549">matrix1d.h:549</a></div></div>
<div class="ttc" id="point_8cpp_html_adb0abda300c610b969c8be89ed30a4f6"><div class="ttname"><a href="point_8cpp.html#adb0abda300c610b969c8be89ed30a4f6">distance</a></div><div class="ttdeci">TYPE distance(struct Point_T *p, struct Point_T *q)</div><div class="ttdef"><b>Definition:</b> <a href="point_8cpp_source.html#l00028">point.cpp:28</a></div></div>
<div class="ttc" id="cuda__basic__math_8h_html_a2065eb145275f878c1d045c9f3fb1cc7"><div class="ttname"><a href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a></div><div class="ttdeci">__host__ __device__ float2 floor(const float2 v)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__basic__math_8h_source.html#l00175">cuda_basic_math.h:175</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; int &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00279">multidim_array.h:279</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad919bbce6f061400a0bc5231a9cd1621"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a></div><div class="ttdeci">static double * y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08506">numerical_recipes.cpp:8506</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga706d2ce724d393d4d759a46225bbc6c1"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a></div><div class="ttdeci">#define FINISHINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00081">multidim_array.h:81</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00065">multidim_array.h:65</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaceb4070c83bd0e86e3adc96e07a32c31"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaceb4070c83bd0e86e3adc96e07a32c31">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY1D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00603">multidim_array.h:603</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="classMatrix1D_html_a79a482948ae334cbefaef7c7839cd934"><div class="ttname"><a href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">Matrix1D::resize</a></div><div class="ttdeci">void resize(size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00451">matrix1d.h:451</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aa508e3dbd0e86258b5c69e8a8b6b8295"><div class="ttname"><a href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08509">numerical_recipes.cpp:8509</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00073">multidim_array.h:73</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="namespacealglib_html_a43452b10ffe26174e5d328a6ceb5fa9a"><div class="ttname"><a href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">alglib::round</a></div><div class="ttdeci">int round(double x)</div><div class="ttdef"><b>Definition:</b> <a href="ap_8cpp_source.html#l07245">ap.cpp:7245</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga83ea1646b86f859b5bb17f3783fed2a3"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void radialAveragePrecomputeDistance </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>center_of_rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>distance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>rounding</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="transformations_8h_source.html#l01653">1653</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;{</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt; double &gt;</a> idx(3);</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="comment">// If center_of_rot was written for 2D image</span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <span class="keywordflow">if</span> (center_of_rot.<a class="code" href="classMatrix1D.html#ace0d77b8d838032f071e18e450fc04e4">size</a>() &lt; 3)</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;        center_of_rot.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(3);</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <span class="comment">// First determine the maximum distance that one should expect, to set the</span></div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <span class="comment">// dimension of the radial average vector</span></div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; int &gt;</a> distances(8);</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> = <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(m) - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(center_of_rot);</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> = <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(m) - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(center_of_rot);</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(m) - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(center_of_rot);</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    distances(0) = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(x * x + y * y + z * z));</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    x = <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(m) - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(center_of_rot);</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    distances(1) = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(x * x + y * y + z * z));</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    y = <a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(m) - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(center_of_rot);</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    distances(2) = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(x * x + y * y + z * z));</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    x = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(m) - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(center_of_rot);</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    distances(3) = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(x * x + y * y + z * z));</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    z = <a class="code" href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(m) - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(center_of_rot);</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    distances(4) = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(x * x + y * y + z * z));</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    x = <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(m) - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(center_of_rot);</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    distances(5) = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(x * x + y * y + z * z));</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    y = <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(m) - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(center_of_rot);</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    distances(6) = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(x * x + y * y + z * z));</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    x = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(m) - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(center_of_rot);</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    distances(7) = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(x * x + y * y + z * z));</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    dim = (int) <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(distances.computeMax()) + 1;</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="keywordflow">if</span> (rounding)</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        dim++;</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    <span class="comment">// Perform the radial sum and count pixels that contribute to every</span></div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <span class="comment">// distance</span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    distance.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(m);</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(m)</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    {</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(idx) = <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(center_of_rot);</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(idx) = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(center_of_rot);</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(idx) = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(center_of_rot);</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        <span class="comment">// Determine distance to the center</span></div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;        <span class="keywordflow">if</span> (rounding)</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(distance,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = (int) <a class="code" href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">round</a>(idx.module());</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(distance,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(idx.module());</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    }</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;}</div><div class="ttc" id="classMatrix1D_html_ace0d77b8d838032f071e18e450fc04e4"><div class="ttname"><a href="classMatrix1D.html#ace0d77b8d838032f071e18e450fc04e4">Matrix1D::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00549">matrix1d.h:549</a></div></div>
<div class="ttc" id="cuda__basic__math_8h_html_a2065eb145275f878c1d045c9f3fb1cc7"><div class="ttname"><a href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a></div><div class="ttdeci">__host__ __device__ float2 floor(const float2 v)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__basic__math_8h_source.html#l00175">cuda_basic_math.h:175</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; int &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00279">multidim_array.h:279</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad919bbce6f061400a0bc5231a9cd1621"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a></div><div class="ttdeci">static double * y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08506">numerical_recipes.cpp:8506</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga706d2ce724d393d4d759a46225bbc6c1"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a></div><div class="ttdeci">#define FINISHINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00081">multidim_array.h:81</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00065">multidim_array.h:65</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="classMatrix1D_html_a79a482948ae334cbefaef7c7839cd934"><div class="ttname"><a href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">Matrix1D::resize</a></div><div class="ttdeci">void resize(size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00451">matrix1d.h:451</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aa508e3dbd0e86258b5c69e8a8b6b8295"><div class="ttname"><a href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08509">numerical_recipes.cpp:8509</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00073">multidim_array.h:73</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="namespacealglib_html_a43452b10ffe26174e5d328a6ceb5fa9a"><div class="ttname"><a href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">alglib::round</a></div><div class="ttdeci">int round(double x)</div><div class="ttdef"><b>Definition:</b> <a href="ap_8cpp_source.html#l07245">ap.cpp:7245</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga76da3279dcd1977351b97b95db52b543"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void radiallySymmetrize </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>radialImg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l01161">1161</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;{</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a> center(2);</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    center.initZeros();</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;int&gt;</a> <a class="code" href="point_8cpp.html#adb0abda300c610b969c8be89ed30a4f6">distance</a>, radial_count;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> radial_mean;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="keywordtype">int</span> dim;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga83ea1646b86f859b5bb17f3783fed2a3">radialAveragePrecomputeDistance</a>(img, center, distance, dim);</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga458542f12eb6e607d932ded467a283b8">fastRadialAverage</a>(img, distance, dim, radial_mean, radial_count);</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    radialImg.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(img);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(radialImg)</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    {</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a>=<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(distance,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(radialImg,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)=<a class="code" href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(radial_mean,d);</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    }</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;}</div><div class="ttc" id="point_8cpp_html_adb0abda300c610b969c8be89ed30a4f6"><div class="ttname"><a href="point_8cpp.html#adb0abda300c610b969c8be89ed30a4f6">distance</a></div><div class="ttdeci">TYPE distance(struct Point_T *p, struct Point_T *q)</div><div class="ttdef"><b>Definition:</b> <a href="point_8cpp_source.html#l00028">point.cpp:28</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga97809f7244a28aaa1c26e29e6e3204ef"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a></div><div class="ttdeci">#define A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00549">multidim_array.h:549</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; int &gt;</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga458542f12eb6e607d932ded467a283b8"><div class="ttname"><a href="group__GeometricalTransformations.html#ga458542f12eb6e607d932ded467a283b8">fastRadialAverage</a></div><div class="ttdeci">void fastRadialAverage(const MultidimArray&lt; T &gt; &amp;m, const MultidimArray&lt; int &gt; &amp;distance, int dim, MultidimArray&lt; T &gt; &amp;radial_mean, MultidimArray&lt; int &gt; &amp;radial_count)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01718">transformations.h:1718</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3939496af6ccffe20d083935ebd3225b"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a></div><div class="ttdeci">doublereal * d</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga83ea1646b86f859b5bb17f3783fed2a3"><div class="ttname"><a href="group__GeometricalTransformations.html#ga83ea1646b86f859b5bb17f3783fed2a3">radialAveragePrecomputeDistance</a></div><div class="ttdeci">void radialAveragePrecomputeDistance(const MultidimArray&lt; T &gt; &amp;m, Matrix1D&lt; int &gt; &amp;center_of_rot, MultidimArray&lt; int &gt; &amp;distance, int &amp;dim, const bool &amp;rounding=false)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01653">transformations.h:1653</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; int &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga0231e8c22c93bfa84df99d95527b7cbc"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void reduceBSpline </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reduce a set of B-spline coefficients.</p>
<p>Knowing that V1 is a (single image of) B-spline coefficients, produce the reduced set of B-spline coefficients using the two-scale relationship. </p>

<p>Definition at line <a class="el" href="transformations_8h_source.html#l01360">1360</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;{</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a>[200]; <span class="comment">// Coefficients of the reduce filter</span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="keywordtype">long</span> ng; <span class="comment">// Number of coefficients of the reduce filter</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    <span class="keywordtype">double</span> h[200]; <span class="comment">// Coefficients of the expansion filter</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    <span class="keywordtype">long</span> nh; <span class="comment">// Number of coefficients of the expansion filter</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <span class="keywordtype">short</span> IsCentered; <span class="comment">// Equal TRUE if the filter is a centered spline</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="comment">// Get the filter</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *splineType=<span class="stringliteral">&quot;Centered Spline&quot;</span>;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__PyramidTools.html#ga4333a698029811c9b24fb452a53a1286">GetPyramidFilter</a>(splineType, SplineDegree,</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                         g, &amp;ng, h, &amp;nh, &amp;IsCentered))</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa60458766acaafb3722c0234011bbdbf8">ERR_UNCLASSIFIED</a>, <span class="stringliteral">&quot;Unable to load the filter coefficients&quot;</span>);</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; double&gt;</a>  aux;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <a class="code" href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a>(V1, aux);</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <span class="keywordflow">if</span> (V1.<a class="code" href="classMultidimArrayBase.html#afbb6b0117ab2bbad5949e688d32a7c0d">getDim</a>() == 2)</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    {</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux) % 2 != 0 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux) % 2 != 0)</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;            aux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux) - 1, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux) - 1);</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux) % 2 != 0)</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;            aux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux) - 1, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux));</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux) % 2 != 0)</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;            aux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux), <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux) - 1);</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        V2.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux) / 2, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux) / 2);</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        <a class="code" href="group__PyramidTools.html#gacb07b24550631611496f08be719ae15f">Reduce_2D</a>(<a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(aux), <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux), <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux),</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                  <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(V2), g, ng, IsCentered);</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    }</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (V1.<a class="code" href="classMultidimArrayBase.html#afbb6b0117ab2bbad5949e688d32a7c0d">getDim</a>() == 3)</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    {</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux) % 2 != 0 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux) % 2 != 0 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(aux) % 2 != 0)</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;            aux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(aux - 1), <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux) - 1, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux) - 1);</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux) % 2 != 0 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux) % 2 != 0 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(aux) % 2 == 0)</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;            aux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(aux), <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux) - 1, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux) - 1);</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux) % 2 != 0 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux) % 2 == 0 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(aux) % 2 != 0)</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;            aux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(aux) - 1, <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux), <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux) - 1);</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux) % 2 != 0 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux) % 2 == 0 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(aux) % 2 == 0)</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;            aux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(aux), <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux), <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux) - 1);</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux) % 2 == 0 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux) % 2 != 0 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(aux) % 2 != 0)</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;            aux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(aux) - 1, <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux) - 1, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux));</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux) % 2 == 0 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux) % 2 != 0 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(aux) % 2 == 0)</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;            aux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(aux), <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux) - 1, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux));</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux) % 2 == 0 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux) % 2 == 0 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(aux) % 2 != 0)</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;            aux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(aux) - 1, <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux), <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux));</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        V2.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(aux) / 2, <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux) / 2, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux) / 2);</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;        <a class="code" href="group__PyramidTools.html#ga17e8cd7b1e1d4cb32412bb5d41a287e5">Reduce_3D</a>(<a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(aux), <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(aux), <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(aux), <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(aux),</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                  <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(V2), g, ng, IsCentered);</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    }</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa24918e77d512d272bc38188b58f78ac2">ERR_MULTIDIM_DIM</a>,<span class="stringliteral">&quot;reduceBSpline ERROR: only valid for 2D or 3D arrays&quot;</span>);</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa60458766acaafb3722c0234011bbdbf8"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa60458766acaafb3722c0234011bbdbf8">ERR_UNCLASSIFIED</a></div><div class="ttdoc">Just to locate unclassified errors. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00197">xmipp_error.h:197</a></div></div>
<div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gac87b223f03097d45f776b44b6aeea9f7"><div class="ttname"><a href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a></div><div class="ttdeci">#define MULTIDIM_ARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00136">multidim_array.h:136</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af72286acf4184005499476fbc853146f"><div class="ttname"><a href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a></div><div class="ttdeci">doublereal * g</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02490">numerical_recipes.cpp:2490</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="group__PyramidTools_html_gacb07b24550631611496f08be719ae15f"><div class="ttname"><a href="group__PyramidTools.html#gacb07b24550631611496f08be719ae15f">Reduce_2D</a></div><div class="ttdeci">int Reduce_2D(double *In, long int NxIn, long int NyIn, double *Out, double w[], long int nw, short FlagCentered)</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="group__PyramidTools_html_ga17e8cd7b1e1d4cb32412bb5d41a287e5"><div class="ttname"><a href="group__PyramidTools.html#ga17e8cd7b1e1d4cb32412bb5d41a287e5">Reduce_3D</a></div><div class="ttdeci">int Reduce_3D(double *In, long int NxIn, long int NyIn, long int NzIn, double *Out, double w[], long int nw, short FlagCentered)</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__Vectors_html_gaf36b657319bb585c75cfa14744dab275"><div class="ttname"><a href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a></div><div class="ttdeci">void typeCast(const Matrix1D&lt; T1 &gt; &amp;v1, Matrix1D&lt; T2 &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01904">matrix1d.h:1904</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_afbb6b0117ab2bbad5949e688d32a7c0d"><div class="ttname"><a href="classMultidimArrayBase.html#afbb6b0117ab2bbad5949e688d32a7c0d">MultidimArrayBase::getDim</a></div><div class="ttdeci">int getDim() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01098">multidim_array.h:1098</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa24918e77d512d272bc38188b58f78ac2"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa24918e77d512d272bc38188b58f78ac2">ERR_MULTIDIM_DIM</a></div><div class="ttdoc">Incorrect MultidimArray dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00178">xmipp_error.h:178</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="group__PyramidTools_html_ga4333a698029811c9b24fb452a53a1286"><div class="ttname"><a href="group__PyramidTools.html#ga4333a698029811c9b24fb452a53a1286">GetPyramidFilter</a></div><div class="ttdeci">int GetPyramidFilter(const char *Filter, long int Order, double g[], long int *ng, double h[], long int *nh, short *FlagCentered)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga4ae3c62d556580964f40a41304b5e0fe"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void rotate </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ang</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>axis</em> = <code>'Z'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wrap</em> = <code><a class="el" href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>outside</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Rotate an array around a given system axis.</p>
<p>The rotation angle is in degrees, and the rotational axis is either 'X', 'Y' or 'Z' for 3D arrays and only 'Z' for 2D arrays. An exception is thrown if the axis given is not one of these.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;V2 = V1.rotate(60);</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="transformations_8h_source.html#l01105">1105</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;{</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt; double &gt;</a> tmp;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="keywordflow">if</span> (V1.<a class="code" href="classMultidimArrayBase.html#afbb6b0117ab2bbad5949e688d32a7c0d">getDim</a>()==2)</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    {</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga93598c1cf08f43c7a58a096003b2d718">rotation2DMatrix</a>(ang,tmp);</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    }</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (V1.<a class="code" href="classMultidimArrayBase.html#afbb6b0117ab2bbad5949e688d32a7c0d">getDim</a>()==3)</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    {</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a>(ang, <a class="code" href="image__operate_8cpp.html#aae5e6d8d8a0b1792b5fc6fde13bc4a8c">axis</a>, tmp);</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    }</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa24918e77d512d272bc38188b58f78ac2">ERR_MULTIDIM_DIM</a>,<span class="stringliteral">&quot;rotate ERROR: rotate only valid for 2D or 3D arrays&quot;</span>);</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga667bc7e15d5132db020732ef87e9acb2">applyGeometry</a>(SplineDegree, V2, V1, tmp, <a class="code" href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a>, wrap, outside);</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga667bc7e15d5132db020732ef87e9acb2"><div class="ttname"><a href="group__GeometricalTransformations.html#ga667bc7e15d5132db020732ef87e9acb2">applyGeometry</a></div><div class="ttdeci">void applyGeometry(int SplineDegree, MultidimArray&lt; T &gt; &amp;__restrict__ V2, const MultidimArray&lt; T1 &gt; &amp;__restrict__ V1, const Matrix2D&lt; T2 &gt; &amp;At, bool inv, bool wrap, T outside=0, MultidimArray&lt; double &gt; *BcoeffsPtr=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00287">transformations.h:287</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gade7a7cd894f08efccc7d6b6410bbf891"><div class="ttname"><a href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a></div><div class="ttdeci">void rotation3DMatrix(double ang, char axis, Matrix2D&lt; double &gt; &amp;m, bool homogeneous=true)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00277">transformations.cpp:277</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aae5e6d8d8a0b1792b5fc6fde13bc4a8c"><div class="ttname"><a href="image__operate_8cpp.html#aae5e6d8d8a0b1792b5fc6fde13bc4a8c">axis</a></div><div class="ttdeci">char axis</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00254">image_operate.cpp:254</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga93598c1cf08f43c7a58a096003b2d718"><div class="ttname"><a href="group__GeometricalTransformations.html#ga93598c1cf08f43c7a58a096003b2d718">rotation2DMatrix</a></div><div class="ttdeci">void rotation2DMatrix(T ang, Matrix2D&lt; T &gt; &amp;m, bool homogeneous=true)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00212">transformations.cpp:212</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_afbb6b0117ab2bbad5949e688d32a7c0d"><div class="ttname"><a href="classMultidimArrayBase.html#afbb6b0117ab2bbad5949e688d32a7c0d">MultidimArrayBase::getDim</a></div><div class="ttdeci">int getDim() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01098">multidim_array.h:1098</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa24918e77d512d272bc38188b58f78ac2"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa24918e77d512d272bc38188b58f78ac2">ERR_MULTIDIM_DIM</a></div><div class="ttdoc">Incorrect MultidimArray dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00178">xmipp_error.h:178</a></div></div>
<div class="ttc" id="transformations_8h_html_a3a4a05e15fc1cc8a66159304e4c33eb1"><div class="ttname"><a href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a></div><div class="ttdeci">#define IS_NOT_INV</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00041">transformations.h:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga93598c1cf08f43c7a58a096003b2d718"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void rotation2DMatrix </td>
          <td>(</td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>ang</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>homogeneous</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a rotational matrix (3x3) for images</p>
<p>The rotation angle is in degrees. m must have been already resized to 3x3</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;rotation2DMatrix(60,m);</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00212">212</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;{</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// FIXME DS this might not be true, but just to make sure</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    static_assert(std::is_floating_point&lt;T&gt;::value,</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="stringliteral">&quot;Only float and double are allowed as template parameters&quot;</span>);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    T rad = <a class="code" href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a>(ang);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    T cosine = cos(rad);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    T sine = sin(rad);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">if</span> (homogeneous)</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        result.resizeNoCopy(3,3); <span class="comment">// sizes will be tested inside</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="comment">// now we have 3x3 matrix row wise matrix</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        result.mdata[0] = cosine;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        result.mdata[1] = sine;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        result.mdata[2] = 0;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        result.mdata[3] = -sine;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        result.mdata[4] = cosine;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        result.mdata[5] = 0;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        result.mdata[6] = 0;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        result.mdata[7] = 0;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        result.mdata[8] = 1;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        result.resizeNoCopy(2,2); <span class="comment">// sizes will be tested inside</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="comment">// now we have 2x2 matrix row wise matrix</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        result.mdata[0] = cosine;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        result.mdata[1] = sine;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        result.mdata[2] = -sine;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        result.mdata[3] = cosine;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    }</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;}</div><div class="ttc" id="group__Macros_html_gadec1e6bbd34c5cf8765a457da4876c91"><div class="ttname"><a href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a></div><div class="ttdeci">#define DEG2RAD(d)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00312">xmipp_macros.h:312</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gade7a7cd894f08efccc7d6b6410bbf891"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotation3DMatrix </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ang</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>axis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>homogeneous</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a rotational matrix (4x4) for volumes around system axis</p>
<p>The rotation angle is in degrees, and the rotational axis is either 'X', 'Y' or 'Z'. An exception is thrown if the axis given is not one of these.</p>
<p>The returned matrices are respectively alpha degrees around Z</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[ cos(A) -sin(A)     0   ]</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;[ sin(A)  cos(A)     0   ]</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;[   0       0        1   ]</div></div><!-- fragment --><p>alpha degrees around Y </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[ cos(A)    0    -sin(A) ]</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;[   0       1       0    ]</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;[ sin(A)    0     cos(A) ]</div></div><!-- fragment --><p>alpha degrees around X </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[   1       0       0    ]</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;[   0     cos(A) -sin(A) ]</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;[   0     sin(A)  cos(A) ]</div></div><!-- fragment --><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;m = rotation3DMatrix(60, &#39;X&#39;);</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00277">277</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;{</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">if</span> (homogeneous)</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        result.initZeros(4,4);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,3, 3) = 1;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        result.initZeros(3,3);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordtype">double</span> cosine, sine;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    ang = <a class="code" href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a>(ang);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    cosine = cos(ang);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    sine = sin(ang);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="image__operate_8cpp.html#aae5e6d8d8a0b1792b5fc6fde13bc4a8c">axis</a>)</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    {</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;Z&#39;</span>:</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,0, 0) = cosine;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,0, 1) = sine;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,1, 0) = -sine;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,1, 1) = cosine;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,2, 2) = 1;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;Y&#39;</span>:</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,0, 0) = cosine;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,0, 2) = sine;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,2, 0) = -sine;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,2, 2) = cosine;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,1, 1) = 1;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;X&#39;</span>:</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,1, 1) = cosine;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,1, 2) = sine;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,2, 1) = -sine;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,2, 2) = cosine;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,0, 0) = 1;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a>, <span class="stringliteral">&quot;rotation3DMatrix: Unknown axis&quot;</span>);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    }</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="group__Macros_html_gadec1e6bbd34c5cf8765a457da4876c91"><div class="ttname"><a href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a></div><div class="ttdeci">#define DEG2RAD(d)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00312">xmipp_macros.h:312</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aae5e6d8d8a0b1792b5fc6fde13bc4a8c"><div class="ttname"><a href="image__operate_8cpp.html#aae5e6d8d8a0b1792b5fc6fde13bc4a8c">axis</a></div><div class="ttdeci">char axis</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00254">image_operate.cpp:254</a></div></div>
<div class="ttc" id="group__Matrices_html_gaf0f6abe0342cabe025337d656f034e87"><div class="ttname"><a href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a></div><div class="ttdeci">#define dMij(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00140">matrix2d.h:140</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a></div><div class="ttdoc">Incorrect value received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00200">xmipp_error.h:200</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga23125465e6cfa723f07e35ed78d42be9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotation3DMatrix </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ang</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>axis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>homogeneous</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a rotational matrix (4x4) for volumes around any axis</p>
<p>The rotation angle is in degrees, and the rotational axis is given as a R3 vector. An exception is thrown if the axis is not a R3 vector. The axis needs not to be unitary.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;m = rotation3DMatrix(60, vectorR3(1, 1, 1));</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00368">368</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;{</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="preprocessor">#ifdef NEVERDEFINED</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">// Compute a matrix which makes the turning axis coincident with Z</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">// And turn around this axis</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> A, R;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#gae1017da8a3705e6a6aeffd6c0a2af38f">alignWithZ</a>(axis, A, homogeneous);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a>(ang, <span class="charliteral">&#39;Z&#39;</span>, R, homogeneous);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    result = A.<a class="code" href="classMatrix2D.html#a350918f3b68e68e5a358bf75fa1b283f">transpose</a>() * R * A;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="comment">// http://en.wikipedia.org/wiki/Rotation_matrix#Rotation_matrix_from_axis_and_angle</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">if</span> (homogeneous)</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        result.<a class="code" href="classMatrix2D.html#a1b0afdb4a10ad1857db3db8b64715ba3">initIdentity</a>(4);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        result.initIdentity(3);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordtype">double</span> s,<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga343bb99185c21cb45ddf83ffa06f9198">sincos</a>(-<a class="code" href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a>(ang),&amp;s,&amp;c);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordtype">double</span> c1=1-<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>=<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(axis);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>=<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(axis);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>=<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(axis);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordtype">double</span> xy=x*<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordtype">double</span> xz=x*<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordtype">double</span> yz=y*<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordtype">double</span> x2=x*<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordtype">double</span> y2=y*<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordtype">double</span> z2=z*<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,0,0)=c+x2*c1;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,0,1)=xy*c1-z*s;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,0,2)=xz*c1+y*s;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,1,0)=xy*c1+z*s;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,1,1)=c+y2*c1;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,1,2)=yz*c1-x*s;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,2,0)=xz*c1-y*s;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,2,1)=yz*c1+x*s;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,2,2)=c+z2*c1;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__Macros_html_gadec1e6bbd34c5cf8765a457da4876c91"><div class="ttname"><a href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a></div><div class="ttdeci">#define DEG2RAD(d)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00312">xmipp_macros.h:312</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad919bbce6f061400a0bc5231a9cd1621"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a></div><div class="ttdeci">static double * y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08506">numerical_recipes.cpp:8506</a></div></div>
<div class="ttc" id="classMatrix2D_html_a350918f3b68e68e5a358bf75fa1b283f"><div class="ttname"><a href="classMatrix2D.html#a350918f3b68e68e5a358bf75fa1b283f">Matrix2D::transpose</a></div><div class="ttdeci">Matrix2D&lt; T &gt; transpose() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01630">matrix2d.h:1630</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gade7a7cd894f08efccc7d6b6410bbf891"><div class="ttname"><a href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a></div><div class="ttdeci">void rotation3DMatrix(double ang, char axis, Matrix2D&lt; double &gt; &amp;result, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00277">transformations.cpp:277</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Matrices_html_gaf0f6abe0342cabe025337d656f034e87"><div class="ttname"><a href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a></div><div class="ttdeci">#define dMij(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00140">matrix2d.h:140</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga343bb99185c21cb45ddf83ffa06f9198"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga343bb99185c21cb45ddf83ffa06f9198">sincos</a></div><div class="ttdeci">void sincos(const MultidimArray&lt; double &gt; &amp;x, MultidimArray&lt; double &gt; &amp;s, MultidimArray&lt; double &gt; &amp;c)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00593">multidim_array.cpp:593</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aa508e3dbd0e86258b5c69e8a8b6b8295"><div class="ttname"><a href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08509">numerical_recipes.cpp:8509</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gae1017da8a3705e6a6aeffd6c0a2af38f"><div class="ttname"><a href="group__GeometricalTransformations.html#gae1017da8a3705e6a6aeffd6c0a2af38f">alignWithZ</a></div><div class="ttdeci">void alignWithZ(const Matrix1D&lt; double &gt; &amp;axis, Matrix2D&lt; double &gt; &amp;result, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00322">transformations.cpp:322</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="classMatrix2D_html_a1b0afdb4a10ad1857db3db8b64715ba3"><div class="ttname"><a href="classMatrix2D.html#a1b0afdb4a10ad1857db3db8b64715ba3">Matrix2D::initIdentity</a></div><div class="ttdeci">void initIdentity()</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00835">matrix2d.h:835</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga3889b5e4274c3765f42cb62cd35fe33f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotation3DMatrixFromIcoOrientations </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>icoFrom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>icoTo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>R</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a rotation matrix (R) to change the orientation from one standard orientation (icoFrom) to another one (icoTo) </p>

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l01181">1181</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;{</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    std::vector&lt;char&gt; symLabel;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    symLabel.push_back((<span class="keywordtype">int</span>)icoFrom[1]);</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    symLabel.push_back((<span class="keywordtype">int</span>)icoTo[1]);</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> xyz(3); </div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> Rfrom, Rto;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;2; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    {</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        <span class="keywordflow">switch</span> (symLabel[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        {</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;1&#39;</span>:</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                xyz = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0.0, 90.0, 0.0);</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;2&#39;</span>:</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                xyz = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0.0, 0.0, 0.0);</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;3&#39;</span>:</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                xyz = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0.0, 31.7175, 0.0);</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;4&#39;</span>:</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                xyz = <a class="code" href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a>(0.0, -31.7175, 0.0);</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">/*            case &#39;5&#39;:</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">                xyz = vectorR3(31.7175, 90.0, 0.0); // not aviable yet</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">                break;</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="comment">            case &#39;6&#39;:</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="comment">                xyz = vectorR3(-31.7175, 90.0, 0.0); // not aviable yet</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="comment">                break;*/</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;            <span class="keywordflow">default</span>:</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aac2c1f1c6c03ba33fc7530b58babe0ed5">ERR_PARAM_INCORRECT</a>, <span class="stringliteral">&quot;Incorrect standard icosahedral orientation&quot;</span>);</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        }</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        <span class="keywordflow">if</span> (i==0)</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;            <a class="code" href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(xyz), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(xyz), <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(xyz), Rfrom, <span class="keyword">true</span>);</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;            <a class="code" href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(xyz), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(xyz), <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(xyz), Rto, <span class="keyword">true</span>);</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    }</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    R = Rto * Rfrom.<a class="code" href="classMatrix2D.html#a350918f3b68e68e5a358bf75fa1b283f">transpose</a>();</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aac2c1f1c6c03ba33fc7530b58babe0ed5"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aac2c1f1c6c03ba33fc7530b58babe0ed5">ERR_PARAM_INCORRECT</a></div><div class="ttdoc">Parameter incorrect. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00186">xmipp_error.h:186</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="group__Geometry_html_gaf67a2d233e3fbf038d111a91197fa759"><div class="ttname"><a href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a></div><div class="ttdeci">void Euler_angles2matrix(T alpha, T beta, T gamma, Matrix2D&lt; T &gt; &amp;A, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00621">geometry.cpp:621</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8caf6673fdc30d0b6f4a529cb1f4e3ab"><div class="ttname"><a href="group__Vectors.html#ga8caf6673fdc30d0b6f4a529cb1f4e3ab">vectorR3</a></div><div class="ttdeci">Matrix1D&lt; double &gt; vectorR3(double x, double y, double z)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8cpp_source.html#l00036">matrix1d.cpp:36</a></div></div>
<div class="ttc" id="classMatrix2D_html_a350918f3b68e68e5a358bf75fa1b283f"><div class="ttname"><a href="classMatrix2D.html#a350918f3b68e68e5a358bf75fa1b283f">Matrix2D::transpose</a></div><div class="ttdeci">Matrix2D&lt; T &gt; transpose() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01630">matrix2d.h:1630</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga3b1fdfbbfbd9315cdb3b9f432911eb70"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void scale3DMatrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>sc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>homogeneous</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a scaling matrix (4x4) for volumes</p>
<p>The scaling factors for the different axis must be given as a vector. So that, <a class="el" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX(sc)</a>=scale for X axis, <a class="el" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY(sc)</a>=... </p>

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00433">433</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;{</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#gad6524c4e36da91aae3fb6f8564112364">VEC_XSIZE</a>(sc) != 3)</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a>, <span class="stringliteral">&quot;Scale3D_matrix: vector is not in R3&quot;</span>);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">if</span> (homogeneous)</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    {</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        result.initZeros(4,4);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,3, 3) = 1;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    }</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        result.initZeros(3,3);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,0, 0) = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(sc);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,1, 1) = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(sc);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(result,2, 2) = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(sc);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a></div><div class="ttdoc">Problem with matrix size. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00157">xmipp_error.h:157</a></div></div>
<div class="ttc" id="group__Vectors_html_gad6524c4e36da91aae3fb6f8564112364"><div class="ttname"><a href="group__Vectors.html#gad6524c4e36da91aae3fb6f8564112364">VEC_XSIZE</a></div><div class="ttdeci">#define VEC_XSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00080">matrix1d.h:80</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Matrices_html_gaf0f6abe0342cabe025337d656f034e87"><div class="ttname"><a href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a></div><div class="ttdeci">#define dMij(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00140">matrix2d.h:140</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gacc8574b3660c08bf34e97dfafa390ee0"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T1 , typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void scaleToSize </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T1 &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>Xdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>Zdim</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Scales to a new size.</p>
<p>The volume is scaled (resampled) to fill a new size. It is not the same as "selfWindow" in this same class. The size can be larger or smaller than the actual one.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;V2 = V1.scaleToSize(128, 128, 128);</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="transformations_8h_source.html#l01233">1233</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;{</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="keywordflow">if</span> (Xdim == <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V1) &amp;&amp; Ydim == <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(V1) &amp;&amp; \</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        (!(V1.<a class="code" href="classMultidimArrayBase.html#afbb6b0117ab2bbad5949e688d32a7c0d">getDim</a>()==3) || (Zdim == <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(V1))) )</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    {</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        <a class="code" href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a>(V1,V2);</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    }</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt; double &gt;</a> tmp;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keywordflow">if</span> (V1.<a class="code" href="classMultidimArrayBase.html#afbb6b0117ab2bbad5949e688d32a7c0d">getDim</a>()==2)</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    {</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        tmp.<a class="code" href="classMatrix2D.html#a1b0afdb4a10ad1857db3db8b64715ba3">initIdentity</a>(3);</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        tmp(0, 0) = (double) Xdim / (<span class="keywordtype">double</span>) <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V1);</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        tmp(1, 1) = (double) Ydim / (<span class="keywordtype">double</span>) <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(V1);</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        V2.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(1, 1, Ydim, Xdim);</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    }</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (V1.<a class="code" href="classMultidimArrayBase.html#afbb6b0117ab2bbad5949e688d32a7c0d">getDim</a>()==3)</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    {</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        tmp.<a class="code" href="classMatrix2D.html#a1b0afdb4a10ad1857db3db8b64715ba3">initIdentity</a>(4);</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        tmp(0, 0) = (double) Xdim / (<span class="keywordtype">double</span>) <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V1);</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        tmp(1, 1) = (double) Ydim / (<span class="keywordtype">double</span>) <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(V1);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        tmp(2, 2) = (double) Zdim / (<span class="keywordtype">double</span>) <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(V1);</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        V2.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(1, Zdim, Ydim, Xdim);</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    }</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa24918e77d512d272bc38188b58f78ac2">ERR_MULTIDIM_DIM</a>,<span class="stringliteral">&quot;scaleToSize ERROR: scaleToSize only valid for 2D or 3D arrays&quot;</span>);</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    V2.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga667bc7e15d5132db020732ef87e9acb2">applyGeometry</a>(SplineDegree, V2, V1, tmp, <a class="code" href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a>, <a class="code" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a>, (T)0);</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="transformations_8h_html_a43c1de45dbd91827a260224c9c40221b"><div class="ttname"><a href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a></div><div class="ttdeci">#define WRAP</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00043">transformations.h:43</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga667bc7e15d5132db020732ef87e9acb2"><div class="ttname"><a href="group__GeometricalTransformations.html#ga667bc7e15d5132db020732ef87e9acb2">applyGeometry</a></div><div class="ttdeci">void applyGeometry(int SplineDegree, MultidimArray&lt; T &gt; &amp;__restrict__ V2, const MultidimArray&lt; T1 &gt; &amp;__restrict__ V1, const Matrix2D&lt; T2 &gt; &amp;At, bool inv, bool wrap, T outside=0, MultidimArray&lt; double &gt; *BcoeffsPtr=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00287">transformations.h:287</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__Vectors_html_gaf36b657319bb585c75cfa14744dab275"><div class="ttname"><a href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a></div><div class="ttdeci">void typeCast(const Matrix1D&lt; T1 &gt; &amp;v1, Matrix1D&lt; T2 &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01904">matrix1d.h:1904</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_afbb6b0117ab2bbad5949e688d32a7c0d"><div class="ttname"><a href="classMultidimArrayBase.html#afbb6b0117ab2bbad5949e688d32a7c0d">MultidimArrayBase::getDim</a></div><div class="ttdeci">int getDim() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01098">multidim_array.h:1098</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa24918e77d512d272bc38188b58f78ac2"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa24918e77d512d272bc38188b58f78ac2">ERR_MULTIDIM_DIM</a></div><div class="ttdoc">Incorrect MultidimArray dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00178">xmipp_error.h:178</a></div></div>
<div class="ttc" id="transformations_8h_html_a3a4a05e15fc1cc8a66159304e4c33eb1"><div class="ttname"><a href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a></div><div class="ttdeci">#define IS_NOT_INV</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00041">transformations.h:41</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="classMatrix2D_html_a1b0afdb4a10ad1857db3db8b64715ba3"><div class="ttname"><a href="classMatrix2D.html#a1b0afdb4a10ad1857db3db8b64715ba3">Matrix2D::initIdentity</a></div><div class="ttdeci">void initIdentity()</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00835">matrix2d.h:835</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga61730930931511f402f6b8af417d3b88"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void scaleToSize </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Zdim</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Scales to a new size.</p>
<p>The volume is scaled (resampled) to fill a new size. Same as previous, but in this case the input is a <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a>.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;scaleToSize(VolumeOut, VolumeGenericInput, 128, 128, 128);</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="transformations_8h_source.html#l01279">1279</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;{</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="preprocessor">#define SCALETOSIZE(type) scaleToSize(SplineDegree,V2,*((MultidimArray&lt;type&gt;*)(V1.im)),Xdim,Ydim,Zdim);</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <a class="code" href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a>(V1.<a class="code" href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">datatype</a>,<a class="code" href="transformations_8h.html#aff360d930907e5de2f99c457098061f9">SCALETOSIZE</a>)</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="preprocessor">#undef SCALETOSIZE</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;}</div><div class="ttc" id="classMultidimArrayGeneric_html_a0b74b17fe8d2f77c90b1513bd795c224"><div class="ttname"><a href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">MultidimArrayGeneric::datatype</a></div><div class="ttdeci">DataType datatype</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00110">multidim_array_generic.h:110</a></div></div>
<div class="ttc" id="transformations_8h_html_aff360d930907e5de2f99c457098061f9"><div class="ttname"><a href="transformations_8h.html#aff360d930907e5de2f99c457098061f9">SCALETOSIZE</a></div><div class="ttdeci">#define SCALETOSIZE(type)</div></div>
<div class="ttc" id="multidim__array__generic_8h_html_ada27bedba7f65b4ad8fca3eb7f5ad65e"><div class="ttname"><a href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a></div><div class="ttdeci">#define SWITCHDATATYPE(datatype, OP)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00044">multidim_array_generic.h:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaee7fbda1e25b15feff604ab93203f91d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void scaleToSize </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;&#160;</td>
          <td class="paramname"><em>V2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Zdim</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Scales to a new size.</p>
<p>The volume is scaled (resampled) to fill a new size. Same as previous, but in this case the input is a <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a>.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;scaleToSize(VolumeOut, VolumeGenericInput, 128, 128, 128);</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="transformations_8h_source.html#l01299">1299</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;{</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="preprocessor">#define SCALETOSIZE(type) scaleToSize(SplineDegree,MULTIDIM_ARRAY_TYPE(V2,type),V1,Xdim,Ydim,Zdim);</span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <a class="code" href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a>(V1.datatype,<a class="code" href="transformations_8h.html#aff360d930907e5de2f99c457098061f9">SCALETOSIZE</a>)</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="preprocessor">#undef SCALETOSIZE</span></div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;}</div><div class="ttc" id="transformations_8h_html_aff360d930907e5de2f99c457098061f9"><div class="ttname"><a href="transformations_8h.html#aff360d930907e5de2f99c457098061f9">SCALETOSIZE</a></div><div class="ttdeci">#define SCALETOSIZE(type)</div></div>
<div class="ttc" id="multidim__array__generic_8h_html_ada27bedba7f65b4ad8fca3eb7f5ad65e"><div class="ttname"><a href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a></div><div class="ttdeci">#define SWITCHDATATYPE(datatype, OP)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00044">multidim_array_generic.h:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gafc49d813bd3c47ca193e504888d78b2a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void scaleToSize </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;&#160;</td>
          <td class="paramname"><em>V2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Zdim</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Scales to a new size.</p>
<p>The volume is scaled (resampled) to fill a new size. Same as previous, but in this case the input is a <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a>.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;scaleToSize(VolumeOut, VolumeGenericInput, 128, 128, 128);</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00595">595</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;{</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="keywordflow">if</span> (V1.<a class="code" href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">datatype</a> != V2.<a class="code" href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">datatype</a>)</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aac2c1f1c6c03ba33fc7530b58babe0ed5">ERR_PARAM_INCORRECT</a>, <span class="stringliteral">&quot;scaleToSize: MultidimArrayGeneric requires same datatype&quot;</span>);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="preprocessor">#define SCALETOSIZE(type) scaleToSize(SplineDegree,MULTIDIM_ARRAY_TYPE(V2,type), \</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="preprocessor">                          MULTIDIM_ARRAY_TYPE(V1,type),Xdim,Ydim,Zdim);</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <a class="code" href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a>(V1.<a class="code" href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">datatype</a>, <a class="code" href="transformations_8cpp.html#aff360d930907e5de2f99c457098061f9">SCALETOSIZE</a>)</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="preprocessor">#undef SCALETOSIZE</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aac2c1f1c6c03ba33fc7530b58babe0ed5"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aac2c1f1c6c03ba33fc7530b58babe0ed5">ERR_PARAM_INCORRECT</a></div><div class="ttdoc">Parameter incorrect. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00186">xmipp_error.h:186</a></div></div>
<div class="ttc" id="transformations_8cpp_html_aff360d930907e5de2f99c457098061f9"><div class="ttname"><a href="transformations_8cpp.html#aff360d930907e5de2f99c457098061f9">SCALETOSIZE</a></div><div class="ttdeci">#define SCALETOSIZE(type)</div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="classMultidimArrayGeneric_html_a0b74b17fe8d2f77c90b1513bd795c224"><div class="ttname"><a href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">MultidimArrayGeneric::datatype</a></div><div class="ttdeci">DataType datatype</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00110">multidim_array_generic.h:110</a></div></div>
<div class="ttc" id="multidim__array__generic_8h_html_ada27bedba7f65b4ad8fca3eb7f5ad65e"><div class="ttname"><a href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a></div><div class="ttdeci">#define SWITCHDATATYPE(datatype, OP)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00044">multidim_array_generic.h:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga7c05f0285d9099f2e94c37ae9d192253"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void scaleToSize </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>V2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Zdim</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00608">608</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;{</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordflow">if</span> (SplineDegree &gt; 1)</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    {</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <a class="code" href="classMultidimArray.html">MultidimArray&lt; double &gt;</a> re, im, aux;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <a class="code" href="classMultidimArray.html">MultidimArray&lt;std::complex&lt;double&gt;</a> &gt; oneImg;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        re.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(V1), <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(V1), <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V1));</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        im.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(V1), <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(V1), <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V1));</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        oneImg=V1;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <a class="code" href="group__Fourier.html#gaecc9ea04e2c2d93f8da933157abdc473">Complex2RealImag</a>(<a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(oneImg),</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                         <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(re), <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(im),</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                         <a class="code" href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(oneImg));</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        aux = re;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#gafc49d813bd3c47ca193e504888d78b2a">scaleToSize</a>(SplineDegree, re, aux, Ydim, Xdim, Zdim);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        aux = im;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#gafc49d813bd3c47ca193e504888d78b2a">scaleToSize</a>(SplineDegree, im, aux, Ydim, Xdim, Zdim);</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <a class="code" href="group__Fourier.html#ga33c7ec60c621eb0d58a4d23981b84793">RealImag2Complex</a>(<a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(re), <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(im),</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                         <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(V2), <a class="code" href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(re));</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    }</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#gafc49d813bd3c47ca193e504888d78b2a">scaleToSize</a>(SplineDegree, V2, V1, Xdim, Ydim, Zdim);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gac87b223f03097d45f776b44b6aeea9f7"><div class="ttname"><a href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a></div><div class="ttdeci">#define MULTIDIM_ARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00136">multidim_array.h:136</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga027a630a86c277b71cda769268764fd1"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a></div><div class="ttdeci">#define MULTIDIM_SIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00125">multidim_array.h:125</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="group__Fourier_html_ga33c7ec60c621eb0d58a4d23981b84793"><div class="ttname"><a href="group__Fourier.html#ga33c7ec60c621eb0d58a4d23981b84793">RealImag2Complex</a></div><div class="ttdeci">void RealImag2Complex(const MultidimArray&lt; double &gt; &amp;real, const MultidimArray&lt; double &gt; &amp;imag, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8cpp_source.html#l00114">xmipp_fft.cpp:114</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gafc49d813bd3c47ca193e504888d78b2a"><div class="ttname"><a href="group__GeometricalTransformations.html#gafc49d813bd3c47ca193e504888d78b2a">scaleToSize</a></div><div class="ttdeci">void scaleToSize(int SplineDegree, MultidimArrayGeneric &amp;V2, const MultidimArrayGeneric &amp;V1, int Xdim, int Ydim, int Zdim)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00595">transformations.cpp:595</a></div></div>
<div class="ttc" id="group__Fourier_html_gaecc9ea04e2c2d93f8da933157abdc473"><div class="ttname"><a href="group__Fourier.html#gaecc9ea04e2c2d93f8da933157abdc473">Complex2RealImag</a></div><div class="ttdeci">void Complex2RealImag(const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;in, MultidimArray&lt; double &gt; &amp;real, MultidimArray&lt; double &gt; &amp;imag)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8cpp_source.html#l00103">xmipp_fft.cpp:103</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga15a4c13ffed0695f09ea5340d27ff5c1"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void selfApplyGeometry </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wrap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>outside</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Applies a geometrical transformation and overwrites the input matrix.</p>
<p>The same as the previous function, but input array is overwritten </p>

<p>Definition at line <a class="el" href="transformations_8h_source.html#l00999">999</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;{</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;T&gt;</a> aux = V1;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    V1.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga667bc7e15d5132db020732ef87e9acb2">applyGeometry</a>(SplineDegree, V1, aux, A, inv, wrap, outside);</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga667bc7e15d5132db020732ef87e9acb2"><div class="ttname"><a href="group__GeometricalTransformations.html#ga667bc7e15d5132db020732ef87e9acb2">applyGeometry</a></div><div class="ttdeci">void applyGeometry(int SplineDegree, MultidimArray&lt; T &gt; &amp;__restrict__ V2, const MultidimArray&lt; T1 &gt; &amp;__restrict__ V1, const Matrix2D&lt; T2 &gt; &amp;At, bool inv, bool wrap, T outside=0, MultidimArray&lt; double &gt; *BcoeffsPtr=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00287">transformations.h:287</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga22035972f95a4f2bf79416b5ebf9d44e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void selfApplyGeometry </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wrap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::complex&lt; double &gt;&#160;</td>
          <td class="paramname"><em>outside</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00553">553</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;{</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;std::complex&lt;double&gt;</a> &gt; aux = V1;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a>(Splinedegree, V1, aux, A, inv, wrap, outside);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga3cc15e5dda7c58b9cacb7eee440d6bdc"><div class="ttname"><a href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a></div><div class="ttdeci">void applyGeometry(int SplineDegree, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V2, const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V1, const Matrix2D&lt; double &gt; &amp;A, bool inv, bool wrap, std::complex&lt; double &gt; outside, MultidimArray&lt; double &gt; *BcoeffsPtr)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00517">transformations.cpp:517</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaf7119c6e78f80419f2bca98c6599d514"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void selfPyramidExpand </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>levels</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Expand the nth volume by 2 using a BSpline pyramid.</p>
<p>The same as the previous function, but input array is overwritten </p>

<p>Definition at line <a class="el" href="transformations_8h_source.html#l01539">1539</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;{</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;T&gt;</a> aux = V1;</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    V1.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga4244b45bd0344100b4e2e868a2b403af">pyramidExpand</a>(SplineDegree, V1, aux, levels);</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga4244b45bd0344100b4e2e868a2b403af"><div class="ttname"><a href="group__GeometricalTransformations.html#ga4244b45bd0344100b4e2e868a2b403af">pyramidExpand</a></div><div class="ttdeci">void pyramidExpand(int SplineDegree, MultidimArray&lt; T &gt; &amp;V2, const MultidimArray&lt; T &gt; &amp;V1, int levels=1)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01504">transformations.h:1504</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga48c82b941f9e97e6c629b6ecda579995"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void selfPyramidExpand </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>levels</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Same as previous but for <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> </p>

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00658">658</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;{</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="preprocessor">#define SELFPYRAMIDEXPAND(type) selfPyramidExpand(SplineDegree, \</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="preprocessor">                                      *((MultidimArray&lt;type&gt;*)(V1.im)), levels);</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a>(V1.<a class="code" href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">datatype</a>,<a class="code" href="transformations_8cpp.html#a21b200603820ad5560fc1388a54f59d0">SELFPYRAMIDEXPAND</a>);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="preprocessor">#undef SELFPYRAMIDEXPAND</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;}</div><div class="ttc" id="transformations_8cpp_html_a21b200603820ad5560fc1388a54f59d0"><div class="ttname"><a href="transformations_8cpp.html#a21b200603820ad5560fc1388a54f59d0">SELFPYRAMIDEXPAND</a></div><div class="ttdeci">#define SELFPYRAMIDEXPAND(type)</div></div>
<div class="ttc" id="classMultidimArrayGeneric_html_a0b74b17fe8d2f77c90b1513bd795c224"><div class="ttname"><a href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">MultidimArrayGeneric::datatype</a></div><div class="ttdeci">DataType datatype</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00110">multidim_array_generic.h:110</a></div></div>
<div class="ttc" id="multidim__array__generic_8h_html_ada27bedba7f65b4ad8fca3eb7f5ad65e"><div class="ttname"><a href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a></div><div class="ttdeci">#define SWITCHDATATYPE(datatype, OP)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00044">multidim_array_generic.h:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga2d6b094c319191119a3b8516be6cffbf"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void selfPyramidReduce </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>levels</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reduce the nth volume by 2 using a BSpline pyramid.</p>
<p>The same as the previous function, but input array is overwritten </p>

<p>Definition at line <a class="el" href="transformations_8h_source.html#l01485">1485</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;{</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;T&gt;</a> aux = V1;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    V1.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#gaa6664b10a8446559d382f093905d3dbd">pyramidReduce</a>(SplineDegree, V1, aux, levels);</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gaa6664b10a8446559d382f093905d3dbd"><div class="ttname"><a href="group__GeometricalTransformations.html#gaa6664b10a8446559d382f093905d3dbd">pyramidReduce</a></div><div class="ttdeci">void pyramidReduce(int SplineDegree, MultidimArray&lt; T &gt; &amp;V2, const MultidimArray&lt; T &gt; &amp;V1, int levels=1)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01461">transformations.h:1461</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga6a293c497c0d2892a529cefa8cab3d03"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void selfPyramidReduce </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>levels</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Same as previous but for <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a></p>
<p>Same as template version but for <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> </p>

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00647">647</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;{</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="preprocessor">#define SELFPYRAMIDREDUCE(type) selfPyramidReduce(SplineDegree, \</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="preprocessor">                                      *((MultidimArray&lt;type&gt;*)(V1.im)), levels);</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <a class="code" href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a>(V1.<a class="code" href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">datatype</a>,<a class="code" href="transformations_8cpp.html#aeb169763dd4030eedec4b91bd16636ab">SELFPYRAMIDREDUCE</a>);</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="preprocessor">#undef SELFPYRAMIDREDUCE</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;}</div><div class="ttc" id="transformations_8cpp_html_aeb169763dd4030eedec4b91bd16636ab"><div class="ttname"><a href="transformations_8cpp.html#aeb169763dd4030eedec4b91bd16636ab">SELFPYRAMIDREDUCE</a></div><div class="ttdeci">#define SELFPYRAMIDREDUCE(type)</div></div>
<div class="ttc" id="classMultidimArrayGeneric_html_a0b74b17fe8d2f77c90b1513bd795c224"><div class="ttname"><a href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">MultidimArrayGeneric::datatype</a></div><div class="ttdeci">DataType datatype</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00110">multidim_array_generic.h:110</a></div></div>
<div class="ttc" id="multidim__array__generic_8h_html_ada27bedba7f65b4ad8fca3eb7f5ad65e"><div class="ttname"><a href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a></div><div class="ttdeci">#define SWITCHDATATYPE(datatype, OP)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00044">multidim_array_generic.h:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gacbdf0682a5d446110f6a0932d2101e02"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void selfRotate </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ang</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>axis</em> = <code>'Z'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wrap</em> = <code><a class="el" href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>outside</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Rotate an array around a given system axis.</p>
<p>The same as the previous function, but input array is overwritten </p>

<p>Definition at line <a class="el" href="transformations_8h_source.html#l01132">1132</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;{</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;T&gt;</a> aux = V1;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    V1.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga4ae3c62d556580964f40a41304b5e0fe">rotate</a>(SplineDegree, V1, aux, ang, <a class="code" href="image__operate_8cpp.html#aae5e6d8d8a0b1792b5fc6fde13bc4a8c">axis</a>, wrap, outside);</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga4ae3c62d556580964f40a41304b5e0fe"><div class="ttname"><a href="group__GeometricalTransformations.html#ga4ae3c62d556580964f40a41304b5e0fe">rotate</a></div><div class="ttdeci">void rotate(int SplineDegree, MultidimArray&lt; T &gt; &amp;V2, const MultidimArray&lt; T &gt; &amp;V1, double ang, char axis= 'Z', bool wrap=DONT_WRAP, T outside=0)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01105">transformations.h:1105</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aae5e6d8d8a0b1792b5fc6fde13bc4a8c"><div class="ttname"><a href="image__operate_8cpp.html#aae5e6d8d8a0b1792b5fc6fde13bc4a8c">axis</a></div><div class="ttdeci">char axis</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00254">image_operate.cpp:254</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga8cc329115cf649b839ab2dd9829a64b2"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void selfScaleToSize </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Zdim</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Scales to a new size.</p>
<p>The same as the previous function, but input array is overwritten </p>

<p>Definition at line <a class="el" href="transformations_8h_source.html#l01328">1328</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;{</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;T&gt;</a> aux = V1;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#gacc8574b3660c08bf34e97dfafa390ee0">scaleToSize</a>(SplineDegree, V1, aux, Xdim, Ydim, Zdim);</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gacc8574b3660c08bf34e97dfafa390ee0"><div class="ttname"><a href="group__GeometricalTransformations.html#gacc8574b3660c08bf34e97dfafa390ee0">scaleToSize</a></div><div class="ttdeci">void scaleToSize(int SplineDegree, MultidimArray&lt; T &gt; &amp;V2, const MultidimArray&lt; T1 &gt; &amp;V1, size_t Xdim, size_t Ydim, size_t Zdim=1)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01233">transformations.h:1233</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga04c547130530ebaa6ce754df5b0ae089"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void selfScaleToSize </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Zdim</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00585">585</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;{</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="preprocessor">#define SELFSCALETOSIZE(type) selfScaleToSize(SplineDegree,MULTIDIM_ARRAY_TYPE(V1,type), \</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="preprocessor">                                                                Xdim,Ydim,Zdim);</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <a class="code" href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a>(V1.<a class="code" href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">datatype</a>,<a class="code" href="transformations_8cpp.html#ae1eaed5ad6d1aae36d30e570b773a6de">SELFSCALETOSIZE</a>)</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="preprocessor">#undef SELFSCALETOSIZE</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;}</div><div class="ttc" id="transformations_8cpp_html_ae1eaed5ad6d1aae36d30e570b773a6de"><div class="ttname"><a href="transformations_8cpp.html#ae1eaed5ad6d1aae36d30e570b773a6de">SELFSCALETOSIZE</a></div><div class="ttdeci">#define SELFSCALETOSIZE(type)</div></div>
<div class="ttc" id="classMultidimArrayGeneric_html_a0b74b17fe8d2f77c90b1513bd795c224"><div class="ttname"><a href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">MultidimArrayGeneric::datatype</a></div><div class="ttdeci">DataType datatype</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00110">multidim_array_generic.h:110</a></div></div>
<div class="ttc" id="multidim__array__generic_8h_html_ada27bedba7f65b4ad8fca3eb7f5ad65e"><div class="ttname"><a href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a></div><div class="ttdeci">#define SWITCHDATATYPE(datatype, OP)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00044">multidim_array_generic.h:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gacf1576f9d76ad69fefb0fb2ee77a8bb1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void selfScaleToSize </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Zdim</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00638">638</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;{</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;std::complex&lt;double&gt;</a> &gt; aux;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#gafc49d813bd3c47ca193e504888d78b2a">scaleToSize</a>(SplineDegree, V1, aux, Xdim, Ydim, Zdim);</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gafc49d813bd3c47ca193e504888d78b2a"><div class="ttname"><a href="group__GeometricalTransformations.html#gafc49d813bd3c47ca193e504888d78b2a">scaleToSize</a></div><div class="ttdeci">void scaleToSize(int SplineDegree, MultidimArrayGeneric &amp;V2, const MultidimArrayGeneric &amp;V1, int Xdim, int Ydim, int Zdim)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00595">transformations.cpp:595</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gae9f9e35557a7659baf5a1bdbe62e3afc"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void selfTranslate </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wrap</em> = <code><a class="el" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>outside</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Translate an array.</p>
<p>The same as the previous function, but input array is overwritten </p>

<p>Definition at line <a class="el" href="transformations_8h_source.html#l01176">1176</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;{</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;T&gt;</a> aux = V1;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    V1.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga055e247ebfb6905fd478fa0dc73f382e">translate</a>(SplineDegree, V1, aux, v, wrap, outside);</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;}</div><div class="ttc" id="group__GeometricalTransformations_html_ga055e247ebfb6905fd478fa0dc73f382e"><div class="ttname"><a href="group__GeometricalTransformations.html#ga055e247ebfb6905fd478fa0dc73f382e">translate</a></div><div class="ttdeci">void translate(int SplineDegree, MultidimArray&lt; T &gt; &amp;V2, const MultidimArray&lt; T &gt; &amp;V1, const Matrix1D&lt; double &gt; &amp;v, bool wrap=WRAP, T outside=0)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01154">transformations.h:1154</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga360426b8d752570a9001671712665d69"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void selfTranslateCenterOfMassToCenter </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wrap</em> = <code><a class="el" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Translate center of mass to center</p>
<p>The same as the previous function, but input array is overwritten </p>

<p>Definition at line <a class="el" href="transformations_8h_source.html#l01212">1212</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;{</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;T&gt;</a> aux = V1;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    V1.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga735401e4b0f0a7ba162379cd9d79d6ce">translateCenterOfMassToCenter</a>(SplineDegree, V1, aux, wrap);</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga735401e4b0f0a7ba162379cd9d79d6ce"><div class="ttname"><a href="group__GeometricalTransformations.html#ga735401e4b0f0a7ba162379cd9d79d6ce">translateCenterOfMassToCenter</a></div><div class="ttdeci">void translateCenterOfMassToCenter(int SplineDegree, MultidimArray&lt; T &gt; &amp;V2, const MultidimArray&lt; T &gt; &amp;V1, bool wrap=WRAP)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01193">transformations.h:1193</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga2623912568cc54d33c74f63f445a1d26"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void string2TransformationMatrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a> &amp;&#160;</td>
          <td class="paramname"><em>matrixStr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>dim</em> = <code>4</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieve the matrix from an string representation Valid formats are: [[1, 0, 0, 0], [0, 1, 0, 0], [0, 0, 1, 0], [0, 0, 0, 1]] or 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1 or 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 </p>

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00092">92</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;{</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  matrix.<a class="code" href="classMatrix2D.html#a6928f78d5ccff2c21a26811702fa4d82">resizeNoCopy</a>(dim, dim);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a> matrixStrCopy(matrixStr);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordtype">char</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; matrixStr.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    c = matrixStr[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;[&#39;</span> <a class="code" href="numerical__recipes_8cpp.html#a4e22223cce6cd87a8eb1b271ab21c639">or</a> c == <span class="charliteral">&#39;]&#39;</span> <a class="code" href="numerical__recipes_8cpp.html#a4e22223cce6cd87a8eb1b271ab21c639">or</a> c == <span class="charliteral">&#39;,&#39;</span>)</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      matrixStrCopy[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <span class="charliteral">&#39; &#39;</span>;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = 4; <span class="comment">// EMX matrix are always 4x4</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  std::stringstream ss(matrixStrCopy);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">size_t</span> d_1 = dim - 1;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>; ++<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="comment">//TODO validate that M(dim, dim) is 1</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="comment">//if (i == dim-1 &amp;&amp; j == dim-1)</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      ss &gt;&gt; <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(matrix, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dim ? <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> : <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; dim ? <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> : <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>-1);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(matrix, d_1, d_1) = 1.;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMatrix2D_html_a6928f78d5ccff2c21a26811702fa4d82"><div class="ttname"><a href="classMatrix2D.html#a6928f78d5ccff2c21a26811702fa4d82">Matrix2D::resizeNoCopy</a></div><div class="ttdeci">void resizeNoCopy(int Ydim, int Xdim)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00664">matrix2d.h:664</a></div></div>
<div class="ttc" id="group__Matrices_html_gaf0f6abe0342cabe025337d656f034e87"><div class="ttname"><a href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a></div><div class="ttdeci">#define dMij(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00140">matrix2d.h:140</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="xmipp__strings_8h_html_afbeda3fd1bdc8c37d01bdf9f5c8274ff"><div class="ttname"><a href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a></div><div class="ttdeci">std::string String</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__strings_8h_source.html#l00034">xmipp_strings.h:34</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a4e22223cce6cd87a8eb1b271ab21c639"><div class="ttname"><a href="numerical__recipes_8cpp.html#a4e22223cce6cd87a8eb1b271ab21c639">or</a></div><div class="ttdeci">or</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05518">numerical_recipes.cpp:5518</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga460d3da338c37f4a55b631b8e9e327c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void transformationMatrix2Geo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMDRow.html">MDRow</a> &amp;&#160;</td>
          <td class="paramname"><em>imageGeo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieve the geometry transfomations from matrix </p>

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00181">181</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;{</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordtype">bool</span> flip = <span class="keyword">false</span>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordtype">double</span> scale = 1, shiftX = 0, shiftY = 0, <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a> = 0, shiftZ = 0, rot = 0, tilt = 0;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordtype">int</span> dim = A.<a class="code" href="classMatrix2D.html#aba34255aa8d181d565014abf744c5dd1">Xdim</a>() - 1;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> (dim == 2)</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#gab70aa0d1b7ed21012af53afc71b13930">transformationMatrix2Parameters2D</a>(A, flip, scale, shiftX, shiftY, <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 3)</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga8d2783cc5053c7ed71d61a5044e16abd">transformationMatrix2Parameters3D</a>(A, flip, scale, shiftX, shiftY, shiftZ,</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                          rot, tilt, <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <a class="code" href="transformations_8cpp.html#ab3fb5a3cecb5a874bbfa8daf42fa673e">ADD_IF_EXIST_NONZERO</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a59fffce298c0f99a1d592544d3d39a08">MDL_ANGLE_ROT</a>, rot);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <a class="code" href="transformations_8cpp.html#ab3fb5a3cecb5a874bbfa8daf42fa673e">ADD_IF_EXIST_NONZERO</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac15f836e18a2035d2923ecf76c6e8c7f">MDL_ANGLE_TILT</a>, tilt);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <a class="code" href="transformations_8cpp.html#ab3fb5a3cecb5a874bbfa8daf42fa673e">ADD_IF_EXIST_NONZERO</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aa66f1aad407cfbd08f582453ffa68c3e">MDL_SHIFT_Z</a>, shiftZ);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="transformations_8cpp.html#ab3fb5a3cecb5a874bbfa8daf42fa673e">ADD_IF_EXIST_NONZERO</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a114e3414dd216e4308946a016b5cc46f">MDL_ANGLE_PSI</a>, <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="transformations_8cpp.html#ab3fb5a3cecb5a874bbfa8daf42fa673e">ADD_IF_EXIST_NONZERO</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acb3aa7acca32f4524608635e2e09650e">MDL_SHIFT_X</a>, shiftX);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="transformations_8cpp.html#ab3fb5a3cecb5a874bbfa8daf42fa673e">ADD_IF_EXIST_NONZERO</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab00882fc483e9a1a7e6af5829a6afb8e">MDL_SHIFT_Y</a>, shiftY);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">if</span> (imageGeo.<a class="code" href="classMDRow.html#a43d04d2d479adff3735e0dfb9e40942b">containsLabel</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aad487c1de68c3a3b8f44773ee776d87c">MDL_SCALE</a>) || !<a class="code" href="group__Macros.html#ga6a5ec2c8ec1b157d7ab56ea0e5a1f2fb">XMIPP_EQUAL_REAL</a>(scale, 1.))</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        imageGeo.<a class="code" href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aad487c1de68c3a3b8f44773ee776d87c">MDL_SCALE</a>, scale);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">if</span> (imageGeo.<a class="code" href="classMDRow.html#a43d04d2d479adff3735e0dfb9e40942b">containsLabel</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af6495a877b8c80b9c45b8156b406b183">MDL_FLIP</a>) || flip)</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        imageGeo.<a class="code" href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af6495a877b8c80b9c45b8156b406b183">MDL_FLIP</a>, flip);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;}</div><div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a59fffce298c0f99a1d592544d3d39a08"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a59fffce298c0f99a1d592544d3d39a08">MDL_ANGLE_ROT</a></div><div class="ttdoc">Rotation angle of an image (double,degrees) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00057">metadata_label.h:57</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gab70aa0d1b7ed21012af53afc71b13930"><div class="ttname"><a href="group__GeometricalTransformations.html#gab70aa0d1b7ed21012af53afc71b13930">transformationMatrix2Parameters2D</a></div><div class="ttdeci">void transformationMatrix2Parameters2D(const Matrix2D&lt; T &gt; &amp;A, bool &amp;flip, T &amp;scale, T &amp;shiftX, T &amp;shiftY, T &amp;psi)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00123">transformations.cpp:123</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac15f836e18a2035d2923ecf76c6e8c7f"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac15f836e18a2035d2923ecf76c6e8c7f">MDL_ANGLE_TILT</a></div><div class="ttdoc">Tilting angle of an image (double,degrees) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00060">metadata_label.h:60</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78acb3aa7acca32f4524608635e2e09650e"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acb3aa7acca32f4524608635e2e09650e">MDL_SHIFT_X</a></div><div class="ttdoc">Shift for the image in the X axis (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00412">metadata_label.h:412</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a114e3414dd216e4308946a016b5cc46f"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a114e3414dd216e4308946a016b5cc46f">MDL_ANGLE_PSI</a></div><div class="ttdoc">Special label to be used when gathering MDs in MpiMetadataPrograms. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00054">metadata_label.h:54</a></div></div>
<div class="ttc" id="group__Macros_html_ga6a5ec2c8ec1b157d7ab56ea0e5a1f2fb"><div class="ttname"><a href="group__Macros.html#ga6a5ec2c8ec1b157d7ab56ea0e5a1f2fb">XMIPP_EQUAL_REAL</a></div><div class="ttdeci">#define XMIPP_EQUAL_REAL(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00122">xmipp_macros.h:122</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga8d2783cc5053c7ed71d61a5044e16abd"><div class="ttname"><a href="group__GeometricalTransformations.html#ga8d2783cc5053c7ed71d61a5044e16abd">transformationMatrix2Parameters3D</a></div><div class="ttdeci">void transformationMatrix2Parameters3D(const Matrix2D&lt; double &gt; &amp;A, bool &amp;flip, double &amp;scale, double &amp;shiftX, double &amp;shiftY, double &amp;shiftZ, double &amp;rot, double &amp;tilt, double &amp;psi)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00146">transformations.cpp:146</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af6495a877b8c80b9c45b8156b406b183"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af6495a877b8c80b9c45b8156b406b183">MDL_FLIP</a></div><div class="ttdoc">Flip the image? (bool) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00231">metadata_label.h:231</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78aad487c1de68c3a3b8f44773ee776d87c"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aad487c1de68c3a3b8f44773ee776d87c">MDL_SCALE</a></div><div class="ttdoc">scaling factor for an image or volume (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00385">metadata_label.h:385</a></div></div>
<div class="ttc" id="classMDRow_html_a916bbf19ab9a48f400800160b9b581fa"><div class="ttname"><a href="classMDRow.html#a916bbf19ab9a48f400800160b9b581fa">MDRow::setValue</a></div><div class="ttdeci">void setValue(MDLabel label, const T &amp;d, bool addLabel=true)</div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l01168">metadata_label.h:1168</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="classMatrix2D_html_aba34255aa8d181d565014abf744c5dd1"><div class="ttname"><a href="classMatrix2D.html#aba34255aa8d181d565014abf744c5dd1">Matrix2D::Xdim</a></div><div class="ttdeci">size_t Xdim() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00728">matrix2d.h:728</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78aa66f1aad407cfbd08f582453ffa68c3e"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aa66f1aad407cfbd08f582453ffa68c3e">MDL_SHIFT_Z</a></div><div class="ttdoc">Shift for the image in the Z axis (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00418">metadata_label.h:418</a></div></div>
<div class="ttc" id="transformations_8cpp_html_ab3fb5a3cecb5a874bbfa8daf42fa673e"><div class="ttname"><a href="transformations_8cpp.html#ab3fb5a3cecb5a874bbfa8daf42fa673e">ADD_IF_EXIST_NONZERO</a></div><div class="ttdeci">#define ADD_IF_EXIST_NONZERO(label, value)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00178">transformations.cpp:178</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab00882fc483e9a1a7e6af5829a6afb8e"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab00882fc483e9a1a7e6af5829a6afb8e">MDL_SHIFT_Y</a></div><div class="ttdoc">Shift for the image in the Y axis (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00415">metadata_label.h:415</a></div></div>
<div class="ttc" id="classMDRow_html_a43d04d2d479adff3735e0dfb9e40942b"><div class="ttname"><a href="classMDRow.html#a43d04d2d479adff3735e0dfb9e40942b">MDRow::containsLabel</a></div><div class="ttdeci">bool containsLabel(MDLabel label) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8cpp_source.html#l00775">metadata_label.cpp:775</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gab70aa0d1b7ed21012af53afc71b13930"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void transformationMatrix2Parameters2D </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>flip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T &amp;&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T &amp;&#160;</td>
          <td class="paramname"><em>shiftX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T &amp;&#160;</td>
          <td class="paramname"><em>shiftY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T &amp;&#160;</td>
          <td class="paramname"><em>psi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieve the geometry transformations from matrix for 2D. </p>

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00123">123</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;{</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// FIXME DS this might not be true, but just to make sure</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    static_assert(std::is_floating_point&lt;T&gt;::value,</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="stringliteral">&quot;Only float and double are allowed as template parameters&quot;</span>);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">//Calculate determinant for getting flip</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    flip = ((<a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(A, 0, 0) * <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(A, 1, 1) - <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(A, 0, 1) * <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(A, 1, 0) ) &lt; 0);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordtype">int</span> sgn = flip ? -1 : 1;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    T cosine = sgn * <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(A, 0, 0);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    T sine = sgn * <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(A, 0, 1);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    T scale2 = cosine * cosine +  sine * sine;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    scale = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(scale2);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    T invScale = 1 / scale;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    shiftX = <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(A, 0, 2) * invScale;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    shiftY = <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(A, 1, 2) * invScale;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a> = <a class="code" href="group__Macros.html#ga18b5ff2c19b69c072069398c7a5520cd">RAD2DEG</a>(atan2(sine, cosine));</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;}</div><div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="group__Matrices_html_gaf0f6abe0342cabe025337d656f034e87"><div class="ttname"><a href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a></div><div class="ttdeci">#define dMij(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00140">matrix2d.h:140</a></div></div>
<div class="ttc" id="group__Macros_html_ga18b5ff2c19b69c072069398c7a5520cd"><div class="ttname"><a href="group__Macros.html#ga18b5ff2c19b69c072069398c7a5520cd">RAD2DEG</a></div><div class="ttdeci">#define RAD2DEG(r)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00320">xmipp_macros.h:320</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga8d2783cc5053c7ed71d61a5044e16abd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void transformationMatrix2Parameters3D </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>flip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>shiftX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>shiftY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>shiftZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>tilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>psi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieve the geometry transformations from matrix for D. </p>

<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00146">146</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;{</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    scale =  <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(<a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(A,2,0)*<a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(A,2,0) \</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                  + <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(A,2,1)*<a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(A,2,1)\</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                  + <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(A,2,2)*<a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(A,2,2) );</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordtype">double</span> invScale = 1./ scale;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> tmpMatrix(4,4);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="group__Matrices.html#ga9322b16bc590b58c44a2c92ba58fe805">M4x4_BY_CT</a>(tmpMatrix, A, invScale);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> eulerMatrix(3,3);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="group__Matrices.html#ga80aee91a3508fa5d1df6fc0ee3693b06">FOR_ALL_ELEMENTS_IN_MATRIX2D</a>(eulerMatrix)</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(eulerMatrix,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(tmpMatrix, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">//check determinant if -1 then flip = true</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    flip = tmpMatrix.det3x3() &lt; 0;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (flip)</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(eulerMatrix, 0, 0) *= -1.;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(eulerMatrix, 0, 1) *= -1.;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(eulerMatrix, 0, 2) *= -1.;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="group__Geometry.html#gaa0889ad000c2166f766c927fc7c2f58c">Euler_matrix2angles</a>(eulerMatrix, rot, tilt, <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    shiftX = <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(tmpMatrix,0,3);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    shiftY = <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(tmpMatrix,1,3);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    shiftZ = <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(tmpMatrix,2,3);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;}</div><div class="ttc" id="group__Matrices_html_ga80aee91a3508fa5d1df6fc0ee3693b06"><div class="ttname"><a href="group__Matrices.html#ga80aee91a3508fa5d1df6fc0ee3693b06">FOR_ALL_ELEMENTS_IN_MATRIX2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_MATRIX2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00105">matrix2d.h:105</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Matrices_html_gaf0f6abe0342cabe025337d656f034e87"><div class="ttname"><a href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a></div><div class="ttdeci">#define dMij(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00140">matrix2d.h:140</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="group__Geometry_html_gaa0889ad000c2166f766c927fc7c2f58c"><div class="ttname"><a href="group__Geometry.html#gaa0889ad000c2166f766c927fc7c2f58c">Euler_matrix2angles</a></div><div class="ttdeci">void Euler_matrix2angles(const Matrix2D&lt; double &gt; &amp;A, double &amp;alpha, double &amp;beta, double &amp;gamma, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00836">geometry.cpp:836</a></div></div>
<div class="ttc" id="group__Matrices_html_ga9322b16bc590b58c44a2c92ba58fe805"><div class="ttname"><a href="group__Matrices.html#ga9322b16bc590b58c44a2c92ba58fe805">M4x4_BY_CT</a></div><div class="ttdeci">#define M4x4_BY_CT(M2, M1, k)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00264">matrix2d.h:264</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga055e247ebfb6905fd478fa0dc73f382e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void translate </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wrap</em> = <code><a class="el" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>outside</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Translate a array.</p>
<p>The shift is given as a R2 or R3 vector (shift_X, shift_Y, shift_Z) for 2D and 3D arrays, respectively. An exception is thrown if the displacement is not a R3 vector.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// Displacement of 2 pixels down</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;V2 = V1.translate(vectorR3(0, 0, 2));</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="transformations_8h_source.html#l01154">1154</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;{</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt; double &gt;</a> tmp;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keywordflow">if</span> (V1.<a class="code" href="classMultidimArrayBase.html#afbb6b0117ab2bbad5949e688d32a7c0d">getDim</a>()==2)</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga85214d9ca1caaac30f8cb0b838339536">translation2DMatrix</a>(v, tmp,<span class="keyword">true</span>);</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (V1.<a class="code" href="classMultidimArrayBase.html#afbb6b0117ab2bbad5949e688d32a7c0d">getDim</a>()==3)</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga93d35b9f379a9cf966f6aff6c7c216c5">translation3DMatrix</a>(v, tmp,<span class="keyword">true</span>);</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa24918e77d512d272bc38188b58f78ac2">ERR_MULTIDIM_DIM</a>,<span class="stringliteral">&quot;translate ERROR: translate only valid for 2D or 3D arrays&quot;</span>);</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga667bc7e15d5132db020732ef87e9acb2">applyGeometry</a>(SplineDegree, V2, V1, tmp, <a class="code" href="transformations_8h.html#a855436c9d0ed5174df8917d5239d7597">IS_INV</a>, wrap, outside);</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga85214d9ca1caaac30f8cb0b838339536"><div class="ttname"><a href="group__GeometricalTransformations.html#ga85214d9ca1caaac30f8cb0b838339536">translation2DMatrix</a></div><div class="ttdeci">void translation2DMatrix(const Matrix1D&lt; T &gt; &amp;translation, Matrix2D&lt; T &gt; &amp;resMatrix, bool inverse=false)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00256">transformations.cpp:256</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga93d35b9f379a9cf966f6aff6c7c216c5"><div class="ttname"><a href="group__GeometricalTransformations.html#ga93d35b9f379a9cf966f6aff6c7c216c5">translation3DMatrix</a></div><div class="ttdeci">void translation3DMatrix(const Matrix1D&lt; T &gt; &amp;translation, Matrix2D&lt; T &gt; &amp;resMatrix, bool inverse=false)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00412">transformations.cpp:412</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga667bc7e15d5132db020732ef87e9acb2"><div class="ttname"><a href="group__GeometricalTransformations.html#ga667bc7e15d5132db020732ef87e9acb2">applyGeometry</a></div><div class="ttdeci">void applyGeometry(int SplineDegree, MultidimArray&lt; T &gt; &amp;__restrict__ V2, const MultidimArray&lt; T1 &gt; &amp;__restrict__ V1, const Matrix2D&lt; T2 &gt; &amp;At, bool inv, bool wrap, T outside=0, MultidimArray&lt; double &gt; *BcoeffsPtr=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00287">transformations.h:287</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="transformations_8h_html_a855436c9d0ed5174df8917d5239d7597"><div class="ttname"><a href="transformations_8h.html#a855436c9d0ed5174df8917d5239d7597">IS_INV</a></div><div class="ttdeci">#define IS_INV</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00040">transformations.h:40</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_afbb6b0117ab2bbad5949e688d32a7c0d"><div class="ttname"><a href="classMultidimArrayBase.html#afbb6b0117ab2bbad5949e688d32a7c0d">MultidimArrayBase::getDim</a></div><div class="ttdeci">int getDim() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01098">multidim_array.h:1098</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa24918e77d512d272bc38188b58f78ac2"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa24918e77d512d272bc38188b58f78ac2">ERR_MULTIDIM_DIM</a></div><div class="ttdoc">Incorrect MultidimArray dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00178">xmipp_error.h:178</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga735401e4b0f0a7ba162379cd9d79d6ce"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void translateCenterOfMassToCenter </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wrap</em> = <code><a class="el" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Translate center of mass to center</p>
<p>If the input has very high values, it is better to rescale it to be between 0 and 1. </p>

<p>Definition at line <a class="el" href="transformations_8h_source.html#l01193">1193</a> of file <a class="el" href="transformations_8h_source.html">transformations.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;{</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    V2 = V1;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    V2.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt; double &gt;</a> center;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    V2.<a class="code" href="classMultidimArray.html#a715e9e815c3c01d75dd0b322500f1fad">centerOfMass</a>(center);</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    center *= -1;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga055e247ebfb6905fd478fa0dc73f382e">translate</a>(SplineDegree, V2, V1, center, wrap, 0);</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;}</div><div class="ttc" id="group__GeometricalTransformations_html_ga055e247ebfb6905fd478fa0dc73f382e"><div class="ttname"><a href="group__GeometricalTransformations.html#ga055e247ebfb6905fd478fa0dc73f382e">translate</a></div><div class="ttdeci">void translate(int SplineDegree, MultidimArray&lt; T &gt; &amp;V2, const MultidimArray&lt; T &gt; &amp;V1, const Matrix1D&lt; double &gt; &amp;v, bool wrap=WRAP, T outside=0)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01154">transformations.h:1154</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="classMultidimArray_html_a715e9e815c3c01d75dd0b322500f1fad"><div class="ttname"><a href="classMultidimArray.html#a715e9e815c3c01d75dd0b322500f1fad">MultidimArray::centerOfMass</a></div><div class="ttdeci">void centerOfMass(Matrix1D&lt; double &gt; &amp;center, void *mask=NULL, size_t n=0)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04625">multidim_array.h:4625</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga85214d9ca1caaac30f8cb0b838339536"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void translation2DMatrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>translation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>resMatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>inverse</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a translational matrix (3x3) for images</p>
<p>The shift is given as a R2 vector (shift_X, shift_Y). An exception is thrown if the displacement is not a R2 vector.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// Displacement of 1 pixel to the right</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160; resMatrix = translation2DMatrix(vectorR2(1, 0));</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00256">256</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;{</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#gad6524c4e36da91aae3fb6f8564112364">VEC_XSIZE</a>(translation) != 2)</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a>, <span class="stringliteral">&quot;Translation2D_matrix: vector is not in R2&quot;</span>);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    resMatrix.<a class="code" href="classMatrix2D.html#a1b0afdb4a10ad1857db3db8b64715ba3">initIdentity</a>(3);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">if</span> (inverse)</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    {</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(resMatrix,0, 2) = -<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(translation);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(resMatrix,1, 2) = -<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(translation);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(resMatrix,0, 2) = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(translation);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(resMatrix,1, 2) = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(translation);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    }</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a></div><div class="ttdoc">Problem with matrix size. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00157">xmipp_error.h:157</a></div></div>
<div class="ttc" id="group__Vectors_html_gad6524c4e36da91aae3fb6f8564112364"><div class="ttname"><a href="group__Vectors.html#gad6524c4e36da91aae3fb6f8564112364">VEC_XSIZE</a></div><div class="ttdeci">#define VEC_XSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00080">matrix1d.h:80</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Matrices_html_gaf0f6abe0342cabe025337d656f034e87"><div class="ttname"><a href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a></div><div class="ttdeci">#define dMij(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00140">matrix2d.h:140</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="classMatrix2D_html_a1b0afdb4a10ad1857db3db8b64715ba3"><div class="ttname"><a href="classMatrix2D.html#a1b0afdb4a10ad1857db3db8b64715ba3">Matrix2D::initIdentity</a></div><div class="ttdeci">void initIdentity()</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00835">matrix2d.h:835</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga93d35b9f379a9cf966f6aff6c7c216c5"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void translation3DMatrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>translation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>resMatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>inverse</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a translational matrix (4x4) for volumes</p>
<p>The shift is given as a R3 vector (shift_X, shift_Y, shift_Z). An exception is thrown if the displacement is not a R3 vector.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// Displacement of 2 pixels down</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;resMatrix = translation3DMatrix(vectorR3(0, 0, 2));</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="transformations_8cpp_source.html#l00412">412</a> of file <a class="el" href="transformations_8cpp_source.html">transformations.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;{</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#gad6524c4e36da91aae3fb6f8564112364">VEC_XSIZE</a>(translation) != 3)</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a>, <span class="stringliteral">&quot;Translation3D_matrix: vector is not in R3&quot;</span>);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    resMatrix.<a class="code" href="classMatrix2D.html#a1b0afdb4a10ad1857db3db8b64715ba3">initIdentity</a>(4);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">if</span> (inverse)</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    {</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(resMatrix,0, 3) = -<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(translation);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(resMatrix,1, 3) = -<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(translation);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(resMatrix,2, 3) = -<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(translation);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    {</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(resMatrix,0, 3) = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(translation);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(resMatrix,1, 3) = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(translation);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(resMatrix,2, 3) = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(translation);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    }</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a></div><div class="ttdoc">Problem with matrix size. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00157">xmipp_error.h:157</a></div></div>
<div class="ttc" id="group__Vectors_html_gad6524c4e36da91aae3fb6f8564112364"><div class="ttname"><a href="group__Vectors.html#gad6524c4e36da91aae3fb6f8564112364">VEC_XSIZE</a></div><div class="ttdeci">#define VEC_XSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00080">matrix1d.h:80</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Matrices_html_gaf0f6abe0342cabe025337d656f034e87"><div class="ttname"><a href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a></div><div class="ttdeci">#define dMij(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00140">matrix2d.h:140</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="classMatrix2D_html_a1b0afdb4a10ad1857db3db8b64715ba3"><div class="ttname"><a href="classMatrix2D.html#a1b0afdb4a10ad1857db3db8b64715ba3">Matrix2D::initIdentity</a></div><div class="ttdeci">void initIdentity()</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00835">matrix2d.h:835</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
