<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Xmipp: Masks</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v3.23.11-Nereus</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Masks<div class="ingroups"><a class="el" href="group__Libraries.html">Libraries</a> &raquo; <a class="el" href="group__DataLibrary.html">Basic data library</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Masks:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__Masks.png" border="0" alt="" usemap="#group____Masks"/>
<map name="group____Masks" id="group____Masks">
</map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMask.html">Mask</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgMask.html">ProgMask</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gad28ec3eb633c0492e8c8eda0144ddc1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#gad28ec3eb633c0492e8c8eda0144ddc1e">apply_geo_binary_2D_mask</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A)</td></tr>
<tr class="separator:gad28ec3eb633c0492e8c8eda0144ddc1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8817e5e5196deb477827232365b8812f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga8817e5e5196deb477827232365b8812f">apply_geo_cont_2D_mask</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;mask, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A)</td></tr>
<tr class="separator:ga8817e5e5196deb477827232365b8812f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:gac9de3d29a36807613ac35b5179169b8e"><td class="memItemLeft" align="right" valign="top">constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a> = 1</td></tr>
<tr class="separator:gac9de3d29a36807613ac35b5179169b8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad17bd6c30fa379217b64dba93b7f53e3"><td class="memItemLeft" align="right" valign="top">constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a> = 2</td></tr>
<tr class="separator:gad17bd6c30fa379217b64dba93b7f53e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga208e6ec7969fa2afa47962bbe7a47dc1"><td class="memItemLeft" align="right" valign="top">constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga208e6ec7969fa2afa47962bbe7a47dc1">NO_ACTIVATE</a> = 0</td></tr>
<tr class="separator:ga208e6ec7969fa2afa47962bbe7a47dc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6048a038c89f2aac58cecd96aa9fee6b"><td class="memItemLeft" align="right" valign="top">constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga6048a038c89f2aac58cecd96aa9fee6b">ACTIVATE</a> = 1</td></tr>
<tr class="separator:ga6048a038c89f2aac58cecd96aa9fee6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Actual masks</h2></td></tr>
<tr class="memitem:gad0d072390d45045c014fd96f63e022bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#gad0d072390d45045c014fd96f63e022bc">RaisedCosineMask</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;mask, double <a class="el" href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a>, double <a class="el" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a>, int <a class="el" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a>=<a class="el" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a>, double <a class="el" href="project__crystal_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>=0, double <a class="el" href="project__crystal_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>=0, double <a class="el" href="splines_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>=0)</td></tr>
<tr class="separator:gad0d072390d45045c014fd96f63e022bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga670b6b4cac3aa318afb1758ba210ba2e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga670b6b4cac3aa318afb1758ba210ba2e">RaisedCrownMask</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;mask, double <a class="el" href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a>, double <a class="el" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a>, double pix_width, int <a class="el" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a>=<a class="el" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a>, double <a class="el" href="project__crystal_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>=0, double <a class="el" href="project__crystal_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>=0, double <a class="el" href="splines_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>=0)</td></tr>
<tr class="separator:ga670b6b4cac3aa318afb1758ba210ba2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf284df7ea9e569041cafa8477a421f84"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#gaf284df7ea9e569041cafa8477a421f84">KaiserMask</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;mask, double <a class="el" href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a>=0.01, double Deltaw=1.0/12.0)</td></tr>
<tr class="separator:gaf284df7ea9e569041cafa8477a421f84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeb66a36a7d6902696536b5e568a982e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#gaeb66a36a7d6902696536b5e568a982e0">SincMask</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;mask, double omega, int <a class="el" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a>=<a class="el" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a>, double <a class="el" href="project__crystal_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>=0, double <a class="el" href="project__crystal_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>=0, double <a class="el" href="splines_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>=0)</td></tr>
<tr class="separator:gaeb66a36a7d6902696536b5e568a982e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7289b52c50e1b5e8a8d500fe5e3d2ef0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga7289b52c50e1b5e8a8d500fe5e3d2ef0">SincKaiserMask</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;mask, double omega, double <a class="el" href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a>=0.01, double Deltaw=1.0/12.0)</td></tr>
<tr class="separator:ga7289b52c50e1b5e8a8d500fe5e3d2ef0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaf93cc29cff5705b942acc0f9f61d860"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#gaaf93cc29cff5705b942acc0f9f61d860">BlackmanMask</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;mask, int <a class="el" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a>=<a class="el" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a>, double <a class="el" href="project__crystal_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>=0, double <a class="el" href="project__crystal_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>=0, double <a class="el" href="splines_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>=0)</td></tr>
<tr class="separator:gaaf93cc29cff5705b942acc0f9f61d860"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacc23efbd540bb3a40a9fcb15221d7c58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#gacc23efbd540bb3a40a9fcb15221d7c58">SincBlackmanMask</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;mask, double omega, double power_percentage, double <a class="el" href="project__crystal_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>=0, double <a class="el" href="project__crystal_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>=0, double <a class="el" href="splines_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>=0)</td></tr>
<tr class="separator:gacc23efbd540bb3a40a9fcb15221d7c58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1f835f6611a65877b172c170a555f869"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga1f835f6611a65877b172c170a555f869">BinaryCircularMask</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, double radius, int <a class="el" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a>=<a class="el" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a>, double <a class="el" href="project__crystal_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>=0, double <a class="el" href="project__crystal_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>=0, double <a class="el" href="splines_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>=0)</td></tr>
<tr class="separator:ga1f835f6611a65877b172c170a555f869"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae4b008931c501e48d2e9164943743a5b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#gae4b008931c501e48d2e9164943743a5b">BlobCircularMask</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;mask, double <a class="el" href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a>, <a class="el" href="structblobtype.html">blobtype</a> blob, int <a class="el" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a>, double <a class="el" href="project__crystal_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>=0, double <a class="el" href="project__crystal_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>=0, double <a class="el" href="splines_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>=0)</td></tr>
<tr class="separator:gae4b008931c501e48d2e9164943743a5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab405cf3a919aaffa65a6385e01f78999"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#gab405cf3a919aaffa65a6385e01f78999">BinaryCrownMask</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, double R1, double R2, int <a class="el" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a>=<a class="el" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a>, double <a class="el" href="project__crystal_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>=0, double <a class="el" href="project__crystal_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>=0, double <a class="el" href="splines_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>=0)</td></tr>
<tr class="separator:gab405cf3a919aaffa65a6385e01f78999"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8ba643ec2d65c0d878013fbc04750eff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga8ba643ec2d65c0d878013fbc04750eff">BlobCrownMask</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;mask, double <a class="el" href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a>, double <a class="el" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a>, <a class="el" href="structblobtype.html">blobtype</a> blob, int <a class="el" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a>, double <a class="el" href="project__crystal_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>=0, double <a class="el" href="project__crystal_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>=0, double <a class="el" href="splines_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>=0)</td></tr>
<tr class="separator:ga8ba643ec2d65c0d878013fbc04750eff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga561afba8071986dbbe415ba0e783347c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga561afba8071986dbbe415ba0e783347c">GaussianMask</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;mask, double sigma, int <a class="el" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a>=<a class="el" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a>, double <a class="el" href="project__crystal_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>=0, double <a class="el" href="project__crystal_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>=0, double <a class="el" href="splines_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>=0)</td></tr>
<tr class="separator:ga561afba8071986dbbe415ba0e783347c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf0bf07594a130f3a48b874d30ebd5948"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#gaf0bf07594a130f3a48b874d30ebd5948">BinaryDWTCircularMask2D</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, double radius, int smin, int smax, const std::string &amp;quadrant)</td></tr>
<tr class="separator:gaf0bf07594a130f3a48b874d30ebd5948"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafc888c1bf492265e7dc9b8e3a540bc5b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#gafc888c1bf492265e7dc9b8e3a540bc5b">SeparableSincKaiserMask2D</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;mask, double omega, double <a class="el" href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a>=0.01, double Deltaw=1.0/12.0)</td></tr>
<tr class="separator:gafc888c1bf492265e7dc9b8e3a540bc5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga757ffa92a783e2bfee146c7139e15be0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga757ffa92a783e2bfee146c7139e15be0">mask2D_4neig</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, int value=1, int center=<a class="el" href="group__Masks.html#ga208e6ec7969fa2afa47962bbe7a47dc1">NO_ACTIVATE</a>)</td></tr>
<tr class="separator:ga757ffa92a783e2bfee146c7139e15be0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga38271c8bfabe440107efa83f762fba11"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga38271c8bfabe440107efa83f762fba11">mask2D_8neig</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, int value1=1, int value2=1, int center=<a class="el" href="group__Masks.html#ga208e6ec7969fa2afa47962bbe7a47dc1">NO_ACTIVATE</a>)</td></tr>
<tr class="separator:ga38271c8bfabe440107efa83f762fba11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaae4dd3c0dce82e6a95cb30874e11259"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#gaaae4dd3c0dce82e6a95cb30874e11259">BinaryDWTSphericalMask2D</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, double radius, int smin, int smax, const std::string &amp;quadrant)</td></tr>
<tr class="separator:gaaae4dd3c0dce82e6a95cb30874e11259"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6f39dced292a63fb18aa3480a8b7d791"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga6f39dced292a63fb18aa3480a8b7d791">BinaryCylinderMask</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, double R, double H, int <a class="el" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a>=<a class="el" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a>, double <a class="el" href="project__crystal_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>=0, double <a class="el" href="project__crystal_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>=0, int <a class="el" href="splines_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>=0)</td></tr>
<tr class="separator:ga6f39dced292a63fb18aa3480a8b7d791"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga73ea87c6fbf3515013c419aa19fe7eeb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga73ea87c6fbf3515013c419aa19fe7eeb">BinaryFrameMask</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, int Xrect, int Yrect, int Zrect, int <a class="el" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a>=<a class="el" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a>, double <a class="el" href="project__crystal_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>=0, double <a class="el" href="project__crystal_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>=0, double <a class="el" href="splines_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>=0)</td></tr>
<tr class="separator:ga73ea87c6fbf3515013c419aa19fe7eeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga19760f6c6ba30192b9c4c94b27da31c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga19760f6c6ba30192b9c4c94b27da31c4">BinaryConeMask</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, double <a class="el" href="numerical__recipes_8cpp.html#aca81c35c21e3a5f7f3a8d24504e76664">theta</a>, int <a class="el" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a>=<a class="el" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a>, bool centerOrigin=false)</td></tr>
<tr class="separator:ga19760f6c6ba30192b9c4c94b27da31c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga115614bf7aa8b05afd2ae53251affa8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga115614bf7aa8b05afd2ae53251affa8e">BinaryWedgeMask</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, double theta0, double thetaF, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A, bool centerOrigin=false)</td></tr>
<tr class="separator:ga115614bf7aa8b05afd2ae53251affa8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1943342930b9a077f8618f9f182442a6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga1943342930b9a077f8618f9f182442a6">mask3D_6neig</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, int value=1, int center=<a class="el" href="group__Masks.html#ga208e6ec7969fa2afa47962bbe7a47dc1">NO_ACTIVATE</a>)</td></tr>
<tr class="separator:ga1943342930b9a077f8618f9f182442a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa93258bba6703e7dd0bf23c6fedff86a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#gaa93258bba6703e7dd0bf23c6fedff86a">mask3D_18neig</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, int value1=1, int value2=1, int center=<a class="el" href="group__Masks.html#ga208e6ec7969fa2afa47962bbe7a47dc1">NO_ACTIVATE</a>)</td></tr>
<tr class="separator:gaa93258bba6703e7dd0bf23c6fedff86a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacac17e19d7b8f3ba81c01b1c5cbdf7a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#gacac17e19d7b8f3ba81c01b1c5cbdf7a8">mask3D_26neig</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, int value1=1, int value2=1, int value3=1, int center=<a class="el" href="group__Masks.html#ga208e6ec7969fa2afa47962bbe7a47dc1">NO_ACTIVATE</a>)</td></tr>
<tr class="separator:gacac17e19d7b8f3ba81c01b1c5cbdf7a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Mask Tools</h2></td></tr>
<tr><td class="ititle" colspan="2"><p><a class="anchor" id="amgrp9eb4d90214f92734c596dcad7fc0f9bc"></a>All <a class="el" href="classMask.html">Mask</a> tools work only in the overlapping area of the given image/volume and the mask in logical coordinates. Ie, if you have a mask defined from -2 to 2 and you apply it to an image defined from 0 to 63 then only those values of the mask between 0 and 2 will be applied. The rest of the image will remain untouched. This region where the mask is active within the overlapping area will be called in this documentation: active area. </p>
</td></tr>
<tr class="memitem:gacddf12a44ad18f7d3d7555e2d6918d2f"><td class="memItemLeft" align="right" valign="top">constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#gacddf12a44ad18f7d3d7555e2d6918d2f">COUNT_ABOVE</a> = 1</td></tr>
<tr class="separator:gacddf12a44ad18f7d3d7555e2d6918d2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6b609bf3ee4fe60e9623eb10678c52aa"><td class="memItemLeft" align="right" valign="top">constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga6b609bf3ee4fe60e9623eb10678c52aa">COUNT_BELOW</a> = 2</td></tr>
<tr class="separator:ga6b609bf3ee4fe60e9623eb10678c52aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7030285e58b95c96d766c3998d3d37d8"><td class="memItemLeft" align="right" valign="top">constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga7030285e58b95c96d766c3998d3d37d8">COUNT_BETWEEN</a> = 3</td></tr>
<tr class="separator:ga7030285e58b95c96d766c3998d3d37d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5bd552c32d3d6b6abd6ddf18677cf647"><td class="memTemplParams" colspan="2">template&lt;typename T1 , typename T &gt; </td></tr>
<tr class="memitem:ga5bd552c32d3d6b6abd6ddf18677cf647"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga5bd552c32d3d6b6abd6ddf18677cf647">computeStats_within_binary_mask</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T1 &gt; &amp;mask, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, double &amp;min_val, double &amp;max_val, double &amp;avg, double &amp;stddev)</td></tr>
<tr class="separator:ga5bd552c32d3d6b6abd6ddf18677cf647"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga42e921a8bf2008e6141e17dd9f0bdff4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga42e921a8bf2008e6141e17dd9f0bdff4">computeStats_within_binary_mask</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, const <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;<a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, double &amp;min_val, double &amp;max_val, double &amp;avg, double &amp;stddev)</td></tr>
<tr class="separator:ga42e921a8bf2008e6141e17dd9f0bdff4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadf8e3471e09288a8c320d1d900695c21"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:gadf8e3471e09288a8c320d1d900695c21"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Masks.html#gadf8e3471e09288a8c320d1d900695c21">apply_binary_mask</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;m_in, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;m_out, T subs_val=(T) 0)</td></tr>
<tr class="separator:gadf8e3471e09288a8c320d1d900695c21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2ff19e7dc6c1636236c98c65584b6116"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga2ff19e7dc6c1636236c98c65584b6116"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga2ff19e7dc6c1636236c98c65584b6116">apply_cont_mask</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;mask, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;m_in, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;m_out)</td></tr>
<tr class="separator:ga2ff19e7dc6c1636236c98c65584b6116"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad522883b557df4c83ab2e7dddb6d8d85"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:gad522883b557df4c83ab2e7dddb6d8d85"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Masks.html#gad522883b557df4c83ab2e7dddb6d8d85">compute_hist_within_binary_mask</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;v, <a class="el" href="classHistogram1D.html">Histogram1D</a> &amp;hist, int no_steps)</td></tr>
<tr class="separator:gad522883b557df4c83ab2e7dddb6d8d85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga514151c832d31a137fe4febb708071c3"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga514151c832d31a137fe4febb708071c3"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga514151c832d31a137fe4febb708071c3">compute_hist_within_binary_mask</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;v, <a class="el" href="classHistogram1D.html">Histogram1D</a> &amp;hist, T <a class="el" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">min</a>, T <a class="el" href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">max</a>, int no_steps)</td></tr>
<tr class="separator:ga514151c832d31a137fe4febb708071c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9d22d919d00b6979db4b8500233604ac"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga9d22d919d00b6979db4b8500233604ac"><td class="memTemplItemLeft" align="right" valign="top">int&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga9d22d919d00b6979db4b8500233604ac">count_with_mask</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, int <a class="el" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a>, double th1, double th2)</td></tr>
<tr class="separator:ga9d22d919d00b6979db4b8500233604ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0eb8cc6f4757102d7a1a7a9b2f8d1194"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga0eb8cc6f4757102d7a1a7a9b2f8d1194">count_with_mask</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, int <a class="el" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a>, double th1, double th2)</td></tr>
<tr class="separator:ga0eb8cc6f4757102d7a1a7a9b2f8d1194"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab3da3cb40033e29917d151e7508b0ab6"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:gab3da3cb40033e29917d151e7508b0ab6"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Masks.html#gab3da3cb40033e29917d151e7508b0ab6">invert_binary_mask</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;mask)</td></tr>
<tr class="separator:gab3da3cb40033e29917d151e7508b0ab6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacc5b7b7c85913b08abc68b4827bd4295"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#gacc5b7b7c85913b08abc68b4827bd4295">rangeAdjust_within_mask</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *mask, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;m1, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;m2)</td></tr>
<tr class="separator:gacc5b7b7c85913b08abc68b4827bd4295"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9dd2cc0b63459aec2634e3ee8e4538ff"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga9dd2cc0b63459aec2634e3ee8e4538ff">count_with_mask_above</a>(mask,  <a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>,  th)&#160;&#160;&#160;<a class="el" href="group__Masks.html#ga0eb8cc6f4757102d7a1a7a9b2f8d1194">count_with_mask</a>(mask, <a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, <a class="el" href="group__Masks.html#gacddf12a44ad18f7d3d7555e2d6918d2f">COUNT_ABOVE</a>, th, 0);</td></tr>
<tr class="separator:ga9dd2cc0b63459aec2634e3ee8e4538ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga61cc916828a42cbedf420a67415af1bb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#ga61cc916828a42cbedf420a67415af1bb">count_with_mask_below</a>(mask,  <a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>,  th)&#160;&#160;&#160;<a class="el" href="group__Masks.html#ga0eb8cc6f4757102d7a1a7a9b2f8d1194">count_with_mask</a>(mask, <a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, <a class="el" href="group__Masks.html#ga6b609bf3ee4fe60e9623eb10678c52aa">COUNT_BELOW</a>, th, 0);</td></tr>
<tr class="separator:ga61cc916828a42cbedf420a67415af1bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa220a98c83e9ea3c5d100e8c66ac49ef"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Masks.html#gaa220a98c83e9ea3c5d100e8c66ac49ef">count_with_mask_between</a>(mask,  <a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>,  th1,  th2)&#160;&#160;&#160;<a class="el" href="group__Masks.html#ga0eb8cc6f4757102d7a1a7a9b2f8d1194">count_with_mask</a>(mask, <a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, <a class="el" href="group__Masks.html#ga7030285e58b95c96d766c3998d3d37d8">COUNT_BETWEEN</a>, th1, th2);</td></tr>
<tr class="separator:gaa220a98c83e9ea3c5d100e8c66ac49ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga9dd2cc0b63459aec2634e3ee8e4538ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9dd2cc0b63459aec2634e3ee8e4538ff">&#9670;&nbsp;</a></span>count_with_mask_above</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define count_with_mask_above</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">mask, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">th&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="group__Masks.html#ga0eb8cc6f4757102d7a1a7a9b2f8d1194">count_with_mask</a>(mask, <a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, <a class="el" href="group__Masks.html#gacddf12a44ad18f7d3d7555e2d6918d2f">COUNT_ABOVE</a>, th, 0);</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Count pixels/voxels with mask and above a threshold</p>
<p>Those pixels within the mask with a value greater or equal than a threshold are counted. This function makes a call to count_with_mask </p>

<p class="definition">Definition at line <a class="el" href="mask_8h_source.html#l00951">951</a> of file <a class="el" href="mask_8h_source.html">mask.h</a>.</p>

</div>
</div>
<a id="ga61cc916828a42cbedf420a67415af1bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga61cc916828a42cbedf420a67415af1bb">&#9670;&nbsp;</a></span>count_with_mask_below</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define count_with_mask_below</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">mask, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">th&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="group__Masks.html#ga0eb8cc6f4757102d7a1a7a9b2f8d1194">count_with_mask</a>(mask, <a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, <a class="el" href="group__Masks.html#ga6b609bf3ee4fe60e9623eb10678c52aa">COUNT_BELOW</a>, th, 0);</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Count pixels/voxels with mask and below a threshold</p>
<p>Those pixels within the mask with a value smaller or equal than a threshold are counted. This function makes a call to count_with_mask </p>

<p class="definition">Definition at line <a class="el" href="mask_8h_source.html#l00959">959</a> of file <a class="el" href="mask_8h_source.html">mask.h</a>.</p>

</div>
</div>
<a id="gaa220a98c83e9ea3c5d100e8c66ac49ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa220a98c83e9ea3c5d100e8c66ac49ef">&#9670;&nbsp;</a></span>count_with_mask_between</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define count_with_mask_between</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">mask, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">th1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">th2&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="group__Masks.html#ga0eb8cc6f4757102d7a1a7a9b2f8d1194">count_with_mask</a>(mask, <a class="el" href="numerical__recipes_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, <a class="el" href="group__Masks.html#ga7030285e58b95c96d766c3998d3d37d8">COUNT_BETWEEN</a>, th1, th2);</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Count pixels/voxels with mask and between two thresholds</p>
<p>Those pixels within the mask with a value greater or equal than th1 and smaller or equal than th2 are counted. This function makes a call to count_with_mask </p>

<p class="definition">Definition at line <a class="el" href="mask_8h_source.html#l00968">968</a> of file <a class="el" href="mask_8h_source.html">mask.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gadf8e3471e09288a8c320d1d900695c21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadf8e3471e09288a8c320d1d900695c21">&#9670;&nbsp;</a></span>apply_binary_mask()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void apply_binary_mask </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>m_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>m_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>subs_val</em> = <code>(T)&#160;0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply mask to a <a class="el" href="classMultidimArray.html">MultidimArray</a></p>
<p>The volume values for which the input mask is 0 are set to 0. The input and output volumes can be the same ones. </p>

<p class="definition">Definition at line <a class="el" href="mask_8h_source.html#l00857">857</a> of file <a class="el" href="mask_8h_source.html">mask.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;{</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    m_out.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(m_in);</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(m_out)</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="comment">// If in common with the mask</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> &gt;= <a class="code" href="multidim__array__base_8h.html#aafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(mask) &amp;&amp; <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> &lt;= <a class="code" href="multidim__array__base_8h.html#a706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(mask) &amp;&amp;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;= <a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(mask) &amp;&amp; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= <a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(mask) &amp;&amp;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &gt;= <a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(mask) &amp;&amp; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt;= <a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(mask))</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) == 0)</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(m_out, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = subs_val;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(m_out, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(m_in, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">// It is not in common, leave the original one</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(m_out, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(m_in, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00983">multidim_array.cpp:983</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a706d2ce724d393d4d759a46225bbc6c1"><div class="ttname"><a href="multidim__array__base_8h.html#a706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a></div><div class="ttdeci">#define FINISHINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00071">multidim_array_base.h:71</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="multidim__array__base_8h_html_a6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00059">multidim_array_base.h:59</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00269">multidim_array_base.h:269</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00063">multidim_array_base.h:63</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_aafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="multidim__array__base_8h.html#aafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00067">multidim_array_base.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga2ff19e7dc6c1636236c98c65584b6116"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2ff19e7dc6c1636236c98c65584b6116">&#9670;&nbsp;</a></span>apply_cont_mask()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void apply_cont_mask </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>m_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>m_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply continuous mask to a <a class="el" href="classMultidimArray.html">MultidimArray</a></p>
<p>The image is multiplied by the mask. The input and output matrices can be the same ones. Only the overlapping values are affected by the mask. </p>

<p class="definition">Definition at line <a class="el" href="mask_8h_source.html#l00881">881</a> of file <a class="el" href="mask_8h_source.html">mask.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;{</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    m_out.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(m_in);</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(m_out)</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="comment">// If in common with the mask</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> &gt;= <a class="code" href="multidim__array__base_8h.html#aafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(mask)) &amp;&amp; (<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> &lt;= <a class="code" href="multidim__array__base_8h.html#a706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(mask)) &amp;&amp;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;= <a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(mask)) &amp;&amp; (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= <a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(mask)) &amp;&amp;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &gt;= <a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(mask) &amp;&amp; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt;= <a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(mask)))</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    {</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(m_out, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = (T)(<a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(m_in, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) * <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    }</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="comment">// It is not in common, leave the original one</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(m_out, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(m_in, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00983">multidim_array.cpp:983</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a706d2ce724d393d4d759a46225bbc6c1"><div class="ttname"><a href="multidim__array__base_8h.html#a706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a></div><div class="ttdeci">#define FINISHINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00071">multidim_array_base.h:71</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="multidim__array__base_8h_html_a6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00059">multidim_array_base.h:59</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00269">multidim_array_base.h:269</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00063">multidim_array_base.h:63</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_aafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="multidim__array__base_8h.html#aafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00067">multidim_array_base.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gad28ec3eb633c0492e8c8eda0144ddc1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad28ec3eb633c0492e8c8eda0144ddc1e">&#9670;&nbsp;</a></span>apply_geo_binary_2D_mask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void apply_geo_binary_2D_mask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply geometric transformation to a binary (2D) mask </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l01682">1682</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;{</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> tmp;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    tmp.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(mask);</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <a class="code" href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a>(mask, tmp);</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <span class="keywordtype">double</span> outside = <a class="code" href="multidim__array__base_8h.html#a9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(tmp, 0, 0);</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> tmp2;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    tmp2 = tmp;</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    <span class="comment">// Instead of IS_INV for images use IS_NOT_INV for masks!</span></div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a>(<a class="code" href="namespacexmipp__transformation.html#ac5f2bd2937d73c34ed4f6c6c5ff2492aaffcd115cf9fbf6a51a8b2862062acc74">xmipp_transformation::LINEAR</a>, tmp, tmp2, A, xmipp_transformation::IS_NOT_INV, xmipp_transformation::DONT_WRAP, outside);</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <span class="comment">// The type cast gives strange results here, using round instead</span></div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <span class="comment">//typeCast(tmp, mask);</span></div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a>(mask)</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    {</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;        <a class="code" href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a>(mask,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)=<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a>(tmp,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        <span class="comment">//        std::cout &lt;&lt; &quot;i, j = &quot; &lt;&lt; i &lt;&lt; &quot;,&quot; &lt;&lt; j &lt;&lt;std::endl;</span></div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    }</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00983">multidim_array.cpp:983</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4e8db4e5757ca2f6e233d0a1eec7ff1c"><div class="ttname"><a href="multidim__array__base_8h.html#a4e8db4e5757ca2f6e233d0a1eec7ff1c">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00509">multidim_array_base.h:509</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_afa02b309a507bf04daf9f31fa828ce4f"><div class="ttname"><a href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a></div><div class="ttdeci">#define dAij(M, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00345">multidim_array_base.h:345</a></div></div>
<div class="ttc" id="namespacexmipp__transformation_html_ac5f2bd2937d73c34ed4f6c6c5ff2492aaffcd115cf9fbf6a51a8b2862062acc74"><div class="ttname"><a href="namespacexmipp__transformation.html#ac5f2bd2937d73c34ed4f6c6c5ff2492aaffcd115cf9fbf6a51a8b2862062acc74">xmipp_transformation::LINEAR</a></div><div class="ttdef"><b>Definition:</b> <a href="transformations__defines_8h_source.html#l00032">transformations_defines.h:32</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga3cc15e5dda7c58b9cacb7eee440d6bdc"><div class="ttname"><a href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a></div><div class="ttdeci">void applyGeometry(int SplineDegree, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V2, const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V1, const Matrix2D&lt; double &gt; &amp;A, bool inv, bool wrap, std::complex&lt; double &gt; outside, MultidimArray&lt; double &gt; *BcoeffsPtr)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00668">transformations.cpp:668</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a9ed4376d9ad511e963caf118a6640b28"><div class="ttname"><a href="multidim__array__base_8h.html#a9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a></div><div class="ttdeci">#define DIRECT_A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00341">multidim_array_base.h:341</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__Vectors_html_gaf36b657319bb585c75cfa14744dab275"><div class="ttname"><a href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a></div><div class="ttdeci">void typeCast(const Matrix1D&lt; T1 &gt; &amp;v1, Matrix1D&lt; T2 &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01227">matrix1d.h:1227</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga8817e5e5196deb477827232365b8812f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8817e5e5196deb477827232365b8812f">&#9670;&nbsp;</a></span>apply_geo_cont_2D_mask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void apply_geo_cont_2D_mask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply geometric transformation to a continuous (2D) mask </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l01703">1703</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;{</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    <span class="keywordtype">double</span> outside = <a class="code" href="multidim__array__base_8h.html#a9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(mask, 0, 0);</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> tmp = mask;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    <span class="comment">// Instead of IS_INV for images use IS_NOT_INV for masks!</span></div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a>(<a class="code" href="namespacexmipp__transformation.html#ac5f2bd2937d73c34ed4f6c6c5ff2492aaffcd115cf9fbf6a51a8b2862062acc74">xmipp_transformation::LINEAR</a>, tmp, mask, A, xmipp_transformation::IS_NOT_INV, xmipp_transformation::DONT_WRAP, outside);</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="namespacexmipp__transformation_html_ac5f2bd2937d73c34ed4f6c6c5ff2492aaffcd115cf9fbf6a51a8b2862062acc74"><div class="ttname"><a href="namespacexmipp__transformation.html#ac5f2bd2937d73c34ed4f6c6c5ff2492aaffcd115cf9fbf6a51a8b2862062acc74">xmipp_transformation::LINEAR</a></div><div class="ttdef"><b>Definition:</b> <a href="transformations__defines_8h_source.html#l00032">transformations_defines.h:32</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga3cc15e5dda7c58b9cacb7eee440d6bdc"><div class="ttname"><a href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a></div><div class="ttdeci">void applyGeometry(int SplineDegree, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V2, const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V1, const Matrix2D&lt; double &gt; &amp;A, bool inv, bool wrap, std::complex&lt; double &gt; outside, MultidimArray&lt; double &gt; *BcoeffsPtr)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00668">transformations.cpp:668</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a9ed4376d9ad511e963caf118a6640b28"><div class="ttname"><a href="multidim__array__base_8h.html#a9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a></div><div class="ttdeci">#define DIRECT_A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00341">multidim_array_base.h:341</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga1f835f6611a65877b172c170a555f869"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1f835f6611a65877b172c170a555f869">&#9670;&nbsp;</a></span>BinaryCircularMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BinaryCircularMask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em> = <code><a class="el" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z0</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a circular mask for already sized masks</p>
<p>The mask is supposed to be resized and with its logical origin already set. A circle placed logically at (x0,y0,z0), by default (0,0,0), is created with the radius indicated. The only two valid modes are INNER_MASK (by default) or OUTSIDE_MASK. When entering the mask is initialiazed to 0 and then the mask is created. </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00193">193</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;{</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    mask.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordtype">double</span> radius2 = <a class="code" href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">radius</a> * <a class="code" href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">radius</a>;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>=<a class="code" href="multidim__array__base_8h.html#aafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(mask); <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>&lt;=<a class="code" href="multidim__array__base_8h.html#a706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(mask); ++<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>)</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordtype">double</span> diff=<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> - <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordtype">double</span> z2=diff*diff;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=<a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(mask); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;=<a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(mask); ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            diff=<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            <span class="keywordtype">double</span> z2y2=z2+diff*diff;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(mask); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;=<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(mask); ++<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                diff=<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                <span class="keywordtype">double</span> <a class="code" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a> = z2y2+diff*diff;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                <span class="keywordflow">if</span> (r2 &lt;= radius2 &amp;&amp; <a class="code" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a> == <a class="code" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a>)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                    <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 1;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r2 &gt;= radius2 &amp;&amp; <a class="code" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a> == <a class="code" href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a>)</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                    <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 1;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            }</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        }</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;}</div><div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a3f5c4dfb0dff56801752771f78265fbe"><div class="ttname"><a href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a></div><div class="ttdeci">#define z0</div></div>
<div class="ttc" id="multidim__array__base_8h_html_a706d2ce724d393d4d759a46225bbc6c1"><div class="ttname"><a href="multidim__array__base_8h.html#a706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a></div><div class="ttdeci">#define FINISHINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00071">multidim_array_base.h:71</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="multidim__array__base_8h_html_a6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00059">multidim_array_base.h:59</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a0d9521fd31b2e16413d1b78836953d53"><div class="ttname"><a href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a></div><div class="ttdeci">#define y0</div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a74e37497baeb87072fb1730874e59adb"><div class="ttname"><a href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a></div><div class="ttdeci">void mode</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00063">multidim_array_base.h:63</a></div></div>
<div class="ttc" id="group__Masks_html_gad17bd6c30fa379217b64dba93b7f53e3"><div class="ttname"><a href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a></div><div class="ttdeci">constexpr int OUTSIDE_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00048">mask.h:48</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_ab7a69dabaa7151dae4d7a3998167e2f3"><div class="ttname"><a href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a></div><div class="ttdeci">float r2</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02723">multidim_array.h:2723</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_aafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="multidim__array__base_8h.html#aafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00067">multidim_array_base.h:67</a></div></div>
<div class="ttc" id="structblobtype_html_a292968bd7221739a3a58231353f0d0ec"><div class="ttname"><a href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">blobtype::radius</a></div><div class="ttdeci">double radius</div><div class="ttdoc">Spatial radius in Universal System units. </div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00115">blobs.h:115</a></div></div>
<div class="ttc" id="group__Masks_html_gac9de3d29a36807613ac35b5179169b8e"><div class="ttname"><a href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a></div><div class="ttdeci">constexpr int INNER_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00047">mask.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga19760f6c6ba30192b9c4c94b27da31c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga19760f6c6ba30192b9c4c94b27da31c4">&#9670;&nbsp;</a></span>BinaryConeMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BinaryConeMask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em> = <code><a class="el" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>centerOrigin</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a 3D cone mask for already sized masks</p>
<p>The mask is supposed to be resized and with its logical origin already set. A cone with angle theta is placed parallel to the Z-axis and centered at (x0,y0,z0). The only two valid modes are INNER_MASK (by default, inside the crown is zero, outside is 1) or OUTSIDE_MASK (the negative of the crown).</p>
<p>When entering the mask is initialiazed to 0 and then the mask is created. </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00488">488</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;{</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordtype">int</span> halfX = mask.<a class="code" href="classMultidimArrayBase.html#a6d50e69638ce9965ce56fbefa0840f2a">xdim</a>/2;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordtype">int</span> halfY = mask.<a class="code" href="classMultidimArrayBase.html#a239bae0a69ae7de31ed5627bdb65bda4">ydim</a>/2;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordtype">int</span> halfZ = mask.<a class="code" href="classMultidimArrayBase.html#ac51e2cd5a0f23b34bc903626fbe56ffd">zdim</a>/2;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordtype">int</span> minX = -halfX;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordtype">int</span> minY = -halfY;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordtype">int</span> minZ = -halfZ;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordtype">int</span> maxX = (int)((mask.<a class="code" href="classMultidimArrayBase.html#a6d50e69638ce9965ce56fbefa0840f2a">xdim</a>-0.5)/2);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordtype">int</span> maxY = (int)((mask.<a class="code" href="classMultidimArrayBase.html#a239bae0a69ae7de31ed5627bdb65bda4">ydim</a>-0.5)/2);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordtype">int</span> maxZ = (int)((mask.<a class="code" href="classMultidimArrayBase.html#ac51e2cd5a0f23b34bc903626fbe56ffd">zdim</a>-0.5)/2);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(mask)</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keywordtype">int</span> kpp = <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ac70543792196a6e073812077da9208ba">ipp</a> = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordtype">int</span> jpp = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keywordflow">if</span> (centerOrigin)</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        {</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            kpp = <a class="code" href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a> (<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>+halfZ,minZ,maxZ);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            ipp = <a class="code" href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a> (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+halfY,minY,maxY);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            jpp = <a class="code" href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a> (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>+halfX,minX,maxX);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        }</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordtype">double</span> rad = tan(<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * <a class="code" href="numerical__recipes_8cpp.html#aca81c35c21e3a5f7f3a8d24504e76664">theta</a> / 180.) * (double)<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordflow">if</span> ((<span class="keywordtype">double</span>)(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>*<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>*<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) &lt; (rad*rad))</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, kpp, ipp, jpp) = 0;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, kpp, ipp, jpp) = 1;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a> == <a class="code" href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a>)</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, kpp, ipp, jpp) = 1 - <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, kpp, ipp, jpp);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_ac70543792196a6e073812077da9208ba"><div class="ttname"><a href="numerical__recipes_8cpp.html#ac70543792196a6e073812077da9208ba">ipp</a></div><div class="ttdeci">ipp</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04714">numerical_recipes.cpp:4714</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a239bae0a69ae7de31ed5627bdb65bda4"><div class="ttname"><a href="classMultidimArrayBase.html#a239bae0a69ae7de31ed5627bdb65bda4">MultidimArrayBase::ydim</a></div><div class="ttdeci">size_t ydim</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00628">multidim_array_base.h:628</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca81c35c21e3a5f7f3a8d24504e76664"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca81c35c21e3a5f7f3a8d24504e76664">theta</a></div><div class="ttdeci">double theta</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l06214">numerical_recipes.cpp:6214</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00269">multidim_array_base.h:269</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a6d50e69638ce9965ce56fbefa0840f2a"><div class="ttname"><a href="classMultidimArrayBase.html#a6d50e69638ce9965ce56fbefa0840f2a">MultidimArrayBase::xdim</a></div><div class="ttdeci">size_t xdim</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00631">multidim_array_base.h:631</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_ac51e2cd5a0f23b34bc903626fbe56ffd"><div class="ttname"><a href="classMultidimArrayBase.html#ac51e2cd5a0f23b34bc903626fbe56ffd">MultidimArrayBase::zdim</a></div><div class="ttdeci">size_t zdim</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00625">multidim_array_base.h:625</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a74e37497baeb87072fb1730874e59adb"><div class="ttname"><a href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a></div><div class="ttdeci">void mode</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__Masks_html_gad17bd6c30fa379217b64dba93b7f53e3"><div class="ttname"><a href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a></div><div class="ttdeci">constexpr int OUTSIDE_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00048">mask.h:48</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="group__Macros_html_ga10de40044d2903ec0d4e7e57c31322aa"><div class="ttname"><a href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a></div><div class="ttdeci">#define intWRAP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00272">xmipp_macros.h:272</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gab405cf3a919aaffa65a6385e01f78999"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab405cf3a919aaffa65a6385e01f78999">&#9670;&nbsp;</a></span>BinaryCrownMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BinaryCrownMask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>R1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>R2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em> = <code><a class="el" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z0</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a crown mask for already sized masks</p>
<p>The mask is supposed to be resized and with its logical origin already set. A circle placed logically at (x0,y0,z0), by default (0,0,0), is created with the two radii indicated. The only two valid modes are INNER_MASK (by default, between the two radii) or OUTSIDE_MASK (the negative of the crown). It is supposed that R1 is smaller than R2.</p>
<p>When entering the mask is initialiazed to 0 and then the mask is created. </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00244">244</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;{</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    mask.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordtype">double</span> R12 = R1 * R1;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordtype">double</span> R22 = R2 * R2;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(mask)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a> = (<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> - <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>) * (<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> - <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>) + (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>) * (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>) + (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>) * (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordtype">bool</span> in_crown = (r2 &gt;= R12 &amp;&amp; r2 &lt;= R22);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">if</span> (in_crown  &amp;&amp; <a class="code" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a> == <a class="code" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a>)</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 1;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!in_crown &amp;&amp; <a class="code" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a> == <a class="code" href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a>)</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 1;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;}</div><div class="ttc" id="blobs_8cpp_html_a3f5c4dfb0dff56801752771f78265fbe"><div class="ttname"><a href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a></div><div class="ttdeci">#define z0</div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00269">multidim_array_base.h:269</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a0d9521fd31b2e16413d1b78836953d53"><div class="ttname"><a href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a></div><div class="ttdeci">#define y0</div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a74e37497baeb87072fb1730874e59adb"><div class="ttname"><a href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a></div><div class="ttdeci">void mode</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__Masks_html_gad17bd6c30fa379217b64dba93b7f53e3"><div class="ttname"><a href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a></div><div class="ttdeci">constexpr int OUTSIDE_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00048">mask.h:48</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_ab7a69dabaa7151dae4d7a3998167e2f3"><div class="ttname"><a href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a></div><div class="ttdeci">float r2</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02723">multidim_array.h:2723</a></div></div>
<div class="ttc" id="group__Masks_html_gac9de3d29a36807613ac35b5179169b8e"><div class="ttname"><a href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a></div><div class="ttdeci">constexpr int INNER_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00047">mask.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga6f39dced292a63fb18aa3480a8b7d791"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6f39dced292a63fb18aa3480a8b7d791">&#9670;&nbsp;</a></span>BinaryCylinderMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BinaryCylinderMask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em> = <code><a class="el" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>z0</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a 3D <a class="el" href="classCylinder.html">Cylinder</a> mask for already sized masks</p>
<p>The mask is supposed to be already resized and with its logical origin defined. A cylinder placed logically at (z0,x0,y0), by default (0,0,0), is created with the radius and height indicated. The only two valid modes ar INNER_MASK (by default) or OUTSIDE_MASK. When entering the mask is initialiazed to 0 and then the mask is created. </p>

</div>
</div>
<a id="gaf0bf07594a130f3a48b874d30ebd5948"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf0bf07594a130f3a48b874d30ebd5948">&#9670;&nbsp;</a></span>BinaryDWTCircularMask2D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BinaryDWTCircularMask2D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>smin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>smax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>quadrant</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Binary Circular 2D mask in wavelet space </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00356">356</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;{</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordtype">double</span> radius2 = <a class="code" href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">radius</a> * <a class="code" href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">radius</a> / (4 * (smin + 1));</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    mask.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s = smin; s &lt;= smax; s++)</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a> corner1(2);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a> corner2(2);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a> r(2);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> center(2);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordflow">if</span> (quadrant == <span class="stringliteral">&quot;xx&quot;</span>)</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <a class="code" href="mask_8cpp.html#a72c46b71fc267ea7ff5f5c6b928d5dc2">DWTCIRCULAR2D_BLOCK</a>(s, <span class="stringliteral">&quot;01&quot;</span>);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <a class="code" href="mask_8cpp.html#a72c46b71fc267ea7ff5f5c6b928d5dc2">DWTCIRCULAR2D_BLOCK</a>(s, <span class="stringliteral">&quot;10&quot;</span>);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <a class="code" href="mask_8cpp.html#a72c46b71fc267ea7ff5f5c6b928d5dc2">DWTCIRCULAR2D_BLOCK</a>(s, <span class="stringliteral">&quot;11&quot;</span>);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <a class="code" href="mask_8cpp.html#a72c46b71fc267ea7ff5f5c6b928d5dc2">DWTCIRCULAR2D_BLOCK</a>(s, quadrant);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        radius2 /= 4;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;}</div><div class="ttc" id="mask_8cpp_html_a72c46b71fc267ea7ff5f5c6b928d5dc2"><div class="ttname"><a href="mask_8cpp.html#a72c46b71fc267ea7ff5f5c6b928d5dc2">DWTCIRCULAR2D_BLOCK</a></div><div class="ttdeci">#define DWTCIRCULAR2D_BLOCK(s, quadrant)</div><div class="ttdef"><b>Definition:</b> <a href="mask_8cpp_source.html#l00346">mask.cpp:346</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; int &gt;</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02723">multidim_array.h:2723</a></div></div>
<div class="ttc" id="structblobtype_html_a292968bd7221739a3a58231353f0d0ec"><div class="ttname"><a href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">blobtype::radius</a></div><div class="ttdeci">double radius</div><div class="ttdoc">Spatial radius in Universal System units. </div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00115">blobs.h:115</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaaae4dd3c0dce82e6a95cb30874e11259"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaae4dd3c0dce82e6a95cb30874e11259">&#9670;&nbsp;</a></span>BinaryDWTSphericalMask2D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BinaryDWTSphericalMask2D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>smin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>smax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>quadrant</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a 3D DWT spherical for already sized masks</p>
<p>The mask size must be a power of 2. The radius must be expressed in pixel units corresponding to the size of the image. For instance, a 64x64x64 image might have a radius of 32 pixels to concentrate on the central part only.</p>
<p>If quadrant=xxx then 001,010,011,100,101,110 and 111 are generated together </p>

</div>
</div>
<a id="ga73ea87c6fbf3515013c419aa19fe7eeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga73ea87c6fbf3515013c419aa19fe7eeb">&#9670;&nbsp;</a></span>BinaryFrameMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BinaryFrameMask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xrect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Yrect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Zrect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em> = <code><a class="el" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z0</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a 3D frame mask for already sized masks</p>
<p>The mask is supposed to be resized and with its logical origin already set. A square placed logically at (x0,y0,z0), by default (0,0,0), is created with the two rectangular dimensions indicated. The only two valid modes are INNER_MASK (by default, between the two radii) or OUTSIDE_MASK (the negative of the crown). It is supposed that R1 is smaller than R2.</p>
<p>When entering the mask is initialiazed to 0 and then the mask is created. </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00309">309</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;{</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    mask.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(mask)</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    {</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordtype">bool</span> in_frame =</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &gt;= <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a> + <a class="code" href="group__Macros.html#gaf809d730a6aa2f55cd4c3d0251f433a7">FIRST_XMIPP_INDEX</a>(Xrect)) &amp;&amp; (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt;= <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a> + <a class="code" href="group__Macros.html#ga37ce421600f14de73f7006bf40cc5b3a">LAST_XMIPP_INDEX</a>(Xrect)) &amp;&amp;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;= <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a> + <a class="code" href="group__Macros.html#gaf809d730a6aa2f55cd4c3d0251f433a7">FIRST_XMIPP_INDEX</a>(Yrect)) &amp;&amp; (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a> + <a class="code" href="group__Macros.html#ga37ce421600f14de73f7006bf40cc5b3a">LAST_XMIPP_INDEX</a>(Yrect)) &amp;&amp;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            (<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> &gt;= <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a> + <a class="code" href="group__Macros.html#gaf809d730a6aa2f55cd4c3d0251f433a7">FIRST_XMIPP_INDEX</a>(Zrect)) &amp;&amp; (<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> &lt;= <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a> + <a class="code" href="group__Macros.html#ga37ce421600f14de73f7006bf40cc5b3a">LAST_XMIPP_INDEX</a>(Zrect));</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keywordflow">if</span> ((in_frame  &amp;&amp; <a class="code" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a> == <a class="code" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a>) || (!in_frame &amp;&amp; <a class="code" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a> == <a class="code" href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a>))</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 1;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;}</div><div class="ttc" id="blobs_8cpp_html_a3f5c4dfb0dff56801752771f78265fbe"><div class="ttname"><a href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a></div><div class="ttdeci">#define z0</div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00269">multidim_array_base.h:269</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a0d9521fd31b2e16413d1b78836953d53"><div class="ttname"><a href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a></div><div class="ttdeci">#define y0</div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a74e37497baeb87072fb1730874e59adb"><div class="ttname"><a href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a></div><div class="ttdeci">void mode</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__Macros_html_gaf809d730a6aa2f55cd4c3d0251f433a7"><div class="ttname"><a href="group__Macros.html#gaf809d730a6aa2f55cd4c3d0251f433a7">FIRST_XMIPP_INDEX</a></div><div class="ttdeci">#define FIRST_XMIPP_INDEX(size)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00439">xmipp_macros.h:439</a></div></div>
<div class="ttc" id="group__Masks_html_gad17bd6c30fa379217b64dba93b7f53e3"><div class="ttname"><a href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a></div><div class="ttdeci">constexpr int OUTSIDE_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00048">mask.h:48</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02723">multidim_array.h:2723</a></div></div>
<div class="ttc" id="group__Macros_html_ga37ce421600f14de73f7006bf40cc5b3a"><div class="ttname"><a href="group__Macros.html#ga37ce421600f14de73f7006bf40cc5b3a">LAST_XMIPP_INDEX</a></div><div class="ttdeci">#define LAST_XMIPP_INDEX(size)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00448">xmipp_macros.h:448</a></div></div>
<div class="ttc" id="group__Masks_html_gac9de3d29a36807613ac35b5179169b8e"><div class="ttname"><a href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a></div><div class="ttdeci">constexpr int INNER_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00047">mask.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga115614bf7aa8b05afd2ae53251affa8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga115614bf7aa8b05afd2ae53251affa8e">&#9670;&nbsp;</a></span>BinaryWedgeMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BinaryWedgeMask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>thetaF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>centerOrigin</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a 3D missing wedge mask</p>
<p>The mask is supposed to be resized and with its logical origin already set. theta0 and thetaF are the tilting angles (around the Y-axis) wherin between the data is supposed to be collected. In this region the mask will be one, outside (ie in the missing wedge) it will be zero. The mask is centered at (x0,y0,z0), and rotated with respect to euler angle matrix A. </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00524">524</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;{</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordtype">int</span> halfX = mask.<a class="code" href="classMultidimArrayBase.html#a6d50e69638ce9965ce56fbefa0840f2a">xdim</a>/2;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordtype">int</span> halfY = mask.<a class="code" href="classMultidimArrayBase.html#a239bae0a69ae7de31ed5627bdb65bda4">ydim</a>/2;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordtype">int</span> halfZ = mask.<a class="code" href="classMultidimArrayBase.html#ac51e2cd5a0f23b34bc903626fbe56ffd">zdim</a>/2;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordtype">int</span> minX = -halfX;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordtype">int</span> minY = -halfY;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keywordtype">int</span> minZ = -halfZ;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordtype">int</span> maxX = (int)((mask.<a class="code" href="classMultidimArrayBase.html#a6d50e69638ce9965ce56fbefa0840f2a">xdim</a>-0.5)/2);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordtype">int</span> maxY = (int)((mask.<a class="code" href="classMultidimArrayBase.html#a239bae0a69ae7de31ed5627bdb65bda4">ydim</a>-0.5)/2);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordtype">int</span> maxZ = (int)((mask.<a class="code" href="classMultidimArrayBase.html#ac51e2cd5a0f23b34bc903626fbe56ffd">zdim</a>-0.5)/2);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keyword">auto</span> tg0 = -tan(<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * (-90. - thetaF) / 180.);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keyword">auto</span> tgF = -tan(<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * (90. - theta0) / 180.);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(tg0) &lt; <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>)</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        tg0=0.;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(tgF) &lt; <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>)</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        tgF=0.;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">// ROB: A=A.inv(); A no const</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(mask)</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    {</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="keyword">auto</span> <a class="code" href="numerical__recipes_8cpp.html#ab96fca79aa45e2e22226e5938e235299">di</a>=(double)<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="keyword">auto</span> dj=(double)<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keyword">auto</span> dk=(double)<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="keyword">auto</span> xp = <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A, 0, 0) * dj + <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A, 0, 1) * <a class="code" href="numerical__recipes_8cpp.html#ab96fca79aa45e2e22226e5938e235299">di</a> + <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A, 0, 2) * dk;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="keyword">auto</span> zp = <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A, 2, 0) * dj + <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A, 2, 1) * <a class="code" href="numerical__recipes_8cpp.html#ab96fca79aa45e2e22226e5938e235299">di</a> + <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A, 2, 2) * dk;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <span class="keywordtype">int</span> kpp = <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ac70543792196a6e073812077da9208ba">ipp</a> = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="keywordtype">int</span> jpp = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keywordflow">if</span> (centerOrigin)</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        {</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            kpp = <a class="code" href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a> (<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>+halfZ,minZ,maxZ);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            ipp = <a class="code" href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a> (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+halfY,minY,maxY);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            jpp = <a class="code" href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a> (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>+halfX,minX,maxX);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        }</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="keyword">auto</span> limx0 = tg0 * zp;<span class="comment">// + 0.5;</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keyword">auto</span> limxF = tgF * zp;<span class="comment">// + 0.5;</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="keywordflow">if</span> (zp &gt;= 0)</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        {</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            <span class="keywordflow">if</span> (xp &lt;= limx0 || xp &gt;= limxF)</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            {</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, kpp, ipp, jpp) = 1;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            }</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, kpp, ipp, jpp) = 0;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            <span class="keywordflow">if</span> (xp &lt;= limxF || xp &gt;= limx0)</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, kpp, ipp, jpp) = 1;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            }</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, kpp, ipp, jpp) = 0;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        }</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    }</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_ac70543792196a6e073812077da9208ba"><div class="ttname"><a href="numerical__recipes_8cpp.html#ac70543792196a6e073812077da9208ba">ipp</a></div><div class="ttdeci">ipp</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04714">numerical_recipes.cpp:4714</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a239bae0a69ae7de31ed5627bdb65bda4"><div class="ttname"><a href="classMultidimArrayBase.html#a239bae0a69ae7de31ed5627bdb65bda4">MultidimArrayBase::ydim</a></div><div class="ttdeci">size_t ydim</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00628">multidim_array_base.h:628</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab96fca79aa45e2e22226e5938e235299"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab96fca79aa45e2e22226e5938e235299">di</a></div><div class="ttdeci">double * di</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05168">numerical_recipes.cpp:5168</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="group__Matrices_html_gab40746be05d4bbf352787018922ecc2e"><div class="ttname"><a href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a></div><div class="ttdeci">#define MAT_ELEM(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00116">matrix2d.h:116</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00269">multidim_array_base.h:269</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a6d50e69638ce9965ce56fbefa0840f2a"><div class="ttname"><a href="classMultidimArrayBase.html#a6d50e69638ce9965ce56fbefa0840f2a">MultidimArrayBase::xdim</a></div><div class="ttdeci">size_t xdim</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00631">multidim_array_base.h:631</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_ac51e2cd5a0f23b34bc903626fbe56ffd"><div class="ttname"><a href="classMultidimArrayBase.html#ac51e2cd5a0f23b34bc903626fbe56ffd">MultidimArrayBase::zdim</a></div><div class="ttdeci">size_t zdim</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00625">multidim_array_base.h:625</a></div></div>
<div class="ttc" id="group__Macros_html_gad584f97e936242b173add43261376ba5"><div class="ttname"><a href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a></div><div class="ttdeci">#define XMIPP_EQUAL_ACCURACY</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00119">xmipp_macros.h:119</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="group__Macros_html_ga10de40044d2903ec0d4e7e57c31322aa"><div class="ttname"><a href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a></div><div class="ttdeci">#define intWRAP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00272">xmipp_macros.h:272</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaaf93cc29cff5705b942acc0f9f61d860"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaf93cc29cff5705b942acc0f9f61d860">&#9670;&nbsp;</a></span>BlackmanMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BlackmanMask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em> = <code><a class="el" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z0</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Blackman selfWindow</p>
<p>It receives no parameter. </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00151">151</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;{</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordtype">double</span> Xdim2 = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(1, (<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(mask) - 1) * (<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(mask) - 1));</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordtype">double</span> Ydim2 = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(1, (<a class="code" href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(mask) - 1) * (<a class="code" href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(mask) - 1));</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordtype">double</span> Zdim2 = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(1, (<a class="code" href="multidim__array__base_8h.html#addfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(mask) - 1) * (<a class="code" href="multidim__array__base_8h.html#addfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(mask) - 1));</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(mask)</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordtype">double</span> r = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>((<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> - <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>) * (<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> - <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>) / Zdim2 + (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>) * (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>) / Xdim2 + (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>) * (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>) / Ydim2);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 0.42 + 0.5 * cos(2 * <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * r) + 0.08 * cos(4 * <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * r);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a> == <a class="code" href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a>)</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 1 - <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;}</div><div class="ttc" id="multidim__array__base_8h_html_a93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00095">multidim_array_base.h:95</a></div></div>
<div class="ttc" id="group__Macros_html_gae0a4180e923e3ffca3989e20e441aa3c"><div class="ttname"><a href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a></div><div class="ttdeci">#define XMIPP_MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00193">xmipp_macros.h:193</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00210">image_operate.cpp:210</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a3f5c4dfb0dff56801752771f78265fbe"><div class="ttname"><a href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a></div><div class="ttdeci">#define z0</div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00269">multidim_array_base.h:269</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a0d9521fd31b2e16413d1b78836953d53"><div class="ttname"><a href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a></div><div class="ttdeci">#define y0</div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00091">multidim_array_base.h:91</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_addfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="multidim__array__base_8h.html#addfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00099">multidim_array_base.h:99</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a74e37497baeb87072fb1730874e59adb"><div class="ttname"><a href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a></div><div class="ttdeci">void mode</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__Masks_html_gad17bd6c30fa379217b64dba93b7f53e3"><div class="ttname"><a href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a></div><div class="ttdeci">constexpr int OUTSIDE_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00048">mask.h:48</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gae4b008931c501e48d2e9164943743a5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae4b008931c501e48d2e9164943743a5b">&#9670;&nbsp;</a></span>BlobCircularMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BlobCircularMask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structblobtype.html">blobtype</a>&#160;</td>
          <td class="paramname"><em>blob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z0</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a circular mask with blob-shaped edges for already sized masks</p>
<p>The mask is supposed to be resized and with its logical origin already set. A circle placed logically at (x0,y0,z0), by default (0,0,0), is created with the radius indicated. The only two valid modes are INNER_MASK (by default) or OUTSIDE_MASK. When entering the mask is initialiazed to 0 and then the mask is created. </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00219">219</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;{</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(mask)</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordtype">double</span> r = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>((<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> - <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>) * (<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> - <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>) + (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>) * (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>) + (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>) * (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>));</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a> == <a class="code" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a>)</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="keywordflow">if</span> (r &lt;= <a class="code" href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a>)</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 1;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__Blobs.html#gaeba6cc6d681f05be51139d9d5c21a305">blob_val</a>(r-<a class="code" href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a>, blob);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        }</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        {</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="keywordflow">if</span> (r &gt;= <a class="code" href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a>)</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 1;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__Blobs.html#gaeba6cc6d681f05be51139d9d5c21a305">blob_val</a>(<a class="code" href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a>-r, blob);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;}</div><div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00210">image_operate.cpp:210</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a3f5c4dfb0dff56801752771f78265fbe"><div class="ttname"><a href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a></div><div class="ttdeci">#define z0</div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00269">multidim_array_base.h:269</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a0d9521fd31b2e16413d1b78836953d53"><div class="ttname"><a href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a></div><div class="ttdeci">#define y0</div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a74e37497baeb87072fb1730874e59adb"><div class="ttname"><a href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a></div><div class="ttdeci">void mode</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__Blobs_html_gaeba6cc6d681f05be51139d9d5c21a305"><div class="ttname"><a href="group__Blobs.html#gaeba6cc6d681f05be51139d9d5c21a305">blob_val</a></div><div class="ttdeci">#define blob_val(r, blob)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00139">blobs.h:139</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a1f47f51cace576c94f6c1c9483d28a8f"><div class="ttname"><a href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a></div><div class="ttdeci">float r1</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="group__Masks_html_gac9de3d29a36807613ac35b5179169b8e"><div class="ttname"><a href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a></div><div class="ttdeci">constexpr int INNER_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00047">mask.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga8ba643ec2d65c0d878013fbc04750eff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8ba643ec2d65c0d878013fbc04750eff">&#9670;&nbsp;</a></span>BlobCrownMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BlobCrownMask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structblobtype.html">blobtype</a>&#160;</td>
          <td class="paramname"><em>blob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z0</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a crown mask with blob-shaped edges for already sized masks</p>
<p>The mask is supposed to be resized and with its logical origin already set. A circle placed logically at (x0,y0,z0), by default (0,0,0), is created with the two radii indicated. The only two valid modes are INNER_MASK (by default, between the two radii) or OUTSIDE_MASK (the negative of the crown). It is supposed that R1 is smaller than R2.</p>
<p>When entering the mask is initialiazed to 0 and then the mask is created. </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00278">278</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;{</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> aux;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    aux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(mask);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a> == <a class="code" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a>)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <a class="code" href="group__Masks.html#gae4b008931c501e48d2e9164943743a5b">BlobCircularMask</a>(mask, <a class="code" href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a>, blob,</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                         <a class="code" href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a>, <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>, <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>, <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <a class="code" href="group__Masks.html#gae4b008931c501e48d2e9164943743a5b">BlobCircularMask</a>(aux, <a class="code" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a>, blob,</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                         <a class="code" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a>, <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>, <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>, <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(mask)</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) *= <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(aux, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        }</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <a class="code" href="group__Masks.html#gae4b008931c501e48d2e9164943743a5b">BlobCircularMask</a>(mask, <a class="code" href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a>, blob,</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                         <a class="code" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a>, <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>, <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>, <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <a class="code" href="group__Masks.html#gae4b008931c501e48d2e9164943743a5b">BlobCircularMask</a>(aux, <a class="code" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a>, blob,</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                         <a class="code" href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a>, <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>, <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>, <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(mask)</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) += <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(aux, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00983">multidim_array.cpp:983</a></div></div>
<div class="ttc" id="group__Masks_html_gae4b008931c501e48d2e9164943743a5b"><div class="ttname"><a href="group__Masks.html#gae4b008931c501e48d2e9164943743a5b">BlobCircularMask</a></div><div class="ttdeci">void BlobCircularMask(MultidimArray&lt; double &gt; &amp;mask, double r1, blobtype blob, int mode, double x0, double y0, double z0)</div><div class="ttdef"><b>Definition:</b> <a href="mask_8cpp_source.html#l00219">mask.cpp:219</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a3f5c4dfb0dff56801752771f78265fbe"><div class="ttname"><a href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a></div><div class="ttdeci">#define z0</div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00269">multidim_array_base.h:269</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a0d9521fd31b2e16413d1b78836953d53"><div class="ttname"><a href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a></div><div class="ttdeci">#define y0</div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a74e37497baeb87072fb1730874e59adb"><div class="ttname"><a href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a></div><div class="ttdeci">void mode</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__Masks_html_gad17bd6c30fa379217b64dba93b7f53e3"><div class="ttname"><a href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a></div><div class="ttdeci">constexpr int OUTSIDE_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00048">mask.h:48</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_ab7a69dabaa7151dae4d7a3998167e2f3"><div class="ttname"><a href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a></div><div class="ttdeci">float r2</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a1f47f51cace576c94f6c1c9483d28a8f"><div class="ttname"><a href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a></div><div class="ttdeci">float r1</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="group__Masks_html_gac9de3d29a36807613ac35b5179169b8e"><div class="ttname"><a href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a></div><div class="ttdeci">constexpr int INNER_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00047">mask.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gad522883b557df4c83ab2e7dddb6d8d85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad522883b557df4c83ab2e7dddb6d8d85">&#9670;&nbsp;</a></span>compute_hist_within_binary_mask() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void compute_hist_within_binary_mask </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classHistogram1D.html">Histogram1D</a> &amp;&#160;</td>
          <td class="paramname"><em>hist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>no_steps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute histogram inside mask within its minimum and maximum value (3D)</p>
<p>Given a volume as input, this function returns the histogram of values inside the mask within the minimum and maximum of the volume, in this way all the values in the volume are counted. The volume can be of any numerical type (short int, int, double, ...). The number of steps must always be given. </p>

<p class="definition">Definition at line <a class="el" href="mask_8h_source.html#l00906">906</a> of file <a class="el" href="mask_8h_source.html">mask.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;{</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    T min_val;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    T max_val;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keywordtype">double</span> avg;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keywordtype">double</span> stddev;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <a class="code" href="group__Masks.html#ga5bd552c32d3d6b6abd6ddf18677cf647">computeStats_within_binary_mask</a>(mask, v, min_val, max_val, avg, stddev);</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <a class="code" href="group__Masks.html#gad522883b557df4c83ab2e7dddb6d8d85">compute_hist_within_binary_mask</a>(mask, v, hist, min_val, max_val, no_steps);</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;}</div><div class="ttc" id="group__Masks_html_ga5bd552c32d3d6b6abd6ddf18677cf647"><div class="ttname"><a href="group__Masks.html#ga5bd552c32d3d6b6abd6ddf18677cf647">computeStats_within_binary_mask</a></div><div class="ttdeci">void computeStats_within_binary_mask(const MultidimArray&lt; T1 &gt; &amp;mask, const MultidimArray&lt; T &gt; &amp;m, double &amp;min_val, double &amp;max_val, double &amp;avg, double &amp;stddev)</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00799">mask.h:799</a></div></div>
<div class="ttc" id="group__Masks_html_gad522883b557df4c83ab2e7dddb6d8d85"><div class="ttname"><a href="group__Masks.html#gad522883b557df4c83ab2e7dddb6d8d85">compute_hist_within_binary_mask</a></div><div class="ttdeci">void compute_hist_within_binary_mask(const MultidimArray&lt; int &gt; &amp;mask, MultidimArray&lt; T &gt; &amp;v, Histogram1D &amp;hist, int no_steps)</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00906">mask.h:906</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga514151c832d31a137fe4febb708071c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga514151c832d31a137fe4febb708071c3">&#9670;&nbsp;</a></span>compute_hist_within_binary_mask() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void compute_hist_within_binary_mask </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classHistogram1D.html">Histogram1D</a> &amp;&#160;</td>
          <td class="paramname"><em>hist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>no_steps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute histogram inside mask within two values (3D)</p>
<p>Given a volume as input, this function returns the histogram of the values inside the mask within two values, the volume values outside this range are not counted. This can be used to avoid the effect of outliers which causes a "compression" in the histogram. The volume can be of any numerical type (short int, int, double, ...). The number of steps must always be given. </p>

<p class="definition">Definition at line <a class="el" href="mask_8h_source.html#l00928">928</a> of file <a class="el" href="mask_8h_source.html">mask.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;{</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <a class="code" href="group__Macros.html#ga4c9386c11dfbaac4b99d2f7799dbc0c1">SPEED_UP_tempsInt</a>;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    hist.<a class="code" href="classHistogram1D.html#ac40dd6aedb6ee53598b7bcc05ab27db5">init</a>(<a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">min</a>, <a class="code" href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">max</a>, no_steps);</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <a class="code" href="multidim__array__base_8h.html#aaee6e163d8f7e358c38d3fcfe935b6fc">FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D</a>(mask, v)</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) != 0)</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    {</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="keywordtype">double</span> value=<a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(v, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <a class="code" href="histogram_8h.html#a259a7773c997783e3a2a141038d93e40">INSERT_VALUE</a>(hist,value);</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    }</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;}</div><div class="ttc" id="image__operate_8cpp_html_afbbd36781c10524238c70745c6f6f35d"><div class="ttname"><a href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">min</a></div><div class="ttdeci">void min(Image&lt; double &gt; &amp;op1, const Image&lt; double &gt; &amp;op2)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00118">image_operate.cpp:118</a></div></div>
<div class="ttc" id="histogram_8h_html_a259a7773c997783e3a2a141038d93e40"><div class="ttname"><a href="histogram_8h.html#a259a7773c997783e3a2a141038d93e40">INSERT_VALUE</a></div><div class="ttdeci">#define INSERT_VALUE(histogram, value)</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00205">histogram.h:205</a></div></div>
<div class="ttc" id="classHistogram1D_html_ac40dd6aedb6ee53598b7bcc05ab27db5"><div class="ttname"><a href="classHistogram1D.html#ac40dd6aedb6ee53598b7bcc05ab27db5">Histogram1D::init</a></div><div class="ttdeci">void init(double min_val, double max_val, int n_steps)</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00071">histogram.cpp:71</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_ac5474a01d203d14c046620266b2f1954"><div class="ttname"><a href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">max</a></div><div class="ttdeci">void max(Image&lt; double &gt; &amp;op1, const Image&lt; double &gt; &amp;op2)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00128">image_operate.cpp:128</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__Macros_html_ga4c9386c11dfbaac4b99d2f7799dbc0c1"><div class="ttname"><a href="group__Macros.html#ga4c9386c11dfbaac4b99d2f7799dbc0c1">SPEED_UP_tempsInt</a></div><div class="ttdeci">#define SPEED_UP_tempsInt</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00408">xmipp_macros.h:408</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_aaee6e163d8f7e358c38d3fcfe935b6fc"><div class="ttname"><a href="multidim__array__base_8h.html#aaee6e163d8f7e358c38d3fcfe935b6fc">FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D(V1, V2)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00298">multidim_array_base.h:298</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga5bd552c32d3d6b6abd6ddf18677cf647"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5bd552c32d3d6b6abd6ddf18677cf647">&#9670;&nbsp;</a></span>computeStats_within_binary_mask() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T1 , typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void computeStats_within_binary_mask </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T1 &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>min_val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>max_val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>avg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>stddev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute statistics in the active area</p>
<p>Only the statistics for values in the overlapping between the mask and the volume for those the mask is not 0 are computed. </p>

<p class="definition">Definition at line <a class="el" href="mask_8h_source.html#l00799">799</a> of file <a class="el" href="mask_8h_source.html">mask.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;{</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <a class="code" href="group__Macros.html#ga4c9386c11dfbaac4b99d2f7799dbc0c1">SPEED_UP_tempsInt</a>;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keywordtype">double</span> sum1 = 0;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordtype">double</span> sum2 = 0;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordtype">int</span> N = 0;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    max_val = min_val = <a class="code" href="multidim__array__base_8h.html#acac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(m, 0, 0, 0);</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <a class="code" href="multidim__array__base_8h.html#aaee6e163d8f7e358c38d3fcfe935b6fc">FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D</a>(mask, m)</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    {</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) &gt; 0)</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        {</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            N++;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            <span class="keywordtype">double</span> aux=<a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(m, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            <span class="comment">// Minimum and maximum</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            <span class="keywordflow">if</span> (aux &lt; min_val)</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                min_val = aux;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (aux &gt; max_val)</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                max_val = aux;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <span class="comment">// cumulative sums for average and standard deviation</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            sum1 += aux;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            sum2 += aux*aux;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        }</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    }</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="comment">// average and standard deviation</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    avg  = sum1 / (double) N;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordflow">if</span> (N &gt; 1)</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        stddev = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(fabs(sum2 / N - avg * avg) * N / (N - 1));</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        stddev = 0;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;}</div><div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00210">image_operate.cpp:210</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_acac7be97c37bd2e4f801976749de839c"><div class="ttname"><a href="multidim__array__base_8h.html#acac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a></div><div class="ttdeci">#define DIRECT_A3D_ELEM(v, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00239">multidim_array_base.h:239</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__Macros_html_ga4c9386c11dfbaac4b99d2f7799dbc0c1"><div class="ttname"><a href="group__Macros.html#ga4c9386c11dfbaac4b99d2f7799dbc0c1">SPEED_UP_tempsInt</a></div><div class="ttdeci">#define SPEED_UP_tempsInt</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00408">xmipp_macros.h:408</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_aaee6e163d8f7e358c38d3fcfe935b6fc"><div class="ttname"><a href="multidim__array__base_8h.html#aaee6e163d8f7e358c38d3fcfe935b6fc">FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D(V1, V2)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00298">multidim_array_base.h:298</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga42e921a8bf2008e6141e17dd9f0bdff4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga42e921a8bf2008e6141e17dd9f0bdff4">&#9670;&nbsp;</a></span>computeStats_within_binary_mask() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void computeStats_within_binary_mask </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>min_val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>max_val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>avg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>stddev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mask_8h_source.html#l00838">838</a> of file <a class="el" href="mask_8h_source.html">mask.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;{</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="preprocessor">#define COMPUTESTATS(type) \</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="preprocessor">computeStats_within_binary_mask(mask,*((MultidimArray&lt;type&gt;*)m.im),min_val,max_val,avg,stddev);</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <a class="code" href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a>(m.<a class="code" href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">datatype</a>,<a class="code" href="mask_8h.html#a4f5e38df9e4ce74d44d442f3bb8b236b">COMPUTESTATS</a>);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="preprocessor">#undef COMPUTESTATS</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;}</div><div class="ttc" id="mask_8h_html_a4f5e38df9e4ce74d44d442f3bb8b236b"><div class="ttname"><a href="mask_8h.html#a4f5e38df9e4ce74d44d442f3bb8b236b">COMPUTESTATS</a></div><div class="ttdeci">#define COMPUTESTATS(type)</div></div>
<div class="ttc" id="classMultidimArrayGeneric_html_a0b74b17fe8d2f77c90b1513bd795c224"><div class="ttname"><a href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">MultidimArrayGeneric::datatype</a></div><div class="ttdeci">DataType datatype</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00114">multidim_array_generic.h:114</a></div></div>
<div class="ttc" id="multidim__array__generic_8h_html_ada27bedba7f65b4ad8fca3eb7f5ad65e"><div class="ttname"><a href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a></div><div class="ttdeci">#define SWITCHDATATYPE(datatype, OP)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00045">multidim_array_generic.h:45</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga9d22d919d00b6979db4b8500233604ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9d22d919d00b6979db4b8500233604ac">&#9670;&nbsp;</a></span>count_with_mask() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">int count_with_mask </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>th1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>th2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Count voxels with mask and threshold.</p>
<p>This function returns the number of voxels in the ACTIVE area of an volume with a value:</p>
<p>COUNT_ABOVE: greater or equal than th1 COUNT_BELOW: smaller or equal than th1 COUNT_BETWEEN: smaller or equal than th1 and greater or equal than th2</p>
<p>For complex matrices the absolute value is compared. </p>

<p class="definition">Definition at line <a class="el" href="mask_8h_source.html#l00983">983</a> of file <a class="el" href="mask_8h_source.html">mask.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;{</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <a class="code" href="group__Macros.html#ga4c9386c11dfbaac4b99d2f7799dbc0c1">SPEED_UP_tempsInt</a>;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="keywordtype">int</span> N = 0;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <a class="code" href="multidim__array__base_8h.html#aaee6e163d8f7e358c38d3fcfe935b6fc">FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D</a>(mask, m)</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>))</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a>)</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        {</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__Masks.html#gacddf12a44ad18f7d3d7555e2d6918d2f">COUNT_ABOVE</a>:</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(m, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) &gt;= th1)</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                            N++;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__Masks.html#ga6b609bf3ee4fe60e9623eb10678c52aa">COUNT_BELOW</a>:</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(m, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) &lt;= th1)</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                            N++;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__Masks.html#ga7030285e58b95c96d766c3998d3d37d8">COUNT_BETWEEN</a>:</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(m, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) &gt;= th1 &amp;&amp; <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(m, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) &lt;= th2)</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                            N++;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        }</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="keywordflow">return</span> N;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;}</div><div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="group__Masks_html_ga7030285e58b95c96d766c3998d3d37d8"><div class="ttname"><a href="group__Masks.html#ga7030285e58b95c96d766c3998d3d37d8">COUNT_BETWEEN</a></div><div class="ttdeci">constexpr int COUNT_BETWEEN</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00944">mask.h:944</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a74e37497baeb87072fb1730874e59adb"><div class="ttname"><a href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a></div><div class="ttdeci">void mode</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__Masks_html_ga6b609bf3ee4fe60e9623eb10678c52aa"><div class="ttname"><a href="group__Masks.html#ga6b609bf3ee4fe60e9623eb10678c52aa">COUNT_BELOW</a></div><div class="ttdeci">constexpr int COUNT_BELOW</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00943">mask.h:943</a></div></div>
<div class="ttc" id="group__Macros_html_ga4c9386c11dfbaac4b99d2f7799dbc0c1"><div class="ttname"><a href="group__Macros.html#ga4c9386c11dfbaac4b99d2f7799dbc0c1">SPEED_UP_tempsInt</a></div><div class="ttdeci">#define SPEED_UP_tempsInt</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00408">xmipp_macros.h:408</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_aaee6e163d8f7e358c38d3fcfe935b6fc"><div class="ttname"><a href="multidim__array__base_8h.html#aaee6e163d8f7e358c38d3fcfe935b6fc">FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D(V1, V2)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00298">multidim_array_base.h:298</a></div></div>
<div class="ttc" id="group__Masks_html_gacddf12a44ad18f7d3d7555e2d6918d2f"><div class="ttname"><a href="group__Masks.html#gacddf12a44ad18f7d3d7555e2d6918d2f">COUNT_ABOVE</a></div><div class="ttdeci">constexpr int COUNT_ABOVE</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00942">mask.h:942</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga0eb8cc6f4757102d7a1a7a9b2f8d1194"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0eb8cc6f4757102d7a1a7a9b2f8d1194">&#9670;&nbsp;</a></span>count_with_mask() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int count_with_mask </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>th1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>th2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l01712">1712</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;{</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <a class="code" href="group__Macros.html#ga4c9386c11dfbaac4b99d2f7799dbc0c1">SPEED_UP_tempsInt</a>;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <span class="keywordtype">int</span> N = 0;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <a class="code" href="multidim__array__base_8h.html#aaee6e163d8f7e358c38d3fcfe935b6fc">FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D</a>(mask, m)</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(mask, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>))</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a>)</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        {</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__Masks.html#gacddf12a44ad18f7d3d7555e2d6918d2f">COUNT_ABOVE</a>:</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="image__operate_8cpp.html#ae1a7280fa539d74ebf884fe25fa8f5a8">abs</a>(<a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(m, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)) &gt;= th1)</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                            N++;</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__Masks.html#ga6b609bf3ee4fe60e9623eb10678c52aa">COUNT_BELOW</a>:</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="image__operate_8cpp.html#ae1a7280fa539d74ebf884fe25fa8f5a8">abs</a>(<a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(m, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)) &lt;= th1)</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                            N++;</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__Masks.html#ga7030285e58b95c96d766c3998d3d37d8">COUNT_BETWEEN</a>:</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="image__operate_8cpp.html#ae1a7280fa539d74ebf884fe25fa8f5a8">abs</a>(<a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(m, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)) &gt;= th1 &amp;&amp; <a class="code" href="image__operate_8cpp.html#ae1a7280fa539d74ebf884fe25fa8f5a8">abs</a>(<a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(m, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)) &lt;= th2)</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                            N++;</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        }</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="keywordflow">return</span> N;</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;}</div><div class="ttc" id="multidim__array__base_8h_html_a9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00354">multidim_array_base.h:354</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_ae1a7280fa539d74ebf884fe25fa8f5a8"><div class="ttname"><a href="image__operate_8cpp.html#ae1a7280fa539d74ebf884fe25fa8f5a8">abs</a></div><div class="ttdeci">void abs(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00219">image_operate.cpp:219</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="group__Masks_html_ga7030285e58b95c96d766c3998d3d37d8"><div class="ttname"><a href="group__Masks.html#ga7030285e58b95c96d766c3998d3d37d8">COUNT_BETWEEN</a></div><div class="ttdeci">constexpr int COUNT_BETWEEN</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00944">mask.h:944</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a74e37497baeb87072fb1730874e59adb"><div class="ttname"><a href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a></div><div class="ttdeci">void mode</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__Masks_html_ga6b609bf3ee4fe60e9623eb10678c52aa"><div class="ttname"><a href="group__Masks.html#ga6b609bf3ee4fe60e9623eb10678c52aa">COUNT_BELOW</a></div><div class="ttdeci">constexpr int COUNT_BELOW</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00943">mask.h:943</a></div></div>
<div class="ttc" id="group__Macros_html_ga4c9386c11dfbaac4b99d2f7799dbc0c1"><div class="ttname"><a href="group__Macros.html#ga4c9386c11dfbaac4b99d2f7799dbc0c1">SPEED_UP_tempsInt</a></div><div class="ttdeci">#define SPEED_UP_tempsInt</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00408">xmipp_macros.h:408</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_aaee6e163d8f7e358c38d3fcfe935b6fc"><div class="ttname"><a href="multidim__array__base_8h.html#aaee6e163d8f7e358c38d3fcfe935b6fc">FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D(V1, V2)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00298">multidim_array_base.h:298</a></div></div>
<div class="ttc" id="group__Masks_html_gacddf12a44ad18f7d3d7555e2d6918d2f"><div class="ttname"><a href="group__Masks.html#gacddf12a44ad18f7d3d7555e2d6918d2f">COUNT_ABOVE</a></div><div class="ttdeci">constexpr int COUNT_ABOVE</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00942">mask.h:942</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga561afba8071986dbbe415ba0e783347c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga561afba8071986dbbe415ba0e783347c">&#9670;&nbsp;</a></span>GaussianMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GaussianMask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em> = <code><a class="el" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z0</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a gaussian mask for already sized masks</p>
<p>The mask is supposed to be resized and with its logical origin already set. A circle placed logically at (x0,y0,z0), by default (0,0,0), is created with the radius indicated. The only two valid modes are INNER_MASK (by default) or OUTSIDE_MASK. Inner mask are normal sincs, and outside masks are 1 -gaussian.</p>
<p>When entering the mask is initialiazed to 0 and then the mask is created. </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00325">325</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;{</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordtype">double</span> sigma2 = sigma * sigma;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="libraries_2data_2integration_8cpp.html#a77a9b787be0b9b24ab6b55aade3eeeaf">K</a> = 1. / pow(<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(2.*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>)*sigma,(<span class="keywordtype">double</span>)mask.<a class="code" href="classMultidimArrayBase.html#a727c471c59edd875ec3c1f926f09e077">getDim</a>());</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(mask)</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a> = (<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> - <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>) * (<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> - <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>) + (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>) * (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>) + (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>) * (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = K * exp(-0.5 * r2 / sigma2);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a> == <a class="code" href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a>)</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 1 - <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;}</div><div class="ttc" id="classMultidimArrayBase_html_a727c471c59edd875ec3c1f926f09e077"><div class="ttname"><a href="classMultidimArrayBase.html#a727c471c59edd875ec3c1f926f09e077">MultidimArrayBase::getDim</a></div><div class="ttdeci">int getDim() const</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l01000">multidim_array_base.h:1000</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00210">image_operate.cpp:210</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a3f5c4dfb0dff56801752771f78265fbe"><div class="ttname"><a href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a></div><div class="ttdeci">#define z0</div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00269">multidim_array_base.h:269</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a0d9521fd31b2e16413d1b78836953d53"><div class="ttname"><a href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a></div><div class="ttdeci">#define y0</div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a74e37497baeb87072fb1730874e59adb"><div class="ttname"><a href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a></div><div class="ttdeci">void mode</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__Masks_html_gad17bd6c30fa379217b64dba93b7f53e3"><div class="ttname"><a href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a></div><div class="ttdeci">constexpr int OUTSIDE_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00048">mask.h:48</a></div></div>
<div class="ttc" id="libraries_2data_2integration_8cpp_html_a77a9b787be0b9b24ab6b55aade3eeeaf"><div class="ttname"><a href="libraries_2data_2integration_8cpp.html#a77a9b787be0b9b24ab6b55aade3eeeaf">K</a></div><div class="ttdeci">constexpr int K</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2integration_8cpp_source.html#l00123">integration.cpp:123</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_ab7a69dabaa7151dae4d7a3998167e2f3"><div class="ttname"><a href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a></div><div class="ttdeci">float r2</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gab3da3cb40033e29917d151e7508b0ab6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab3da3cb40033e29917d151e7508b0ab6">&#9670;&nbsp;</a></span>invert_binary_mask()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void invert_binary_mask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Invert binary mask.</p>
<p>0's are converted in 1's and viceversa </p>

<p class="definition">Definition at line <a class="el" href="mask_8h_source.html#l01020">1020</a> of file <a class="el" href="mask_8h_source.html">mask.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;{</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    T* ptr=NULL;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a26e3526530a71567390ed3d98c1654cf">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY_ptr</a>(mask,n,ptr)</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    *ptr = 1-(*ptr);</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;}</div><div class="ttc" id="multidim__array__base_8h_html_a26e3526530a71567390ed3d98c1654cf"><div class="ttname"><a href="multidim__array__base_8h.html#a26e3526530a71567390ed3d98c1654cf">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY_ptr</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY_ptr(v, n, ptr)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00233">multidim_array_base.h:233</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02229">numerical_recipes.cpp:2229</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaf284df7ea9e569041cafa8477a421f84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf284df7ea9e569041cafa8477a421f84">&#9670;&nbsp;</a></span>KaiserMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KaiserMask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>delta</em> = <code>0.01</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Deltaw</em> = <code>1.0/12.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Kaiser selfWindow The mask is resized. delta=ripple (in natural units) in the pass band. Deltaw=transition bandwidth (normalized to 1.0). </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00083">83</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;{</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">// Convert Deltaw from a frequency normalized to 1, to a freq. normalized to PI</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    Deltaw *= <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// Design Kaiser selfWindow</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordtype">double</span> A = -20 * <a class="code" href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a>(<a class="code" href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a>);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">int</span>    M = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>((A - 8) / (2.285 * Deltaw));</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">if</span> (A &gt; 50)</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        beta = 0.1102 * (A - 8.7);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (A &gt;= 21)</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        beta = 0.5842 * pow(A - 21, 0.4) + 0.07886 * (A - 21);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        beta = 0;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// &quot;Draw&quot; Kaiser selfWindow</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(mask)==1 &amp;&amp; <a class="code" href="multidim__array__base_8h.html#addfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(mask)==1)</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    {</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="comment">// 1D</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        mask.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(2*M + 1);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="multidim__array__base_8h.html#addfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(mask)==1)</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="comment">// 2D</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        mask.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(2*M + 1, 2*M + 1);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    {</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="comment">// 3D</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        mask.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(2*M + 1, 2*M + 1, 2*M + 1);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    mask.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordtype">double</span> iI0Beta = 1.0 / <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#af79423b2c41ae25087708dabd9722890">bessi0</a>(beta);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(mask)</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    {</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordtype">double</span> r = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>((<span class="keywordtype">double</span>)(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> * <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> * <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>));</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">if</span> (r &lt;= M)</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#af79423b2c41ae25087708dabd9722890">bessi0</a>(beta * <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(1-(r/M)*(r/M))) * iI0Beta;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    }</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;}</div><div class="ttc" id="multidim__array__base_8h_html_a93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00095">multidim_array_base.h:95</a></div></div>
<div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00983">multidim_array.cpp:983</a></div></div>
<div class="ttc" id="namespacealglib_html_a038c39f3bfe0dff667a2cb6bebfed764"><div class="ttname"><a href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">alglib::beta</a></div><div class="ttdeci">double beta(const double a, const double b)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l00962">specialfunctions.cpp:962</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00210">image_operate.cpp:210</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8cpp_source.html#l00200">multidim_array_base.cpp:200</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="cuda__gpu__reconstruct__fourier_8cpp_html_af79423b2c41ae25087708dabd9722890"><div class="ttname"><a href="cuda__gpu__reconstruct__fourier_8cpp.html#af79423b2c41ae25087708dabd9722890">bessi0</a></div><div class="ttdeci">__device__ float bessi0(float x)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gpu__reconstruct__fourier_8cpp_source.html#l00086">cuda_gpu_reconstruct_fourier.cpp:86</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00269">multidim_array_base.h:269</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_addfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="multidim__array__base_8h.html#addfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00099">multidim_array_base.h:99</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_a3aadc7a86770372bb401fbcb4c05a252"><div class="ttname"><a href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a></div><div class="ttdeci">void log10(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00237">image_operate.cpp:237</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a9ea1a8f5ef3e6d20b362385e1288c72c"><div class="ttname"><a href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a></div><div class="ttdeci">double * delta</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07597">numerical_recipes.cpp:7597</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga757ffa92a783e2bfee146c7139e15be0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga757ffa92a783e2bfee146c7139e15be0">&#9670;&nbsp;</a></span>mask2D_4neig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mask2D_4neig </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>value</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>center</em> = <code><a class="el" href="group__Masks.html#ga208e6ec7969fa2afa47962bbe7a47dc1">NO_ACTIVATE</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a 3x3 mask with value (1 by default) for those 4-neighbours of the central point (0 otherwise).</p>
<p>The parameter center controls whether the center pixel is set to 1 or not </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00409">409</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;{</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    mask.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(3, 3);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    mask.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    mask(0, 1) = mask(1, 0) = mask(1, 2) = mask(2, 1) = value;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    mask(1, 1) = center;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00983">multidim_array.cpp:983</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02723">multidim_array.h:2723</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga38271c8bfabe440107efa83f762fba11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga38271c8bfabe440107efa83f762fba11">&#9670;&nbsp;</a></span>mask2D_8neig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mask2D_8neig </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>value1</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>value2</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>center</em> = <code><a class="el" href="group__Masks.html#ga208e6ec7969fa2afa47962bbe7a47dc1">NO_ACTIVATE</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a 3x3 mask with value1 for those 4-neighbors of the central point and value2 for the 8 neighbours.</p>
<p>The parameter center controls whether the center pixel is set to 1 or not </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00417">417</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;{</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    mask.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(3, 3);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    mask.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    mask(0, 1) = mask(1, 0) = mask(1, 2) = mask(2, 1) = value1;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    mask(0, 0) = mask(0, 2) = mask(2, 0) = mask(2, 2) = value2;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    mask(1, 1) = center;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00983">multidim_array.cpp:983</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02723">multidim_array.h:2723</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaa93258bba6703e7dd0bf23c6fedff86a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa93258bba6703e7dd0bf23c6fedff86a">&#9670;&nbsp;</a></span>mask3D_18neig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mask3D_18neig </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>value1</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>value2</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>center</em> = <code><a class="el" href="group__Masks.html#ga208e6ec7969fa2afa47962bbe7a47dc1">NO_ACTIVATE</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a 3x3x3 mask with value1 (1 by default) for those 6-neighbors and value2 for the 18 neighbors of the central point (0 otherwise).</p>
<p>The parameter center controls whether the center pixel is set to 1 or not </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00598">598</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;{</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    mask.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(3, 3, 3);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    mask.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    mask(1, 1, 1) = center;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="comment">//Face neighbors</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    mask(1, 1, 0) = mask(1, 1, 2) = mask(0, 1, 1) = mask(2, 1, 1) = mask(1, 0, 1) = mask(1, 2, 1) = value1;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="comment">//Edge neighbors</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    mask(0, 1, 0) = mask(0, 0, 1) = mask(0, 1, 2) = mask(0, 2, 1) = value2;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    mask(1, 0, 0) = mask(1, 2, 0) = mask(1, 0, 2) = mask(1, 2, 2) = value2;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    mask(2, 1, 0) = mask(2, 0, 1) = mask(2, 1, 2) = mask(2, 2, 1) = value2;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00983">multidim_array.cpp:983</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02723">multidim_array.h:2723</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gacac17e19d7b8f3ba81c01b1c5cbdf7a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacac17e19d7b8f3ba81c01b1c5cbdf7a8">&#9670;&nbsp;</a></span>mask3D_26neig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mask3D_26neig </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>value1</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>value2</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>value3</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>center</em> = <code><a class="el" href="group__Masks.html#ga208e6ec7969fa2afa47962bbe7a47dc1">NO_ACTIVATE</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a 3x3x3 mask with value1 (1 by default) for those 6-neighbors, value2 for the 18 neighbors and value3 for the 26 neighbors of the central point (0 otherwise).</p>
<p>The parameter center controls whether the center pixel is set to 1 or not </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00612">612</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;{</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    mask.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(3, 3, 3);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    mask.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    mask(1, 1, 1) = center;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="comment">//Face neighbors</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    mask(1, 1, 0) = mask(1, 1, 2) = mask(0, 1, 1) = mask(2, 1, 1) = mask(1, 0, 1) = mask(1, 2, 1) = value1;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="comment">//Edge neighbors</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    mask(0, 1, 0) = mask(0, 0, 1) = mask(0, 1, 2) = mask(0, 2, 1) = value2;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    mask(1, 0, 0) = mask(1, 2, 0) = mask(1, 0, 2) = mask(1, 2, 2) = value2;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    mask(2, 1, 0) = mask(2, 0, 1) = mask(2, 1, 2) = mask(2, 2, 1) = value2;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="comment">//Vertex neighbors</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    mask(0, 0, 0) = mask(0, 0, 2) = mask(0, 2, 0) = mask(0, 2, 2) = value3;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    mask(2, 0, 0) = mask(2, 0, 2) = mask(2, 2, 0) = mask(2, 2, 2) = value3;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00983">multidim_array.cpp:983</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02723">multidim_array.h:2723</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga1943342930b9a077f8618f9f182442a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1943342930b9a077f8618f9f182442a6">&#9670;&nbsp;</a></span>mask3D_6neig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mask3D_6neig </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>value</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>center</em> = <code><a class="el" href="group__Masks.html#ga208e6ec7969fa2afa47962bbe7a47dc1">NO_ACTIVATE</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a 3x3x3 mask with value (1 by default) for those 6-neighbors of the central point (0 otherwise).</p>
<p>The parameter center controls whether the center pixel is set to 1 or not </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00589">589</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;{</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    mask.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(3, 3, 3);</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    mask.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    mask(1, 1, 1) = center;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    mask(1, 1, 0) = mask(1, 1, 2) = mask(0, 1, 1) = mask(2, 1, 1) = mask(1, 0, 1) = mask(1, 2, 1) = value;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00983">multidim_array.cpp:983</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02723">multidim_array.h:2723</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gad0d072390d45045c014fd96f63e022bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad0d072390d45045c014fd96f63e022bc">&#9670;&nbsp;</a></span>RaisedCosineMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RaisedCosineMask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em> = <code><a class="el" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z0</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a RaisedCosine mask for already sized masks</p>
<p>The mask is supposed to be resized and with its logical origin already set. A circle placed logically at (x0,y0,z0), by default (0,0,0), is created with the radius indicated. The only two valid modes are INNER_MASK (by default) or OUTSIDE_MASK. Inner mask are normal RaisedCosines, and outside masks are 1 - RaisedCosine. When entering, the mask is initialiazed to 0 and then the mask is created. </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00036">36</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="libraries_2data_2integration_8cpp.html#a77a9b787be0b9b24ab6b55aade3eeeaf">K</a> = <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> / (<a class="code" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a> - <a class="code" href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a>);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordtype">double</span> r1_2=<a class="code" href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a>*<a class="code" href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a>;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">double</span> r2_2=<a class="code" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a>*<a class="code" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>=<a class="code" href="multidim__array__base_8h.html#aafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(mask); <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>&lt;=<a class="code" href="multidim__array__base_8h.html#a706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(mask); ++<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>)</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordtype">double</span> k2=(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> - <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>) * (<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> - <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=<a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(mask); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;=<a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(mask); ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        {</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            <span class="keywordtype">double</span> i2_k2=k2+(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>) * (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(mask); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;=<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(mask); ++<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                <span class="keywordtype">double</span> r2=i2_k2+(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>) * (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                <span class="keywordflow">if</span> (r2 &lt;= r1_2)</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                    <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 1;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r2 &lt; r2_2)</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                {</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                    <span class="keywordtype">double</span> r=<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(r2);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                    <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 0.5*(1 + cos(K * (r - r1)));</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                    <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 0;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a> == <a class="code" href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a>)</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                    <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 1 - <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        }</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;}</div><div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00210">image_operate.cpp:210</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a3f5c4dfb0dff56801752771f78265fbe"><div class="ttname"><a href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a></div><div class="ttdeci">#define z0</div></div>
<div class="ttc" id="multidim__array__base_8h_html_a706d2ce724d393d4d759a46225bbc6c1"><div class="ttname"><a href="multidim__array__base_8h.html#a706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a></div><div class="ttdeci">#define FINISHINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00071">multidim_array_base.h:71</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="multidim__array__base_8h_html_a6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00059">multidim_array_base.h:59</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a0d9521fd31b2e16413d1b78836953d53"><div class="ttname"><a href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a></div><div class="ttdeci">#define y0</div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a74e37497baeb87072fb1730874e59adb"><div class="ttname"><a href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a></div><div class="ttdeci">void mode</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00063">multidim_array_base.h:63</a></div></div>
<div class="ttc" id="group__Masks_html_gad17bd6c30fa379217b64dba93b7f53e3"><div class="ttname"><a href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a></div><div class="ttdeci">constexpr int OUTSIDE_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00048">mask.h:48</a></div></div>
<div class="ttc" id="libraries_2data_2integration_8cpp_html_a77a9b787be0b9b24ab6b55aade3eeeaf"><div class="ttname"><a href="libraries_2data_2integration_8cpp.html#a77a9b787be0b9b24ab6b55aade3eeeaf">K</a></div><div class="ttdeci">constexpr int K</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2integration_8cpp_source.html#l00123">integration.cpp:123</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_ab7a69dabaa7151dae4d7a3998167e2f3"><div class="ttname"><a href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a></div><div class="ttdeci">float r2</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_aafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="multidim__array__base_8h.html#aafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00067">multidim_array_base.h:67</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a1f47f51cace576c94f6c1c9483d28a8f"><div class="ttname"><a href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a></div><div class="ttdeci">float r1</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga670b6b4cac3aa318afb1758ba210ba2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga670b6b4cac3aa318afb1758ba210ba2e">&#9670;&nbsp;</a></span>RaisedCrownMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RaisedCrownMask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pix_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em> = <code><a class="el" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z0</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a RaisedCrown mask for already sized masks</p>
<p>The mask is supposed to be resized and with its logical origin already set. A circle placed logically at (x0,y0), by default (0,0), is created within the two the radii indicated with an extra region of (pix_width) pixels. The only two valid modes are INNER_MASK (by default) or OUTSIDE_MASK. Inner mask are normal RaisedCrowns, and outside masks are 1 - RaisedCrowns. When entering, the mask is initialiazed to 0 and then the mask is created. </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00067">67</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;{</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="group__Masks.html#gad0d072390d45045c014fd96f63e022bc">RaisedCosineMask</a>(mask, <a class="code" href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a> - pix_width, <a class="code" href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a> + pix_width, <a class="code" href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a>, <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>, <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>, <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> aux;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    aux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(mask);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="group__Masks.html#gad0d072390d45045c014fd96f63e022bc">RaisedCosineMask</a>(aux, <a class="code" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a> - pix_width, <a class="code" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a> + pix_width, <a class="code" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a>, <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>, <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>, <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(mask)</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) *= <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(aux, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a> == <a class="code" href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a>)</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 1 - <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00983">multidim_array.cpp:983</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a3f5c4dfb0dff56801752771f78265fbe"><div class="ttname"><a href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a></div><div class="ttdeci">#define z0</div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00269">multidim_array_base.h:269</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a0d9521fd31b2e16413d1b78836953d53"><div class="ttname"><a href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a></div><div class="ttdeci">#define y0</div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a74e37497baeb87072fb1730874e59adb"><div class="ttname"><a href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a></div><div class="ttdeci">void mode</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__Masks_html_gad17bd6c30fa379217b64dba93b7f53e3"><div class="ttname"><a href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a></div><div class="ttdeci">constexpr int OUTSIDE_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00048">mask.h:48</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_ab7a69dabaa7151dae4d7a3998167e2f3"><div class="ttname"><a href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a></div><div class="ttdeci">float r2</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="group__Masks_html_gad0d072390d45045c014fd96f63e022bc"><div class="ttname"><a href="group__Masks.html#gad0d072390d45045c014fd96f63e022bc">RaisedCosineMask</a></div><div class="ttdeci">void RaisedCosineMask(MultidimArray&lt; double &gt; &amp;mask, double r1, double r2, int mode, double x0, double y0, double z0)</div><div class="ttdef"><b>Definition:</b> <a href="mask_8cpp_source.html#l00036">mask.cpp:36</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a1f47f51cace576c94f6c1c9483d28a8f"><div class="ttname"><a href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a></div><div class="ttdeci">float r1</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="group__Masks_html_gac9de3d29a36807613ac35b5179169b8e"><div class="ttname"><a href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a></div><div class="ttdeci">constexpr int INNER_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00047">mask.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gacc5b7b7c85913b08abc68b4827bd4295"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacc5b7b7c85913b08abc68b4827bd4295">&#9670;&nbsp;</a></span>rangeAdjust_within_mask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rangeAdjust_within_mask </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>m1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>m2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Range adjust within binary mask</p>
<p>Make the grey values of m2 fit, in L2 sense, with those in m1. Only the voxels within the mask are used to compute the linear transformation. If no mask is provided then all voxels are used. </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l01738">1738</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;{</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> A(2, 2);</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    A.initZeros();</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>(2);</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>.initZeros();</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <a class="code" href="group__Macros.html#ga4c9386c11dfbaac4b99d2f7799dbc0c1">SPEED_UP_tempsInt</a>;</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    <span class="comment">// Compute Least squares solution</span></div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    <span class="keywordflow">if</span> (mask == <span class="keyword">nullptr</span>)</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    {</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        <a class="code" href="multidim__array__base_8h.html#aaee6e163d8f7e358c38d3fcfe935b6fc">FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D</a>(m1, m2)</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        {</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;            A(0, 0) += m2(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) * m2(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;            A(0, 1) += m2(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;            A(1, 1) += 1;</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;            <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>(0)   += m1(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) * m2(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;            <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>(1)   += m1(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        }</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;        A(1, 0) = A(0, 1);</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    }</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    {</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;        <a class="code" href="multidim__array__base_8h.html#aaee6e163d8f7e358c38d3fcfe935b6fc">FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D</a>(*mask, m2)</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;        {</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;            <span class="keywordflow">if</span> ((*mask)(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>))</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;            {</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                A(0, 0) += m2(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) * m2(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;                A(0, 1) += m2(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                A(1, 1) += 1;</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;                <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>(0)   += m1(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) * m2(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;                <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>(1)   += m1(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;            }</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;        }</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;        A(1, 0) = A(0, 1);</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    }</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a> = A.inv() * <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>;</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    <span class="comment">// Apply to m2</span></div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(m2) m2(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>(0) * m2(<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) + <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>(1);</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;}</div><div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00269">multidim_array_base.h:269</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af090b2fbbd2916bfb2e493c5162969d6"><div class="ttname"><a href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a></div><div class="ttdeci">doublereal * b</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02230">numerical_recipes.cpp:2230</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Macros_html_ga4c9386c11dfbaac4b99d2f7799dbc0c1"><div class="ttname"><a href="group__Macros.html#ga4c9386c11dfbaac4b99d2f7799dbc0c1">SPEED_UP_tempsInt</a></div><div class="ttdeci">#define SPEED_UP_tempsInt</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00408">xmipp_macros.h:408</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_aaee6e163d8f7e358c38d3fcfe935b6fc"><div class="ttname"><a href="multidim__array__base_8h.html#aaee6e163d8f7e358c38d3fcfe935b6fc">FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_COMMON_IN_ARRAY3D(V1, V2)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00298">multidim_array_base.h:298</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gafc888c1bf492265e7dc9b8e3a540bc5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafc888c1bf492265e7dc9b8e3a540bc5b">&#9670;&nbsp;</a></span>SeparableSincKaiserMask2D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SeparableSincKaiserMask2D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>omega</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>delta</em> = <code>0.01</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Deltaw</em> = <code>1.0/12.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a 2D separable-sinc-kaiser mask, the mask is resized. This function returns a sinc mask windowed by a Kaiser selfWindow. delta=ripple (in natural units) in the pass band. Deltaw=transition bandwidth (normalized to 1). omega=low pass frequency (normalized to 1). </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00379">379</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;{</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">// Convert Deltaw from a frequency normalized to 1, to a freq. normalized to PI</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    Deltaw *= <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    omega *= <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">// Design Kaiser selfWindow</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordtype">double</span> A = -20 * <a class="code" href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a>(<a class="code" href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a>);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordtype">double</span> M = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>((A - 8) / (2.285 * Deltaw));</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">if</span> (A &gt; 50)</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        beta = 0.1102 * (A - 8.7);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (A &gt;= 21)</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        beta = 0.5842 * pow(A - 21, 0.4) + 0.07886 * (A - 21);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        beta = 0;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">// &quot;Draw&quot; Separable Kaiser Sinc selfWindow</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    mask.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>((<span class="keywordtype">size_t</span>)(2*M + 1),(<span class="keywordtype">size_t</span>)(2*M + 1));</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    mask.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordtype">double</span> iI0Beta = 1.0 / <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#af79423b2c41ae25087708dabd9722890">bessi0</a>(beta);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(mask)</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    {</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        mask(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = omega/<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * <a class="code" href="group__Macros.html#ga106948f3882a4fb786ec0c2547bab930">SINC</a>(omega/<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) * omega/<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * <a class="code" href="group__Macros.html#ga106948f3882a4fb786ec0c2547bab930">SINC</a>(omega/<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) *</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                     <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#af79423b2c41ae25087708dabd9722890">bessi0</a>(beta * <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>((<span class="keywordtype">double</span>)(1 - (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> / M) * (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> / M)))) * iI0Beta *</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                     <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#af79423b2c41ae25087708dabd9722890">bessi0</a>(beta * <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>((<span class="keywordtype">double</span>)(1 - (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> / M) * (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> / M)))) * iI0Beta;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    }</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00983">multidim_array.cpp:983</a></div></div>
<div class="ttc" id="namespacealglib_html_a038c39f3bfe0dff667a2cb6bebfed764"><div class="ttname"><a href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">alglib::beta</a></div><div class="ttdeci">double beta(const double a, const double b)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l00962">specialfunctions.cpp:962</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00210">image_operate.cpp:210</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="multidim__array__base_8h.html#a7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00390">multidim_array_base.h:390</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8cpp_source.html#l00200">multidim_array_base.cpp:200</a></div></div>
<div class="ttc" id="cuda__gpu__reconstruct__fourier_8cpp_html_af79423b2c41ae25087708dabd9722890"><div class="ttname"><a href="cuda__gpu__reconstruct__fourier_8cpp.html#af79423b2c41ae25087708dabd9722890">bessi0</a></div><div class="ttdeci">__device__ float bessi0(float x)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gpu__reconstruct__fourier_8cpp_source.html#l00086">cuda_gpu_reconstruct_fourier.cpp:86</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_a3aadc7a86770372bb401fbcb4c05a252"><div class="ttname"><a href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a></div><div class="ttdeci">void log10(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00237">image_operate.cpp:237</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="group__Macros_html_ga106948f3882a4fb786ec0c2547bab930"><div class="ttname"><a href="group__Macros.html#ga106948f3882a4fb786ec0c2547bab930">SINC</a></div><div class="ttdeci">#define SINC(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00362">xmipp_macros.h:362</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a9ea1a8f5ef3e6d20b362385e1288c72c"><div class="ttname"><a href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a></div><div class="ttdeci">double * delta</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07597">numerical_recipes.cpp:7597</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gacc23efbd540bb3a40a9fcb15221d7c58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacc23efbd540bb3a40a9fcb15221d7c58">&#9670;&nbsp;</a></span>SincBlackmanMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SincBlackmanMask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>omega</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>power_percentage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z0</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a sinc-blackman mask, the mask is resized</p>
<p>This function returns a sinc mask windowed by a Blackman selfWindow. The selfWindow is designed to cover a certain power of the sinc </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00166">166</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;{</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> blackman;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordtype">int</span> N = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(1 / omega * <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(-1 / 2 + 1 / (<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * (1 - power_percentage / 100))));</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="multidim__array__base_8h.html#addfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(mask)==1)</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    {</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="comment">// 2D</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        mask.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(N, N);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        blackman.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(N, N);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="comment">// 3D</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        mask.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(N, N, N);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        blackman.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(N, N, N);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    mask.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="group__Masks.html#gaeb66a36a7d6902696536b5e568a982e0">SincMask</a>(mask,omega,<a class="code" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a>,<a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>,<a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>,<a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    blackman.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="group__Masks.html#gaaf93cc29cff5705b942acc0f9f61d860">BlackmanMask</a>(blackman);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    mask *= blackman;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00983">multidim_array.cpp:983</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Masks_html_gaeb66a36a7d6902696536b5e568a982e0"><div class="ttname"><a href="group__Masks.html#gaeb66a36a7d6902696536b5e568a982e0">SincMask</a></div><div class="ttdeci">void SincMask(MultidimArray&lt; double &gt; &amp;mask, double omega, int mode, double x0, double y0, double z0)</div><div class="ttdef"><b>Definition:</b> <a href="mask_8cpp_source.html#l00127">mask.cpp:127</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a3f5c4dfb0dff56801752771f78265fbe"><div class="ttname"><a href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a></div><div class="ttdeci">#define z0</div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8cpp_source.html#l00200">multidim_array_base.cpp:200</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a0d9521fd31b2e16413d1b78836953d53"><div class="ttname"><a href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a></div><div class="ttdeci">#define y0</div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="group__Masks_html_gaaf93cc29cff5705b942acc0f9f61d860"><div class="ttname"><a href="group__Masks.html#gaaf93cc29cff5705b942acc0f9f61d860">BlackmanMask</a></div><div class="ttdeci">void BlackmanMask(MultidimArray&lt; double &gt; &amp;mask, int mode, double x0, double y0, double z0)</div><div class="ttdef"><b>Definition:</b> <a href="mask_8cpp_source.html#l00151">mask.cpp:151</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_addfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="multidim__array__base_8h.html#addfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00099">multidim_array_base.h:99</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="group__Masks_html_gac9de3d29a36807613ac35b5179169b8e"><div class="ttname"><a href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a></div><div class="ttdeci">constexpr int INNER_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00047">mask.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga7289b52c50e1b5e8a8d500fe5e3d2ef0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7289b52c50e1b5e8a8d500fe5e3d2ef0">&#9670;&nbsp;</a></span>SincKaiserMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SincKaiserMask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>omega</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>delta</em> = <code>0.01</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Deltaw</em> = <code>1.0/12.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a radial-sinc-kaiser mask, the mask is resized. This function returns a sinc mask windowed by a Kaiser selfWindow. delta=ripple (in natural units) in the pass band. Deltaw=transition bandwidth (normalized to 1). omega=low pass frequency (normalized to 1). </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00139">139</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;{</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> kaiser;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    kaiser.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(mask);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="group__Masks.html#gaf284df7ea9e569041cafa8477a421f84">KaiserMask</a>(kaiser, <a class="code" href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a>, Deltaw);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    mask.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(kaiser);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    mask.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="group__Masks.html#gaeb66a36a7d6902696536b5e568a982e0">SincMask</a>(mask, omega*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>, <a class="code" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a>);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    mask *= kaiser;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00983">multidim_array.cpp:983</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classMultidimArray_html_ac0efebfb32ab4e37cf33efca3349aa9b"><div class="ttname"><a href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">MultidimArray::resizeNoCopy</a></div><div class="ttdeci">void resizeNoCopy(const MultidimArray&lt; T1 &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00504">multidim_array.h:504</a></div></div>
<div class="ttc" id="group__Masks_html_gaeb66a36a7d6902696536b5e568a982e0"><div class="ttname"><a href="group__Masks.html#gaeb66a36a7d6902696536b5e568a982e0">SincMask</a></div><div class="ttdeci">void SincMask(MultidimArray&lt; double &gt; &amp;mask, double omega, int mode, double x0, double y0, double z0)</div><div class="ttdef"><b>Definition:</b> <a href="mask_8cpp_source.html#l00127">mask.cpp:127</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8cpp_source.html#l00200">multidim_array_base.cpp:200</a></div></div>
<div class="ttc" id="group__Masks_html_gaf284df7ea9e569041cafa8477a421f84"><div class="ttname"><a href="group__Masks.html#gaf284df7ea9e569041cafa8477a421f84">KaiserMask</a></div><div class="ttdeci">void KaiserMask(MultidimArray&lt; double &gt; &amp;mask, double delta, double Deltaw)</div><div class="ttdef"><b>Definition:</b> <a href="mask_8cpp_source.html#l00083">mask.cpp:83</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a9ea1a8f5ef3e6d20b362385e1288c72c"><div class="ttname"><a href="numerical__recipes_8cpp.html#a9ea1a8f5ef3e6d20b362385e1288c72c">delta</a></div><div class="ttdeci">double * delta</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07597">numerical_recipes.cpp:7597</a></div></div>
<div class="ttc" id="group__Masks_html_gac9de3d29a36807613ac35b5179169b8e"><div class="ttname"><a href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a></div><div class="ttdeci">constexpr int INNER_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00047">mask.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaeb66a36a7d6902696536b5e568a982e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaeb66a36a7d6902696536b5e568a982e0">&#9670;&nbsp;</a></span>SincMask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SincMask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>omega</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em> = <code><a class="el" href="group__Masks.html#gac9de3d29a36807613ac35b5179169b8e">INNER_MASK</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z0</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a sinc mask for already sized masks</p>
<p>The mask is supposed to be resized and with its logical origin already set. A circle placed logically at (x0), by default (0), is created with the radius indicated. The only two valid modes are INNER_MASK (by default) or OUTSIDE_MASK. Inner mask are normal sincs, and outside masks are 1 - sinc. When entering the mask is initialiazed to 0 and then the mask is created.</p>
<p>Remind that sinc(w*n) is zero at n=1/w; </p>

<p class="definition">Definition at line <a class="el" href="mask_8cpp_source.html#l00127">127</a> of file <a class="el" href="mask_8cpp_source.html">mask.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;{</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(mask)</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    {</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordtype">double</span> r = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>( (<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> - <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>) * (<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> - <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>) + (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>) * (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>) + (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>) * (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>) );</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = omega/<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * <a class="code" href="group__Macros.html#ga106948f3882a4fb786ec0c2547bab930">SINC</a>(omega/<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * r);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a> == <a class="code" href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a>)</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 1 - <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(mask, <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;}</div><div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00210">image_operate.cpp:210</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a3f5c4dfb0dff56801752771f78265fbe"><div class="ttname"><a href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a></div><div class="ttdeci">#define z0</div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="multidim__array__base_8h.html#a59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00269">multidim_array_base.h:269</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a0d9521fd31b2e16413d1b78836953d53"><div class="ttname"><a href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a></div><div class="ttdeci">#define y0</div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a74e37497baeb87072fb1730874e59adb"><div class="ttname"><a href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a></div><div class="ttdeci">void mode</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04411">numerical_recipes.cpp:4411</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__Masks_html_gad17bd6c30fa379217b64dba93b7f53e3"><div class="ttname"><a href="group__Masks.html#gad17bd6c30fa379217b64dba93b7f53e3">OUTSIDE_MASK</a></div><div class="ttdeci">constexpr int OUTSIDE_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00048">mask.h:48</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="group__Macros_html_ga106948f3882a4fb786ec0c2547bab930"><div class="ttname"><a href="group__Macros.html#ga106948f3882a4fb786ec0c2547bab930">SINC</a></div><div class="ttdeci">#define SINC(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00362">xmipp_macros.h:362</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ga6048a038c89f2aac58cecd96aa9fee6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6048a038c89f2aac58cecd96aa9fee6b">&#9670;&nbsp;</a></span>ACTIVATE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int ACTIVATE = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mask_8h_source.html#l00050">50</a> of file <a class="el" href="mask_8h_source.html">mask.h</a>.</p>

</div>
</div>
<a id="gacddf12a44ad18f7d3d7555e2d6918d2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacddf12a44ad18f7d3d7555e2d6918d2f">&#9670;&nbsp;</a></span>COUNT_ABOVE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int COUNT_ABOVE = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mask_8h_source.html#l00942">942</a> of file <a class="el" href="mask_8h_source.html">mask.h</a>.</p>

</div>
</div>
<a id="ga6b609bf3ee4fe60e9623eb10678c52aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6b609bf3ee4fe60e9623eb10678c52aa">&#9670;&nbsp;</a></span>COUNT_BELOW</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int COUNT_BELOW = 2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mask_8h_source.html#l00943">943</a> of file <a class="el" href="mask_8h_source.html">mask.h</a>.</p>

</div>
</div>
<a id="ga7030285e58b95c96d766c3998d3d37d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7030285e58b95c96d766c3998d3d37d8">&#9670;&nbsp;</a></span>COUNT_BETWEEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int COUNT_BETWEEN = 3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mask_8h_source.html#l00944">944</a> of file <a class="el" href="mask_8h_source.html">mask.h</a>.</p>

</div>
</div>
<a id="gac9de3d29a36807613ac35b5179169b8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac9de3d29a36807613ac35b5179169b8e">&#9670;&nbsp;</a></span>INNER_MASK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int INNER_MASK = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mask_8h_source.html#l00047">47</a> of file <a class="el" href="mask_8h_source.html">mask.h</a>.</p>

</div>
</div>
<a id="ga208e6ec7969fa2afa47962bbe7a47dc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga208e6ec7969fa2afa47962bbe7a47dc1">&#9670;&nbsp;</a></span>NO_ACTIVATE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int NO_ACTIVATE = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mask_8h_source.html#l00049">49</a> of file <a class="el" href="mask_8h_source.html">mask.h</a>.</p>

</div>
</div>
<a id="gad17bd6c30fa379217b64dba93b7f53e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad17bd6c30fa379217b64dba93b7f53e3">&#9670;&nbsp;</a></span>OUTSIDE_MASK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int OUTSIDE_MASK = 2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mask_8h_source.html#l00048">48</a> of file <a class="el" href="mask_8h_source.html">mask.h</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
