<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Xmipp: Geometry</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">Geometry</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structFitPoint.html">FitPoint</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfit__point2D.html">fit_point2D</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBspline__model.html">Bspline_model</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Geometrical operations</h2></td></tr>
<tr class="memitem:gade8f7976e3d84a594d4728bf8f4c029e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#gade8f7976e3d84a594d4728bf8f4c029e">Uproject_to_plane</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;point, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="group__FringeProcessing.html#gad71cd7f2325be81202279ed730355092">direction</a>, double <a class="el" href="external_2delaunay_2point_8h.html#adb0abda300c610b969c8be89ed30a4f6">distance</a>, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;result)</td></tr>
<tr class="separator:gade8f7976e3d84a594d4728bf8f4c029e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga54b1579073632c12c4d311be204eec3e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#ga54b1579073632c12c4d311be204eec3e">Uproject_to_plane</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;r, double rot, double tilt, double psi, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;result)</td></tr>
<tr class="separator:ga54b1579073632c12c4d311be204eec3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaec185180517a9672a2ebdc0a1bfd3e77"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#gaec185180517a9672a2ebdc0a1bfd3e77">Uproject_to_plane</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;r, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;euler, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;result)</td></tr>
<tr class="separator:gaec185180517a9672a2ebdc0a1bfd3e77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab9ad8d1ca1a8c56fb2a1cfe0a5990cc4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#gab9ad8d1ca1a8c56fb2a1cfe0a5990cc4">spherical_distance</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a>, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a>)</td></tr>
<tr class="separator:gab9ad8d1ca1a8c56fb2a1cfe0a5990cc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3adf48a1d9643041f01f7bab097a8d44"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#ga3adf48a1d9643041f01f7bab097a8d44">point_line_distance_3D</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;p, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;v)</td></tr>
<tr class="separator:ga3adf48a1d9643041f01f7bab097a8d44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa4d9e4ee82f494ed61ace73dd7a2dc81"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#gaa4d9e4ee82f494ed61ace73dd7a2dc81">point_plane_distance_3D</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;p, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;v)</td></tr>
<tr class="separator:gaa4d9e4ee82f494ed61ace73dd7a2dc81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga390c0b3d3c4ee8857d9c9e5ab36d7f30"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#ga390c0b3d3c4ee8857d9c9e5ab36d7f30">least_squares_plane_fit</a> (<a class="el" href="structFitPoint.html">FitPoint</a> *IN_points, int Npoints, double &amp;plane_A, double &amp;plane_B, double &amp;plane_C)</td></tr>
<tr class="separator:ga390c0b3d3c4ee8857d9c9e5ab36d7f30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga132d339f9935014a8df1c1073e6400cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#ga132d339f9935014a8df1c1073e6400cd">least_squares_plane_fit_All_Points</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;<a class="el" href="classImage.html">Image</a>, double &amp;plane_A, double &amp;plane_B, double &amp;plane_C)</td></tr>
<tr class="separator:ga132d339f9935014a8df1c1073e6400cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga89aeed607c234539e306b114f7a33195"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#ga89aeed607c234539e306b114f7a33195">least_squares_line_fit</a> (const std::vector&lt; <a class="el" href="structfit__point2D.html">fit_point2D</a> &gt; &amp;IN_points, double &amp;line_A, double &amp;line_B)</td></tr>
<tr class="separator:ga89aeed607c234539e306b114f7a33195"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaec7aca810b7ac7bdcea7a7282e6aa6c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#gaaec7aca810b7ac7bdcea7a7282e6aa6c">Bspline_model_fitting</a> (const std::vector&lt; <a class="el" href="structFitPoint.html">FitPoint</a> &gt; &amp;IN_points, int SplineDegree, int l0, int lF, int m0, int mF, double h_x, double h_y, double <a class="el" href="project__crystal_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>, double <a class="el" href="project__crystal_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>, <a class="el" href="classBspline__model.html">Bspline_model</a> &amp;result)</td></tr>
<tr class="separator:gaaec7aca810b7ac7bdcea7a7282e6aa6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf98f879a0edc0a55192481d00e31ae37"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#gaf98f879a0edc0a55192481d00e31ae37">rectangle_enclosing</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a8eb6f9afe59b4924d42d1ea2002148e7">v0</a>, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;vF, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;V, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;corner1, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;corner2)</td></tr>
<tr class="separator:gaf98f879a0edc0a55192481d00e31ae37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3baa7ca66e02a7a51562325d28e70d47"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#ga3baa7ca66e02a7a51562325d28e70d47">box_enclosing</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a8eb6f9afe59b4924d42d1ea2002148e7">v0</a>, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;vF, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;V, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;corner1, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;corner2)</td></tr>
<tr class="separator:ga3baa7ca66e02a7a51562325d28e70d47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4ba6558fddc767ff505f747d275ea5d4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#ga4ba6558fddc767ff505f747d275ea5d4">point_inside_polygon</a> (const std::vector&lt; <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &gt; &amp;polygon, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;point)</td></tr>
<tr class="separator:ga4ba6558fddc767ff505f747d275ea5d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3a2dfdbceca9c87ab5be4fbaa5cb78d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#ga3a2dfdbceca9c87ab5be4fbaa5cb78d1">def_affinity</a> (double u1x, double u1y, double u2x, double u2y, double u3x, double u3y, double t1x, double t1y, double t2x, double t2y, double t3x, double t3y, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;T, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;invW)</td></tr>
<tr class="separator:ga3a2dfdbceca9c87ab5be4fbaa5cb78d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga087a4c564869f76df0f1a499737e4e50"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#ga087a4c564869f76df0f1a499737e4e50">triangle_area</a> (double x1, double y1, double x2, double y2, double x3, double y3)</td></tr>
<tr class="separator:ga087a4c564869f76df0f1a499737e4e50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga90c00c4b44fb178a299c96bb8587df52"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#ga90c00c4b44fb178a299c96bb8587df52">line_plane_intersection</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; normal_plane, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; vector_line, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;intersection_point, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; point_line, double point_plane_at_x_y_zero=0.)</td></tr>
<tr class="separator:ga90c00c4b44fb178a299c96bb8587df52"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Euler operations</h2></td></tr>
<tr class="memitem:gaf67a2d233e3fbf038d111a91197fa759"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:gaf67a2d233e3fbf038d111a91197fa759"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a> (T <a class="el" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, T <a class="el" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, T <a class="el" href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a>, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;A, bool homogeneous=false)</td></tr>
<tr class="separator:gaf67a2d233e3fbf038d111a91197fa759"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga831e69dcc04c1853cffb899072979654"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#ga831e69dcc04c1853cffb899072979654">Euler_anglesZXZ2matrix</a> (double <a class="el" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, double <a class="el" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, double <a class="el" href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a>, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A, bool homogeneous=false)</td></tr>
<tr class="separator:ga831e69dcc04c1853cffb899072979654"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0de882a451c91a7a8580614fcc57c407"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#ga0de882a451c91a7a8580614fcc57c407">Euler_distanceBetweenMatrices</a> (const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;E1, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;E2)</td></tr>
<tr class="separator:ga0de882a451c91a7a8580614fcc57c407"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9d70fcf75a8e3278bee887e0ef47c3d6"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga9d70fcf75a8e3278bee887e0ef47c3d6"><td class="memTemplItemLeft" align="right" valign="top">T&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Geometry.html#ga9d70fcf75a8e3278bee887e0ef47c3d6">Euler_distanceBetweenAngleSets</a> (T rot1, T tilt1, T psi1, T rot2, T tilt2, T psi2, bool only_projdir)</td></tr>
<tr class="separator:ga9d70fcf75a8e3278bee887e0ef47c3d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaee274cbf4227b0a40a0192437d0ce258"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:gaee274cbf4227b0a40a0192437d0ce258"><td class="memTemplItemLeft" align="right" valign="top">T&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Geometry.html#gaee274cbf4227b0a40a0192437d0ce258">Euler_distanceBetweenAngleSets_fast</a> (const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;E1, T rot2, T tilt2, T psi2, bool only_projdir, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;E2)</td></tr>
<tr class="separator:gaee274cbf4227b0a40a0192437d0ce258"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadaf2fbd3996fb68c98a60633c1a8db68"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#gadaf2fbd3996fb68c98a60633c1a8db68">Euler_Angles_after_compresion</a> (const double rot, double tilt, double psi, double &amp;new_rot, double &amp;new_tilt, double &amp;new_psi, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;D)</td></tr>
<tr class="separator:gadaf2fbd3996fb68c98a60633c1a8db68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac0a39b9536b704ecb1c9e44436796b2b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#gac0a39b9536b704ecb1c9e44436796b2b">Euler_direction</a> (double alpha, double beta, double <a class="el" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a>, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;v)</td></tr>
<tr class="separator:gac0a39b9536b704ecb1c9e44436796b2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaac7ef13b5115d1ba4eee95784243cd9c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#gaac7ef13b5115d1ba4eee95784243cd9c">Euler_direction2angles</a> (<a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;v, double &amp;alpha, double &amp;beta, double &amp;<a class="el" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a>)</td></tr>
<tr class="separator:gaac7ef13b5115d1ba4eee95784243cd9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa0889ad000c2166f766c927fc7c2f58c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#gaa0889ad000c2166f766c927fc7c2f58c">Euler_matrix2angles</a> (const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A, double &amp;alpha, double &amp;beta, double &amp;<a class="el" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a>, bool homogeneous=false)</td></tr>
<tr class="separator:gaa0889ad000c2166f766c927fc7c2f58c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga927b671af65fe7edba793ca05b0c665a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#ga927b671af65fe7edba793ca05b0c665a">Euler_up_down</a> (double rot, double tilt, double psi, double &amp;newrot, double &amp;newtilt, double &amp;newpsi)</td></tr>
<tr class="separator:ga927b671af65fe7edba793ca05b0c665a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4f0aa261268a10dde4daf1faab390a00"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#ga4f0aa261268a10dde4daf1faab390a00">Euler_another_set</a> (double rot, double tilt, double psi, double &amp;newrot, double &amp;newtilt, double &amp;newpsi)</td></tr>
<tr class="separator:ga4f0aa261268a10dde4daf1faab390a00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2025665517148ed18cd866241c8aba3a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#ga2025665517148ed18cd866241c8aba3a">Euler_mirrorY</a> (double rot, double tilt, double psi, double &amp;newrot, double &amp;newtilt, double &amp;newpsi)</td></tr>
<tr class="separator:ga2025665517148ed18cd866241c8aba3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga793967c9f8c58bdd585a6bdfbe7806a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#ga793967c9f8c58bdd585a6bdfbe7806a3">Euler_mirrorX</a> (double rot, double tilt, double psi, double &amp;newrot, double &amp;newtilt, double &amp;newpsi)</td></tr>
<tr class="separator:ga793967c9f8c58bdd585a6bdfbe7806a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa8e4765997f2a336493a6b7a843cd7bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#gaa8e4765997f2a336493a6b7a843cd7bd">Euler_mirrorXY</a> (double rot, double tilt, double psi, double &amp;newrot, double &amp;newtilt, double &amp;newpsi)</td></tr>
<tr class="separator:gaa8e4765997f2a336493a6b7a843cd7bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1a37da6506d421d52c9a102eb9732928"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#ga1a37da6506d421d52c9a102eb9732928">Euler_apply_transf</a> (const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;L, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;R, double rot, double tilt, double psi, double &amp;newrot, double &amp;newtilt, double &amp;newpsi)</td></tr>
<tr class="separator:ga1a37da6506d421d52c9a102eb9732928"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadd4cd90d2c7b5471461066cb5042edb8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#gadd4cd90d2c7b5471461066cb5042edb8">Euler_rotate</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V, double rot, double tilt, double psi, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;result)</td></tr>
<tr class="separator:gadd4cd90d2c7b5471461066cb5042edb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae58ee12942ad4fe5a7d07ab7b988a827"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#gae58ee12942ad4fe5a7d07ab7b988a827">Euler_rotate</a> (const <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;V, double rot, double tilt, double psi, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;result)</td></tr>
<tr class="separator:gae58ee12942ad4fe5a7d07ab7b988a827"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaae41a5015cbfd6ab97119d08e572cd23"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#gaae41a5015cbfd6ab97119d08e572cd23">computeCircleAroundE</a> (const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;E, double angCircle, double angStep, std::vector&lt; double &gt; &amp;outputEulerAngles)</td></tr>
<tr class="separator:gaae41a5015cbfd6ab97119d08e572cd23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac9a01090711842bea6f6fe759ca71ceb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#gac9a01090711842bea6f6fe759ca71ceb">EULER_CLIPPING</a>(rot,  tilt,  psi)</td></tr>
<tr class="separator:gac9a01090711842bea6f6fe759ca71ceb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5eed0e298c6feb8b860a764f5eeab84d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#ga5eed0e298c6feb8b860a764f5eeab84d">EULER_CLIPPING_RAD</a>(rot,  tilt,  psi)</td></tr>
<tr class="separator:ga5eed0e298c6feb8b860a764f5eeab84d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Intersections</h2></td></tr>
<tr class="memitem:ga64b58172fd2a45ebeae5e7ce3216ec1c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#ga64b58172fd2a45ebeae5e7ce3216ec1c">intersection_unit_sphere</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a>, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;r)</td></tr>
<tr class="separator:ga64b58172fd2a45ebeae5e7ce3216ec1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad110429984082334e49641f5bca50c02"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#gad110429984082334e49641f5bca50c02">intersection_unit_cylinder</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a>, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;r)</td></tr>
<tr class="separator:gad110429984082334e49641f5bca50c02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabc3d2cc2704dd94b49fb8c2c0fc5a977"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Geometry.html#gabc3d2cc2704dd94b49fb8c2c0fc5a977">intersection_unit_cube</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a>, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;r)</td></tr>
<tr class="separator:gabc3d2cc2704dd94b49fb8c2c0fc5a977"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="gac9a01090711842bea6f6fe759ca71ceb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EULER_CLIPPING</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">rot, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">tilt, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">psi&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">rot = <a class="code" href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a>(rot, 0, 360); \</div><div class="line">    tilt = <a class="code" href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a>(tilt, 0, 360); <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">\</a></div><div class="line"><a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">    psi</a> = <a class="code" href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a>(<a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>, 0, 360);</div><div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="group__Macros_html_ga25935c2309abe02cff60809c4d7d9b9e"><div class="ttname"><a href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a></div><div class="ttdeci">#define realWRAP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00304">xmipp_macros.h:304</a></div></div>
</div><!-- fragment --><p>Getting the <a class="el" href="classEuler.html">Euler</a> angles to a range (0-360). No direction equivalence is applied, ie, there is no correction of the direction of projection making use that a view from the top is the same as a view from the bottom but reversed ... Just a wrapping of the angles is done until the angles fall in the specified ranges. The angles given must be variables and they are modified with the new values. </p>

<p>Definition at line <a class="el" href="geometry_8h_source.html#l00548">548</a> of file <a class="el" href="geometry_8h_source.html">geometry.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga5eed0e298c6feb8b860a764f5eeab84d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EULER_CLIPPING_RAD</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">rot, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">tilt, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">psi&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">rot = <a class="code" href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a>(rot, 0, 2.0*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>); \</div><div class="line">    tilt = <a class="code" href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a>(tilt, 0, 2.0*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>); <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">\</a></div><div class="line"><a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">    psi</a> = <a class="code" href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a>(<a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>, 0, 2.0*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>);</div><div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="group__Macros_html_ga25935c2309abe02cff60809c4d7d9b9e"><div class="ttname"><a href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a></div><div class="ttdeci">#define realWRAP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00304">xmipp_macros.h:304</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
</div><!-- fragment --><p>Getting the <a class="el" href="classEuler.html">Euler</a> angles to a range (0-2*PI).</p>
<p>The same as before but the angles are expressed in radians. </p>

<p>Definition at line <a class="el" href="geometry_8h_source.html#l00557">557</a> of file <a class="el" href="geometry_8h_source.html">geometry.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga3baa7ca66e02a7a51562325d28e70d47"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void box_enclosing </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>vF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>corner1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>corner2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Box which encloses a deformed box</p>
<p>Given a box characterized by the top-left corner (most negative) and the right-bottom (most positive) corner, and given a matrix after which the box is deformed. Which is the minimum box which encloses the preceding one? This function is useful for stablishing for loops which will cover for sure the deformed box. All vectors are supposed to be 3x1 and the deformation matrix is 3x3. The corner (x0,y0,z0) goes to V*(x0,y0,z0)' and (xF,yF,zF) to V*(xf,yF,zF)'. After that you can make a loop from corner1 to corner2.</p>
<p>The v0 and vF vectors can be reused as outputs. </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00363">363</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;{</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a>;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> v(3);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    corner1.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(3);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    corner2.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(3);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">// Store values for reusing input as output vectors</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordtype">double</span> XX_v0 = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(v0);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordtype">double</span> YY_v0 = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(v0);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordtype">double</span> ZZ_v0 = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(v0);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordtype">double</span> XX_vF = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(vF);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordtype">double</span> YY_vF = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(vF);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordtype">double</span> ZZ_vF = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(vF);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(v, XX_v0, YY_v0, ZZ_v0);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <a class="code" href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a>(v, V, v);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1) = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(v);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2) = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(v);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1) = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(v);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2) = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(v);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner1) = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(v);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner2) = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(v);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="preprocessor">#define DEFORM_AND_CHOOSE_CORNERS3D \</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="preprocessor">    M3x3_BY_V3x1(v,V,v); \</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="preprocessor">    XX(corner1)=XMIPP_MIN(XX(corner1),XX(v)); \</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="preprocessor">    XX(corner2)=XMIPP_MAX(XX(corner2),XX(v)); \</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="preprocessor">    YY(corner1)=XMIPP_MIN(YY(corner1),YY(v)); \</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="preprocessor">    YY(corner2)=XMIPP_MAX(YY(corner2),YY(v)); \</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="preprocessor">    ZZ(corner1)=XMIPP_MIN(ZZ(corner1),ZZ(v)); \</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="preprocessor">    ZZ(corner2)=XMIPP_MAX(ZZ(corner2),ZZ(v));</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(v, XX_vF, YY_v0, ZZ_v0);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <a class="code" href="geometry_8cpp.html#acf97b3e94f98705f8858176abc81ab46">DEFORM_AND_CHOOSE_CORNERS3D</a>;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(v, XX_v0, YY_vF, ZZ_v0);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <a class="code" href="geometry_8cpp.html#acf97b3e94f98705f8858176abc81ab46">DEFORM_AND_CHOOSE_CORNERS3D</a>;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(v, XX_vF, YY_vF, ZZ_v0);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <a class="code" href="geometry_8cpp.html#acf97b3e94f98705f8858176abc81ab46">DEFORM_AND_CHOOSE_CORNERS3D</a>;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(v, XX_v0, YY_v0, ZZ_vF);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <a class="code" href="geometry_8cpp.html#acf97b3e94f98705f8858176abc81ab46">DEFORM_AND_CHOOSE_CORNERS3D</a>;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(v, XX_vF, YY_v0, ZZ_vF);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="geometry_8cpp.html#acf97b3e94f98705f8858176abc81ab46">DEFORM_AND_CHOOSE_CORNERS3D</a>;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(v, XX_v0, YY_vF, ZZ_vF);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <a class="code" href="geometry_8cpp.html#acf97b3e94f98705f8858176abc81ab46">DEFORM_AND_CHOOSE_CORNERS3D</a>;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(v, XX_vF, YY_vF, ZZ_vF);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="geometry_8cpp.html#acf97b3e94f98705f8858176abc81ab46">DEFORM_AND_CHOOSE_CORNERS3D</a>;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;}</div><div class="ttc" id="geometry_8cpp_html_acf97b3e94f98705f8858176abc81ab46"><div class="ttname"><a href="geometry_8cpp.html#acf97b3e94f98705f8858176abc81ab46">DEFORM_AND_CHOOSE_CORNERS3D</a></div><div class="ttdeci">#define DEFORM_AND_CHOOSE_CORNERS3D</div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="classMatrix1D_html_a79a482948ae334cbefaef7c7839cd934"><div class="ttname"><a href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">Matrix1D::resize</a></div><div class="ttdeci">void resize(size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00451">matrix1d.h:451</a></div></div>
<div class="ttc" id="group__Matrices_html_gad159332322d687de886a720422e4b757"><div class="ttname"><a href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a></div><div class="ttdeci">#define M3x3_BY_V3x1(a, M, b)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00171">matrix2d.h:171</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_ga6c6b4d4f88daca5e1d8e171bec3b4af0"><div class="ttname"><a href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a></div><div class="ttdeci">#define VECTOR_R3(v, x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00127">matrix1d.h:127</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="group__Macros_html_ga20716e3da0ba25d3c4c9a2421573391f"><div class="ttname"><a href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a></div><div class="ttdeci">#define SPEED_UP_temps012</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00403">xmipp_macros.h:403</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaaec7aca810b7ac7bdcea7a7282e6aa6c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bspline_model_fitting </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structFitPoint.html">FitPoint</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>IN_points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SplineDegree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>l0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>h_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>h_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classBspline__model.html">Bspline_model</a> &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Least-squares fit of a B-spline 2D model</p>
<p>For fitting a set of values that are distributed between (x0,y0) and (xF,yF) with a cubic Bspline centered on each corner, the right call is</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Bspline_model model;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Bspline_model_fitting(list_of_points, 3, -1, 2, -1, 2, xF-x0, yF-y0, x0,</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    y0, model);</div></div><!-- fragment --><p>Once the model is returned you can evaluate it at any point simply by</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;model.evaluate(x,y);</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00240">240</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;{</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">// Initialize model</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    result.<a class="code" href="classBspline__model.html#ae2fe9367828446b060636ba894b7d3ce">l0</a> = l0;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    result.<a class="code" href="classBspline__model.html#a38d62bdcede23ea7949548530ef8da26">lF</a> = lF;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    result.<a class="code" href="classBspline__model.html#a87c02c3fcc3b3eb92496736f26773e21">m0</a> = m0;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    result.<a class="code" href="classBspline__model.html#a6d4e29d0f9665703b48cd9b915524b34">mF</a> = mF;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    result.<a class="code" href="classBspline__model.html#abb905807490cb4e6b8acffb77d537b86">x0</a> = <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    result.<a class="code" href="classBspline__model.html#a6dc02a3ef9b7e62ff4f09b2807d868bb">y0</a> = <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    result.<a class="code" href="classBspline__model.html#a163c39fbfa28a8c60ccb278d809b9dd1">SplineDegree</a> = SplineDegree;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    result.<a class="code" href="classBspline__model.html#a1fc6ba1e579156189043a08b257ef12d">h_x</a> = h_x;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    result.<a class="code" href="classBspline__model.html#a0558f6253836c2e1c066e6d03881ccea">h_y</a> = h_y;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    result.<a class="code" href="classBspline__model.html#a9a9c5b23a5dd2e6f6bc48edbebc3cfc8">c_ml</a>.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(mF - m0 + 1, lF - l0 + 1);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(result.<a class="code" href="classBspline__model.html#a9a9c5b23a5dd2e6f6bc48edbebc3cfc8">c_ml</a>) = m0;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(result.<a class="code" href="classBspline__model.html#a9a9c5b23a5dd2e6f6bc48edbebc3cfc8">c_ml</a>) = l0;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">// Modify the list of points to include the weight</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">int</span> Npoints = IN_points.size();</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    std::vector&lt;FitPoint&gt; AUX_points = IN_points;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; Npoints; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    {</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordtype">double</span> sqrt_w = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(AUX_points[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        AUX_points[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].x *= sqrt_w;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        AUX_points[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].y *= sqrt_w;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        AUX_points[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].z *= sqrt_w;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">// Now solve the normal linear regression problem</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// Ax=B</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">// A=system matrix</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">// x=B-spline coefficients</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">// B=vector of measured values</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordtype">int</span> Ncoeff = <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(result.<a class="code" href="classBspline__model.html#a9a9c5b23a5dd2e6f6bc48edbebc3cfc8">c_ml</a>) * <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(result.<a class="code" href="classBspline__model.html#a9a9c5b23a5dd2e6f6bc48edbebc3cfc8">c_ml</a>);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> A(Npoints, Ncoeff);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> B(Npoints);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; Npoints; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        B(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = AUX_points[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].z;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordtype">double</span> xarg = (AUX_points[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].x - <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>) / h_x;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordtype">double</span> yarg = (AUX_points[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].y - <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>) / h_y;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> = m0; <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> &lt;= mF; ++<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>)</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = l0; l &lt;= lF; ++l)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                <span class="keywordtype">double</span> coeff=0.;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                <span class="keywordflow">switch</span> (SplineDegree)</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                    coeff = <a class="code" href="group__KernelDefinition.html#gaa92a7fe60e1322678e95722660710dde">Bspline02</a>(xarg - l) * <a class="code" href="group__KernelDefinition.html#gaa92a7fe60e1322678e95722660710dde">Bspline02</a>(yarg - <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                    coeff = <a class="code" href="group__KernelDefinition.html#gace85f77536f263f76d041d57b6f781c9">Bspline03</a>(xarg - l) * <a class="code" href="group__KernelDefinition.html#gace85f77536f263f76d041d57b6f781c9">Bspline03</a>(yarg - <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                    coeff = <a class="code" href="group__KernelDefinition.html#ga7735a4dada77ad119562083b16b65523">Bspline04</a>(xarg - l) * <a class="code" href="group__KernelDefinition.html#ga7735a4dada77ad119562083b16b65523">Bspline04</a>(yarg - <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                    coeff = <a class="code" href="group__KernelDefinition.html#gaf4b9554342b12659737e4ed7130eaa7b">Bspline05</a>(xarg - l) * <a class="code" href="group__KernelDefinition.html#gaf4b9554342b12659737e4ed7130eaa7b">Bspline05</a>(yarg - <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                    coeff = <a class="code" href="group__KernelDefinition.html#ga2ea30a01ce9a0bea67dc6a116be4d90f">Bspline06</a>(xarg - l) * <a class="code" href="group__KernelDefinition.html#ga2ea30a01ce9a0bea67dc6a116be4d90f">Bspline06</a>(yarg - <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                    coeff = <a class="code" href="group__KernelDefinition.html#gac15ac191df9734bd90df659e98284f41">Bspline07</a>(xarg - l) * <a class="code" href="group__KernelDefinition.html#gac15ac191df9734bd90df659e98284f41">Bspline07</a>(yarg - <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                    coeff = <a class="code" href="group__KernelDefinition.html#ga38406ca5c4cd9600f103dbaa34171390">Bspline08</a>(xarg - l) * <a class="code" href="group__KernelDefinition.html#ga38406ca5c4cd9600f103dbaa34171390">Bspline08</a>(yarg - <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                <span class="keywordflow">case</span> 9:</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                    coeff = <a class="code" href="group__KernelDefinition.html#ga32d62f1a4548fa42a191f36e14116a5a">Bspline09</a>(xarg - l) * <a class="code" href="group__KernelDefinition.html#ga32d62f1a4548fa42a191f36e14116a5a">Bspline09</a>(yarg - <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                }</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                A(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, (<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> - m0)*<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(result.<a class="code" href="classBspline__model.html#a9a9c5b23a5dd2e6f6bc48edbebc3cfc8">c_ml</a>) + l - l0) = coeff;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            }</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> = (A.transpose() * A).inv() * (A.transpose() * B);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> = m0; <a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> &lt;= mF; ++<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>)</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = l0; l &lt;= lF; ++l)</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            result.<a class="code" href="classBspline__model.html#a9a9c5b23a5dd2e6f6bc48edbebc3cfc8">c_ml</a>(<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a>, l) = <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>((<a class="code" href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a> - m0) * <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(result.<a class="code" href="classBspline__model.html#a9a9c5b23a5dd2e6f6bc48edbebc3cfc8">c_ml</a>) + l - l0);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;}</div><div class="ttc" id="group__KernelDefinition_html_gaf4b9554342b12659737e4ed7130eaa7b"><div class="ttname"><a href="group__KernelDefinition.html#gaf4b9554342b12659737e4ed7130eaa7b">Bspline05</a></div><div class="ttdeci">double Bspline05(double Argument)</div></div>
<div class="ttc" id="classBspline__model_html_a6dc02a3ef9b7e62ff4f09b2807d868bb"><div class="ttname"><a href="classBspline__model.html#a6dc02a3ef9b7e62ff4f09b2807d868bb">Bspline_model::y0</a></div><div class="ttdeci">double y0</div><div class="ttdoc">y0 </div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00288">geometry.h:288</a></div></div>
<div class="ttc" id="classBspline__model_html_a38d62bdcede23ea7949548530ef8da26"><div class="ttname"><a href="classBspline__model.html#a38d62bdcede23ea7949548530ef8da26">Bspline_model::lF</a></div><div class="ttdeci">int lF</div><div class="ttdoc">lF; </div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00279">geometry.h:279</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a2b83edee7677c7a2b0a4e5ac99baa586"><div class="ttname"><a href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a></div><div class="ttdeci">doublereal * w</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02494">numerical_recipes.cpp:2494</a></div></div>
<div class="ttc" id="classBspline__model_html_ae2fe9367828446b060636ba894b7d3ce"><div class="ttname"><a href="classBspline__model.html#ae2fe9367828446b060636ba894b7d3ce">Bspline_model::l0</a></div><div class="ttdeci">int l0</div><div class="ttdoc">l0 </div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00277">geometry.h:277</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classBspline__model_html_abb905807490cb4e6b8acffb77d537b86"><div class="ttname"><a href="classBspline__model.html#abb905807490cb4e6b8acffb77d537b86">Bspline_model::x0</a></div><div class="ttdeci">double x0</div><div class="ttdoc">x0 </div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00286">geometry.h:286</a></div></div>
<div class="ttc" id="group__KernelDefinition_html_ga7735a4dada77ad119562083b16b65523"><div class="ttname"><a href="group__KernelDefinition.html#ga7735a4dada77ad119562083b16b65523">Bspline04</a></div><div class="ttdeci">double Bspline04(double Argument)</div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a0d9521fd31b2e16413d1b78836953d53"><div class="ttname"><a href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a></div><div class="ttdeci">#define y0</div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="classBspline__model_html_a163c39fbfa28a8c60ccb278d809b9dd1"><div class="ttname"><a href="classBspline__model.html#a163c39fbfa28a8c60ccb278d809b9dd1">Bspline_model::SplineDegree</a></div><div class="ttdeci">int SplineDegree</div><div class="ttdoc">Order of the Bspline. </div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00291">geometry.h:291</a></div></div>
<div class="ttc" id="group__KernelDefinition_html_gace85f77536f263f76d041d57b6f781c9"><div class="ttname"><a href="group__KernelDefinition.html#gace85f77536f263f76d041d57b6f781c9">Bspline03</a></div><div class="ttdeci">double Bspline03(double Argument)</div></div>
<div class="ttc" id="group__KernelDefinition_html_gac15ac191df9734bd90df659e98284f41"><div class="ttname"><a href="group__KernelDefinition.html#gac15ac191df9734bd90df659e98284f41">Bspline07</a></div><div class="ttdeci">double Bspline07(double Argument)</div></div>
<div class="ttc" id="group__KernelDefinition_html_ga38406ca5c4cd9600f103dbaa34171390"><div class="ttname"><a href="group__KernelDefinition.html#ga38406ca5c4cd9600f103dbaa34171390">Bspline08</a></div><div class="ttdeci">double Bspline08(double Argument)</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a438c75002165fed58970c95d67a268c1"><div class="ttname"><a href="image__find__center_8cpp.html#a438c75002165fed58970c95d67a268c1">m</a></div><div class="ttdeci">int m</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="group__KernelDefinition_html_gaa92a7fe60e1322678e95722660710dde"><div class="ttname"><a href="group__KernelDefinition.html#gaa92a7fe60e1322678e95722660710dde">Bspline02</a></div><div class="ttdeci">double Bspline02(double Argument)</div></div>
<div class="ttc" id="classBspline__model_html_a9a9c5b23a5dd2e6f6bc48edbebc3cfc8"><div class="ttname"><a href="classBspline__model.html#a9a9c5b23a5dd2e6f6bc48edbebc3cfc8">Bspline_model::c_ml</a></div><div class="ttdeci">MultidimArray&lt; double &gt; c_ml</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00302">geometry.h:302</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__KernelDefinition_html_ga32d62f1a4548fa42a191f36e14116a5a"><div class="ttname"><a href="group__KernelDefinition.html#ga32d62f1a4548fa42a191f36e14116a5a">Bspline09</a></div><div class="ttdeci">double Bspline09(double Argument)</div></div>
<div class="ttc" id="classBspline__model_html_a6d4e29d0f9665703b48cd9b915524b34"><div class="ttname"><a href="classBspline__model.html#a6d4e29d0f9665703b48cd9b915524b34">Bspline_model::mF</a></div><div class="ttdeci">int mF</div><div class="ttdoc">mF; </div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00283">geometry.h:283</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="group__KernelDefinition_html_ga2ea30a01ce9a0bea67dc6a116be4d90f"><div class="ttname"><a href="group__KernelDefinition.html#ga2ea30a01ce9a0bea67dc6a116be4d90f">Bspline06</a></div><div class="ttdeci">double Bspline06(double Argument)</div></div>
<div class="ttc" id="classBspline__model_html_a0558f6253836c2e1c066e6d03881ccea"><div class="ttname"><a href="classBspline__model.html#a0558f6253836c2e1c066e6d03881ccea">Bspline_model::h_y</a></div><div class="ttdeci">double h_y</div><div class="ttdoc">Scale Y. </div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00296">geometry.h:296</a></div></div>
<div class="ttc" id="classBspline__model_html_a87c02c3fcc3b3eb92496736f26773e21"><div class="ttname"><a href="classBspline__model.html#a87c02c3fcc3b3eb92496736f26773e21">Bspline_model::m0</a></div><div class="ttdeci">int m0</div><div class="ttdoc">m0 </div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00281">geometry.h:281</a></div></div>
<div class="ttc" id="classBspline__model_html_a1fc6ba1e579156189043a08b257ef12d"><div class="ttname"><a href="classBspline__model.html#a1fc6ba1e579156189043a08b257ef12d">Bspline_model::h_x</a></div><div class="ttdeci">double h_x</div><div class="ttdoc">Scale X. </div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00294">geometry.h:294</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaae41a5015cbfd6ab97119d08e572cd23"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void computeCircleAroundE </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angCircle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>outputEulerAngles</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute circle around <a class="el" href="classEuler.html">Euler</a> matrix</p>
<p>Given an input <a class="el" href="classEuler.html">Euler</a> matrix, this function returns a set of <a class="el" href="classEuler.html">Euler</a> angles such that they sample a circle around the original projection direction (a sample every angStep). The projection directions in the circle are separated by angCircle.</p>
<p>The output is in outputEulerAngles whose structure is (newrot1,newtilt1,newpsi1,newrot2,newtilt2,newpsi2,...) </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l01083">1083</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;{</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    outputEulerAngles.clear();</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="comment">// Get the projection direction and a perpendicular direction</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> projectionDirection, perpendicular;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    E.<a class="code" href="classMatrix2D.html#af11b96d9f1adce57692855f081f14760">getRow</a>(1,perpendicular);</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    E.<a class="code" href="classMatrix2D.html#af11b96d9f1adce57692855f081f14760">getRow</a>(2,projectionDirection);</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> newEt;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    newEt = E.<a class="code" href="classMatrix2D.html#a350918f3b68e68e5a358bf75fa1b283f">transpose</a>();</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> rotStep, <a class="code" href="spherical__harmonics_8h.html#a155dcdb9d4ce202cc937816a560c27ec">sampling</a>;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a>(angCircle,perpendicular,rotStep,<span class="keyword">false</span>);</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a>(angStep,projectionDirection,sampling,<span class="keyword">false</span>);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="comment">// Now rotate</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    newEt = rotStep*newEt;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">double</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 360; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> += angStep)</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    {</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        newEt=sampling*newEt;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <span class="comment">// Normalize</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>=0; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>&lt;3; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>++)</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        {</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> aux;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            newEt.getCol(<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>,aux);</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            aux/=aux.<a class="code" href="classMatrix1D.html#a9ee6afb32720ca26450038def994af96">module</a>();</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            newEt.setCol(<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>,aux);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        }</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> newE=newEt.<a class="code" href="classMatrix2D.html#a350918f3b68e68e5a358bf75fa1b283f">transpose</a>();</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <span class="keywordtype">double</span> newrot, newtilt, newpsi;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <a class="code" href="group__Geometry.html#gaa0889ad000c2166f766c927fc7c2f58c">Euler_matrix2angles</a>(newE,newrot,newtilt,newpsi);</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        outputEulerAngles.push_back(newrot);</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        outputEulerAngles.push_back(newtilt);</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        outputEulerAngles.push_back(newpsi);</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    }</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="classMatrix2D_html_a350918f3b68e68e5a358bf75fa1b283f"><div class="ttname"><a href="classMatrix2D.html#a350918f3b68e68e5a358bf75fa1b283f">Matrix2D::transpose</a></div><div class="ttdeci">Matrix2D&lt; T &gt; transpose() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01630">matrix2d.h:1630</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gade7a7cd894f08efccc7d6b6410bbf891"><div class="ttname"><a href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a></div><div class="ttdeci">void rotation3DMatrix(double ang, char axis, Matrix2D&lt; double &gt; &amp;result, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00277">transformations.cpp:277</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="spherical__harmonics_8h_html_a155dcdb9d4ce202cc937816a560c27ec"><div class="ttname"><a href="spherical__harmonics_8h.html#a155dcdb9d4ce202cc937816a560c27ec">sampling</a></div><div class="ttdeci">#define sampling</div><div class="ttdef"><b>Definition:</b> <a href="spherical__harmonics_8h_source.html#l00036">spherical_harmonics.h:36</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classMatrix1D_html_a9ee6afb32720ca26450038def994af96"><div class="ttname"><a href="classMatrix1D.html#a9ee6afb32720ca26450038def994af96">Matrix1D::module</a></div><div class="ttdeci">double module() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01578">matrix1d.h:1578</a></div></div>
<div class="ttc" id="group__Geometry_html_gaa0889ad000c2166f766c927fc7c2f58c"><div class="ttname"><a href="group__Geometry.html#gaa0889ad000c2166f766c927fc7c2f58c">Euler_matrix2angles</a></div><div class="ttdeci">void Euler_matrix2angles(const Matrix2D&lt; double &gt; &amp;A, double &amp;alpha, double &amp;beta, double &amp;gamma, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00836">geometry.cpp:836</a></div></div>
<div class="ttc" id="classMatrix2D_html_af11b96d9f1adce57692855f081f14760"><div class="ttname"><a href="classMatrix2D.html#af11b96d9f1adce57692855f081f14760">Matrix2D::getRow</a></div><div class="ttdeci">void getRow(size_t i, Matrix1D&lt; T &gt; &amp;v) const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01396">matrix2d.h:1396</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga3a2dfdbceca9c87ab5be4fbaa5cb78d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void def_affinity </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>u1x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>u1y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>u2x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>u2y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>u3x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>u3y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t1x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t1y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t2x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t2y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t3x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t3y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>invW</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Affine transformation </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00438">438</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;{</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordtype">double</span> den = (u1x*u2y - u1y*u2x - u1x*u3y + u1y*u3x + u2x*u3y - u2y*u3x);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;den&quot; &lt;&lt;k &lt;&lt; std::endl;</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    invW.<a class="code" href="classMatrix2D.html#a35921c37b27282bac3b3868cce8feb26">initZeros</a>(6,6);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(invW,0,0) = <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(invW,2,3) = (u2y - u3y)/den;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(invW,0,1) = <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(invW,2,4) = -(u1y - u3y)/den;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(invW,0,2) = <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(invW,2,5) = (u1y - u2y)/den;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(invW,1,0) = <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(invW,3,3) = -(u2x - u3x)/den;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(invW,1,1) = <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(invW,3,4) = (u1x - u3x)/den;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(invW,1,2) = <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(invW,3,5) = -(u1x - u2x)/den;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(invW,4,0) = <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(invW,5,3) = (u2x*u3y - u2y*u3x)/den;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(invW,4,1) = <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(invW,5,4) = -(u1x*u3y - u1y*u3x)/den;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(invW,4,2) = <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(invW,5,5) = (u1x*u2y - u1y*u2x)/den;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> t_vec;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    t_vec.<a class="code" href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">initZeros</a>(6);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(t_vec,0) = t1x;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(t_vec,1) = t2x;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(t_vec,2) = t3x;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(t_vec,3) = t1y;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(t_vec,4) = t2y;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(t_vec,5) = t3y;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordtype">double</span> dettt = invW.<a class="code" href="classMatrix2D.html#a1bbe8b120e3f27649ad1047a5cd0dd7c">det</a>();</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;determinant&quot; &lt;&lt; dettt &lt;&lt; std::endl;</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">//Matrix1D&lt;double&gt; sol = invW*t_vec;</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;sol = &quot; &lt;&lt; sol &lt;&lt; std::endl;</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">if</span> (fabs(dettt) &lt;  <a class="code" href="angular__continuous__assign_8cpp.html#ab701824136346377b44fc3adb8050b29">DBL_EPSILON</a> )</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    {</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="comment">//std::cout &lt;&lt; &quot;I&#39;m in if&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        A.<a class="code" href="classMatrix2D.html#a35921c37b27282bac3b3868cce8feb26">initZeros</a>(2,2);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        T.<a class="code" href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">initZeros</a>(2);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(T,0) = <a class="code" href="angular__continuous__assign_8cpp.html#af78670ee54c1203d613f8fb0e022d214">DBL_MAX</a> ;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(T,1) = <a class="code" href="angular__continuous__assign_8cpp.html#af78670ee54c1203d613f8fb0e022d214">DBL_MAX</a> ;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    }</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    {</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <span class="comment">//std::cout &lt;&lt; &quot;I&#39;m in else&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> sol = invW*t_vec;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="comment">//std::cout &lt;&lt; &quot;sol = &quot; &lt;&lt; sol &lt;&lt; std::endl;</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        A.<a class="code" href="classMatrix2D.html#a35921c37b27282bac3b3868cce8feb26">initZeros</a>(2,2);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        T.<a class="code" href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">initZeros</a>(2);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="comment">//std::cout &lt;&lt; A &lt;&lt; std::endl;</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A,0,0) = <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(sol,0);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A,0,1) = <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(sol,1);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A,1,0) = <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(sol,2);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A,1,1) = <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(sol,3);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(T,0) = <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(sol,4);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(T,1) = <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(sol,5);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="comment">//std::cout &lt;&lt; &quot;A ==&quot; &lt;&lt; sol &lt;&lt; std::endl;</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;}</div><div class="ttc" id="angular__continuous__assign_8cpp_html_ab701824136346377b44fc3adb8050b29"><div class="ttname"><a href="angular__continuous__assign_8cpp.html#ab701824136346377b44fc3adb8050b29">DBL_EPSILON</a></div><div class="ttdeci">#define DBL_EPSILON</div></div>
<div class="ttc" id="group__Vectors_html_ga58173d9430e8e68017e3698f30382d5d"><div class="ttname"><a href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a></div><div class="ttdeci">#define VEC_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00248">matrix1d.h:248</a></div></div>
<div class="ttc" id="group__Matrices_html_gab40746be05d4bbf352787018922ecc2e"><div class="ttname"><a href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a></div><div class="ttdeci">#define MAT_ELEM(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00117">matrix2d.h:117</a></div></div>
<div class="ttc" id="classMatrix1D_html_a203e2128d65fd2d51dc764f5e7c52a63"><div class="ttname"><a href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">Matrix1D::initZeros</a></div><div class="ttdeci">void initZeros()</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00646">matrix1d.h:646</a></div></div>
<div class="ttc" id="angular__continuous__assign_8cpp_html_af78670ee54c1203d613f8fb0e022d214"><div class="ttname"><a href="angular__continuous__assign_8cpp.html#af78670ee54c1203d613f8fb0e022d214">DBL_MAX</a></div><div class="ttdeci">#define DBL_MAX</div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classMatrix2D_html_a35921c37b27282bac3b3868cce8feb26"><div class="ttname"><a href="classMatrix2D.html#a35921c37b27282bac3b3868cce8feb26">Matrix2D::initZeros</a></div><div class="ttdeci">void initZeros()</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00779">matrix2d.h:779</a></div></div>
<div class="ttc" id="classMatrix2D_html_a1bbe8b120e3f27649ad1047a5cd0dd7c"><div class="ttname"><a href="classMatrix2D.html#a1bbe8b120e3f27649ad1047a5cd0dd7c">Matrix2D::det</a></div><div class="ttdeci">T det() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01560">matrix2d.h:1560</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaf67a2d233e3fbf038d111a91197fa759"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void Euler_angles2matrix </td>
          <td>(</td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>homogeneous</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classEuler.html">Euler</a> angles &ndash;&gt; <a class="el" href="classEuler.html">Euler</a> matrix.</p>
<p>This function returns the transformation matrix associated to the 3 given <a class="el" href="classEuler.html">Euler</a> angles (in degrees).</p>
<p>As an implementation note you might like to know that this function calls always to <a class="el" href="classMatrix2D.html#aeedb221b3c316a93de2826d56302bf98">Matrix2D::resize</a></p>
<p>See <a href="http://xmipp.cnb.csic.es/twiki/bin/view/Xmipp/EulerAngles">http://xmipp.cnb.csic.es/twiki/bin/view/Xmipp/EulerAngles</a> for a description of the <a class="el" href="classEuler.html">Euler</a> angles. </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00621">621</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;{</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    static_assert(std::is_floating_point&lt;T&gt;::value, <span class="stringliteral">&quot;Only float and double are allowed as template parameters&quot;</span>);</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">if</span> (homogeneous)</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        A.<a class="code" href="classMatrix2D.html#a35921c37b27282bac3b3868cce8feb26">initZeros</a>(4,4);</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A,3,3)=1;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    }</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a>(A) != 3 || <a class="code" href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a>(A) != 3)</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            A.<a class="code" href="classMatrix2D.html#a6928f78d5ccff2c21a26811702fa4d82">resizeNoCopy</a>(3, 3);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    T ca = std::cos(<a class="code" href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a>(alpha));</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    T sa = std::sin(<a class="code" href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a>(alpha));</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    T cb = std::cos(<a class="code" href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a>(<a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>));</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    T sb = std::sin(<a class="code" href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a>(<a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>));</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    T cg = std::cos(<a class="code" href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a>(<a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a>));</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    T sg = std::sin(<a class="code" href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a>(<a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a>));</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    T cc = cb * ca;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    T <a class="code" href="numerical__recipes_8cpp.html#a367915de7b4fd0fbcf1c4b79e2c7a02d">cs</a> = cb * sa;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    T sc = sb * ca;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    T ss = sb * sa;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A, 0, 0) =  cg * cc - sg * sa;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A, 0, 1) =  cg * cs + sg * ca;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A, 0, 2) = -cg * sb;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A, 1, 0) = -sg * cc - cg * sa;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A, 1, 1) = -sg * cs + cg * ca;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A, 1, 2) = sg * sb;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A, 2, 0) =  sc;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A, 2, 1) =  ss;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(A, 2, 2) = cb;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;}</div><div class="ttc" id="group__Matrices_html_ga43e28f6079b3652588d5b76ff199ff1e"><div class="ttname"><a href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a></div><div class="ttdeci">#define MAT_YSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00125">matrix2d.h:125</a></div></div>
<div class="ttc" id="group__Macros_html_gadec1e6bbd34c5cf8765a457da4876c91"><div class="ttname"><a href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a></div><div class="ttdeci">#define DEG2RAD(d)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00312">xmipp_macros.h:312</a></div></div>
<div class="ttc" id="namespacealglib_html_a038c39f3bfe0dff667a2cb6bebfed764"><div class="ttname"><a href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">alglib::beta</a></div><div class="ttdeci">double beta(const double a, const double b)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l00962">specialfunctions.cpp:962</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_acf097d43154f3f002dbb9692ce4c55f7"><div class="ttname"><a href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a></div><div class="ttdeci">double * gamma</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07616">numerical_recipes.cpp:7616</a></div></div>
<div class="ttc" id="classMatrix2D_html_a6928f78d5ccff2c21a26811702fa4d82"><div class="ttname"><a href="classMatrix2D.html#a6928f78d5ccff2c21a26811702fa4d82">Matrix2D::resizeNoCopy</a></div><div class="ttdeci">void resizeNoCopy(int Ydim, int Xdim)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00664">matrix2d.h:664</a></div></div>
<div class="ttc" id="group__Matrices_html_gab40746be05d4bbf352787018922ecc2e"><div class="ttname"><a href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a></div><div class="ttdeci">#define MAT_ELEM(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00117">matrix2d.h:117</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a367915de7b4fd0fbcf1c4b79e2c7a02d"><div class="ttname"><a href="numerical__recipes_8cpp.html#a367915de7b4fd0fbcf1c4b79e2c7a02d">cs</a></div><div class="ttdeci">struct _constraint * cs</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04653">numerical_recipes.cpp:4653</a></div></div>
<div class="ttc" id="group__Matrices_html_gacd5c6ac63f21fdbbd4343a9caf1ee9c6"><div class="ttname"><a href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a></div><div class="ttdeci">#define MAT_XSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00121">matrix2d.h:121</a></div></div>
<div class="ttc" id="classMatrix2D_html_a35921c37b27282bac3b3868cce8feb26"><div class="ttname"><a href="classMatrix2D.html#a35921c37b27282bac3b3868cce8feb26">Matrix2D::initZeros</a></div><div class="ttdeci">void initZeros()</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00779">matrix2d.h:779</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gadaf2fbd3996fb68c98a60633c1a8db68"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Euler_Angles_after_compresion </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>new_rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>new_tilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>new_psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>D</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Angles after compresion</p>
<p>Let be two volumes f and g related by g(x,y,z) = f(D(x,y,z)) (where D is a lineal transformation) then the projection direction parallel to the vector w in f is going to be related with the projection direction parallel to the vector w_prime in g. Given the w <a class="el" href="classEuler.html">Euler</a> angles this routine provide the w_prime angles </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00952">952</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;{</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>(3);</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> new_w(3);</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> D_1(3, 3);</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="comment">//if D has not inverse we are not in business</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keywordflow">try</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    {</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        D_1 = D.<a class="code" href="classMatrix2D.html#add8d2052c53fcf6689908614f67b9ee6">inv</a>();</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    }</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keywordflow">catch</span> (<a class="code" href="classXmippError.html">XmippError</a> &amp;XE)</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    {</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        std::cout &lt;&lt; XE;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        exit(1);</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    }</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <a class="code" href="group__Geometry.html#gac0a39b9536b704ecb1c9e44436796b2b">Euler_direction</a>(rot, tilt, <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>, <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>);</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="keywordflow">if</span> (fabs(<a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>(2)) &gt; 0.999847695)<span class="comment">/*cos one degree */</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    {</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <a class="code" href="group__Geometry.html#gac0a39b9536b704ecb1c9e44436796b2b">Euler_direction</a>(rot, 10., <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>, <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>);</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        new_w = (<a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a>)(D_1 * <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>) / ((D_1 * <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>).module());</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <a class="code" href="group__Geometry.html#gaac7ef13b5115d1ba4eee95784243cd9c">Euler_direction2angles</a>(new_w, new_rot, new_tilt, new_psi);</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <a class="code" href="group__Geometry.html#gac0a39b9536b704ecb1c9e44436796b2b">Euler_direction</a>(rot, tilt, <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>, w);</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        new_w = (<a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a>)((D_1 * w) / ((D_1 * <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>).module()));</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        new_tilt = <a class="code" href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a>(new_tilt) * fabs(<a class="code" href="group__Macros.html#ga7e7a2d2e3911f497562fd7308abbf121">ACOSD</a>(new_w(2)));</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        new_psi = <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <span class="comment">// so, for small tilt the value of the rot is not realiable</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="comment">// doubleo overcome this problem I first calculate the rot for</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <span class="comment">// any arbitrary large tilt angle and the right rotation</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        <span class="comment">// and then I calculate the new tilt.</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        <span class="comment">// Please notice that the new_rotation is not a funcion of</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <span class="comment">// the old tilt angle so I can use any arbitrary tilt angle</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    }</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    {</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        new_w = (<a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a>)(D_1 * w) / ((D_1 * <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>).module());</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        <a class="code" href="group__Geometry.html#gaac7ef13b5115d1ba4eee95784243cd9c">Euler_direction2angles</a>(new_w, new_rot, new_tilt, new_psi);</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        new_psi = <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    }</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;}</div><div class="ttc" id="classMatrix2D_html_add8d2052c53fcf6689908614f67b9ee6"><div class="ttname"><a href="classMatrix2D.html#add8d2052c53fcf6689908614f67b9ee6">Matrix2D::inv</a></div><div class="ttdeci">void inv(Matrix2D&lt; T &gt; &amp;result) const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01648">matrix2d.h:1648</a></div></div>
<div class="ttc" id="classXmippError_html"><div class="ttname"><a href="classXmippError.html">XmippError</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00248">xmipp_error.h:248</a></div></div>
<div class="ttc" id="group__Geometry_html_gac0a39b9536b704ecb1c9e44436796b2b"><div class="ttname"><a href="group__Geometry.html#gac0a39b9536b704ecb1c9e44436796b2b">Euler_direction</a></div><div class="ttdeci">void Euler_direction(double alpha, double beta, double gamma, Matrix1D&lt; double &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00718">geometry.cpp:718</a></div></div>
<div class="ttc" id="group__Geometry_html_gaac7ef13b5115d1ba4eee95784243cd9c"><div class="ttname"><a href="group__Geometry.html#gaac7ef13b5115d1ba4eee95784243cd9c">Euler_direction2angles</a></div><div class="ttdeci">void Euler_direction2angles(Matrix1D&lt; double &gt; &amp;v0, double &amp;alpha, double &amp;beta, double &amp;gamma)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00743">geometry.cpp:743</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a2b83edee7677c7a2b0a4e5ac99baa586"><div class="ttname"><a href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a></div><div class="ttdeci">doublereal * w</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02494">numerical_recipes.cpp:2494</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Macros_html_ga7e7a2d2e3911f497562fd7308abbf121"><div class="ttname"><a href="group__Macros.html#ga7e7a2d2e3911f497562fd7308abbf121">ACOSD</a></div><div class="ttdeci">#define ACOSD(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00338">xmipp_macros.h:338</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="group__Macros_html_ga95ed41486ca0ed53262e4b8934d4afac"><div class="ttname"><a href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a></div><div class="ttdeci">#define SGN(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00155">xmipp_macros.h:155</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga831e69dcc04c1853cffb899072979654"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Euler_anglesZXZ2matrix </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>homogeneous</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classEuler.html">Euler</a> angles &ndash;&gt; <a class="el" href="classEuler.html">Euler</a> matrix.</p>
<p>This function returns the transformation matrix associated to the 3 given <a class="el" href="classEuler.html">Euler</a> angles (in degrees). </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00658">658</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;{</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> RZ1, RX2, RZ3;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a>(<a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>,<span class="charliteral">&#39;Z&#39;</span>,RZ1,homogeneous);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a>(<a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>,<span class="charliteral">&#39;X&#39;</span>,RX2,homogeneous);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a>(<a class="code" href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a>,<span class="charliteral">&#39;Z&#39;</span>,RZ3,homogeneous);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    A=RZ3*RX2*RZ1;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_af72286acf4184005499476fbc853146f"><div class="ttname"><a href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a></div><div class="ttdeci">doublereal * g</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02490">numerical_recipes.cpp:2490</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gade7a7cd894f08efccc7d6b6410bbf891"><div class="ttname"><a href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a></div><div class="ttdeci">void rotation3DMatrix(double ang, char axis, Matrix2D&lt; double &gt; &amp;result, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00277">transformations.cpp:277</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af090b2fbbd2916bfb2e493c5162969d6"><div class="ttname"><a href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a></div><div class="ttdeci">doublereal * b</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af2a333b1670df64a88d3a2f22210d155"><div class="ttname"><a href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a></div><div class="ttdeci">doublereal * a</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga4f0aa261268a10dde4daf1faab390a00"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Euler_another_set </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>newrot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>newtilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>newpsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The same view but differently expressed</p>
<p>As you know a projection view from a point can be expressed with different sets of <a class="el" href="classEuler.html">Euler</a> angles. This function gives you another expression of the <a class="el" href="classEuler.html">Euler</a> angles for this point of view. Exactly the operation performed is:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;newrot = rot + 180;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;newtilt = -tilt;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;newpsi = -180 + psi;</div></div><!-- fragment --><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Euler_another_set(rot, tilt, psi, newrot, newtilt, newpsi);</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l01007">1007</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;{</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    newrot  = rot + 180;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    newtilt = -tilt;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    newpsi  = -180 + <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;}</div><div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga1a37da6506d421d52c9a102eb9732928"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Euler_apply_transf </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>newrot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>newtilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>newpsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply a geometrical transformation</p>
<p>The idea behind this function is the following. 3 <a class="el" href="classEuler.html">Euler</a> angles define a point of view for a projection, but also a coordinate system. You might apply a geometrical transformation to this system, and then compute back what the <a class="el" href="classEuler.html">Euler</a> angles for the new system are. This could be used to "mirror" points of view, rotate them and all the stuff. The transformation matrix must be 3x3 but it must transform R3 vectors into R3 vectors (that is a normal 3D transformation matrix when vector coordinates are not homogeneous) and it will be applied in the sense:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;New Euler matrix = L * Old Euler matrix * R</div></div><!-- fragment --><p>where you know that the <a class="el" href="classEuler.html">Euler</a> matrix rows represent the different system axes. See Euler_angles2matrix for more information about the <a class="el" href="classEuler.html">Euler</a> coordinate system.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Matrix2D&lt; double &gt; R60 = rotation3DMatrix(60, &#39;Z&#39;);</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;R60.resize(3, 3); // Get rid of homogeneous part</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Matrix2D&lt; double &gt; I(3, 3);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;I.initIdentity();</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Euler_apply_transf(I, R60, rot, tilt, psi, newrot, newtilt, newpsi);</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l01043">1043</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;{</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> euler(3, 3), temp;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <a class="code" href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a>(rot, tilt, <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>, euler);</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    temp = L * euler * R;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <a class="code" href="group__Geometry.html#gaa0889ad000c2166f766c927fc7c2f58c">Euler_matrix2angles</a>(temp, newrot, newtilt, newpsi);</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;}</div><div class="ttc" id="group__Geometry_html_gaf67a2d233e3fbf038d111a91197fa759"><div class="ttname"><a href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a></div><div class="ttdeci">void Euler_angles2matrix(T alpha, T beta, T gamma, Matrix2D&lt; T &gt; &amp;A, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00621">geometry.cpp:621</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="group__Geometry_html_gaa0889ad000c2166f766c927fc7c2f58c"><div class="ttname"><a href="group__Geometry.html#gaa0889ad000c2166f766c927fc7c2f58c">Euler_matrix2angles</a></div><div class="ttdeci">void Euler_matrix2angles(const Matrix2D&lt; double &gt; &amp;A, double &amp;alpha, double &amp;beta, double &amp;gamma, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00836">geometry.cpp:836</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gac0a39b9536b704ecb1c9e44436796b2b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Euler_direction </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classEuler.html">Euler</a> direction</p>
<p>This function returns a vector parallel to the projection direction. Resizes v if needed </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00718">718</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;{</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordtype">double</span> ca, sa, cb, sb;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordtype">double</span> sc, ss;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    v.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(3);</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    alpha = <a class="code" href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a>(alpha);</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>  = <a class="code" href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a>(<a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    ca = cos(alpha);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    cb = cos(<a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    sa = sin(alpha);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    sb = sin(<a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>);</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    sc = sb * ca;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    ss = sb * sa;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    v(0) = sc;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    v(1) = ss;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    v(2) = cb;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;}</div><div class="ttc" id="group__Macros_html_gadec1e6bbd34c5cf8765a457da4876c91"><div class="ttname"><a href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a></div><div class="ttdeci">#define DEG2RAD(d)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00312">xmipp_macros.h:312</a></div></div>
<div class="ttc" id="namespacealglib_html_a038c39f3bfe0dff667a2cb6bebfed764"><div class="ttname"><a href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">alglib::beta</a></div><div class="ttdeci">double beta(const double a, const double b)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l00962">specialfunctions.cpp:962</a></div></div>
<div class="ttc" id="classMatrix1D_html_a79a482948ae334cbefaef7c7839cd934"><div class="ttname"><a href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">Matrix1D::resize</a></div><div class="ttdeci">void resize(size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00451">matrix1d.h:451</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaac7ef13b5115d1ba4eee95784243cd9c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Euler_direction2angles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>gamma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classEuler.html">Euler</a> direction2angles</p>
<p>This function returns the 3 <a class="el" href="classEuler.html">Euler</a> angles associated to the direction given by the vector v. The 3rd <a class="el" href="classEuler.html">Euler</a> angle is set always to 0 </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00743">743</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;{</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordtype">double</span> abs_ca, sb, cb;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordtype">double</span> aux_alpha;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordtype">double</span> aux_beta;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="tools_8cpp.html#a42c6b1edc1bd763019f0eb5edce18793">error</a>, newerror;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> v_aux;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> v;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="comment">//if not normalized do it so</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    v.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(3);</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    v = <a class="code" href="numerical__recipes_8cpp.html#a8eb6f9afe59b4924d42d1ea2002148e7">v0</a>;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    v.<a class="code" href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">selfNormalize</a>();</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    v_aux.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(3);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    cb = v(2);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keywordflow">if</span> (fabs((cb)) &gt; 0.999847695)<span class="comment">/*one degree */</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    {</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;\nWARNING: Routine Euler_direction2angles is not reliable\n&quot;</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="stringliteral">&quot;for small tilt angles. Up to 0.001 deg it should be OK\n&quot;</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="stringliteral">&quot;for most applications but you never know&quot;</span>;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    }</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">if</span> (fabs((cb - 1.)) &lt; <a class="code" href="geometry_8h.html#aafe5d2c4dc0edd9840f20e885dcae6ad">FLT_EPSILON</a>)</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    {</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        alpha = 0.;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a> = 0.;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    }</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    {<span class="comment">/*1*/</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        aux_beta = acos(cb); <span class="comment">/* beta between 0 and PI */</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        sb = sin(aux_beta);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        abs_ca = fabs(v(0)) / sb;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        <span class="keywordflow">if</span> (fabs((abs_ca - 1.)) &lt; <a class="code" href="geometry_8h.html#aafe5d2c4dc0edd9840f20e885dcae6ad">FLT_EPSILON</a>)</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            aux_alpha = 0.;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            aux_alpha = acos(abs_ca);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        v_aux(0) = sin(aux_beta) * cos(aux_alpha);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        v_aux(1) = sin(aux_beta) * sin(aux_alpha);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        v_aux(2) = cos(aux_beta);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        error = fabs(<a class="code" href="group__Vectors.html#ga5d2bc77c327154906885f1ebedc8d787">dotProduct</a>(v, v_aux) - 1.);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        alpha = aux_alpha;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a> = aux_beta;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        v_aux(0) = sin(aux_beta) * cos(-1. * aux_alpha);</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        v_aux(1) = sin(aux_beta) * sin(-1. * aux_alpha);</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        v_aux(2) = cos(aux_beta);</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        newerror = fabs(<a class="code" href="group__Vectors.html#ga5d2bc77c327154906885f1ebedc8d787">dotProduct</a>(v, v_aux) - 1.);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <span class="keywordflow">if</span> (error &gt; newerror)</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        {</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            alpha = -1. * aux_alpha;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>  = aux_beta;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            error = newerror;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        }</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        v_aux(0) = sin(-aux_beta) * cos(-1. * aux_alpha);</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        v_aux(1) = sin(-aux_beta) * sin(-1. * aux_alpha);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        v_aux(2) = cos(-aux_beta);</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        newerror = fabs(<a class="code" href="group__Vectors.html#ga5d2bc77c327154906885f1ebedc8d787">dotProduct</a>(v, v_aux) - 1.);</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <span class="keywordflow">if</span> (error &gt; newerror)</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        {</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            alpha = -1. * aux_alpha;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>  = -1. * aux_beta;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            error = newerror;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        }</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        v_aux(0) = sin(-aux_beta) * cos(aux_alpha);</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        v_aux(1) = sin(-aux_beta) * sin(aux_alpha);</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        v_aux(2) = cos(-aux_beta);</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        newerror = fabs(<a class="code" href="group__Vectors.html#ga5d2bc77c327154906885f1ebedc8d787">dotProduct</a>(v, v_aux) - 1.);</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="keywordflow">if</span> (error &gt; newerror)</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        {</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            alpha = aux_alpha;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>  = -1. * aux_beta;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        }</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    }<span class="comment">/*else 1 end*/</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a> = 0.;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>  = <a class="code" href="group__Macros.html#ga18b5ff2c19b69c072069398c7a5520cd">RAD2DEG</a>(<a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>);</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    alpha = <a class="code" href="group__Macros.html#ga18b5ff2c19b69c072069398c7a5520cd">RAD2DEG</a>(alpha);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;}<span class="comment">/*Eulerdirection2angles end*/</span></div><div class="ttc" id="namespacealglib_html_a038c39f3bfe0dff667a2cb6bebfed764"><div class="ttname"><a href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">alglib::beta</a></div><div class="ttdeci">double beta(const double a, const double b)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l00962">specialfunctions.cpp:962</a></div></div>
<div class="ttc" id="classMatrix1D_html_a4afb1b4e8a8132a53b985e5fa7da6e30"><div class="ttname"><a href="classMatrix1D.html#a4afb1b4e8a8132a53b985e5fa7da6e30">Matrix1D::selfNormalize</a></div><div class="ttdeci">void selfNormalize()</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01595">matrix1d.h:1595</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_acf097d43154f3f002dbb9692ce4c55f7"><div class="ttname"><a href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a></div><div class="ttdeci">double * gamma</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07616">numerical_recipes.cpp:7616</a></div></div>
<div class="ttc" id="classMatrix1D_html_a79a482948ae334cbefaef7c7839cd934"><div class="ttname"><a href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">Matrix1D::resize</a></div><div class="ttdeci">void resize(size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00451">matrix1d.h:451</a></div></div>
<div class="ttc" id="geometry_8h_html_aafe5d2c4dc0edd9840f20e885dcae6ad"><div class="ttname"><a href="geometry_8h.html#aafe5d2c4dc0edd9840f20e885dcae6ad">FLT_EPSILON</a></div><div class="ttdeci">#define FLT_EPSILON</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00033">geometry.h:33</a></div></div>
<div class="ttc" id="tools_8cpp_html_a42c6b1edc1bd763019f0eb5edce18793"><div class="ttname"><a href="tools_8cpp.html#a42c6b1edc1bd763019f0eb5edce18793">error</a></div><div class="ttdeci">void error(char *s)</div><div class="ttdef"><b>Definition:</b> <a href="tools_8cpp_source.html#l00107">tools.cpp:107</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_ga5d2bc77c327154906885f1ebedc8d787"><div class="ttname"><a href="group__Vectors.html#ga5d2bc77c327154906885f1ebedc8d787">dotProduct</a></div><div class="ttdeci">T dotProduct(const Matrix1D&lt; T &gt; &amp;v1, const Matrix1D&lt; T &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01817">matrix1d.h:1817</a></div></div>
<div class="ttc" id="group__Macros_html_ga18b5ff2c19b69c072069398c7a5520cd"><div class="ttname"><a href="group__Macros.html#ga18b5ff2c19b69c072069398c7a5520cd">RAD2DEG</a></div><div class="ttdeci">#define RAD2DEG(r)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00320">xmipp_macros.h:320</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a8eb6f9afe59b4924d42d1ea2002148e7"><div class="ttname"><a href="numerical__recipes_8cpp.html#a8eb6f9afe59b4924d42d1ea2002148e7">v0</a></div><div class="ttdeci">double v0</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l06229">numerical_recipes.cpp:6229</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga9d70fcf75a8e3278bee887e0ef47c3d6"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">T Euler_distanceBetweenAngleSets </td>
          <td>(</td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>tilt1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>psi1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>tilt2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>psi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>only_projdir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Average distance between two angle sets. If the only_projdir is set, then only the projection direction is considered. </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00678">678</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;{</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    static_assert(std::is_floating_point&lt;T&gt;::value, <span class="stringliteral">&quot;Only float and double are allowed as template parameters&quot;</span>);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;T&gt;</a> E1, E2;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <a class="code" href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a>(rot1, tilt1, psi1, E1, <span class="keyword">false</span>);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__Geometry.html#gaee274cbf4227b0a40a0192437d0ce258">Euler_distanceBetweenAngleSets_fast</a>(E1,rot2,tilt2,psi2,only_projdir,E2);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;}</div><div class="ttc" id="group__Geometry_html_gaf67a2d233e3fbf038d111a91197fa759"><div class="ttname"><a href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a></div><div class="ttdeci">void Euler_angles2matrix(T alpha, T beta, T gamma, Matrix2D&lt; T &gt; &amp;A, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00621">geometry.cpp:621</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D</a></div><div class="ttdef"><b>Definition:</b> <a href="numerical__tools_8h_source.html#l00037">numerical_tools.h:37</a></div></div>
<div class="ttc" id="group__Geometry_html_gaee274cbf4227b0a40a0192437d0ce258"><div class="ttname"><a href="group__Geometry.html#gaee274cbf4227b0a40a0192437d0ce258">Euler_distanceBetweenAngleSets_fast</a></div><div class="ttdeci">T Euler_distanceBetweenAngleSets_fast(const Matrix2D&lt; T &gt; &amp;E1, T rot2, T tilt2, T psi2, bool only_projdir, Matrix2D&lt; T &gt; &amp;E2)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00690">geometry.cpp:690</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaee274cbf4227b0a40a0192437d0ce258"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">T Euler_distanceBetweenAngleSets_fast </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>E1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>tilt2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>psi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>only_projdir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>E2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Average distance between two angle sets. E1 must contain the <a class="el" href="classEuler.html">Euler</a> matrix corresponding to set1, E2 is used as an auxiliary variable for storing the second <a class="el" href="classEuler.html">Euler</a> matrix. </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00690">690</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;{</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    static_assert(std::is_floating_point&lt;T&gt;::value, <span class="stringliteral">&quot;Only float and double are allowed as template parameters&quot;</span>);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <a class="code" href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a>(rot2, tilt2, psi2, E2, <span class="keyword">false</span>);</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    T aux=<a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(E1,2,0)*<a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(E2,2,0)+</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;               <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(E1,2,1)*<a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(E2,2,1)+</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;               <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(E1,2,2)*<a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(E2,2,2);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    T axes_dist=std::acos(<a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(aux, -1, 1));</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keywordflow">if</span> (!only_projdir)</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    {</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 2; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        {</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            T aux=<a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(E1,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,0)*<a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(E2,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,0)+</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                       <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(E1,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,1)*<a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(E2,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,1)+</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                       <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(E1,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,2)*<a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(E2,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,2);</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            T dist=acos(<a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(aux, -1, 1));</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            axes_dist += dist;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        }</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        axes_dist /= 3.0;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    }</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__Macros.html#ga18b5ff2c19b69c072069398c7a5520cd">RAD2DEG</a>(axes_dist);</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;}</div><div class="ttc" id="group__Geometry_html_gaf67a2d233e3fbf038d111a91197fa759"><div class="ttname"><a href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a></div><div class="ttdeci">void Euler_angles2matrix(T alpha, T beta, T gamma, Matrix2D&lt; T &gt; &amp;A, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00621">geometry.cpp:621</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Macros_html_gad4d08cca0a39849cc247072eaebe7726"><div class="ttname"><a href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a></div><div class="ttdeci">#define CLIP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00260">xmipp_macros.h:260</a></div></div>
<div class="ttc" id="group__Matrices_html_gab40746be05d4bbf352787018922ecc2e"><div class="ttname"><a href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a></div><div class="ttdeci">#define MAT_ELEM(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00117">matrix2d.h:117</a></div></div>
<div class="ttc" id="group__Macros_html_ga18b5ff2c19b69c072069398c7a5520cd"><div class="ttname"><a href="group__Macros.html#ga18b5ff2c19b69c072069398c7a5520cd">RAD2DEG</a></div><div class="ttdeci">#define RAD2DEG(r)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00320">xmipp_macros.h:320</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga0de882a451c91a7a8580614fcc57c407"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Euler_distanceBetweenMatrices </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>E1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>E2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Distance between two <a class="el" href="classEuler.html">Euler</a> matrices.</p>
<p>The distance is defined as 1/3*(X1.X2 + Y1.Y2 + Z1.Z2) </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00668">668</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;{</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordtype">double</span> retval=0;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <a class="code" href="group__Matrices.html#ga80aee91a3508fa5d1df6fc0ee3693b06">FOR_ALL_ELEMENTS_IN_MATRIX2D</a>(E1)</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    retval+=<a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(E1,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)*<a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(E2,i,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a5ea9a6a7bd724d30070df9316ccc8199">return</a> retval/3.0;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;}</div><div class="ttc" id="group__Matrices_html_ga80aee91a3508fa5d1df6fc0ee3693b06"><div class="ttname"><a href="group__Matrices.html#ga80aee91a3508fa5d1df6fc0ee3693b06">FOR_ALL_ELEMENTS_IN_MATRIX2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_MATRIX2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00105">matrix2d.h:105</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Matrices_html_gab40746be05d4bbf352787018922ecc2e"><div class="ttname"><a href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a></div><div class="ttdeci">#define MAT_ELEM(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00117">matrix2d.h:117</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a5ea9a6a7bd724d30070df9316ccc8199"><div class="ttname"><a href="numerical__recipes_8cpp.html#a5ea9a6a7bd724d30070df9316ccc8199">return</a></div><div class="ttdeci">return</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02411">numerical_recipes.cpp:2411</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaa0889ad000c2166f766c927fc7c2f58c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Euler_matrix2angles </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>homogeneous</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>"Euler" matrix &ndash;&gt; angles</p>
<p>This function compute a set of <a class="el" href="classEuler.html">Euler</a> angles which result in an "Euler" matrix as the one given. See <a class="el" href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a> to know more about how this matrix is computed and what each row means. The result angles are in degrees. Alpha, beta and gamma are respectively the first, second and third rotation angles. If the input matrix is not 3x3 then an exception is thrown, the function doesn't check that the <a class="el" href="classEuler.html">Euler</a> matrix is truly representing a coordinate system.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Euler_matrix2angles(Euler, alpha, beta, gamma);</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00836">836</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;{</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordtype">double</span> abs_sb, sign_sb;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordflow">if</span> (homogeneous)</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a>(A) != 4 || <a class="code" href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a>(A) != 4)</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a>, <span class="stringliteral">&quot;Euler_matrix2angles: The Euler matrix is not 4x4&quot;</span>);</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a>(A) != 3 || <a class="code" href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a>(A) != 3)</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a>, <span class="stringliteral">&quot;Euler_matrix2angles: The Euler matrix is not 3x3&quot;</span>);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    abs_sb = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(A(0, 2) * A(0, 2) + A(1, 2) * A(1, 2));</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keywordflow">if</span> (abs_sb &gt; 16*<a class="code" href="geometry_8h.html#aafe5d2c4dc0edd9840f20e885dcae6ad">FLT_EPSILON</a>)</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    {</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a> = atan2(A(1, 2), -A(0, 2));</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        alpha = atan2(A(2, 1), A(2, 0));</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(sin(<a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a>)) &lt; <a class="code" href="geometry_8h.html#aafe5d2c4dc0edd9840f20e885dcae6ad">FLT_EPSILON</a>)</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            sign_sb = <a class="code" href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a>(-A(0, 2) / cos(<a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a>));</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <span class="comment">// if (sin(alpha)&lt;FLT_EPSILON) sign_sb=SGN(-A(0,2)/cos(gamma));</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="comment">// else sign_sb=(sin(alpha)&gt;0) ? SGN(A(2,1)):-SGN(A(2,1));</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            sign_sb = (sin(<a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a>) &gt; 0) ? <a class="code" href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a>(A(1, 2)) : -<a class="code" href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a>(A(1, 2));</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>  = atan2(sign_sb * abs_sb, A(2, 2));</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    }</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    {</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a>(A(2, 2)) &gt; 0)</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        {</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            <span class="comment">// Let&#39;s consider the matrix as a rotation around Z</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            alpha = 0;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>  = 0;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            <a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a> = atan2(-A(1, 0), A(0, 0));</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        }</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        {</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            alpha = 0;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>  = <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            <a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a> = atan2(A(1, 0), -A(0, 0));</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        }</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    }</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a> = <a class="code" href="group__Macros.html#ga18b5ff2c19b69c072069398c7a5520cd">RAD2DEG</a>(<a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a>);</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>  = <a class="code" href="group__Macros.html#ga18b5ff2c19b69c072069398c7a5520cd">RAD2DEG</a>(<a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>);</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    alpha = <a class="code" href="group__Macros.html#ga18b5ff2c19b69c072069398c7a5520cd">RAD2DEG</a>(alpha);</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="preprocessor">#ifdef double</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> Ap;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <a class="code" href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a>(alpha, <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>, <a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a>, Ap);</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">if</span> (A != Ap)</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    {</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;---\n&quot;</span>;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Euler_matrix2angles: I have computed angles &quot;</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="stringliteral">&quot; which doesn&#39;t match with the original matrix\n&quot;</span>;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Original matrix\n&quot;</span> &lt;&lt; A;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Computed angles alpha=&quot;</span> &lt;&lt; alpha &lt;&lt; <span class="stringliteral">&quot; beta=&quot;</span> &lt;&lt; <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; gamma=&quot;</span> &lt;&lt; <a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;New matrix\n&quot;</span> &lt;&lt; Ap;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;---\n&quot;</span>;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    }</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;abs_sb &quot;</span> &lt;&lt; abs_sb &lt;&lt; std::endl;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;A(1,2) &quot;</span> &lt;&lt; A(1, 2) &lt;&lt; <span class="stringliteral">&quot; A(0,2) &quot;</span> &lt;&lt; A(0, 2) &lt;&lt; <span class="stringliteral">&quot; gamma &quot;</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    &lt;&lt; <a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;A(2,1) &quot;</span> &lt;&lt; A(2, 1) &lt;&lt; <span class="stringliteral">&quot; A(2,0) &quot;</span> &lt;&lt; A(2, 0) &lt;&lt; <span class="stringliteral">&quot; alpha &quot;</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    &lt;&lt; alpha &lt;&lt; std::endl;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;sign sb &quot;</span> &lt;&lt; sign_sb &lt;&lt; <span class="stringliteral">&quot; A(2,2) &quot;</span> &lt;&lt; A(2, 2)</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; beta &quot;</span> &lt;&lt; <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;}</div><div class="ttc" id="group__Matrices_html_ga43e28f6079b3652588d5b76ff199ff1e"><div class="ttname"><a href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a></div><div class="ttdeci">#define MAT_YSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00125">matrix2d.h:125</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a></div><div class="ttdoc">Problem with matrix size. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00157">xmipp_error.h:157</a></div></div>
<div class="ttc" id="group__Geometry_html_gaf67a2d233e3fbf038d111a91197fa759"><div class="ttname"><a href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a></div><div class="ttdeci">void Euler_angles2matrix(T alpha, T beta, T gamma, Matrix2D&lt; T &gt; &amp;A, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00621">geometry.cpp:621</a></div></div>
<div class="ttc" id="namespacealglib_html_a038c39f3bfe0dff667a2cb6bebfed764"><div class="ttname"><a href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">alglib::beta</a></div><div class="ttdeci">double beta(const double a, const double b)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l00962">specialfunctions.cpp:962</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_acf097d43154f3f002dbb9692ce4c55f7"><div class="ttname"><a href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a></div><div class="ttdeci">double * gamma</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07616">numerical_recipes.cpp:7616</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="geometry_8h_html_aafe5d2c4dc0edd9840f20e885dcae6ad"><div class="ttname"><a href="geometry_8h.html#aafe5d2c4dc0edd9840f20e885dcae6ad">FLT_EPSILON</a></div><div class="ttdeci">#define FLT_EPSILON</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00033">geometry.h:33</a></div></div>
<div class="ttc" id="group__Macros_html_ga18b5ff2c19b69c072069398c7a5520cd"><div class="ttname"><a href="group__Macros.html#ga18b5ff2c19b69c072069398c7a5520cd">RAD2DEG</a></div><div class="ttdeci">#define RAD2DEG(r)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00320">xmipp_macros.h:320</a></div></div>
<div class="ttc" id="group__Matrices_html_gacd5c6ac63f21fdbbd4343a9caf1ee9c6"><div class="ttname"><a href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a></div><div class="ttdeci">#define MAT_XSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00121">matrix2d.h:121</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="group__Macros_html_ga95ed41486ca0ed53262e4b8934d4afac"><div class="ttname"><a href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a></div><div class="ttdeci">#define SGN(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00155">xmipp_macros.h:155</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga793967c9f8c58bdd585a6bdfbe7806a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Euler_mirrorX </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>newrot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>newtilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>newpsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Mirror over X axis</p>
<p>Given a set of <a class="el" href="classEuler.html">Euler</a> angles this function returns a new set which define a mirrored (over X axis) version of the former projection.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;-----&gt; X               Y</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;|                       ^</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;|                       |</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;|               ======&gt; |</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;v                       |</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Y                        -----&gt; X</div></div><!-- fragment --><p>The operation performed is</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;newrot = rot;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;newtilt = tilt + 180;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;newpsi = 180 - psi;</div></div><!-- fragment --><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Euler_mirrorX(rot, tilt, psi, newrot, newtilt, newpsi);</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l01025">1025</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;{</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    newrot  = rot;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    newtilt = tilt + 180;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    newpsi  = 180 - <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;}</div><div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaa8e4765997f2a336493a6b7a843cd7bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Euler_mirrorXY </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>newrot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>newtilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>newpsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Mirror over X and Y axes</p>
<p>Given a set of <a class="el" href="classEuler.html">Euler</a> angles this function returns a new set which define a mirrored (over X and Y axes at the same time) version of the former projection.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;-----&gt; X                       Y</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;|                               ^</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;|                               |</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;|               ======&gt;         |</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;v                               |</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Y                        X&lt;-----</div></div><!-- fragment --><p>The operation performed is</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;newrot = rot;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;newtilt = tilt;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;newpsi = 180 + psi;</div></div><!-- fragment --><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Euler_mirrorX(rot, tilt, psi, newrot, newtilt, newpsi);</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l01034">1034</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;{</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    newrot  = rot;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    newtilt = tilt;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    newpsi  = 180 + <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;}</div><div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga2025665517148ed18cd866241c8aba3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Euler_mirrorY </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>newrot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>newtilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>newpsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Mirror over Y axis</p>
<p>Given a set of <a class="el" href="classEuler.html">Euler</a> angles this function returns a new set which define a mirrored (over Y axis) version of the former projection.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;-----&gt; X               X&lt;------</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;|                              |</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;|                              |</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;|               ======&gt;        |</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;v                              v</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Y                             Y</div></div><!-- fragment --><p>The operation performed is</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;newrot = rot;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;newtilt = tilt + 180;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;newpsi = -psi;</div></div><!-- fragment --><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Euler_mirrorY(rot, tilt, psi, newrot, newtilt, newpsi);</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l01016">1016</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;{</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    newrot  = rot;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    newtilt = tilt + 180;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    newpsi  = -<a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;}</div><div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gadd4cd90d2c7b5471461066cb5042edb8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Euler_rotate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Rotate a volume after 3 <a class="el" href="classEuler.html">Euler</a> angles</p>
<p>Input and output volumes cannot be the same one. </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l01066">1066</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;{</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> R;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <a class="code" href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a>(rot, tilt, <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>, R, <span class="keyword">true</span>);</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a>(1, result, V, R, <a class="code" href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a>, <a class="code" href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a>);</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;}</div><div class="ttc" id="group__Geometry_html_gaf67a2d233e3fbf038d111a91197fa759"><div class="ttname"><a href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a></div><div class="ttdeci">void Euler_angles2matrix(T alpha, T beta, T gamma, Matrix2D&lt; T &gt; &amp;A, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00621">geometry.cpp:621</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga3cc15e5dda7c58b9cacb7eee440d6bdc"><div class="ttname"><a href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a></div><div class="ttdeci">void applyGeometry(int SplineDegree, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V2, const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V1, const Matrix2D&lt; double &gt; &amp;A, bool inv, bool wrap, std::complex&lt; double &gt; outside, MultidimArray&lt; double &gt; *BcoeffsPtr)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00517">transformations.cpp:517</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="transformations_8h_html_a9fbfdbc149e55def0e63127fcb558d13"><div class="ttname"><a href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a></div><div class="ttdeci">#define DONT_WRAP</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00042">transformations.h:42</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="transformations_8h_html_a3a4a05e15fc1cc8a66159304e4c33eb1"><div class="ttname"><a href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a></div><div class="ttdeci">#define IS_NOT_INV</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00041">transformations.h:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gae58ee12942ad4fe5a7d07ab7b988a827"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Euler_rotate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Rotate a volume after 3 <a class="el" href="classEuler.html">Euler</a> angles</p>
<p>Input and output volumes cannot be the same one. </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l01073">1073</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;{</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> R;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  <a class="code" href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a>(rot, tilt, <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>, R, <span class="keyword">true</span>);</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="preprocessor">#define APPLYGEO(type) applyGeometry(1, result, *((MultidimArray&lt;type&gt; *)V.im), R, IS_NOT_INV, DONT_WRAP);</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  <a class="code" href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a>(V.<a class="code" href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">datatype</a>, <a class="code" href="geometry_8cpp.html#acaf9f281bf871227874ac97ea3b2badb">APPLYGEO</a>)</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="preprocessor">#undef APPLYGEO</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;}</div><div class="ttc" id="group__Geometry_html_gaf67a2d233e3fbf038d111a91197fa759"><div class="ttname"><a href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a></div><div class="ttdeci">void Euler_angles2matrix(T alpha, T beta, T gamma, Matrix2D&lt; T &gt; &amp;A, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00621">geometry.cpp:621</a></div></div>
<div class="ttc" id="geometry_8cpp_html_acaf9f281bf871227874ac97ea3b2badb"><div class="ttname"><a href="geometry_8cpp.html#acaf9f281bf871227874ac97ea3b2badb">APPLYGEO</a></div><div class="ttdeci">#define APPLYGEO(type)</div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="classMultidimArrayGeneric_html_a0b74b17fe8d2f77c90b1513bd795c224"><div class="ttname"><a href="classMultidimArrayGeneric.html#a0b74b17fe8d2f77c90b1513bd795c224">MultidimArrayGeneric::datatype</a></div><div class="ttdeci">DataType datatype</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00110">multidim_array_generic.h:110</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="multidim__array__generic_8h_html_ada27bedba7f65b4ad8fca3eb7f5ad65e"><div class="ttname"><a href="multidim__array__generic_8h.html#ada27bedba7f65b4ad8fca3eb7f5ad65e">SWITCHDATATYPE</a></div><div class="ttdeci">#define SWITCHDATATYPE(datatype, OP)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__generic_8h_source.html#l00044">multidim_array_generic.h:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga927b671af65fe7edba793ca05b0c665a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Euler_up_down </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>newrot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>newtilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>newpsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Up-Down projection equivalence</p>
<p>As you know a projection view from a point has got its homologous from its diametrized point in the projection sphere. This function takes a projection defined by its 3 <a class="el" href="classEuler.html">Euler</a> angles and computes an equivalent set of <a class="el" href="classEuler.html">Euler</a> angles from which the view is exactly the same but in the other part of the sphere (if the projection is taken from the bottom then the new projection from the top, and viceversa). The defined projections are exactly the same except for a flip over X axis, ie, an up-down inversion. Exactly the correction performed is:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;newrot = rot;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;newtilt = tilt + 180;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;newpsi = -(180 + psi);</div></div><!-- fragment --><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Euler_up_down(rot, tilt, psi, newrot, newtilt, newpsi);</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00998">998</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;{</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    newrot  = rot;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    newtilt = tilt + 180;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    newpsi  = -(180 + <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>);</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;}</div><div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gabc3d2cc2704dd94b49fb8c2c0fc5a977"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double intersection_unit_cube </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Intersection of a ray with a unit cube</p>
<p>The cube is centered at (0,0,0) and has got unit size length in all directions, i.e., the cube goes from (-0.5, -0.5, -0.5) to (0.5, 0.5, 0.5). The ray is defined by its direction (u) and a passing point (r). See <a class="el" href="classCube.html">Cube</a> to know how you can intersect any ray with any cube. </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l01195">1195</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;{</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keywordtype">double</span> t1=0., t2=0., t;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="keywordtype">int</span> found_t = 0;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="preprocessor">#define ASSIGN_IF_GOOD_ONE \</span></div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="preprocessor">    if (fabs(XX(r)+t*XX(u))-XMIPP_EQUAL_ACCURACY&lt;=0.5 &amp;&amp; \</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="preprocessor">        fabs(YY(r)+t*YY(u))-XMIPP_EQUAL_ACCURACY&lt;=0.5 &amp;&amp; \</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="preprocessor">        fabs(ZZ(r)+t*ZZ(u))-XMIPP_EQUAL_ACCURACY&lt;=0.5) {\</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="preprocessor">        if      (found_t==0) {found_t++; t1=t;} \</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="preprocessor">        else if (found_t==1) {found_t++; t2=t;} \</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="preprocessor">    }</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="comment">// Intersect with x=0.5 and x=-0.5</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(u) != 0)</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    {</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        t = (0.5 - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r)) / <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(u);</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        <a class="code" href="geometry_8cpp.html#a7c7a927b60ebc2f213b35c7da6039918">ASSIGN_IF_GOOD_ONE</a>;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        t = (-0.5 - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r)) / <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(u);</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        <a class="code" href="geometry_8cpp.html#a7c7a927b60ebc2f213b35c7da6039918">ASSIGN_IF_GOOD_ONE</a>;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    }</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="comment">// Intersect with y=0.5 and y=-0.5</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(u) != 0 &amp;&amp; found_t != 2)</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    {</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        t = (0.5 - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r)) / <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(u);</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        <a class="code" href="geometry_8cpp.html#a7c7a927b60ebc2f213b35c7da6039918">ASSIGN_IF_GOOD_ONE</a>;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        t = (-0.5 - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r)) / <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(u);</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <a class="code" href="geometry_8cpp.html#a7c7a927b60ebc2f213b35c7da6039918">ASSIGN_IF_GOOD_ONE</a>;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    }</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <span class="comment">// Intersect with z=0.5 and z=-0.5</span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(u) != 0 &amp;&amp; found_t != 2)</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    {</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        t = (0.5 - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r)) / <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(u);</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        <a class="code" href="geometry_8cpp.html#a7c7a927b60ebc2f213b35c7da6039918">ASSIGN_IF_GOOD_ONE</a>;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        t = (-0.5 - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r)) / <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(u);</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        <a class="code" href="geometry_8cpp.html#a7c7a927b60ebc2f213b35c7da6039918">ASSIGN_IF_GOOD_ONE</a>;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    }</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordflow">if</span> (found_t == 2)</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        <span class="keywordflow">return</span> fabs(t1 -t2);</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;}</div><div class="ttc" id="geometry_8cpp_html_a7c7a927b60ebc2f213b35c7da6039918"><div class="ttname"><a href="geometry_8cpp.html#a7c7a927b60ebc2f213b35c7da6039918">ASSIGN_IF_GOOD_ONE</a></div><div class="ttdeci">#define ASSIGN_IF_GOOD_ONE</div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gad110429984082334e49641f5bca50c02"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double intersection_unit_cylinder </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Intersection of a ray with a unit cylinder</p>
<p>The cylinder is centered at (0,0,0), has got unit radius on the plane XY, and in Z goes from -h/2 to +h/2. The ray is defined by its direction (u) and a passing point (r). If the ray belongs to the lateral circular wall of the cylinder the length returned is h (h is computed as 1/ZZ(u), this is so because it is supposed that this intersection is computed after a coordinate transformation process from any cylinder to a unit one).</p>
<p>See <a class="el" href="classCylinder.html">Cylinder</a> to know how you can intersect any ray with any cylinder. </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l01156">1156</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;{</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="comment">// Intersect with an infinite cylinder of radius=ry</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keywordtype">double</span> A = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(u) * <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(u) + <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(u) * <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(u);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="keywordtype">double</span> B = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r) * <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(u) + <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r) * <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(u);</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="keywordtype">double</span> C = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r) * <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r) + <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r) * <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r) - 1;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="keywordtype">double</span> B2_AC = B * B - A * C;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keywordflow">if</span> (A == 0)</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    {</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;        <span class="keywordflow">if</span> (C &gt; 0)</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;            <span class="keywordflow">return</span> 0;       <span class="comment">// Parallel ray outside the cylinder</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;            <span class="keywordflow">return</span> 1 / <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(u); <span class="comment">// return height</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    }</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (B2_AC &lt; 0)</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    B2_AC = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(B2_AC);</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="comment">// Points at intersection</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keywordtype">double</span> t1 = (-B - B2_AC) / A;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="keywordtype">double</span> t2 = (-B + B2_AC) / A;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="keywordtype">double</span> z1 = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r) + t1 * <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(u);</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keywordtype">double</span> z2 = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r) + t2 * <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(u);</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="comment">// Check position of the intersecting points with respect to</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="comment">// the finite cylinder, if any is outside correct it to the</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="comment">// right place in the top or bottom of the cylinder</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(z1) &gt;= 0.5)</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        t1 = (<a class="code" href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a>(z1) * 0.5 - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r)) / <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(u);</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(z2) &gt;= 0.5)</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        t2 = (<a class="code" href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a>(z2) * 0.5 - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r)) / <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(u);</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(t1 -t2);</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;}</div><div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__Macros_html_ga95ed41486ca0ed53262e4b8934d4afac"><div class="ttname"><a href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a></div><div class="ttdeci">#define SGN(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00155">xmipp_macros.h:155</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga64b58172fd2a45ebeae5e7ce3216ec1c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double intersection_unit_sphere </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Intersection of a ray with a unit sphere</p>
<p>The sphere is centered at (0,0,0) and has got unit radius. The ray is defined by its direction (u) and a passing point (r). The function returns the length of the intersection. If the ray is tangent to the sphere the length is 0. See <a class="el" href="classEllipsoid.html">Ellipsoid</a> to know how you can intersect any ray with any ellipsoid/sphere. </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l01127">1127</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;{</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="comment">// Some useful constants</span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="keywordtype">double</span> A = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(u) * <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(u) + <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(u) * <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(u) + <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(u) * <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(u);</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="keywordtype">double</span> B = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r) * <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(u) + <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r) * <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(u) + <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r) * <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(u);</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keywordtype">double</span> C = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r) * <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r) + <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r) * <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r) + <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r) * <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r) - 1.0;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="keywordtype">double</span> B2_AC = B * B - A * C;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="comment">// A degenerate case?</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="keywordflow">if</span> (A == 0)</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    {</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <span class="keywordflow">if</span> (B == 0)</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            <span class="keywordflow">return</span> -1; <span class="comment">// The ellipsoid doesn&#39;t intersect</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        <span class="keywordflow">return</span> 0;            <span class="comment">// The ellipsoid is tangent at t=-C/2B</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    }</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <span class="keywordflow">if</span> (B2_AC &lt; 0)</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="comment">// A normal intersection</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    B2_AC = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(B2_AC);</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="keywordtype">double</span> t1 = (-B - B2_AC) / A;  <span class="comment">// The two parameters within the line for</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordtype">double</span> t2 = (-B + B2_AC) / A;  <span class="comment">// the solution</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(t2 -t1);</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;}</div><div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga89aeed607c234539e306b114f7a33195"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void least_squares_line_fit </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structfit__point2D.html">fit_point2D</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>IN_points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>line_A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>line_B</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Least-squares-fit a line to an arbitrary number of (x,y) points</p>
<p>Plane described as Ax + B = y</p>
<p>Points are defined using the struct</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;struct fit_point2D</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;{</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    double x;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    double y;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    double w;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;};</div></div><!-- fragment --><p>where w is a weighting factor. Set it to 1 if you do not want to use it </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00209">209</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;{</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordtype">double</span>  sumx = 0.;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordtype">double</span>  sumy = 0.;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordtype">double</span>  sumxy = 0.;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordtype">double</span>  sumxx = 0.;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordtype">double</span>  sumw = 0.;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">double</span>  W2;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keyword">const</span> <a class="code" href="structfit__point2D.html">fit_point2D</a> * point;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = IN_points.size();</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    {</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        point = &amp;(IN_points[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        W2 = point-&gt;<a class="code" href="structfit__point2D.html#a74114f6c70b3c75f2bf8ea213269174d">w</a> * point-&gt;<a class="code" href="structfit__point2D.html#a74114f6c70b3c75f2bf8ea213269174d">w</a>;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        sumx  += point-&gt;<a class="code" href="structfit__point2D.html#a3923f9b47bafd8bec871c16fe75effc6">x</a> * point-&gt;<a class="code" href="structfit__point2D.html#a74114f6c70b3c75f2bf8ea213269174d">w</a> ;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        sumy  += point-&gt;<a class="code" href="structfit__point2D.html#a8d2bd55015f7076e0ed1da4353e8877f">y</a> * point-&gt;<a class="code" href="structfit__point2D.html#a74114f6c70b3c75f2bf8ea213269174d">w</a> ;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        sumxx += point-&gt;<a class="code" href="structfit__point2D.html#a3923f9b47bafd8bec871c16fe75effc6">x</a> * point-&gt;<a class="code" href="structfit__point2D.html#a3923f9b47bafd8bec871c16fe75effc6">x</a> * W2 ;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        sumxy += point-&gt;<a class="code" href="structfit__point2D.html#a3923f9b47bafd8bec871c16fe75effc6">x</a> * point-&gt;<a class="code" href="structfit__point2D.html#a8d2bd55015f7076e0ed1da4353e8877f">y</a> * W2 ;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        sumw  += point-&gt;<a class="code" href="structfit__point2D.html#a74114f6c70b3c75f2bf8ea213269174d">w</a> ;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    line_a = (sumx*sumy - sumw*sumxy) / (sumx*sumx - sumw*sumxx) ;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    line_b = (sumy - line_a*sumx) / sumw ;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;}</div><div class="ttc" id="structfit__point2D_html_a3923f9b47bafd8bec871c16fe75effc6"><div class="ttname"><a href="structfit__point2D.html#a3923f9b47bafd8bec871c16fe75effc6">fit_point2D::x</a></div><div class="ttdeci">double x</div><div class="ttdoc">x coordinate </div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00234">geometry.h:234</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="structfit__point2D_html"><div class="ttname"><a href="structfit__point2D.html">fit_point2D</a></div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00231">geometry.h:231</a></div></div>
<div class="ttc" id="structfit__point2D_html_a8d2bd55015f7076e0ed1da4353e8877f"><div class="ttname"><a href="structfit__point2D.html#a8d2bd55015f7076e0ed1da4353e8877f">fit_point2D::y</a></div><div class="ttdeci">double y</div><div class="ttdoc">y coordinate (assumed to be a function of x) </div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00236">geometry.h:236</a></div></div>
<div class="ttc" id="structfit__point2D_html_a74114f6c70b3c75f2bf8ea213269174d"><div class="ttname"><a href="structfit__point2D.html#a74114f6c70b3c75f2bf8ea213269174d">fit_point2D::w</a></div><div class="ttdeci">double w</div><div class="ttdoc">Weight of the point in the Least-Squares problem. </div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00238">geometry.h:238</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga390c0b3d3c4ee8857d9c9e5ab36d7f30"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void least_squares_plane_fit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFitPoint.html">FitPoint</a> *&#160;</td>
          <td class="paramname"><em>IN_points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Npoints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>plane_A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>plane_B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>plane_C</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Least-squares-fit a plane to an arbitrary number of (x,y,z) points</p>
<p>Plane described as Ax + By + C = z</p>
<p>Points are defined using the struct</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;struct fit_point</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;{</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    double x;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    double y;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    double z;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    double w;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;};</div></div><!-- fragment --><p>where w is a weighting factor. Set it to 1 if you do not want to use it </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00098">98</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;{</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">double</span>  D = 0;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordtype">double</span>  E = 0;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordtype">double</span>  F = 0;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordtype">double</span>  G = 0;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordtype">double</span>  H = 0;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordtype">double</span>  I = 0;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordtype">double</span>  J = 0;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordtype">double</span>  <a class="code" href="libraries_2data_2integration_8cpp.html#a97d832ae23af4f215e801e37e4f94254">K</a> = 0;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordtype">double</span>  L = 0;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordtype">double</span>  W2 = 0;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordtype">double</span>  denom = 0;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keyword">const</span> <a class="code" href="structFitPoint.html">FitPoint</a> * point;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; Npoints; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        point = &amp;(IN_points[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);<span class="comment">//Can I copy just the address?</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        W2 = point-&gt;<a class="code" href="structFitPoint.html#aedc11e94cbd1158d90508a91223fbd13">w</a> * point-&gt;<a class="code" href="structFitPoint.html#aedc11e94cbd1158d90508a91223fbd13">w</a>;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        D += point-&gt;<a class="code" href="structFitPoint.html#ab99c7363be00be51a757b651d0e3c1ad">x</a> * point-&gt;<a class="code" href="structFitPoint.html#ab99c7363be00be51a757b651d0e3c1ad">x</a> * W2 ;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        E += point-&gt;<a class="code" href="structFitPoint.html#ab99c7363be00be51a757b651d0e3c1ad">x</a> * point-&gt;<a class="code" href="structFitPoint.html#af985f5a0c42728bacb9b8a34e52c7740">y</a> * W2 ;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        F += point-&gt;<a class="code" href="structFitPoint.html#ab99c7363be00be51a757b651d0e3c1ad">x</a> * W2 ;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        G += point-&gt;<a class="code" href="structFitPoint.html#af985f5a0c42728bacb9b8a34e52c7740">y</a> * point-&gt;<a class="code" href="structFitPoint.html#af985f5a0c42728bacb9b8a34e52c7740">y</a> * W2 ;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        H += point-&gt;<a class="code" href="structFitPoint.html#af985f5a0c42728bacb9b8a34e52c7740">y</a> * W2 ;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        I += 1 * W2 ;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        J += point-&gt;<a class="code" href="structFitPoint.html#ab99c7363be00be51a757b651d0e3c1ad">x</a> * point-&gt;<a class="code" href="structFitPoint.html#a92d92a0a18160ec456e56ace85c9eddb">z</a> * W2 ;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        K += point-&gt;<a class="code" href="structFitPoint.html#af985f5a0c42728bacb9b8a34e52c7740">y</a> * point-&gt;<a class="code" href="structFitPoint.html#a92d92a0a18160ec456e56ace85c9eddb">z</a> * W2 ;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        L += point-&gt;<a class="code" href="structFitPoint.html#a92d92a0a18160ec456e56ace85c9eddb">z</a> * W2 ;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    denom = F * F * G - 2 * E * F * H + D * H * H + E * E * I - D * G * I;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">// X axis slope</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    plane_a = (H * H * J - G * I * J + E * I * K + F * G * L - H * (F * K + E * L)) / denom;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// Y axis slope</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    plane_b = (E * I * J + F * F * K - D * I * K + D * H * L - F * (H * J + E * L)) / denom;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// Z axis intercept</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    plane_c = (F * G * J - E * H * J - E * F * K + D * H * K + E * E * L - D * G * L) / denom;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;}</div><div class="ttc" id="structFitPoint_html_a92d92a0a18160ec456e56ace85c9eddb"><div class="ttname"><a href="structFitPoint.html#a92d92a0a18160ec456e56ace85c9eddb">FitPoint::z</a></div><div class="ttdeci">double z</div><div class="ttdoc">z coordinate, assumed to be a function of x and y </div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00190">geometry.h:190</a></div></div>
<div class="ttc" id="structFitPoint_html_ab99c7363be00be51a757b651d0e3c1ad"><div class="ttname"><a href="structFitPoint.html#ab99c7363be00be51a757b651d0e3c1ad">FitPoint::x</a></div><div class="ttdeci">double x</div><div class="ttdoc">x coordinate </div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00186">geometry.h:186</a></div></div>
<div class="ttc" id="structFitPoint_html_aedc11e94cbd1158d90508a91223fbd13"><div class="ttname"><a href="structFitPoint.html#aedc11e94cbd1158d90508a91223fbd13">FitPoint::w</a></div><div class="ttdeci">double w</div><div class="ttdoc">Weight of the point in the Least-Squares problem. </div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00192">geometry.h:192</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="structFitPoint_html_af985f5a0c42728bacb9b8a34e52c7740"><div class="ttname"><a href="structFitPoint.html#af985f5a0c42728bacb9b8a34e52c7740">FitPoint::y</a></div><div class="ttdeci">double y</div><div class="ttdoc">y coordinate </div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00188">geometry.h:188</a></div></div>
<div class="ttc" id="structFitPoint_html"><div class="ttname"><a href="structFitPoint.html">FitPoint</a></div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00183">geometry.h:183</a></div></div>
<div class="ttc" id="libraries_2data_2integration_8cpp_html_a97d832ae23af4f215e801e37e4f94254"><div class="ttname"><a href="libraries_2data_2integration_8cpp.html#a97d832ae23af4f215e801e37e4f94254">K</a></div><div class="ttdeci">#define K</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2integration_8cpp_source.html#l00118">integration.cpp:118</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga132d339f9935014a8df1c1073e6400cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void least_squares_plane_fit_All_Points </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>plane_A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>plane_B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>plane_C</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Least-squares-fit a plane to an image</p>
<p>Performs the same computation as least_squares_plane_fit but using a complete image instead of only a set of points. </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00151">151</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;{</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordtype">double</span>  D = 0;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">double</span>  E = 0;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordtype">double</span>  F = 0;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordtype">double</span>  G = 0;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordtype">double</span>  H = 0;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordtype">double</span>  I = 0;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordtype">double</span>  J = 0;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordtype">double</span>  <a class="code" href="libraries_2data_2integration_8cpp.html#a97d832ae23af4f215e801e37e4f94254">K</a> = 0;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordtype">double</span>  L = 0;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordtype">double</span>  denom = 0;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordtype">int</span> nIterations=0;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordtype">double</span> sumjValues=0.0;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=<a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(Image); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;=<a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(Image); ++<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        D += <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>*<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        sumjValues += <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        I += 1;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    }</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    F = sumjValues;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordtype">double</span> *ref;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordtype">double</span> sumElements;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=<a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(Image); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;=<a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(Image); ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        nIterations++;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        ref = &amp;<a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Image, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(Image));</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        sumElements = 0.0;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=<a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(Image); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;=<a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(Image); ++<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            J += <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>*(*ref);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            sumElements += (*ref);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            ref++;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        K += <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>*sumElements;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        L += sumElements;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        E += sumjValues*<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        G += i*i*I;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        H += i*I;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    D = D*nIterations;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    F = F*nIterations;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    I = I*nIterations;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    denom = F * F * G - 2 * E * F * H + D * H * H + E * E * I - D * G * I;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// X axis slope</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    plane_a = (H * H * J - G * I * J + E * I * K + F * G * L - H * (F * K + E * L)) / denom;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// Y axis slope</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    plane_b = (E * I * J + F * F * K - D * I * K + D * H * L - F * (H * J + E * L)) / denom;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// Z axis intercept</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    plane_c = (F * G * J - E * H * J - E * F * K + D * H * K + E * E * L - D * G * L) / denom;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00364">multidim_array.h:364</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00065">multidim_array.h:65</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00073">multidim_array.h:73</a></div></div>
<div class="ttc" id="libraries_2data_2integration_8cpp_html_a97d832ae23af4f215e801e37e4f94254"><div class="ttname"><a href="libraries_2data_2integration_8cpp.html#a97d832ae23af4f215e801e37e4f94254">K</a></div><div class="ttdeci">#define K</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2integration_8cpp_source.html#l00118">integration.cpp:118</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga90c00c4b44fb178a299c96bb8587df52"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int line_plane_intersection </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>normal_plane</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>vector_line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>intersection_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>point_line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>point_plane_at_x_y_zero</em> = <code>0.</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Line Plane Intersection</p>
<p>Let ax+by+cz+D=0 be the equation of your plane (if your plane is defined by a normal vector N + one point M, then (a,b,c) are the coordinates of the normal N, and d is calculated by using the coordinates of M in the above equation).</p>
<p>Let your line be defined by one point P(d,e,f) and a vector V(u,v,w), the points on your line are those which verify</p>
<p>x = d + lu y = e + lv z = f + lw</p>
<p>where l takes all real values.</p>
<p>for this point to be on the plane, you have to have</p>
<p>ax + by + cz + D = 0, so,</p>
<p>a(d + lu) + b(e + lv) + c(f + lw) + D = 0</p>
<p>that is</p>
<p>l(au + bv + cw) = -(ad + be + cf + D)</p>
<p>note that, if au + bv + cw = 0, then your line is either in the plane, or parallel to it... otherwise you get the value of l, and the intersection has coordinates:</p>
<p>x = d + lu y = e + lv z = f + lw</p>
<p>where</p>
<p>l = -(ad + be + cf + D) / (au + bv + cw)</p>
<p>a = <a class="el" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX(normal_plane)</a>; b = <a class="el" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY(normal_plane)</a>; c = <a class="el" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ(normal_plane)</a>; D = intersection_point;</p>
<p>d = <a class="el" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX(point_line)</a> e = <a class="el" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY(point_line)</a> f = <a class="el" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ(point_line)</a></p>
<p>u = <a class="el" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX(vector_line)</a>; v = <a class="el" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY(vector_line)</a>; w = <a class="el" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ(vector_line)</a>;</p>
<p><a class="el" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX(intersection_point)</a> = x; <a class="el" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY(intersection_point)</a> = y; <a class="el" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ(intersection_point)</a> = z;</p>
<p>return 0 if successful return -1 if line parallel to plane return +1 if line in the plane </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00585">585</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;{</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordtype">double</span> l;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    intersection_point.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(3);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="comment">// if au+bv+cw=0, then your line is either in the plane, or</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">// parallel to it</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(<a class="code" href="group__Vectors.html#ga5d2bc77c327154906885f1ebedc8d787">dotProduct</a>(normal_plane, vector_line)) &lt; <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>)</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    {</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        intersection_point = point_line + vector_line;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(<a class="code" href="group__Vectors.html#ga5d2bc77c327154906885f1ebedc8d787">dotProduct</a>(intersection_point, normal_plane) +</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                point_plane_at_x_y_zero) &lt; <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>)</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <span class="keywordflow">return</span>(1);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="keywordflow">return</span>(-1);</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    }</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="comment">//compute intersection</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    l = -1.0 * <a class="code" href="group__Vectors.html#ga5d2bc77c327154906885f1ebedc8d787">dotProduct</a>(point_line, normal_plane) +</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        point_plane_at_x_y_zero;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    l /=  <a class="code" href="group__Vectors.html#ga5d2bc77c327154906885f1ebedc8d787">dotProduct</a>(normal_plane, vector_line);</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    intersection_point = point_line + l * vector_line;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">return</span>(0);</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;}</div><div class="ttc" id="group__Macros_html_gad584f97e936242b173add43261376ba5"><div class="ttname"><a href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a></div><div class="ttdeci">#define XMIPP_EQUAL_ACCURACY</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00119">xmipp_macros.h:119</a></div></div>
<div class="ttc" id="classMatrix1D_html_a79a482948ae334cbefaef7c7839cd934"><div class="ttname"><a href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">Matrix1D::resize</a></div><div class="ttdeci">void resize(size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00451">matrix1d.h:451</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="group__Vectors_html_ga5d2bc77c327154906885f1ebedc8d787"><div class="ttname"><a href="group__Vectors.html#ga5d2bc77c327154906885f1ebedc8d787">dotProduct</a></div><div class="ttdeci">T dotProduct(const Matrix1D&lt; T &gt; &amp;v1, const Matrix1D&lt; T &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01817">matrix1d.h:1817</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga4ba6558fddc767ff505f747d275ea5d4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool point_inside_polygon </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>polygon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>point</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structPoint.html">Point</a> inside polygon</p>
<p>Given a polygon described by a list of points (the last one and the first one ust be the same), determine whether another point is inside the polygon or not. </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00415">415</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;{</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordtype">bool</span> retval = <span class="keyword">false</span>;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">for</span> (i = 0, j = polygon.size() - 1; i &lt; polygon.size(); j = i++)</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    {</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="keywordflow">if</span> ((((<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(polygon[i]) &lt;= <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(point)) &amp;&amp; (<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(point) &lt; <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(polygon[j]))) ||</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;             ((<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(polygon[j]) &lt;= <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(point)) &amp;&amp; (<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(point) &lt; <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(polygon[i])))) &amp;&amp;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(point) &lt; (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(polygon[j]) - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(polygon[i])) *</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;             (<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(point) - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(polygon[i])) /</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;             (<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(polygon[j]) - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(polygon[i])) + <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(polygon[i])))</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            retval = !retval;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    }</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">return</span> retval;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;}</div><div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga3adf48a1d9643041f01f7bab097a8d44"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double point_line_distance_3D </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structPoint.html">Point</a> to line distance in 3D</p>
<p>Let a line in 3-D be specified by the point a and the vector v, this fuction returns the minimum distance of this line to the point p. </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00082">82</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> p_a(3);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="group__Vectors.html#ga84bcbfeda75ac1ed822f6d92585e4fdf">V3_MINUS_V3</a>(p_a, p, a);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a>(p_a, v).module() / v.<a class="code" href="classMatrix1D.html#a9ee6afb32720ca26450038def994af96">module</a>());</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;}</div><div class="ttc" id="group__Vectors_html_ga84bcbfeda75ac1ed822f6d92585e4fdf"><div class="ttname"><a href="group__Vectors.html#ga84bcbfeda75ac1ed822f6d92585e4fdf">V3_MINUS_V3</a></div><div class="ttdeci">#define V3_MINUS_V3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00205">matrix1d.h:205</a></div></div>
<div class="ttc" id="group__Vectors_html_ga4bdee25c828ee43970e047b304c7dd20"><div class="ttname"><a href="group__Vectors.html#ga4bdee25c828ee43970e047b304c7dd20">vectorProduct</a></div><div class="ttdeci">Matrix1D&lt; T &gt; vectorProduct(const Matrix1D&lt; T &gt; &amp;v1, const Matrix1D&lt; T &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01842">matrix1d.h:1842</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classMatrix1D_html_a9ee6afb32720ca26450038def994af96"><div class="ttname"><a href="classMatrix1D.html#a9ee6afb32720ca26450038def994af96">Matrix1D::module</a></div><div class="ttdeci">double module() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01578">matrix1d.h:1578</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaa4d9e4ee82f494ed61ace73dd7a2dc81"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double point_plane_distance_3D </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p><a class="el" href="structPoint.html">Point</a> to plane distance in 3D</p>
<p>Let a plane in 3-D be specified by the point a and the perpendicular vector v, this fuction returns the minimum distance of this plane to the point p. </p>

<p>Definition at line <a class="el" href="geometry_8h_source.html#l00171">171</a> of file <a class="el" href="geometry_8h_source.html">geometry.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;{</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keyword">static</span> <a class="code" href="classMatrix1D.html">Matrix1D&lt; double &gt;</a> p_a(3);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="group__Vectors.html#ga84bcbfeda75ac1ed822f6d92585e4fdf">V3_MINUS_V3</a>(p_a, p, a);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="group__Vectors.html#ga5d2bc77c327154906885f1ebedc8d787">dotProduct</a>(p_a, v) / v.<a class="code" href="classMatrix1D.html#a9ee6afb32720ca26450038def994af96">module</a>());</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;}</div><div class="ttc" id="group__Vectors_html_ga84bcbfeda75ac1ed822f6d92585e4fdf"><div class="ttname"><a href="group__Vectors.html#ga84bcbfeda75ac1ed822f6d92585e4fdf">V3_MINUS_V3</a></div><div class="ttdeci">#define V3_MINUS_V3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00205">matrix1d.h:205</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_ga5d2bc77c327154906885f1ebedc8d787"><div class="ttname"><a href="group__Vectors.html#ga5d2bc77c327154906885f1ebedc8d787">dotProduct</a></div><div class="ttdeci">T dotProduct(const Matrix1D&lt; T &gt; &amp;v1, const Matrix1D&lt; T &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01817">matrix1d.h:1817</a></div></div>
<div class="ttc" id="classMatrix1D_html_a9ee6afb32720ca26450038def994af96"><div class="ttname"><a href="classMatrix1D.html#a9ee6afb32720ca26450038def994af96">Matrix1D::module</a></div><div class="ttdeci">double module() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01578">matrix1d.h:1578</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaf98f879a0edc0a55192481d00e31ae37"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rectangle_enclosing </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>vF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>corner1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>corner2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classRectangle.html">Rectangle</a> which encloses a deformed rectangle</p>
<p>Given a rectangle characterized by the top-left corner and the right-bottom corner, and given a matrix after which the rectangle is deformed. Which is the minimum rectangle which encloses the preceding one? This function is useful for stablishing for loops which will cover for sure the deformed rectangle. All vectors are supposed to be 2x1 and the deformation matrix is 2x2. The corner (x0,y0) goes to V*(x0,y0)' and (xF,yF) to V*(xf,yF)'. After that you can make a loop from corner1 to corner2.</p>
<p>The v0 and vF vectors can be reused as outputs. </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00325">325</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;{</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <a class="code" href="group__Macros.html#ga0714b7b60ab5b804af1c9b124863178e">SPEED_UP_temps01</a>;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> v(2);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    corner1.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(2);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    corner2.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(2);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="comment">// Store values for reusing input as output vectors</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordtype">double</span> XX_v0 = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(v0);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordtype">double</span> YY_v0 = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(v0);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordtype">double</span> XX_vF = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(vF);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordtype">double</span> YY_vF = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(vF);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="group__Vectors.html#gaf35071e3863333ef9ff847bb85615bb4">VECTOR_R2</a>(v, XX_v0, YY_v0);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <a class="code" href="group__Matrices.html#gaec08782c566ba3c8c093b909f562e953">M2x2_BY_V2x1</a>(v, V, v);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1) = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(v);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2) = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(v);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1) = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(v);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2) = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(v);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="preprocessor">#define DEFORM_AND_CHOOSE_CORNERS2D \</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="preprocessor">    M2x2_BY_V2x1(v,V,v); \</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="preprocessor">    XX(corner1)=XMIPP_MIN(XX(corner1),XX(v)); \</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="preprocessor">    XX(corner2)=XMIPP_MAX(XX(corner2),XX(v)); \</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="preprocessor">    YY(corner1)=XMIPP_MIN(YY(corner1),YY(v)); \</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="preprocessor">    YY(corner2)=XMIPP_MAX(YY(corner2),YY(v));</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <a class="code" href="group__Vectors.html#gaf35071e3863333ef9ff847bb85615bb4">VECTOR_R2</a>(v, XX_vF, YY_v0);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <a class="code" href="geometry_8cpp.html#a67d6af88b94c006c0d5382c229d2d328">DEFORM_AND_CHOOSE_CORNERS2D</a>;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="group__Vectors.html#gaf35071e3863333ef9ff847bb85615bb4">VECTOR_R2</a>(v, XX_v0, YY_vF);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="geometry_8cpp.html#a67d6af88b94c006c0d5382c229d2d328">DEFORM_AND_CHOOSE_CORNERS2D</a>;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="group__Vectors.html#gaf35071e3863333ef9ff847bb85615bb4">VECTOR_R2</a>(v, XX_vF, YY_vF);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <a class="code" href="geometry_8cpp.html#a67d6af88b94c006c0d5382c229d2d328">DEFORM_AND_CHOOSE_CORNERS2D</a>;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;}</div><div class="ttc" id="group__Vectors_html_gaf35071e3863333ef9ff847bb85615bb4"><div class="ttname"><a href="group__Vectors.html#gaf35071e3863333ef9ff847bb85615bb4">VECTOR_R2</a></div><div class="ttdeci">#define VECTOR_R2(v, x, y)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00115">matrix1d.h:115</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Matrices_html_gaec08782c566ba3c8c093b909f562e953"><div class="ttname"><a href="group__Matrices.html#gaec08782c566ba3c8c093b909f562e953">M2x2_BY_V2x1</a></div><div class="ttdeci">#define M2x2_BY_V2x1(a, M, b)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00226">matrix2d.h:226</a></div></div>
<div class="ttc" id="classMatrix1D_html_a79a482948ae334cbefaef7c7839cd934"><div class="ttname"><a href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">Matrix1D::resize</a></div><div class="ttdeci">void resize(size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00451">matrix1d.h:451</a></div></div>
<div class="ttc" id="group__Macros_html_ga0714b7b60ab5b804af1c9b124863178e"><div class="ttname"><a href="group__Macros.html#ga0714b7b60ab5b804af1c9b124863178e">SPEED_UP_temps01</a></div><div class="ttdeci">#define SPEED_UP_temps01</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00398">xmipp_macros.h:398</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="geometry_8cpp_html_a67d6af88b94c006c0d5382c229d2d328"><div class="ttname"><a href="geometry_8cpp.html#a67d6af88b94c006c0d5382c229d2d328">DEFORM_AND_CHOOSE_CORNERS2D</a></div><div class="ttdeci">#define DEFORM_AND_CHOOSE_CORNERS2D</div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gab9ad8d1ca1a8c56fb2a1cfe0a5990cc4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double spherical_distance </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Spherical distance</p>
<p>This function returns the distance over a sphere, not the straight line but the line which goes from one point to the other going over the surface of a sphere, supposing that both points lie on the same sphere. </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00072">72</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;{</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordtype">double</span> r1r2 = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r1) * <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r2) + <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r1) * <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r2) + <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r1) * <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r2);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">double</span> R1 = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r1) * <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r1) + <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r1) * <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r1) + <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r1) * <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r1));</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordtype">double</span> R2 = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r2) * <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r2) + <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r2) * <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r2) + <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r2) * <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r2));</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">double</span> ang = acos(r1r2 / (R1 * R2));</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">return</span> ang*R1;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;}</div><div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga087a4c564869f76df0f1a499737e4e50"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double triangle_area </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Area of a triangle Given the coordinates of three points this function calculates the area of the triangle </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00508">508</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;{</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordtype">double</span> trigarea = ((x2 - x1)*(y3 - y1) - (x3 - x1)*(y2 - y1))/2;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">return</span> (trigarea &gt; 0) ? trigarea : -trigarea;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gade8f7976e3d84a594d4728bf8f4c029e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Uproject_to_plane </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>distance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Project a point to a plane (direction vector, distance)</p>
<p>Given the coordinates for a vector in R3, and a plane (defined by its direction vector and the minimum distance from the plane to the coordinate system origin). This function computes the perpendicular projection from the vector to the plane. This function has tried to be optimized in speed as it is used in core routines within huge loops, this is why the result is given as an argument, and why no check about the dimensionality of the vectors is performed. The routine performs faster if the result vector is already in R3.</p>
<p>The following example projects the point P=(1,1,1) to the XY-plane storing the result in Pp (belonging to R3), the result is obviously Pp=(1,1,0).</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Matrix1D&lt; double &gt; Z = vectorR3(0, 0, 1), P = vector_R3(1, 1, 1), Pp(3);</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Uproject_to_plane(P,Z,0,Pp);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;std::cout &lt;&lt; &quot;After projecting: Pp=&quot; &lt;&lt; Pp.transpose() &lt;&lt; std::endl;</div></div><!-- fragment --><p>The starting U in the function name stands for the fact that the plane and the point are in the same reference system (called by default Universal).</p>
<p>The result and point vectors can be the same one. </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00038">38</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">if</span> (result.<a class="code" href="classMatrix1D.html#ace0d77b8d838032f071e18e450fc04e4">size</a>() != 3)</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        result.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(3);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordtype">double</span> xx = <a class="code" href="point_8cpp.html#adb0abda300c610b969c8be89ed30a4f6">distance</a> - (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(point) * <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(direction) + <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(point) * <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(direction) +</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                            <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(point) * <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(direction));</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(result) = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(point) + xx * <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(direction);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(result) = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(point) + xx * <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(direction);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(result) = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(point) + xx * <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(direction);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div><div class="ttc" id="classMatrix1D_html_ace0d77b8d838032f071e18e450fc04e4"><div class="ttname"><a href="classMatrix1D.html#ace0d77b8d838032f071e18e450fc04e4">Matrix1D::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00549">matrix1d.h:549</a></div></div>
<div class="ttc" id="point_8cpp_html_adb0abda300c610b969c8be89ed30a4f6"><div class="ttname"><a href="point_8cpp.html#adb0abda300c610b969c8be89ed30a4f6">distance</a></div><div class="ttdeci">TYPE distance(struct Point_T *p, struct Point_T *q)</div><div class="ttdef"><b>Definition:</b> <a href="point_8cpp_source.html#l00028">point.cpp:28</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="classMatrix1D_html_a79a482948ae334cbefaef7c7839cd934"><div class="ttname"><a href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">Matrix1D::resize</a></div><div class="ttdeci">void resize(size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00451">matrix1d.h:451</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga54b1579073632c12c4d311be204eec3e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Uproject_to_plane </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Project a vector to a plane (<a class="el" href="classEuler.html">Euler</a> angles)</p>
<p>These planes are restricted to have 0 distance to the universal coordinate system. In this special case, a plane can be defined by 3 <a class="el" href="classEuler.html">Euler</a> angles (this is specially suited for projections, where the projection plane is defined by its 3 <a class="el" href="classEuler.html">Euler</a> angles). Then, the coordinate system associated to the 3 <a class="el" href="classEuler.html">Euler</a> angles (let's call its vectors X',Y',Z') defines a projection plane where Z' is the direction vector, and X'Y' are in-plane vectors. Actually, X' coincides with the X vector in the <a class="el" href="classMatrix2D.html">Matrix2D</a> definition and Y' with the Y vector.</p>
<p>The resulting vector is in R3, and the function has been optimized for speed, so the result is passed as a parameter. This function is based in the one which projects a point given the <a class="el" href="classEuler.html">Euler</a> matrix of the projection plane. If you are to project several points to the same plane, you should better use the project to plane function where you give the <a class="el" href="classEuler.html">Euler</a> matrix.</p>
<p>The following example projects the point P=(1,1,1) to the XY-plane storing the result in Pp (belonging to R3), the result is obviously Pp=(1,1,0).</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Matrix1D&lt; double &gt; P = vectorR3(1, 1, 1), Pp(3);</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Uproject_to_plane(P, 0, 0, 0, Pp);</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;std::cout &lt;&lt; &quot;After projecting: Pp=&quot; &lt;&lt; Pp.transpose() &lt;&lt; std::endl;</div></div><!-- fragment --><p>The starting U in the function name stands for the fact that the plane, and the point are in the same reference system (called by default Universal).</p>
<p>The result and point vectors can be the same one. </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00053">53</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> euler(3, 3);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a>(rot, tilt, <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>, euler);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="group__Geometry.html#gade8f7976e3d84a594d4728bf8f4c029e">Uproject_to_plane</a>(r, euler, result);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;}</div><div class="ttc" id="group__Geometry_html_gaf67a2d233e3fbf038d111a91197fa759"><div class="ttname"><a href="group__Geometry.html#gaf67a2d233e3fbf038d111a91197fa759">Euler_angles2matrix</a></div><div class="ttdeci">void Euler_angles2matrix(T alpha, T beta, T gamma, Matrix2D&lt; T &gt; &amp;A, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00621">geometry.cpp:621</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="group__Geometry_html_gade8f7976e3d84a594d4728bf8f4c029e"><div class="ttname"><a href="group__Geometry.html#gade8f7976e3d84a594d4728bf8f4c029e">Uproject_to_plane</a></div><div class="ttdeci">void Uproject_to_plane(const Matrix1D&lt; double &gt; &amp;point, const Matrix1D&lt; double &gt; &amp;direction, double distance, Matrix1D&lt; double &gt; &amp;result)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00038">geometry.cpp:38</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaec185180517a9672a2ebdc0a1bfd3e77"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Uproject_to_plane </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>euler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Project a vector to a plane (<a class="el" href="classEuler.html">Euler</a> matrix)</p>
<p>These planes are restricted to have 0 distance to the universal coordinate system. In this special case, a plane can be defined by 3 <a class="el" href="classEuler.html">Euler</a> angles (this is specially suited for projections, where the projection plane is defined by its 3 <a class="el" href="classEuler.html">Euler</a> angles). Then, the coordinate system associated to the 3 <a class="el" href="classEuler.html">Euler</a> angles (let's call its vectors X',Y',Z') defines a projection plane where Z' is the direction vector, and X'Y' are in-plane vectors. Actually, X' coincides with the X vector in the <a class="el" href="classMatrix2D.html">Matrix2D</a> definition and Y' with the Y vector.</p>
<p>The resulting vector is in R3, and the function has been optimized for speed, if the result vector is already 3 dimensional when entering the function, no resize is performed; and the result is passed as a parameter. If you are to project several points to the same plane, you should better use the project to plane function where you give the <a class="el" href="classEuler.html">Euler</a> matrix.</p>
<p>The following example projects the point P=(1,1,1) to the XY-plane storing the result in Pp (belonging to R3), the result is obviously Pp=(1,1,0).</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Matrix1D&lt; double &gt; P = vectorR3(1, 1, 1), Pp(3);</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Matrix2D&lt; double &gt; euler;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Euler_angles2matrix(0, 0, 0, euler);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Uproject_to_plane(P, euler, Pp);</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;std::cout &lt;&lt; &quot;After projecting: Pp=&quot; &lt;&lt; Pp.transpose() &lt;&lt; std::endl;</div></div><!-- fragment --><p>The starting U in the function name stands for the fact that the plane, and the point are in the same reference system (called by default Universal).</p>
<p>The result and point vectors can be the same one. </p>

<p>Definition at line <a class="el" href="geometry_8cpp_source.html#l00062">62</a> of file <a class="el" href="geometry_8cpp_source.html">geometry.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#gad6524c4e36da91aae3fb6f8564112364">VEC_XSIZE</a>(result) != 3)</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        result.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(3);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a>(result, euler, r);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;}</div><div class="ttc" id="group__Vectors_html_gad6524c4e36da91aae3fb6f8564112364"><div class="ttname"><a href="group__Vectors.html#gad6524c4e36da91aae3fb6f8564112364">VEC_XSIZE</a></div><div class="ttdeci">#define VEC_XSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00080">matrix1d.h:80</a></div></div>
<div class="ttc" id="classMatrix1D_html_a79a482948ae334cbefaef7c7839cd934"><div class="ttname"><a href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">Matrix1D::resize</a></div><div class="ttdeci">void resize(size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00451">matrix1d.h:451</a></div></div>
<div class="ttc" id="group__Matrices_html_gad159332322d687de886a720422e4b757"><div class="ttname"><a href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a></div><div class="ttdeci">#define M3x3_BY_V3x1(a, M, b)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00171">matrix2d.h:171</a></div></div>
<div class="ttc" id="group__Macros_html_ga20716e3da0ba25d3c4c9a2421573391f"><div class="ttname"><a href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a></div><div class="ttdeci">#define SPEED_UP_temps012</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00403">xmipp_macros.h:403</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
