<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Xmipp: Feature Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classFeature-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Feature Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span><div class="ingroups"><a class="el" href="group__Phantoms.html">Phantoms</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="phantom_8h_source.html">phantom.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Feature:</div>
<div class="dyncontent">
<div class="center"><img src="classFeature__inherit__graph.png" border="0" usemap="#Feature_inherit__map" alt="Inheritance graph"/></div>
<map name="Feature_inherit__map" id="Feature_inherit__map">
<area shape="rect" id="node2" href="classBlob.html" title="Blob" alt="" coords="5,80,53,107"/>
<area shape="rect" id="node3" href="classGaussian.html" title="Gaussian" alt="" coords="77,80,155,107"/>
<area shape="rect" id="node4" href="classOriented__Feature.html" title="Oriented_Feature" alt="" coords="179,80,301,107"/>
<area shape="rect" id="node10" href="classSphere.html" title="Sphere" alt="" coords="326,80,389,107"/>
<area shape="rect" id="node5" href="classCone.html" title="Cone" alt="" coords="49,155,103,181"/>
<area shape="rect" id="node6" href="classCube.html" title="Cube" alt="" coords="127,155,180,181"/>
<area shape="rect" id="node7" href="classCylinder.html" title="Cylinder" alt="" coords="205,155,275,181"/>
<area shape="rect" id="node8" href="classDCylinder.html" title="DCylinder" alt="" coords="300,155,380,181"/>
<area shape="rect" id="node9" href="classEllipsoid.html" title="Ellipsoid" alt="" coords="405,155,475,181"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for Feature:</div>
<div class="dyncontent">
<div class="center"><img src="classFeature__coll__graph.png" border="0" usemap="#Feature_coll__map" alt="Collaboration graph"/></div>
<map name="Feature_coll__map" id="Feature_coll__map">
<area shape="rect" id="node2" href="classMatrix1D.html" title="Matrix1D\&lt; double \&gt;" alt="" coords="5,5,143,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8b8eb9bc2f3759db4f200b37336825c3"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a8b8eb9bc2f3759db4f200b37336825c3">~Feature</a> ()</td></tr>
<tr class="separator:a8b8eb9bc2f3759db4f200b37336825c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfc109c7db1e18439d93e4bf56260e09"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#acfc109c7db1e18439d93e4bf56260e09">prepare</a> ()=0</td></tr>
<tr class="separator:acfc109c7db1e18439d93e4bf56260e09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af12ffde77862ccfa8f05edcf83318abe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFeature.html">Feature</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#af12ffde77862ccfa8f05edcf83318abe">operator=</a> (const <a class="el" href="classFeature.html">Feature</a> &amp;F)</td></tr>
<tr class="memdesc:af12ffde77862ccfa8f05edcf83318abe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assignment.  <a href="#af12ffde77862ccfa8f05edcf83318abe">More...</a><br /></td></tr>
<tr class="separator:af12ffde77862ccfa8f05edcf83318abe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2b730e0b4547bcfb383b243aa868136"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#ae2b730e0b4547bcfb383b243aa868136">assign</a> (const <a class="el" href="classFeature.html">Feature</a> &amp;F)</td></tr>
<tr class="separator:ae2b730e0b4547bcfb383b243aa868136"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6a6e450be06a1ece3d1d97adce9812c"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#aa6a6e450be06a1ece3d1d97adce9812c">rotate</a> (const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;E)</td></tr>
<tr class="separator:aa6a6e450be06a1ece3d1d97adce9812c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b02140efd49b5ac5cb4f01d7aff22d8"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a9b02140efd49b5ac5cb4f01d7aff22d8">rotate_center</a> (const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;E)</td></tr>
<tr class="separator:a9b02140efd49b5ac5cb4f01d7aff22d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5873e9c913db461359adf4e928a3395"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#ac5873e9c913db461359adf4e928a3395">point_inside</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;r, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;aux) const =0</td></tr>
<tr class="separator:ac5873e9c913db461359adf4e928a3395"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84045e929f5d93536443e3defb909a78"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a84045e929f5d93536443e3defb909a78">point_inside</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;r) const </td></tr>
<tr class="separator:a84045e929f5d93536443e3defb909a78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3de0cabb49594eb85b5b344f4ca206a"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#ad3de0cabb49594eb85b5b344f4ca206a">density_inside</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;r, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;aux) const =0</td></tr>
<tr class="separator:ad3de0cabb49594eb85b5b344f4ca206a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86351acf111729baa92dfc2a5b659ba7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a86351acf111729baa92dfc2a5b659ba7">voxel_inside</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;r, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;aux1, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;aux2) const </td></tr>
<tr class="separator:a86351acf111729baa92dfc2a5b659ba7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a447b25305ed4c7e3e77fcb238dca6add"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a447b25305ed4c7e3e77fcb238dca6add">voxel_inside</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;r) const </td></tr>
<tr class="separator:a447b25305ed4c7e3e77fcb238dca6add"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a589dbf4e23cf03f4e4eea36b57c39cf3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a589dbf4e23cf03f4e4eea36b57c39cf3">voxel_inside_by_normalized_density</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;r, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;aux1, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;aux2) const </td></tr>
<tr class="separator:a589dbf4e23cf03f4e4eea36b57c39cf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1232deb6df56547d20f56b954a4b7e38"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a1232deb6df56547d20f56b954a4b7e38">intersects_sphere</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;r, double radius, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;aux1, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;aux2, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;aux3) const </td></tr>
<tr class="separator:a1232deb6df56547d20f56b954a4b7e38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5acc3cedbdb9dd8b5bea4285e5265ff2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a5acc3cedbdb9dd8b5bea4285e5265ff2">intersects_sphere</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;r, double radius) const </td></tr>
<tr class="separator:a5acc3cedbdb9dd8b5bea4285e5265ff2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fb35b9110971e737e132c90575671ba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFeature.html">Feature</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a8fb35b9110971e737e132c90575671ba">encircle</a> (double radius=0) const </td></tr>
<tr class="separator:a8fb35b9110971e737e132c90575671ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f1c9056e82930b80b6eddc70e9f251b"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classFeature.html">Feature</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a2f1c9056e82930b80b6eddc70e9f251b">scale</a> (double factor) const =0</td></tr>
<tr class="separator:a2f1c9056e82930b80b6eddc70e9f251b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac21e1c64ba88596e390eb35f4dc1dd31"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFeature.html">Feature</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#ac21e1c64ba88596e390eb35f4dc1dd31">background</a> (int back_mode, double back_param) const </td></tr>
<tr class="separator:ac21e1c64ba88596e390eb35f4dc1dd31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22505c1face2430b74fce3d331aeceab"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a22505c1face2430b74fce3d331aeceab">intersection</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="group__FringeProcessing.html#gad71cd7f2325be81202279ed730355092">direction</a>, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;passing_point, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;r, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a>) const =0</td></tr>
<tr class="separator:a22505c1face2430b74fce3d331aeceab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43b504e31e69cd03aa61de4916f943f2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a43b504e31e69cd03aa61de4916f943f2">intersection</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="group__FringeProcessing.html#gad71cd7f2325be81202279ed730355092">direction</a>, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;passing_point) const </td></tr>
<tr class="separator:a43b504e31e69cd03aa61de4916f943f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c5db26cf1ca5d7d818ed38f62de628b"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a9c5db26cf1ca5d7d818ed38f62de628b">volume</a> () const =0</td></tr>
<tr class="separator:a9c5db26cf1ca5d7d818ed38f62de628b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aceb596dd2b88936855a7b1d4f094c909"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#aceb596dd2b88936855a7b1d4f094c909">mean_variance_in_plane</a> (<a class="el" href="classImage.html">Image</a>&lt; double &gt; *V, double <a class="el" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>, double &amp;mean, double &amp;var)</td></tr>
<tr class="separator:aceb596dd2b88936855a7b1d4f094c909"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3ddafb2c72f4c09640e9b1881b1d6b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#ac3ddafb2c72f4c09640e9b1881b1d6b8">project_to</a> (<a class="el" href="classProjection.html">Projection</a> &amp;P, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;VP, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;PV) const </td></tr>
<tr class="separator:ac3ddafb2c72f4c09640e9b1881b1d6b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6045b395ac5dd1cb15a5a083427fd44"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#aa6045b395ac5dd1cb15a5a083427fd44">corners</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;corner1, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;corner2)</td></tr>
<tr class="separator:aa6045b395ac5dd1cb15a5a083427fd44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0d1d87a571d721c2b75023b8c63544b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#ac0d1d87a571d721c2b75023b8c63544b">draw_in</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V, int color_mode=<a class="el" href="phantom_8h.html#a02c5e2eafaed44878fd8e6c54c8dde4d">INTERNAL</a>, double colour=-1)</td></tr>
<tr class="separator:ac0d1d87a571d721c2b75023b8c63544b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af92c06440e165f40c303e893564326f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#af92c06440e165f40c303e893564326f3">sketch_in</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V, double colour=2)</td></tr>
<tr class="separator:af92c06440e165f40c303e893564326f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a747114489bb6e6fcfe2f8d196d7f6ec1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a747114489bb6e6fcfe2f8d196d7f6ec1">shift</a> (double shiftX, double shiftY, double shiftZ)</td></tr>
<tr class="separator:a747114489bb6e6fcfe2f8d196d7f6ec1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e9c3df179e1616f1fd2a897f166c7ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a7e9c3df179e1616f1fd2a897f166c7ea">selfApplyGeometry</a> (const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A)</td></tr>
<tr class="separator:a7e9c3df179e1616f1fd2a897f166c7ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89d945caba1be77294c0b911a14324e0"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a89d945caba1be77294c0b911a14324e0">feat_printf</a> (FILE *fh) const =0</td></tr>
<tr class="separator:a89d945caba1be77294c0b911a14324e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac69f549ad8ddae687fcb42f2f981832b"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#ac69f549ad8ddae687fcb42f2f981832b">feat_printm</a> (<a class="el" href="classMetaData.html">MetaData</a> &amp;MD, size_t id)=0</td></tr>
<tr class="separator:ac69f549ad8ddae687fcb42f2f981832b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade99a9be8ccf32211771399d3f9e607f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#ade99a9be8ccf32211771399d3f9e607f">readCommon</a> (char *line)</td></tr>
<tr class="separator:ade99a9be8ccf32211771399d3f9e607f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83e7afa434f27b8d408ce5eefa6b3c56"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a83e7afa434f27b8d408ce5eefa6b3c56">readCommon</a> (<a class="el" href="classMDRow.html">MDRow</a> &amp;row)</td></tr>
<tr class="separator:a83e7afa434f27b8d408ce5eefa6b3c56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1843de345993d7491c653d769ee029b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a1843de345993d7491c653d769ee029b6">read</a> (<a class="el" href="classMDRow.html">MDRow</a> &amp;row)</td></tr>
<tr class="separator:a1843de345993d7491c653d769ee029b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd3167f4a843950a74b48e13af71fc3f"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#acd3167f4a843950a74b48e13af71fc3f">read_specific</a> (const std::vector&lt; double &gt; &amp;vector)=0</td></tr>
<tr class="separator:acd3167f4a843950a74b48e13af71fc3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:abaec53ba8fbe169f88bfeb526d56f7a5"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Type</a></td></tr>
<tr class="separator:abaec53ba8fbe169f88bfeb526d56f7a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ca340a4eb8c5da25ffe1ab3958e1548"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a7ca340a4eb8c5da25ffe1ab3958e1548">Add_Assign</a></td></tr>
<tr class="separator:a7ca340a4eb8c5da25ffe1ab3958e1548"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cef017ac20ba675d36573449b186579"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a2cef017ac20ba675d36573449b186579">Density</a></td></tr>
<tr class="separator:a2cef017ac20ba675d36573449b186579"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45423ae0a78ea69cbf18bf69ebd13119"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a></td></tr>
<tr class="separator:a45423ae0a78ea69cbf18bf69ebd13119"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6171dbc2a0f64c2b7c31fb91573a75c1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">max_distance</a></td></tr>
<tr class="separator:a6171dbc2a0f64c2b7c31fb91573a75c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a1f194860a9611e66a9a1cd196a9ad469"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFeature.html#a1f194860a9611e66a9a1cd196a9ad469">operator&lt;&lt;</a> (std::ostream &amp;o, const <a class="el" href="classFeature.html">Feature</a> *F)</td></tr>
<tr class="separator:a1f194860a9611e66a9a1cd196a9ad469"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classFeature.html">Feature</a> superclass. This is a superclass from which all features (cones, cylinders, ...) inherit. It contains all general information common to all feature classes, then the subclasses give the specific parameters for the feature. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l00087">87</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a8b8eb9bc2f3759db4f200b37336825c3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual Feature::~Feature </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="phantom_8h_source.html#l00123">123</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    {}</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ae2b730e0b4547bcfb383b243aa868136"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Feature::assign </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFeature.html">Feature</a> &amp;&#160;</td>
          <td class="paramname"><em>F</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Another function for assigmnet. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l00101">101</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;{</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    *<span class="keyword">this</span> = F;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac21e1c64ba88596e390eb35f4dc1dd31"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classFeature.html">Feature</a> * Feature::background </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>back_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>back_param</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a pointer to a feature which is the background of the actual one. You can specify two ways of computing the background, either as a sphere surrounding the feature or as an enlarged version of the feature. This is chosen giving the modes ENLARGE_MODE or SPHERE_MODE. Depending on the mode used the background parameter is understood as the sphere radius or as the scaling factor. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l01736">1736</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;{</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    <span class="keywordflow">switch</span> (back_mode)</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    {</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="phantom_8h.html#a998496c86f8d49e9d848ddc55fa6bbcb">ENLARGE_MODE</a>:</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classFeature.html#a2f1c9056e82930b80b6eddc70e9f251b">scale</a>(back_param);</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="phantom_8h.html#a1242150e0e467ff2ad9b8286ac8789ee">SPHERE_MODE</a>:</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classFeature.html#a8fb35b9110971e737e132c90575671ba">encircle</a>(back_param);</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a>, <span class="stringliteral">&quot;Feature::background: mode not supported&quot;</span>);</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    }</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="phantom_8h_html_a998496c86f8d49e9d848ddc55fa6bbcb"><div class="ttname"><a href="phantom_8h.html#a998496c86f8d49e9d848ddc55fa6bbcb">ENLARGE_MODE</a></div><div class="ttdeci">#define ENLARGE_MODE</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00245">phantom.h:245</a></div></div>
<div class="ttc" id="classFeature_html_a8fb35b9110971e737e132c90575671ba"><div class="ttname"><a href="classFeature.html#a8fb35b9110971e737e132c90575671ba">Feature::encircle</a></div><div class="ttdeci">Feature * encircle(double radius=0) const </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l01718">phantom.cpp:1718</a></div></div>
<div class="ttc" id="classFeature_html_a2f1c9056e82930b80b6eddc70e9f251b"><div class="ttname"><a href="classFeature.html#a2f1c9056e82930b80b6eddc70e9f251b">Feature::scale</a></div><div class="ttdeci">virtual Feature * scale(double factor) const =0</div></div>
<div class="ttc" id="phantom_8h_html_a1242150e0e467ff2ad9b8286ac8789ee"><div class="ttname"><a href="phantom_8h.html#a1242150e0e467ff2ad9b8286ac8789ee">SPHERE_MODE</a></div><div class="ttdeci">#define SPHERE_MODE</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00246">phantom.h:246</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a></div><div class="ttdoc">Incorrect value received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00200">xmipp_error.h:200</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa6045b395ac5dd1cb15a5a083427fd44"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Feature::corners </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>corner1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>corner2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Define 3D corners for a feature. This function returns two Z3 points where the feature is confined. The volume borders are taken into account and you might make a for using these two values like this: \Ex: </p><div class="fragment"><div class="line">F.corners(V,corner1,corner2);</div><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>=<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner1); <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>&lt;=<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner2); <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>++)</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;=<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;=<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++) {</div><div class="line">            ...</div><div class="line">}</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l01050">1050</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;{</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    corner1.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(3);</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    corner2.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(3);</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1) = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(<a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>) - <a class="code" href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">max_distance</a>), <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(V));</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1) = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(<a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>) - <a class="code" href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">max_distance</a>), <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(V));</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner1) = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(<a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>) - <a class="code" href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">max_distance</a>), <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(V));</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2) = <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(<a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>) + <a class="code" href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">max_distance</a>), <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(V));</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2) = <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(<a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>) + <a class="code" href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">max_distance</a>), <a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(V));</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner2) = <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(<a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>) + <a class="code" href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">max_distance</a>), <a class="code" href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(V));</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;}</div><div class="ttc" id="group__Macros_html_gae0a4180e923e3ffca3989e20e441aa3c"><div class="ttname"><a href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a></div><div class="ttdeci">#define XMIPP_MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00193">xmipp_macros.h:193</a></div></div>
<div class="ttc" id="classFeature_html_a45423ae0a78ea69cbf18bf69ebd13119"><div class="ttname"><a href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Feature::Center</a></div><div class="ttdeci">Matrix1D&lt; double &gt; Center</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00113">phantom.h:113</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga706d2ce724d393d4d759a46225bbc6c1"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a></div><div class="ttdeci">#define FINISHINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00081">multidim_array.h:81</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00065">multidim_array.h:65</a></div></div>
<div class="ttc" id="group__Macros_html_ga2f0eecb0f7856721f56faff8f27b0dc1"><div class="ttname"><a href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a></div><div class="ttdeci">#define FLOOR(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00240">xmipp_macros.h:240</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="classMatrix1D_html_a79a482948ae334cbefaef7c7839cd934"><div class="ttname"><a href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">Matrix1D::resize</a></div><div class="ttdeci">void resize(size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00451">matrix1d.h:451</a></div></div>
<div class="ttc" id="group__Macros_html_gac9ae6a207f10c821b06a8c0df153a7d5"><div class="ttname"><a href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a></div><div class="ttdeci">#define XMIPP_MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00181">xmipp_macros.h:181</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="classFeature_html_a6171dbc2a0f64c2b7c31fb91573a75c1"><div class="ttname"><a href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">Feature::max_distance</a></div><div class="ttdeci">double max_distance</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00120">phantom.h:120</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00073">multidim_array.h:73</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad3de0cabb49594eb85b5b344f4ca206a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double Feature::density_inside </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>aux</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Speeded up density inside a feature, VIRTUAL!!. This function MUST be implemented for each subclass with NON constant density as blobs and tells you if a point is inside the feature or not plus give you information about the density of the feature at that point. If the point is inside returns 1 multiplied by the density of the NORMALIZED feature and if not, returns 0. The point is given in the vector r, and aux is an auxiliar vector with dimension 3 (must be externally resized) used to do some computations. This auxiliar vector must be supplied in order to gain speed as no memory allocating and freeing is needed. </p>

<p>Implemented in <a class="el" href="classCone.html#ae0067f5f69f88d58adb70da753a495c7">Cone</a>, <a class="el" href="classEllipsoid.html#a8212cac7bd708d17d63a2acd1930a7c7">Ellipsoid</a>, <a class="el" href="classCube.html#a212b748fad93c35d2bd92ab4b0f58c64">Cube</a>, <a class="el" href="classDCylinder.html#a4e5d38ffafe33f94c89d82c85def8990">DCylinder</a>, <a class="el" href="classCylinder.html#a469c56e2eee95279f22113e5cc843006">Cylinder</a>, <a class="el" href="classGaussian.html#acb4922e4c01404fdbdfb355e0dac19a8">Gaussian</a>, <a class="el" href="classBlob.html#ac8824826aeb174e873c838464f91933b">Blob</a>, and <a class="el" href="classSphere.html#a9741b622bd8228d56ea9d8584c7d99d1">Sphere</a>.</p>

</div>
</div>
<a class="anchor" id="ac0d1d87a571d721c2b75023b8c63544b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Feature::draw_in </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>color_mode</em> = <code><a class="el" href="phantom_8h.html#a02c5e2eafaed44878fd8e6c54c8dde4d">INTERNAL</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>colour</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Draw a feature in a Volume. This function draws a feature in a volume (*V). The word "colour" is a little misleading as the colour really refers to a grey-level global density. Ie, the default mode (INTERNAL) draws the feature with its own density and discards the "colour" given in the function call. However, you may change this colour, set a new global density and draw the volume with this given density. This option is useful to generate easily a labelled volume.</p>
<p>The Add-Assign behaviour is the one of the feature if the colour is internally defined, or Assign if the colour is externally given. In the assign behaviour a voxel value is assigned to the volume if the voxel there is smaller than the value we pretend to assign.</p>
<p>A voxel is drawn with a colour proportional to the number of Vertex inside the features. The volume is not cleaned at the beginning. \ Ex: </p><div class="fragment"><div class="line"><a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>.draw_in(V)              --&gt; Internal density</div><div class="line"><a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>.draw_in(V,<a class="code" href="phantom_8h.html#a02c5e2eafaed44878fd8e6c54c8dde4d">INTERNAL</a>,0.5) --&gt; Internal density, 0.5 is discarded</div><div class="line"><a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>.draw_in(V,<a class="code" href="phantom_8h.html#af3fe37c1cda80aa7202b5a3bb7557dc9">EXTERNAL</a>,0.5) --&gt; External density=0.5</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l01066">1066</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;{</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a>   aux1(3), aux2(3), corner1(3), corner2(3), r(3);</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="keywordtype">int</span>               add;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="keywordtype">double</span>             inside;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="keywordtype">double</span>             final_colour;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="keywordflow">if</span> (colour_mode == <a class="code" href="phantom_8h.html#a02c5e2eafaed44878fd8e6c54c8dde4d">INTERNAL</a>)</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    {</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        final_colour = <a class="code" href="classFeature.html#a2cef017ac20ba675d36573449b186579">Density</a>;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        add = <a class="code" href="classFeature.html#a7ca340a4eb8c5da25ffe1ab3958e1548">Add_Assign</a> == <span class="charliteral">&#39;+&#39;</span>;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    }</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    {</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        final_colour = colour;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        add = 0;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    }</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <a class="code" href="classFeature.html#aa6045b395ac5dd1cb15a5a083427fd44">corners</a>(V, corner1, corner2);</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Drawing \n&quot;</span>;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    std::cout &lt;&lt; <span class="keyword">this</span>;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;colour_mode=&quot;</span> &lt;&lt; colour_mode &lt;&lt; std::endl;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Add_Assign= &quot;</span> &lt;&lt; <a class="code" href="classFeature.html#a7ca340a4eb8c5da25ffe1ab3958e1548">Add_Assign</a>  &lt;&lt; std::endl;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;add=        &quot;</span> &lt;&lt; add         &lt;&lt; std::endl;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;   Corner 1&quot;</span> &lt;&lt; corner1.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;   Corner 2&quot;</span> &lt;&lt; corner2.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gacf49ec8e8432f65baabc829653497e12">FOR_ALL_ELEMENTS_IN_ARRAY3D_BETWEEN</a>(corner1, corner2)</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    {</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        inside = <a class="code" href="classFeature.html#a589dbf4e23cf03f4e4eea36b57c39cf3">voxel_inside_by_normalized_density</a>(r, aux1, aux2);</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        <span class="comment">//int condition=(ZZ(r)==-12) &amp;&amp; (YY(r)==1);</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        <span class="keywordtype">int</span> condition = 1;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;   r=&quot;</span> &lt;&lt; r.transpose() &lt;&lt; <span class="stringliteral">&quot; inside= &quot;</span> &lt;&lt; inside;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <span class="keywordflow">if</span> (inside != 0)</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        {</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            <span class="keywordtype">double</span> drawing_colour = final_colour * inside / 8;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            <span class="keywordflow">if</span> (add)</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                <a class="code" href="phantom_8cpp.html#acf63a6f40288d76c46a529633b4fa875">Vr</a> += drawing_colour;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                <a class="code" href="phantom_8cpp.html#acf63a6f40288d76c46a529633b4fa875">Vr</a>  = drawing_colour; <span class="comment">// It does not select the maximum between Vr and drawing_colour anymore -&gt; it fails when adding less dense features</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;   V(r)=&quot;</span> &lt;&lt; <a class="code" href="group__Images.html#ga9b8f3c798427474abfd9070b6f482249">VOLVOXEL</a>(V, (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r), (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r), (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r));</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        }</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;            std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    }</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;}</div><div class="ttc" id="group__Images_html_ga9b8f3c798427474abfd9070b6f482249"><div class="ttname"><a href="group__Images.html#ga9b8f3c798427474abfd9070b6f482249">VOLVOXEL</a></div><div class="ttdeci">#define VOLVOXEL(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00204">xmipp_image_base.h:204</a></div></div>
<div class="ttc" id="classFeature_html_aa6045b395ac5dd1cb15a5a083427fd44"><div class="ttname"><a href="classFeature.html#aa6045b395ac5dd1cb15a5a083427fd44">Feature::corners</a></div><div class="ttdeci">void corners(const MultidimArray&lt; double &gt; &amp;V, Matrix1D&lt; double &gt; &amp;corner1, Matrix1D&lt; double &gt; &amp;corner2)</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l01050">phantom.cpp:1050</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gacf49ec8e8432f65baabc829653497e12"><div class="ttname"><a href="group__MultidimensionalArrays.html#gacf49ec8e8432f65baabc829653497e12">FOR_ALL_ELEMENTS_IN_ARRAY3D_BETWEEN</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D_BETWEEN(corner1, corner2)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00455">multidim_array.h:455</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="phantom_8cpp_html_acf63a6f40288d76c46a529633b4fa875"><div class="ttname"><a href="phantom_8cpp.html#acf63a6f40288d76c46a529633b4fa875">Vr</a></div><div class="ttdeci">#define Vr</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l01065">phantom.cpp:1065</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classFeature_html_a2cef017ac20ba675d36573449b186579"><div class="ttname"><a href="classFeature.html#a2cef017ac20ba675d36573449b186579">Feature::Density</a></div><div class="ttdeci">double Density</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00108">phantom.h:108</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="classFeature_html_a589dbf4e23cf03f4e4eea36b57c39cf3"><div class="ttname"><a href="classFeature.html#a589dbf4e23cf03f4e4eea36b57c39cf3">Feature::voxel_inside_by_normalized_density</a></div><div class="ttdeci">double voxel_inside_by_normalized_density(const Matrix1D&lt; double &gt; &amp;r, Matrix1D&lt; double &gt; &amp;aux1, Matrix1D&lt; double &gt; &amp;aux2) const </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l00971">phantom.cpp:971</a></div></div>
<div class="ttc" id="phantom_8h_html_a02c5e2eafaed44878fd8e6c54c8dde4d"><div class="ttname"><a href="phantom_8h.html#a02c5e2eafaed44878fd8e6c54c8dde4d">INTERNAL</a></div><div class="ttdeci">#define INTERNAL</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00326">phantom.h:326</a></div></div>
<div class="ttc" id="classFeature_html_a7ca340a4eb8c5da25ffe1ab3958e1548"><div class="ttname"><a href="classFeature.html#a7ca340a4eb8c5da25ffe1ab3958e1548">Feature::Add_Assign</a></div><div class="ttdeci">char Add_Assign</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00102">phantom.h:102</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8fb35b9110971e737e132c90575671ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classFeature.html">Feature</a> * Feature::encircle </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em> = <code>0</code></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Produce a sphere envolving the feature. This function returns a pointer to a feature (a sphere) with the same center, density, and feature behaviour as the given feature. The radius could be given in voxel units or if you leave it 0 then the radius is computed as 1.5 times the <a class="el" href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">max_distance</a> of this feature </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l01718">1718</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;{</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <a class="code" href="classSphere.html">Sphere</a> *<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>;</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    f = <span class="keyword">new</span> <a class="code" href="classSphere.html">Sphere</a>;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    <span class="keywordflow">if</span> (radius == 0)</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        radius = 1.5 * <a class="code" href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">max_distance</a>;</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    f-&gt;<a class="code" href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Type</a>         = <span class="stringliteral">&quot;sph&quot;</span>;</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    f-&gt;<a class="code" href="classFeature.html#a7ca340a4eb8c5da25ffe1ab3958e1548">Add_Assign</a>   = <a class="code" href="classFeature.html#a7ca340a4eb8c5da25ffe1ab3958e1548">Add_Assign</a>;</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    f-&gt;<a class="code" href="classFeature.html#a2cef017ac20ba675d36573449b186579">Density</a>      = <a class="code" href="classFeature.html#a2cef017ac20ba675d36573449b186579">Density</a>;</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    f-&gt;<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>       = <a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    f-&gt;<a class="code" href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">max_distance</a> = radius;</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    f-&gt;<a class="code" href="classSphere.html#a45d6c6c870fac7c2a885ad2e226334ad">radius</a>       = radius;</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="classFeature.html">Feature</a> *)<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;}</div><div class="ttc" id="classSphere_html_a45d6c6c870fac7c2a885ad2e226334ad"><div class="ttname"><a href="classSphere.html#a45d6c6c870fac7c2a885ad2e226334ad">Sphere::radius</a></div><div class="ttdeci">double radius</div><div class="ttdoc">Sphere radius. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00477">phantom.h:477</a></div></div>
<div class="ttc" id="classFeature_html_a45423ae0a78ea69cbf18bf69ebd13119"><div class="ttname"><a href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Feature::Center</a></div><div class="ttdeci">Matrix1D&lt; double &gt; Center</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00113">phantom.h:113</a></div></div>
<div class="ttc" id="classFeature_html_abaec53ba8fbe169f88bfeb526d56f7a5"><div class="ttname"><a href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Feature::Type</a></div><div class="ttdeci">std::string Type</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00095">phantom.h:95</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a633de4b0c14ca52ea2432a3c8a5c4c31"><div class="ttname"><a href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a></div><div class="ttdeci">double * f</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04431">numerical_recipes.cpp:4431</a></div></div>
<div class="ttc" id="classFeature_html"><div class="ttname"><a href="classFeature.html">Feature</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00087">phantom.h:87</a></div></div>
<div class="ttc" id="classFeature_html_a6171dbc2a0f64c2b7c31fb91573a75c1"><div class="ttname"><a href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">Feature::max_distance</a></div><div class="ttdeci">double max_distance</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00120">phantom.h:120</a></div></div>
<div class="ttc" id="classSphere_html"><div class="ttname"><a href="classSphere.html">Sphere</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00473">phantom.h:473</a></div></div>
<div class="ttc" id="classFeature_html_a2cef017ac20ba675d36573449b186579"><div class="ttname"><a href="classFeature.html#a2cef017ac20ba675d36573449b186579">Feature::Density</a></div><div class="ttdeci">double Density</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00108">phantom.h:108</a></div></div>
<div class="ttc" id="classFeature_html_a7ca340a4eb8c5da25ffe1ab3958e1548"><div class="ttname"><a href="classFeature.html#a7ca340a4eb8c5da25ffe1ab3958e1548">Feature::Add_Assign</a></div><div class="ttdeci">char Add_Assign</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00102">phantom.h:102</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a89d945caba1be77294c0b911a14324e0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void Feature::feat_printf </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fh</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Print the feature in the <a class="el" href="classFeature.html">Feature</a> format, VIRTUAL!!!. This function prints the feature in the Standard <a class="el" href="classFeature.html">Feature</a> format (readable by this library). Notice that the standard format is different for each specific feature. See <a class="el" href="group__Phantoms.html">Phantoms</a> for more information about the supported file format. </p>

<p>Implemented in <a class="el" href="classCone.html#a776a4b5ec72c041fb29eecfa50c30bbb">Cone</a>, <a class="el" href="classEllipsoid.html#aa0e30c327f11c4c8d63b7d0b554e621a">Ellipsoid</a>, <a class="el" href="classCube.html#ab5c96e1ce556e60195f83860bbd8a4a0">Cube</a>, <a class="el" href="classDCylinder.html#a00c75be73fb720f1dd78a76c6cfcaea1">DCylinder</a>, <a class="el" href="classCylinder.html#ac54b0cae09a14b3132a94264184befad">Cylinder</a>, <a class="el" href="classGaussian.html#a71fb6f8e629b623549a0773488d718c7">Gaussian</a>, <a class="el" href="classBlob.html#ae4a823e90239b33b03e47911f8b79200">Blob</a>, and <a class="el" href="classSphere.html#ad693b5181af61744ed72acb637f7dabc">Sphere</a>.</p>

</div>
</div>
<a class="anchor" id="ac69f549ad8ddae687fcb42f2f981832b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void Feature::feat_printm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMetaData.html">MetaData</a> &amp;&#160;</td>
          <td class="paramname"><em>MD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classCone.html#a5ea193ab7dcf761c191644e5017f6a51">Cone</a>, <a class="el" href="classEllipsoid.html#ab16e3229cdea09237b43044336dd9b32">Ellipsoid</a>, <a class="el" href="classCube.html#af1fcc4a26fa286f82d27170a4aa8fa19">Cube</a>, <a class="el" href="classDCylinder.html#a77ec713babd4dbb146c960e6c1e08986">DCylinder</a>, <a class="el" href="classCylinder.html#a99883fb5b6529ad33bee18890b1eaae4">Cylinder</a>, <a class="el" href="classGaussian.html#a482e23a74b1719dc8d182fe5e77921b6">Gaussian</a>, <a class="el" href="classBlob.html#ae0376e3ef93c61fb3f7a97231872ab0a">Blob</a>, and <a class="el" href="classSphere.html#a855b5c999c19ef04c1f1d1151fb83bbb">Sphere</a>.</p>

</div>
</div>
<a class="anchor" id="a22505c1face2430b74fce3d331aeceab"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double Feature::intersection </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>passing_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Speeded Up intersection of a feature with a ray, VIRTUAL!!!. This function returns the length of the intersection between the ray defined by its direction and a passing point and the actual feature (whose center and dimensions are known by itself).</p>
<p>r and u are auxiliar vectors of dimension 3, they must be supplied in order to gain speed. r is the passing point expressed in the feature coordinate system, and u is the direction in the same coordinate system. </p>

<p>Implemented in <a class="el" href="classCone.html#ac63fd9138e49b2bf75ede6d2a8a046aa">Cone</a>, <a class="el" href="classEllipsoid.html#a10e92da194091eddbc5a2ff0660f70aa">Ellipsoid</a>, <a class="el" href="classCube.html#a10c98844709a3a0354337912e2caa88c">Cube</a>, <a class="el" href="classDCylinder.html#ad399207ca2ec87cf7844a717b5b1e01f">DCylinder</a>, <a class="el" href="classCylinder.html#a1de2a6f65833918f8a5875670ade0448">Cylinder</a>, <a class="el" href="classGaussian.html#a38b5029d1c4ce97eb8cf2bbffb67dbc2">Gaussian</a>, <a class="el" href="classBlob.html#af8457d914454613a3a6cbf06e6cb0902">Blob</a>, and <a class="el" href="classSphere.html#a6bccd74d8b60e2f0860c7a92f877416c">Sphere</a>.</p>

</div>
</div>
<a class="anchor" id="a43b504e31e69cd03aa61de4916f943f2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double Feature::intersection </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>passing_point</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Intersection of a feature with a ray. This function does the same as the previous one but you needn't provide extra auxiliar vectors. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l00271">271</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> r(3), <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a>(3);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classFeature.html#a22505c1face2430b74fce3d331aeceab">intersection</a>(direction, passing_point, r, <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a>);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    }</div><div class="ttc" id="classFeature_html_a22505c1face2430b74fce3d331aeceab"><div class="ttname"><a href="classFeature.html#a22505c1face2430b74fce3d331aeceab">Feature::intersection</a></div><div class="ttdeci">virtual double intersection(const Matrix1D&lt; double &gt; &amp;direction, const Matrix1D&lt; double &gt; &amp;passing_point, Matrix1D&lt; double &gt; &amp;r, Matrix1D&lt; double &gt; &amp;u) const =0</div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a6277e2a7446059985dc9bcf0a4ac1a8f"><div class="ttname"><a href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a></div><div class="ttdeci">doublereal * u</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1232deb6df56547d20f56b954a4b7e38"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Feature::intersects_sphere </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>aux1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>aux2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>aux3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Speeded up sphere intersecting feature. This function returns TRUE if a sphere of a given radius has any voxel inside this feature. r is the center of the sphere in R3. This speeded up function needs two vectors with dimension 3 externally resized. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l01027">1027</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;{</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordtype">double</span> radius2 = radius * radius;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="keywordtype">bool</span> intersects = <span class="keyword">false</span>;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> = <a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r) - radius); <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> &lt;= <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r) + radius) &amp;&amp; !intersects; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>++)</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">double</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = <a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r) - radius); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r) + radius) &amp;&amp; !intersects; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">double</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = <a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r) - radius); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt;= <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r) + radius) &amp;&amp; !intersects; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;            {</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                <span class="keywordflow">if</span> ((<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r))*(<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r)) + (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r))*(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r)) + (<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r))*(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r)) &gt;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                    radius2)</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(aux3, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>);</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                intersects = <a class="code" href="classFeature.html#a86351acf111729baa92dfc2a5b659ba7">voxel_inside</a>(aux3, aux1, aux2);</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            }</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="keywordflow">return</span> intersects;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;}</div><div class="ttc" id="classFeature_html_a86351acf111729baa92dfc2a5b659ba7"><div class="ttname"><a href="classFeature.html#a86351acf111729baa92dfc2a5b659ba7">Feature::voxel_inside</a></div><div class="ttdeci">int voxel_inside(const Matrix1D&lt; double &gt; &amp;r, Matrix1D&lt; double &gt; &amp;aux1, Matrix1D&lt; double &gt; &amp;aux2) const </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l00936">phantom.cpp:936</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Macros_html_ga2f0eecb0f7856721f56faff8f27b0dc1"><div class="ttname"><a href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a></div><div class="ttdeci">#define FLOOR(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00240">xmipp_macros.h:240</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="group__Vectors_html_ga6c6b4d4f88daca5e1d8e171bec3b4af0"><div class="ttname"><a href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a></div><div class="ttdeci">#define VECTOR_R3(v, x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00127">matrix1d.h:127</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5acc3cedbdb9dd8b5bea4285e5265ff2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Feature::intersects_sphere </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p><a class="el" href="classSphere.html">Sphere</a> intersecting feature. This function is based in the previous one. It makes the same but you needn't supply the auxiliar vectors. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l00221">221</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    {</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> aux1(3), aux2(3), aux3(3);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classFeature.html#a1232deb6df56547d20f56b954a4b7e38">intersects_sphere</a>(r, radius, aux1, aux2, aux3);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div><div class="ttc" id="classFeature_html_a1232deb6df56547d20f56b954a4b7e38"><div class="ttname"><a href="classFeature.html#a1232deb6df56547d20f56b954a4b7e38">Feature::intersects_sphere</a></div><div class="ttdeci">int intersects_sphere(const Matrix1D&lt; double &gt; &amp;r, double radius, Matrix1D&lt; double &gt; &amp;aux1, Matrix1D&lt; double &gt; &amp;aux2, Matrix1D&lt; double &gt; &amp;aux3) const </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l01027">phantom.cpp:1027</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aceb596dd2b88936855a7b1d4f094c909"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Feature::mean_variance_in_plane </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classImage.html">Image</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>mean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>var</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Mean and variance in a given plane. Given a plane z=z0, this function returns the mean and variance values of the volume (*V) in the voxels inside this feature. A voxel is considered to belong to the feature if it is totally inside the feature. If the plane is outside the volume scope the result is mean=variance=0 </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02003">2003</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;{</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    <span class="keywordtype">double</span> sum1 = 0;</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    <span class="keywordtype">double</span> sum2 = 0;</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    <span class="keywordtype">double</span> no_points = 0;</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> r(3), aux1(3), aux2(3);</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    mean = 0;</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    var = 0;</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(<a class="code" href="group__Images.html#ga3f9407185c0caa54804ad3ad7be036b4">VOLMATRIX</a>(*V)) || <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> &gt; <a class="code" href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(<a class="code" href="group__Images.html#ga3f9407185c0caa54804ad3ad7be036b4">VOLMATRIX</a>(*V)))</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r) = <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>;</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r) = <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(<a class="code" href="group__Images.html#ga3f9407185c0caa54804ad3ad7be036b4">VOLMATRIX</a>(*V)); <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r) &lt;= <a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(<a class="code" href="group__Images.html#ga3f9407185c0caa54804ad3ad7be036b4">VOLMATRIX</a>(*V)); <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r)++)</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r) = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(<a class="code" href="group__Images.html#ga3f9407185c0caa54804ad3ad7be036b4">VOLMATRIX</a>(*V)); <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r) &lt;= <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(<a class="code" href="group__Images.html#ga3f9407185c0caa54804ad3ad7be036b4">VOLMATRIX</a>(*V)); <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r)++)</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;        {</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classFeature.html#a86351acf111729baa92dfc2a5b659ba7">voxel_inside</a>(r, aux1, aux2) == 8)</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;            {</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;                <span class="keywordtype">double</span> voxel = <a class="code" href="group__Images.html#ga9b8f3c798427474abfd9070b6f482249">VOLVOXEL</a>(*V, (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r), (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r), (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r));</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;                sum1 += voxel;</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                sum2 += voxel * voxel;</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;                no_points++;</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;            }</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;        }</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    <span class="keywordflow">if</span> (no_points != 0)</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    {</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;        mean = sum1 / no_points;</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        var  = sum2 / no_points - mean * mean;</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    }</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;}</div><div class="ttc" id="classFeature_html_a86351acf111729baa92dfc2a5b659ba7"><div class="ttname"><a href="classFeature.html#a86351acf111729baa92dfc2a5b659ba7">Feature::voxel_inside</a></div><div class="ttdeci">int voxel_inside(const Matrix1D&lt; double &gt; &amp;r, Matrix1D&lt; double &gt; &amp;aux1, Matrix1D&lt; double &gt; &amp;aux2) const </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l00936">phantom.cpp:936</a></div></div>
<div class="ttc" id="group__Images_html_ga9b8f3c798427474abfd9070b6f482249"><div class="ttname"><a href="group__Images.html#ga9b8f3c798427474abfd9070b6f482249">VOLVOXEL</a></div><div class="ttdeci">#define VOLVOXEL(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00204">xmipp_image_base.h:204</a></div></div>
<div class="ttc" id="group__Images_html_ga3f9407185c0caa54804ad3ad7be036b4"><div class="ttname"><a href="group__Images.html#ga3f9407185c0caa54804ad3ad7be036b4">VOLMATRIX</a></div><div class="ttdeci">#define VOLMATRIX(V)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00158">xmipp_image_base.h:158</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga706d2ce724d393d4d759a46225bbc6c1"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a></div><div class="ttdeci">#define FINISHINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00081">multidim_array.h:81</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00065">multidim_array.h:65</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aa508e3dbd0e86258b5c69e8a8b6b8295"><div class="ttname"><a href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08509">numerical_recipes.cpp:8509</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00073">multidim_array.h:73</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af12ffde77862ccfa8f05edcf83318abe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classFeature.html">Feature</a> &amp; Feature::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFeature.html">Feature</a> &amp;&#160;</td>
          <td class="paramname"><em>F</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assignment. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l00089">89</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;{</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">this</span> == &amp;F)</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Type</a>         = F.<a class="code" href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Type</a>;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="classFeature.html#a7ca340a4eb8c5da25ffe1ab3958e1548">Add_Assign</a>   = F.<a class="code" href="classFeature.html#a7ca340a4eb8c5da25ffe1ab3958e1548">Add_Assign</a>;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="classFeature.html#a2cef017ac20ba675d36573449b186579">Density</a>      = F.<a class="code" href="classFeature.html#a2cef017ac20ba675d36573449b186579">Density</a>;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>       = F.<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">max_distance</a> = F.<a class="code" href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">max_distance</a>;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;}</div><div class="ttc" id="classFeature_html_a45423ae0a78ea69cbf18bf69ebd13119"><div class="ttname"><a href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Feature::Center</a></div><div class="ttdeci">Matrix1D&lt; double &gt; Center</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00113">phantom.h:113</a></div></div>
<div class="ttc" id="classFeature_html_abaec53ba8fbe169f88bfeb526d56f7a5"><div class="ttname"><a href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Feature::Type</a></div><div class="ttdeci">std::string Type</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00095">phantom.h:95</a></div></div>
<div class="ttc" id="classFeature_html_a6171dbc2a0f64c2b7c31fb91573a75c1"><div class="ttname"><a href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">Feature::max_distance</a></div><div class="ttdeci">double max_distance</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00120">phantom.h:120</a></div></div>
<div class="ttc" id="classFeature_html_a2cef017ac20ba675d36573449b186579"><div class="ttname"><a href="classFeature.html#a2cef017ac20ba675d36573449b186579">Feature::Density</a></div><div class="ttdeci">double Density</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00108">phantom.h:108</a></div></div>
<div class="ttc" id="classFeature_html_a7ca340a4eb8c5da25ffe1ab3958e1548"><div class="ttname"><a href="classFeature.html#a7ca340a4eb8c5da25ffe1ab3958e1548">Feature::Add_Assign</a></div><div class="ttdeci">char Add_Assign</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00102">phantom.h:102</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac5873e9c913db461359adf4e928a3395"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int Feature::point_inside </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>aux</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Speeded up point inside a feature, VIRTUAL!!. This function MUST be implemented for each subclass and tells you if a point is inside the feature or not. If the point is inside returns 1 and if not, returns 0. The point is given in the vector r, and aux is an auxiliar vector with dimension 3 (must be externally resized) used to do some computations. This auxiliar vector must be supplied in order to gain speed as no memory allocating and freeing is needed. </p>

<p>Implemented in <a class="el" href="classCone.html#a95ee9c17466223262e1e33dcfd0cb1da">Cone</a>, <a class="el" href="classEllipsoid.html#a21ecc6f1f34389a715ba3390d65653f3">Ellipsoid</a>, <a class="el" href="classCube.html#a400ddf752a005fb58ded557936e0705f">Cube</a>, <a class="el" href="classDCylinder.html#a3ae99c62f5da034e91ecf73dc8a716ee">DCylinder</a>, <a class="el" href="classCylinder.html#a519d31de99a78f4a492c760d41c0bc20">Cylinder</a>, <a class="el" href="classGaussian.html#a35cae4a0015af8aaff4d53becee88d9c">Gaussian</a>, <a class="el" href="classBlob.html#a7e1b66601b69074da2c91942e5cc29cd">Blob</a>, and <a class="el" href="classSphere.html#a075dad5d3545e05e394789f1779b004d">Sphere</a>.</p>

</div>
</div>
<a class="anchor" id="a84045e929f5d93536443e3defb909a78"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Feature::point_inside </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p><a class="el" href="structPoint.html">Point</a> inside a feature. This function is based in the previous one. It makes the same but you needn't supply the auxiliar vector. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l00160">160</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> aux(3);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classFeature.html#ac5873e9c913db461359adf4e928a3395">point_inside</a>(r, aux);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    }</div><div class="ttc" id="classFeature_html_ac5873e9c913db461359adf4e928a3395"><div class="ttname"><a href="classFeature.html#ac5873e9c913db461359adf4e928a3395">Feature::point_inside</a></div><div class="ttdeci">virtual int point_inside(const Matrix1D&lt; double &gt; &amp;r, Matrix1D&lt; double &gt; &amp;aux) const =0</div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acfc109c7db1e18439d93e4bf56260e09"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void Feature::prepare </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Prepare feature for work. This function computes the maximum distance and possibly the <a class="el" href="classEuler.html">Euler</a> and inverse <a class="el" href="classEuler.html">Euler</a> matrices. </p>

<p>Implemented in <a class="el" href="classCone.html#a5d4c7663ac6aab8c3f19b82c182c32bb">Cone</a>, <a class="el" href="classEllipsoid.html#a5a1ff53cbbbb4b51aeae6be7ff660b60">Ellipsoid</a>, <a class="el" href="classCube.html#a4e6254f3343eeb377e60297eeee6c75a">Cube</a>, <a class="el" href="classDCylinder.html#a6a393f2cb726b31e00d4d4e3b7cb7d56">DCylinder</a>, <a class="el" href="classCylinder.html#acae1af3d90b0b22d975613491306da5a">Cylinder</a>, <a class="el" href="classGaussian.html#a06e63a884493d3fd1da88aa6e0b40c3e">Gaussian</a>, <a class="el" href="classBlob.html#ad6f639e88175561bb575fb38373246fd">Blob</a>, and <a class="el" href="classSphere.html#a13a4794da6b7099369c6e691fff7a289">Sphere</a>.</p>

</div>
</div>
<a class="anchor" id="ac3ddafb2c72f4c09640e9b1881b1d6b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Feature::project_to </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>VP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>PV</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Project feature onto a projection plane. <a class="el" href="classProjection.html">Projection</a> is a class itself which has got inside the direction of projection. The projection plane is not cleaned (set all values to 0) when entering this function, but the projection of this feature is added to the already stored one. The projection plane is supposed to have its logical origin in the right place (normally, the middle of the image) before entering the function. An oversampling technique is used in order to produce better projections, the projection in one pixel is computed from the value of 4 points near the pixel, you can modify the subsampling value (actually 2x2=4) by changing a constant at the beginning of the function.</p>
<p>The matrix VP (3x3) is used to define how to relate a point in the 3D universal coordinate to the projection plane. So a point ru in the universal coordinate system, projects to VP*r. PV must be the inverse of the forwarding projection matrix. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l01368">1368</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;{</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="preprocessor">#define SUBSAMPLING 2                  // for every measure 2x2 line</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="comment">// integrals will be taken to</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <span class="comment">// avoid numerical errors</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="preprocessor">#define SUBSTEP 1/(SUBSAMPLING*2.0)</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> origin(3);</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="group__FringeProcessing.html#gad71cd7f2325be81202279ed730355092">direction</a>;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    VP.<a class="code" href="classMatrix2D.html#af11b96d9f1adce57692855f081f14760">getRow</a>(2, direction);</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    direction.<a class="code" href="classMatrix1D.html#af8b6ea8f86fcf69738d37b3336f536af">selfTranspose</a>();</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> corner1(3), corner2(3);</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> act(3);</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <a class="code" href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a>;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <span class="comment">// Find center of the feature in the projection plane ...................</span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="comment">// Step 1). Project the center to the plane, the result is in the</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="comment">//          universal coord system</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    <a class="code" href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a>(origin, VP, <a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>);</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <span class="comment">//   Matrix1D&lt;double&gt; origin_debug(3);</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <span class="comment">//   Uproject_to_plane(Center,P.direction,0,origin_debug);</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="comment">//#define DEBUG_LITTLE</span></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Actual feature\n&quot;</span>     &lt;&lt; <span class="keyword">this</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Center              &quot;</span> &lt;&lt; <a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>.<a class="code" href="classMatrix1D.html#a8849e36416cde2a57914953a815d4b43">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;VP matrix\n&quot;</span>          &lt;&lt; VP &lt;&lt; std::endl;</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;P.direction         &quot;</span> &lt;&lt; P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>.<a class="code" href="classMatrix1D.html#a8849e36416cde2a57914953a815d4b43">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;direction           &quot;</span> &lt;&lt; direction.<a class="code" href="classMatrix1D.html#a8849e36416cde2a57914953a815d4b43">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;P.euler matrix      &quot;</span> &lt;&lt; P.<a class="code" href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">euler</a> &lt;&lt; std::endl;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;max_distance        &quot;</span> &lt;&lt; <a class="code" href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">max_distance</a> &lt;&lt; std::endl;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;origin              &quot;</span> &lt;&lt; origin.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="comment">//      std::cout &lt;&lt; &quot;origin_debug (Univ.coord) &quot; &lt;&lt; origin_debug.transpose() &lt;&lt; std::endl;</span></div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="comment">       // Step 2). Express this projected center in the projection coord system</span></div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="comment">       M3x3_BY_V3x1(origin_debug,P.euler,origin_debug);</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="comment">    //   if (A!=NULL) M2x2_BY_V2x1(origin,*A,origin_);</span></div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="comment">       #ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="comment">          std::cout &lt;&lt; &quot;origin (Proj.coord) &quot; &lt;&lt; origin_debug.transpose() &lt;&lt; std::endl;</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="comment">       #endif</span></div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="comment">// Find limits for projection ...........................................</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="comment">// Choose corners for the projection of this feature. It is supposed</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="comment">// to have at the worst case a projection of size max_distance</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(corner1, <a class="code" href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">max_distance</a>, <a class="code" href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">max_distance</a>, <a class="code" href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">max_distance</a>);</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(corner2, -<a class="code" href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">max_distance</a>, -<a class="code" href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">max_distance</a>, -<a class="code" href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">max_distance</a>);</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Corner1 : &quot;</span> &lt;&lt; corner1.transpose() &lt;&lt; std::endl</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Corner2 : &quot;</span> &lt;&lt; corner2.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <a class="code" href="group__Geometry.html#ga3baa7ca66e02a7a51562325d28e70d47">box_enclosing</a>(corner1, corner2, VP, corner1, corner2);</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <span class="comment">//   if (A!=NULL) {</span></div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="comment">//      rectangle_enclosing(corner1,corner2,*A,corner1,corner2);</span></div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Corner1 moves to : &quot;</span> &lt;&lt; corner1.transpose() &lt;&lt; std::endl</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Corner2 moves to : &quot;</span> &lt;&lt; corner2.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="comment">//   }</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <a class="code" href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a>(corner1, origin, corner1);</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <a class="code" href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a>(corner2, origin, corner2);</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Corner1 finally is : &quot;</span> &lt;&lt; corner1.transpose() &lt;&lt; std::endl</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Corner2 finally is : &quot;</span> &lt;&lt; corner2.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="comment">       Matrix1D&lt;double&gt; corner1_debug(2),corner2_debug(2);</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="comment">       VECTOR_R2(corner1_debug, max_distance, max_distance);</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="comment">       VECTOR_R2(corner2_debug,-max_distance,-max_distance);</span></div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="comment">       #ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="comment">          std::cout &lt;&lt; &quot;Corner1_debug : &quot; &lt;&lt; corner1_debug.transpose() &lt;&lt; std::endl</span></div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="comment">               &lt;&lt; &quot;Corner2_debug : &quot; &lt;&lt; corner2_debug.transpose() &lt;&lt; std::endl;</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="comment">       #endif</span></div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="comment">       V2_PLUS_V2(corner1_debug,origin_debug,corner1_debug);</span></div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="comment">       V2_PLUS_V2(corner2_debug,origin_debug,corner2_debug);</span></div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="comment">       #ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="comment">          std::cout &lt;&lt; &quot;Corner1_debug finally is : &quot; &lt;&lt; corner1_debug.transpose() &lt;&lt; std::endl</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="comment">               &lt;&lt; &quot;Corner2_debug finally is : &quot; &lt;&lt; corner2_debug.transpose() &lt;&lt; std::endl;</span></div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="comment">       #endif</span></div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="comment">// Discard not necessary components</span></div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    corner1.resize(2);</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    corner2.resize(2);</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="comment">// Clip to image size</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <a class="code" href="group__Vectors.html#ga988b127d529b4cf677e3d31f65bc8403">sortTwoVectors</a>(corner1, corner2);</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1) = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1)), <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(P()), <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(P()));</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1) = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1)), <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(P()), <a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(P()));</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2) = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2)), <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(P()), <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(P()));</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2) = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2)), <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(P()), <a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(P()));</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;corner1      &quot;</span> &lt;&lt; corner1.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;corner2      &quot;</span> &lt;&lt; corner2.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    std::cout.flush();</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <span class="comment">// Check if there is something to project</span></div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1) == <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2))</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1) == <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2))</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="comment">// Study the projection for each point in the projection plane ..........</span></div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="comment">// (u,v) are in the deformed projection plane (if any deformation)</span></div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1); v &lt;= (int)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2); v++)</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a> = (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1); <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a> &lt;= (int)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2); <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a>++)</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        {</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="cuda__basic__math_8h.html#a2fcd5057894d92219f3d8e11e6ace2ff">length</a> = 0;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="preprocessor">#ifdef DEBUG_EVEN_MORE</span></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Studying point (&quot;</span> &lt;&lt; <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; v &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;            std::cout.flush();</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;            <span class="comment">// Perform subsampling ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,</span></div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;            <span class="keywordtype">double</span> u0 = <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a> - (int)(<a class="code" href="phantom_8cpp.html#ab009a686fbda6acc8eafb306c4609120">SUBSAMPLING</a> / 2.0) * <a class="code" href="phantom_8cpp.html#ad9381309914b415faf626209a5ee9e59">SUBSTEP</a>;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#a8eb6f9afe59b4924d42d1ea2002148e7">v0</a> = v - (int)(<a class="code" href="phantom_8cpp.html#ab009a686fbda6acc8eafb306c4609120">SUBSAMPLING</a> / 2.0) * <a class="code" href="phantom_8cpp.html#ad9381309914b415faf626209a5ee9e59">SUBSTEP</a>;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;            <span class="keywordtype">double</span> actv = <a class="code" href="numerical__recipes_8cpp.html#a8eb6f9afe59b4924d42d1ea2002148e7">v0</a>;</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> subv = 0; subv &lt; <a class="code" href="phantom_8cpp.html#ab009a686fbda6acc8eafb306c4609120">SUBSAMPLING</a>; subv++)</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;            {</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                <span class="keywordtype">double</span> actu = u0;</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> subu = 0; subu &lt; <a class="code" href="phantom_8cpp.html#ab009a686fbda6acc8eafb306c4609120">SUBSAMPLING</a>; subu++)</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                {</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                    <span class="comment">// Compute the coordinates of point (subu,subv) which is</span></div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                    <span class="comment">// within the plane in the universal coordinate system</span></div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(act) = actu;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(act) = actv;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(act) = 0;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                    <span class="comment">//               if (Ainv!=NULL) M2x2_BY_V2x1(act,*Ainv,act);</span></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                    <span class="comment">//               M3x3_BY_V3x1(act,P.eulert,act);</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                    <a class="code" href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a>(act, PV, act);</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                    <span class="comment">// Compute the intersection of a ray which passes through</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                    <span class="comment">// this point and its direction is perpendicular to the</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                    <span class="comment">// projection plane</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                    <span class="keywordtype">double</span> possible_length = <a class="code" href="classFeature.html#a22505c1face2430b74fce3d331aeceab">intersection</a>(direction, act);</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                    <span class="keywordflow">if</span> (possible_length &gt; 0)</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                        length += possible_length;</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="preprocessor">#ifdef DEBUG_EVEN_MORE</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;Averaging at (&quot;</span> &lt;&lt; actu &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; actv &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;   which in univ. coords is &quot;</span> &lt;&lt; act.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;   intersection there &quot;</span> &lt;&lt; possible_length &lt;&lt; std::endl;</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                    <span class="comment">// Prepare for next iteration</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                    actu += <a class="code" href="phantom_8cpp.html#ad9381309914b415faf626209a5ee9e59">SUBSTEP</a> * 2.0;</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                }</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                actv += <a class="code" href="phantom_8cpp.html#ad9381309914b415faf626209a5ee9e59">SUBSTEP</a> * 2.0;</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;            }</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;            length /= (SUBSAMPLING * <a class="code" href="phantom_8cpp.html#ab009a686fbda6acc8eafb306c4609120">SUBSAMPLING</a>);</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Final value added at position (&quot;</span> &lt;&lt; <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; v &lt;&lt; <span class="stringliteral">&quot;)=&quot;</span></div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            &lt;&lt; length &lt;&lt; std::endl;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;            <span class="comment">// Add at the correspondent pixel the found intersection ,,,,,,,,,,</span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;            <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(P, v, <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a>) += length * <a class="code" href="classFeature.html#a2cef017ac20ba675d36573449b186579">Density</a>;</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        }</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;}</div><div class="ttc" id="classMatrix1D_html_a8849e36416cde2a57914953a815d4b43"><div class="ttname"><a href="classMatrix1D.html#a8849e36416cde2a57914953a815d4b43">Matrix1D::transpose</a></div><div class="ttdeci">Matrix1D&lt; T &gt; transpose() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01466">matrix1d.h:1466</a></div></div>
<div class="ttc" id="group__Vectors_html_ga988b127d529b4cf677e3d31f65bc8403"><div class="ttname"><a href="group__Vectors.html#ga988b127d529b4cf677e3d31f65bc8403">sortTwoVectors</a></div><div class="ttdeci">void sortTwoVectors(Matrix1D&lt; T &gt; &amp;v1, Matrix1D&lt; T &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01883">matrix1d.h:1883</a></div></div>
<div class="ttc" id="classFeature_html_a45423ae0a78ea69cbf18bf69ebd13119"><div class="ttname"><a href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Feature::Center</a></div><div class="ttdeci">Matrix1D&lt; double &gt; Center</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00113">phantom.h:113</a></div></div>
<div class="ttc" id="group__FourierProjection_html_gabef83744f4e0571354f31586fb41d357"><div class="ttname"><a href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">Projection::euler</a></div><div class="ttdeci">Matrix2D&lt; double &gt; euler</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00074">fourier_projection.h:74</a></div></div>
<div class="ttc" id="phantom_8cpp_html_ab009a686fbda6acc8eafb306c4609120"><div class="ttname"><a href="phantom_8cpp.html#ab009a686fbda6acc8eafb306c4609120">SUBSAMPLING</a></div><div class="ttdeci">#define SUBSAMPLING</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00065">multidim_array.h:65</a></div></div>
<div class="ttc" id="classMatrix1D_html_af8b6ea8f86fcf69738d37b3336f536af"><div class="ttname"><a href="classMatrix1D.html#af8b6ea8f86fcf69738d37b3336f536af">Matrix1D::selfTranspose</a></div><div class="ttdeci">void selfTranspose()</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01477">matrix1d.h:1477</a></div></div>
<div class="ttc" id="group__Macros_html_gad4d08cca0a39849cc247072eaebe7726"><div class="ttname"><a href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a></div><div class="ttdeci">#define CLIP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00260">xmipp_macros.h:260</a></div></div>
<div class="ttc" id="group__Geometry_html_ga3baa7ca66e02a7a51562325d28e70d47"><div class="ttname"><a href="group__Geometry.html#ga3baa7ca66e02a7a51562325d28e70d47">box_enclosing</a></div><div class="ttdeci">void box_enclosing(const Matrix1D&lt; double &gt; &amp;v0, const Matrix1D&lt; double &gt; &amp;vF, const Matrix2D&lt; double &gt; &amp;V, Matrix1D&lt; double &gt; &amp;corner1, Matrix1D&lt; double &gt; &amp;corner2)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00363">geometry.cpp:363</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="classFeature_html_a22505c1face2430b74fce3d331aeceab"><div class="ttname"><a href="classFeature.html#a22505c1face2430b74fce3d331aeceab">Feature::intersection</a></div><div class="ttdeci">virtual double intersection(const Matrix1D&lt; double &gt; &amp;direction, const Matrix1D&lt; double &gt; &amp;passing_point, Matrix1D&lt; double &gt; &amp;r, Matrix1D&lt; double &gt; &amp;u) const =0</div></div>
<div class="ttc" id="cuda__basic__math_8h_html_a2fcd5057894d92219f3d8e11e6ace2ff"><div class="ttname"><a href="cuda__basic__math_8h.html#a2fcd5057894d92219f3d8e11e6ace2ff">length</a></div><div class="ttdeci">__host__ __device__ float length(float2 v)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__basic__math_8h_source.html#l00162">cuda_basic_math.h:162</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="group__FringeProcessing_html_gad71cd7f2325be81202279ed730355092"><div class="ttname"><a href="group__FringeProcessing.html#gad71cd7f2325be81202279ed730355092">direction</a></div><div class="ttdeci">void direction(const MultidimArray&lt; double &gt; &amp;orMap, MultidimArray&lt; double &gt; &amp;qualityMap, double lambda, int size, MultidimArray&lt; double &gt; &amp;dirMap, int x, int y)</div><div class="ttdef"><b>Definition:</b> <a href="fringe__processing_8cpp_source.html#l00436">fringe_processing.cpp:436</a></div></div>
<div class="ttc" id="group__FourierProjection_html_ga532f6713fbe228d3ee30f4d3a2766a20"><div class="ttname"><a href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">Projection::direction</a></div><div class="ttdeci">Matrix1D&lt; double &gt; direction</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00065">fourier_projection.h:65</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="classFeature_html_a6171dbc2a0f64c2b7c31fb91573a75c1"><div class="ttname"><a href="classFeature.html#a6171dbc2a0f64c2b7c31fb91573a75c1">Feature::max_distance</a></div><div class="ttdeci">double max_distance</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00120">phantom.h:120</a></div></div>
<div class="ttc" id="group__Matrices_html_gad159332322d687de886a720422e4b757"><div class="ttname"><a href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a></div><div class="ttdeci">#define M3x3_BY_V3x1(a, M, b)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00171">matrix2d.h:171</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00073">multidim_array.h:73</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_ga6c6b4d4f88daca5e1d8e171bec3b4af0"><div class="ttname"><a href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a></div><div class="ttdeci">#define VECTOR_R3(v, x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00127">matrix1d.h:127</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a6277e2a7446059985dc9bcf0a4ac1a8f"><div class="ttname"><a href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a></div><div class="ttdeci">doublereal * u</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="classMatrix2D_html_af11b96d9f1adce57692855f081f14760"><div class="ttname"><a href="classMatrix2D.html#af11b96d9f1adce57692855f081f14760">Matrix2D::getRow</a></div><div class="ttdeci">void getRow(size_t i, Matrix1D&lt; T &gt; &amp;v) const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01396">matrix2d.h:1396</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a8eb6f9afe59b4924d42d1ea2002148e7"><div class="ttname"><a href="numerical__recipes_8cpp.html#a8eb6f9afe59b4924d42d1ea2002148e7">v0</a></div><div class="ttdeci">double v0</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l06229">numerical_recipes.cpp:6229</a></div></div>
<div class="ttc" id="classFeature_html_a2cef017ac20ba675d36573449b186579"><div class="ttname"><a href="classFeature.html#a2cef017ac20ba675d36573449b186579">Feature::Density</a></div><div class="ttdeci">double Density</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00108">phantom.h:108</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="phantom_8cpp_html_ad9381309914b415faf626209a5ee9e59"><div class="ttname"><a href="phantom_8cpp.html#ad9381309914b415faf626209a5ee9e59">SUBSTEP</a></div><div class="ttdeci">#define SUBSTEP</div></div>
<div class="ttc" id="group__Vectors_html_gafe748b92e8aeaa282eb7bafbd2baca37"><div class="ttname"><a href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a></div><div class="ttdeci">#define V3_PLUS_V3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00193">matrix1d.h:193</a></div></div>
<div class="ttc" id="group__Images_html_gaad11fc7e221702e9f1adeb445ba5db9c"><div class="ttname"><a href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a></div><div class="ttdeci">#define IMGPIXEL(I, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00176">xmipp_image_base.h:176</a></div></div>
<div class="ttc" id="group__Macros_html_ga20716e3da0ba25d3c4c9a2421573391f"><div class="ttname"><a href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a></div><div class="ttdeci">#define SPEED_UP_temps012</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00403">xmipp_macros.h:403</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1843de345993d7491c653d769ee029b6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Feature::read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMDRow.html">MDRow</a> &amp;&#160;</td>
          <td class="paramname"><em>row</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l00312">312</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;{</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="classFeature.html#ade99a9be8ccf32211771399d3f9e607f">readCommon</a>(row);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    std::vector&lt;double&gt; VectSpecific;  <span class="comment">// Vector for specific parameters of feature</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    row.<a class="code" href="classMDRow.html#a05a9538d1fe892459ed8405862ea0f76">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aefdc80320a13e60a03deec65db9a47d0">MDL_PHANTOM_FEATURE_SPECIFIC</a>, VectSpecific);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="classFeature.html#acd3167f4a843950a74b48e13af71fc3f">read_specific</a>(VectSpecific);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;}</div><div class="ttc" id="classFeature_html_ade99a9be8ccf32211771399d3f9e607f"><div class="ttname"><a href="classFeature.html#ade99a9be8ccf32211771399d3f9e607f">Feature::readCommon</a></div><div class="ttdeci">void readCommon(char *line)</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l00276">phantom.cpp:276</a></div></div>
<div class="ttc" id="classMDRow_html_a05a9538d1fe892459ed8405862ea0f76"><div class="ttname"><a href="classMDRow.html#a05a9538d1fe892459ed8405862ea0f76">MDRow::getValue</a></div><div class="ttdeci">bool getValue(MDLabel label, T &amp;d) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l01130">metadata_label.h:1130</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78aefdc80320a13e60a03deec65db9a47d0"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aefdc80320a13e60a03deec65db9a47d0">MDL_PHANTOM_FEATURE_SPECIFIC</a></div><div class="ttdoc">Specific parameters for a feature (vector double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00324">metadata_label.h:324</a></div></div>
<div class="ttc" id="classFeature_html_acd3167f4a843950a74b48e13af71fc3f"><div class="ttname"><a href="classFeature.html#acd3167f4a843950a74b48e13af71fc3f">Feature::read_specific</a></div><div class="ttdeci">virtual void read_specific(const std::vector&lt; double &gt; &amp;vector)=0</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acd3167f4a843950a74b48e13af71fc3f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void Feature::read_specific </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>vector</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Read a feature from a file, VIRTUAL!!!. The format must be the one given in <a class="el" href="group__Phantoms.html">Phantoms</a>, and each subclass must implement its own I/O routines. These routines must fill only the non common part of the feature description, but they receive the whole line with the description. </p>

<p>Implemented in <a class="el" href="classCone.html#a8f51c3c5cb74007970a300e3ed18f1af">Cone</a>, <a class="el" href="classEllipsoid.html#a96fa115eef89fd6d9b6c3d5d4909f9db">Ellipsoid</a>, <a class="el" href="classCube.html#a4a3e9b9cfff9b00d68ad7d1a0dc700a8">Cube</a>, <a class="el" href="classDCylinder.html#addc73e46e722f9368854556bf39c0e59">DCylinder</a>, <a class="el" href="classCylinder.html#aa18b0207ade53ec1fa05dc86f13fd38c">Cylinder</a>, <a class="el" href="classGaussian.html#ab679ded100e093c411057e222589ea08">Gaussian</a>, <a class="el" href="classBlob.html#a7020bb866e8d4ce118cc65eb33f05706">Blob</a>, and <a class="el" href="classSphere.html#a79f36d82f454370f9e1d4677bb63a3e1">Sphere</a>.</p>

</div>
</div>
<a class="anchor" id="ade99a9be8ccf32211771399d3f9e607f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Feature::readCommon </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>line</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read common part of the feature description. The common part is the feature type, the behaviour, density and center. The description is passed as a line. Exceptions are thrown if the description doesn't conform the standard specification. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l00276">276</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;{</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordtype">int</span>        stat;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordtype">char</span>       straux[6];</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(3);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    stat = sscanf(line, <span class="stringliteral">&quot;%s %c %lf %lf %lf %lf&quot;</span>,</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                  straux,</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                  &amp;(<a class="code" href="classFeature.html#a7ca340a4eb8c5da25ffe1ab3958e1548">Add_Assign</a>),</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                  &amp;(<a class="code" href="classFeature.html#a2cef017ac20ba675d36573449b186579">Density</a>),</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                  &amp;(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>)),</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                  &amp;(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>)),</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                  &amp;(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>)));</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span> (stat != 6)</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa3841b4acd9ccaecf1f418cb40b1537f1">ERR_IO_NOREAD</a>,</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                     (<a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a>)<span class="stringliteral">&quot;Error when reading common part of feature: &quot;</span> + line);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Type</a> = straux;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="classFeature_html_a45423ae0a78ea69cbf18bf69ebd13119"><div class="ttname"><a href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Feature::Center</a></div><div class="ttdeci">Matrix1D&lt; double &gt; Center</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00113">phantom.h:113</a></div></div>
<div class="ttc" id="namespacetesting_1_1internal_html_a8e8ff5b11e64078831112677156cb111"><div class="ttname"><a href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">testing::internal::string</a></div><div class="ttdeci">::std::string string</div><div class="ttdef"><b>Definition:</b> <a href="gtest_8h_source.html#l01818">gtest.h:1818</a></div></div>
<div class="ttc" id="classFeature_html_abaec53ba8fbe169f88bfeb526d56f7a5"><div class="ttname"><a href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Feature::Type</a></div><div class="ttdeci">std::string Type</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00095">phantom.h:95</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="classMatrix1D_html_a79a482948ae334cbefaef7c7839cd934"><div class="ttname"><a href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">Matrix1D::resize</a></div><div class="ttdeci">void resize(size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00451">matrix1d.h:451</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa3841b4acd9ccaecf1f418cb40b1537f1"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa3841b4acd9ccaecf1f418cb40b1537f1">ERR_IO_NOREAD</a></div><div class="ttdoc">Couldn&amp;#39;t read from file. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00144">xmipp_error.h:144</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="classFeature_html_a2cef017ac20ba675d36573449b186579"><div class="ttname"><a href="classFeature.html#a2cef017ac20ba675d36573449b186579">Feature::Density</a></div><div class="ttdeci">double Density</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00108">phantom.h:108</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="classFeature_html_a7ca340a4eb8c5da25ffe1ab3958e1548"><div class="ttname"><a href="classFeature.html#a7ca340a4eb8c5da25ffe1ab3958e1548">Feature::Add_Assign</a></div><div class="ttdeci">char Add_Assign</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00102">phantom.h:102</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a83e7afa434f27b8d408ce5eefa6b3c56"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Feature::readCommon </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMDRow.html">MDRow</a> &amp;&#160;</td>
          <td class="paramname"><em>row</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l00295">295</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;{</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(3);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    std::vector &lt;double&gt; VecFeatureCenter;  <span class="comment">// Keep the center of the feature</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a> s_op;  <span class="comment">// As no label for char in MD_TYPE  (for add/assign)</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">if</span> (!row.<a class="code" href="classMDRow.html#a05a9538d1fe892459ed8405862ea0f76">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acecdff1b6573be9445a251278b6d72e6">MDL_PHANTOM_FEATURE_TYPE</a>,<a class="code" href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Type</a>) ||</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        !row.<a class="code" href="classMDRow.html#a05a9538d1fe892459ed8405862ea0f76">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aece849675970cf461aee160553150539">MDL_PHANTOM_FEATURE_OPERATION</a>,s_op) ||</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        !row.<a class="code" href="classMDRow.html#a05a9538d1fe892459ed8405862ea0f76">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aa8a3fe90d0810c653bc9a8a5a23719e1">MDL_PHANTOM_FEATURE_DENSITY</a>,<a class="code" href="classFeature.html#a2cef017ac20ba675d36573449b186579">Density</a>) ||</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        !row.<a class="code" href="classMDRow.html#a05a9538d1fe892459ed8405862ea0f76">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ae62481e20c2f0bd4e58fbe55d2bb4a7a">MDL_PHANTOM_FEATURE_CENTER</a>,VecFeatureCenter))</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aab06d98c5deb993d88b1121766274b6e8">ERR_ARG_MISSING</a>, (<a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a>)<span class="stringliteral">&quot;Error when reading common part of feature&quot;</span>);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>) = VecFeatureCenter[0];</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>) = VecFeatureCenter[1];</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>) = VecFeatureCenter[2];</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="classFeature.html#a7ca340a4eb8c5da25ffe1ab3958e1548">Add_Assign</a> = s_op[0];</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aab06d98c5deb993d88b1121766274b6e8"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aab06d98c5deb993d88b1121766274b6e8">ERR_ARG_MISSING</a></div><div class="ttdoc">Argument missing. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00119">xmipp_error.h:119</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="classFeature_html_a45423ae0a78ea69cbf18bf69ebd13119"><div class="ttname"><a href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Feature::Center</a></div><div class="ttdeci">Matrix1D&lt; double &gt; Center</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00113">phantom.h:113</a></div></div>
<div class="ttc" id="namespacetesting_1_1internal_html_a8e8ff5b11e64078831112677156cb111"><div class="ttname"><a href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">testing::internal::string</a></div><div class="ttdeci">::std::string string</div><div class="ttdef"><b>Definition:</b> <a href="gtest_8h_source.html#l01818">gtest.h:1818</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78aa8a3fe90d0810c653bc9a8a5a23719e1"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aa8a3fe90d0810c653bc9a8a5a23719e1">MDL_PHANTOM_FEATURE_DENSITY</a></div><div class="ttdoc">The density of the feature (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00322">metadata_label.h:322</a></div></div>
<div class="ttc" id="classFeature_html_abaec53ba8fbe169f88bfeb526d56f7a5"><div class="ttname"><a href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Feature::Type</a></div><div class="ttdeci">std::string Type</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00095">phantom.h:95</a></div></div>
<div class="ttc" id="classMDRow_html_a05a9538d1fe892459ed8405862ea0f76"><div class="ttname"><a href="classMDRow.html#a05a9538d1fe892459ed8405862ea0f76">MDRow::getValue</a></div><div class="ttdeci">bool getValue(MDLabel label, T &amp;d) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l01130">metadata_label.h:1130</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="classMatrix1D_html_a79a482948ae334cbefaef7c7839cd934"><div class="ttname"><a href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">Matrix1D::resize</a></div><div class="ttdeci">void resize(size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00451">matrix1d.h:451</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78acecdff1b6573be9445a251278b6d72e6"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acecdff1b6573be9445a251278b6d72e6">MDL_PHANTOM_FEATURE_TYPE</a></div><div class="ttdoc">Type of the feature (Sphere, Blob, ...) (std::string) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00325">metadata_label.h:325</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78aece849675970cf461aee160553150539"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aece849675970cf461aee160553150539">MDL_PHANTOM_FEATURE_OPERATION</a></div><div class="ttdoc">Operation in case of overlapping features (+,-) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00323">metadata_label.h:323</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78ae62481e20c2f0bd4e58fbe55d2bb4a7a"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ae62481e20c2f0bd4e58fbe55d2bb4a7a">MDL_PHANTOM_FEATURE_CENTER</a></div><div class="ttdoc">Center of the feature (vector double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00321">metadata_label.h:321</a></div></div>
<div class="ttc" id="classFeature_html_a2cef017ac20ba675d36573449b186579"><div class="ttname"><a href="classFeature.html#a2cef017ac20ba675d36573449b186579">Feature::Density</a></div><div class="ttdeci">double Density</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00108">phantom.h:108</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="classFeature_html_a7ca340a4eb8c5da25ffe1ab3958e1548"><div class="ttname"><a href="classFeature.html#a7ca340a4eb8c5da25ffe1ab3958e1548">Feature::Add_Assign</a></div><div class="ttdeci">char Add_Assign</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00102">phantom.h:102</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa6a6e450be06a1ece3d1d97adce9812c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Feature::rotate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>E</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Rotate the whole feature. Rotate this feature using a rotation matrix. The center as well as the feature itself is rotated. </p>

<p>Reimplemented in <a class="el" href="classOriented__Feature.html#a53861bab42165b2b19d2ffceb7f73f6d">Oriented_Feature</a>.</p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l00258">258</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;{</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="classFeature.html#a9b02140efd49b5ac5cb4f01d7aff22d8">rotate_center</a>(E);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;}</div><div class="ttc" id="classFeature_html_a9b02140efd49b5ac5cb4f01d7aff22d8"><div class="ttname"><a href="classFeature.html#a9b02140efd49b5ac5cb4f01d7aff22d8">Feature::rotate_center</a></div><div class="ttdeci">virtual void rotate_center(const Matrix2D&lt; double &gt; &amp;E)</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l00250">phantom.cpp:250</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9b02140efd49b5ac5cb4f01d7aff22d8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Feature::rotate_center </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>E</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Rotate only the center. Rotate the center of this feature only around the phantom center </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l00250">250</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;{</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> inverse_angles_matrix;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    inverse_angles_matrix = E.<a class="code" href="classMatrix2D.html#add8d2052c53fcf6689908614f67b9ee6">inv</a>();</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a> = inverse_angles_matrix * <a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">//Center=E*Center;</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;}</div><div class="ttc" id="classMatrix2D_html_add8d2052c53fcf6689908614f67b9ee6"><div class="ttname"><a href="classMatrix2D.html#add8d2052c53fcf6689908614f67b9ee6">Matrix2D::inv</a></div><div class="ttdeci">void inv(Matrix2D&lt; T &gt; &amp;result) const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01648">matrix2d.h:1648</a></div></div>
<div class="ttc" id="classFeature_html_a45423ae0a78ea69cbf18bf69ebd13119"><div class="ttname"><a href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Feature::Center</a></div><div class="ttdeci">Matrix1D&lt; double &gt; Center</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00113">phantom.h:113</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2f1c9056e82930b80b6eddc70e9f251b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classFeature.html">Feature</a>* Feature::scale </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>factor</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return a scaled version of this feature, VIRTUAL!!!. This function returns a pointer to a feature (of the same type as the feature for which the function was called, ie, if you scale a sphere the result is a sphere, if you scale a cone, the result is a cone, ...) that is a scaled version of the actual feature (see each specific implementation to see which is the relatioship between the two features). This function is useful to define backgrounds with the same shape of the given feature. </p>

<p>Implemented in <a class="el" href="classCone.html#adee4566bb1a976098f2892c94cd161b2">Cone</a>, <a class="el" href="classEllipsoid.html#a38e152eb65e485ceaf85b5b4fb22057c">Ellipsoid</a>, <a class="el" href="classCube.html#a4a9ea8cc21f2b95c662f93917bbb6793">Cube</a>, <a class="el" href="classDCylinder.html#a9f9aaed4c799a1bdbf71ef9e746815d8">DCylinder</a>, <a class="el" href="classCylinder.html#a33cf6dfdaf55e59458f1ed361b50404c">Cylinder</a>, <a class="el" href="classGaussian.html#a2d5716bffc1da521024726c46e4e8840">Gaussian</a>, <a class="el" href="classBlob.html#a359fba48f25a8f8a1bdf067b9bf892a2">Blob</a>, and <a class="el" href="classSphere.html#a8d3590d3f2afda31589e95c335714b03">Sphere</a>.</p>

</div>
</div>
<a class="anchor" id="a7e9c3df179e1616f1fd2a897f166c7ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Feature::selfApplyGeometry </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply a general geometric transformation. The transformation must be defined by a 4x4 matrix that can be generated using the geometric functions in xmippGeometry or xmippMatrix2D. The matrix must be the desired transformation (i.e., new coordinate=A*old_coordinate. Don't worry because the selfApplyGeometry of <a class="el" href="classPhantom.html">Phantom</a> take cares of passing to this function the appropriate matrix. No check is done about the size of A.</p>
<p>Only the center is transformed, the feature will keep the same size. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l01153">1153</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;{</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> r(4);</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r) = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>);</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r) = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>);</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r) = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>);</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    r(3) = 1;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    r = A * r;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>) = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>) = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r);</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>) = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r);</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;}</div><div class="ttc" id="classFeature_html_a45423ae0a78ea69cbf18bf69ebd13119"><div class="ttname"><a href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Feature::Center</a></div><div class="ttdeci">Matrix1D&lt; double &gt; Center</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00113">phantom.h:113</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a747114489bb6e6fcfe2f8d196d7f6ec1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Feature::shift </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shiftX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shiftY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shiftZ</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Shift. Shift the feature a given amount of voxels. The new center is the old center plus the given shift, and that's all </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l01145">1145</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;{</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>) += shiftX;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>) += shiftY;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>) += shiftZ;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;}</div><div class="ttc" id="classFeature_html_a45423ae0a78ea69cbf18bf69ebd13119"><div class="ttname"><a href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Feature::Center</a></div><div class="ttdeci">Matrix1D&lt; double &gt; Center</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00113">phantom.h:113</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af92c06440e165f40c303e893564326f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Feature::sketch_in </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>colour</em> = <code>2</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Draw the surface of the feature. This function draws the surface of the feature at the given volume. A voxel is said to belong to the surface if the number of corners inside the feature meets 1&lt;=n&lt;=7. The default gray_level with which voxels will be drawn is 2 (normally higher than the usual volume grey levels, and the behaviour of the voxels drawn is Assign. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l01130">1130</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;{</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a>   aux1(3), aux2(3), corner1(3), corner2(3), r(3);</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="keywordtype">int</span>               inside;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <a class="code" href="classFeature.html#aa6045b395ac5dd1cb15a5a083427fd44">corners</a>(V, corner1, corner2);</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gacf49ec8e8432f65baabc829653497e12">FOR_ALL_ELEMENTS_IN_ARRAY3D_BETWEEN</a>(corner1, corner2)</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    {</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        inside = <a class="code" href="classFeature.html#a86351acf111729baa92dfc2a5b659ba7">voxel_inside</a>(r, aux1, aux2);</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        <span class="keywordflow">if</span> (inside != 0 &amp;&amp; inside != 8)</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(V, (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r), (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r), (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r)) = colour;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    }</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;}</div><div class="ttc" id="classFeature_html_a86351acf111729baa92dfc2a5b659ba7"><div class="ttname"><a href="classFeature.html#a86351acf111729baa92dfc2a5b659ba7">Feature::voxel_inside</a></div><div class="ttdeci">int voxel_inside(const Matrix1D&lt; double &gt; &amp;r, Matrix1D&lt; double &gt; &amp;aux1, Matrix1D&lt; double &gt; &amp;aux2) const </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l00936">phantom.cpp:936</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="classFeature_html_aa6045b395ac5dd1cb15a5a083427fd44"><div class="ttname"><a href="classFeature.html#aa6045b395ac5dd1cb15a5a083427fd44">Feature::corners</a></div><div class="ttdeci">void corners(const MultidimArray&lt; double &gt; &amp;V, Matrix1D&lt; double &gt; &amp;corner1, Matrix1D&lt; double &gt; &amp;corner2)</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l01050">phantom.cpp:1050</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gacf49ec8e8432f65baabc829653497e12"><div class="ttname"><a href="group__MultidimensionalArrays.html#gacf49ec8e8432f65baabc829653497e12">FOR_ALL_ELEMENTS_IN_ARRAY3D_BETWEEN</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D_BETWEEN(corner1, corner2)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00455">multidim_array.h:455</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9c5db26cf1ca5d7d818ed38f62de628b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double Feature::volume </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Volume of the feature in (voxel units)� , VIRTUAL!!!. This function returns the volume of each feature supposing that a voxel is of size 1x1x1. </p>

<p>Implemented in <a class="el" href="classCone.html#a6a4ebc702c82e30820d4fbb37fb08018">Cone</a>, <a class="el" href="classEllipsoid.html#aab1924f47700f3097e4804bf6b201d6e">Ellipsoid</a>, <a class="el" href="classCube.html#a69345e6485299539f2552c4f4cdf7b2f">Cube</a>, <a class="el" href="classDCylinder.html#a33e730e1112be7a2f7f314a9bbeaba99">DCylinder</a>, <a class="el" href="classCylinder.html#a767d540b2da13224589b36824bdec83b">Cylinder</a>, <a class="el" href="classGaussian.html#a92655897707c9acda9e83a6ae6e2e3fd">Gaussian</a>, <a class="el" href="classBlob.html#aeaac027bf52567643e57107fead05167">Blob</a>, and <a class="el" href="classSphere.html#aa15774662e1bd8ee2ff9344589bda2e3">Sphere</a>.</p>

</div>
</div>
<a class="anchor" id="a86351acf111729baa92dfc2a5b659ba7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Feature::voxel_inside </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>aux1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>aux2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Speeded up voxel inside a feature. A voxel is compound of 8 subvoxels. This function returns the number of subvoxel centers falling inside the feature. The voxel size is supposed to be 1, and r is the center of the voxel in R3. This speeded up function needs two vectors with dimension 3 externally resized. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l00936">936</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;{</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="comment">// The subvoxels are visited following a Gray code, so the number</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="comment">// of operations is minimized</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(aux1) = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r) + 0.25;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(aux1) = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r) + 0.25;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(aux1) = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r) + 0.25; <span class="comment">// 000</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keywordtype">int</span> inside = <a class="code" href="classFeature.html#ac5873e9c913db461359adf4e928a3395">point_inside</a>(aux1, aux2);</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <a class="code" href="phantom_8cpp.html#a7d1f74e0f28edca2f3e45218ae500c6a">DEBUG_SHOW</a>;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(aux1) -= 0.5;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    inside += <a class="code" href="classFeature.html#ac5873e9c913db461359adf4e928a3395">point_inside</a>(aux1, aux2);             <span class="comment">// 001</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <a class="code" href="phantom_8cpp.html#a7d1f74e0f28edca2f3e45218ae500c6a">DEBUG_SHOW</a>;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(aux1) -= 0.5;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    inside += <a class="code" href="classFeature.html#ac5873e9c913db461359adf4e928a3395">point_inside</a>(aux1, aux2);             <span class="comment">// 011</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <a class="code" href="phantom_8cpp.html#a7d1f74e0f28edca2f3e45218ae500c6a">DEBUG_SHOW</a>;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(aux1) += 0.5;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    inside += <a class="code" href="classFeature.html#ac5873e9c913db461359adf4e928a3395">point_inside</a>(aux1, aux2);             <span class="comment">// 010</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <a class="code" href="phantom_8cpp.html#a7d1f74e0f28edca2f3e45218ae500c6a">DEBUG_SHOW</a>;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(aux1) -= 0.5;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    inside += <a class="code" href="classFeature.html#ac5873e9c913db461359adf4e928a3395">point_inside</a>(aux1, aux2);             <span class="comment">// 110</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <a class="code" href="phantom_8cpp.html#a7d1f74e0f28edca2f3e45218ae500c6a">DEBUG_SHOW</a>;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(aux1) -= 0.5;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    inside += <a class="code" href="classFeature.html#ac5873e9c913db461359adf4e928a3395">point_inside</a>(aux1, aux2);             <span class="comment">// 111</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <a class="code" href="phantom_8cpp.html#a7d1f74e0f28edca2f3e45218ae500c6a">DEBUG_SHOW</a>;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(aux1) += 0.5;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    inside += <a class="code" href="classFeature.html#ac5873e9c913db461359adf4e928a3395">point_inside</a>(aux1, aux2);             <span class="comment">// 101</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <a class="code" href="phantom_8cpp.html#a7d1f74e0f28edca2f3e45218ae500c6a">DEBUG_SHOW</a>;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(aux1) += 0.5;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    inside += <a class="code" href="classFeature.html#ac5873e9c913db461359adf4e928a3395">point_inside</a>(aux1, aux2);             <span class="comment">// 100</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <a class="code" href="phantom_8cpp.html#a7d1f74e0f28edca2f3e45218ae500c6a">DEBUG_SHOW</a>;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keywordflow">return</span> inside;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;}</div><div class="ttc" id="phantom_8cpp_html_a7d1f74e0f28edca2f3e45218ae500c6a"><div class="ttname"><a href="phantom_8cpp.html#a7d1f74e0f28edca2f3e45218ae500c6a">DEBUG_SHOW</a></div><div class="ttdeci">#define DEBUG_SHOW</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l00934">phantom.cpp:934</a></div></div>
<div class="ttc" id="classFeature_html_ac5873e9c913db461359adf4e928a3395"><div class="ttname"><a href="classFeature.html#ac5873e9c913db461359adf4e928a3395">Feature::point_inside</a></div><div class="ttdeci">virtual int point_inside(const Matrix1D&lt; double &gt; &amp;r, Matrix1D&lt; double &gt; &amp;aux) const =0</div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a447b25305ed4c7e3e77fcb238dca6add"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Feature::voxel_inside </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Voxel inside a feature. This function is based in the previous one. It makes the same but you needn't supply the auxiliar vectors. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l00192">192</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> aux1(3), aux2(3);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classFeature.html#a86351acf111729baa92dfc2a5b659ba7">voxel_inside</a>(r, aux1, aux2);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    }</div><div class="ttc" id="classFeature_html_a86351acf111729baa92dfc2a5b659ba7"><div class="ttname"><a href="classFeature.html#a86351acf111729baa92dfc2a5b659ba7">Feature::voxel_inside</a></div><div class="ttdeci">int voxel_inside(const Matrix1D&lt; double &gt; &amp;r, Matrix1D&lt; double &gt; &amp;aux1, Matrix1D&lt; double &gt; &amp;aux2) const </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l00936">phantom.cpp:936</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a589dbf4e23cf03f4e4eea36b57c39cf3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Feature::voxel_inside_by_normalized_density </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>aux1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>aux2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A voxel is compound of 8 subvoxels. This function returns the number of subvoxel centers falling inside the feature multiplied by the normalized feature density. That is, the value of the density is always 1 at the origin The voxel size is supposed to be 1, and r is the center of the voxel in R3. This speeded up function needs two vectors with dimension 3 externally resized. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l00971">971</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;{</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="preprocessor">#ifdef NEVER</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Type</a> == <span class="stringliteral">&quot;blo&quot;</span>)</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    {</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;den=&quot;</span> &lt;&lt;   <a class="code" href="classFeature.html#ad3de0cabb49594eb85b5b344f4ca206a">density_inside</a>(r, aux2) &lt;&lt; std::endl;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <span class="keywordflow">return</span>(<a class="code" href="classFeature.html#ad3de0cabb49594eb85b5b344f4ca206a">density_inside</a>(r, aux2));</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    }</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="keywordflow">return</span>((<span class="keywordtype">double</span>)<a class="code" href="classFeature.html#a86351acf111729baa92dfc2a5b659ba7">voxel_inside</a>(r, aux1, aux2));</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="comment">// The subvoxels are visited following a Gray code, so the number</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="comment">// of operations is minimized</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(aux1) = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r) + 0.25;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(aux1) = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r) + 0.25;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(aux1) = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r) + 0.25; <span class="comment">// 000</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="keywordtype">double</span> inside = (double)<a class="code" href="classFeature.html#ac5873e9c913db461359adf4e928a3395">point_inside</a>(aux1, aux2)</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                    * <a class="code" href="classFeature.html#ad3de0cabb49594eb85b5b344f4ca206a">density_inside</a>(r, aux2);</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <a class="code" href="phantom_8cpp.html#a7d1f74e0f28edca2f3e45218ae500c6a">DEBUG_SHOW</a>;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(aux1) -= 0.5;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    inside += (double)<a class="code" href="classFeature.html#ac5873e9c913db461359adf4e928a3395">point_inside</a>(aux1, aux2)</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;              * <a class="code" href="classFeature.html#ad3de0cabb49594eb85b5b344f4ca206a">density_inside</a>(r, aux2); <span class="comment">// 001</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <a class="code" href="phantom_8cpp.html#a7d1f74e0f28edca2f3e45218ae500c6a">DEBUG_SHOW</a>;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(aux1) -= 0.5;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    inside += (double)<a class="code" href="classFeature.html#ac5873e9c913db461359adf4e928a3395">point_inside</a>(aux1, aux2)</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;              * <a class="code" href="classFeature.html#ad3de0cabb49594eb85b5b344f4ca206a">density_inside</a>(r, aux2);  <span class="comment">// 011</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <a class="code" href="phantom_8cpp.html#a7d1f74e0f28edca2f3e45218ae500c6a">DEBUG_SHOW</a>;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(aux1) += 0.5;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    inside += (double)<a class="code" href="classFeature.html#ac5873e9c913db461359adf4e928a3395">point_inside</a>(aux1, aux2)</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;              * <a class="code" href="classFeature.html#ad3de0cabb49594eb85b5b344f4ca206a">density_inside</a>(r, aux2); <span class="comment">// 010</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <a class="code" href="phantom_8cpp.html#a7d1f74e0f28edca2f3e45218ae500c6a">DEBUG_SHOW</a>;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(aux1) -= 0.5;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    inside += (double)<a class="code" href="classFeature.html#ac5873e9c913db461359adf4e928a3395">point_inside</a>(aux1, aux2)</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;              * <a class="code" href="classFeature.html#ad3de0cabb49594eb85b5b344f4ca206a">density_inside</a>(r, aux2); <span class="comment">// 110</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <a class="code" href="phantom_8cpp.html#a7d1f74e0f28edca2f3e45218ae500c6a">DEBUG_SHOW</a>;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(aux1) -= 0.5;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    inside += (double)<a class="code" href="classFeature.html#ac5873e9c913db461359adf4e928a3395">point_inside</a>(aux1, aux2)</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;              * <a class="code" href="classFeature.html#ad3de0cabb49594eb85b5b344f4ca206a">density_inside</a>(r, aux2); <span class="comment">// 111</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <a class="code" href="phantom_8cpp.html#a7d1f74e0f28edca2f3e45218ae500c6a">DEBUG_SHOW</a>;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(aux1) += 0.5;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    inside += (double)<a class="code" href="classFeature.html#ac5873e9c913db461359adf4e928a3395">point_inside</a>(aux1, aux2)</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;              * <a class="code" href="classFeature.html#ad3de0cabb49594eb85b5b344f4ca206a">density_inside</a>(r, aux2); <span class="comment">// 101</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <a class="code" href="phantom_8cpp.html#a7d1f74e0f28edca2f3e45218ae500c6a">DEBUG_SHOW</a>;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(aux1) += 0.5;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    inside += (double)<a class="code" href="classFeature.html#ac5873e9c913db461359adf4e928a3395">point_inside</a>(aux1, aux2)</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;              * <a class="code" href="classFeature.html#ad3de0cabb49594eb85b5b344f4ca206a">density_inside</a>(r, aux2); <span class="comment">// 100</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <a class="code" href="phantom_8cpp.html#a7d1f74e0f28edca2f3e45218ae500c6a">DEBUG_SHOW</a>;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="keywordflow">return</span> inside;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;}</div><div class="ttc" id="phantom_8cpp_html_a7d1f74e0f28edca2f3e45218ae500c6a"><div class="ttname"><a href="phantom_8cpp.html#a7d1f74e0f28edca2f3e45218ae500c6a">DEBUG_SHOW</a></div><div class="ttdeci">#define DEBUG_SHOW</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l00934">phantom.cpp:934</a></div></div>
<div class="ttc" id="classFeature_html_a86351acf111729baa92dfc2a5b659ba7"><div class="ttname"><a href="classFeature.html#a86351acf111729baa92dfc2a5b659ba7">Feature::voxel_inside</a></div><div class="ttdeci">int voxel_inside(const Matrix1D&lt; double &gt; &amp;r, Matrix1D&lt; double &gt; &amp;aux1, Matrix1D&lt; double &gt; &amp;aux2) const </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l00936">phantom.cpp:936</a></div></div>
<div class="ttc" id="classFeature_html_ac5873e9c913db461359adf4e928a3395"><div class="ttname"><a href="classFeature.html#ac5873e9c913db461359adf4e928a3395">Feature::point_inside</a></div><div class="ttdeci">virtual int point_inside(const Matrix1D&lt; double &gt; &amp;r, Matrix1D&lt; double &gt; &amp;aux) const =0</div></div>
<div class="ttc" id="classFeature_html_abaec53ba8fbe169f88bfeb526d56f7a5"><div class="ttname"><a href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Feature::Type</a></div><div class="ttdeci">std::string Type</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00095">phantom.h:95</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="classFeature_html_ad3de0cabb49594eb85b5b344f4ca206a"><div class="ttname"><a href="classFeature.html#ad3de0cabb49594eb85b5b344f4ca206a">Feature::density_inside</a></div><div class="ttdeci">virtual double density_inside(const Matrix1D&lt; double &gt; &amp;r, Matrix1D&lt; double &gt; &amp;aux) const =0</div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="a1f194860a9611e66a9a1cd196a9ad469"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream&amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classFeature.html">Feature</a> *&#160;</td>
          <td class="paramname"><em>F</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Show feature not in the standard format but more informatively. This function is based on the std::cout &lt;&lt; ... of each subclass. First shows the common part of the feature and then its specific part. Be careful that you must show a pointer to the feature!! \ Ex: <a class="el" href="classSphere.html">Sphere</a> sphere; std::cout &lt;&lt; (<a class="el" href="classFeature.html">Feature</a> *) &amp;sphere; </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l00663">663</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;{</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordflow">if</span> (F != NULL)</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        o &lt;&lt; <span class="stringliteral">&quot;Feature --------&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        o &lt;&lt; <span class="stringliteral">&quot;   Type:        &quot;</span> &lt;&lt; F-&gt;<a class="code" href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Type</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        o &lt;&lt; <span class="stringliteral">&quot;   Add_Assign:  &quot;</span> &lt;&lt; F-&gt;<a class="code" href="classFeature.html#a7ca340a4eb8c5da25ffe1ab3958e1548">Add_Assign</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        o &lt;&lt; <span class="stringliteral">&quot;   Density:     &quot;</span> &lt;&lt; F-&gt;<a class="code" href="classFeature.html#a2cef017ac20ba675d36573449b186579">Density</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        o &lt;&lt; <span class="stringliteral">&quot;   Center:      &quot;</span> &lt;&lt; F-&gt;<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a>.<a class="code" href="classMatrix1D.html#a8849e36416cde2a57914953a815d4b43">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="keywordflow">if</span> (F-&gt;<a class="code" href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Type</a> == <span class="stringliteral">&quot;sph&quot;</span>)</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            o &lt;&lt; *((<a class="code" href="classSphere.html">Sphere</a> *) F);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (F-&gt;<a class="code" href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Type</a> == <span class="stringliteral">&quot;blo&quot;</span>)</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            o &lt;&lt; *((<a class="code" href="classBlob.html">Blob</a> *) F);</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (F-&gt;<a class="code" href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Type</a> == <span class="stringliteral">&quot;gau&quot;</span>)</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            o &lt;&lt; *((<a class="code" href="classGaussian.html">Gaussian</a> *) F);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (F-&gt;<a class="code" href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Type</a> == <span class="stringliteral">&quot;cyl&quot;</span>)</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            o &lt;&lt; *((<a class="code" href="classCylinder.html">Cylinder</a> *) F);</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (F-&gt;<a class="code" href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Type</a> == <span class="stringliteral">&quot;dcy&quot;</span>)</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            o &lt;&lt; *((<a class="code" href="classDCylinder.html">DCylinder</a> *) F);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (F-&gt;<a class="code" href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Type</a> == <span class="stringliteral">&quot;cub&quot;</span>)</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            o &lt;&lt; *((<a class="code" href="classCube.html">Cube</a> *) F);</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (F-&gt;<a class="code" href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Type</a> == <span class="stringliteral">&quot;ell&quot;</span>)</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            o &lt;&lt; *((<a class="code" href="classEllipsoid.html">Ellipsoid</a> *) F);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (F-&gt;<a class="code" href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Type</a> == <span class="stringliteral">&quot;con&quot;</span>)</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            o &lt;&lt; *((<a class="code" href="classCone.html">Cone</a> *) F);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    }</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordflow">return</span> o;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;}</div><div class="ttc" id="classMatrix1D_html_a8849e36416cde2a57914953a815d4b43"><div class="ttname"><a href="classMatrix1D.html#a8849e36416cde2a57914953a815d4b43">Matrix1D::transpose</a></div><div class="ttdeci">Matrix1D&lt; T &gt; transpose() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01466">matrix1d.h:1466</a></div></div>
<div class="ttc" id="classCone_html"><div class="ttname"><a href="classCone.html">Cone</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01274">phantom.h:1274</a></div></div>
<div class="ttc" id="classBlob_html"><div class="ttname"><a href="classBlob.html">Blob</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00572">phantom.h:572</a></div></div>
<div class="ttc" id="classFeature_html_a45423ae0a78ea69cbf18bf69ebd13119"><div class="ttname"><a href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Feature::Center</a></div><div class="ttdeci">Matrix1D&lt; double &gt; Center</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00113">phantom.h:113</a></div></div>
<div class="ttc" id="classGaussian_html"><div class="ttname"><a href="classGaussian.html">Gaussian</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00676">phantom.h:676</a></div></div>
<div class="ttc" id="classCylinder_html"><div class="ttname"><a href="classCylinder.html">Cylinder</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00780">phantom.h:780</a></div></div>
<div class="ttc" id="classFeature_html_abaec53ba8fbe169f88bfeb526d56f7a5"><div class="ttname"><a href="classFeature.html#abaec53ba8fbe169f88bfeb526d56f7a5">Feature::Type</a></div><div class="ttdeci">std::string Type</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00095">phantom.h:95</a></div></div>
<div class="ttc" id="classEllipsoid_html"><div class="ttname"><a href="classEllipsoid.html">Ellipsoid</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01154">phantom.h:1154</a></div></div>
<div class="ttc" id="classCube_html"><div class="ttname"><a href="classCube.html">Cube</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01034">phantom.h:1034</a></div></div>
<div class="ttc" id="classDCylinder_html"><div class="ttname"><a href="classDCylinder.html">DCylinder</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00911">phantom.h:911</a></div></div>
<div class="ttc" id="classSphere_html"><div class="ttname"><a href="classSphere.html">Sphere</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00473">phantom.h:473</a></div></div>
<div class="ttc" id="classFeature_html_a2cef017ac20ba675d36573449b186579"><div class="ttname"><a href="classFeature.html#a2cef017ac20ba675d36573449b186579">Feature::Density</a></div><div class="ttdeci">double Density</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00108">phantom.h:108</a></div></div>
<div class="ttc" id="classFeature_html_a7ca340a4eb8c5da25ffe1ab3958e1548"><div class="ttname"><a href="classFeature.html#a7ca340a4eb8c5da25ffe1ab3958e1548">Feature::Add_Assign</a></div><div class="ttdeci">char Add_Assign</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00102">phantom.h:102</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a7ca340a4eb8c5da25ffe1ab3958e1548"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char Feature::Add_Assign</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classFeature.html">Feature</a> behaviour. This flag indicates how the feature behaves inside the voxel volume. If this flag is set to '+' then the voxels occupied by this feature are incremented with the feature value. If the flag is set to '=' then the voxels are set to to the same value of the feature. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l00102">102</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>

</div>
</div>
<a class="anchor" id="a45423ae0a78ea69cbf18bf69ebd13119"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt;double&gt; Feature::Center</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Center of the feature. The center of the feature is understood differently according to the specific class, see them to know exactly how this value is interpreted. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l00113">113</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2cef017ac20ba675d36573449b186579"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Feature::Density</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classFeature.html">Feature</a> Density. Density of the feature in grey level values. It needn't be between 0 and 1, or 0 and 255. What is more, it can be even negative, and so you can build holes inside volumes. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l00108">108</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6171dbc2a0f64c2b7c31fb91573a75c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Feature::max_distance</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Maximum distance from the center. This value is a precalculated and tells the maximum distance from any point belonging to the feature to its center. This is used to speed up some functions not considering voxels which we know are beyond the scope of this feature. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l00120">120</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>

</div>
</div>
<a class="anchor" id="abaec53ba8fbe169f88bfeb526d56f7a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string Feature::Type</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classFeature.html">Feature</a> type. A three letters string telling what kind of feature this object is. For example, "cyl", "con", "cub", ... See the specific classes to know exactly which is each label. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l00095">95</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/yunior/Yunior/Projects/Scipion/COSS/xmipp-bundle/src/xmipp/libraries/data/<a class="el" href="phantom_8h_source.html">phantom.h</a></li>
<li>/home/yunior/Yunior/Projects/Scipion/COSS/xmipp-bundle/src/xmipp/libraries/data/<a class="el" href="phantom_8cpp_source.html">phantom.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
