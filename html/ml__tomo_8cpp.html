<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Xmipp: /home/yunior/Yunior/Projects/Scipion/COSS/xmipp-bundle/src/xmipp/libraries/reconstruction/ml_tomo.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_dbce2b2c1291334a9ade6207c7a262fa.html">xmipp-bundle</a></li><li class="navelem"><a class="el" href="dir_5ca4f3e8e51f1e22c724fe6427eb943c.html">src</a></li><li class="navelem"><a class="el" href="dir_51a4fe91bde3feaf0f23bad87d0144e4.html">xmipp</a></li><li class="navelem"><a class="el" href="dir_c1f8b3d1b5354b6c120dfc6668096234.html">libraries</a></li><li class="navelem"><a class="el" href="dir_36a774f45692ae2527792ff0fdfc392f.html">reconstruction</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">ml_tomo.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="ml__tomo_8h_source.html">ml_tomo.h</a>&quot;</code><br />
<code>#include &lt;<a class="el" href="metadata__extension_8h_source.html">core/metadata_extension.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ml_tomo.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="ml__tomo_8cpp__incl.png" border="0" usemap="#_2home_2yunior_2Yunior_2Projects_2Scipion_2COSS_2xmipp-bundle_2src_2xmipp_2libraries_2reconstruction_2ml__tomo_8cpp" alt=""/></div>
<map name="_2home_2yunior_2Yunior_2Projects_2Scipion_2COSS_2xmipp-bundle_2src_2xmipp_2libraries_2reconstruction_2ml__tomo_8cpp" id="_2home_2yunior_2Yunior_2Projects_2Scipion_2COSS_2xmipp-bundle_2src_2xmipp_2libraries_2reconstruction_2ml__tomo_8cpp">
<area shape="rect" id="node2" href="ml__tomo_8h.html" title="ml_tomo.h" alt="" coords="1487,139,1569,165"/>
<area shape="rect" id="node26" href="metadata__extension_8h.html" title="core/metadata_extension.h" alt="" coords="245,363,424,389"/>
<area shape="rect" id="node3" href="xmipp__fftw_8h.html" title="core/xmipp_fftw.h" alt="" coords="1731,736,1858,763"/>
<area shape="rect" id="node13" href="xmipp__funcs_8h.html" title="xmipp_funcs.h" alt="" coords="939,1109,1045,1136"/>
<area shape="rect" id="node24" href="xmipp__fft_8h.html" title="xmipp_fft.h" alt="" coords="854,811,941,837"/>
<area shape="rect" id="node25" href="args_8h.html" title="core/args.h" alt="" coords="2261,661,2347,688"/>
<area shape="rect" id="node27" href="xmipp__image_8h.html" title="xmipp_image.h" alt="" coords="862,437,973,464"/>
<area shape="rect" id="node30" href="geometry_8h.html" title="geometry.h" alt="" coords="2159,736,2246,763"/>
<area shape="rect" id="node36" href="filters_8h.html" title="data/filters.h" alt="" coords="1481,213,1575,240"/>
<area shape="rect" id="node39" href="xmipp__program_8h.html" title="core/xmipp_program.h" alt="" coords="741,363,891,389"/>
<area shape="rect" id="node41" href="mask_8h.html" title="data/mask.h" alt="" coords="1214,288,1309,315"/>
<area shape="rect" id="node46" href="ctf_8h.html" title="data/ctf.h" alt="" coords="613,288,691,315"/>
<area shape="rect" id="node47" href="sampling_8h.html" title="data/sampling.h" alt="" coords="2379,512,2493,539"/>
<area shape="rect" id="node48" href="ore_2core_2symmetries_8h.html" title="core/symmetries.h" alt="" coords="1933,587,2064,613"/>
<area shape="rect" id="node49" href="symmetrize_8h.html" title="symmetrize.h" alt="" coords="1024,213,1125,240"/>
<area shape="rect" id="node50" href="xmipp__threads_8h.html" title="core/xmipp_threads.h" alt="" coords="2240,363,2387,389"/>
<area shape="rect" id="node6" href="multidim__array_8h.html" title="multidim_array.h" alt="" coords="1391,885,1510,912"/>
<area shape="rect" id="node23" href="multidim__array__generic_8h.html" title="multidim_array_generic.h" alt="" coords="1407,811,1574,837"/>
<area shape="rect" id="node7" href="xmipp__strings_8h.html" title="xmipp_strings.h" alt="" coords="948,1259,1063,1285"/>
<area shape="rect" id="node10" href="matrix1d_8h.html" title="matrix1d.h" alt="" coords="1631,1035,1713,1061"/>
<area shape="rect" id="node22" href="matrix2d_8h.html" title="matrix2d.h" alt="" coords="1521,960,1604,987"/>
<area shape="rect" id="node16" href="xmipp__filename_8h.html" title="xmipp_filename.h" alt="" coords="927,1184,1051,1211"/>
<area shape="rect" id="node18" href="xmipp__macros_8h.html" title="xmipp_macros.h" alt="" coords="1075,1184,1194,1211"/>
<area shape="rect" id="node19" href="xmipp__error_8h.html" title="xmipp_error.h" alt="" coords="1463,1184,1564,1211"/>
<area shape="rect" id="node31" href="metadata_8h.html" title="metadata.h" alt="" coords="773,736,859,763"/>
<area shape="rect" id="node28" href="xmipp__image__base_8h.html" title="xmipp_image_base.h" alt="" coords="905,587,1050,613"/>
<area shape="rect" id="node34" href="xmipp__image__generic_8h.html" title="xmipp_image_generic.h" alt="" coords="955,512,1114,539"/>
<area shape="rect" id="node35" href="xmipp__color_8h.html" title="xmipp_color.h" alt="" coords="457,885,559,912"/>
<area shape="rect" id="node29" href="transformations_8h.html" title="transformations.h" alt="" coords="1631,661,1753,688"/>
<area shape="rect" id="node38" href="histogram_8h.html" title="core/histogram.h" alt="" coords="1443,437,1562,464"/>
<area shape="rect" id="node40" href="numerical__tools_8h.html" title="data/numerical_tools.h" alt="" coords="1991,811,2145,837"/>
<area shape="rect" id="node45" href="polar_8h.html" title="data/polar.h" alt="" coords="1701,587,1792,613"/>
<area shape="rect" id="node42" href="blobs_8h.html" title="blobs.h" alt="" coords="1392,363,1456,389"/>
<area shape="rect" id="node44" href="libraries_2data_2wavelet_8h.html" title="wavelet.h" alt="" coords="1241,512,1319,539"/>
</map>
</div>
</div>
<p><a href="ml__tomo_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2b0a6c4e3b1cb9deda0aa4fa5cd703b3"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ml__tomo_8cpp.html#a2b0a6c4e3b1cb9deda0aa4fa5cd703b3">threadMLTomoExpectationSingleImage</a> (void *data)</td></tr>
<tr class="separator:a2b0a6c4e3b1cb9deda0aa4fa5cd703b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae0b77114d78d4cff4fd1d1808d05b678"><td class="memItemLeft" align="right" valign="top">pthread_mutex_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ml__tomo_8cpp.html#ae0b77114d78d4cff4fd1d1808d05b678">mltomo_weightedsum_update_mutex</a> = PTHREAD_MUTEX_INITIALIZER</td></tr>
<tr class="separator:ae0b77114d78d4cff4fd1d1808d05b678"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af07d07c6859cb36e9759a979d17da8a9"><td class="memItemLeft" align="right" valign="top">pthread_mutex_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ml__tomo_8cpp.html#af07d07c6859cb36e9759a979d17da8a9">mltomo_selfile_access_mutex</a> = PTHREAD_MUTEX_INITIALIZER</td></tr>
<tr class="separator:af07d07c6859cb36e9759a979d17da8a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a2b0a6c4e3b1cb9deda0aa4fa5cd703b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* threadMLTomoExpectationSingleImage </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ml__tomo_8cpp_source.html#l02706">2706</a> of file <a class="el" href="ml__tomo_8cpp_source.html">ml_tomo.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;{</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;    <a class="code" href="structstructThreadExpectationSingleImage.html">structThreadExpectationSingleImage</a> * thread_data =</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;        (<a class="code" href="structstructThreadExpectationSingleImage.html">structThreadExpectationSingleImage</a> *) data;</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;    <span class="comment">// Variables from above</span></div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;    <span class="keywordtype">int</span> thread_id = thread_data-&gt;<a class="code" href="structstructThreadExpectationSingleImage.html#a27316f00dca31a66757d3331afa54964">thread_id</a>;</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;    <a class="code" href="classProgMLTomo.html">ProgMLTomo</a> *<a class="code" href="mpi__classify__CL2D_8cpp.html#a831c08adbb8230fd6a60f4a130923a19">prm</a> = thread_data-&gt;<a class="code" href="structstructThreadExpectationSingleImage.html#aab78fea404f2b613476e616ceee99fb4">prm</a>;</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;    <a class="code" href="classMetaData.html">MetaData</a> *MDimg = thread_data-&gt;<a class="code" href="structstructThreadExpectationSingleImage.html#a83ccc54200b1b094c4f59b7a25cac96c">MDimg</a>;</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    <span class="keywordtype">double</span> *wsum_sigma_noise = thread_data-&gt;<a class="code" href="structstructThreadExpectationSingleImage.html#af4b46d4c56fb8efd54360401c1aad501">wsum_sigma_noise</a>;</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    <span class="keywordtype">double</span> *wsum_sigma_offset = thread_data-&gt;<a class="code" href="structstructThreadExpectationSingleImage.html#aed2dc075575659b6dc70792f6486adbb">wsum_sigma_offset</a>;</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;    <span class="keywordtype">double</span> *sumfracweight = thread_data-&gt;<a class="code" href="structstructThreadExpectationSingleImage.html#ae0e019ac725e9a8d63c099676023ae42">sumfracweight</a>;</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;    <span class="keywordtype">double</span> *LL = thread_data-&gt;<a class="code" href="structstructThreadExpectationSingleImage.html#ab670a3b6aa870724c59f45b5358a9be9">LL</a>;</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;    std::vector&lt;MultidimArray&lt;double&gt; &gt; *wsumimgs = thread_data-&gt;<a class="code" href="structstructThreadExpectationSingleImage.html#aa18d3b5dbdd337c1d2a8b1138390f6cf">wsumimgs</a>;</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;    std::vector&lt;MultidimArray&lt;double&gt; &gt; *wsumweds = thread_data-&gt;<a class="code" href="structstructThreadExpectationSingleImage.html#a6b2786408ebff3b97a8194e495c43bdb">wsumweds</a>;</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;    std::vector&lt;Image&lt;double&gt; &gt; *Iref = thread_data-&gt;<a class="code" href="structstructThreadExpectationSingleImage.html#acd2f6e8ba38e55811a8a821996f4dbff">Iref</a>;</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> *sumw = thread_data-&gt;<a class="code" href="structstructThreadExpectationSingleImage.html#acb66e863f39699d1599c63224336be1c">sumw</a>;</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;    std::vector&lt;size_t&gt; * imgs_id = thread_data-&gt;<a class="code" href="structstructThreadExpectationSingleImage.html#a81cdbc603ab160e624b795f8f70c5dcf">imgs_id</a>;</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;    <a class="code" href="classThreadTaskDistributor.html">ThreadTaskDistributor</a> * <a class="code" href="mpi__write__test_8cpp.html#aa97ceb86d64068bdd8768ab8a93003df">distributor</a> = thread_data-&gt;<a class="code" href="structstructThreadExpectationSingleImage.html#a16a985fffc78ecb6b633e91fa1149452">distributor</a>;</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;    <span class="comment">//#define DEBUG_THREAD</span></div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;<span class="preprocessor">#ifdef DEBUG_THREAD</span></div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;    std::cerr&lt;&lt;<span class="stringliteral">&quot;start threadMLTomoExpectationSingleImage&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;    <span class="comment">// Local variables</span></div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;    <a class="code" href="classImage.html">Image&lt;double&gt;</a> img;</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;    <a class="code" href="classFileName.html">FileName</a> fn_img, fn_trans;</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;    std::vector&lt;MultidimArray&lt;double&gt; &gt; allref_offsets;</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> opt_offsets(3);</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;    <span class="keywordtype">float</span> old_psi = -999.;</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    <span class="keywordtype">double</span> fracweight, trymindiff, dLL;</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;    <span class="keywordtype">int</span> opt_refno, opt_angno, missno;</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;    <span class="comment">//try</span></div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;    {</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;        <span class="comment">//Approximate number of images</span></div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;        <span class="keywordtype">size_t</span> myNum = MDimg-&gt;<a class="code" href="classMetaData.html#ad844b6a5655be4205e4bb03ab6372562">size</a>() / prm-&gt;<a class="code" href="classProgMLTomo.html#ad336d0dd613cc1e5061ece830dcf0ed5">threads</a>;</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;        <span class="comment">//First and last image to process in each block</span></div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;        <span class="keywordtype">size_t</span> firstIndex, lastIndex;</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;        <span class="keywordflow">if</span> (prm-&gt;<a class="code" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a> &amp;&amp; thread_id == 0)</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;            <a class="code" href="group__GeneralFunctions.html#ga8c220fe710ecdb4f9b1696dd53e20ff3">init_progress_bar</a>(myNum);</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;        <span class="comment">// Loop over all images</span></div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;        <span class="keywordtype">size_t</span> cc = 0;</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;        <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;docfiledata = prm-&gt;<a class="code" href="classProgMLTomo.html#a3e0d9d00a8a0176a4bcc3a50d9f4068c">docfiledata</a>;</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;        <span class="comment">//Work while there are tasks to do</span></div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;        <span class="keywordflow">while</span> (distributor-&gt;<a class="code" href="classParallelTaskDistributor.html#a28f70bcc333b8b06d7571db06c67bdc3">getTasks</a>(firstIndex, lastIndex))</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;        {</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imgno = firstIndex; imgno &lt;= lastIndex; ++imgno)</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;            {</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;                <span class="comment">//TODO: Check if really needed the mutexes</span></div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;                <span class="comment">//only for read from MetaData</span></div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;                pthread_mutex_lock(&amp;<a class="code" href="ml__tomo_8cpp.html#af07d07c6859cb36e9759a979d17da8a9">mltomo_selfile_access_mutex</a>);</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;                MDimg-&gt;<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a>, fn_img, (*imgs_id)[imgno + prm-&gt;<a class="code" href="classProgMLTomo.html#ad5401f3244fd557cafc1468efbdbef97">myFirstImg</a>]);</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;                pthread_mutex_unlock(&amp;<a class="code" href="ml__tomo_8cpp.html#af07d07c6859cb36e9759a979d17da8a9">mltomo_selfile_access_mutex</a>);</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;                img.<a class="code" href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">read</a>(fn_img);</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;                img().setXmippOrigin();</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;                <span class="keywordflow">if</span> (prm-&gt;<a class="code" href="classProgMLTomo.html#aa0ba632475ebbfdb60bd4aeac1ab92b9">dont_align</a> || prm-&gt;<a class="code" href="classProgMLTomo.html#ad886603460797b663099437d45b45692">do_only_average</a>)</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;                {</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;                    <a class="code" href="group__GeometricalTransformations.html#gae9f9e35557a7659baf5a1bdbe62e3afc">selfTranslate</a>(<a class="code" href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a>, img(), prm-&gt;<a class="code" href="classProgMLTomo.html#af4a5f9c45b81c9a905eadc484d1fd41f">imgs_optoffsets</a>[imgno], <a class="code" href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a>);</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;                }</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;                prm-&gt;<a class="code" href="classProgMLTomo.html#a2e0bd782eec2005184b8a840ee0edd19">reScaleVolume</a>(img(), <span class="keyword">true</span>);</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;                missno = (prm-&gt;<a class="code" href="classProgMLTomo.html#aac1eefc809a193ff169a03cf22c20f0e">do_missing</a>) ? prm-&gt;<a class="code" href="classProgMLTomo.html#aaf7ae6b1982c6ed19089cbef8bc31898">imgs_missno</a>[imgno] : -1;</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;                <span class="comment">// These three parameters speed up expectationSingleImage</span></div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;                trymindiff = prm-&gt;<a class="code" href="classProgMLTomo.html#a2fe56eac9ae3877bee379d2d54bc738b">imgs_trymindiff</a>[imgno];</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;                opt_refno = prm-&gt;<a class="code" href="classProgMLTomo.html#a235759b7edbfdff6a9fbddfd9c4a44f1">imgs_optrefno</a>[imgno];</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;                opt_angno = prm-&gt;<a class="code" href="classProgMLTomo.html#aac16aacfdde9f2d39fbe875bccdb7a10">imgs_optangno</a>[imgno];</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;                old_psi = prm-&gt;<a class="code" href="classProgMLTomo.html#a02a346b9d9730b598fd57d8847d92676">imgs_optpsi</a>[imgno];</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;                <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (prm-&gt;<a class="code" href="classProgMLTomo.html#ad170e5b1c1ab3b9364929adb377ecfdd">do_ml</a>)</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;                {</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;                    <span class="comment">// A. Use maximum likelihood approach</span></div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;                    prm-&gt;<a class="code" href="classProgMLTomo.html#aa1fa178a3dd70b3bbd9f0f81d5b9a934">expectationSingleImage</a>(img(), imgno, missno, old_psi, *Iref,</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;                                                *wsumimgs, *wsumweds, *wsum_sigma_noise, *wsum_sigma_offset,</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;                                                *sumw, *LL, dLL, fracweight, *sumfracweight, trymindiff,</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;                                                opt_refno, opt_angno, opt_offsets);</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;                }</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;                {</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;                    <span class="comment">// B. Use constrained correlation coefficient approach</span></div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;                    prm-&gt;<a class="code" href="classProgMLTomo.html#af8c9b9d79e2c8fed3ef7ce1d00f69fd0">maxConstrainedCorrSingleImage</a>(img(), imgno, missno, old_psi,</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;                                                       *Iref, *wsumimgs, *wsumweds, *sumw, fracweight, *sumfracweight,</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;                                                       opt_refno, opt_angno, opt_offsets);</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;                }</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;                <span class="comment">// Store for next iteration</span></div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;                prm-&gt;<a class="code" href="classProgMLTomo.html#a2fe56eac9ae3877bee379d2d54bc738b">imgs_trymindiff</a>[imgno] = trymindiff;</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;                prm-&gt;<a class="code" href="classProgMLTomo.html#a235759b7edbfdff6a9fbddfd9c4a44f1">imgs_optrefno</a>[imgno] = opt_refno;</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;                prm-&gt;<a class="code" href="classProgMLTomo.html#aac16aacfdde9f2d39fbe875bccdb7a10">imgs_optangno</a>[imgno] = opt_angno;</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;                <span class="comment">// Output MetaData</span></div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;                <span class="comment">//FIXME: THIS ALSO LIKE JoseMiguel did ML2D</span></div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 0) = (prm-&gt;<a class="code" href="classProgMLTomo.html#ae0499877c83ff29f2fb59b85fe4a3b82">all_angle_info</a>[opt_angno]).rot; <span class="comment">// rot</span></div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 1) = (prm-&gt;<a class="code" href="classProgMLTomo.html#ae0499877c83ff29f2fb59b85fe4a3b82">all_angle_info</a>[opt_angno]).tilt; <span class="comment">// tilt</span></div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 2) = (prm-&gt;<a class="code" href="classProgMLTomo.html#ae0499877c83ff29f2fb59b85fe4a3b82">all_angle_info</a>[opt_angno]).<a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>; <span class="comment">// psi</span></div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;                <span class="keywordflow">if</span> (prm-&gt;<a class="code" href="classProgMLTomo.html#aa0ba632475ebbfdb60bd4aeac1ab92b9">dont_align</a> || prm-&gt;<a class="code" href="classProgMLTomo.html#ad886603460797b663099437d45b45692">do_only_average</a>)</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;                {</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 3) = prm-&gt;<a class="code" href="classProgMLTomo.html#af4a5f9c45b81c9a905eadc484d1fd41f">imgs_optoffsets</a>[imgno](0); <span class="comment">// Xoff</span></div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 4) = prm-&gt;<a class="code" href="classProgMLTomo.html#af4a5f9c45b81c9a905eadc484d1fd41f">imgs_optoffsets</a>[imgno](1); <span class="comment">// Yoff</span></div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 5) = prm-&gt;<a class="code" href="classProgMLTomo.html#af4a5f9c45b81c9a905eadc484d1fd41f">imgs_optoffsets</a>[imgno](2); <span class="comment">// zoff</span></div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;                }</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;                {</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 3) = opt_offsets(0) / prm-&gt;<a class="code" href="classProgMLTomo.html#a5e3c641c916514c3280354773b2f70ee">scale_factor</a>; <span class="comment">// Xoff</span></div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 4) = opt_offsets(1) / prm-&gt;<a class="code" href="classProgMLTomo.html#a5e3c641c916514c3280354773b2f70ee">scale_factor</a>; <span class="comment">// Yoff</span></div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 5) = opt_offsets(2) / prm-&gt;<a class="code" href="classProgMLTomo.html#a5e3c641c916514c3280354773b2f70ee">scale_factor</a>; <span class="comment">// Zoff</span></div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;                }</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 6) = (double) (opt_refno + 1); <span class="comment">// Ref</span></div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 7) = (double) (missno + 1); <span class="comment">// Wedge number</span></div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 8) = fracweight; <span class="comment">// P_max/P_tot</span></div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 9) = dLL; <span class="comment">// log-likelihood</span></div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;                <span class="keywordflow">if</span> (prm-&gt;<a class="code" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a> &amp;&amp; thread_id == 0)</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;                    <a class="code" href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a>(cc);</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;                cc++;</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;            }</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;        }</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;        <span class="keywordflow">if</span> (prm-&gt;<a class="code" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a> &amp;&amp; thread_id == 0)</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;            <a class="code" href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a>(myNum);</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;    }</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;<span class="preprocessor">#ifdef DEBUG_THREAD</span></div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;    std::cerr&lt;&lt;<span class="stringliteral">&quot;finished threadMLTomoExpectationSingleImage&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;}</div><div class="ttc" id="group__GeneralFunctions_html_ga8c220fe710ecdb4f9b1696dd53e20ff3"><div class="ttname"><a href="group__GeneralFunctions.html#ga8c220fe710ecdb4f9b1696dd53e20ff3">init_progress_bar</a></div><div class="ttdeci">void init_progress_bar(long total)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00773">xmipp_funcs.cpp:773</a></div></div>
<div class="ttc" id="classProgMLTomo_html_aac1eefc809a193ff169a03cf22c20f0e"><div class="ttname"><a href="classProgMLTomo.html#aac1eefc809a193ff169a03cf22c20f0e">ProgMLTomo::do_missing</a></div><div class="ttdeci">bool do_missing</div><div class="ttdoc">Internally store all missing wedges or re-compute on the fly? </div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00165">ml_tomo.h:165</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classProgMLTomo_html_a235759b7edbfdff6a9fbddfd9c4a44f1"><div class="ttname"><a href="classProgMLTomo.html#a235759b7edbfdff6a9fbddfd9c4a44f1">ProgMLTomo::imgs_optrefno</a></div><div class="ttdeci">std::vector&lt; int &gt; imgs_optrefno</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00142">ml_tomo.h:142</a></div></div>
<div class="ttc" id="classProgMLTomo_html"><div class="ttname"><a href="classProgMLTomo.html">ProgMLTomo</a></div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00086">ml_tomo.h:86</a></div></div>
<div class="ttc" id="structstructThreadExpectationSingleImage_html_a81cdbc603ab160e624b795f8f70c5dcf"><div class="ttname"><a href="structstructThreadExpectationSingleImage.html#a81cdbc603ab160e624b795f8f70c5dcf">structThreadExpectationSingleImage::imgs_id</a></div><div class="ttdeci">std::vector&lt; size_t &gt; * imgs_id</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00077">ml_tomo.h:77</a></div></div>
<div class="ttc" id="classProgMLTomo_html_aa0ba632475ebbfdb60bd4aeac1ab92b9"><div class="ttname"><a href="classProgMLTomo.html#aa0ba632475ebbfdb60bd4aeac1ab92b9">ProgMLTomo::dont_align</a></div><div class="ttdeci">bool dont_align</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00178">ml_tomo.h:178</a></div></div>
<div class="ttc" id="classProgMLTomo_html_ad886603460797b663099437d45b45692"><div class="ttname"><a href="classProgMLTomo.html#ad886603460797b663099437d45b45692">ProgMLTomo::do_only_average</a></div><div class="ttdeci">bool do_only_average</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00189">ml_tomo.h:189</a></div></div>
<div class="ttc" id="structstructThreadExpectationSingleImage_html_af4b46d4c56fb8efd54360401c1aad501"><div class="ttname"><a href="structstructThreadExpectationSingleImage.html#af4b46d4c56fb8efd54360401c1aad501">structThreadExpectationSingleImage::wsum_sigma_noise</a></div><div class="ttdeci">double * wsum_sigma_noise</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00068">ml_tomo.h:68</a></div></div>
<div class="ttc" id="structstructThreadExpectationSingleImage_html_acd2f6e8ba38e55811a8a821996f4dbff"><div class="ttname"><a href="structstructThreadExpectationSingleImage.html#acd2f6e8ba38e55811a8a821996f4dbff">structThreadExpectationSingleImage::Iref</a></div><div class="ttdeci">std::vector&lt; Image&lt; double &gt; &gt; * Iref</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00074">ml_tomo.h:74</a></div></div>
<div class="ttc" id="classParallelTaskDistributor_html_a28f70bcc333b8b06d7571db06c67bdc3"><div class="ttname"><a href="classParallelTaskDistributor.html#a28f70bcc333b8b06d7571db06c67bdc3">ParallelTaskDistributor::getTasks</a></div><div class="ttdeci">bool getTasks(size_t &amp;first, size_t &amp;last)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8cpp_source.html#l00318">xmipp_threads.cpp:318</a></div></div>
<div class="ttc" id="classProgMLTomo_html_a2e0bd782eec2005184b8a840ee0edd19"><div class="ttname"><a href="classProgMLTomo.html#a2e0bd782eec2005184b8a840ee0edd19">ProgMLTomo::reScaleVolume</a></div><div class="ttdeci">void reScaleVolume(MultidimArray&lt; double &gt; &amp;Min, bool down_scale=true)</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8cpp_source.html#l01754">ml_tomo.cpp:1754</a></div></div>
<div class="ttc" id="structstructThreadExpectationSingleImage_html_a6b2786408ebff3b97a8194e495c43bdb"><div class="ttname"><a href="structstructThreadExpectationSingleImage.html#a6b2786408ebff3b97a8194e495c43bdb">structThreadExpectationSingleImage::wsumweds</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; double &gt; &gt; * wsumweds</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00073">ml_tomo.h:73</a></div></div>
<div class="ttc" id="classProgMLTomo_html_a3e0d9d00a8a0176a4bcc3a50d9f4068c"><div class="ttname"><a href="classProgMLTomo.html#a3e0d9d00a8a0176a4bcc3a50d9f4068c">ProgMLTomo::docfiledata</a></div><div class="ttdeci">MultidimArray&lt; double &gt; docfiledata</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00123">ml_tomo.h:123</a></div></div>
<div class="ttc" id="classMetaData_html"><div class="ttname"><a href="classMetaData.html">MetaData</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00234">metadata.h:234</a></div></div>
<div class="ttc" id="classProgMLTomo_html_aa1fa178a3dd70b3bbd9f0f81d5b9a934"><div class="ttname"><a href="classProgMLTomo.html#aa1fa178a3dd70b3bbd9f0f81d5b9a934">ProgMLTomo::expectationSingleImage</a></div><div class="ttdeci">void expectationSingleImage(MultidimArray&lt; double &gt; &amp;Mimg, int imgno, const int missno, double old_rot, std::vector&lt; Image&lt; double &gt; &gt; &amp;Iref, std::vector&lt; MultidimArray&lt; double &gt; &gt; &amp;wsumimgs, std::vector&lt; MultidimArray&lt; double &gt; &gt; &amp;wsumweds, double &amp;wsum_sigma_noise, double &amp;wsum_sigma_offset, MultidimArray&lt; double &gt; &amp;sumw, double &amp;LL, double &amp;dLL, double &amp;fracweight, double &amp;sumfracweight, double &amp;trymindiff, int &amp;opt_refno, int &amp;opt_angno, Matrix1D&lt; double &gt; &amp;opt_offsets)</div><div class="ttdoc">ML-integration over all hidden parameters. </div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8cpp_source.html#l01994">ml_tomo.cpp:1994</a></div></div>
<div class="ttc" id="mpi__write__test_8cpp_html_aa97ceb86d64068bdd8768ab8a93003df"><div class="ttname"><a href="mpi__write__test_8cpp.html#aa97ceb86d64068bdd8768ab8a93003df">distributor</a></div><div class="ttdeci">ParallelTaskDistributor * distributor</div><div class="ttdef"><b>Definition:</b> <a href="mpi__write__test_8cpp_source.html#l00054">mpi_write_test.cpp:54</a></div></div>
<div class="ttc" id="classProgMLTomo_html_af4a5f9c45b81c9a905eadc484d1fd41f"><div class="ttname"><a href="classProgMLTomo.html#af4a5f9c45b81c9a905eadc484d1fd41f">ProgMLTomo::imgs_optoffsets</a></div><div class="ttdeci">std::vector&lt; Matrix1D&lt; double &gt; &gt; imgs_optoffsets</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00144">ml_tomo.h:144</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00068">xmipp_filename.h:68</a></div></div>
<div class="ttc" id="structstructThreadExpectationSingleImage_html_aa18d3b5dbdd337c1d2a8b1138390f6cf"><div class="ttname"><a href="structstructThreadExpectationSingleImage.html#aa18d3b5dbdd337c1d2a8b1138390f6cf">structThreadExpectationSingleImage::wsumimgs</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; double &gt; &gt; * wsumimgs</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00072">ml_tomo.h:72</a></div></div>
<div class="ttc" id="classProgMLTomo_html_aaf7ae6b1982c6ed19089cbef8bc31898"><div class="ttname"><a href="classProgMLTomo.html#aaf7ae6b1982c6ed19089cbef8bc31898">ProgMLTomo::imgs_missno</a></div><div class="ttdeci">std::vector&lt; int &gt; imgs_missno</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00146">ml_tomo.h:146</a></div></div>
<div class="ttc" id="classProgMLTomo_html_af8c9b9d79e2c8fed3ef7ce1d00f69fd0"><div class="ttname"><a href="classProgMLTomo.html#af8c9b9d79e2c8fed3ef7ce1d00f69fd0">ProgMLTomo::maxConstrainedCorrSingleImage</a></div><div class="ttdeci">void maxConstrainedCorrSingleImage(MultidimArray&lt; double &gt; &amp;Mimg, int imgno, int missno, double old_rot, std::vector&lt; Image&lt; double &gt; &gt; &amp;Iref, std::vector&lt; MultidimArray&lt; double &gt; &gt; &amp;wsumimgs, std::vector&lt; MultidimArray&lt; double &gt; &gt; &amp;wsumweds, MultidimArray&lt; double &gt; &amp;sumw, double &amp;maxCC, double &amp;sumCC, int &amp;opt_refno, int &amp;opt_angno, Matrix1D&lt; double &gt; &amp;opt_offsets)</div><div class="ttdoc">Maximum constrained correlation search over all hidden parameters. </div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8cpp_source.html#l02428">ml_tomo.cpp:2428</a></div></div>
<div class="ttc" id="ml__tomo_8cpp_html_af07d07c6859cb36e9759a979d17da8a9"><div class="ttname"><a href="ml__tomo_8cpp.html#af07d07c6859cb36e9759a979d17da8a9">mltomo_selfile_access_mutex</a></div><div class="ttdeci">pthread_mutex_t mltomo_selfile_access_mutex</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8cpp_source.html#l00032">ml_tomo.cpp:32</a></div></div>
<div class="ttc" id="classMetaData_html_a2239fbb7e492654f1e2866ab27492a5d"><div class="ttname"><a href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">MetaData::getValue</a></div><div class="ttdeci">bool getValue(MDObject &amp;mdValueOut, size_t id) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00217">metadata.cpp:217</a></div></div>
<div class="ttc" id="classThreadTaskDistributor_html"><div class="ttname"><a href="classThreadTaskDistributor.html">ThreadTaskDistributor</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8h_source.html#l00451">xmipp_threads.h:451</a></div></div>
<div class="ttc" id="structstructThreadExpectationSingleImage_html_ae0e019ac725e9a8d63c099676023ae42"><div class="ttname"><a href="structstructThreadExpectationSingleImage.html#ae0e019ac725e9a8d63c099676023ae42">structThreadExpectationSingleImage::sumfracweight</a></div><div class="ttdeci">double * sumfracweight</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00070">ml_tomo.h:70</a></div></div>
<div class="ttc" id="classProgMLTomo_html_a02a346b9d9730b598fd57d8847d92676"><div class="ttname"><a href="classProgMLTomo.html#a02a346b9d9730b598fd57d8847d92676">ProgMLTomo::imgs_optpsi</a></div><div class="ttdeci">std::vector&lt; double &gt; imgs_optpsi</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00143">ml_tomo.h:143</a></div></div>
<div class="ttc" id="classProgMLTomo_html_ad5401f3244fd557cafc1468efbdbef97"><div class="ttname"><a href="classProgMLTomo.html#ad5401f3244fd557cafc1468efbdbef97">ProgMLTomo::myFirstImg</a></div><div class="ttdeci">size_t myFirstImg</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00121">ml_tomo.h:121</a></div></div>
<div class="ttc" id="classMetaData_html_ad844b6a5655be4205e4bb03ab6372562"><div class="ttname"><a href="classMetaData.html#ad844b6a5655be4205e4bb03ab6372562">MetaData::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00702">metadata.cpp:702</a></div></div>
<div class="ttc" id="classProgMLTomo_html_a5e3c641c916514c3280354773b2f70ee"><div class="ttname"><a href="classProgMLTomo.html#a5e3c641c916514c3280354773b2f70ee">ProgMLTomo::scale_factor</a></div><div class="ttdeci">double scale_factor</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00173">ml_tomo.h:173</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga3bdba82f045e73fb216c6be539e6b129"><div class="ttname"><a href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a></div><div class="ttdeci">void progress_bar(long rlen)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00782">xmipp_funcs.cpp:782</a></div></div>
<div class="ttc" id="classProgMLTomo_html_ad336d0dd613cc1e5061ece830dcf0ed5"><div class="ttname"><a href="classProgMLTomo.html#ad336d0dd613cc1e5061ece830dcf0ed5">ProgMLTomo::threads</a></div><div class="ttdeci">int threads</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00243">ml_tomo.h:243</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gac645eb9a88619ee6f5e14c557ab8ef62"><div class="ttname"><a href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a></div><div class="ttdeci">#define LINEAR</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00208">transformations.h:208</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gafa02b309a507bf04daf9f31fa828ce4f"><div class="ttname"><a href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a></div><div class="ttdeci">#define dAij(M, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00355">multidim_array.h:355</a></div></div>
<div class="ttc" id="classXmippProgram_html_aed62cfe3c074e69076bf348fc101a717"><div class="ttname"><a href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">XmippProgram::verbose</a></div><div class="ttdeci">int verbose</div><div class="ttdoc">Verbosity level. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8h_source.html#l00168">xmipp_program.h:168</a></div></div>
<div class="ttc" id="structstructThreadExpectationSingleImage_html"><div class="ttname"><a href="structstructThreadExpectationSingleImage.html">structThreadExpectationSingleImage</a></div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00061">ml_tomo.h:61</a></div></div>
<div class="ttc" id="classProgMLTomo_html_ad170e5b1c1ab3b9364929adb377ecfdd"><div class="ttname"><a href="classProgMLTomo.html#ad170e5b1c1ab3b9364929adb377ecfdd">ProgMLTomo::do_ml</a></div><div class="ttdeci">bool do_ml</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00169">ml_tomo.h:169</a></div></div>
<div class="ttc" id="structstructThreadExpectationSingleImage_html_a27316f00dca31a66757d3331afa54964"><div class="ttname"><a href="structstructThreadExpectationSingleImage.html#a27316f00dca31a66757d3331afa54964">structThreadExpectationSingleImage::thread_id</a></div><div class="ttdeci">int thread_id</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00063">ml_tomo.h:63</a></div></div>
<div class="ttc" id="structstructThreadExpectationSingleImage_html_a16a985fffc78ecb6b633e91fa1149452"><div class="ttname"><a href="structstructThreadExpectationSingleImage.html#a16a985fffc78ecb6b633e91fa1149452">structThreadExpectationSingleImage::distributor</a></div><div class="ttdeci">ThreadTaskDistributor * distributor</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00078">ml_tomo.h:78</a></div></div>
<div class="ttc" id="transformations_8h_html_a9fbfdbc149e55def0e63127fcb558d13"><div class="ttname"><a href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a></div><div class="ttdeci">#define DONT_WRAP</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00042">transformations.h:42</a></div></div>
<div class="ttc" id="classProgMLTomo_html_a2fe56eac9ae3877bee379d2d54bc738b"><div class="ttname"><a href="classProgMLTomo.html#a2fe56eac9ae3877bee379d2d54bc738b">ProgMLTomo::imgs_trymindiff</a></div><div class="ttdeci">std::vector&lt; double &gt; imgs_trymindiff</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00143">ml_tomo.h:143</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gae9f9e35557a7659baf5a1bdbe62e3afc"><div class="ttname"><a href="group__GeometricalTransformations.html#gae9f9e35557a7659baf5a1bdbe62e3afc">selfTranslate</a></div><div class="ttdeci">void selfTranslate(int SplineDegree, MultidimArray&lt; T &gt; &amp;V1, const Matrix1D&lt; double &gt; &amp;v, bool wrap=WRAP, T outside=0)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01176">transformations.h:1176</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="structstructThreadExpectationSingleImage_html_aab78fea404f2b613476e616ceee99fb4"><div class="ttname"><a href="structstructThreadExpectationSingleImage.html#aab78fea404f2b613476e616ceee99fb4">structThreadExpectationSingleImage::prm</a></div><div class="ttdeci">ProgMLTomo * prm</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00065">ml_tomo.h:65</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="structstructThreadExpectationSingleImage_html_a83ccc54200b1b094c4f59b7a25cac96c"><div class="ttname"><a href="structstructThreadExpectationSingleImage.html#a83ccc54200b1b094c4f59b7a25cac96c">structThreadExpectationSingleImage::MDimg</a></div><div class="ttdeci">MetaData * MDimg</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00066">ml_tomo.h:66</a></div></div>
<div class="ttc" id="structstructThreadExpectationSingleImage_html_ab670a3b6aa870724c59f45b5358a9be9"><div class="ttname"><a href="structstructThreadExpectationSingleImage.html#ab670a3b6aa870724c59f45b5358a9be9">structThreadExpectationSingleImage::LL</a></div><div class="ttdeci">double * LL</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00071">ml_tomo.h:71</a></div></div>
<div class="ttc" id="classImageBase_html_a88636b7a7bd4e0e454877e691ee2da84"><div class="ttname"><a href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">ImageBase::read</a></div><div class="ttdeci">int read(const FileName &amp;name, DataMode datamode=DATA, size_t select_img=ALL_IMAGES, bool mapData=false, int mode=WRITE_READONLY)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00061">xmipp_image_base.cpp:61</a></div></div>
<div class="ttc" id="classProgMLTomo_html_ae0499877c83ff29f2fb59b85fe4a3b82"><div class="ttname"><a href="classProgMLTomo.html#ae0499877c83ff29f2fb59b85fe4a3b82">ProgMLTomo::all_angle_info</a></div><div class="ttdeci">AnglesInfoVector all_angle_info</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00222">ml_tomo.h:222</a></div></div>
<div class="ttc" id="classProgMLTomo_html_aac16aacfdde9f2d39fbe875bccdb7a10"><div class="ttname"><a href="classProgMLTomo.html#aac16aacfdde9f2d39fbe875bccdb7a10">ProgMLTomo::imgs_optangno</a></div><div class="ttdeci">std::vector&lt; int &gt; imgs_optangno</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00142">ml_tomo.h:142</a></div></div>
<div class="ttc" id="mpi__classify__CL2D_8cpp_html_a831c08adbb8230fd6a60f4a130923a19"><div class="ttname"><a href="mpi__classify__CL2D_8cpp.html#a831c08adbb8230fd6a60f4a130923a19">prm</a></div><div class="ttdeci">ProgClassifyCL2D * prm</div><div class="ttdef"><b>Definition:</b> <a href="mpi__classify__CL2D_8cpp_source.html#l00033">mpi_classify_CL2D.cpp:33</a></div></div>
<div class="ttc" id="structstructThreadExpectationSingleImage_html_aed2dc075575659b6dc70792f6486adbb"><div class="ttname"><a href="structstructThreadExpectationSingleImage.html#aed2dc075575659b6dc70792f6486adbb">structThreadExpectationSingleImage::wsum_sigma_offset</a></div><div class="ttdeci">double * wsum_sigma_offset</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00069">ml_tomo.h:69</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a></div><div class="ttdoc">Name of an image (std::string) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00235">metadata_label.h:235</a></div></div>
<div class="ttc" id="structstructThreadExpectationSingleImage_html_acb66e863f39699d1599c63224336be1c"><div class="ttname"><a href="structstructThreadExpectationSingleImage.html#acb66e863f39699d1599c63224336be1c">structThreadExpectationSingleImage::sumw</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * sumw</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00076">ml_tomo.h:76</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="af07d07c6859cb36e9759a979d17da8a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pthread_mutex_t mltomo_selfile_access_mutex = PTHREAD_MUTEX_INITIALIZER</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ml__tomo_8cpp_source.html#l00032">32</a> of file <a class="el" href="ml__tomo_8cpp_source.html">ml_tomo.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae0b77114d78d4cff4fd1d1808d05b678"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pthread_mutex_t mltomo_weightedsum_update_mutex = PTHREAD_MUTEX_INITIALIZER</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ml__tomo_8cpp_source.html#l00031">31</a> of file <a class="el" href="ml__tomo_8cpp_source.html">ml_tomo.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
