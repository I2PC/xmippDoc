<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Xmipp: xmipp/legacy/libraries/reconstruction/ml_tomo.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5bce755d3f27cf36e7d1a940cfd4182d.html">xmipp</a></li><li class="navelem"><a class="el" href="dir_5ee8c3a986de9cbc18000e453191b32c.html">legacy</a></li><li class="navelem"><a class="el" href="dir_ec5db26cfb72886407809adaaec84b8a.html">libraries</a></li><li class="navelem"><a class="el" href="dir_446be90e67127eeb24a96d3bc4d45a1b.html">reconstruction</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">ml_tomo.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="ml__tomo_8h_source.html">ml_tomo.h</a>&quot;</code><br />
<code>#include &lt;<a class="el" href="metadata__extension_8h_source.html">core/metadata_extension.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="metadata__sql_8h_source.html">core/metadata_sql.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ml_tomo.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="ml__tomo_8cpp__incl.png" border="0" usemap="#xmipp_2legacy_2libraries_2reconstruction_2ml__tomo_8cpp" alt=""/></div>
<map name="xmipp_2legacy_2libraries_2reconstruction_2ml__tomo_8cpp" id="xmipp_2legacy_2libraries_2reconstruction_2ml__tomo_8cpp">
</map>
</div>
</div>
<p><a href="ml__tomo_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2b0a6c4e3b1cb9deda0aa4fa5cd703b3"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ml__tomo_8cpp.html#a2b0a6c4e3b1cb9deda0aa4fa5cd703b3">threadMLTomoExpectationSingleImage</a> (void *data)</td></tr>
<tr class="separator:a2b0a6c4e3b1cb9deda0aa4fa5cd703b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae0b77114d78d4cff4fd1d1808d05b678"><td class="memItemLeft" align="right" valign="top">pthread_mutex_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ml__tomo_8cpp.html#ae0b77114d78d4cff4fd1d1808d05b678">mltomo_weightedsum_update_mutex</a> = PTHREAD_MUTEX_INITIALIZER</td></tr>
<tr class="separator:ae0b77114d78d4cff4fd1d1808d05b678"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af07d07c6859cb36e9759a979d17da8a9"><td class="memItemLeft" align="right" valign="top">pthread_mutex_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ml__tomo_8cpp.html#af07d07c6859cb36e9759a979d17da8a9">mltomo_selfile_access_mutex</a> = PTHREAD_MUTEX_INITIALIZER</td></tr>
<tr class="separator:af07d07c6859cb36e9759a979d17da8a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a2b0a6c4e3b1cb9deda0aa4fa5cd703b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b0a6c4e3b1cb9deda0aa4fa5cd703b3">&#9670;&nbsp;</a></span>threadMLTomoExpectationSingleImage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* threadMLTomoExpectationSingleImage </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ml__tomo_8cpp_source.html#l02702">2702</a> of file <a class="el" href="ml__tomo_8cpp_source.html">ml_tomo.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;{</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;    <span class="keyword">auto</span> * thread_data =</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;        (<a class="code" href="structstructThreadExpectationSingleImage.html">structThreadExpectationSingleImage</a> *) data;</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;    <span class="comment">// Variables from above</span></div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;    <span class="keywordtype">int</span> thread_id = thread_data-&gt;thread_id;</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;    <a class="code" href="classProgMLTomo.html">ProgMLTomo</a> *<a class="code" href="mpi__classify__CL2D_8cpp.html#a831c08adbb8230fd6a60f4a130923a19">prm</a> = thread_data-&gt;prm;</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    <a class="code" href="classMetaDataVec.html">MetaDataVec</a> *MDimg = thread_data-&gt;MDimg;</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;    <span class="keywordtype">double</span> *wsum_sigma_noise = thread_data-&gt;wsum_sigma_noise;</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;    <span class="keywordtype">double</span> *wsum_sigma_offset = thread_data-&gt;wsum_sigma_offset;</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;    <span class="keywordtype">double</span> *sumfracweight = thread_data-&gt;sumfracweight;</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;    <span class="keywordtype">double</span> *LL = thread_data-&gt;LL;</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    std::vector&lt;MultidimArray&lt;double&gt; &gt; *wsumimgs = thread_data-&gt;wsumimgs;</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    std::vector&lt;MultidimArray&lt;double&gt; &gt; *wsumweds = thread_data-&gt;wsumweds;</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;    std::vector&lt;Image&lt;double&gt; &gt; *Iref = thread_data-&gt;Iref;</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> *sumw = thread_data-&gt;sumw;</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;    std::vector&lt;size_t&gt; * imgs_id = thread_data-&gt;imgs_id;</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;    <a class="code" href="classThreadTaskDistributor.html">ThreadTaskDistributor</a> * <a class="code" href="mpi__write__test_8cpp.html#aa97ceb86d64068bdd8768ab8a93003df">distributor</a> = thread_data-&gt;distributor;</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;    <span class="comment">//#define DEBUG_THREAD</span></div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;<span class="preprocessor">#ifdef DEBUG_THREAD</span></div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;    std::cerr&lt;&lt;<span class="stringliteral">&quot;start threadMLTomoExpectationSingleImage&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;    <span class="comment">// Local variables</span></div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;    <a class="code" href="classImage.html">Image&lt;double&gt;</a> img;</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;    <a class="code" href="classFileName.html">FileName</a> fn_img, fn_trans;</div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;    std::vector&lt;MultidimArray&lt;double&gt; &gt; allref_offsets;</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> opt_offsets(3);</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;    <span class="keywordtype">float</span> old_psi = -999.;</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;    <span class="keywordtype">double</span> fracweight, trymindiff, dLL;</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;    <span class="keywordtype">int</span> opt_refno, opt_angno, missno;</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;    <span class="comment">//try</span></div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    {</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;        <span class="comment">//Approximate number of images</span></div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;        <span class="keywordtype">size_t</span> myNum = MDimg-&gt;<a class="code" href="classMetaDataVec.html#a6dadeeb468ea65886b16518818b84111">size</a>() / prm-&gt;<a class="code" href="classProgMLTomo.html#ad336d0dd613cc1e5061ece830dcf0ed5">threads</a>;</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;        <span class="comment">//First and last image to process in each block</span></div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;        <span class="keywordtype">size_t</span> firstIndex, lastIndex;</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;        <span class="keywordflow">if</span> (prm-&gt;<a class="code" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a> &amp;&amp; thread_id == 0)</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;            <a class="code" href="group__GeneralFunctions.html#ga8c220fe710ecdb4f9b1696dd53e20ff3">init_progress_bar</a>(myNum);</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;        <span class="comment">// Loop over all images</span></div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;        <span class="keywordtype">size_t</span> cc = 0;</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;        <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;docfiledata = prm-&gt;<a class="code" href="classProgMLTomo.html#a3e0d9d00a8a0176a4bcc3a50d9f4068c">docfiledata</a>;</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;        <span class="comment">//Work while there are tasks to do</span></div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;        <span class="keywordflow">while</span> (distributor-&gt;<a class="code" href="classParallelTaskDistributor.html#a28f70bcc333b8b06d7571db06c67bdc3">getTasks</a>(firstIndex, lastIndex))</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;        {</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> imgno = firstIndex; imgno &lt;= lastIndex; ++imgno)</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;            {</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;                <span class="comment">//TODO: Check if really needed the mutexes</span></div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;                <span class="comment">//only for read from MetaData</span></div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;                pthread_mutex_lock(&amp;<a class="code" href="ml__tomo_8cpp.html#af07d07c6859cb36e9759a979d17da8a9">mltomo_selfile_access_mutex</a>);</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;                MDimg-&gt;<a class="code" href="classMetaDataVec.html#a71728ad7664da6eba90ec1dbc787d434">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a>, fn_img, (*imgs_id)[imgno + prm-&gt;<a class="code" href="classProgMLTomo.html#ad5401f3244fd557cafc1468efbdbef97">myFirstImg</a>]);</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;                pthread_mutex_unlock(&amp;<a class="code" href="ml__tomo_8cpp.html#af07d07c6859cb36e9759a979d17da8a9">mltomo_selfile_access_mutex</a>);</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;                img.<a class="code" href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">read</a>(fn_img);</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;                img().setXmippOrigin();</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;                <span class="keywordflow">if</span> (prm-&gt;<a class="code" href="classProgMLTomo.html#aa0ba632475ebbfdb60bd4aeac1ab92b9">dont_align</a> || prm-&gt;<a class="code" href="classProgMLTomo.html#ad886603460797b663099437d45b45692">do_only_average</a>)</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;                {</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;                    <a class="code" href="group__GeometricalTransformations.html#ga5751842c11a31f5d7ce95a1f8ccbe67d">selfTranslate</a>(<a class="code" href="namespacexmipp__transformation.html#ac5f2bd2937d73c34ed4f6c6c5ff2492aaffcd115cf9fbf6a51a8b2862062acc74">xmipp_transformation::LINEAR</a>, img(), prm-&gt;<a class="code" href="classProgMLTomo.html#af4a5f9c45b81c9a905eadc484d1fd41f">imgs_optoffsets</a>[imgno], xmipp_transformation::DONT_WRAP);</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;                }</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;                prm-&gt;<a class="code" href="classProgMLTomo.html#a2e0bd782eec2005184b8a840ee0edd19">reScaleVolume</a>(img(), <span class="keyword">true</span>);</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;                missno = (prm-&gt;<a class="code" href="classProgMLTomo.html#aac1eefc809a193ff169a03cf22c20f0e">do_missing</a>) ? prm-&gt;<a class="code" href="classProgMLTomo.html#aaf7ae6b1982c6ed19089cbef8bc31898">imgs_missno</a>[imgno] : -1;</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;                <span class="comment">// These three parameters speed up expectationSingleImage</span></div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;                trymindiff = prm-&gt;<a class="code" href="classProgMLTomo.html#a2fe56eac9ae3877bee379d2d54bc738b">imgs_trymindiff</a>[imgno];</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;                opt_refno = prm-&gt;<a class="code" href="classProgMLTomo.html#a235759b7edbfdff6a9fbddfd9c4a44f1">imgs_optrefno</a>[imgno];</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;                opt_angno = prm-&gt;<a class="code" href="classProgMLTomo.html#aac16aacfdde9f2d39fbe875bccdb7a10">imgs_optangno</a>[imgno];</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;                old_psi = prm-&gt;<a class="code" href="classProgMLTomo.html#a02a346b9d9730b598fd57d8847d92676">imgs_optpsi</a>[imgno];</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;                <a class="code" href="numerical__recipes_8cpp.html#a83598b308cacef6d6b356c3455bf5a7c">if</a> (prm-&gt;<a class="code" href="classProgMLTomo.html#ad170e5b1c1ab3b9364929adb377ecfdd">do_ml</a>)</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;                {</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;                    <span class="comment">// A. Use maximum likelihood approach</span></div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;                    prm-&gt;<a class="code" href="classProgMLTomo.html#aa1fa178a3dd70b3bbd9f0f81d5b9a934">expectationSingleImage</a>(img(), imgno, missno, old_psi, *Iref,</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;                                                *wsumimgs, *wsumweds, *wsum_sigma_noise, *wsum_sigma_offset,</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;                                                *sumw, *LL, dLL, fracweight, *sumfracweight, trymindiff,</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;                                                opt_refno, opt_angno, opt_offsets);</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;                }</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;                {</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;                    <span class="comment">// B. Use constrained correlation coefficient approach</span></div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;                    prm-&gt;<a class="code" href="classProgMLTomo.html#af8c9b9d79e2c8fed3ef7ce1d00f69fd0">maxConstrainedCorrSingleImage</a>(img(), imgno, missno, old_psi,</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;                                                       *Iref, *wsumimgs, *wsumweds, *sumw, fracweight, *sumfracweight,</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;                                                       opt_refno, opt_angno, opt_offsets);</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;                }</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;                <span class="comment">// Store for next iteration</span></div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;                prm-&gt;<a class="code" href="classProgMLTomo.html#a2fe56eac9ae3877bee379d2d54bc738b">imgs_trymindiff</a>[imgno] = trymindiff;</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;                prm-&gt;<a class="code" href="classProgMLTomo.html#a235759b7edbfdff6a9fbddfd9c4a44f1">imgs_optrefno</a>[imgno] = opt_refno;</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;                prm-&gt;<a class="code" href="classProgMLTomo.html#aac16aacfdde9f2d39fbe875bccdb7a10">imgs_optangno</a>[imgno] = opt_angno;</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;                <span class="comment">// Output MetaData</span></div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;                <span class="comment">//FIXME: THIS ALSO LIKE JoseMiguel did ML2D</span></div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;                <a class="code" href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 0) = (prm-&gt;<a class="code" href="classProgMLTomo.html#ae0499877c83ff29f2fb59b85fe4a3b82">all_angle_info</a>[opt_angno]).rot; <span class="comment">// rot</span></div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;                <a class="code" href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 1) = (prm-&gt;<a class="code" href="classProgMLTomo.html#ae0499877c83ff29f2fb59b85fe4a3b82">all_angle_info</a>[opt_angno]).tilt; <span class="comment">// tilt</span></div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;                <a class="code" href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 2) = (prm-&gt;<a class="code" href="classProgMLTomo.html#ae0499877c83ff29f2fb59b85fe4a3b82">all_angle_info</a>[opt_angno]).<a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>; <span class="comment">// psi</span></div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;                <span class="keywordflow">if</span> (prm-&gt;<a class="code" href="classProgMLTomo.html#aa0ba632475ebbfdb60bd4aeac1ab92b9">dont_align</a> || prm-&gt;<a class="code" href="classProgMLTomo.html#ad886603460797b663099437d45b45692">do_only_average</a>)</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;                {</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;                    <a class="code" href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 3) = prm-&gt;<a class="code" href="classProgMLTomo.html#af4a5f9c45b81c9a905eadc484d1fd41f">imgs_optoffsets</a>[imgno](0); <span class="comment">// Xoff</span></div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;                    <a class="code" href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 4) = prm-&gt;<a class="code" href="classProgMLTomo.html#af4a5f9c45b81c9a905eadc484d1fd41f">imgs_optoffsets</a>[imgno](1); <span class="comment">// Yoff</span></div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;                    <a class="code" href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 5) = prm-&gt;<a class="code" href="classProgMLTomo.html#af4a5f9c45b81c9a905eadc484d1fd41f">imgs_optoffsets</a>[imgno](2); <span class="comment">// zoff</span></div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;                }</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;                {</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;                    <a class="code" href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 3) = opt_offsets(0) / prm-&gt;<a class="code" href="classProgMLTomo.html#a5e3c641c916514c3280354773b2f70ee">scale_factor</a>; <span class="comment">// Xoff</span></div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;                    <a class="code" href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 4) = opt_offsets(1) / prm-&gt;<a class="code" href="classProgMLTomo.html#a5e3c641c916514c3280354773b2f70ee">scale_factor</a>; <span class="comment">// Yoff</span></div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;                    <a class="code" href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 5) = opt_offsets(2) / prm-&gt;<a class="code" href="classProgMLTomo.html#a5e3c641c916514c3280354773b2f70ee">scale_factor</a>; <span class="comment">// Zoff</span></div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;                }</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;                <a class="code" href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 6) = (double) (opt_refno + 1); <span class="comment">// Ref</span></div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;                <a class="code" href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 7) = (double) (missno + 1); <span class="comment">// Wedge number</span></div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;                <a class="code" href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 8) = fracweight; <span class="comment">// P_max/P_tot</span></div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;                <a class="code" href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a>(docfiledata, imgno, 9) = dLL; <span class="comment">// log-likelihood</span></div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;                <span class="keywordflow">if</span> (prm-&gt;<a class="code" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a> &amp;&amp; thread_id == 0)</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;                    <a class="code" href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a>(cc);</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;                cc++;</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;            }</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;        }</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;        <span class="keywordflow">if</span> (prm-&gt;<a class="code" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a> &amp;&amp; thread_id == 0)</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;            <a class="code" href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a>(myNum);</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;    }</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;<span class="preprocessor">#ifdef DEBUG_THREAD</span></div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;    std::cerr&lt;&lt;<span class="stringliteral">&quot;finished threadMLTomoExpectationSingleImage&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;}</div><div class="ttc" id="group__GeneralFunctions_html_ga8c220fe710ecdb4f9b1696dd53e20ff3"><div class="ttname"><a href="group__GeneralFunctions.html#ga8c220fe710ecdb4f9b1696dd53e20ff3">init_progress_bar</a></div><div class="ttdeci">void init_progress_bar(long total)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00782">xmipp_funcs.cpp:782</a></div></div>
<div class="ttc" id="classProgMLTomo_html_aac1eefc809a193ff169a03cf22c20f0e"><div class="ttname"><a href="classProgMLTomo.html#aac1eefc809a193ff169a03cf22c20f0e">ProgMLTomo::do_missing</a></div><div class="ttdeci">bool do_missing</div><div class="ttdoc">Internally store all missing wedges or re-compute on the fly? </div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00165">ml_tomo.h:165</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classProgMLTomo_html_a235759b7edbfdff6a9fbddfd9c4a44f1"><div class="ttname"><a href="classProgMLTomo.html#a235759b7edbfdff6a9fbddfd9c4a44f1">ProgMLTomo::imgs_optrefno</a></div><div class="ttdeci">std::vector&lt; int &gt; imgs_optrefno</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00142">ml_tomo.h:142</a></div></div>
<div class="ttc" id="classProgMLTomo_html"><div class="ttname"><a href="classProgMLTomo.html">ProgMLTomo</a></div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00086">ml_tomo.h:86</a></div></div>
<div class="ttc" id="classProgMLTomo_html_aa0ba632475ebbfdb60bd4aeac1ab92b9"><div class="ttname"><a href="classProgMLTomo.html#aa0ba632475ebbfdb60bd4aeac1ab92b9">ProgMLTomo::dont_align</a></div><div class="ttdeci">bool dont_align</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00178">ml_tomo.h:178</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_afa02b309a507bf04daf9f31fa828ce4f"><div class="ttname"><a href="multidim__array__base_8h.html#afa02b309a507bf04daf9f31fa828ce4f">dAij</a></div><div class="ttdeci">#define dAij(M, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00345">multidim_array_base.h:345</a></div></div>
<div class="ttc" id="classProgMLTomo_html_ad886603460797b663099437d45b45692"><div class="ttname"><a href="classProgMLTomo.html#ad886603460797b663099437d45b45692">ProgMLTomo::do_only_average</a></div><div class="ttdeci">bool do_only_average</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00189">ml_tomo.h:189</a></div></div>
<div class="ttc" id="namespacexmipp__transformation_html_ac5f2bd2937d73c34ed4f6c6c5ff2492aaffcd115cf9fbf6a51a8b2862062acc74"><div class="ttname"><a href="namespacexmipp__transformation.html#ac5f2bd2937d73c34ed4f6c6c5ff2492aaffcd115cf9fbf6a51a8b2862062acc74">xmipp_transformation::LINEAR</a></div><div class="ttdef"><b>Definition:</b> <a href="transformations__defines_8h_source.html#l00032">transformations_defines.h:32</a></div></div>
<div class="ttc" id="classParallelTaskDistributor_html_a28f70bcc333b8b06d7571db06c67bdc3"><div class="ttname"><a href="classParallelTaskDistributor.html#a28f70bcc333b8b06d7571db06c67bdc3">ParallelTaskDistributor::getTasks</a></div><div class="ttdeci">bool getTasks(size_t &amp;first, size_t &amp;last)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8cpp_source.html#l00318">xmipp_threads.cpp:318</a></div></div>
<div class="ttc" id="classProgMLTomo_html_a2e0bd782eec2005184b8a840ee0edd19"><div class="ttname"><a href="classProgMLTomo.html#a2e0bd782eec2005184b8a840ee0edd19">ProgMLTomo::reScaleVolume</a></div><div class="ttdeci">void reScaleVolume(MultidimArray&lt; double &gt; &amp;Min, bool down_scale=true)</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8cpp_source.html#l01750">ml_tomo.cpp:1750</a></div></div>
<div class="ttc" id="classProgMLTomo_html_a3e0d9d00a8a0176a4bcc3a50d9f4068c"><div class="ttname"><a href="classProgMLTomo.html#a3e0d9d00a8a0176a4bcc3a50d9f4068c">ProgMLTomo::docfiledata</a></div><div class="ttdeci">MultidimArray&lt; double &gt; docfiledata</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00123">ml_tomo.h:123</a></div></div>
<div class="ttc" id="classProgMLTomo_html_aa1fa178a3dd70b3bbd9f0f81d5b9a934"><div class="ttname"><a href="classProgMLTomo.html#aa1fa178a3dd70b3bbd9f0f81d5b9a934">ProgMLTomo::expectationSingleImage</a></div><div class="ttdeci">void expectationSingleImage(MultidimArray&lt; double &gt; &amp;Mimg, int imgno, const int missno, double old_rot, std::vector&lt; Image&lt; double &gt; &gt; &amp;Iref, std::vector&lt; MultidimArray&lt; double &gt; &gt; &amp;wsumimgs, std::vector&lt; MultidimArray&lt; double &gt; &gt; &amp;wsumweds, double &amp;wsum_sigma_noise, double &amp;wsum_sigma_offset, MultidimArray&lt; double &gt; &amp;sumw, double &amp;LL, double &amp;dLL, double &amp;fracweight, double &amp;sumfracweight, double &amp;trymindiff, int &amp;opt_refno, int &amp;opt_angno, Matrix1D&lt; double &gt; &amp;opt_offsets)</div><div class="ttdoc">ML-integration over all hidden parameters. </div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8cpp_source.html#l01990">ml_tomo.cpp:1990</a></div></div>
<div class="ttc" id="mpi__write__test_8cpp_html_aa97ceb86d64068bdd8768ab8a93003df"><div class="ttname"><a href="mpi__write__test_8cpp.html#aa97ceb86d64068bdd8768ab8a93003df">distributor</a></div><div class="ttdeci">ParallelTaskDistributor * distributor</div><div class="ttdef"><b>Definition:</b> <a href="mpi__write__test_8cpp_source.html#l00054">mpi_write_test.cpp:54</a></div></div>
<div class="ttc" id="classProgMLTomo_html_af4a5f9c45b81c9a905eadc484d1fd41f"><div class="ttname"><a href="classProgMLTomo.html#af4a5f9c45b81c9a905eadc484d1fd41f">ProgMLTomo::imgs_optoffsets</a></div><div class="ttdeci">std::vector&lt; Matrix1D&lt; double &gt; &gt; imgs_optoffsets</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00144">ml_tomo.h:144</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00065">xmipp_filename.h:65</a></div></div>
<div class="ttc" id="classProgMLTomo_html_aaf7ae6b1982c6ed19089cbef8bc31898"><div class="ttname"><a href="classProgMLTomo.html#aaf7ae6b1982c6ed19089cbef8bc31898">ProgMLTomo::imgs_missno</a></div><div class="ttdeci">std::vector&lt; int &gt; imgs_missno</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00146">ml_tomo.h:146</a></div></div>
<div class="ttc" id="classMetaDataVec_html_a6dadeeb468ea65886b16518818b84111"><div class="ttname"><a href="classMetaDataVec.html#a6dadeeb468ea65886b16518818b84111">MetaDataVec::size</a></div><div class="ttdeci">size_t size() const override</div><div class="ttdef"><b>Definition:</b> <a href="metadata__vec_8cpp_source.html#l00393">metadata_vec.cpp:393</a></div></div>
<div class="ttc" id="classProgMLTomo_html_af8c9b9d79e2c8fed3ef7ce1d00f69fd0"><div class="ttname"><a href="classProgMLTomo.html#af8c9b9d79e2c8fed3ef7ce1d00f69fd0">ProgMLTomo::maxConstrainedCorrSingleImage</a></div><div class="ttdeci">void maxConstrainedCorrSingleImage(MultidimArray&lt; double &gt; &amp;Mimg, int imgno, int missno, double old_rot, std::vector&lt; Image&lt; double &gt; &gt; &amp;Iref, std::vector&lt; MultidimArray&lt; double &gt; &gt; &amp;wsumimgs, std::vector&lt; MultidimArray&lt; double &gt; &gt; &amp;wsumweds, MultidimArray&lt; double &gt; &amp;sumw, double &amp;maxCC, double &amp;sumCC, int &amp;opt_refno, int &amp;opt_angno, Matrix1D&lt; double &gt; &amp;opt_offsets)</div><div class="ttdoc">Maximum constrained correlation search over all hidden parameters. </div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8cpp_source.html#l02424">ml_tomo.cpp:2424</a></div></div>
<div class="ttc" id="ml__tomo_8cpp_html_af07d07c6859cb36e9759a979d17da8a9"><div class="ttname"><a href="ml__tomo_8cpp.html#af07d07c6859cb36e9759a979d17da8a9">mltomo_selfile_access_mutex</a></div><div class="ttdeci">pthread_mutex_t mltomo_selfile_access_mutex</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8cpp_source.html#l00033">ml_tomo.cpp:33</a></div></div>
<div class="ttc" id="classMetaDataVec_html"><div class="ttname"><a href="classMetaDataVec.html">MetaDataVec</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata__vec_8h_source.html#l00046">metadata_vec.h:46</a></div></div>
<div class="ttc" id="classThreadTaskDistributor_html"><div class="ttname"><a href="classThreadTaskDistributor.html">ThreadTaskDistributor</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8h_source.html#l00451">xmipp_threads.h:451</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a83598b308cacef6d6b356c3455bf5a7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#a83598b308cacef6d6b356c3455bf5a7c">if</a></div><div class="ttdeci">if(fabs(c[*nmax+ *nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02297">numerical_recipes.cpp:2297</a></div></div>
<div class="ttc" id="classProgMLTomo_html_a02a346b9d9730b598fd57d8847d92676"><div class="ttname"><a href="classProgMLTomo.html#a02a346b9d9730b598fd57d8847d92676">ProgMLTomo::imgs_optpsi</a></div><div class="ttdeci">std::vector&lt; double &gt; imgs_optpsi</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00143">ml_tomo.h:143</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga5751842c11a31f5d7ce95a1f8ccbe67d"><div class="ttname"><a href="group__GeometricalTransformations.html#ga5751842c11a31f5d7ce95a1f8ccbe67d">selfTranslate</a></div><div class="ttdeci">void selfTranslate(int SplineDegree, MultidimArray&lt; T &gt; &amp;V1, const Matrix1D&lt; double &gt; &amp;v, bool wrap=xmipp_transformation::WRAP, T outside=0)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01394">transformations.h:1394</a></div></div>
<div class="ttc" id="classProgMLTomo_html_ad5401f3244fd557cafc1468efbdbef97"><div class="ttname"><a href="classProgMLTomo.html#ad5401f3244fd557cafc1468efbdbef97">ProgMLTomo::myFirstImg</a></div><div class="ttdeci">size_t myFirstImg</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00121">ml_tomo.h:121</a></div></div>
<div class="ttc" id="classProgMLTomo_html_a5e3c641c916514c3280354773b2f70ee"><div class="ttname"><a href="classProgMLTomo.html#a5e3c641c916514c3280354773b2f70ee">ProgMLTomo::scale_factor</a></div><div class="ttdeci">double scale_factor</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00173">ml_tomo.h:173</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga3bdba82f045e73fb216c6be539e6b129"><div class="ttname"><a href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a></div><div class="ttdeci">void progress_bar(long rlen)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00791">xmipp_funcs.cpp:791</a></div></div>
<div class="ttc" id="classProgMLTomo_html_ad336d0dd613cc1e5061ece830dcf0ed5"><div class="ttname"><a href="classProgMLTomo.html#ad336d0dd613cc1e5061ece830dcf0ed5">ProgMLTomo::threads</a></div><div class="ttdeci">int threads</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00243">ml_tomo.h:243</a></div></div>
<div class="ttc" id="classXmippProgram_html_aed62cfe3c074e69076bf348fc101a717"><div class="ttname"><a href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">XmippProgram::verbose</a></div><div class="ttdeci">int verbose</div><div class="ttdoc">Verbosity level. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8h_source.html#l00161">xmipp_program.h:161</a></div></div>
<div class="ttc" id="structstructThreadExpectationSingleImage_html"><div class="ttname"><a href="structstructThreadExpectationSingleImage.html">structThreadExpectationSingleImage</a></div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00061">ml_tomo.h:61</a></div></div>
<div class="ttc" id="classProgMLTomo_html_ad170e5b1c1ab3b9364929adb377ecfdd"><div class="ttname"><a href="classProgMLTomo.html#ad170e5b1c1ab3b9364929adb377ecfdd">ProgMLTomo::do_ml</a></div><div class="ttdeci">bool do_ml</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00169">ml_tomo.h:169</a></div></div>
<div class="ttc" id="classProgMLTomo_html_a2fe56eac9ae3877bee379d2d54bc738b"><div class="ttname"><a href="classProgMLTomo.html#a2fe56eac9ae3877bee379d2d54bc738b">ProgMLTomo::imgs_trymindiff</a></div><div class="ttdeci">std::vector&lt; double &gt; imgs_trymindiff</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00143">ml_tomo.h:143</a></div></div>
<div class="ttc" id="classMetaDataVec_html_a71728ad7664da6eba90ec1dbc787d434"><div class="ttname"><a href="classMetaDataVec.html#a71728ad7664da6eba90ec1dbc787d434">MetaDataVec::getValue</a></div><div class="ttdeci">bool getValue(MDObject &amp;mdValueOut, size_t id) const override</div><div class="ttdef"><b>Definition:</b> <a href="metadata__vec_8cpp_source.html#l00293">metadata_vec.cpp:293</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="classImageBase_html_a88636b7a7bd4e0e454877e691ee2da84"><div class="ttname"><a href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">ImageBase::read</a></div><div class="ttdeci">int read(const FileName &amp;name, DataMode datamode=DATA, size_t select_img=ALL_IMAGES, bool mapData=false, int mode=WRITE_READONLY)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00119">xmipp_image_base.cpp:119</a></div></div>
<div class="ttc" id="classProgMLTomo_html_ae0499877c83ff29f2fb59b85fe4a3b82"><div class="ttname"><a href="classProgMLTomo.html#ae0499877c83ff29f2fb59b85fe4a3b82">ProgMLTomo::all_angle_info</a></div><div class="ttdeci">AnglesInfoVector all_angle_info</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00222">ml_tomo.h:222</a></div></div>
<div class="ttc" id="classProgMLTomo_html_aac16aacfdde9f2d39fbe875bccdb7a10"><div class="ttname"><a href="classProgMLTomo.html#aac16aacfdde9f2d39fbe875bccdb7a10">ProgMLTomo::imgs_optangno</a></div><div class="ttdeci">std::vector&lt; int &gt; imgs_optangno</div><div class="ttdef"><b>Definition:</b> <a href="ml__tomo_8h_source.html#l00142">ml_tomo.h:142</a></div></div>
<div class="ttc" id="mpi__classify__CL2D_8cpp_html_a831c08adbb8230fd6a60f4a130923a19"><div class="ttname"><a href="mpi__classify__CL2D_8cpp.html#a831c08adbb8230fd6a60f4a130923a19">prm</a></div><div class="ttdeci">ProgClassifyCL2D * prm</div><div class="ttdef"><b>Definition:</b> <a href="mpi__classify__CL2D_8cpp_source.html#l00035">mpi_classify_CL2D.cpp:35</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a></div><div class="ttdoc">Name of an image (std::string) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00244">metadata_label.h:244</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af07d07c6859cb36e9759a979d17da8a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af07d07c6859cb36e9759a979d17da8a9">&#9670;&nbsp;</a></span>mltomo_selfile_access_mutex</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pthread_mutex_t mltomo_selfile_access_mutex = PTHREAD_MUTEX_INITIALIZER</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ml__tomo_8cpp_source.html#l00033">33</a> of file <a class="el" href="ml__tomo_8cpp_source.html">ml_tomo.cpp</a>.</p>

</div>
</div>
<a id="ae0b77114d78d4cff4fd1d1808d05b678"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0b77114d78d4cff4fd1d1808d05b678">&#9670;&nbsp;</a></span>mltomo_weightedsum_update_mutex</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pthread_mutex_t mltomo_weightedsum_update_mutex = PTHREAD_MUTEX_INITIALIZER</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ml__tomo_8cpp_source.html#l00032">32</a> of file <a class="el" href="ml__tomo_8cpp_source.html">ml_tomo.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
