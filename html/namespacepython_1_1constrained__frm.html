<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Xmipp: python.constrained_frm Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Namespace&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Namespace&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacepython.html">python</a></li><li class="navelem"><a class="el" href="namespacepython_1_1constrained__frm.html">constrained_frm</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">python.constrained_frm Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpython_1_1constrained__frm_1_1AngularConstraint.html">AngularConstraint</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpython_1_1constrained__frm_1_1FixedAngleConstraint.html">FixedAngleConstraint</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpython_1_1constrained__frm_1_1FixedAxisConstraint.html">FixedAxisConstraint</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1d293512b6c0982b3e9924823ce7939f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepython_1_1constrained__frm.html#a1d293512b6c0982b3e9924823ce7939f">frm_find_best_constrained_angle_interp</a> (corr, <a class="el" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>=None, constraint=None)</td></tr>
<tr class="separator:a1d293512b6c0982b3e9924823ce7939f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa962ed47607fcc562bda589af8e49179"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepython_1_1constrained__frm.html#aa962ed47607fcc562bda589af8e49179">frm_find_topn_constrained_angles_interp</a> (corr, <a class="el" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>=5, dist=3.0, constraint=None)</td></tr>
<tr class="separator:aa962ed47607fcc562bda589af8e49179"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfab7e0d37e319b2bd2fce751695d8ba"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepython_1_1constrained__frm.html#adfab7e0d37e319b2bd2fce751695d8ba">frm_constrained_align</a> (vf, wf, vg, wg, <a class="el" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, max_freq, peak_offset=None, mask=None, constraint=None, weights=None, position=None, num_seeds=5, pytom_volume=None)</td></tr>
<tr class="separator:adfab7e0d37e319b2bd2fce751695d8ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="adfab7e0d37e319b2bd2fce751695d8ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def python.constrained_frm.frm_constrained_align </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_freq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>peak_offset</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mask</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>constraint</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>weights</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>position</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_seeds</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pytom_volume</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Find the best alignment (translation &amp; rotation) of volume vg (reference) to match vf.
For details, please check the paper.

Parameters
----------
vf: Volume Nr. 1
    pytom_volume.vol

wf: Mask of vf in Fourier space.
    pytom.basic.structures.Wedge. If none, no missing wedge.

vg: Volume Nr. 2 / Reference
    pytom_volume.vol

wg: Mask of vg in Fourier space.
    pytom.basic.structures.Wedge. If none, no missing wedge.

b: Bandwidth range of spherical harmonics.
   None -&gt; [4, 64]
   List -&gt; [b_min, b_max]
   Integer -&gt; [b, b]

max_freq: Maximal frequency involved in calculation.
          Integer.

peak_offset: The maximal offset which allows the peak of the score to be.
             Or simply speaking, the maximal distance allowed to shift vg to match vf.
             This parameter is needed to prevent shifting the reference volume out of the frame.
             pytom_volume.vol / Integer. By default is half of the volume radius.

mask: Mask volume for vg in real space.
      pytom_volume.vol

constraint: Angular constraint
            sh_alignment.constrained_frm.AngularConstraint

weights: Obsolete.

position: If the translation is already known or not. If provided, no translational search will be conducted.
          List: [x,y,z], default None.

num_seeds: Number of threads for the expectation maximization procedure. The more the better, yet slower.
           Integer, default is 5.

Returns
-------
(The best translation and rotation (Euler angle, ZXZ convention [Phi, Psi, Theta]) to transform vg to match vf.
(best_translation, best_rotation, correlation_score)
</pre> 
<p>Definition at line <a class="el" href="constrained__frm_8py_source.html#l00184">184</a> of file <a class="el" href="constrained__frm_8py_source.html">constrained_frm.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="namespacepython_1_1constrained__frm.html#adfab7e0d37e319b2bd2fce751695d8ba">  184</a></span>&#160;                          pytom_volume=<span class="keywordtype">None</span>):</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Find the best alignment (translation &amp; rotation) of volume vg (reference) to match vf.</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="stringliteral">    For details, please check the paper.</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="stringliteral">    Parameters</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="stringliteral">    ----------</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="stringliteral">    vf: Volume Nr. 1</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="stringliteral">        pytom_volume.vol</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="stringliteral">    wf: Mask of vf in Fourier space.</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="stringliteral">        pytom.basic.structures.Wedge. If none, no missing wedge.</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="stringliteral">    vg: Volume Nr. 2 / Reference</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="stringliteral">        pytom_volume.vol</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="stringliteral">    wg: Mask of vg in Fourier space.</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="stringliteral">        pytom.basic.structures.Wedge. If none, no missing wedge.</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="stringliteral">    b: Bandwidth range of spherical harmonics.</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="stringliteral">       None -&gt; [4, 64]</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="stringliteral">       List -&gt; [b_min, b_max]</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="stringliteral">       Integer -&gt; [b, b]</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="stringliteral">    max_freq: Maximal frequency involved in calculation.</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="stringliteral">              Integer.</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="stringliteral">    peak_offset: The maximal offset which allows the peak of the score to be.</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="stringliteral">                 Or simply speaking, the maximal distance allowed to shift vg to match vf.</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="stringliteral">                 This parameter is needed to prevent shifting the reference volume out of the frame.</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="stringliteral">                 pytom_volume.vol / Integer. By default is half of the volume radius.</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="stringliteral">    mask: Mask volume for vg in real space.</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="stringliteral">          pytom_volume.vol</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="stringliteral">    constraint: Angular constraint</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="stringliteral">                sh_alignment.constrained_frm.AngularConstraint</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="stringliteral">    weights: Obsolete.</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="stringliteral">    position: If the translation is already known or not. If provided, no translational search will be conducted.</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="stringliteral">              List: [x,y,z], default None.</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="stringliteral">    num_seeds: Number of threads for the expectation maximization procedure. The more the better, yet slower.</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="stringliteral">               Integer, default is 5.</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="stringliteral">    Returns</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="stringliteral">    -------</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="stringliteral">    (The best translation and rotation (Euler angle, ZXZ convention [Phi, Psi, Theta]) to transform vg to match vf.</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="stringliteral">    (best_translation, best_rotation, correlation_score)</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keyword">from</span> pytom_volume <span class="keyword">import</span> vol, rotateSpline, peak</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keyword">from</span> pytom.basic.transformations <span class="keyword">import</span> shift</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keyword">from</span> pytom.basic.correlation <span class="keyword">import</span> FLCF</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keyword">from</span> pytom.basic.filter <span class="keyword">import</span> lowpassFilter</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keyword">from</span> pytom.basic.structures <span class="keyword">import</span> Mask, SingleTiltWedge</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keyword">from</span> pytom_volume <span class="keyword">import</span> initSphere</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keyword">from</span> pytom_numpy <span class="keyword">import</span> vol2npy</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">if</span> vf.sizeX()!=vg.sizeX() <span class="keywordflow">or</span> vf.sizeY()!=vg.sizeY() <span class="keywordflow">or</span> vf.sizeZ()!=vg.sizeZ():</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;Two volumes must have the same size!&#39;</span>)</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">if</span> wf <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        wf = SingleTiltWedge(0)</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">if</span> wg <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        wg = SingleTiltWedge(0)</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">if</span> peak_offset <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        peak_offset = <a class="code" href="namespacepython_1_1vol2sf.html#ac59d2037601404ca7f192c266689d118">vol</a>(vf.sizeX(), vf.sizeY(), vf.sizeZ())</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        initSphere(peak_offset, vf.sizeX()/4, 0,0, vf.sizeX()/2,vf.sizeY()/2,vf.sizeZ()/2)</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">elif</span> peak_offset.__class__ == int:</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        peak_radius = peak_offset</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        peak_offset = <a class="code" href="namespacepython_1_1vol2sf.html#ac59d2037601404ca7f192c266689d118">vol</a>(vf.sizeX(), vf.sizeY(), vf.sizeZ())</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        initSphere(peak_offset, peak_radius, 0,0, vf.sizeX()/2,vf.sizeY()/2,vf.sizeZ()/2)</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">elif</span> peak_offset.__class__ == vol:</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordflow">pass</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">else</span>:</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;Peak offset is given wrong!&#39;</span>)</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment"># cut out the outer part which normally contains nonsense</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    m = <a class="code" href="namespacepython_1_1vol2sf.html#ac59d2037601404ca7f192c266689d118">vol</a>(vf.sizeX(), vf.sizeY(), vf.sizeZ())</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    initSphere(m, vf.sizeX()/2, 0,0, vf.sizeX()/2,vf.sizeY()/2,vf.sizeZ()/2)</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    vf = vf*m</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    vg = vg*m</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">if</span> mask <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        mask = m</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">else</span>:</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        vg = vg*mask</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">if</span> position <span class="keywordflow">is</span> <span class="keywordtype">None</span>: <span class="comment"># if position is not given, we have to find it ourself</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment"># first roughtly determine the orientation (only according to the energy info)</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="comment"># get multiple candidate orientations</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        numerator, denominator1, denominator2 = <a class="code" href="namespacepython_1_1frm.html#abb56e262c632dd99d2046f4ec02539bb">frm_correlate</a>(vf, wf, vg, wg, b, max_freq, weights, <span class="keyword">True</span>, <span class="keywordtype">None</span>, <span class="keywordtype">None</span>, <span class="keyword">False</span>)</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        score = numerator/(denominator1 * denominator2)**0.5</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        res = <a class="code" href="namespacepython_1_1constrained__frm.html#aa962ed47607fcc562bda589af8e49179">frm_find_topn_constrained_angles_interp</a>(score, num_seeds, <a class="code" href="namespacepython_1_1frm.html#af873c3f4ca54a286df6f7706115b43e9">get_adaptive_bw</a>(max_freq, b)/16., constraint)</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">else</span>:</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="comment"># the position is given by the user</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        vf2 = shift(vf, -position[0]+vf.sizeX()/2, -position[1]+vf.sizeY()/2, -position[2]+vf.sizeZ()/2, <span class="stringliteral">&#39;fourier&#39;</span>)</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        score = <a class="code" href="namespacepython_1_1frm.html#abb56e262c632dd99d2046f4ec02539bb">frm_correlate</a>(vf2, wf, vg, wg, b, max_freq, weights, ps=<span class="keyword">False</span>)</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        orientation, max_value = <a class="code" href="namespacepython_1_1constrained__frm.html#a1d293512b6c0982b3e9924823ce7939f">frm_find_best_constrained_angle_interp</a>(score, constraint=constraint)</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keywordflow">return</span> position, orientation, max_value</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment"># iteratively refine the position &amp; orientation</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keyword">from</span> pytom.tools.maths <span class="keyword">import</span> euclidianDistance</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    max_iter = 10 <span class="comment"># maximal number of iterations</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    mask2 = <a class="code" href="namespacepython_1_1vol2sf.html#ac59d2037601404ca7f192c266689d118">vol</a>(mask.sizeX(), mask.sizeY(), mask.sizeZ()) <span class="comment"># store the rotated mask</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    vg2 = <a class="code" href="namespacepython_1_1vol2sf.html#ac59d2037601404ca7f192c266689d118">vol</a>(vg.sizeX(), vg.sizeY(), vg.sizeZ())</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    lowpass_vf = lowpassFilter(vf, max_freq, max_freq/10.)[0]</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    max_position = <span class="keywordtype">None</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    max_orientation = <span class="keywordtype">None</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    max_value = -1.0</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> xrange(num_seeds):</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        old_pos = [-1, -1, -1]</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        lm_pos = [-1, -1, -1]</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        lm_ang = <span class="keywordtype">None</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        lm_value = -1.0</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        orientation = res[i][0] <span class="comment"># initial orientation</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordflow">for</span> j <span class="keywordflow">in</span> xrange(max_iter):</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            rotateSpline(vg, vg2, orientation[0], orientation[1], orientation[2]) <span class="comment"># first rotate</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            rotateSpline(mask, mask2, orientation[0], orientation[1], orientation[2]) <span class="comment"># rotate the mask as well</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            vg2 = wf.apply(vg2) <span class="comment"># then apply the wedge</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            vg2 = lowpassFilter(vg2, max_freq, max_freq/10.)[0]</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            score = <a class="code" href="namespacepython_1_1tompy_1_1score.html#a383d3fc08a51bf6cf80353228d0f9180">FLCF</a>(lowpass_vf, vg2, mask2) <span class="comment"># find the position</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            pos = <a class="code" href="stack_8cpp.html#a79e815757d3ac37cabaad4e7a12b816f">peak</a>(score, peak_offset)</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            pos, val = <a class="code" href="namespacepython_1_1frm.html#aa2afd121d24f3fb18d3f8b3a5554ed54">find_subpixel_peak_position</a>(vol2npy(score), pos)</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <span class="keywordflow">if</span> val &gt; lm_value:</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                lm_pos = pos</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                lm_ang = orientation</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                lm_value = val</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        </div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <span class="keywordflow">if</span> <a class="code" href="group__Filters.html#gae47fe945bf87f1eadce22969939ffefd">euclidianDistance</a>(lm_pos, old_pos) &lt;= 1.0:</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                <span class="comment"># terminate this thread</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                <span class="keywordflow">if</span> lm_value &gt; max_value:</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                    max_position = lm_pos</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                    max_orientation = lm_ang</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                    max_value = lm_value</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                <span class="keywordflow">break</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                old_pos = lm_pos</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="comment"># here we shift the target, not the reference</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="comment"># if you dont want the shift to change the energy landscape, use fourier shift</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            vf2 = shift(vf, -lm_pos[0]+vf.sizeX()/2, -lm_pos[1]+vf.sizeY()/2, -lm_pos[2]+vf.sizeZ()/2, <span class="stringliteral">&#39;fourier&#39;</span>)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            score = <a class="code" href="namespacepython_1_1frm.html#abb56e262c632dd99d2046f4ec02539bb">frm_correlate</a>(vf2, wf, vg, wg, b, max_freq, weights, <span class="keyword">False</span>, denominator1, denominator2, <span class="keyword">True</span>)</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            orientation, val = <a class="code" href="namespacepython_1_1constrained__frm.html#a1d293512b6c0982b3e9924823ce7939f">frm_find_best_constrained_angle_interp</a>(score, constraint=constraint)</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            </div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordflow">else</span>: <span class="comment"># no converge after the specified iteration, still get the best result as we can</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            <span class="keywordflow">if</span> lm_value &gt; max_value:</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                max_position = lm_pos</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                max_orientation = lm_ang</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                max_value = lm_value</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="comment"># print max_value # for show the convergence of the algorithm</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">return</span> max_position, max_orientation, max_value</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    </div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<div class="ttc" id="namespacepython_1_1frm_html_abb56e262c632dd99d2046f4ec02539bb"><div class="ttname"><a href="namespacepython_1_1frm.html#abb56e262c632dd99d2046f4ec02539bb">python.frm.frm_correlate</a></div><div class="ttdeci">def frm_correlate(vf, wf, vg, wg, b, max_freq, weights=None, ps=False, denominator1=None, denominator2=None, return_score=True)</div><div class="ttdef"><b>Definition:</b> <a href="frm_8py_source.html#l00880">frm.py:880</a></div></div>
<div class="ttc" id="namespacepython_1_1tompy_1_1score_html_a383d3fc08a51bf6cf80353228d0f9180"><div class="ttname"><a href="namespacepython_1_1tompy_1_1score.html#a383d3fc08a51bf6cf80353228d0f9180">python.tompy.score.FLCF</a></div><div class="ttdeci">def FLCF(volume, template, mask=None, stdV=None)</div><div class="ttdef"><b>Definition:</b> <a href="score_8py_source.html#l00085">score.py:85</a></div></div>
<div class="ttc" id="group__Filters_html_gae47fe945bf87f1eadce22969939ffefd"><div class="ttname"><a href="group__Filters.html#gae47fe945bf87f1eadce22969939ffefd">euclidianDistance</a></div><div class="ttdeci">double euclidianDistance(const MultidimArray&lt; T &gt; &amp;x, const MultidimArray&lt; T &gt; &amp;y, const MultidimArray&lt; int &gt; *mask=NULL)</div><div class="ttdoc">euclidian distance nD </div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00653">filters.h:653</a></div></div>
<div class="ttc" id="namespacepython_1_1frm_html_aa2afd121d24f3fb18d3f8b3a5554ed54"><div class="ttname"><a href="namespacepython_1_1frm.html#aa2afd121d24f3fb18d3f8b3a5554ed54">python.frm.find_subpixel_peak_position</a></div><div class="ttdeci">def find_subpixel_peak_position(corr, pos)</div><div class="ttdef"><b>Definition:</b> <a href="frm_8py_source.html#l00396">frm.py:396</a></div></div>
<div class="ttc" id="namespacepython_1_1constrained__frm_html_aa962ed47607fcc562bda589af8e49179"><div class="ttname"><a href="namespacepython_1_1constrained__frm.html#aa962ed47607fcc562bda589af8e49179">python.constrained_frm.frm_find_topn_constrained_angles_interp</a></div><div class="ttdeci">def frm_find_topn_constrained_angles_interp(corr, n=5, dist=3.0, constraint=None)</div><div class="ttdef"><b>Definition:</b> <a href="constrained__frm_8py_source.html#l00167">constrained_frm.py:167</a></div></div>
<div class="ttc" id="namespacepython_1_1constrained__frm_html_a1d293512b6c0982b3e9924823ce7939f"><div class="ttname"><a href="namespacepython_1_1constrained__frm.html#a1d293512b6c0982b3e9924823ce7939f">python.constrained_frm.frm_find_best_constrained_angle_interp</a></div><div class="ttdeci">def frm_find_best_constrained_angle_interp(corr, b=None, constraint=None)</div><div class="ttdef"><b>Definition:</b> <a href="constrained__frm_8py_source.html#l00159">constrained_frm.py:159</a></div></div>
<div class="ttc" id="namespacepython_1_1frm_html_af873c3f4ca54a286df6f7706115b43e9"><div class="ttname"><a href="namespacepython_1_1frm.html#af873c3f4ca54a286df6f7706115b43e9">python.frm.get_adaptive_bw</a></div><div class="ttdeci">def get_adaptive_bw(k, b=None)</div><div class="ttdef"><b>Definition:</b> <a href="frm_8py_source.html#l00841">frm.py:841</a></div></div>
<div class="ttc" id="stack_8cpp_html_a79e815757d3ac37cabaad4e7a12b816f"><div class="ttname"><a href="stack_8cpp.html#a79e815757d3ac37cabaad4e7a12b816f">peak</a></div><div class="ttdeci">struct Convex_T peak(struct stack_T *stack)</div><div class="ttdef"><b>Definition:</b> <a href="stack_8cpp_source.html#l00033">stack.cpp:33</a></div></div>
<div class="ttc" id="namespacepython_1_1vol2sf_html_ac59d2037601404ca7f192c266689d118"><div class="ttname"><a href="namespacepython_1_1vol2sf.html#ac59d2037601404ca7f192c266689d118">python.vol2sf.vol</a></div><div class="ttdeci">vol</div><div class="ttdef"><b>Definition:</b> <a href="vol2sf_8py_source.html#l00243">vol2sf.py:243</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1d293512b6c0982b3e9924823ce7939f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def python.constrained_frm.frm_find_best_constrained_angle_interp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>corr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>constraint</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="constrained__frm_8py_source.html#l00159">159</a> of file <a class="el" href="constrained__frm_8py_source.html">constrained_frm.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="namespacepython_1_1constrained__frm.html#a1d293512b6c0982b3e9924823ce7939f">  159</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacepython_1_1constrained__frm.html#a1d293512b6c0982b3e9924823ce7939f">frm_find_best_constrained_angle_interp</a>(corr, b=None, constraint=None):</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">if</span> <span class="keywordflow">not</span> b:</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        b = corr.shape[0]/2</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">if</span> constraint <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        corr = corr * constraint.getConstraintVolume(b)</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacepython_1_1frm.html#a0f5d86e1db76d54024195c80d639cdd4">frm_find_best_angle_interp</a>(corr, b)</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="ttc" id="namespacepython_1_1frm_html_a0f5d86e1db76d54024195c80d639cdd4"><div class="ttname"><a href="namespacepython_1_1frm.html#a0f5d86e1db76d54024195c80d639cdd4">python.frm.frm_find_best_angle_interp</a></div><div class="ttdeci">def frm_find_best_angle_interp(corr, b=None)</div><div class="ttdef"><b>Definition:</b> <a href="frm_8py_source.html#l00443">frm.py:443</a></div></div>
<div class="ttc" id="namespacepython_1_1constrained__frm_html_a1d293512b6c0982b3e9924823ce7939f"><div class="ttname"><a href="namespacepython_1_1constrained__frm.html#a1d293512b6c0982b3e9924823ce7939f">python.constrained_frm.frm_find_best_constrained_angle_interp</a></div><div class="ttdeci">def frm_find_best_constrained_angle_interp(corr, b=None, constraint=None)</div><div class="ttdef"><b>Definition:</b> <a href="constrained__frm_8py_source.html#l00159">constrained_frm.py:159</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa962ed47607fcc562bda589af8e49179"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def python.constrained_frm.frm_find_topn_constrained_angles_interp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>corr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dist</em> = <code>3.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>constraint</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="constrained__frm_8py_source.html#l00167">167</a> of file <a class="el" href="constrained__frm_8py_source.html">constrained_frm.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="namespacepython_1_1constrained__frm.html#aa962ed47607fcc562bda589af8e49179">  167</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacepython_1_1constrained__frm.html#aa962ed47607fcc562bda589af8e49179">frm_find_topn_constrained_angles_interp</a>(corr, n=5, dist=3.0, constraint=None):</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    b = corr.shape[0]/2</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment"># when the angular constraint conflicts the dist</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">if</span> constraint.__class__ == FixedAngleConstraint <span class="keywordflow">and</span> float(dist+1)/b*180 &gt; constraint.nearby:</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        print(<span class="stringliteral">&#39;Warning: angular distance cut is overwritten by angular constraint.&#39;</span>)</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keyword">from</span> math <span class="keyword">import</span> floor</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        dist = <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(constraint.nearby*b/180.)-1</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordflow">if</span> dist &lt; 1.:</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="keywordflow">raise</span> Exception(<span class="stringliteral">&quot;The angular constraint is too small. Please re-specify!&quot;</span>)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">if</span> constraint <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        corr = corr * constraint.getConstraintVolume(b)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacepython_1_1frm.html#afddbd66cd7feebb38d44e4bee97588a4">frm_find_topn_angles_interp</a>(corr, n, dist)</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="ttc" id="cuda__basic__math_8h_html_a2065eb145275f878c1d045c9f3fb1cc7"><div class="ttname"><a href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a></div><div class="ttdeci">__host__ __device__ float2 floor(const float2 v)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__basic__math_8h_source.html#l00175">cuda_basic_math.h:175</a></div></div>
<div class="ttc" id="namespacepython_1_1constrained__frm_html_aa962ed47607fcc562bda589af8e49179"><div class="ttname"><a href="namespacepython_1_1constrained__frm.html#aa962ed47607fcc562bda589af8e49179">python.constrained_frm.frm_find_topn_constrained_angles_interp</a></div><div class="ttdeci">def frm_find_topn_constrained_angles_interp(corr, n=5, dist=3.0, constraint=None)</div><div class="ttdef"><b>Definition:</b> <a href="constrained__frm_8py_source.html#l00167">constrained_frm.py:167</a></div></div>
<div class="ttc" id="namespacepython_1_1frm_html_afddbd66cd7feebb38d44e4bee97588a4"><div class="ttname"><a href="namespacepython_1_1frm.html#afddbd66cd7feebb38d44e4bee97588a4">python.frm.frm_find_topn_angles_interp</a></div><div class="ttdeci">def frm_find_topn_angles_interp(corr, n=5, dist=3.0)</div><div class="ttdef"><b>Definition:</b> <a href="frm_8py_source.html#l00647">frm.py:647</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
