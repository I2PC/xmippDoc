<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Xmipp: Parameters Projection for Tomography</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Parameters Projection for Tomography<div class="ingroups"><a class="el" href="group__Libraries.html">Libraries</a> &raquo; <a class="el" href="group__DataLibrary.html">Basic data library</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Parameters Projection for Tomography:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__ParametersProjectionTomography.png" border="0" alt="" usemap="#group____ParametersProjectionTomography"/>
<map name="group____ParametersProjectionTomography" id="group____ParametersProjectionTomography">
</map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classParametersProjectionTomography.html">ParametersProjectionTomography</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structproject__thread__params.html">project_thread_params</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga94ec8a7a5cf5c289d292aef5777c4c14"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#ga94ec8a7a5cf5c289d292aef5777c4c14">x0</a>&#160;&#160;&#160;<a class="el" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(*proj))</td></tr>
<tr class="separator:ga94ec8a7a5cf5c289d292aef5777c4c14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8f613ddaea2048e3471a1f4f04ba4b79"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#ga8f613ddaea2048e3471a1f4f04ba4b79">xF</a>&#160;&#160;&#160;<a class="el" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(*proj))</td></tr>
<tr class="separator:ga8f613ddaea2048e3471a1f4f04ba4b79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0d9521fd31b2e16413d1b78836953d53"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#ga0d9521fd31b2e16413d1b78836953d53">y0</a>&#160;&#160;&#160;<a class="el" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(*proj))</td></tr>
<tr class="separator:ga0d9521fd31b2e16413d1b78836953d53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga132f3924593d07b0a1f55b3f22e92ba6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#ga132f3924593d07b0a1f55b3f22e92ba6">yF</a>&#160;&#160;&#160;<a class="el" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(*proj))</td></tr>
<tr class="separator:ga132f3924593d07b0a1f55b3f22e92ba6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab17807a5400b7a54607c87513d0edf80"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#gab17807a5400b7a54607c87513d0edf80">xDim</a>&#160;&#160;&#160;<a class="el" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(*proj))</td></tr>
<tr class="separator:gab17807a5400b7a54607c87513d0edf80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga151b09680d4024bb8c942ec71983b77f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#ga151b09680d4024bb8c942ec71983b77f">yDim</a>&#160;&#160;&#160;<a class="el" href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(*proj))</td></tr>
<tr class="separator:ga151b09680d4024bb8c942ec71983b77f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga9fa2cc1995e6791b45c9c0680a2e22d1"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:ga9fa2cc1995e6791b45c9c0680a2e22d1"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#ga9fa2cc1995e6791b45c9c0680a2e22d1">project_SimpleGrid</a> (<a class="el" href="classImage.html">Image</a>&lt; T &gt; *vol, const <a class="el" href="classSimpleGrid.html">SimpleGrid</a> *grid, const <a class="el" href="classBasis.html">Basis</a> *basis, <a class="el" href="classProjection.html">Projection</a> *proj, <a class="el" href="classProjection.html">Projection</a> *norm_proj, int FORW, int eq_mode, const <a class="el" href="classImage.html">Image</a>&lt; int &gt; *VNeq, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; *M, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask=nullptr, double ray_length=-1.0, int thread_id=-1, int num_threads=1)</td></tr>
<tr class="separator:ga9fa2cc1995e6791b45c9c0680a2e22d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa2a035335544acb914ec49b685e3cfcc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#gaa2a035335544acb914ec49b685e3cfcc">projectVolume</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V, <a class="el" href="classProjection.html">Projection</a> &amp;P, int Ydim, int Xdim, double rot, double tilt, double psi, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; *roffset=nullptr)</td></tr>
<tr class="separator:gaa2a035335544acb914ec49b685e3cfcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga125751740b29feb4f536731abe705b6a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#ga125751740b29feb4f536731abe705b6a">projectVolumeOffCentered</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V, <a class="el" href="classProjection.html">Projection</a> &amp;P, int Ydim, int Xdim)</td></tr>
<tr class="separator:ga125751740b29feb4f536731abe705b6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafaefa09ed28fafff7cf217bfe29f1efe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#gafaefa09ed28fafff7cf217bfe29f1efe">singleWBP</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V, <a class="el" href="classProjection.html">Projection</a> &amp;P)</td></tr>
<tr class="separator:gafaefa09ed28fafff7cf217bfe29f1efe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8c95065c2aa1d113758a2621cfaa65b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#ga8c95065c2aa1d113758a2621cfaa65b6">count_eqs_in_projection</a> (<a class="el" href="classGridVolumeT.html">GridVolumeT</a>&lt; int &gt; &amp;GVNeq, const <a class="el" href="classBasis.html">Basis</a> &amp;basis, <a class="el" href="classProjection.html">Projection</a> &amp;read_proj)</td></tr>
<tr class="separator:ga8c95065c2aa1d113758a2621cfaa65b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac611e9cc947339cc7586feebcec83789"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#gac611e9cc947339cc7586feebcec83789">project_Crystal_Volume</a> (<a class="el" href="group__Grids.html#gae3eeb15b316a9800a7c35372dfd57460">GridVolume</a> &amp;vol, const <a class="el" href="classBasis.html">Basis</a> &amp;basis, <a class="el" href="classProjection.html">Projection</a> &amp;proj, <a class="el" href="classProjection.html">Projection</a> &amp;norm_proj, int Ydim, int Xdim, double rot, double tilt, double psi, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;shift, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;aint, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;bint, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;D, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;Dinv, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, int FORW, int eq_mode=<a class="el" href="group__ParametersProjectionTomography.html#ga64d6cb0b0a0141854ec21615c4a39d6a">ARTK</a>)</td></tr>
<tr class="separator:gac611e9cc947339cc7586feebcec83789"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8a291520ffc843c4d21eaf1038be55fe"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:ga8a291520ffc843c4d21eaf1038be55fe"><td class="memTemplItemLeft" align="right" valign="top">void *&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#ga8a291520ffc843c4d21eaf1038be55fe">project_SimpleGridThread</a> (void *params)</td></tr>
<tr class="separator:ga8a291520ffc843c4d21eaf1038be55fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6551ebbcb3db8c9075597537f445307a"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:ga6551ebbcb3db8c9075597537f445307a"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#ga6551ebbcb3db8c9075597537f445307a">project_GridVolume</a> (<a class="el" href="classGridVolumeT.html">GridVolumeT</a>&lt; T &gt; &amp;vol, const <a class="el" href="classBasis.html">Basis</a> &amp;basis, <a class="el" href="classProjection.html">Projection</a> &amp;proj, <a class="el" href="classProjection.html">Projection</a> &amp;norm_proj, int Ydim, int Xdim, double rot, double tilt, double psi, int FORW, int eq_mode, <a class="el" href="classGridVolumeT.html">GridVolumeT</a>&lt; int &gt; *GVNeq, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; *M, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask, double ray_length, int threads)</td></tr>
<tr class="separator:ga6551ebbcb3db8c9075597537f445307a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga3e46756d453b695deb8da52e590ef0b1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__Threads.html#ga0b86c483ccff385c24a8a278870af9f7">barrier_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#ga3e46756d453b695deb8da52e590ef0b1">project_barrier</a></td></tr>
<tr class="separator:ga3e46756d453b695deb8da52e590ef0b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6b8971032d8e98145e6691683950fe8c"><td class="memItemLeft" align="right" valign="top">pthread_mutex_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#ga6b8971032d8e98145e6691683950fe8c">project_mutex</a></td></tr>
<tr class="separator:ga6b8971032d8e98145e6691683950fe8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaef66df64a8ff60fcb4b1aed8341af3b1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structproject__thread__params.html">project_thread_params</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#gaef66df64a8ff60fcb4b1aed8341af3b1">project_threads</a></td></tr>
<tr class="separator:gaef66df64a8ff60fcb4b1aed8341af3b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2dd06786fc540036602745df1373a2b0"><td class="memItemLeft" align="right" valign="top">constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#ga2dd06786fc540036602745df1373a2b0">FORWARD</a> = 1</td></tr>
<tr class="separator:ga2dd06786fc540036602745df1373a2b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa7dca3eaddb40b1a3802354354766e47"><td class="memItemLeft" align="right" valign="top">constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#gaa7dca3eaddb40b1a3802354354766e47">BACKWARD</a> = 0</td></tr>
<tr class="separator:gaa7dca3eaddb40b1a3802354354766e47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga64d6cb0b0a0141854ec21615c4a39d6a"><td class="memItemLeft" align="right" valign="top">constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#ga64d6cb0b0a0141854ec21615c4a39d6a">ARTK</a> = 1</td></tr>
<tr class="separator:ga64d6cb0b0a0141854ec21615c4a39d6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1d8d965aac23a7a7e10e4fe50ae70f41"><td class="memItemLeft" align="right" valign="top">constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#ga1d8d965aac23a7a7e10e4fe50ae70f41">CAVK</a> = 2</td></tr>
<tr class="separator:ga1d8d965aac23a7a7e10e4fe50ae70f41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3c6a0d295bfc7f31b0c926d9a25527e8"><td class="memItemLeft" align="right" valign="top">constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#ga3c6a0d295bfc7f31b0c926d9a25527e8">COUNT_EQ</a> = 3</td></tr>
<tr class="separator:ga3c6a0d295bfc7f31b0c926d9a25527e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga56d592540304881fd5411961458e4118"><td class="memItemLeft" align="right" valign="top">constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#ga56d592540304881fd5411961458e4118">CAV</a> = 4</td></tr>
<tr class="separator:ga56d592540304881fd5411961458e4118"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga66def0fa268ae303861b249fa125deb8"><td class="memItemLeft" align="right" valign="top">constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#ga66def0fa268ae303861b249fa125deb8">CAVARTK</a> = 5</td></tr>
<tr class="separator:ga66def0fa268ae303861b249fa125deb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9d1421cb7105f364df31c920daee64cd"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ParametersProjectionTomography.html#ga9d1421cb7105f364df31c920daee64cd">ART_PIXEL_SUBSAMPLING</a> = 2</td></tr>
<tr class="separator:ga9d1421cb7105f364df31c920daee64cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga94ec8a7a5cf5c289d292aef5777c4c14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga94ec8a7a5cf5c289d292aef5777c4c14">&#9670;&nbsp;</a></span>x0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define x0&#160;&#160;&#160;<a class="el" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(*proj))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="projection_8h_source.html#l00255">255</a> of file <a class="el" href="projection_8h_source.html">projection.h</a>.</p>

</div>
</div>
<a id="gab17807a5400b7a54607c87513d0edf80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab17807a5400b7a54607c87513d0edf80">&#9670;&nbsp;</a></span>xDim</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define xDim&#160;&#160;&#160;<a class="el" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(*proj))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="projection_8h_source.html#l00259">259</a> of file <a class="el" href="projection_8h_source.html">projection.h</a>.</p>

</div>
</div>
<a id="ga8f613ddaea2048e3471a1f4f04ba4b79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8f613ddaea2048e3471a1f4f04ba4b79">&#9670;&nbsp;</a></span>xF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define xF&#160;&#160;&#160;<a class="el" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(*proj))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="projection_8h_source.html#l00256">256</a> of file <a class="el" href="projection_8h_source.html">projection.h</a>.</p>

</div>
</div>
<a id="ga0d9521fd31b2e16413d1b78836953d53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0d9521fd31b2e16413d1b78836953d53">&#9670;&nbsp;</a></span>y0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define y0&#160;&#160;&#160;<a class="el" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(*proj))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="projection_8h_source.html#l00257">257</a> of file <a class="el" href="projection_8h_source.html">projection.h</a>.</p>

</div>
</div>
<a id="ga151b09680d4024bb8c942ec71983b77f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga151b09680d4024bb8c942ec71983b77f">&#9670;&nbsp;</a></span>yDim</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define yDim&#160;&#160;&#160;<a class="el" href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(*proj))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="projection_8h_source.html#l00260">260</a> of file <a class="el" href="projection_8h_source.html">projection.h</a>.</p>

</div>
</div>
<a id="ga132f3924593d07b0a1f55b3f22e92ba6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga132f3924593d07b0a1f55b3f22e92ba6">&#9670;&nbsp;</a></span>yF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define yF&#160;&#160;&#160;<a class="el" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(*proj))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="projection_8h_source.html#l00258">258</a> of file <a class="el" href="projection_8h_source.html">projection.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga8c95065c2aa1d113758a2621cfaa65b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8c95065c2aa1d113758a2621cfaa65b6">&#9670;&nbsp;</a></span>count_eqs_in_projection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void count_eqs_in_projection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classGridVolumeT.html">GridVolumeT</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>GVNeq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBasis.html">Basis</a> &amp;&#160;</td>
          <td class="paramname"><em>basis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>read_proj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Count equations in volume. For Component AVeraing (CAV), the number of equations in which each basis is involved is needed. </p>

<p class="definition">Definition at line <a class="el" href="projection_8cpp_source.html#l01206">1206</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;{</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; GVNeq.<a class="code" href="classGridVolumeT.html#ab75022f1bcc31df3154d6bfb7bfa01b3">VolumesNo</a>(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        <a class="code" href="group__ParametersProjectionTomography.html#ga9fa2cc1995e6791b45c9c0680a2e22d1">project_SimpleGrid</a>(&amp;(GVNeq(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)), &amp;(GVNeq.<a class="code" href="classGridVolumeT.html#ae3533d1e5f50afe4575c0029cb3f9de3">grid</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)), &amp;basis,</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                           &amp;read_proj, &amp;read_proj, <a class="code" href="blobs_8cpp.html#a6ddfdda7a062d10cff4a72b76b44aeb8">FORWARD</a>, <a class="code" href="group__ParametersProjectionTomography.html#ga3c6a0d295bfc7f31b0c926d9a25527e8">COUNT_EQ</a>, NULL, NULL);</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;}</div><div class="ttc" id="group__ParametersProjectionTomography_html_ga3c6a0d295bfc7f31b0c926d9a25527e8"><div class="ttname"><a href="group__ParametersProjectionTomography.html#ga3c6a0d295bfc7f31b0c926d9a25527e8">COUNT_EQ</a></div><div class="ttdeci">constexpr int COUNT_EQ</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00179">projection.h:179</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="classGridVolumeT_html_ab75022f1bcc31df3154d6bfb7bfa01b3"><div class="ttname"><a href="classGridVolumeT.html#ab75022f1bcc31df3154d6bfb7bfa01b3">GridVolumeT::VolumesNo</a></div><div class="ttdeci">size_t VolumesNo() const</div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l01003">grids.h:1003</a></div></div>
<div class="ttc" id="group__ParametersProjectionTomography_html_ga9fa2cc1995e6791b45c9c0680a2e22d1"><div class="ttname"><a href="group__ParametersProjectionTomography.html#ga9fa2cc1995e6791b45c9c0680a2e22d1">project_SimpleGrid</a></div><div class="ttdeci">void project_SimpleGrid(Image&lt; T &gt; *vol, const SimpleGrid *grid, const Basis *basis, Projection *proj, Projection *norm_proj, int FORW, int eq_mode, const Image&lt; int &gt; *VNeq, Matrix2D&lt; double &gt; *M, const MultidimArray&lt; int &gt; *mask, double ray_length, int thread_id, int numthreads)</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l01314">projection.cpp:1314</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a6ddfdda7a062d10cff4a72b76b44aeb8"><div class="ttname"><a href="blobs_8cpp.html#a6ddfdda7a062d10cff4a72b76b44aeb8">FORWARD</a></div><div class="ttdeci">#define FORWARD</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l01091">blobs.cpp:1091</a></div></div>
<div class="ttc" id="classGridVolumeT_html_ae3533d1e5f50afe4575c0029cb3f9de3"><div class="ttname"><a href="classGridVolumeT.html#ae3533d1e5f50afe4575c0029cb3f9de3">GridVolumeT::grid</a></div><div class="ttdeci">const SimpleGrid &amp; grid(size_t n) const</div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00978">grids.h:978</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gac611e9cc947339cc7586feebcec83789"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac611e9cc947339cc7586feebcec83789">&#9670;&nbsp;</a></span>project_Crystal_Volume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void project_Crystal_Volume </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__Grids.html#gae3eeb15b316a9800a7c35372dfd57460">GridVolume</a> &amp;&#160;</td>
          <td class="paramname"><em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBasis.html">Basis</a> &amp;&#160;</td>
          <td class="paramname"><em>basis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>proj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>norm_proj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>aint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>bint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Dinv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>FORW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>eq_mode</em> = <code><a class="el" href="group__ParametersProjectionTomography.html#ga64d6cb0b0a0141854ec21615c4a39d6a">ARTK</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Project a crystal basis volume. This function projects a crystal deformed basis volume, ie, in the documentation volume g. However the angles given must be those for volume f, the undeformed one. You must supply the deformed lattice vectors, and the matrix to pass from the deformed to the undeformed vectors (D and Dinv). a=D*ai;</p>
<p>Valid eq_modes are ARTK, CAVARTK and CAV. </p>

<p class="definition">Definition at line <a class="el" href="projection_8cpp_source.html#l01157">1157</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;{</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="comment">// If projecting forward initialise projections</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keywordflow">if</span> (FORW)</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    {</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        proj.<a class="code" href="group__FourierProjection.html#ga0996d67a36d07d6eb3373022c24c7952">reset</a>(Ydim, Xdim);</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        proj.<a class="code" href="group__FourierProjection.html#ga38fc7e819f167ed62bf63c13e1058aab">setAngles</a>(rot, tilt, <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>);</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        norm_proj().resize(proj());</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    }</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="comment">// Project each subvolume</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; vol.<a class="code" href="classGridVolumeT.html#ab75022f1bcc31df3154d6bfb7bfa01b3">VolumesNo</a>(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    {</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        <a class="code" href="projection_8cpp.html#a5822d132674cef78f61512b773206e12">project_Crystal_SimpleGrid</a>(vol(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>), vol.<a class="code" href="classGridVolumeT.html#ae3533d1e5f50afe4575c0029cb3f9de3">grid</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>), basis,</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                                   proj, norm_proj, shift, aint, bint, D, Dinv, mask, FORW, eq_mode);</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        <a class="code" href="classImage.html">Image&lt;double&gt;</a> save;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;        save = norm_proj;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        <span class="keywordflow">if</span> (FORW)</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;            save.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>((std::string)<span class="stringliteral">&quot;PPPnorm_FORW&quot;</span> + (<span class="keywordtype">char</span>)(48 + <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;            save.write((std::string)<span class="stringliteral">&quot;PPPnorm_BACK&quot;</span> + (<span class="keywordtype">char</span>)(48 + <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    }</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;}</div><div class="ttc" id="group__FourierProjection_html_ga0996d67a36d07d6eb3373022c24c7952"><div class="ttname"><a href="group__FourierProjection.html#ga0996d67a36d07d6eb3373022c24c7952">Projection::reset</a></div><div class="ttdeci">void reset(int Ydim, int Xdim)</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8cpp_source.html#l00033">fourier_projection.cpp:33</a></div></div>
<div class="ttc" id="projection_8cpp_html_a5822d132674cef78f61512b773206e12"><div class="ttname"><a href="projection_8cpp.html#a5822d132674cef78f61512b773206e12">project_Crystal_SimpleGrid</a></div><div class="ttdeci">void project_Crystal_SimpleGrid(Image&lt; double &gt; &amp;vol, const SimpleGrid &amp;grid, const Basis &amp;basis, Projection &amp;proj, Projection &amp;norm_proj, const Matrix1D&lt; double &gt; &amp;shift, const Matrix1D&lt; double &gt; &amp;aint, const Matrix1D&lt; double &gt; &amp;bint, const Matrix2D&lt; double &gt; &amp;D, const Matrix2D&lt; double &gt; &amp;Dinv, const MultidimArray&lt; int &gt; &amp;mask, int FORW, int eq_mode)</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l00773">projection.cpp:773</a></div></div>
<div class="ttc" id="classImageBase_html_ae81a8c11a832924c2bda0909882c3168"><div class="ttname"><a href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">ImageBase::write</a></div><div class="ttdeci">void write(const FileName &amp;name=&quot;&quot;, size_t select_img=ALL_IMAGES, bool isStack=false, int mode=WRITE_OVERWRITE, CastWriteMode castMode=CW_CAST, int _swapWrite=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00292">xmipp_image_base.cpp:292</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="classGridVolumeT_html_ab75022f1bcc31df3154d6bfb7bfa01b3"><div class="ttname"><a href="classGridVolumeT.html#ab75022f1bcc31df3154d6bfb7bfa01b3">GridVolumeT::VolumesNo</a></div><div class="ttdeci">size_t VolumesNo() const</div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l01003">grids.h:1003</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="classGridVolumeT_html_ae3533d1e5f50afe4575c0029cb3f9de3"><div class="ttname"><a href="classGridVolumeT.html#ae3533d1e5f50afe4575c0029cb3f9de3">GridVolumeT::grid</a></div><div class="ttdeci">const SimpleGrid &amp; grid(size_t n) const</div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00978">grids.h:978</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="group__FourierProjection_html_ga38fc7e819f167ed62bf63c13e1058aab"><div class="ttname"><a href="group__FourierProjection.html#ga38fc7e819f167ed62bf63c13e1058aab">Projection::setAngles</a></div><div class="ttdeci">void setAngles(double _rot, double _tilt, double _psi)</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8cpp_source.html#l00040">fourier_projection.cpp:40</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga6551ebbcb3db8c9075597537f445307a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6551ebbcb3db8c9075597537f445307a">&#9670;&nbsp;</a></span>project_GridVolume()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void project_GridVolume </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classGridVolumeT.html">GridVolumeT</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBasis.html">Basis</a> &amp;&#160;</td>
          <td class="paramname"><em>basis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>proj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>norm_proj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>FORW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>eq_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classGridVolumeT.html">GridVolumeT</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>GVNeq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ray_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>threads</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classProjection.html">Projection</a> of a <a class="el" href="classGrid.html">Grid</a> Volume.</p>
<p>Project a grid volume with a basis. The <a class="el" href="classGrid.html">Grid</a> volume is projected onto a projection plane defined by (rot, tilt, psi) (1st, 2nd and 3rd <a class="el" href="classEuler.html">Euler</a> angles). The projection is previously is resized to Ydim x Xdim and initialized to 0. The projection itself, from now on, will keep the <a class="el" href="classEuler.html">Euler</a> angles.</p>
<p>FORWARD process: Each volume of the grid is projected on to the projection plane. The output is the projection itself and a normalising image, the normalising image is the projection of the same grid supposing that all basis are of value 1. This normalising image is used by the ART process</p>
<p>BACKWARD process: During the backward process the normalising projection contains the correction image to apply to the volume (in the ART sense). The output is the volume itself, the projection image is useless in this case, and the normalising projection is not modified at all.</p>
<p>As for the mode, valid modes are ARTK, CAVK, COUNT_EQ, CAVARTK.</p>
<p>M is the matrix corresponding to the projection process. </p>

<p class="definition">Definition at line <a class="el" href="projection_8cpp_source.html#l01863">1863</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;{</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    <span class="comment">// If projecting forward initialize projections</span></div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    <span class="keywordflow">if</span> (FORW)</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    {</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        proj.<a class="code" href="group__FourierProjection.html#ga0996d67a36d07d6eb3373022c24c7952">reset</a>(Ydim, Xdim);</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        proj.<a class="code" href="group__FourierProjection.html#ga38fc7e819f167ed62bf63c13e1058aab">setAngles</a>(rot, tilt, <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>);</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;        norm_proj().initZeros(proj());</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    }</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    <span class="keywordflow">if</span>( threads &gt; 1 )</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    {</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> = 0 ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> &lt; threads ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>++ )</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;        {</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;            <a class="code" href="group__ParametersProjectionTomography.html#gaef66df64a8ff60fcb4b1aed8341af3b1">project_threads</a>[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structproject__thread__params.html#a4fe1936aa1f3a45350a62997776d6d25">global_proj</a> = &amp;proj;</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;            <a class="code" href="group__ParametersProjectionTomography.html#gaef66df64a8ff60fcb4b1aed8341af3b1">project_threads</a>[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structproject__thread__params.html#a08a3d2e659897fe8e5508fa4e68c4ef1">global_norm_proj</a> = &amp;norm_proj;</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;            <a class="code" href="group__ParametersProjectionTomography.html#gaef66df64a8ff60fcb4b1aed8341af3b1">project_threads</a>[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structproject__thread__params.html#ad93b2a0e2a11093fe3845d8500d0b823">FORW</a> = FORW;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;            <a class="code" href="group__ParametersProjectionTomography.html#gaef66df64a8ff60fcb4b1aed8341af3b1">project_threads</a>[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structproject__thread__params.html#aaa40b1f7b743bcb5484b346af156f830">eq_mode</a> = eq_mode;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;            <a class="code" href="group__ParametersProjectionTomography.html#gaef66df64a8ff60fcb4b1aed8341af3b1">project_threads</a>[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structproject__thread__params.html#a6a23faee5154c6127bb8c4e58cfd9cec">basis</a> = &amp;basis;</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;            <a class="code" href="group__ParametersProjectionTomography.html#gaef66df64a8ff60fcb4b1aed8341af3b1">project_threads</a>[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structproject__thread__params.html#aa24a5ba3945b9c1026445e3b262d51fb">M</a> = M;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;            <a class="code" href="group__ParametersProjectionTomography.html#gaef66df64a8ff60fcb4b1aed8341af3b1">project_threads</a>[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structproject__thread__params.html#a89cad4cf2af36eb0d2ac003e6c27a0d5">rot</a> = rot;</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;            <a class="code" href="group__ParametersProjectionTomography.html#gaef66df64a8ff60fcb4b1aed8341af3b1">project_threads</a>[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structproject__thread__params.html#a12b1bcc84d24d9cfd68094cfc427ed42">tilt</a> = tilt;</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;            <a class="code" href="group__ParametersProjectionTomography.html#gaef66df64a8ff60fcb4b1aed8341af3b1">project_threads</a>[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structproject__thread__params.html#ae51e9d9d12000ccee165160aaec242bf">psi</a> = <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>;</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;            <a class="code" href="group__ParametersProjectionTomography.html#gaef66df64a8ff60fcb4b1aed8341af3b1">project_threads</a>[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structproject__thread__params.html#a1cf910b5c9f5d30037fa4649aca8c00b">ray_length</a> = ray_length;</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        }</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    }</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <span class="keywordflow">if</span> (FORW)</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    {</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Number of volumes: &quot;</span> &lt;&lt; vol.<a class="code" href="classGridVolumeT.html#ab75022f1bcc31df3154d6bfb7bfa01b3">VolumesNo</a>() &lt;&lt; std::endl</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;YdimxXdim: &quot;</span> &lt;&lt; Ydim &lt;&lt; <span class="stringliteral">&quot;x&quot;</span> &lt;&lt; Xdim &lt;&lt; std::endl;</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; vol.<a class="code" href="classGridVolumeT.html#ab75022f1bcc31df3154d6bfb7bfa01b3">VolumesNo</a>(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Volume &quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; std::endl &lt;&lt; vol.<a class="code" href="classGridVolumeT.html#ae3533d1e5f50afe4575c0029cb3f9de3">grid</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; std::endl;</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    }</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <span class="comment">// Project each subvolume</span></div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; vol.<a class="code" href="classGridVolumeT.html#ab75022f1bcc31df3154d6bfb7bfa01b3">VolumesNo</a>(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    {</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        <a class="code" href="classImage.html">Image&lt;int&gt;</a> *VNeq;</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        <span class="keywordflow">if</span> (GVNeq != NULL)</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;            VNeq = &amp;((*GVNeq)(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;            VNeq = NULL;</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;        <span class="keywordflow">if</span>( threads &gt; 1 )</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        {</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;            <span class="keywordflow">for</span>( <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> = 0 ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a> &lt; threads ; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>++ )</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;            {</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;                <a class="code" href="group__ParametersProjectionTomography.html#gaef66df64a8ff60fcb4b1aed8341af3b1">project_threads</a>[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structproject__thread__params.html#acc59577968b550be7a7b2edcce5e6ee2">vol</a> = &amp;(vol(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;                <a class="code" href="group__ParametersProjectionTomography.html#gaef66df64a8ff60fcb4b1aed8341af3b1">project_threads</a>[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structproject__thread__params.html#a8c41102036b8d7bc7e89e9392cdc54c2">grid</a> = &amp;(vol.<a class="code" href="classGridVolumeT.html#ae3533d1e5f50afe4575c0029cb3f9de3">grid</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;                <a class="code" href="group__ParametersProjectionTomography.html#gaef66df64a8ff60fcb4b1aed8341af3b1">project_threads</a>[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structproject__thread__params.html#a7aa320d0e9acfe931bf0399f5d7cb549">VNeq</a> = VNeq;</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;                <a class="code" href="group__ParametersProjectionTomography.html#gaef66df64a8ff60fcb4b1aed8341af3b1">project_threads</a>[<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>].<a class="code" href="structproject__thread__params.html#aeb2b14aa64ac9499f2da17688b8fcc81">mask</a> = mask;</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;            }</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;            <a class="code" href="group__Threads.html#ga99a3a59fba69ac42cf6fb51df0dc5b64">barrier_wait</a>( &amp;<a class="code" href="group__ParametersProjectionTomography.html#ga3e46756d453b695deb8da52e590ef0b1">project_barrier</a> );</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;            <span class="comment">// Here is being processed the volume by the threads</span></div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;            <a class="code" href="group__Threads.html#ga99a3a59fba69ac42cf6fb51df0dc5b64">barrier_wait</a>( &amp;<a class="code" href="group__ParametersProjectionTomography.html#ga3e46756d453b695deb8da52e590ef0b1">project_barrier</a> );</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        }</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        {</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;            <span class="comment">// create no thread to do the job</span></div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;            <a class="code" href="group__ParametersProjectionTomography.html#ga9fa2cc1995e6791b45c9c0680a2e22d1">project_SimpleGrid</a>(&amp;(vol(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)), &amp;(vol.<a class="code" href="classGridVolumeT.html#ae3533d1e5f50afe4575c0029cb3f9de3">grid</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)), &amp;basis,</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;                               &amp;proj, &amp;norm_proj, FORW, eq_mode,</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;                               VNeq, M, mask, ray_length);</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        }</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        <a class="code" href="classImage.html">Image&lt;double&gt;</a> save;</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;        save = norm_proj;</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;        <span class="keywordflow">if</span> (FORW)</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;            save.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>((std::string)<span class="stringliteral">&quot;PPPnorm_FORW&quot;</span> + (<span class="keywordtype">char</span>)(48 + <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;            save.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>((std::string)<span class="stringliteral">&quot;PPPnorm_BACK&quot;</span> + (<span class="keywordtype">char</span>)(48 + <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    }</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;}</div><div class="ttc" id="structproject__thread__params_html_ae51e9d9d12000ccee165160aaec242bf"><div class="ttname"><a href="structproject__thread__params.html#ae51e9d9d12000ccee165160aaec242bf">project_thread_params::psi</a></div><div class="ttdeci">double psi</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00154">projection.h:154</a></div></div>
<div class="ttc" id="structproject__thread__params_html_aeb2b14aa64ac9499f2da17688b8fcc81"><div class="ttname"><a href="structproject__thread__params.html#aeb2b14aa64ac9499f2da17688b8fcc81">project_thread_params::mask</a></div><div class="ttdeci">const MultidimArray&lt; int &gt; * mask</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00150">projection.h:150</a></div></div>
<div class="ttc" id="group__FourierProjection_html_ga0996d67a36d07d6eb3373022c24c7952"><div class="ttname"><a href="group__FourierProjection.html#ga0996d67a36d07d6eb3373022c24c7952">Projection::reset</a></div><div class="ttdeci">void reset(int Ydim, int Xdim)</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8cpp_source.html#l00033">fourier_projection.cpp:33</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02230">numerical_recipes.cpp:2230</a></div></div>
<div class="ttc" id="structproject__thread__params_html_a08a3d2e659897fe8e5508fa4e68c4ef1"><div class="ttname"><a href="structproject__thread__params.html#a08a3d2e659897fe8e5508fa4e68c4ef1">project_thread_params::global_norm_proj</a></div><div class="ttdeci">Projection * global_norm_proj</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00145">projection.h:145</a></div></div>
<div class="ttc" id="structproject__thread__params_html_a8c41102036b8d7bc7e89e9392cdc54c2"><div class="ttname"><a href="structproject__thread__params.html#a8c41102036b8d7bc7e89e9392cdc54c2">project_thread_params::grid</a></div><div class="ttdeci">const SimpleGrid * grid</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00142">projection.h:142</a></div></div>
<div class="ttc" id="classImageBase_html_ae81a8c11a832924c2bda0909882c3168"><div class="ttname"><a href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">ImageBase::write</a></div><div class="ttdeci">void write(const FileName &amp;name=&quot;&quot;, size_t select_img=ALL_IMAGES, bool isStack=false, int mode=WRITE_OVERWRITE, CastWriteMode castMode=CW_CAST, int _swapWrite=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00292">xmipp_image_base.cpp:292</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="structproject__thread__params_html_a1cf910b5c9f5d30037fa4649aca8c00b"><div class="ttname"><a href="structproject__thread__params.html#a1cf910b5c9f5d30037fa4649aca8c00b">project_thread_params::ray_length</a></div><div class="ttdeci">double ray_length</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00151">projection.h:151</a></div></div>
<div class="ttc" id="structproject__thread__params_html_a7aa320d0e9acfe931bf0399f5d7cb549"><div class="ttname"><a href="structproject__thread__params.html#a7aa320d0e9acfe931bf0399f5d7cb549">project_thread_params::VNeq</a></div><div class="ttdeci">const Image&lt; int &gt; * VNeq</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00148">projection.h:148</a></div></div>
<div class="ttc" id="classGridVolumeT_html_ab75022f1bcc31df3154d6bfb7bfa01b3"><div class="ttname"><a href="classGridVolumeT.html#ab75022f1bcc31df3154d6bfb7bfa01b3">GridVolumeT::VolumesNo</a></div><div class="ttdeci">size_t VolumesNo() const</div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l01003">grids.h:1003</a></div></div>
<div class="ttc" id="group__ParametersProjectionTomography_html_ga9fa2cc1995e6791b45c9c0680a2e22d1"><div class="ttname"><a href="group__ParametersProjectionTomography.html#ga9fa2cc1995e6791b45c9c0680a2e22d1">project_SimpleGrid</a></div><div class="ttdeci">void project_SimpleGrid(Image&lt; T &gt; *vol, const SimpleGrid *grid, const Basis *basis, Projection *proj, Projection *norm_proj, int FORW, int eq_mode, const Image&lt; int &gt; *VNeq, Matrix2D&lt; double &gt; *M, const MultidimArray&lt; int &gt; *mask, double ray_length, int thread_id, int numthreads)</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l01314">projection.cpp:1314</a></div></div>
<div class="ttc" id="structproject__thread__params_html_ad93b2a0e2a11093fe3845d8500d0b823"><div class="ttname"><a href="structproject__thread__params.html#ad93b2a0e2a11093fe3845d8500d0b823">project_thread_params::FORW</a></div><div class="ttdeci">int FORW</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00146">projection.h:146</a></div></div>
<div class="ttc" id="group__ParametersProjectionTomography_html_ga3e46756d453b695deb8da52e590ef0b1"><div class="ttname"><a href="group__ParametersProjectionTomography.html#ga3e46756d453b695deb8da52e590ef0b1">project_barrier</a></div><div class="ttdeci">barrier_t project_barrier</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l00046">projection.cpp:46</a></div></div>
<div class="ttc" id="structproject__thread__params_html_acc59577968b550be7a7b2edcce5e6ee2"><div class="ttname"><a href="structproject__thread__params.html#acc59577968b550be7a7b2edcce5e6ee2">project_thread_params::vol</a></div><div class="ttdeci">Image&lt; double &gt; * vol</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00141">projection.h:141</a></div></div>
<div class="ttc" id="structproject__thread__params_html_aa24a5ba3945b9c1026445e3b262d51fb"><div class="ttname"><a href="structproject__thread__params.html#aa24a5ba3945b9c1026445e3b262d51fb">project_thread_params::M</a></div><div class="ttdeci">Matrix2D&lt; double &gt; * M</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00149">projection.h:149</a></div></div>
<div class="ttc" id="structproject__thread__params_html_a12b1bcc84d24d9cfd68094cfc427ed42"><div class="ttname"><a href="structproject__thread__params.html#a12b1bcc84d24d9cfd68094cfc427ed42">project_thread_params::tilt</a></div><div class="ttdeci">double tilt</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00153">projection.h:153</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; int &gt;</a></div></div>
<div class="ttc" id="classGridVolumeT_html_ae3533d1e5f50afe4575c0029cb3f9de3"><div class="ttname"><a href="classGridVolumeT.html#ae3533d1e5f50afe4575c0029cb3f9de3">GridVolumeT::grid</a></div><div class="ttdeci">const SimpleGrid &amp; grid(size_t n) const</div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00978">grids.h:978</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="group__ParametersProjectionTomography_html_gaef66df64a8ff60fcb4b1aed8341af3b1"><div class="ttname"><a href="group__ParametersProjectionTomography.html#gaef66df64a8ff60fcb4b1aed8341af3b1">project_threads</a></div><div class="ttdeci">project_thread_params * project_threads</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l00048">projection.cpp:48</a></div></div>
<div class="ttc" id="structproject__thread__params_html_a4fe1936aa1f3a45350a62997776d6d25"><div class="ttname"><a href="structproject__thread__params.html#a4fe1936aa1f3a45350a62997776d6d25">project_thread_params::global_proj</a></div><div class="ttdeci">Projection * global_proj</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00144">projection.h:144</a></div></div>
<div class="ttc" id="group__FourierProjection_html_ga38fc7e819f167ed62bf63c13e1058aab"><div class="ttname"><a href="group__FourierProjection.html#ga38fc7e819f167ed62bf63c13e1058aab">Projection::setAngles</a></div><div class="ttdeci">void setAngles(double _rot, double _tilt, double _psi)</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8cpp_source.html#l00040">fourier_projection.cpp:40</a></div></div>
<div class="ttc" id="group__Threads_html_ga99a3a59fba69ac42cf6fb51df0dc5b64"><div class="ttname"><a href="group__Threads.html#ga99a3a59fba69ac42cf6fb51df0dc5b64">barrier_wait</a></div><div class="ttdeci">int barrier_wait(barrier_t *barrier)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8cpp_source.html#l00382">xmipp_threads.cpp:382</a></div></div>
<div class="ttc" id="structproject__thread__params_html_aaa40b1f7b743bcb5484b346af156f830"><div class="ttname"><a href="structproject__thread__params.html#aaa40b1f7b743bcb5484b346af156f830">project_thread_params::eq_mode</a></div><div class="ttdeci">int eq_mode</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00147">projection.h:147</a></div></div>
<div class="ttc" id="structproject__thread__params_html_a6a23faee5154c6127bb8c4e58cfd9cec"><div class="ttname"><a href="structproject__thread__params.html#a6a23faee5154c6127bb8c4e58cfd9cec">project_thread_params::basis</a></div><div class="ttdeci">const Basis * basis</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00143">projection.h:143</a></div></div>
<div class="ttc" id="structproject__thread__params_html_a89cad4cf2af36eb0d2ac003e6c27a0d5"><div class="ttname"><a href="structproject__thread__params.html#a89cad4cf2af36eb0d2ac003e6c27a0d5">project_thread_params::rot</a></div><div class="ttdeci">double rot</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00152">projection.h:152</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga9fa2cc1995e6791b45c9c0680a2e22d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9fa2cc1995e6791b45c9c0680a2e22d1">&#9670;&nbsp;</a></span>project_SimpleGrid()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void project_SimpleGrid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classImage.html">Image</a>&lt; T &gt; *&#160;</td>
          <td class="paramname"><em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classSimpleGrid.html">SimpleGrid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBasis.html">Basis</a> *&#160;</td>
          <td class="paramname"><em>basis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> *&#160;</td>
          <td class="paramname"><em>proj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> *&#160;</td>
          <td class="paramname"><em>norm_proj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>FORW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>eq_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classImage.html">Image</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>VNeq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ray_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>thread_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numthreads</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classProjection.html">Projection</a> of a Simple <a class="el" href="classGrid.html">Grid</a>. Valid eq_modes are ARTK, CAVARTK and CAV. </p>

<p class="definition">Definition at line <a class="el" href="projection_8cpp_source.html#l01314">1314</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;{</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#ac4b52aadff4f14652b7c8c288af86a3e">zero</a>(3);                <span class="comment">// Origin (0,0,0)</span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> prjPix(3);       <span class="comment">// Position of the pixel within the projection</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> prjX(3);         <span class="comment">// Coordinate: Projection of the</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> prjY(3);         <span class="comment">// 3 grid vectors</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> prjZ(3);</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> prjOrigin(3);    <span class="comment">// Coordinate: Where in the 2D</span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="comment">// projection plane the origin of</span></div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <span class="comment">// the grid projects</span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> prjDir(3);       <span class="comment">// Projection direction</span></div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> actprj(3);       <span class="comment">// Coord: Actual position inside</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="comment">// the projection plane</span></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> beginZ(3);       <span class="comment">// Coord: Plane coordinates of the</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="comment">// projection of the 3D point</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="comment">// (z0,YY(lowest),XX(lowest))</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> univ_beginY(3);  <span class="comment">// Coord: coordinates of the</span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <span class="comment">// grid point</span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <span class="comment">// (z0,y0,XX(lowest))</span></div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> univ_beginZ(3);  <span class="comment">// Coord: coordinates of the</span></div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <span class="comment">// grid point</span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <span class="comment">// (z0,YY(lowest),XX(lowest))</span></div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> beginY(3);       <span class="comment">// Coord: Plane coordinates of the</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <span class="comment">// projection of the 3D point</span></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="comment">// (z0,y0,XX(lowest))</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <span class="keywordtype">double</span> XX_footprint_size=0.;                <span class="comment">// The footprint is supposed</span></div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="keywordtype">double</span> YY_footprint_size=0.;                <span class="comment">// to be defined between</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <span class="keywordtype">double</span> ZZ_footprint_size=0.;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <span class="comment">// (-vmax,+vmax) in the Y axis,</span></div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    <span class="comment">// and (-umax,+umax) in the X axis</span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <span class="comment">// This footprint size is the</span></div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <span class="comment">// R2 vector (umax,vmax).</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <span class="keywordtype">int</span> XX_corner2;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <span class="keywordtype">int</span> XX_corner1;              <span class="comment">// Coord: Corners of the</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordtype">int</span> YY_corner2;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="keywordtype">int</span> YY_corner1;              <span class="comment">// footprint when it is projected</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="comment">// onto the projection plane</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="keywordtype">int</span>           foot_V1=0;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    <span class="keywordtype">int</span>           foot_U1=0;      <span class="comment">// Img Coord: coordinate (in</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    <span class="comment">// an image fashion, not in an</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <span class="comment">// oversampled image fashion)</span></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <span class="comment">// inside the blobprint of the</span></div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="comment">// corner1</span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="keywordtype">int</span>        foot_V;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    <span class="keywordtype">int</span>        foot_U;            <span class="comment">// Img Coord: coordinate</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    <span class="keywordtype">int</span>        foot_W = 0;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <span class="comment">// corresponding to the blobprint</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <span class="comment">// point which matches with this</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="comment">// pixel position</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="keywordtype">int</span>           Vsampling=0;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="keywordtype">int</span>           Usampling=0;  <span class="comment">// Sampling rate in Y and X</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <span class="comment">// directions respectively</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <span class="comment">// inside the blobprint</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <span class="keywordtype">double</span>        vol_corr=0.;               <span class="comment">// Correction for a volume element</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <span class="keywordtype">int</span>           N_eq;                      <span class="comment">// Number of equations in which</span></div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="comment">// a blob is involved</span></div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <span class="keywordtype">int</span>           <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <span class="keywordtype">int</span>           <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <span class="keywordtype">int</span>           <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>;                   <span class="comment">// volume element indexes</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="keywordtype">bool</span>   isVolPSF = <span class="keyword">false</span>;    <span class="comment">// Blob footprint is VolumePSF</span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="comment">// Prepare system matrix for printing ...................................</span></div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <span class="keywordflow">if</span> (M != NULL)</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        M-&gt;<a class="code" href="classMatrix2D.html#a35921c37b27282bac3b3868cce8feb26">initZeros</a>(<a class="code" href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>((*proj)())*<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>((*proj)()), grid-&gt;<a class="code" href="classSimpleGrid.html#af3305993a13241aee82259893b045308">get_number_of_samples</a>());</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    <span class="comment">// Project grid axis ....................................................</span></div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="comment">// These vectors ((1,0,0),(0,1,0),...) are referred to the grid</span></div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <span class="comment">// coord. system and the result is a 2D vector in the image plane</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <span class="comment">// The unit size within the image plane is 1, ie, the same as for</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="comment">// the universal grid.</span></div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="comment">// actprj is reused with a different purpose</span></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(actprj, 1, 0, 0);</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    grid-&gt;<a class="code" href="classSimpleGrid.html#a580b115f104e8b44e9d523c7a58f438e">Gdir_project_to_plane</a>(actprj, proj-&gt;<a class="code" href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">euler</a>, prjX);</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(actprj, 0, 1, 0);</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    grid-&gt;<a class="code" href="classSimpleGrid.html#a580b115f104e8b44e9d523c7a58f438e">Gdir_project_to_plane</a>(actprj, proj-&gt;<a class="code" href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">euler</a>, prjY);</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(actprj, 0, 0, 1);</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    grid-&gt;<a class="code" href="classSimpleGrid.html#a580b115f104e8b44e9d523c7a58f438e">Gdir_project_to_plane</a>(actprj, proj-&gt;<a class="code" href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">euler</a>, prjZ);</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    <span class="comment">// This time the origin of the grid is in the universal coord system</span></div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <a class="code" href="group__Geometry.html#gade8f7976e3d84a594d4728bf8f4c029e">Uproject_to_plane</a>(grid-&gt;<a class="code" href="classSimpleGrid.html#a2eb28005f2a2af28ca2fab40772a2561">origin</a>, proj-&gt;<a class="code" href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">euler</a>, prjOrigin);</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="comment">// Get the projection direction .........................................</span></div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    proj-&gt;<a class="code" href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">euler</a>.<a class="code" href="classMatrix2D.html#a9e4bd9c27982c0d7775f3804bf021687">getRow</a>(2, prjDir);</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="comment">// Footprint size .......................................................</span></div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="comment">// The following vectors are integer valued vectors, but they are</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="comment">// stored as real ones to make easier operations with other vectors</span></div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="keywordflow">if</span> (basis-&gt;<a class="code" href="classBasis.html#a12a694f7cef08beaf6f7d51b2837432c">type</a> == <a class="code" href="classBasis.html#aa73185836d4dd144f8591d827d8f952ca5e21d65cbd3255eed09cafb1d2ad0143">Basis::blobs</a>)</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    {</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        XX_footprint_size = basis-&gt;<a class="code" href="classBasis.html#af8314ea940eb8cacc15fda550ea5c8d3">blobprint</a>.<a class="code" href="classImageOver.html#a71c097e5382fb1680d726af25a20d6c4">umax</a>();</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        YY_footprint_size = basis-&gt;<a class="code" href="classBasis.html#af8314ea940eb8cacc15fda550ea5c8d3">blobprint</a>.<a class="code" href="classImageOver.html#a7f602e77d043f66061d28fa68ddbb40c">vmax</a>();</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        Usampling         = basis-&gt;<a class="code" href="classBasis.html#af8314ea940eb8cacc15fda550ea5c8d3">blobprint</a>.<a class="code" href="classImageOver.html#a7f85075ea38546d220bad704f8211cad">Ustep</a>();</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        Vsampling         = basis-&gt;<a class="code" href="classBasis.html#af8314ea940eb8cacc15fda550ea5c8d3">blobprint</a>.<a class="code" href="classImageOver.html#a4bb219dff520a88573c8ac71f05422be">Vstep</a>();</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        <span class="comment">// Set the limit for grid points out of PSF</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;        <span class="keywordflow">if</span> (basis-&gt;<a class="code" href="classBasis.html#a25323c0ed53fb08dcb549c21faea33ff">VolPSF</a> != NULL)</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        {</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            isVolPSF = <span class="keyword">true</span>;</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;            ZZ_footprint_size = basis-&gt;<a class="code" href="classBasis.html#af8314ea940eb8cacc15fda550ea5c8d3">blobprint</a>.<a class="code" href="classImageOver.html#a6cece1669005ceb2b2c7898e1ed4a3fe">wmax</a>();</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        }</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    }</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (basis-&gt;<a class="code" href="classBasis.html#a12a694f7cef08beaf6f7d51b2837432c">type</a> == <a class="code" href="classBasis.html#aa73185836d4dd144f8591d827d8f952ca4ae0f2a6cf6249b5a25ec78352325160">Basis::voxels</a> || basis-&gt;<a class="code" href="classBasis.html#a12a694f7cef08beaf6f7d51b2837432c">type</a> == <a class="code" href="classBasis.html#aa73185836d4dd144f8591d827d8f952ca22d68f5f02d77c712461e2dd630873b9">Basis::splines</a>)</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    {</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        YY_footprint_size = XX_footprint_size = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(basis-&gt;<a class="code" href="classBasis.html#a9bb393c44cf8444b958183ff0737263c">maxLength</a>());</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        Usampling = Vsampling = 0;</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    }</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    XX_footprint_size += <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    YY_footprint_size += <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>;</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="comment">// Project the whole grid ...............................................</span></div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <span class="comment">// Corner of the plane defined by Z. These coordinates try to be within</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="comment">// the valid indexes of the projection (defined between STARTING and</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <span class="comment">// FINISHING values, but it could be that they may lie outside.</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <span class="comment">// These coordinates need not to be integer, in general, they are</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="comment">// real vectors.</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <span class="comment">// The vectors returned by the projection routines are R3 but we</span></div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="comment">// are only interested in their first 2 components, ie, in the</span></div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <span class="comment">// in-plane components</span></div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="comment">// This type conversion gives more speed</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keyword">auto</span> ZZ_lowest = (int) <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(grid-&gt;<a class="code" href="classSimpleGrid.html#ac11364ea0ab16392eef9db243986bc5a">lowest</a>);</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="keywordflow">if</span>( thread_id != -1 )</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;        ZZ_lowest += thread_id;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <span class="keyword">auto</span> YY_lowest = (int) <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(grid-&gt;<a class="code" href="classSimpleGrid.html#ac11364ea0ab16392eef9db243986bc5a">lowest</a>);</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="keyword">auto</span> XX_lowest = (int) <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(grid-&gt;<a class="code" href="classSimpleGrid.html#ac11364ea0ab16392eef9db243986bc5a">lowest</a>);</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="keyword">auto</span> ZZ_highest = (int) <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(grid-&gt;<a class="code" href="classSimpleGrid.html#a9b2b5818f2b06e553c3c6a2a6d2a8951">highest</a>);</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <span class="keyword">auto</span> YY_highest = (int) <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(grid-&gt;<a class="code" href="classSimpleGrid.html#a9b2b5818f2b06e553c3c6a2a6d2a8951">highest</a>);</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <span class="keyword">auto</span> XX_highest = (int) <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(grid-&gt;<a class="code" href="classSimpleGrid.html#a9b2b5818f2b06e553c3c6a2a6d2a8951">highest</a>);</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    beginZ = (double)XX_lowest * prjX + (<span class="keywordtype">double</span>)YY_lowest * prjY + (double)ZZ_lowest * prjZ + prjOrigin;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <span class="comment">// Check if in VSSNR</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="keywordtype">bool</span> VSSNR_mode = (ray_length == basis-&gt;<a class="code" href="classBasis.html#a9bb393c44cf8444b958183ff0737263c">maxLength</a>());</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="keywordtype">int</span> condition;</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    condition = thread_id==1;</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <span class="keywordflow">if</span> (condition || numthreads==1)</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    {</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Equation mode &quot;</span> &lt;&lt; eq_mode &lt;&lt; std::endl;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Footprint size &quot;</span> &lt;&lt; YY_footprint_size &lt;&lt; <span class="stringliteral">&quot;x&quot;</span></div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        &lt;&lt; XX_footprint_size &lt;&lt; std::endl;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;rot=&quot;</span> &lt;&lt; proj-&gt;<a class="code" href="classImageBase.html#ae93e05fe473a50784bdbf28dbcbad20a">rot</a>() &lt;&lt; <span class="stringliteral">&quot; tilt=&quot;</span> &lt;&lt; proj-&gt;<a class="code" href="classImageBase.html#a14098c8a502f3b324ffccef3fcde0de9">tilt</a>()</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; psi=&quot;</span> &lt;&lt; proj-&gt;<a class="code" href="classImageBase.html#a890fd19f4204e83abac6b73c3ca82a1f">psi</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Euler matrix &quot;</span> &lt;&lt; proj-&gt;<a class="code" href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">euler</a>;</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Projection direction &quot;</span> &lt;&lt; prjDir &lt;&lt; std::endl;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        std::cout &lt;&lt; *grid;</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;image limits (&quot;</span> &lt;&lt; <a class="code" href="projection_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="projection_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a> &lt;&lt; <span class="stringliteral">&quot;) (&quot;</span> &lt;&lt; <a class="code" href="projection_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        &lt;&lt; <a class="code" href="projection_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a> &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;prjX           &quot;</span> &lt;&lt; prjX.transpose()      &lt;&lt; std::endl;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;prjY           &quot;</span> &lt;&lt; prjY.transpose()      &lt;&lt; std::endl;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;prjZ           &quot;</span> &lt;&lt; prjZ.transpose()      &lt;&lt; std::endl;</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;prjOrigin      &quot;</span> &lt;&lt; prjOrigin.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;beginZ(coord)  &quot;</span> &lt;&lt; beginZ.transpose()    &lt;&lt; std::endl;</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;lowest         &quot;</span> &lt;&lt; XX_lowest  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; YY_lowest</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; XX_lowest  &lt;&lt; std::endl;</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;highest        &quot;</span> &lt;&lt; XX_highest &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; YY_highest</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; XX_highest &lt;&lt; std::endl;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Stats of input basis volume &quot;</span>;</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        (*vol)().printStats();</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        std::cout.flush();</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    }</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="comment">// Compute the grid lattice vectors in space ............................</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> grid_basis(3, 3);</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    grid_basis = grid-&gt;basis * grid-&gt;relative_size;</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> gridX(3);  <span class="comment">// Direction of the grid lattice vectors</span></div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> gridY(3);  <span class="comment">// in universal coordinates</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> gridZ(3);</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> univ_position(3);</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    grid_basis.getCol(0, gridX);</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    grid_basis.getCol(1, gridY);</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    grid_basis.getCol(2, gridZ);</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    univ_beginZ = (double)XX_lowest * gridX + (<span class="keywordtype">double</span>)YY_lowest * gridY + (double)ZZ_lowest * gridZ + grid-&gt;origin;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="keywordtype">int</span> number_of_basis = 0;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aca6408d1d58d2334ecf5b80c3a9a8881">for</a> (k = ZZ_lowest; k &lt;= ZZ_highest; k += numthreads)</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    {</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        <span class="comment">// Corner of the row defined by Y</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        beginY = beginZ;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        univ_beginY = univ_beginZ;</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        <span class="keywordflow">for</span> (i = YY_lowest; i &lt;= YY_highest; i++)</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        {</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;            <span class="comment">// First point in the row</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;            actprj = beginY;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;            univ_position = univ_beginY;</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;            <span class="keywordflow">for</span> (j = XX_lowest; j &lt;= XX_highest; j++)</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;            {</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                <span class="comment">// Ray length interesting</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                <span class="keywordtype">bool</span> ray_length_interesting = <span class="keyword">true</span>;</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                <span class="keywordtype">double</span> zCenterDist;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a> = 0; <span class="comment">// z = 0 standard value for non 3D blobprints</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                <span class="keywordflow">if</span> (ray_length != -1 || isVolPSF)</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                {</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                    zCenterDist = <a class="code" href="group__Geometry.html#gaa4d9e4ee82f494ed61ace73dd7a2dc81">point_plane_distance_3D</a>(univ_position, <a class="code" href="numerical__recipes_8cpp.html#ac4b52aadff4f14652b7c8c288af86a3e">zero</a>,</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                                                          proj-&gt;<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                    <span class="keywordflow">if</span> (ray_length != -1)</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                        ray_length_interesting = (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(zCenterDist) &lt;= ray_length);</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                    <span class="comment">// Points out of 3DPSF</span></div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                    <span class="keywordflow">if</span> (isVolPSF &amp;&amp; ray_length_interesting)</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                    {</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                        ray_length_interesting = (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(zCenterDist) &lt;= ZZ_footprint_size);</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                        <span class="comment">// There is still missing the shift of the volume from focal plane</span></div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                        z = zCenterDist; <span class="comment">// + shiftZ</span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                    }</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                }</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                <span class="keywordflow">if</span> (grid-&gt;is_interesting(univ_position) &amp;&amp;</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                    ray_length_interesting)</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                {</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                    <span class="comment">// Be careful that you cannot skip any basis, although its</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                    <span class="comment">// value be 0, because it is useful for norm_proj</span></div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                    condition = thread_id == 1;</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                    <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                    {</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                        printf(<span class="stringliteral">&quot;\nProjecting grid coord (%d,%d,%d) &quot;</span>, j, i, k);</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;Vol there = &quot;</span> &lt;&lt; <a class="code" href="group__Images.html#ga9b8f3c798427474abfd9070b6f482249">VOLVOXEL</a>(*vol, k, i, j) &lt;&lt; std::endl;</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                        printf(<span class="stringliteral">&quot; 3D universal position (%f,%f,%f) \n&quot;</span>,</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                               <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(univ_position), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(univ_position), <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(univ_position));</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot; Center of the basis proj (2D) &quot;</span> &lt;&lt; <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(actprj) &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(actprj) &lt;&lt; std::endl;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                        <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> aux;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                        <a class="code" href="group__Geometry.html#gade8f7976e3d84a594d4728bf8f4c029e">Uproject_to_plane</a>(univ_position, proj-&gt;<a class="code" href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">euler</a>, aux);</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot; Center of the basis proj (more accurate) &quot;</span> &lt;&lt; aux.<a class="code" href="classMatrix1D.html#a028505ebdeaf6f62d884c31dcd5127a8">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                    }</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                    <span class="comment">// Search for integer corners for this basis</span></div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                    XX_corner1 = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(<a class="code" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(*proj)), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(actprj) - XX_footprint_size));</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                    YY_corner1 = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(<a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(<a class="code" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(*proj)), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(actprj) - YY_footprint_size));</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                    XX_corner2 = <a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>(<a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(<a class="code" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(*proj)), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(actprj) + XX_footprint_size));</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                    YY_corner2 = <a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>(<a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(<a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(<a class="code" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(*proj)), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(actprj) + YY_footprint_size));</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                    <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                    {</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;Clipped and rounded Corner 1 &quot;</span> &lt;&lt; XX_corner1</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; YY_corner1 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;Clipped and rounded Corner 2 &quot;</span> &lt;&lt; XX_corner2</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; YY_corner2 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                    }</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                    <span class="comment">// Check if the basis falls outside the projection plane</span></div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                    <span class="comment">// COSS: I have changed here</span></div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                    <span class="keywordflow">if</span> (XX_corner1 &lt;= XX_corner2 &amp;&amp; YY_corner1 &lt;= YY_corner2)</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                    {</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;                        <span class="comment">// Compute the index of the basis for corner1</span></div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                        <span class="keywordflow">if</span> (basis-&gt;<a class="code" href="classBasis.html#a12a694f7cef08beaf6f7d51b2837432c">type</a> == <a class="code" href="classBasis.html#aa73185836d4dd144f8591d827d8f952ca5e21d65cbd3255eed09cafb1d2ad0143">Basis::blobs</a>)</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                        {</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                            <a class="code" href="xmipp__image__over_8h.html#a26486cdc744270937159a9255fd4dd41">OVER2IMG</a>(basis-&gt;<a class="code" href="classBasis.html#af8314ea940eb8cacc15fda550ea5c8d3">blobprint</a>, (<span class="keywordtype">double</span>)YY_corner1 - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(actprj),</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;                                     (<span class="keywordtype">double</span>)XX_corner1 - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(actprj), foot_V1, foot_U1);</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                            <span class="keywordflow">if</span> (isVolPSF != <span class="keyword">false</span>)</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                                <a class="code" href="xmipp__image__over_8h.html#ae6d9f9fe77076fc08cc6072a92cd37d0">OVER2IMG_Z</a>(basis-&gt;<a class="code" href="classBasis.html#af8314ea940eb8cacc15fda550ea5c8d3">blobprint</a>, z, foot_W);</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                        }</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                        <span class="keywordflow">if</span> (!FORW)</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                            vol_corr = 0;</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                        <span class="comment">// Effectively project this basis</span></div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                        <span class="comment">// N_eq=(YY_corner2-YY_corner1+1)*(XX_corner2-XX_corner1+1);</span></div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                        N_eq = 0;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                        foot_V = foot_V1;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="projection_8cpp.html#afffa29183d9c97e35c9e6b263445fd3e">y</a> = YY_corner1; <a class="code" href="projection_8cpp.html#afffa29183d9c97e35c9e6b263445fd3e">y</a> &lt;= YY_corner2; <a class="code" href="projection_8cpp.html#afffa29183d9c97e35c9e6b263445fd3e">y</a>++)</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                        {</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                            foot_U = foot_U1;</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="projection_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> = XX_corner1; <a class="code" href="projection_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> &lt;= XX_corner2; <a class="code" href="projection_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>++)</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;                            {</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;                                <span class="keywordflow">if</span> (!((mask != NULL) &amp;&amp; <a class="code" href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(*mask,<a class="code" href="projection_8cpp.html#afffa29183d9c97e35c9e6b263445fd3e">y</a>,<a class="code" href="projection_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>)&lt;0.5))</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;                                {</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                                    <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                                    {</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                                        std::cout &lt;&lt; <span class="stringliteral">&quot;Position in projection (&quot;</span> &lt;&lt; <a class="code" href="projection_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                                        &lt;&lt; <a class="code" href="projection_8cpp.html#afffa29183d9c97e35c9e6b263445fd3e">y</a> &lt;&lt; <span class="stringliteral">&quot;) &quot;</span>;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                                        <span class="keywordtype">double</span> <a class="code" href="projection_8cpp.html#afffa29183d9c97e35c9e6b263445fd3e">y</a>, <a class="code" href="projection_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>;</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                                        <span class="keywordflow">if</span> (basis-&gt;<a class="code" href="classBasis.html#a12a694f7cef08beaf6f7d51b2837432c">type</a> == <a class="code" href="classBasis.html#aa73185836d4dd144f8591d827d8f952ca5e21d65cbd3255eed09cafb1d2ad0143">Basis::blobs</a>)</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                                        {</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                                            std::cout &lt;&lt; <span class="stringliteral">&quot;in footprint (&quot;</span></div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                                            &lt;&lt; foot_U &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; foot_V &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                                            <a class="code" href="xmipp__image__over_8h.html#aec248f641411eee7c13d5eaf800366e3">IMG2OVER</a>(basis-&gt;<a class="code" href="classBasis.html#af8314ea940eb8cacc15fda550ea5c8d3">blobprint</a>, foot_V, foot_U, y, x);</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                                            std::cout &lt;&lt; <span class="stringliteral">&quot; (d= &quot;</span> &lt;&lt; <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(y*y + x*x) &lt;&lt; <span class="stringliteral">&quot;) &quot;</span>;</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                                            fflush(stdout);</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                                        }</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                                    }</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                                    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>;</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                                    <span class="keywordtype">double</span> a2;</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                                    <span class="comment">// Check if volumetric interpolation (i.e., SSNR)</span></div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                                    <span class="keywordflow">if</span> (VSSNR_mode)</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                                    {</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                                        <span class="comment">// This is the VSSNR case</span></div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                                        <span class="comment">// Get the pixel position in the universal coordinate</span></div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                                        <span class="comment">// system</span></div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                                        <a class="code" href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a>;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                                        <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(prjPix, x, y, z);</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                                        <a class="code" href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a>(prjPix, proj-&gt;<a class="code" href="group__FourierProjection.html#ga7c0ae2d78ba098df1b33115e94918f18">eulert</a>, prjPix);</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                                        <a class="code" href="group__Vectors.html#ga84bcbfeda75ac1ed822f6d92585e4fdf">V3_MINUS_V3</a>(prjPix, prjPix, univ_position);</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                                        a = basis-&gt;<a class="code" href="classBasis.html#aa16a8398b8b9377b2e26dbef8fae0fad">valueAt</a>(prjPix);</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                                        a2 = a * <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>;</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                                    }</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                                    <span class="keywordflow">else</span></div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                                    {</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                                        <span class="comment">// This is normal reconstruction from projections</span></div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                                        <span class="keywordflow">if</span> (basis-&gt;<a class="code" href="classBasis.html#a12a694f7cef08beaf6f7d51b2837432c">type</a> == <a class="code" href="classBasis.html#aa73185836d4dd144f8591d827d8f952ca5e21d65cbd3255eed09cafb1d2ad0143">Basis::blobs</a>)</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                                        {</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                                            <span class="comment">// Projection of a blob</span></div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                                            a = <a class="code" href="group__Images.html#ga9b8f3c798427474abfd9070b6f482249">VOLVOXEL</a>(basis-&gt;<a class="code" href="classBasis.html#af8314ea940eb8cacc15fda550ea5c8d3">blobprint</a>, foot_W, foot_V, foot_U);</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                                            a2 = <a class="code" href="group__Images.html#ga9b8f3c798427474abfd9070b6f482249">VOLVOXEL</a>(basis-&gt;<a class="code" href="classBasis.html#aa98a82b3be7c72135cdd3af50bba7b73">blobprint2</a>, foot_W, foot_V, foot_U);</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                                        }</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                                        <span class="keywordflow">else</span></div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                                        {</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                                            <span class="comment">// Projection of other bases</span></div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                                            <span class="comment">// If the basis is big enough, then</span></div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                                            <span class="comment">// it is not necessary to integrate at several</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                                            <span class="comment">// places. Big enough is being greater than</span></div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                                            <span class="comment">// 1.41 which is the maximum separation</span></div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                                            <span class="comment">// between two pixels</span></div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                                            <span class="keywordflow">if</span> (XX_footprint_size &gt; 1.41)</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                                            {</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                                                <span class="comment">// Get the pixel in universal coordinates</span></div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;                                                <a class="code" href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a>;</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                                                <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(prjPix, x, y, 0);</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;                                                <span class="comment">// Express the point in a local coordinate system</span></div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;                                                <a class="code" href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a>(prjPix, proj-&gt;<a class="code" href="group__FourierProjection.html#ga7c0ae2d78ba098df1b33115e94918f18">eulert</a>, prjPix);</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                                                <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;                                                    std::cout &lt;&lt; <span class="stringliteral">&quot; in volume coord (&quot;</span></div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                                                    &lt;&lt; prjPix.transpose() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                                                <a class="code" href="group__Vectors.html#ga84bcbfeda75ac1ed822f6d92585e4fdf">V3_MINUS_V3</a>(prjPix, prjPix, univ_position);</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                                                <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;                                                    std::cout &lt;&lt; <span class="stringliteral">&quot; in voxel coord (&quot;</span></div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;                                                    &lt;&lt; prjPix.transpose() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;                                                a = basis-&gt;<a class="code" href="classBasis.html#ae765e5c976e94f1c0ef4b4255ee34be8">projectionAt</a>(prjDir, prjPix);</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                                                a2 = a * <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>;</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                                            }</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                                            <span class="keywordflow">else</span></div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                                            {</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                                                <span class="comment">// If the basis is too small (of the</span></div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                                                <span class="comment">// range of the voxel), then it is</span></div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                                                <span class="comment">// necessary to sample in a few places</span></div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;                                                <span class="keyword">const</span> <span class="keywordtype">double</span> p0 = 1.0 / (2 * <a class="code" href="group__ParametersProjectionTomography.html#ga9d1421cb7105f364df31c920daee64cd">ART_PIXEL_SUBSAMPLING</a>) - 0.5;</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;                                                <span class="keyword">const</span> <span class="keywordtype">double</span> pStep = 1.0 / <a class="code" href="group__ParametersProjectionTomography.html#ga9d1421cb7105f364df31c920daee64cd">ART_PIXEL_SUBSAMPLING</a>;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                                                <span class="keyword">const</span> <span class="keywordtype">double</span> pAvg = 1.0 / (<a class="code" href="group__ParametersProjectionTomography.html#ga9d1421cb7105f364df31c920daee64cd">ART_PIXEL_SUBSAMPLING</a> * <a class="code" href="group__ParametersProjectionTomography.html#ga9d1421cb7105f364df31c920daee64cd">ART_PIXEL_SUBSAMPLING</a>);</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                                                <span class="keywordtype">int</span> ii;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                                                <span class="keywordtype">int</span> jj;</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                                                <span class="keywordtype">double</span> px;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                                                <span class="keywordtype">double</span> py;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                                                a = 0;</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;                                                <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;                                                    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;                                                <span class="keywordflow">for</span> (ii = 0, px = p0; ii &lt; <a class="code" href="group__ParametersProjectionTomography.html#ga9d1421cb7105f364df31c920daee64cd">ART_PIXEL_SUBSAMPLING</a>; ii++, px += pStep)</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                                                    <span class="keywordflow">for</span> (jj = 0, py = p0; jj &lt; <a class="code" href="group__ParametersProjectionTomography.html#ga9d1421cb7105f364df31c920daee64cd">ART_PIXEL_SUBSAMPLING</a>; jj++, py += pStep)</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;                                                    {</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                                                        <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;                                                            std::cout &lt;&lt; <span class="stringliteral">&quot;    subsampling (&quot;</span> &lt;&lt; ii &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;                                                            &lt;&lt; jj &lt;&lt; <span class="stringliteral">&quot;) &quot;</span>;</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                                                        <a class="code" href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a>;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                                                        <span class="comment">// Get the pixel in universal coordinates</span></div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                                                        <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(prjPix, x + px, y + py, 0);</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                                                        <span class="comment">// Express the point in a local coordinate system</span></div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                                                        <a class="code" href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a>(prjPix, proj-&gt;<a class="code" href="group__FourierProjection.html#ga7c0ae2d78ba098df1b33115e94918f18">eulert</a>, prjPix);</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                                                        <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                                                            std::cout &lt;&lt; <span class="stringliteral">&quot; in volume coord (&quot;</span></div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                                                            &lt;&lt; prjPix.transpose() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                                                        <a class="code" href="group__Vectors.html#ga84bcbfeda75ac1ed822f6d92585e4fdf">V3_MINUS_V3</a>(prjPix, prjPix, univ_position);</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                                                        <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                                                            std::cout &lt;&lt; <span class="stringliteral">&quot; in voxel coord (&quot;</span></div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                                                            &lt;&lt; prjPix.transpose() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;                                                        a += basis-&gt;<a class="code" href="classBasis.html#ae765e5c976e94f1c0ef4b4255ee34be8">projectionAt</a>(prjDir, prjPix);</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                                                        <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                                                            std::cout &lt;&lt; <span class="stringliteral">&quot; partial a=&quot;</span></div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                                                            &lt;&lt; basis-&gt;<a class="code" href="classBasis.html#ae765e5c976e94f1c0ef4b4255ee34be8">projectionAt</a>(prjDir, prjPix)</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                                                            &lt;&lt; std::endl;</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                                                    }</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                                                a *= pAvg;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                                                a2 = a * <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                                                <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                                                    std::cout &lt;&lt; <span class="stringliteral">&quot;   Finally &quot;</span>;</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;                                            }</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;                                        }</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;                                    }</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;                                    <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;                                        std::cout &lt;&lt; <span class="stringliteral">&quot;=&quot;</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot; , &quot;</span> &lt;&lt; a2;</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                                    <span class="keywordflow">if</span> (FORW)</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                                    {</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;                                        <span class="keywordflow">switch</span> (eq_mode)</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;                                        {</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;                                        <span class="keywordflow">case</span> <a class="code" href="group__ParametersProjectionTomography.html#ga66def0fa268ae303861b249fa125deb8">CAVARTK</a>:</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                                        <span class="keywordflow">case</span> <a class="code" href="group__ParametersProjectionTomography.html#ga64d6cb0b0a0141854ec21615c4a39d6a">ARTK</a>:</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                                            <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(*proj, y, x) += <a class="code" href="group__Images.html#ga9b8f3c798427474abfd9070b6f482249">VOLVOXEL</a>(*vol, k, i, j) * <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>;</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                                            <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(*norm_proj, y, x) += a2;</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                                            <span class="keywordflow">if</span> (M != NULL)</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;                                            {</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                                                <span class="keywordtype">int</span> py;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;                                                <span class="keywordtype">int</span> px;</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                                                (*proj)().toPhysical(y, x, py, px);</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;                                                <span class="keywordtype">int</span> number_of_pixel = py * <a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>((*proj)()) + px;</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                                                <a class="code" href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a>(*M, number_of_pixel, number_of_basis) = <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;                                            }</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;                                        <span class="keywordflow">case</span> <a class="code" href="group__ParametersProjectionTomography.html#ga1d8d965aac23a7a7e10e4fe50ae70f41">CAVK</a>:</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;                                            <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(*proj, y, x) += <a class="code" href="group__Images.html#ga9b8f3c798427474abfd9070b6f482249">VOLVOXEL</a>(*vol, k, i, j) * <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>;</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;                                            <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(*norm_proj, y, x) += a2 * N_eq;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;                                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;                                        <span class="keywordflow">case</span> <a class="code" href="group__ParametersProjectionTomography.html#ga3c6a0d295bfc7f31b0c926d9a25527e8">COUNT_EQ</a>:</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;                                            <a class="code" href="group__Images.html#ga9b8f3c798427474abfd9070b6f482249">VOLVOXEL</a>(*vol, k, i, j)++;</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;                                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                                        <span class="keywordflow">case</span> <a class="code" href="group__ParametersProjectionTomography.html#ga56d592540304881fd5411961458e4118">CAV</a>:</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;                                            <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(*proj, y, x) += <a class="code" href="group__Images.html#ga9b8f3c798427474abfd9070b6f482249">VOLVOXEL</a>(*vol, k, i, j) * <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>;</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                                            <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(*norm_proj, y, x) += a2 *</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                                                                          <a class="code" href="group__Images.html#ga9b8f3c798427474abfd9070b6f482249">VOLVOXEL</a>(*VNeq, k, i, j);</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;                                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                                        }</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                                        <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                                        {</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                                            std::cout &lt;&lt; <span class="stringliteral">&quot; proj= &quot;</span> &lt;&lt; <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(*proj, y, x)</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;                                            &lt;&lt; <span class="stringliteral">&quot; norm_proj=&quot;</span> &lt;&lt; <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(*norm_proj, y, x) &lt;&lt; std::endl;</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                                            std::cout.flush();</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                                        }</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                                    }</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                                    <span class="keywordflow">else</span></div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                                    {</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                                        vol_corr += <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(*norm_proj, y, x) * <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                                        <span class="keywordflow">if</span> (a != 0)</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                                            N_eq++;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                                        <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                                        {</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                                            std::cout &lt;&lt; <span class="stringliteral">&quot; corr_img= &quot;</span> &lt;&lt; <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(*norm_proj, y, x)</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                                            &lt;&lt; <span class="stringliteral">&quot; correction=&quot;</span> &lt;&lt; vol_corr &lt;&lt; std::endl;</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                                            std::cout.flush();</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;                                        }</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;                                    }</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;                                }</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                                <span class="comment">// Prepare for next operation</span></div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;                                foot_U += Usampling;</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;                            }</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;                            foot_V += Vsampling;</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;                        } <span class="comment">// Project this basis</span></div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;                        <span class="keywordflow">if</span> (!FORW)</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;                        {</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;                            T correction = 0;</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;                            <span class="keywordflow">switch</span> (eq_mode)</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;                            {</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                            <span class="keywordflow">case</span> <a class="code" href="group__ParametersProjectionTomography.html#ga64d6cb0b0a0141854ec21615c4a39d6a">ARTK</a>:</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;                                correction = (T) vol_corr;</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;                            <span class="keywordflow">case</span> <a class="code" href="group__ParametersProjectionTomography.html#ga66def0fa268ae303861b249fa125deb8">CAVARTK</a>:</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                                <span class="keywordflow">if</span> (N_eq != 0)</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;                                    correction = (T)(vol_corr / N_eq);</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                            <span class="keywordflow">case</span> <a class="code" href="group__ParametersProjectionTomography.html#ga1d8d965aac23a7a7e10e4fe50ae70f41">CAVK</a>:</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;                            <span class="keywordflow">case</span> <a class="code" href="group__ParametersProjectionTomography.html#ga56d592540304881fd5411961458e4118">CAV</a>:</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                                correction = (T) vol_corr;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                            }</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                            <a class="code" href="group__Images.html#ga9b8f3c798427474abfd9070b6f482249">VOLVOXEL</a>(*vol, k, i, j) += correction;</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                            <span class="keywordflow">if</span> (condition)</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                            {</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                                printf(<span class="stringliteral">&quot;\nFinal value at (%d,%d,%d) &quot;</span>, j, i, k);</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                                std::cout &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; <a class="code" href="group__Images.html#ga9b8f3c798427474abfd9070b6f482249">VOLVOXEL</a>(*vol, k, i, j) &lt;&lt; std::endl;</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                                std::cout.flush();</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                            }</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                        }</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;                    } <span class="comment">// If not collapsed</span></div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                    number_of_basis++;</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                } <span class="comment">// If interesting</span></div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;                <span class="comment">// Prepare for next iteration</span></div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;                <a class="code" href="group__Vectors.html#ga43b95e9bbf36d0aff1e421a35e113682">V2_PLUS_V2</a>(actprj, actprj, prjX);</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;                <a class="code" href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a>(univ_position, univ_position, gridX);</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;            }</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;            <a class="code" href="group__Vectors.html#ga43b95e9bbf36d0aff1e421a35e113682">V2_PLUS_V2</a>(beginY, beginY, prjY);</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;            <a class="code" href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a>(univ_beginY, univ_beginY, gridY);</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        }</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        <a class="code" href="group__Vectors.html#ga43b95e9bbf36d0aff1e421a35e113682">V2_PLUS_V2</a>(beginZ, beginZ, prjZ * numthreads );</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;        <a class="code" href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a>(univ_beginZ, univ_beginZ, gridZ * numthreads);</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    }</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;}</div><div class="ttc" id="group__FourierProjection_html_ga7c0ae2d78ba098df1b33115e94918f18"><div class="ttname"><a href="group__FourierProjection.html#ga7c0ae2d78ba098df1b33115e94918f18">Projection::eulert</a></div><div class="ttdeci">Matrix2D&lt; double &gt; eulert</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00079">fourier_projection.h:79</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00095">multidim_array_base.h:95</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00354">multidim_array_base.h:354</a></div></div>
<div class="ttc" id="group__Images_html_ga9b8f3c798427474abfd9070b6f482249"><div class="ttname"><a href="group__Images.html#ga9b8f3c798427474abfd9070b6f482249">VOLVOXEL</a></div><div class="ttdeci">#define VOLVOXEL(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00213">xmipp_image_base.h:213</a></div></div>
<div class="ttc" id="group__Macros_html_gae0a4180e923e3ffca3989e20e441aa3c"><div class="ttname"><a href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a></div><div class="ttdeci">#define XMIPP_MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00193">xmipp_macros.h:193</a></div></div>
<div class="ttc" id="classSimpleGrid_html_a9b2b5818f2b06e553c3c6a2a6d2a8951"><div class="ttname"><a href="classSimpleGrid.html#a9b2b5818f2b06e553c3c6a2a6d2a8951">SimpleGrid::highest</a></div><div class="ttdeci">Matrix1D&lt; double &gt; highest</div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00161">grids.h:161</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="group__ParametersProjectionTomography_html_ga3c6a0d295bfc7f31b0c926d9a25527e8"><div class="ttname"><a href="group__ParametersProjectionTomography.html#ga3c6a0d295bfc7f31b0c926d9a25527e8">COUNT_EQ</a></div><div class="ttdeci">constexpr int COUNT_EQ</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00179">projection.h:179</a></div></div>
<div class="ttc" id="classBasis_html_aa73185836d4dd144f8591d827d8f952ca5e21d65cbd3255eed09cafb1d2ad0143"><div class="ttname"><a href="classBasis.html#aa73185836d4dd144f8591d827d8f952ca5e21d65cbd3255eed09cafb1d2ad0143">Basis::blobs</a></div><div class="ttdef"><b>Definition:</b> <a href="basis_8h_source.html#l00049">basis.h:49</a></div></div>
<div class="ttc" id="classImageBase_html_a890fd19f4204e83abac6b73c3ca82a1f"><div class="ttname"><a href="classImageBase.html#a890fd19f4204e83abac6b73c3ca82a1f">ImageBase::psi</a></div><div class="ttdeci">double psi(const size_t n=0) const</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00391">xmipp_image_base.cpp:391</a></div></div>
<div class="ttc" id="classBasis_html_ae765e5c976e94f1c0ef4b4255ee34be8"><div class="ttname"><a href="classBasis.html#ae765e5c976e94f1c0ef4b4255ee34be8">Basis::projectionAt</a></div><div class="ttdeci">double projectionAt(const Matrix1D&lt; double &gt; &amp;u, const Matrix1D&lt; double &gt; &amp;r) const</div><div class="ttdef"><b>Definition:</b> <a href="basis_8cpp_source.html#l00367">basis.cpp:367</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00210">image_operate.cpp:210</a></div></div>
<div class="ttc" id="group__FourierProjection_html_gabef83744f4e0571354f31586fb41d357"><div class="ttname"><a href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">Projection::euler</a></div><div class="ttdeci">Matrix2D&lt; double &gt; euler</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00071">fourier_projection.h:71</a></div></div>
<div class="ttc" id="group__Vectors_html_ga84bcbfeda75ac1ed822f6d92585e4fdf"><div class="ttname"><a href="group__Vectors.html#ga84bcbfeda75ac1ed822f6d92585e4fdf">V3_MINUS_V3</a></div><div class="ttdeci">#define V3_MINUS_V3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00202">matrix1d.h:202</a></div></div>
<div class="ttc" id="classImageOver_html_a71c097e5382fb1680d726af25a20d6c4"><div class="ttname"><a href="classImageOver.html#a71c097e5382fb1680d726af25a20d6c4">ImageOver::umax</a></div><div class="ttdeci">int umax() const</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__over_8h_source.html#l00322">xmipp_image_over.h:322</a></div></div>
<div class="ttc" id="group__ParametersProjectionTomography_html_ga64d6cb0b0a0141854ec21615c4a39d6a"><div class="ttname"><a href="group__ParametersProjectionTomography.html#ga64d6cb0b0a0141854ec21615c4a39d6a">ARTK</a></div><div class="ttdeci">constexpr int ARTK</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00177">projection.h:177</a></div></div>
<div class="ttc" id="classBasis_html_a12a694f7cef08beaf6f7d51b2837432c"><div class="ttname"><a href="classBasis.html#a12a694f7cef08beaf6f7d51b2837432c">Basis::type</a></div><div class="ttdeci">tBasisFunction type</div><div class="ttdoc">Basis function to use. </div><div class="ttdef"><b>Definition:</b> <a href="basis_8h_source.html#l00052">basis.h:52</a></div></div>
<div class="ttc" id="projection_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="projection_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">#define x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02473">numerical_recipes.cpp:2473</a></div></div>
<div class="ttc" id="classImageBase_html_ae93e05fe473a50784bdbf28dbcbad20a"><div class="ttname"><a href="classImageBase.html#ae93e05fe473a50784bdbf28dbcbad20a">ImageBase::rot</a></div><div class="ttdeci">double rot(const size_t n=0) const</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00365">xmipp_image_base.cpp:365</a></div></div>
<div class="ttc" id="classBasis_html_aa98a82b3be7c72135cdd3af50bba7b73"><div class="ttname"><a href="classBasis.html#aa98a82b3be7c72135cdd3af50bba7b73">Basis::blobprint2</a></div><div class="ttdeci">ImageOver blobprint2</div><div class="ttdoc">Square of the footprint. </div><div class="ttdef"><b>Definition:</b> <a href="basis_8h_source.html#l00074">basis.h:74</a></div></div>
<div class="ttc" id="classBasis_html_a9bb393c44cf8444b958183ff0737263c"><div class="ttname"><a href="classBasis.html#a9bb393c44cf8444b958183ff0737263c">Basis::maxLength</a></div><div class="ttdeci">double maxLength() const</div><div class="ttdef"><b>Definition:</b> <a href="basis_8cpp_source.html#l00242">basis.cpp:242</a></div></div>
<div class="ttc" id="group__Images_html_ga6096c97ad2ba182701f4877c206acb94"><div class="ttname"><a href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a></div><div class="ttdeci">#define IMGMATRIX(I)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00180">xmipp_image_base.h:180</a></div></div>
<div class="ttc" id="classSimpleGrid_html_ac11364ea0ab16392eef9db243986bc5a"><div class="ttname"><a href="classSimpleGrid.html#ac11364ea0ab16392eef9db243986bc5a">SimpleGrid::lowest</a></div><div class="ttdeci">Matrix1D&lt; double &gt; lowest</div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00158">grids.h:158</a></div></div>
<div class="ttc" id="classImageOver_html_a4bb219dff520a88573c8ac71f05422be"><div class="ttname"><a href="classImageOver.html#a4bb219dff520a88573c8ac71f05422be">ImageOver::Vstep</a></div><div class="ttdeci">int Vstep() const</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__over_8h_source.html#l00400">xmipp_image_over.h:400</a></div></div>
<div class="ttc" id="projection_8cpp_html_a8f613ddaea2048e3471a1f4f04ba4b79"><div class="ttname"><a href="projection_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a></div><div class="ttdeci">#define xF</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l00038">projection.cpp:38</a></div></div>
<div class="ttc" id="classImageOver_html_a7f85075ea38546d220bad704f8211cad"><div class="ttname"><a href="classImageOver.html#a7f85075ea38546d220bad704f8211cad">ImageOver::Ustep</a></div><div class="ttdeci">int Ustep() const</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__over_8h_source.html#l00387">xmipp_image_over.h:387</a></div></div>
<div class="ttc" id="group__Vectors_html_ga43b95e9bbf36d0aff1e421a35e113682"><div class="ttname"><a href="group__Vectors.html#ga43b95e9bbf36d0aff1e421a35e113682">V2_PLUS_V2</a></div><div class="ttdeci">#define V2_PLUS_V2(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00134">matrix1d.h:134</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classMatrix1D_html_a028505ebdeaf6f62d884c31dcd5127a8"><div class="ttname"><a href="classMatrix1D.html#a028505ebdeaf6f62d884c31dcd5127a8">Matrix1D::transpose</a></div><div class="ttdeci">Matrix1D&lt; T &gt; transpose() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8cpp_source.html#l00631">matrix1d.cpp:631</a></div></div>
<div class="ttc" id="classImageBase_html_a14098c8a502f3b324ffccef3fcde0de9"><div class="ttname"><a href="classImageBase.html#a14098c8a502f3b324ffccef3fcde0de9">ImageBase::tilt</a></div><div class="ttdeci">double tilt(const size_t n=0) const</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00378">xmipp_image_base.cpp:378</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00059">multidim_array_base.h:59</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__ParametersProjectionTomography_html_ga9d1421cb7105f364df31c920daee64cd"><div class="ttname"><a href="group__ParametersProjectionTomography.html#ga9d1421cb7105f364df31c920daee64cd">ART_PIXEL_SUBSAMPLING</a></div><div class="ttdeci">const int ART_PIXEL_SUBSAMPLING</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00296">projection.h:296</a></div></div>
<div class="ttc" id="classImageOver_html_a7f602e77d043f66061d28fa68ddbb40c"><div class="ttname"><a href="classImageOver.html#a7f602e77d043f66061d28fa68ddbb40c">ImageOver::vmax</a></div><div class="ttdeci">int vmax() const</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__over_8h_source.html#l00335">xmipp_image_over.h:335</a></div></div>
<div class="ttc" id="group__Macros_html_ga2f0eecb0f7856721f56faff8f27b0dc1"><div class="ttname"><a href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a></div><div class="ttdeci">#define FLOOR(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00240">xmipp_macros.h:240</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00085">matrix1d.h:85</a></div></div>
<div class="ttc" id="classBasis_html_a25323c0ed53fb08dcb549c21faea33ff"><div class="ttname"><a href="classBasis.html#a25323c0ed53fb08dcb549c21faea33ff">Basis::VolPSF</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * VolPSF</div><div class="ttdoc">Footprint is convolved with a volume PSF // At this moment only used with blobs. </div><div class="ttdef"><b>Definition:</b> <a href="basis_8h_source.html#l00055">basis.h:55</a></div></div>
<div class="ttc" id="group__Geometry_html_gaa4d9e4ee82f494ed61ace73dd7a2dc81"><div class="ttname"><a href="group__Geometry.html#gaa4d9e4ee82f494ed61ace73dd7a2dc81">point_plane_distance_3D</a></div><div class="ttdeci">double point_plane_distance_3D(const Matrix1D&lt; double &gt; &amp;p, const Matrix1D&lt; double &gt; &amp;a, const Matrix1D&lt; double &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8h_source.html#l00171">geometry.h:171</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="group__Matrices_html_gaf0f6abe0342cabe025337d656f034e87"><div class="ttname"><a href="group__Matrices.html#gaf0f6abe0342cabe025337d656f034e87">dMij</a></div><div class="ttdeci">#define dMij(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00139">matrix2d.h:139</a></div></div>
<div class="ttc" id="group__Macros_html_gad584f97e936242b173add43261376ba5"><div class="ttname"><a href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a></div><div class="ttdeci">#define XMIPP_EQUAL_ACCURACY</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00119">xmipp_macros.h:119</a></div></div>
<div class="ttc" id="xmipp__image__over_8h_html_aec248f641411eee7c13d5eaf800366e3"><div class="ttname"><a href="xmipp__image__over_8h.html#aec248f641411eee7c13d5eaf800366e3">IMG2OVER</a></div><div class="ttdeci">#define IMG2OVER(IO, iv, iu, v, u)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__over_8h_source.html#l00234">xmipp_image_over.h:234</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00091">multidim_array_base.h:91</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="projection_8cpp_html_a132f3924593d07b0a1f55b3f22e92ba6"><div class="ttname"><a href="projection_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a></div><div class="ttdeci">#define yF</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l00040">projection.cpp:40</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aa508e3dbd0e86258b5c69e8a8b6b8295"><div class="ttname"><a href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08492">numerical_recipes.cpp:8492</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca6408d1d58d2334ecf5b80c3a9a8881"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca6408d1d58d2334ecf5b80c3a9a8881">for</a></div><div class="ttdeci">for(j=1;j&lt;=i__1;++j)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02310">numerical_recipes.cpp:2310</a></div></div>
<div class="ttc" id="classBasis_html_aa73185836d4dd144f8591d827d8f952ca22d68f5f02d77c712461e2dd630873b9"><div class="ttname"><a href="classBasis.html#aa73185836d4dd144f8591d827d8f952ca22d68f5f02d77c712461e2dd630873b9">Basis::splines</a></div><div class="ttdef"><b>Definition:</b> <a href="basis_8h_source.html#l00049">basis.h:49</a></div></div>
<div class="ttc" id="group__FourierProjection_html_ga532f6713fbe228d3ee30f4d3a2766a20"><div class="ttname"><a href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">Projection::direction</a></div><div class="ttdeci">Matrix1D&lt; double &gt; direction</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00062">fourier_projection.h:62</a></div></div>
<div class="ttc" id="group__Macros_html_gac9ae6a207f10c821b06a8c0df153a7d5"><div class="ttname"><a href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a></div><div class="ttdeci">#define XMIPP_MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00181">xmipp_macros.h:181</a></div></div>
<div class="ttc" id="classBasis_html_aa16a8398b8b9377b2e26dbef8fae0fad"><div class="ttname"><a href="classBasis.html#aa16a8398b8b9377b2e26dbef8fae0fad">Basis::valueAt</a></div><div class="ttdeci">double valueAt(const Matrix1D&lt; double &gt; &amp;r) const</div><div class="ttdef"><b>Definition:</b> <a href="basis_8cpp_source.html#l00332">basis.cpp:332</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__Matrices_html_gad159332322d687de886a720422e4b757"><div class="ttname"><a href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a></div><div class="ttdeci">#define M3x3_BY_V3x1(a, M, b)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00170">matrix2d.h:170</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00093">matrix1d.h:93</a></div></div>
<div class="ttc" id="projection_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="projection_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l00037">projection.cpp:37</a></div></div>
<div class="ttc" id="group__ParametersProjectionTomography_html_ga56d592540304881fd5411961458e4118"><div class="ttname"><a href="group__ParametersProjectionTomography.html#ga56d592540304881fd5411961458e4118">CAV</a></div><div class="ttdeci">constexpr int CAV</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00180">projection.h:180</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00063">multidim_array_base.h:63</a></div></div>
<div class="ttc" id="group__ParametersProjectionTomography_html_ga66def0fa268ae303861b249fa125deb8"><div class="ttname"><a href="group__ParametersProjectionTomography.html#ga66def0fa268ae303861b249fa125deb8">CAVARTK</a></div><div class="ttdeci">constexpr int CAVARTK</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00181">projection.h:181</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="projection_8cpp_html_afffa29183d9c97e35c9e6b263445fd3e"><div class="ttname"><a href="projection_8cpp.html#afffa29183d9c97e35c9e6b263445fd3e">y</a></div><div class="ttdeci">#define y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08510">numerical_recipes.cpp:8510</a></div></div>
<div class="ttc" id="classSimpleGrid_html_a2eb28005f2a2af28ca2fab40772a2561"><div class="ttname"><a href="classSimpleGrid.html#a2eb28005f2a2af28ca2fab40772a2561">SimpleGrid::origin</a></div><div class="ttdeci">Matrix1D&lt; double &gt; origin</div><div class="ttdoc">Origin of the grid in the Universal coordinate system. </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00165">grids.h:165</a></div></div>
<div class="ttc" id="group__ParametersProjectionTomography_html_ga1d8d965aac23a7a7e10e4fe50ae70f41"><div class="ttname"><a href="group__ParametersProjectionTomography.html#ga1d8d965aac23a7a7e10e4fe50ae70f41">CAVK</a></div><div class="ttdeci">constexpr int CAVK</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00178">projection.h:178</a></div></div>
<div class="ttc" id="group__Vectors_html_ga6c6b4d4f88daca5e1d8e171bec3b4af0"><div class="ttname"><a href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a></div><div class="ttdeci">#define VECTOR_R3(v, x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00124">matrix1d.h:124</a></div></div>
<div class="ttc" id="classSimpleGrid_html_af3305993a13241aee82259893b045308"><div class="ttname"><a href="classSimpleGrid.html#af3305993a13241aee82259893b045308">SimpleGrid::get_number_of_samples</a></div><div class="ttdeci">int get_number_of_samples() const</div><div class="ttdef"><b>Definition:</b> <a href="grids_8cpp_source.html#l00069">grids.cpp:69</a></div></div>
<div class="ttc" id="xmipp__image__over_8h_html_a26486cdc744270937159a9255fd4dd41"><div class="ttname"><a href="xmipp__image__over_8h.html#a26486cdc744270937159a9255fd4dd41">OVER2IMG</a></div><div class="ttdeci">#define OVER2IMG(IO, v, u, iv, iu)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__over_8h_source.html#l00196">xmipp_image_over.h:196</a></div></div>
<div class="ttc" id="classMatrix2D_html_a35921c37b27282bac3b3868cce8feb26"><div class="ttname"><a href="classMatrix2D.html#a35921c37b27282bac3b3868cce8feb26">Matrix2D::initZeros</a></div><div class="ttdeci">void initZeros()</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00626">matrix2d.h:626</a></div></div>
<div class="ttc" id="classSimpleGrid_html_a580b115f104e8b44e9d523c7a58f438e"><div class="ttname"><a href="classSimpleGrid.html#a580b115f104e8b44e9d523c7a58f438e">SimpleGrid::Gdir_project_to_plane</a></div><div class="ttdeci">void Gdir_project_to_plane(const Matrix1D&lt; double &gt; &amp;gr, double rot, double tilt, double psi, Matrix1D&lt; double &gt; &amp;result) const</div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00432">grids.h:432</a></div></div>
<div class="ttc" id="classMatrix2D_html_a9e4bd9c27982c0d7775f3804bf021687"><div class="ttname"><a href="classMatrix2D.html#a9e4bd9c27982c0d7775f3804bf021687">Matrix2D::getRow</a></div><div class="ttdeci">void getRow(size_t i, Matrix1D&lt; T &gt; &amp;v) const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l00871">matrix2d.cpp:871</a></div></div>
<div class="ttc" id="group__Geometry_html_gade8f7976e3d84a594d4728bf8f4c029e"><div class="ttname"><a href="group__Geometry.html#gade8f7976e3d84a594d4728bf8f4c029e">Uproject_to_plane</a></div><div class="ttdeci">void Uproject_to_plane(const Matrix1D&lt; double &gt; &amp;point, const Matrix1D&lt; double &gt; &amp;direction, double distance, Matrix1D&lt; double &gt; &amp;result)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00039">geometry.cpp:39</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00101">matrix1d.h:101</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af2a333b1670df64a88d3a2f22210d155"><div class="ttname"><a href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a></div><div class="ttdeci">doublereal * a</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02230">numerical_recipes.cpp:2230</a></div></div>
<div class="ttc" id="classBasis_html_aa73185836d4dd144f8591d827d8f952ca4ae0f2a6cf6249b5a25ec78352325160"><div class="ttname"><a href="classBasis.html#aa73185836d4dd144f8591d827d8f952ca4ae0f2a6cf6249b5a25ec78352325160">Basis::voxels</a></div><div class="ttdef"><b>Definition:</b> <a href="basis_8h_source.html#l00049">basis.h:49</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ac4b52aadff4f14652b7c8c288af86a3e"><div class="ttname"><a href="numerical__recipes_8cpp.html#ac4b52aadff4f14652b7c8c288af86a3e">zero</a></div><div class="ttdeci">ql0001_ &amp; zero(ctemp+1),(cvec+1),(a+1),(b+1),(bl+1),(bu+1),(x+1),(w+1), &amp;iout, ifail, &amp;zero,(w+3), &amp;lwar2,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="projection_8cpp_html_a0d9521fd31b2e16413d1b78836953d53"><div class="ttname"><a href="projection_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a></div><div class="ttdeci">#define y0</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l00039">projection.cpp:39</a></div></div>
<div class="ttc" id="group__Vectors_html_gafe748b92e8aeaa282eb7bafbd2baca37"><div class="ttname"><a href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a></div><div class="ttdeci">#define V3_PLUS_V3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00190">matrix1d.h:190</a></div></div>
<div class="ttc" id="group__Images_html_gaad11fc7e221702e9f1adeb445ba5db9c"><div class="ttname"><a href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a></div><div class="ttdeci">#define IMGPIXEL(I, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00185">xmipp_image_base.h:185</a></div></div>
<div class="ttc" id="group__Macros_html_ga20716e3da0ba25d3c4c9a2421573391f"><div class="ttname"><a href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a></div><div class="ttdeci">#define SPEED_UP_temps012</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00403">xmipp_macros.h:403</a></div></div>
<div class="ttc" id="classBasis_html_af8314ea940eb8cacc15fda550ea5c8d3"><div class="ttname"><a href="classBasis.html#af8314ea940eb8cacc15fda550ea5c8d3">Basis::blobprint</a></div><div class="ttdeci">ImageOver blobprint</div><div class="ttdoc">Blob footprint. </div><div class="ttdef"><b>Definition:</b> <a href="basis_8h_source.html#l00071">basis.h:71</a></div></div>
<div class="ttc" id="classImageOver_html_a6cece1669005ceb2b2c7898e1ed4a3fe"><div class="ttname"><a href="classImageOver.html#a6cece1669005ceb2b2c7898e1ed4a3fe">ImageOver::wmax</a></div><div class="ttdeci">int wmax() const</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__over_8h_source.html#l00348">xmipp_image_over.h:348</a></div></div>
<div class="ttc" id="xmipp__image__over_8h_html_ae6d9f9fe77076fc08cc6072a92cd37d0"><div class="ttname"><a href="xmipp__image__over_8h.html#ae6d9f9fe77076fc08cc6072a92cd37d0">OVER2IMG_Z</a></div><div class="ttdeci">#define OVER2IMG_Z(IO, w, iw)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__over_8h_source.html#l00200">xmipp_image_over.h:200</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga8a291520ffc843c4d21eaf1038be55fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8a291520ffc843c4d21eaf1038be55fe">&#9670;&nbsp;</a></span>project_SimpleGridThread()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void* project_SimpleGridThread </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Threaded projection for simple grids </p>

<p class="definition">Definition at line <a class="el" href="projection_8cpp_source.html#l01215">1215</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;{</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keyword">auto</span> * thread_data = (<a class="code" href="structproject__thread__params.html">project_thread_params</a> *)params;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <a class="code" href="classImage.html">Image&lt;T&gt;</a> * vol;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="keyword">const</span> <a class="code" href="classSimpleGrid.html">SimpleGrid</a> * grid;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keywordtype">int</span> thread_id = thread_data-&gt;thread_id;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="keywordtype">int</span> threads_count = thread_data-&gt;threads_count;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="keyword">const</span> <a class="code" href="classBasis.html">Basis</a> * basis;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <a class="code" href="classProjection.html">Projection</a> * proj;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <a class="code" href="classProjection.html">Projection</a> * norm_proj;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <span class="keyword">auto</span> * forw_proj = <span class="keyword">new</span> <a class="code" href="classProjection.html">Projection</a>();</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="keyword">auto</span> * forw_norm_proj = <span class="keyword">new</span> <a class="code" href="classProjection.html">Projection</a>();</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <a class="code" href="classProjection.html">Projection</a> * global_proj;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <a class="code" href="classProjection.html">Projection</a> * global_norm_proj;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="keywordtype">int</span> FORW;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordtype">int</span> eq_mode;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="keyword">const</span> <a class="code" href="classImage.html">Image&lt;int&gt;</a> *VNeq=NULL;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> *M=NULL;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="keyword">const</span> <a class="code" href="classMultidimArray.html">MultidimArray&lt;int&gt;</a> *mask=NULL;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keywordtype">double</span> ray_length;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="keywordtype">double</span> rot;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keywordtype">double</span> tilt;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keywordflow">do</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    {</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        <a class="code" href="group__Threads.html#ga99a3a59fba69ac42cf6fb51df0dc5b64">barrier_wait</a>( &amp;<a class="code" href="group__ParametersProjectionTomography.html#ga3e46756d453b695deb8da52e590ef0b1">project_barrier</a> );</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        <span class="keywordflow">if</span>( thread_data-&gt;destroy == <span class="keyword">true</span> )</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        vol = thread_data-&gt;vol;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        grid = thread_data-&gt;grid;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        basis = thread_data-&gt;basis;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        FORW = thread_data-&gt;FORW;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        eq_mode = thread_data-&gt;eq_mode;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        VNeq = thread_data-&gt;VNeq;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        M = thread_data-&gt;M;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        mask = thread_data-&gt;mask;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        ray_length = thread_data-&gt;ray_length;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        global_proj = thread_data-&gt;global_proj;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        global_norm_proj = thread_data-&gt;global_norm_proj;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        rot = thread_data-&gt;<a class="code" href="classImageBase.html#ae93e05fe473a50784bdbf28dbcbad20a">rot</a>;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        tilt = thread_data-&gt;tilt;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        psi = thread_data-&gt;psi;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        <span class="keywordflow">if</span>( FORW )</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        {</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;            proj = forw_proj;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;            norm_proj = forw_norm_proj;</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;            proj-&gt;<a class="code" href="group__FourierProjection.html#ga0996d67a36d07d6eb3373022c24c7952">reset</a>(<a class="code" href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>( (*global_proj)() ), <a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>( (*global_proj)() ));</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;            proj-&gt;<a class="code" href="group__FourierProjection.html#ga38fc7e819f167ed62bf63c13e1058aab">setAngles</a>(rot, tilt, psi);</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;            (*norm_proj)().initZeros((*proj)());</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        }</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        {</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;            proj = global_proj;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;            norm_proj = global_norm_proj;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        }</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        <a class="code" href="group__ParametersProjectionTomography.html#ga9fa2cc1995e6791b45c9c0680a2e22d1">project_SimpleGrid</a>( vol, grid,</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                            basis,</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                            proj,</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                            norm_proj, FORW, eq_mode,</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                            VNeq, M, mask,</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                            ray_length,</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                            thread_id,</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                            threads_count</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                          );</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        <span class="keywordflow">if</span>( FORW )</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        {</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;            pthread_mutex_lock( &amp;<a class="code" href="group__ParametersProjectionTomography.html#ga6b8971032d8e98145e6691683950fe8c">project_mutex</a> );</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;            (*global_proj)() = (*global_proj)() + (*proj)();</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;            (*global_norm_proj)() = (*global_norm_proj)() + (*norm_proj)();</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;            pthread_mutex_unlock( &amp;<a class="code" href="group__ParametersProjectionTomography.html#ga6b8971032d8e98145e6691683950fe8c">project_mutex</a> );</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        }</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        <a class="code" href="group__Threads.html#ga99a3a59fba69ac42cf6fb51df0dc5b64">barrier_wait</a>( &amp;<a class="code" href="group__ParametersProjectionTomography.html#ga3e46756d453b695deb8da52e590ef0b1">project_barrier</a> );</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    }</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="keywordflow">while</span>(1);</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">void</span> *)NULL;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;}</div><div class="ttc" id="multidim__array__base_8h_html_a93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00095">multidim_array_base.h:95</a></div></div>
<div class="ttc" id="group__FourierProjection_html_ga0996d67a36d07d6eb3373022c24c7952"><div class="ttname"><a href="group__FourierProjection.html#ga0996d67a36d07d6eb3373022c24c7952">Projection::reset</a></div><div class="ttdeci">void reset(int Ydim, int Xdim)</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8cpp_source.html#l00033">fourier_projection.cpp:33</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; int &gt;</a></div></div>
<div class="ttc" id="classImageBase_html_ae93e05fe473a50784bdbf28dbcbad20a"><div class="ttname"><a href="classImageBase.html#ae93e05fe473a50784bdbf28dbcbad20a">ImageBase::rot</a></div><div class="ttdeci">double rot(const size_t n=0) const</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00365">xmipp_image_base.cpp:365</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__ParametersProjectionTomography_html_ga9fa2cc1995e6791b45c9c0680a2e22d1"><div class="ttname"><a href="group__ParametersProjectionTomography.html#ga9fa2cc1995e6791b45c9c0680a2e22d1">project_SimpleGrid</a></div><div class="ttdeci">void project_SimpleGrid(Image&lt; T &gt; *vol, const SimpleGrid *grid, const Basis *basis, Projection *proj, Projection *norm_proj, int FORW, int eq_mode, const Image&lt; int &gt; *VNeq, Matrix2D&lt; double &gt; *M, const MultidimArray&lt; int &gt; *mask, double ray_length, int thread_id, int numthreads)</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l01314">projection.cpp:1314</a></div></div>
<div class="ttc" id="classBasis_html"><div class="ttname"><a href="classBasis.html">Basis</a></div><div class="ttdef"><b>Definition:</b> <a href="basis_8h_source.html#l00045">basis.h:45</a></div></div>
<div class="ttc" id="group__ParametersProjectionTomography_html_ga6b8971032d8e98145e6691683950fe8c"><div class="ttname"><a href="group__ParametersProjectionTomography.html#ga6b8971032d8e98145e6691683950fe8c">project_mutex</a></div><div class="ttdeci">pthread_mutex_t project_mutex</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l00047">projection.cpp:47</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00091">multidim_array_base.h:91</a></div></div>
<div class="ttc" id="classSimpleGrid_html"><div class="ttname"><a href="classSimpleGrid.html">SimpleGrid</a></div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00144">grids.h:144</a></div></div>
<div class="ttc" id="classProjection_html"><div class="ttname"><a href="classProjection.html">Projection</a></div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00056">fourier_projection.h:56</a></div></div>
<div class="ttc" id="group__ParametersProjectionTomography_html_ga3e46756d453b695deb8da52e590ef0b1"><div class="ttname"><a href="group__ParametersProjectionTomography.html#ga3e46756d453b695deb8da52e590ef0b1">project_barrier</a></div><div class="ttdeci">barrier_t project_barrier</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l00046">projection.cpp:46</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image</a></div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8h_source.html#l00036">image_operate.h:36</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="structproject__thread__params_html"><div class="ttname"><a href="structproject__thread__params.html">project_thread_params</a></div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00137">projection.h:137</a></div></div>
<div class="ttc" id="group__FourierProjection_html_ga38fc7e819f167ed62bf63c13e1058aab"><div class="ttname"><a href="group__FourierProjection.html#ga38fc7e819f167ed62bf63c13e1058aab">Projection::setAngles</a></div><div class="ttdeci">void setAngles(double _rot, double _tilt, double _psi)</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8cpp_source.html#l00040">fourier_projection.cpp:40</a></div></div>
<div class="ttc" id="group__Threads_html_ga99a3a59fba69ac42cf6fb51df0dc5b64"><div class="ttname"><a href="group__Threads.html#ga99a3a59fba69ac42cf6fb51df0dc5b64">barrier_wait</a></div><div class="ttdeci">int barrier_wait(barrier_t *barrier)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8cpp_source.html#l00382">xmipp_threads.cpp:382</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaa2a035335544acb914ec49b685e3cfcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa2a035335544acb914ec49b685e3cfcc">&#9670;&nbsp;</a></span>projectVolume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void projectVolume </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>roffset</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>From voxel volumes. The voxel volume is projected onto a projection plane defined by (rot, tilt, psi) (1st, 2nd and 3rd <a class="el" href="classEuler.html">Euler</a> angles) . The projection is previously is resized to Ydim x Xdim and initialized to 0. The projection itself, from now on, will keep the <a class="el" href="classEuler.html">Euler</a> angles.</p>
<p>The offset is a 3D vector specifying the offset that must be applied when going from the projection space to the universal space</p>
<p>rproj=E*r+roffset =&gt; r=E^t (rproj-roffset)</p>
<p>Set it to NULL if you don't want to use it </p>

<p class="definition">Definition at line <a class="el" href="projection_8cpp_source.html#l00337">337</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;{</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <a class="code" href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a>;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">// Initialise projection</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    P.<a class="code" href="group__FourierProjection.html#ga0996d67a36d07d6eb3373022c24c7952">reset</a>(Ydim, Xdim);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    P.<a class="code" href="group__FourierProjection.html#ga38fc7e819f167ed62bf63c13e1058aab">setAngles</a>(rot, tilt, <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">// Compute the distance for this line crossing one voxel</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordtype">int</span> x_0 = <a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(V);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordtype">int</span> x_F = <a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(V);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordtype">int</span> y_0 = <a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(V);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordtype">int</span> y_F = <a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(V);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordtype">int</span> z_0 = <a class="code" href="multidim__array__base_8h.html#aafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(V);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordtype">int</span> z_F = <a class="code" href="multidim__array__base_8h.html#a706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(V);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// Distances in X and Y between the center of the projection pixel begin</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">// computed and each computed ray</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordtype">double</span> step = 1.0 / 3.0;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">// Avoids divisions by zero and allows orthogonal rays computation</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) == 0)</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) = <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) == 0)</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) = <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) == 0)</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) = <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">// Some precalculated variables</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordtype">int</span> x_sign = <a class="code" href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>));</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordtype">int</span> y_sign = <a class="code" href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>));</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordtype">int</span> z_sign = <a class="code" href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a>(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>));</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordtype">double</span> half_x_sign = 0.5 * x_sign;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordtype">double</span> half_y_sign = 0.5 * y_sign;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordtype">double</span> half_z_sign = 0.5 * z_sign;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordtype">double</span> iXXP_direction=1.0/<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordtype">double</span> iYYP_direction=1.0/<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordtype">double</span> iZZP_direction=1.0/<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;mP = P();</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a>  v(3);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> r_p(3); <span class="comment">// r_p are the coordinates of the</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">// pixel being projected in the</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">// coordinate system attached to the</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">// projection</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> p1(3);  <span class="comment">// coordinates of the pixel in the</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">// universal space</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> p1_shifted(3); <span class="comment">// shifted half a pixel</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(mP)</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keywordtype">double</span> ray_sum = 0.0;    <span class="comment">// Line integral value</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="comment">// Computes 4 different rays for each pixel.</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rays_per_pixel = 0; rays_per_pixel &lt; 4; rays_per_pixel++)</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="comment">// universal coordinate system</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="keywordflow">switch</span> (rays_per_pixel)</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(r_p, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - step, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - step, 0);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(r_p, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - step, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + step, 0);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(r_p, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + step, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - step, 0);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(r_p, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + step, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + step, 0);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            <span class="comment">// Express r_p in the universal coordinate system</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="keywordflow">if</span> (roffset!=<span class="keyword">nullptr</span>)</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                r_p-=*roffset;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <a class="code" href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a>(p1, P.<a class="code" href="group__FourierProjection.html#ga7c0ae2d78ba098df1b33115e94918f18">eulert</a>, r_p);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p1_shifted)=<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p1)-half_x_sign;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p1_shifted)=<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p1)-half_y_sign;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(p1_shifted)=<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(p1)-half_z_sign;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            <span class="comment">// Compute the minimum and maximum alpha for the ray</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <span class="comment">// intersecting the given volume</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="keywordtype">double</span> alpha_xmin = (x_0 - 0.5 - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p1))* iXXP_direction;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            <span class="keywordtype">double</span> alpha_xmax = (x_F + 0.5 - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p1))* iXXP_direction;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="keywordtype">double</span> alpha_ymin = (y_0 - 0.5 - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p1))* iYYP_direction;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <span class="keywordtype">double</span> alpha_ymax = (y_F + 0.5 - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p1))* iYYP_direction;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            <span class="keywordtype">double</span> alpha_zmin = (z_0 - 0.5 - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(p1))* iZZP_direction;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="keywordtype">double</span> alpha_zmax = (z_F + 0.5 - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(p1))* iZZP_direction;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <span class="keywordtype">double</span> auxMin;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <span class="keywordtype">double</span> auxMax;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="keywordflow">if</span> (alpha_xmin&lt;alpha_xmax)</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            {</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                auxMin=alpha_xmin;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                auxMax=alpha_xmax;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            }</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                auxMin=alpha_xmax;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                auxMax=alpha_xmin;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            }</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            <span class="keywordtype">double</span> alpha_min=auxMin;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keywordtype">double</span> alpha_max=auxMax;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="keywordflow">if</span> (alpha_ymin&lt;alpha_ymax)</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            {</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                auxMin=alpha_ymin;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                auxMax=alpha_ymax;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            {</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                auxMin=alpha_ymax;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                auxMax=alpha_ymin;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            }</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            alpha_min=<a class="code" href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a>(auxMin,alpha_min);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            alpha_max=fmin(auxMax,alpha_max);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            <span class="keywordflow">if</span> (alpha_zmin&lt;alpha_zmax)</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            {</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                auxMin=alpha_zmin;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                auxMax=alpha_zmax;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            }</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            {</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                auxMin=alpha_zmax;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                auxMax=alpha_zmin;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            }</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            alpha_min=<a class="code" href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a>(auxMin,alpha_min);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            alpha_max=fmin(auxMax,alpha_max);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <span class="keywordflow">if</span> (alpha_max - alpha_min &lt; <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>)</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Pixel:  &quot;</span> &lt;&lt; r_p.transpose() &lt;&lt; std::endl</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Univ:   &quot;</span> &lt;&lt; p1.transpose() &lt;&lt; std::endl</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Dir:    &quot;</span> &lt;&lt; P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>.<a class="code" href="classMatrix1D.html#a028505ebdeaf6f62d884c31dcd5127a8">transpose</a>() &lt;&lt; std::endl</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Alpha x:&quot;</span> &lt;&lt; alpha_xmin &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; alpha_xmax &lt;&lt; std::endl</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; (p1 + alpha_xmin*P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>).<a class="code" href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a>() &lt;&lt; std::endl</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; (p1 + alpha_xmax*P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>).<a class="code" href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a>() &lt;&lt; std::endl</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Alpha y:&quot;</span> &lt;&lt; alpha_ymin &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; alpha_ymax &lt;&lt; std::endl</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; (p1 + alpha_ymin*P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>).<a class="code" href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a>() &lt;&lt; std::endl</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; (p1 + alpha_ymax*P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>).<a class="code" href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a>() &lt;&lt; std::endl</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Alpha z:&quot;</span> &lt;&lt; alpha_zmin &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; alpha_zmax &lt;&lt; std::endl</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; (p1 + alpha_zmin*P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>).<a class="code" href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a>() &lt;&lt; std::endl</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; (p1 + alpha_zmax*P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>).<a class="code" href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a>() &lt;&lt; std::endl</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;alpha  :&quot;</span> &lt;&lt; alpha_min  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; alpha_max  &lt;&lt; std::endl</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            &lt;&lt; std::endl;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            <span class="comment">// Compute the first point in the volume intersecting the ray</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            <span class="keywordtype">double</span> zz_idxd;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            <span class="keywordtype">double</span> yy_idxd;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            <span class="keywordtype">double</span> xx_idxd;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            <span class="keywordtype">int</span>    zz_idx;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            <span class="keywordtype">int</span>    yy_idx;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            <span class="keywordtype">int</span>    xx_idx;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            <a class="code" href="group__Vectors.html#ga0c31197d639e9b7b7b8abe4eaebbaa5b">V3_BY_CT</a>(v, P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>, alpha_min);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            <a class="code" href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a>(v, p1, v);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <span class="comment">// Compute the index of the first voxel</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            xx_idx = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(v));</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            yy_idx = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(v));</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            zz_idx = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(v));</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            xx_idxd = xx_idx = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(xx_idx, x_0, x_F);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            yy_idxd = yy_idx = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(yy_idx, y_0, y_F);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            zz_idxd = zz_idx = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(zz_idx, z_0, z_F);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;First voxel: &quot;</span> &lt;&lt; v.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;   First index: &quot;</span> &lt;&lt; idx.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;   Alpha_min: &quot;</span> &lt;&lt; alpha_min &lt;&lt; std::endl;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            <span class="comment">// Follow the ray</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="structblobtype.html#ae713f8fc66da6e18d0bc2ff381bda22f">alpha</a> = alpha_min;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <span class="keywordflow">do</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            {</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot; \n\nCurrent Value: &quot;</span> &lt;&lt; V(zz_idx, yy_idx, xx_idx) &lt;&lt; std::endl;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                <span class="keywordtype">double</span> alpha_x = (xx_idxd - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p1_shifted))* iXXP_direction;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                <span class="keywordtype">double</span> alpha_y = (yy_idxd - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p1_shifted))* iYYP_direction;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                <span class="keywordtype">double</span> alpha_z = (zz_idxd - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(p1_shifted))* iZZP_direction;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                <span class="comment">// Which dimension will ray move next step into?, it isn&#39;t necessary to be only</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                <span class="comment">// one.</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                <span class="keywordtype">double</span> diffx = fabs(alpha-alpha_x);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                <span class="keywordtype">double</span> diffy = fabs(alpha-alpha_y);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                <span class="keywordtype">double</span> diffz = fabs(alpha-alpha_z);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                <span class="keywordtype">int</span> diff_source=0;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                <span class="keywordtype">double</span> diff_alpha=diffx;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                <span class="keywordflow">if</span> (diffy&lt;diff_alpha)</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                {</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                    diff_source=1;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                    diff_alpha=diffy;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                }</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                <span class="keywordflow">if</span> (diffz&lt;diff_alpha)</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                {</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                    diff_source=2;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                    diff_alpha=diffz;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                }</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                ray_sum += diff_alpha * <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(V, zz_idx, yy_idx, xx_idx);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                <span class="keywordflow">switch</span> (diff_source)</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                    alpha = alpha_x;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                    xx_idx += x_sign;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                    xx_idxd = xx_idx;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                    alpha = alpha_y;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                    yy_idx += y_sign;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                    yy_idxd = yy_idx;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                <span class="keywordflow">default</span>:</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                    alpha = alpha_z;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                    zz_idx += z_sign;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                    zz_idxd = zz_idx;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                }</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;Alpha x,y,z: &quot;</span> &lt;&lt; alpha_x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; alpha_y</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; alpha_z &lt;&lt; <span class="stringliteral">&quot; ---&gt; &quot;</span> &lt;&lt; alpha &lt;&lt; std::endl;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(v) += diff_alpha * <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(v) += diff_alpha * <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(v) += diff_alpha * <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;    Next entry point: &quot;</span> &lt;&lt; v.transpose() &lt;&lt; std::endl</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;    Index: &quot;</span> &lt;&lt; idx.transpose() &lt;&lt; std::endl</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;    diff_alpha: &quot;</span> &lt;&lt; diff_alpha &lt;&lt; std::endl</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;    ray_sum: &quot;</span> &lt;&lt; ray_sum &lt;&lt; std::endl</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;    Alfa tot: &quot;</span> &lt;&lt; alpha &lt;&lt; <span class="stringliteral">&quot;alpha_max: &quot;</span> &lt;&lt; alpha_max &lt;&lt;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                std::endl;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            }</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <span class="keywordflow">while</span> ((alpha_max - alpha) &gt; <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        } <span class="comment">// for</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(<a class="code" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(P), <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = ray_sum * 0.25;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Assigning P(&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt;&lt; <span class="stringliteral">&quot;)=&quot;</span> &lt;&lt; ray_sum &lt;&lt; std::endl;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    }</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;}</div><div class="ttc" id="group__FourierProjection_html_ga7c0ae2d78ba098df1b33115e94918f18"><div class="ttname"><a href="group__FourierProjection.html#ga7c0ae2d78ba098df1b33115e94918f18">Projection::eulert</a></div><div class="ttdeci">Matrix2D&lt; double &gt; eulert</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00079">fourier_projection.h:79</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00354">multidim_array_base.h:354</a></div></div>
<div class="ttc" id="structblobtype_html_ae713f8fc66da6e18d0bc2ff381bda22f"><div class="ttname"><a href="structblobtype.html#ae713f8fc66da6e18d0bc2ff381bda22f">blobtype::alpha</a></div><div class="ttdeci">double alpha</div><div class="ttdoc">Smoothness parameter. </div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00121">blobs.h:121</a></div></div>
<div class="ttc" id="group__FourierProjection_html_ga0996d67a36d07d6eb3373022c24c7952"><div class="ttname"><a href="group__FourierProjection.html#ga0996d67a36d07d6eb3373022c24c7952">Projection::reset</a></div><div class="ttdeci">void reset(int Ydim, int Xdim)</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8cpp_source.html#l00033">fourier_projection.cpp:33</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a706d2ce724d393d4d759a46225bbc6c1"><div class="ttname"><a href="multidim__array__base_8h.html#a706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a></div><div class="ttdeci">#define FINISHINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00071">multidim_array_base.h:71</a></div></div>
<div class="ttc" id="group__Images_html_ga6096c97ad2ba182701f4877c206acb94"><div class="ttname"><a href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a></div><div class="ttdeci">#define IMGMATRIX(I)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00180">xmipp_image_base.h:180</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="multidim__array__base_8h.html#a7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00390">multidim_array_base.h:390</a></div></div>
<div class="ttc" id="classMatrix1D_html_a028505ebdeaf6f62d884c31dcd5127a8"><div class="ttname"><a href="classMatrix1D.html#a028505ebdeaf6f62d884c31dcd5127a8">Matrix1D::transpose</a></div><div class="ttdeci">Matrix1D&lt; T &gt; transpose() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8cpp_source.html#l00631">matrix1d.cpp:631</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00059">multidim_array_base.h:59</a></div></div>
<div class="ttc" id="group__Macros_html_gad4d08cca0a39849cc247072eaebe7726"><div class="ttname"><a href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a></div><div class="ttdeci">#define CLIP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00260">xmipp_macros.h:260</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="group__Vectors_html_ga0c31197d639e9b7b7b8abe4eaebbaa5b"><div class="ttname"><a href="group__Vectors.html#ga0c31197d639e9b7b7b8abe4eaebbaa5b">V3_BY_CT</a></div><div class="ttdeci">#define V3_BY_CT(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00238">matrix1d.h:238</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00085">matrix1d.h:85</a></div></div>
<div class="ttc" id="primitive__FST_8cpp_html_af9ecdf0e10481a405f601d27aafd8599"><div class="ttname"><a href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a></div><div class="ttdeci">void transpose(double *array, int size)</div><div class="ttdef"><b>Definition:</b> <a href="primitive__FST_8cpp_source.html#l00121">primitive_FST.cpp:121</a></div></div>
<div class="ttc" id="group__Macros_html_gad584f97e936242b173add43261376ba5"><div class="ttname"><a href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a></div><div class="ttdeci">#define XMIPP_EQUAL_ACCURACY</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00119">xmipp_macros.h:119</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="group__FourierProjection_html_ga532f6713fbe228d3ee30f4d3a2766a20"><div class="ttname"><a href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">Projection::direction</a></div><div class="ttdeci">Matrix1D&lt; double &gt; direction</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00062">fourier_projection.h:62</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__Matrices_html_gad159332322d687de886a720422e4b757"><div class="ttname"><a href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a></div><div class="ttdeci">#define M3x3_BY_V3x1(a, M, b)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00170">matrix2d.h:170</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00093">matrix1d.h:93</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00063">multidim_array_base.h:63</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="group__Vectors_html_ga6c6b4d4f88daca5e1d8e171bec3b4af0"><div class="ttname"><a href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a></div><div class="ttdeci">#define VECTOR_R3(v, x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00124">matrix1d.h:124</a></div></div>
<div class="ttc" id="group__FourierProjection_html_ga38fc7e819f167ed62bf63c13e1058aab"><div class="ttname"><a href="group__FourierProjection.html#ga38fc7e819f167ed62bf63c13e1058aab">Projection::setAngles</a></div><div class="ttdeci">void setAngles(double _rot, double _tilt, double _psi)</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8cpp_source.html#l00040">fourier_projection.cpp:40</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a046e290d67d4e9e20547aae0fab90070"><div class="ttname"><a href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a></div><div class="ttdeci">double fmax</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05166">numerical_recipes.cpp:5166</a></div></div>
<div class="ttc" id="group__Macros_html_ga95ed41486ca0ed53262e4b8934d4afac"><div class="ttname"><a href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a></div><div class="ttdeci">#define SGN(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00155">xmipp_macros.h:155</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_aafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="multidim__array__base_8h.html#aafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00067">multidim_array_base.h:67</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00101">matrix1d.h:101</a></div></div>
<div class="ttc" id="group__Vectors_html_gafe748b92e8aeaa282eb7bafbd2baca37"><div class="ttname"><a href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a></div><div class="ttdeci">#define V3_PLUS_V3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00190">matrix1d.h:190</a></div></div>
<div class="ttc" id="group__Macros_html_ga20716e3da0ba25d3c4c9a2421573391f"><div class="ttname"><a href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a></div><div class="ttdeci">#define SPEED_UP_temps012</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00403">xmipp_macros.h:403</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga125751740b29feb4f536731abe705b6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga125751740b29feb4f536731abe705b6a">&#9670;&nbsp;</a></span>projectVolumeOffCentered()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void projectVolumeOffCentered </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>From voxel volumes, off-centered tilt axis. This routine projects a volume that is rotating (angle) degrees around the axis defined by the two angles (axisRot,axisTilt) and that passes through the point raxis. The projection can be further inplane rotated and shifted through the parameters (inplaneRot) and (rinplane).</p>
<p>All vectors involved must be 3D.</p>
<p>The projection model is rproj=H Rinplane Raxis r + Rinplane (I-Raxis) raxis + rinplane</p>
<p>Where Raxis is the 3D rotation matrix given by the axis and the angle. </p>

<p class="definition">Definition at line <a class="el" href="projection_8cpp_source.html#l00594">594</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;{</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> roffset(3);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    P.<a class="code" href="classImageBase.html#adf429b8f49939bd6e0869eccf1669639">getShifts</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(roffset), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(roffset), <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(roffset));</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <a class="code" href="group__ParametersProjectionTomography.html#gaa2a035335544acb914ec49b685e3cfcc">projectVolume</a>(V, P, Ydim, Xdim, P.<a class="code" href="classImageBase.html#ae93e05fe473a50784bdbf28dbcbad20a">rot</a>(), P.<a class="code" href="classImageBase.html#a14098c8a502f3b324ffccef3fcde0de9">tilt</a>(), P.<a class="code" href="classImageBase.html#a890fd19f4204e83abac6b73c3ca82a1f">psi</a>(), &amp;roffset);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;}</div><div class="ttc" id="classImageBase_html_a890fd19f4204e83abac6b73c3ca82a1f"><div class="ttname"><a href="classImageBase.html#a890fd19f4204e83abac6b73c3ca82a1f">ImageBase::psi</a></div><div class="ttdeci">double psi(const size_t n=0) const</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00391">xmipp_image_base.cpp:391</a></div></div>
<div class="ttc" id="classImageBase_html_ae93e05fe473a50784bdbf28dbcbad20a"><div class="ttname"><a href="classImageBase.html#ae93e05fe473a50784bdbf28dbcbad20a">ImageBase::rot</a></div><div class="ttdeci">double rot(const size_t n=0) const</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00365">xmipp_image_base.cpp:365</a></div></div>
<div class="ttc" id="classImageBase_html_a14098c8a502f3b324ffccef3fcde0de9"><div class="ttname"><a href="classImageBase.html#a14098c8a502f3b324ffccef3fcde0de9">ImageBase::tilt</a></div><div class="ttdeci">double tilt(const size_t n=0) const</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00378">xmipp_image_base.cpp:378</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00085">matrix1d.h:85</a></div></div>
<div class="ttc" id="group__ParametersProjectionTomography_html_gaa2a035335544acb914ec49b685e3cfcc"><div class="ttname"><a href="group__ParametersProjectionTomography.html#gaa2a035335544acb914ec49b685e3cfcc">projectVolume</a></div><div class="ttdeci">void projectVolume(MultidimArray&lt; double &gt; &amp;V, Projection &amp;P, int Ydim, int Xdim, double rot, double tilt, double psi, const Matrix1D&lt; double &gt; *roffset)</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l00337">projection.cpp:337</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00093">matrix1d.h:93</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00101">matrix1d.h:101</a></div></div>
<div class="ttc" id="classImageBase_html_adf429b8f49939bd6e0869eccf1669639"><div class="ttname"><a href="classImageBase.html#adf429b8f49939bd6e0869eccf1669639">ImageBase::getShifts</a></div><div class="ttdeci">void getShifts(double &amp;xoff, double &amp;yoff, double &amp;zoff, const size_t n=0) const</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00537">xmipp_image_base.cpp:537</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gafaefa09ed28fafff7cf217bfe29f1efe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafaefa09ed28fafff7cf217bfe29f1efe">&#9670;&nbsp;</a></span>singleWBP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void singleWBP </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>P</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Single Weighted Back <a class="el" href="classProjection.html">Projection</a>. Projects a single particle into a voxels volume by updating its components this way: Voxel(i,j,k) = Voxel(i,j,k) + Pixel( x,y) * Distance.</p>
<p>Where:</p>
<ul>
<li>Voxel(i,j,k) is the voxel the ray is crossing.</li>
<li>Pixel( y,z ) is the value of the pixel where the ray departs from.</li>
<li>Distance is the distance the ray goes through the Voxel. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="projection_8cpp_source.html#l00609">609</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;{</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <a class="code" href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a>;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="comment">// Compute the distance for this line crossing one voxel</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordtype">int</span> x_0 = <a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(V);</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordtype">int</span> x_F = <a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(V);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordtype">int</span> y_0 = <a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(V);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordtype">int</span> y_F = <a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(V);</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordtype">int</span> z_0 = <a class="code" href="multidim__array__base_8h.html#aafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(V);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="keywordtype">int</span> z_F = <a class="code" href="multidim__array__base_8h.html#a706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(V);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="comment">// Avoids divisions by zero and allows orthogonal rays computation</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) == 0)</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) = <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) == 0)</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) = <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) == 0)</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) = <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="comment">// Some precalculated variables</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordtype">int</span> x_sign = <a class="code" href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>));</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordtype">int</span> y_sign = <a class="code" href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>));</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordtype">int</span> z_sign = <a class="code" href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a>(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>));</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordtype">double</span> half_x_sign = 0.5 * x_sign;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordtype">double</span> half_y_sign = 0.5 * y_sign;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordtype">double</span> half_z_sign = 0.5 * z_sign;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;mP = P();</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> r_p(3); <span class="comment">// r_p are the coordinates of the</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="comment">// pixel being projected in the</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="comment">// coordinate system attached to the</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="comment">// projection</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> p1(3);  <span class="comment">// coordinates of the pixel in the</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a>  v(3);</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a>    idx(3);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(mP)</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    {</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <span class="comment">// Computes 4 different rays for each pixel.</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(r_p, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, 0);</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <span class="comment">// Express r_p in the universal coordinate system</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <a class="code" href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a>(p1, P.<a class="code" href="group__FourierProjection.html#ga7c0ae2d78ba098df1b33115e94918f18">eulert</a>, r_p);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <span class="comment">// Compute the minimum and maximum alpha for the ray</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="comment">// intersecting the given volume</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="keywordtype">double</span> alpha_xmin = (x_0 - 0.5 - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p1)) / <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="keywordtype">double</span> alpha_xmax = (x_F + 0.5 - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p1)) / <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="keywordtype">double</span> alpha_ymin = (y_0 - 0.5 - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p1)) / <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <span class="keywordtype">double</span> alpha_ymax = (y_F + 0.5 - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p1)) / <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="keywordtype">double</span> alpha_zmin = (z_0 - 0.5 - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(p1)) / <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="keywordtype">double</span> alpha_zmax = (z_F + 0.5 - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(p1)) / <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <span class="keywordtype">double</span> alpha_min = <a class="code" href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a>(fmin(alpha_xmin, alpha_xmax),</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                                fmin(alpha_ymin, alpha_ymax));</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        alpha_min = <a class="code" href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a>(alpha_min, fmin(alpha_zmin, alpha_zmax));</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="keywordtype">double</span> alpha_max = fmin(<a class="code" href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a>(alpha_xmin, alpha_xmax),</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                                <a class="code" href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a>(alpha_ymin, alpha_ymax));</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        alpha_max = fmin(alpha_max, <a class="code" href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a>(alpha_zmin, alpha_zmax));</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="keywordflow">if</span> (alpha_max - alpha_min &lt; <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>)</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="comment">// Compute the first point in the volume intersecting the ray</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <a class="code" href="group__Vectors.html#ga0c31197d639e9b7b7b8abe4eaebbaa5b">V3_BY_CT</a>(v, P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>, alpha_min);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <a class="code" href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a>(v, p1, v);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="comment">// Compute the index of the first voxel</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(idx) = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(v)), x_0, x_F);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(idx) = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(v)), y_0, y_F);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(idx) = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(v)), z_0, z_F);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;First voxel: &quot;</span> &lt;&lt; v.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;   First index: &quot;</span> &lt;&lt; idx.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;   Alpha_min: &quot;</span> &lt;&lt; alpha_min &lt;&lt; std::endl;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <span class="comment">// Follow the ray</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structblobtype.html#ae713f8fc66da6e18d0bc2ff381bda22f">alpha</a> = alpha_min;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <span class="keywordflow">do</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        {</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot; \n\nCurrent Value: &quot;</span> &lt;&lt; V(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(idx), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(idx), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(idx)) &lt;&lt; std::endl;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            <span class="keywordtype">double</span> alpha_x = (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(idx) + half_x_sign - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p1)) / <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <span class="keywordtype">double</span> alpha_y = (<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(idx) + half_y_sign - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p1)) / <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            <span class="keywordtype">double</span> alpha_z = (<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(idx) + half_z_sign - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(p1)) / <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            <span class="comment">// Which dimension will ray move next step into?, it isn&#39;t necessary to be only</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            <span class="comment">// one.</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            <span class="keywordtype">double</span> diffx = <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(alpha - alpha_x);</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            <span class="keywordtype">double</span> diffy = <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(alpha - alpha_y);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            <span class="keywordtype">double</span> diffz = <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(alpha - alpha_z);</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            <span class="keywordtype">double</span> diff_alpha = fmin(fmin(diffx, diffy), diffz);</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(V, <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(idx), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(idx), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(idx)) += diff_alpha * <a class="code" href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(P(), <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(diff_alpha - diffx) &lt;= <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>)</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            {</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                alpha = alpha_x;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(idx) += x_sign;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            }</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(diff_alpha - diffy) &lt;= <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>)</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            {</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                alpha = alpha_y;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(idx) += y_sign;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            }</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(diff_alpha - diffz) &lt;= <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>)</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            {</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                alpha = alpha_z;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(idx) += z_sign;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            }</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        }</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">while</span> ((alpha_max - alpha) &gt; <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Assigning P(&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt;&lt; <span class="stringliteral">&quot;)=&quot;</span> &lt;&lt; ray_sum &lt;&lt; std::endl;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    }</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;}</div><div class="ttc" id="group__FourierProjection_html_ga7c0ae2d78ba098df1b33115e94918f18"><div class="ttname"><a href="group__FourierProjection.html#ga7c0ae2d78ba098df1b33115e94918f18">Projection::eulert</a></div><div class="ttdeci">Matrix2D&lt; double &gt; eulert</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00079">fourier_projection.h:79</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00354">multidim_array_base.h:354</a></div></div>
<div class="ttc" id="structblobtype_html_ae713f8fc66da6e18d0bc2ff381bda22f"><div class="ttname"><a href="structblobtype.html#ae713f8fc66da6e18d0bc2ff381bda22f">blobtype::alpha</a></div><div class="ttdeci">double alpha</div><div class="ttdoc">Smoothness parameter. </div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00121">blobs.h:121</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a706d2ce724d393d4d759a46225bbc6c1"><div class="ttname"><a href="multidim__array__base_8h.html#a706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a></div><div class="ttdeci">#define FINISHINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00071">multidim_array_base.h:71</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="multidim__array__base_8h.html#a7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00390">multidim_array_base.h:390</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00059">multidim_array_base.h:59</a></div></div>
<div class="ttc" id="group__Macros_html_gad4d08cca0a39849cc247072eaebe7726"><div class="ttname"><a href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a></div><div class="ttdeci">#define CLIP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00260">xmipp_macros.h:260</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="multidim__array__base_8h.html#a89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00253">multidim_array_base.h:253</a></div></div>
<div class="ttc" id="group__Vectors_html_ga0c31197d639e9b7b7b8abe4eaebbaa5b"><div class="ttname"><a href="group__Vectors.html#ga0c31197d639e9b7b7b8abe4eaebbaa5b">V3_BY_CT</a></div><div class="ttdeci">#define V3_BY_CT(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00238">matrix1d.h:238</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00085">matrix1d.h:85</a></div></div>
<div class="ttc" id="group__Macros_html_gad584f97e936242b173add43261376ba5"><div class="ttname"><a href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a></div><div class="ttdeci">#define XMIPP_EQUAL_ACCURACY</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00119">xmipp_macros.h:119</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="group__FourierProjection_html_ga532f6713fbe228d3ee30f4d3a2766a20"><div class="ttname"><a href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">Projection::direction</a></div><div class="ttdeci">Matrix1D&lt; double &gt; direction</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00062">fourier_projection.h:62</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__Matrices_html_gad159332322d687de886a720422e4b757"><div class="ttname"><a href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a></div><div class="ttdeci">#define M3x3_BY_V3x1(a, M, b)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00170">matrix2d.h:170</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00093">matrix1d.h:93</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00063">multidim_array_base.h:63</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_ga6c6b4d4f88daca5e1d8e171bec3b4af0"><div class="ttname"><a href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a></div><div class="ttdeci">#define VECTOR_R3(v, x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00124">matrix1d.h:124</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a046e290d67d4e9e20547aae0fab90070"><div class="ttname"><a href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a></div><div class="ttdeci">double fmax</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05166">numerical_recipes.cpp:5166</a></div></div>
<div class="ttc" id="group__Macros_html_ga95ed41486ca0ed53262e4b8934d4afac"><div class="ttname"><a href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a></div><div class="ttdeci">#define SGN(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00155">xmipp_macros.h:155</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_aafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="multidim__array__base_8h.html#aafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00067">multidim_array_base.h:67</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00101">matrix1d.h:101</a></div></div>
<div class="ttc" id="group__Vectors_html_gafe748b92e8aeaa282eb7bafbd2baca37"><div class="ttname"><a href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a></div><div class="ttdeci">#define V3_PLUS_V3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00190">matrix1d.h:190</a></div></div>
<div class="ttc" id="group__Macros_html_ga20716e3da0ba25d3c4c9a2421573391f"><div class="ttname"><a href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a></div><div class="ttdeci">#define SPEED_UP_temps012</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00403">xmipp_macros.h:403</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ga9d1421cb7105f364df31c920daee64cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9d1421cb7105f364df31c920daee64cd">&#9670;&nbsp;</a></span>ART_PIXEL_SUBSAMPLING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int ART_PIXEL_SUBSAMPLING = 2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="projection_8h_source.html#l00296">296</a> of file <a class="el" href="projection_8h_source.html">projection.h</a>.</p>

</div>
</div>
<a id="ga64d6cb0b0a0141854ec21615c4a39d6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga64d6cb0b0a0141854ec21615c4a39d6a">&#9670;&nbsp;</a></span>ARTK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int ARTK = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="projection_8h_source.html#l00177">177</a> of file <a class="el" href="projection_8h_source.html">projection.h</a>.</p>

</div>
</div>
<a id="gaa7dca3eaddb40b1a3802354354766e47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa7dca3eaddb40b1a3802354354766e47">&#9670;&nbsp;</a></span>BACKWARD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int BACKWARD = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="projection_8h_source.html#l00175">175</a> of file <a class="el" href="projection_8h_source.html">projection.h</a>.</p>

</div>
</div>
<a id="ga56d592540304881fd5411961458e4118"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga56d592540304881fd5411961458e4118">&#9670;&nbsp;</a></span>CAV</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int CAV = 4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="projection_8h_source.html#l00180">180</a> of file <a class="el" href="projection_8h_source.html">projection.h</a>.</p>

</div>
</div>
<a id="ga66def0fa268ae303861b249fa125deb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga66def0fa268ae303861b249fa125deb8">&#9670;&nbsp;</a></span>CAVARTK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int CAVARTK = 5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="projection_8h_source.html#l00181">181</a> of file <a class="el" href="projection_8h_source.html">projection.h</a>.</p>

</div>
</div>
<a id="ga1d8d965aac23a7a7e10e4fe50ae70f41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1d8d965aac23a7a7e10e4fe50ae70f41">&#9670;&nbsp;</a></span>CAVK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int CAVK = 2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="projection_8h_source.html#l00178">178</a> of file <a class="el" href="projection_8h_source.html">projection.h</a>.</p>

</div>
</div>
<a id="ga3c6a0d295bfc7f31b0c926d9a25527e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3c6a0d295bfc7f31b0c926d9a25527e8">&#9670;&nbsp;</a></span>COUNT_EQ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int COUNT_EQ = 3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="projection_8h_source.html#l00179">179</a> of file <a class="el" href="projection_8h_source.html">projection.h</a>.</p>

</div>
</div>
<a id="ga2dd06786fc540036602745df1373a2b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2dd06786fc540036602745df1373a2b0">&#9670;&nbsp;</a></span>FORWARD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int FORWARD = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="projection_8h_source.html#l00174">174</a> of file <a class="el" href="projection_8h_source.html">projection.h</a>.</p>

</div>
</div>
<a id="ga3e46756d453b695deb8da52e590ef0b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3e46756d453b695deb8da52e590ef0b1">&#9670;&nbsp;</a></span>project_barrier</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__Threads.html#ga0b86c483ccff385c24a8a278870af9f7">barrier_t</a> project_barrier</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="projection_8cpp_source.html#l00046">46</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>

</div>
</div>
<a id="ga6b8971032d8e98145e6691683950fe8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6b8971032d8e98145e6691683950fe8c">&#9670;&nbsp;</a></span>project_mutex</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pthread_mutex_t project_mutex</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="projection_8cpp_source.html#l00047">47</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>

</div>
</div>
<a id="gaef66df64a8ff60fcb4b1aed8341af3b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaef66df64a8ff60fcb4b1aed8341af3b1">&#9670;&nbsp;</a></span>project_threads</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structproject__thread__params.html">project_thread_params</a>* project_threads</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="projection_8cpp_source.html#l00048">48</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
