<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Xmipp: xmipp/libraries/data/pdb.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5bce755d3f27cf36e7d1a940cfd4182d.html">xmipp</a></li><li class="navelem"><a class="el" href="dir_29dba3f3840f20df3b04d1972e99046b.html">libraries</a></li><li class="navelem"><a class="el" href="dir_02b15c2011e26cf58f557fc966b9a0d4.html">data</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">pdb.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;fstream&gt;</code><br />
<code>#include &lt;string&gt;</code><br />
<code>#include &quot;<a class="el" href="pdb_8h_source.html">pdb.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="matrix2d_8h_source.html">core/matrix2d.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="multidim__array_8h_source.html">core/multidim_array.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="transformations_8h_source.html">core/transformations.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="xmipp__fftw_8h_source.html">core/xmipp_fftw.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fourier__projection_8h_source.html">data/fourier_projection.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="libraries_2data_2integration_8h_source.html">data/integration.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mask_8h_source.html">data/mask.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="numerical__tools_8h_source.html">data/numerical_tools.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for pdb.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="pdb_8cpp__incl.png" border="0" usemap="#xmipp_2libraries_2data_2pdb_8cpp" alt=""/></div>
<map name="xmipp_2libraries_2data_2pdb_8cpp" id="xmipp_2libraries_2data_2pdb_8cpp">
</map>
</div>
</div>
<p><a href="pdb_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAtomValueFunc.html">AtomValueFunc</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a693107837cafaa73db3f5ab5c7895c25"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a693107837cafaa73db3f5ab5c7895c25">INTEGRATION</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a693107837cafaa73db3f5ab5c7895c25"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga1d78a55abdbc481c2bf89f16ce38a955"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#ga1d78a55abdbc481c2bf89f16ce38a955">analyzePDBAtoms</a> (const <a class="el" href="classFileName.html">FileName</a> &amp;fn_pdb, const std::string &amp;typeOfAtom, int &amp;numberOfAtoms, <a class="el" href="structpdbInfo.html">pdbInfo</a> &amp;at_pos)</td></tr>
<tr class="separator:ga1d78a55abdbc481c2bf89f16ce38a955"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0d3e71a203505e6efe26e496d7749841"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#ga0d3e71a203505e6efe26e496d7749841">atomCharge</a> (const std::string &amp;atom)</td></tr>
<tr class="separator:ga0d3e71a203505e6efe26e496d7749841"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4e05007583cdf873be6147d695021c9d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#ga4e05007583cdf873be6147d695021c9d">atomRadius</a> (const std::string &amp;atom)</td></tr>
<tr class="separator:ga4e05007583cdf873be6147d695021c9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7511afdf175c757f48708ff53ddcde73"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#ga7511afdf175c757f48708ff53ddcde73">atomCovalentRadius</a> (const std::string &amp;atom)</td></tr>
<tr class="separator:ga7511afdf175c757f48708ff53ddcde73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8145e748890bee54f3acc43e5b03d1e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#ga8145e748890bee54f3acc43e5b03d1e5">computePDBgeometry</a> (const std::string &amp;fnPDB, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;centerOfMass, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;limit0, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;limitF, const std::string &amp;intensityColumn)</td></tr>
<tr class="separator:ga8145e748890bee54f3acc43e5b03d1e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga85155671d61759cdd1dc09421b201340"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#ga85155671d61759cdd1dc09421b201340">applyGeometryToPDBFile</a> (const std::string &amp;fn_in, const std::string &amp;fn_out, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A, bool centerPDB, const std::string &amp;intensityColumn)</td></tr>
<tr class="separator:ga85155671d61759cdd1dc09421b201340"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabf9520a0d03a1eda59392aa37d7fc56d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#gabf9520a0d03a1eda59392aa37d7fc56d">atomDescriptors</a> (const std::string &amp;atom, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;descriptors)</td></tr>
<tr class="separator:gabf9520a0d03a1eda59392aa37d7fc56d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9fffa8bfe3a2f60ab76ae5375321e33d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#ga9fffa8bfe3a2f60ab76ae5375321e33d">electronFormFactorFourier</a> (double <a class="el" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;descriptors)</td></tr>
<tr class="separator:ga9fffa8bfe3a2f60ab76ae5375321e33d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac889ae4327c233fb8f01241f692c7d6f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#gac889ae4327c233fb8f01241f692c7d6f">electronFormFactorRealSpace</a> (double r, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;descriptors)</td></tr>
<tr class="separator:gac889ae4327c233fb8f01241f692c7d6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51457d7aed50e11bffd23e2504696f45"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a51457d7aed50e11bffd23e2504696f45">hlpf</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>, int M, const std::string &amp;filterType, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;filter, double reductionFactor=0.8, double ripple=0.01, double deltaw=1.0/8.0)</td></tr>
<tr class="separator:a51457d7aed50e11bffd23e2504696f45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6404f5d19d22bd1f41927de5cafa6ca5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a6404f5d19d22bd1f41927de5cafa6ca5">fhlpf</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;filter, int M, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;convolution)</td></tr>
<tr class="separator:a6404f5d19d22bd1f41927de5cafa6ca5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53200812640bf6ecfcf3dd8e87fd8725"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a53200812640bf6ecfcf3dd8e87fd8725">Hlpf_fitness</a> (double *p, void *<a class="el" href="mpi__classify__CL2D_8cpp.html#a831c08adbb8230fd6a60f4a130923a19">prm</a>)</td></tr>
<tr class="separator:a53200812640bf6ecfcf3dd8e87fd8725"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d41c7d0e542972c688ed6237a509644"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a2d41c7d0e542972c688ed6237a509644">optimizeHlpf</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>, int M, double T, const std::string &amp;atom, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;filter, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;bestPrm)</td></tr>
<tr class="separator:a2d41c7d0e542972c688ed6237a509644"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a048558a4305419364ccfc1b510df4f8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a048558a4305419364ccfc1b510df4f8e">atomRadialProfile</a> (int M, double T, const std::string &amp;atom, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;profile)</td></tr>
<tr class="separator:a048558a4305419364ccfc1b510df4f8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f15a7e8fb17586cc6403532ff2bd9bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a1f15a7e8fb17586cc6403532ff2bd9bd">atomProjectionRadialProfile</a> (int M, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;profileCoefficients, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;projectionProfile)</td></tr>
<tr class="separator:a1f15a7e8fb17586cc6403532ff2bd9bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a276bb08cb169758db38719569831c899"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a276bb08cb169758db38719569831c899">projectAtom</a> (const <a class="el" href="classAtom.html">Atom</a> &amp;atom, <a class="el" href="classProjection.html">Projection</a> &amp;P, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;VP, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;PV, const <a class="el" href="classAtomInterpolator.html">AtomInterpolator</a> &amp;interpolator)</td></tr>
<tr class="separator:a276bb08cb169758db38719569831c899"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7411b6214afc11f4a5a43d0fa28f9004"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#ga7411b6214afc11f4a5a43d0fa28f9004">projectPDB</a> (const <a class="el" href="classPDBPhantom.html">PDBPhantom</a> &amp;phantomPDB, const <a class="el" href="classAtomInterpolator.html">AtomInterpolator</a> &amp;interpolator, <a class="el" href="classProjection.html">Projection</a> &amp;proj, int Ydim, int Xdim, double rot, double tilt, double psi)</td></tr>
<tr class="separator:ga7411b6214afc11f4a5a43d0fa28f9004"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1ae71a9378a4ca0ef298ec1a3786612e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#ga1ae71a9378a4ca0ef298ec1a3786612e">distanceHistogramPDB</a> (const <a class="el" href="classPDBPhantom.html">PDBPhantom</a> &amp;phantomPDB, size_t Nnearest, double maxDistance, int Nbins, <a class="el" href="classHistogram1D.html">Histogram1D</a> &amp;hist)</td></tr>
<tr class="separator:ga1ae71a9378a4ca0ef298ec1a3786612e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aab664bf51f4d185f6d849d750ac86fee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#aab664bf51f4d185f6d849d750ac86fee">globalHlpfPrm</a> (3)</td></tr>
<tr class="separator:aab664bf51f4d185f6d849d750ac86fee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03670ad2c03f04f1be8646970b6dc8dd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a03670ad2c03f04f1be8646970b6dc8dd">globalf</a></td></tr>
<tr class="separator:a03670ad2c03f04f1be8646970b6dc8dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1fe23303abe1c0c359bc1bfc59a5774"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#ac1fe23303abe1c0c359bc1bfc59a5774">globalM</a></td></tr>
<tr class="separator:ac1fe23303abe1c0c359bc1bfc59a5774"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70cffbaf2c91fc9c77305106b3b88d62"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a70cffbaf2c91fc9c77305106b3b88d62">globalT</a></td></tr>
<tr class="separator:a70cffbaf2c91fc9c77305106b3b88d62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d5905ca42e031c3d91374c6eee83486"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a2d5905ca42e031c3d91374c6eee83486">globalAtom</a></td></tr>
<tr class="separator:a2d5905ca42e031c3d91374c6eee83486"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a693107837cafaa73db3f5ab5c7895c25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a693107837cafaa73db3f5ab5c7895c25">&#9670;&nbsp;</a></span>INTEGRATION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INTEGRATION&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l01005">1005</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a1f15a7e8fb17586cc6403532ff2bd9bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f15a7e8fb17586cc6403532ff2bd9bd">&#9670;&nbsp;</a></span>atomProjectionRadialProfile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void atomProjectionRadialProfile </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>profileCoefficients</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>projectionProfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l01006">1006</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;{</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <a class="code" href="classAtomValueFunc.html">AtomValueFunc</a> atomValue;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    atomValue.<a class="code" href="classAtomValueFunc.html#ae910deea911de10b749aa2cfc63ba515">profileCoefficients</a>=&amp;profileCoefficients;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    atomValue.<a class="code" href="classAtomValueFunc.html#a42b6b56497f6fe09064d15a289782202">M</a>=M;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">radius</a>=(double)<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(profileCoefficients)/M;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a>=radius*<a class="code" href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">radius</a>;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    projectionProfile.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(profileCoefficients);</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <a class="code" href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(projectionProfile)</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    {</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        <span class="keywordtype">double</span> r0=(double)<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>/M;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        atomValue.<a class="code" href="classAtomValueFunc.html#a02f10206324ad21105d410c8e25c00a2">r0_2</a>=r0*r0;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        <span class="keywordflow">if</span> (atomValue.<a class="code" href="classAtomValueFunc.html#a02f10206324ad21105d410c8e25c00a2">r0_2</a>&gt;r2)</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            <span class="keywordflow">continue</span>; <span class="comment">// Because of numerical instabilities</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        <span class="keywordtype">double</span> maxZ=<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(r2-atomValue.<a class="code" href="classAtomValueFunc.html#a02f10206324ad21105d410c8e25c00a2">r0_2</a>);</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="preprocessor">#if INTEGRATION==1</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        <span class="keywordtype">double</span> dz=1/24.0;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        <span class="keywordtype">double</span> integral=0;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <span class="keywordflow">for</span> (atomValue.<a class="code" href="classAtomValueFunc.html#aa27aa05d374b83212bc080e04f9b114b">z</a>=-maxZ; atomValue.<a class="code" href="classAtomValueFunc.html#aa27aa05d374b83212bc080e04f9b114b">z</a>&lt;=maxZ; atomValue.<a class="code" href="classAtomValueFunc.html#aa27aa05d374b83212bc080e04f9b114b">z</a>+=dz)</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        {</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            projectionProfile(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)+=atomValue();</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        }</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        projectionProfile(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)*=dz;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        <a class="code" href="classRomberg.html">Romberg</a> Rom(atomValue, atomValue.<a class="code" href="classAtomValueFunc.html#aa27aa05d374b83212bc080e04f9b114b">z</a>,-maxZ,maxZ);</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        projectionProfile(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = Rom();</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    }</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;}</div><div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="classAtomValueFunc_html_aa27aa05d374b83212bc080e04f9b114b"><div class="ttname"><a href="classAtomValueFunc.html#aa27aa05d374b83212bc080e04f9b114b">AtomValueFunc::z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00994">pdb.cpp:994</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00210">image_operate.cpp:210</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classAtomValueFunc_html_a02f10206324ad21105d410c8e25c00a2"><div class="ttname"><a href="classAtomValueFunc.html#a02f10206324ad21105d410c8e25c00a2">AtomValueFunc::r0_2</a></div><div class="ttdeci">double r0_2</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00993">pdb.cpp:993</a></div></div>
<div class="ttc" id="classRomberg_html"><div class="ttname"><a href="classRomberg.html">Romberg</a></div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2integration_8h_source.html#l00189">integration.h:189</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_aa924a84ae5fbf0ba6b4052eb9d92ef60"><div class="ttname"><a href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00554">multidim_array_base.h:554</a></div></div>
<div class="ttc" id="classAtomValueFunc_html"><div class="ttname"><a href="classAtomValueFunc.html">AtomValueFunc</a></div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00989">pdb.cpp:989</a></div></div>
<div class="ttc" id="classAtomValueFunc_html_ae910deea911de10b749aa2cfc63ba515"><div class="ttname"><a href="classAtomValueFunc.html#ae910deea911de10b749aa2cfc63ba515">AtomValueFunc::profileCoefficients</a></div><div class="ttdeci">const MultidimArray&lt; double &gt; * profileCoefficients</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00995">pdb.cpp:995</a></div></div>
<div class="ttc" id="classAtomValueFunc_html_a42b6b56497f6fe09064d15a289782202"><div class="ttname"><a href="classAtomValueFunc.html#a42b6b56497f6fe09064d15a289782202">AtomValueFunc::M</a></div><div class="ttdeci">int M</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00992">pdb.cpp:992</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_ab7a69dabaa7151dae4d7a3998167e2f3"><div class="ttname"><a href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a></div><div class="ttdeci">float r2</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00053">image_find_center.cpp:53</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02689">multidim_array.h:2689</a></div></div>
<div class="ttc" id="structblobtype_html_a292968bd7221739a3a58231353f0d0ec"><div class="ttname"><a href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">blobtype::radius</a></div><div class="ttdeci">double radius</div><div class="ttdoc">Spatial radius in Universal System units. </div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00115">blobs.h:115</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a048558a4305419364ccfc1b510df4f8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a048558a4305419364ccfc1b510df4f8e">&#9670;&nbsp;</a></span>atomRadialProfile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void atomRadialProfile </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>atom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>profile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l00949">949</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;{</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="comment">// Compute the electron form factor in real space</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="keywordtype">double</span> largestb1=76.7309/(4*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>);</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keywordtype">double</span> Rmax=4*<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(2*largestb1);</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keyword">auto</span> imax=(int)<a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(Rmax/T);</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> descriptors;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <a class="code" href="group__PDBinterface.html#gabf9520a0d03a1eda59392aa37d7fc56d">atomDescriptors</a>(atom, descriptors);</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>(2*imax+1);</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>.setXmippOrigin();</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=-imax; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;=imax; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    {</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <span class="keywordtype">double</span> r=<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>*T;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)=<a class="code" href="group__PDBinterface.html#gac889ae4327c233fb8f01241f692c7d6f">electronFormFactorRealSpace</a>(r,descriptors);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    }</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="comment">// Compute the optimal filter</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> filter;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> bestPrm;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <a class="code" href="pdb_8cpp.html#a2d41c7d0e542972c688ed6237a509644">optimizeHlpf</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>, M, T, atom, filter, bestPrm);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="comment">// Perform the convolution</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <a class="code" href="pdb_8cpp.html#a6404f5d19d22bd1f41927de5cafa6ca5">fhlpf</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>, filter, M, profile);</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="comment">// Remove zero values</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordtype">int</span> ileft=<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(profile);</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="keywordflow">if</span> (fabs(profile(ileft))&lt;1e-3)</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <span class="keywordflow">for</span> (ileft=<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(profile)+1; ileft&lt;=0; ileft++)</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            <span class="keywordflow">if</span> (fabs(profile(ileft))&gt;1e-3)</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keywordtype">int</span> iright=<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(profile);</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keywordflow">if</span> (fabs(profile(iright))&lt;1e-3)</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <span class="keywordflow">for</span> (iright=<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(profile)-1; iright&gt;=0; iright--)</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            <span class="keywordflow">if</span> (fabs(profile(iright))&gt;1e-3)</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    profile.<a class="code" href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">selfWindow</a>(ileft,iright);</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_ac78e0480644752604f2cd3089aeac804"><div class="ttname"><a href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">MultidimArray::selfWindow</a></div><div class="ttdeci">void selfWindow(int n0, int z0, int y0, int x0, int nF, int zF, int yF, int xF, T init_value=0)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00504">multidim_array.h:504</a></div></div>
<div class="ttc" id="group__PDBinterface_html_gac889ae4327c233fb8f01241f692c7d6f"><div class="ttname"><a href="group__PDBinterface.html#gac889ae4327c233fb8f01241f692c7d6f">electronFormFactorRealSpace</a></div><div class="ttdeci">double electronFormFactorRealSpace(double r, const Matrix1D&lt; double &gt; &amp;descriptors)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00730">pdb.cpp:730</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00210">image_operate.cpp:210</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a633de4b0c14ca52ea2432a3c8a5c4c31"><div class="ttname"><a href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a></div><div class="ttdeci">double * f</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04431">numerical_recipes.cpp:4431</a></div></div>
<div class="ttc" id="group__PDBinterface_html_gabf9520a0d03a1eda59392aa37d7fc56d"><div class="ttname"><a href="group__PDBinterface.html#gabf9520a0d03a1eda59392aa37d7fc56d">atomDescriptors</a></div><div class="ttdeci">void atomDescriptors(const std::string &amp;atom, Matrix1D&lt; double &gt; &amp;descriptors)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00526">pdb.cpp:526</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a2d41c7d0e542972c688ed6237a509644"><div class="ttname"><a href="pdb_8cpp.html#a2d41c7d0e542972c688ed6237a509644">optimizeHlpf</a></div><div class="ttdeci">void optimizeHlpf(MultidimArray&lt; double &gt; &amp;f, int M, double T, const std::string &amp;atom, MultidimArray&lt; double &gt; &amp;filter, Matrix1D&lt; double &gt; &amp;bestPrm)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00928">pdb.cpp:928</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a6404f5d19d22bd1f41927de5cafa6ca5"><div class="ttname"><a href="pdb_8cpp.html#a6404f5d19d22bd1f41927de5cafa6ca5">fhlpf</a></div><div class="ttdeci">void fhlpf(const MultidimArray&lt; double &gt; &amp;f, const MultidimArray&lt; double &gt; &amp;filter, int M, MultidimArray&lt; double &gt; &amp;convolution)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00777">pdb.cpp:777</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6404f5d19d22bd1f41927de5cafa6ca5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6404f5d19d22bd1f41927de5cafa6ca5">&#9670;&nbsp;</a></span>fhlpf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fhlpf </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>filter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>convolution</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l00777">777</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;{</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="comment">// Expand the two input signals</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordtype">int</span> Nmax=<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(filter);</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> auxF;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> auxFilter;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    auxF=<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    auxFilter=filter;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    auxF.<a class="code" href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">selfWindow</a>(<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(f)-Nmax,<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(f)+Nmax);</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    auxFilter.<a class="code" href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">selfWindow</a>(<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(filter)-Nmax,<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(filter)+Nmax);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="comment">// Convolve in Fourier</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; std::complex&lt;double&gt;</a> &gt; F;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; std::complex&lt;double&gt;</a> &gt; Filter;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <a class="code" href="group__Fourier.html#ga5fddf4cf6da360abdc8fd7d2f21fcbb9">FourierTransform</a>(auxF,F);</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <a class="code" href="group__Fourier.html#ga5fddf4cf6da360abdc8fd7d2f21fcbb9">FourierTransform</a>(auxFilter,Filter);</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    F*=Filter;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="comment">// Correction for the double phase factor and the double</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="comment">// amplitude factor</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> K1=2*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>*(<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(auxFilter)-1);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> K2=<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(auxFilter);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    std::complex&lt;double&gt; aux;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keyword">auto</span> * ptrAux=(<span class="keywordtype">double</span>*)&amp;aux;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <a class="code" href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(F)</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    {</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(F),w);</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <span class="keywordtype">double</span> arg=w*K1;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga343bb99185c21cb45ddf83ffa06f9198">sincos</a>(arg,ptrAux+1,ptrAux);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        *ptrAux*=K2;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        *(ptrAux+1)*=K2;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(F,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)*=aux;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    }</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <a class="code" href="group__Fourier.html#gae4499c45aa160e02ddbba4aaae14dece">InverseFourierTransform</a>(F,convolution);</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    convolution.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_ac78e0480644752604f2cd3089aeac804"><div class="ttname"><a href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">MultidimArray::selfWindow</a></div><div class="ttdeci">void selfWindow(int n0, int z0, int y0, int x0, int nF, int zF, int yF, int xF, T init_value=0)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00504">multidim_array.h:504</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a97809f7244a28aaa1c26e29e6e3204ef"><div class="ttname"><a href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a></div><div class="ttdeci">#define A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00539">multidim_array_base.h:539</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a2b83edee7677c7a2b0a4e5ac99baa586"><div class="ttname"><a href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a></div><div class="ttdeci">doublereal * w</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02494">numerical_recipes.cpp:2494</a></div></div>
<div class="ttc" id="group__Fourier_html_gae4499c45aa160e02ddbba4aaae14dece"><div class="ttname"><a href="group__Fourier.html#gae4499c45aa160e02ddbba4aaae14dece">InverseFourierTransform</a></div><div class="ttdeci">void InverseFourierTransform(const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;in, MultidimArray&lt; double &gt; &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8cpp_source.html#l00155">xmipp_fft.cpp:155</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8cpp_source.html#l00200">multidim_array_base.cpp:200</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a633de4b0c14ca52ea2432a3c8a5c4c31"><div class="ttname"><a href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a></div><div class="ttdeci">double * f</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04431">numerical_recipes.cpp:4431</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00091">multidim_array_base.h:91</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga343bb99185c21cb45ddf83ffa06f9198"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga343bb99185c21cb45ddf83ffa06f9198">sincos</a></div><div class="ttdeci">void sincos(const MultidimArray&lt; double &gt; &amp;x, MultidimArray&lt; double &gt; &amp;s, MultidimArray&lt; double &gt; &amp;c)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00353">multidim_array.cpp:353</a></div></div>
<div class="ttc" id="group__Fourier_html_ga5fddf4cf6da360abdc8fd7d2f21fcbb9"><div class="ttname"><a href="group__Fourier.html#ga5fddf4cf6da360abdc8fd7d2f21fcbb9">FourierTransform</a></div><div class="ttdeci">void FourierTransform(const MultidimArray&lt; double &gt; &amp;in, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8cpp_source.html#l00124">xmipp_fft.cpp:124</a></div></div>
<div class="ttc" id="cuda__gpu__reconstruct__fourier_8cpp_html_ac914a5e7c4e25d78f31f6ec3b1a93c5c"><div class="ttname"><a href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a></div><div class="ttdeci">__device__ float FFT_IDX2DIGFREQ(int idx, int size)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gpu__reconstruct__fourier_8cpp_source.html#l00382">cuda_gpu_reconstruct_fourier.cpp:382</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_aa924a84ae5fbf0ba6b4052eb9d92ef60"><div class="ttname"><a href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00554">multidim_array_base.h:554</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a51457d7aed50e11bffd23e2504696f45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51457d7aed50e11bffd23e2504696f45">&#9670;&nbsp;</a></span>hlpf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hlpf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filterType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>filter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>reductionFactor</em> = <code>0.8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ripple</em> = <code>0.01</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltaw</em> = <code>1.0/8.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l00747">747</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;{</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    filter.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(f));</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    filter.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keyword">auto</span> Nmax=(int)<a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(M/2.0);</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="keywordflow">if</span> (filterType==<span class="stringliteral">&quot;SimpleAveraging&quot;</span>)</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    {</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <a class="code" href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(filter)</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)&lt;=Nmax)</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            filter(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)=1.0/(2*Nmax+1);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    }</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (filterType==<span class="stringliteral">&quot;SincKaiser&quot;</span>)</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    {</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="keywordtype">int</span> lastIdx=<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(filter);</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <a class="code" href="group__Masks.html#ga7289b52c50e1b5e8a8d500fe5e3d2ef0">SincKaiserMask</a>(filter,reductionFactor*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>/M,ripple,deltaw);</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="keywordtype">int</span> newLastIdx=<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(filter);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="keywordflow">if</span> (newLastIdx&gt;3*lastIdx)</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            filter.<a class="code" href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">selfWindow</a>(-lastIdx,lastIdx);</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        filter/=filter.<a class="code" href="classMultidimArray.html#aee20bc83b6b9c873a34a703a077fbfb9">sum</a>();</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(f)&gt;<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(filter))</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            filter.<a class="code" href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">selfWindow</a>(<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(f),<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(f));</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            f.<a class="code" href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">selfWindow</a>(<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(filter),<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(filter));</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    }</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_ac78e0480644752604f2cd3089aeac804"><div class="ttname"><a href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">MultidimArray::selfWindow</a></div><div class="ttdeci">void selfWindow(int n0, int z0, int y0, int x0, int nF, int zF, int yF, int xF, T init_value=0)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00504">multidim_array.h:504</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8cpp_source.html#l00200">multidim_array_base.cpp:200</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00091">multidim_array_base.h:91</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_aa924a84ae5fbf0ba6b4052eb9d92ef60"><div class="ttname"><a href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00554">multidim_array_base.h:554</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02689">multidim_array.h:2689</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="classMultidimArray_html_aee20bc83b6b9c873a34a703a077fbfb9"><div class="ttname"><a href="classMultidimArray.html#aee20bc83b6b9c873a34a703a077fbfb9">MultidimArray::sum</a></div><div class="ttdeci">double sum() const</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03371">multidim_array.h:3371</a></div></div>
<div class="ttc" id="group__Masks_html_ga7289b52c50e1b5e8a8d500fe5e3d2ef0"><div class="ttname"><a href="group__Masks.html#ga7289b52c50e1b5e8a8d500fe5e3d2ef0">SincKaiserMask</a></div><div class="ttdeci">void SincKaiserMask(MultidimArray&lt; double &gt; &amp;mask, double omega, double delta, double Deltaw)</div><div class="ttdef"><b>Definition:</b> <a href="mask_8cpp_source.html#l00138">mask.cpp:138</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a53200812640bf6ecfcf3dd8e87fd8725"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53200812640bf6ecfcf3dd8e87fd8725">&#9670;&nbsp;</a></span>Hlpf_fitness()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Hlpf_fitness </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>prm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l00824">824</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;{</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="keywordtype">double</span> reductionFactor=p[1];</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordtype">double</span> ripple=p[2];</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="keywordtype">double</span> deltaw=p[3];</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keywordflow">if</span> (reductionFactor&lt;0.7 || reductionFactor&gt;1.3)</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <span class="keywordflow">return</span> 1e38;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordflow">if</span> (ripple&lt;0 || ripple&gt;0.2)</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        <span class="keywordflow">return</span> 1e38;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordflow">if</span> (deltaw&lt;1e-3 || deltaw&gt;0.2)</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="keywordflow">return</span> 1e38;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="comment">// Construct the filter with the current parameters</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> filter;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> auxf;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    auxf=<a class="code" href="pdb_8cpp.html#a03670ad2c03f04f1be8646970b6dc8dd">globalf</a>;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <a class="code" href="pdb_8cpp.html#a51457d7aed50e11bffd23e2504696f45">hlpf</a>(auxf, <a class="code" href="pdb_8cpp.html#ac1fe23303abe1c0c359bc1bfc59a5774">globalM</a>, <span class="stringliteral">&quot;SincKaiser&quot;</span>, filter, reductionFactor,</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;         ripple, deltaw);</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="comment">// Convolve the filter with the atomic profile</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> fhlpfFinelySampled;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <a class="code" href="pdb_8cpp.html#a6404f5d19d22bd1f41927de5cafa6ca5">fhlpf</a>(auxf, filter, <a class="code" href="pdb_8cpp.html#ac1fe23303abe1c0c359bc1bfc59a5774">globalM</a>, fhlpfFinelySampled);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="comment">// Coarsely sample</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keywordtype">double</span> Rmax=<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(fhlpfFinelySampled)*<a class="code" href="pdb_8cpp.html#a70cffbaf2c91fc9c77305106b3b88d62">globalT</a>;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordtype">int</span> imax=<a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(Rmax/(<a class="code" href="pdb_8cpp.html#ac1fe23303abe1c0c359bc1bfc59a5774">globalM</a>*<a class="code" href="pdb_8cpp.html#a70cffbaf2c91fc9c77305106b3b88d62">globalT</a>));</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> fhlpfCoarselySampled(2*imax+1);</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> splineCoeffsfhlpfFinelySampled;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga098f5c8e7e9c010a3bf7ab82e31828a8">produceSplineCoefficients</a>(<a class="code" href="namespacexmipp__transformation.html#ac5f2bd2937d73c34ed4f6c6c5ff2492aac8f522643bcb55d76296b48480a99c44">xmipp_transformation::BSPLINE3</a>,splineCoeffsfhlpfFinelySampled,fhlpfFinelySampled);</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    fhlpfCoarselySampled.setXmippOrigin();</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <a class="code" href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(fhlpfCoarselySampled)</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    {</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="keywordtype">double</span> r=<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>*(<a class="code" href="pdb_8cpp.html#ac1fe23303abe1c0c359bc1bfc59a5774">globalM</a>*<a class="code" href="pdb_8cpp.html#a70cffbaf2c91fc9c77305106b3b88d62">globalT</a>)/<a class="code" href="pdb_8cpp.html#a70cffbaf2c91fc9c77305106b3b88d62">globalT</a>;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        fhlpfCoarselySampled(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)=</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            splineCoeffsfhlpfFinelySampled.<a class="code" href="classMultidimArray.html#af9d3366f28a3aa658ea8fb252214f673">interpolatedElementBSpline1D</a>(r,3);</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    }</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="comment">// Build the frequency response of the convolved and coarsely sampled</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="comment">// atom</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> aux;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> FfilterMag;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> freq;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; std::complex&lt;double&gt;</a> &gt; Ffilter;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    aux=fhlpfCoarselySampled;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    aux.<a class="code" href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">selfWindow</a>(-10*<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(aux),10*<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(aux));</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <a class="code" href="group__Fourier.html#ga5fddf4cf6da360abdc8fd7d2f21fcbb9">FourierTransform</a>(aux,Ffilter);</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <a class="code" href="group__FourierW.html#ga1075fe73c87077296a879f44ded3a2c3">FFT_magnitude</a>(Ffilter,FfilterMag);</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    freq.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Ffilter));</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <a class="code" href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(FfilterMag)</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(FfilterMag),freq(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    freq/=<a class="code" href="pdb_8cpp.html#ac1fe23303abe1c0c359bc1bfc59a5774">globalM</a>*<a class="code" href="pdb_8cpp.html#a70cffbaf2c91fc9c77305106b3b88d62">globalT</a>;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordtype">double</span> amplitudeFactor=fhlpfFinelySampled.<a class="code" href="classMultidimArray.html#aee20bc83b6b9c873a34a703a077fbfb9">sum</a>()/</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                           fhlpfCoarselySampled.sum();</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="comment">// Compute the error in representation</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="tools_8cpp.html#a42c6b1edc1bd763019f0eb5edce18793">error</a>=0;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> descriptors;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <a class="code" href="group__PDBinterface.html#gabf9520a0d03a1eda59392aa37d7fc56d">atomDescriptors</a>(<a class="code" href="pdb_8cpp.html#a2d5905ca42e031c3d91374c6eee83486">globalAtom</a>, descriptors);</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="keywordtype">double</span> iglobalT=1.0/<a class="code" href="pdb_8cpp.html#a70cffbaf2c91fc9c77305106b3b88d62">globalT</a>;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> f1array, f2array;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    f1array.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(FfilterMag);</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    f2array.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(FfilterMag);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordtype">double</span> Npoints=0;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <a class="code" href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(FfilterMag)</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(freq,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)&gt;=0)</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    {</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="keywordtype">double</span> f1=<a class="code" href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a>(<a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(FfilterMag,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)*<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(FfilterMag)*amplitudeFactor);</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="keywordtype">double</span> f2=<a class="code" href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a>(iglobalT*</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                           <a class="code" href="group__PDBinterface.html#ga9fffa8bfe3a2f60ab76ae5375321e33d">electronFormFactorFourier</a>(<a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(freq,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>),descriptors));</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        Npoints++;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <span class="keywordtype">double</span> diff=(f1-f2);</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        error+=diff*diff;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        f1array(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)=f1;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        f2array(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)=f2;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;i=&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot; wi=&quot;</span> &lt;&lt; <a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(freq,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; f1=&quot;</span> &lt;&lt; f1 &lt;&lt; <span class="stringliteral">&quot; f2=&quot;</span> &lt;&lt; f2 &lt;&lt; <span class="stringliteral">&quot; diff=&quot;</span> &lt;&lt; diff &lt;&lt; <span class="stringliteral">&quot; err2=&quot;</span> &lt;&lt; diff*diff &lt;&lt; std::endl;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    }</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        f1array.<a class="code" href="classMultidimArray.html#a42596ccc34c8e8c71cf6d4d92804dc45">write</a>(<span class="stringliteral">&quot;PPPf1.txt&quot;</span>);</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        f2array.<a class="code" href="classMultidimArray.html#a42596ccc34c8e8c71cf6d4d92804dc45">write</a>(<span class="stringliteral">&quot;PPPf2.txt&quot;</span>);</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Error &quot;</span> &lt;&lt; error/Npoints &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; Npoints &lt;&lt; <span class="stringliteral">&quot; M=&quot;</span> &lt;&lt; <a class="code" href="pdb_8cpp.html#ac1fe23303abe1c0c359bc1bfc59a5774">globalM</a> &lt;&lt; <span class="stringliteral">&quot; T=&quot;</span> &lt;&lt; globalT &lt;&lt; std::endl;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keywordflow">return</span> error/Npoints;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_ac78e0480644752604f2cd3089aeac804"><div class="ttname"><a href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">MultidimArray::selfWindow</a></div><div class="ttdeci">void selfWindow(int n0, int z0, int y0, int x0, int nF, int zF, int yF, int xF, T init_value=0)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00504">multidim_array.h:504</a></div></div>
<div class="ttc" id="classMultidimArray_html_af9d3366f28a3aa658ea8fb252214f673"><div class="ttname"><a href="classMultidimArray.html#af9d3366f28a3aa658ea8fb252214f673">MultidimArray::interpolatedElementBSpline1D</a></div><div class="ttdeci">T interpolatedElementBSpline1D(double x, int SplineDegree=3) const</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00759">multidim_array.cpp:759</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a51457d7aed50e11bffd23e2504696f45"><div class="ttname"><a href="pdb_8cpp.html#a51457d7aed50e11bffd23e2504696f45">hlpf</a></div><div class="ttdeci">void hlpf(MultidimArray&lt; double &gt; &amp;f, int M, const std::string &amp;filterType, MultidimArray&lt; double &gt; &amp;filter, double reductionFactor=0.8, double ripple=0.01, double deltaw=1.0/8.0)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00747">pdb.cpp:747</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a03670ad2c03f04f1be8646970b6dc8dd"><div class="ttname"><a href="pdb_8cpp.html#a03670ad2c03f04f1be8646970b6dc8dd">globalf</a></div><div class="ttdeci">MultidimArray&lt; double &gt; globalf</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00818">pdb.cpp:818</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a97809f7244a28aaa1c26e29e6e3204ef"><div class="ttname"><a href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a></div><div class="ttdeci">#define A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00539">multidim_array_base.h:539</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="pdb_8cpp_html_ac1fe23303abe1c0c359bc1bfc59a5774"><div class="ttname"><a href="pdb_8cpp.html#ac1fe23303abe1c0c359bc1bfc59a5774">globalM</a></div><div class="ttdeci">int globalM</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00819">pdb.cpp:819</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga098f5c8e7e9c010a3bf7ab82e31828a8"><div class="ttname"><a href="group__GeometricalTransformations.html#ga098f5c8e7e9c010a3bf7ab82e31828a8">produceSplineCoefficients</a></div><div class="ttdeci">void produceSplineCoefficients(int SplineDegree, MultidimArray&lt; double &gt; &amp;coeffs, const MultidimArray&lt; T &gt; &amp;V1)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00040">transformations.cpp:40</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00091">multidim_array_base.h:91</a></div></div>
<div class="ttc" id="classMultidimArray_html_a42596ccc34c8e8c71cf6d4d92804dc45"><div class="ttname"><a href="classMultidimArray.html#a42596ccc34c8e8c71cf6d4d92804dc45">MultidimArray::write</a></div><div class="ttdeci">void write(const FileName &amp;fn) const</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00969">multidim_array.cpp:969</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a70cffbaf2c91fc9c77305106b3b88d62"><div class="ttname"><a href="pdb_8cpp.html#a70cffbaf2c91fc9c77305106b3b88d62">globalT</a></div><div class="ttdeci">double globalT</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00820">pdb.cpp:820</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_a3aadc7a86770372bb401fbcb4c05a252"><div class="ttname"><a href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a></div><div class="ttdeci">void log10(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00237">image_operate.cpp:237</a></div></div>
<div class="ttc" id="group__Fourier_html_ga5fddf4cf6da360abdc8fd7d2f21fcbb9"><div class="ttname"><a href="group__Fourier.html#ga5fddf4cf6da360abdc8fd7d2f21fcbb9">FourierTransform</a></div><div class="ttdeci">void FourierTransform(const MultidimArray&lt; double &gt; &amp;in, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8cpp_source.html#l00124">xmipp_fft.cpp:124</a></div></div>
<div class="ttc" id="group__PDBinterface_html_ga9fffa8bfe3a2f60ab76ae5375321e33d"><div class="ttname"><a href="group__PDBinterface.html#ga9fffa8bfe3a2f60ab76ae5375321e33d">electronFormFactorFourier</a></div><div class="ttdeci">double electronFormFactorFourier(double f, const Matrix1D&lt; double &gt; &amp;descriptors)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00702">pdb.cpp:702</a></div></div>
<div class="ttc" id="group__PDBinterface_html_gabf9520a0d03a1eda59392aa37d7fc56d"><div class="ttname"><a href="group__PDBinterface.html#gabf9520a0d03a1eda59392aa37d7fc56d">atomDescriptors</a></div><div class="ttdeci">void atomDescriptors(const std::string &amp;atom, Matrix1D&lt; double &gt; &amp;descriptors)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00526">pdb.cpp:526</a></div></div>
<div class="ttc" id="cuda__gpu__reconstruct__fourier_8cpp_html_ac914a5e7c4e25d78f31f6ec3b1a93c5c"><div class="ttname"><a href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a></div><div class="ttdeci">__device__ float FFT_IDX2DIGFREQ(int idx, int size)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gpu__reconstruct__fourier_8cpp_source.html#l00382">cuda_gpu_reconstruct_fourier.cpp:382</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a6404f5d19d22bd1f41927de5cafa6ca5"><div class="ttname"><a href="pdb_8cpp.html#a6404f5d19d22bd1f41927de5cafa6ca5">fhlpf</a></div><div class="ttdeci">void fhlpf(const MultidimArray&lt; double &gt; &amp;f, const MultidimArray&lt; double &gt; &amp;filter, int M, MultidimArray&lt; double &gt; &amp;convolution)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00777">pdb.cpp:777</a></div></div>
<div class="ttc" id="tools_8cpp_html_a42c6b1edc1bd763019f0eb5edce18793"><div class="ttname"><a href="tools_8cpp.html#a42c6b1edc1bd763019f0eb5edce18793">error</a></div><div class="ttdeci">void error(char *s)</div><div class="ttdef"><b>Definition:</b> <a href="tools_8cpp_source.html#l00107">tools.cpp:107</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_aa924a84ae5fbf0ba6b4052eb9d92ef60"><div class="ttname"><a href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00554">multidim_array_base.h:554</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02689">multidim_array.h:2689</a></div></div>
<div class="ttc" id="group__FourierW_html_ga1075fe73c87077296a879f44ded3a2c3"><div class="ttname"><a href="group__FourierW.html#ga1075fe73c87077296a879f44ded3a2c3">FFT_magnitude</a></div><div class="ttdeci">void FFT_magnitude(const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;v, MultidimArray&lt; double &gt; &amp;mag)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00393">xmipp_fftw.cpp:393</a></div></div>
<div class="ttc" id="classMultidimArray_html_aee20bc83b6b9c873a34a703a077fbfb9"><div class="ttname"><a href="classMultidimArray.html#aee20bc83b6b9c873a34a703a077fbfb9">MultidimArray::sum</a></div><div class="ttdeci">double sum() const</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03371">multidim_array.h:3371</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a2d5905ca42e031c3d91374c6eee83486"><div class="ttname"><a href="pdb_8cpp.html#a2d5905ca42e031c3d91374c6eee83486">globalAtom</a></div><div class="ttdeci">std::string globalAtom</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00821">pdb.cpp:821</a></div></div>
<div class="ttc" id="namespacexmipp__transformation_html_ac5f2bd2937d73c34ed4f6c6c5ff2492aac8f522643bcb55d76296b48480a99c44"><div class="ttname"><a href="namespacexmipp__transformation.html#ac5f2bd2937d73c34ed4f6c6c5ff2492aac8f522643bcb55d76296b48480a99c44">xmipp_transformation::BSPLINE3</a></div><div class="ttdef"><b>Definition:</b> <a href="transformations__defines_8h_source.html#l00032">transformations_defines.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2d41c7d0e542972c688ed6237a509644"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d41c7d0e542972c688ed6237a509644">&#9670;&nbsp;</a></span>optimizeHlpf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void optimizeHlpf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>atom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>filter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>bestPrm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Optimize the low pass filter. The optimization is so that the Fourier response of the coarsely downsampled and convolved atom profile resembles as much as possible the ideal atomic response up to the maximum frequency provided by the Nyquist frequency associated to M*T.</p>
<p>f is the electron scattering factor in real space sampled at a sampling rate T. M is the downsampling factor. atom is the name of the atom being optimized. filter is an output parameter with the optimal impulse response sampled at a sampling rate T. bestPrm(0)=reduction function of the cutoff frequency, bestPrm(1)=ripple of the Kaiser selfWindow, bestPrm(2)=deltaw of the Kaiser selfWindow. </p>

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l00928">928</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;{</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <a class="code" href="pdb_8cpp.html#aab664bf51f4d185f6d849d750ac86fee">globalHlpfPrm</a>(0)=1.0;     <span class="comment">// reduction factor</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <a class="code" href="pdb_8cpp.html#aab664bf51f4d185f6d849d750ac86fee">globalHlpfPrm</a>(1)=0.01;    <span class="comment">// ripple</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <a class="code" href="pdb_8cpp.html#aab664bf51f4d185f6d849d750ac86fee">globalHlpfPrm</a>(2)=1.0/8.0; <span class="comment">// deltaw</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <a class="code" href="pdb_8cpp.html#a03670ad2c03f04f1be8646970b6dc8dd">globalf</a>=<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <a class="code" href="pdb_8cpp.html#ac1fe23303abe1c0c359bc1bfc59a5774">globalM</a>=M;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <a class="code" href="pdb_8cpp.html#a70cffbaf2c91fc9c77305106b3b88d62">globalT</a>=T;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <a class="code" href="pdb_8cpp.html#a2d5905ca42e031c3d91374c6eee83486">globalAtom</a>=atom;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="volume__align__prog_8cpp.html#a8b50613ae00d92ad08f3d5481b2fe213">fitness</a>;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a4155d511de81aa816513aa52de01d931">iter</a>;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#a2de5b01a4efcb9b1582bb2947efc6bad">steps</a>(3);</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a2de5b01a4efcb9b1582bb2947efc6bad">steps</a>.initConstant(1);</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <a class="code" href="numerical__tools_8cpp.html#aa75684a0e8adbe5ee59bfd1540907ab3">powellOptimizer</a>(<a class="code" href="pdb_8cpp.html#aab664bf51f4d185f6d849d750ac86fee">globalHlpfPrm</a>, 1, 3,</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                    &amp;<a class="code" href="pdb_8cpp.html#a53200812640bf6ecfcf3dd8e87fd8725">Hlpf_fitness</a>, <span class="keyword">nullptr</span>, 0.05, fitness, iter, <a class="code" href="numerical__recipes_8cpp.html#a2de5b01a4efcb9b1582bb2947efc6bad">steps</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    bestPrm=<a class="code" href="pdb_8cpp.html#aab664bf51f4d185f6d849d750ac86fee">globalHlpfPrm</a>;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <a class="code" href="pdb_8cpp.html#a51457d7aed50e11bffd23e2504696f45">hlpf</a>(f, M, <span class="stringliteral">&quot;SincKaiser&quot;</span>, filter, bestPrm(0), bestPrm(1), bestPrm(2));</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;}</div><div class="ttc" id="pdb_8cpp_html_a51457d7aed50e11bffd23e2504696f45"><div class="ttname"><a href="pdb_8cpp.html#a51457d7aed50e11bffd23e2504696f45">hlpf</a></div><div class="ttdeci">void hlpf(MultidimArray&lt; double &gt; &amp;f, int M, const std::string &amp;filterType, MultidimArray&lt; double &gt; &amp;filter, double reductionFactor=0.8, double ripple=0.01, double deltaw=1.0/8.0)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00747">pdb.cpp:747</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a03670ad2c03f04f1be8646970b6dc8dd"><div class="ttname"><a href="pdb_8cpp.html#a03670ad2c03f04f1be8646970b6dc8dd">globalf</a></div><div class="ttdeci">MultidimArray&lt; double &gt; globalf</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00818">pdb.cpp:818</a></div></div>
<div class="ttc" id="numerical__tools_8cpp_html_aa75684a0e8adbe5ee59bfd1540907ab3"><div class="ttname"><a href="numerical__tools_8cpp.html#aa75684a0e8adbe5ee59bfd1540907ab3">powellOptimizer</a></div><div class="ttdeci">void powellOptimizer(Matrix1D&lt; double &gt; &amp;p, int i0, int n, double(*f)(double *x, void *), void *prm, double ftol, double &amp;fret, int &amp;iter, const Matrix1D&lt; double &gt; &amp;steps, bool show)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__tools_8cpp_source.html#l00043">numerical_tools.cpp:43</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a4155d511de81aa816513aa52de01d931"><div class="ttname"><a href="numerical__recipes_8cpp.html#a4155d511de81aa816513aa52de01d931">iter</a></div><div class="ttdeci">glob_prnt iter</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04715">numerical_recipes.cpp:4715</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a53200812640bf6ecfcf3dd8e87fd8725"><div class="ttname"><a href="pdb_8cpp.html#a53200812640bf6ecfcf3dd8e87fd8725">Hlpf_fitness</a></div><div class="ttdeci">double Hlpf_fitness(double *p, void *prm)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00824">pdb.cpp:824</a></div></div>
<div class="ttc" id="pdb_8cpp_html_ac1fe23303abe1c0c359bc1bfc59a5774"><div class="ttname"><a href="pdb_8cpp.html#ac1fe23303abe1c0c359bc1bfc59a5774">globalM</a></div><div class="ttdeci">int globalM</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00819">pdb.cpp:819</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a633de4b0c14ca52ea2432a3c8a5c4c31"><div class="ttname"><a href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a></div><div class="ttdeci">double * f</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04431">numerical_recipes.cpp:4431</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a70cffbaf2c91fc9c77305106b3b88d62"><div class="ttname"><a href="pdb_8cpp.html#a70cffbaf2c91fc9c77305106b3b88d62">globalT</a></div><div class="ttdeci">double globalT</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00820">pdb.cpp:820</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a2de5b01a4efcb9b1582bb2947efc6bad"><div class="ttname"><a href="numerical__recipes_8cpp.html#a2de5b01a4efcb9b1582bb2947efc6bad">steps</a></div><div class="ttdeci">double steps</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05183">numerical_recipes.cpp:5183</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="pdb_8cpp_html_aab664bf51f4d185f6d849d750ac86fee"><div class="ttname"><a href="pdb_8cpp.html#aab664bf51f4d185f6d849d750ac86fee">globalHlpfPrm</a></div><div class="ttdeci">Matrix1D&lt; double &gt; globalHlpfPrm(3)</div></div>
<div class="ttc" id="volume__align__prog_8cpp_html_a8b50613ae00d92ad08f3d5481b2fe213"><div class="ttname"><a href="volume__align__prog_8cpp.html#a8b50613ae00d92ad08f3d5481b2fe213">fitness</a></div><div class="ttdeci">double fitness(double *p)</div><div class="ttdef"><b>Definition:</b> <a href="volume__align__prog_8cpp_source.html#l00088">volume_align_prog.cpp:88</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a2d5905ca42e031c3d91374c6eee83486"><div class="ttname"><a href="pdb_8cpp.html#a2d5905ca42e031c3d91374c6eee83486">globalAtom</a></div><div class="ttdeci">std::string globalAtom</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00821">pdb.cpp:821</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a276bb08cb169758db38719569831c899"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a276bb08cb169758db38719569831c899">&#9670;&nbsp;</a></span>projectAtom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void projectAtom </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classAtom.html">Atom</a> &amp;&#160;</td>
          <td class="paramname"><em>atom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>VP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>PV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAtomInterpolator.html">AtomInterpolator</a> &amp;&#160;</td>
          <td class="paramname"><em>interpolator</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structPDB.html">PDB</a> projection ------------------------------------------------------&mdash; </p>

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l01089">1089</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;{</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;constexpr <span class="keywordtype">float</span> SUBSAMPLING = 2;                  <span class="comment">// for every measure 2x2 line</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="comment">// integrals will be taken to</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="comment">// avoid numerical errors</span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;constexpr <span class="keywordtype">float</span> SUBSTEP = 1/(SUBSAMPLING*2.0);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> origin(3);</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="group__FringeProcessing.html#gad71cd7f2325be81202279ed730355092">direction</a>;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    VP.<a class="code" href="classMatrix2D.html#a9e4bd9c27982c0d7775f3804bf021687">getRow</a>(2, direction);</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    direction.<a class="code" href="classMatrix1D.html#af8b6ea8f86fcf69738d37b3336f536af">selfTranspose</a>();</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> corner1(3);</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> corner2(3);</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> act(3);</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <a class="code" href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a>;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="comment">// Find center of the feature in the projection plane ...................</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="comment">// Step 1). Project the center to the plane, the result is in the</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="comment">//          universal coord system</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> Center(3);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(Center, atom.<a class="code" href="classAtom.html#a382da4a2a8d20faa2fd1eca986f44056">x</a>, atom.<a class="code" href="classAtom.html#aab210323240ea76e6f866113e590cd22">y</a>, atom.<a class="code" href="classAtom.html#af1c8b6cd65e2a489b9be339efd7a77ac">z</a>);</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="keywordtype">double</span> max_distance=interpolator.<a class="code" href="classAtomInterpolator.html#a3da6490c9d90461cacdf8a9be6627dcd">atomRadius</a>(atom.<a class="code" href="classAtom.html#a7d9721acafaa5d67ee744348e81235c7">atomType</a>);</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <a class="code" href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a>(origin, VP, Center);</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="comment">//#define DEBUG_LITTLE</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Actual atom\n&quot;</span>        &lt;&lt; atom.<a class="code" href="classAtom.html#a7d9721acafaa5d67ee744348e81235c7">atomType</a> &lt;&lt; <span class="stringliteral">&quot; (&quot;</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    &lt;&lt; atom.<a class="code" href="classAtom.html#a382da4a2a8d20faa2fd1eca986f44056">x</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; atom.<a class="code" href="classAtom.html#aab210323240ea76e6f866113e590cd22">y</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; atom.<a class="code" href="classAtom.html#af1c8b6cd65e2a489b9be339efd7a77ac">z</a> &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Center              &quot;</span> &lt;&lt; Center.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;VP matrix\n&quot;</span>          &lt;&lt; VP &lt;&lt; std::endl;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;P.direction         &quot;</span> &lt;&lt; P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>.<a class="code" href="classMatrix1D.html#a028505ebdeaf6f62d884c31dcd5127a8">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;direction           &quot;</span> &lt;&lt; direction.<a class="code" href="classMatrix1D.html#a028505ebdeaf6f62d884c31dcd5127a8">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;P.euler matrix      &quot;</span> &lt;&lt; P.<a class="code" href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">euler</a> &lt;&lt; std::endl;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;max_distance        &quot;</span> &lt;&lt; max_distance &lt;&lt; std::endl;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;origin              &quot;</span> &lt;&lt; origin.<a class="code" href="classMatrix2D.html#a8073200797ec6121b2ad960f6a41f52a">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <span class="comment">// Find limits for projection ...........................................</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="comment">// Choose corners for the projection of this feature. It is supposed</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="comment">// to have at the worst case a projection of size max_distance</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(corner1, max_distance, max_distance, max_distance);</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(corner2, -max_distance, -max_distance, -max_distance);</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Corner1 : &quot;</span> &lt;&lt; corner1.transpose() &lt;&lt; std::endl</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Corner2 : &quot;</span> &lt;&lt; corner2.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <a class="code" href="group__Geometry.html#ga3baa7ca66e02a7a51562325d28e70d47">box_enclosing</a>(corner1, corner2, VP, corner1, corner2);</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Corner1 moves to : &quot;</span> &lt;&lt; corner1.transpose() &lt;&lt; std::endl</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Corner2 moves to : &quot;</span> &lt;&lt; corner2.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <a class="code" href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a>(corner1, origin, corner1);</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <a class="code" href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a>(corner2, origin, corner2);</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Corner1 finally is : &quot;</span> &lt;&lt; corner1.transpose() &lt;&lt; std::endl</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Corner2 finally is : &quot;</span> &lt;&lt; corner2.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="comment">// Discard not necessary components</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    corner1.resize(2);</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    corner2.resize(2);</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="comment">// Clip to image size</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <a class="code" href="group__Vectors.html#ga988b127d529b4cf677e3d31f65bc8403">sortTwoVectors</a>(corner1, corner2);</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1) = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1)), <a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(P()), <a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(P()));</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1) = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1)), <a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(P()), <a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(P()));</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2) = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2)), <a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(P()), <a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(P()));</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2) = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2)), <a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(P()), <a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(P()));</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;corner1      &quot;</span> &lt;&lt; corner1.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;corner2      &quot;</span> &lt;&lt; corner2.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    std::cout.flush();</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="comment">// Check if there is something to project</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1) == <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2))</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1) == <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2))</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="comment">// Study the projection for each point in the projection plane ..........</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="comment">// (u,v) are in the deformed projection plane (if any deformation)</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> v = (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1); v &lt;= (int)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2); v++)</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a> = (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1); <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a> &lt;= (int)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2); <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a>++)</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        {</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="cuda__basic__math_8h.html#a2fcd5057894d92219f3d8e11e6ace2ff">length</a> = 0;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;            <span class="comment">//#define DEBUG_EVEN_MORE</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="preprocessor">#ifdef DEBUG_EVEN_MORE</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Studying point (&quot;</span> &lt;&lt; <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; v &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;            std::cout.flush();</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;            <span class="comment">// Perform subsampling ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;            <span class="keywordtype">double</span> u0 = <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a> - (int)(SUBSAMPLING / 2.0) * SUBSTEP;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#a8eb6f9afe59b4924d42d1ea2002148e7">v0</a> = v - (int)(SUBSAMPLING / 2.0) * SUBSTEP;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            <span class="keywordtype">double</span> actv = <a class="code" href="numerical__recipes_8cpp.html#a8eb6f9afe59b4924d42d1ea2002148e7">v0</a>;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> subv = 0; subv &lt; SUBSAMPLING; subv++)</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;            {</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                <span class="keywordtype">double</span> actu = u0;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> subu = 0; subu &lt; SUBSAMPLING; subu++)</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                {</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                    <span class="comment">// Compute the coordinates of point (subu,subv) which is</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                    <span class="comment">// within the plane in the universal coordinate system</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(act) = actu;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(act) = actv;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(act) = 0;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                    <a class="code" href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a>(act, PV, act);</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                    <span class="comment">// Compute the intersection of a ray which passes through</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                    <span class="comment">// this point and its direction is perpendicular to the</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                    <span class="comment">// projection plane</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                    <span class="keywordtype">double</span> r=<a class="code" href="group__Geometry.html#ga3adf48a1d9643041f01f7bab097a8d44">point_line_distance_3D</a>(Center, act, direction);</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                    <span class="keywordtype">double</span> possible_length=interpolator.</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                                           projectionAtDistance(atom.<a class="code" href="classAtom.html#a7d9721acafaa5d67ee744348e81235c7">atomType</a>,r);</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                    <span class="keywordflow">if</span> (possible_length &gt; 0)</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                        length += possible_length;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="preprocessor">#ifdef DEBUG_EVEN_MORE</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;Averaging at (&quot;</span> &lt;&lt; actu &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; actv &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;   which in univ. coords is &quot;</span> &lt;&lt; act.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;   r=&quot;</span> &lt;&lt; r &lt;&lt; std::endl;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;   intersection there &quot;</span> &lt;&lt; possible_length &lt;&lt; std::endl;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                    std::cout.flush();</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                    <span class="comment">// Prepare for next iteration</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                    actu += SUBSTEP * 2.0;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                }</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                actv += SUBSTEP * 2.0;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;            }</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;            length /= (SUBSAMPLING * SUBSAMPLING);</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;            <span class="comment">//#define DEBUG</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Final value added at position (&quot;</span> &lt;&lt; <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; v &lt;&lt; <span class="stringliteral">&quot;)=&quot;</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;            &lt;&lt; length &lt;&lt; std::endl;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;            std::cout.flush();</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;            <span class="comment">// Add at the correspondent pixel the found intersection ,,,,,,,,,,</span></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;            <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(P, v, <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a>) += <a class="code" href="cuda__basic__math_8h.html#a2fcd5057894d92219f3d8e11e6ace2ff">length</a>;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        }</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;}</div><div class="ttc" id="classAtom_html_af1c8b6cd65e2a489b9be339efd7a77ac"><div class="ttname"><a href="classAtom.html#af1c8b6cd65e2a489b9be339efd7a77ac">Atom::z</a></div><div class="ttdeci">double z</div><div class="ttdoc">Position Z. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00122">pdb.h:122</a></div></div>
<div class="ttc" id="group__Geometry_html_ga3adf48a1d9643041f01f7bab097a8d44"><div class="ttname"><a href="group__Geometry.html#ga3adf48a1d9643041f01f7bab097a8d44">point_line_distance_3D</a></div><div class="ttdeci">double point_line_distance_3D(const Matrix1D&lt; double &gt; &amp;p, const Matrix1D&lt; double &gt; &amp;a, const Matrix1D&lt; double &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00085">geometry.cpp:85</a></div></div>
<div class="ttc" id="group__Vectors_html_ga988b127d529b4cf677e3d31f65bc8403"><div class="ttname"><a href="group__Vectors.html#ga988b127d529b4cf677e3d31f65bc8403">sortTwoVectors</a></div><div class="ttdeci">void sortTwoVectors(Matrix1D&lt; T &gt; &amp;v1, Matrix1D&lt; T &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01205">matrix1d.h:1205</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="group__FourierProjection_html_gabef83744f4e0571354f31586fb41d357"><div class="ttname"><a href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">Projection::euler</a></div><div class="ttdeci">Matrix2D&lt; double &gt; euler</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00071">fourier_projection.h:71</a></div></div>
<div class="ttc" id="classAtom_html_a382da4a2a8d20faa2fd1eca986f44056"><div class="ttname"><a href="classAtom.html#a382da4a2a8d20faa2fd1eca986f44056">Atom::x</a></div><div class="ttdeci">double x</div><div class="ttdoc">Position X. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00116">pdb.h:116</a></div></div>
<div class="ttc" id="classMatrix2D_html_a8073200797ec6121b2ad960f6a41f52a"><div class="ttname"><a href="classMatrix2D.html#a8073200797ec6121b2ad960f6a41f52a">Matrix2D::transpose</a></div><div class="ttdeci">Matrix2D&lt; T &gt; transpose() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l01313">matrix2d.cpp:1313</a></div></div>
<div class="ttc" id="classAtom_html_a7d9721acafaa5d67ee744348e81235c7"><div class="ttname"><a href="classAtom.html#a7d9721acafaa5d67ee744348e81235c7">Atom::atomType</a></div><div class="ttdeci">char atomType</div><div class="ttdoc">Type. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00113">pdb.h:113</a></div></div>
<div class="ttc" id="classMatrix1D_html_af8b6ea8f86fcf69738d37b3336f536af"><div class="ttname"><a href="classMatrix1D.html#af8b6ea8f86fcf69738d37b3336f536af">Matrix1D::selfTranspose</a></div><div class="ttdeci">void selfTranspose()</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00943">matrix1d.h:943</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="classMatrix1D_html_a028505ebdeaf6f62d884c31dcd5127a8"><div class="ttname"><a href="classMatrix1D.html#a028505ebdeaf6f62d884c31dcd5127a8">Matrix1D::transpose</a></div><div class="ttdeci">Matrix1D&lt; T &gt; transpose() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8cpp_source.html#l00631">matrix1d.cpp:631</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00059">multidim_array_base.h:59</a></div></div>
<div class="ttc" id="group__Macros_html_gad4d08cca0a39849cc247072eaebe7726"><div class="ttname"><a href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a></div><div class="ttdeci">#define CLIP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00260">xmipp_macros.h:260</a></div></div>
<div class="ttc" id="group__Geometry_html_ga3baa7ca66e02a7a51562325d28e70d47"><div class="ttname"><a href="group__Geometry.html#ga3baa7ca66e02a7a51562325d28e70d47">box_enclosing</a></div><div class="ttdeci">void box_enclosing(const Matrix1D&lt; double &gt; &amp;v0, const Matrix1D&lt; double &gt; &amp;vF, const Matrix2D&lt; double &gt; &amp;V, Matrix1D&lt; double &gt; &amp;corner1, Matrix1D&lt; double &gt; &amp;corner2)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00366">geometry.cpp:366</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00084">matrix1d.h:84</a></div></div>
<div class="ttc" id="cuda__basic__math_8h_html_a2fcd5057894d92219f3d8e11e6ace2ff"><div class="ttname"><a href="cuda__basic__math_8h.html#a2fcd5057894d92219f3d8e11e6ace2ff">length</a></div><div class="ttdeci">__host__ __device__ float length(float2 v)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__basic__math_8h_source.html#l00162">cuda_basic_math.h:162</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="group__FringeProcessing_html_gad71cd7f2325be81202279ed730355092"><div class="ttname"><a href="group__FringeProcessing.html#gad71cd7f2325be81202279ed730355092">direction</a></div><div class="ttdeci">void direction(const MultidimArray&lt; double &gt; &amp;orMap, MultidimArray&lt; double &gt; &amp;qualityMap, double lambda, int size, MultidimArray&lt; double &gt; &amp;dirMap, int x, int y)</div><div class="ttdef"><b>Definition:</b> <a href="fringe__processing_8cpp_source.html#l00436">fringe_processing.cpp:436</a></div></div>
<div class="ttc" id="group__FourierProjection_html_ga532f6713fbe228d3ee30f4d3a2766a20"><div class="ttname"><a href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">Projection::direction</a></div><div class="ttdeci">Matrix1D&lt; double &gt; direction</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00062">fourier_projection.h:62</a></div></div>
<div class="ttc" id="group__Matrices_html_gad159332322d687de886a720422e4b757"><div class="ttname"><a href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a></div><div class="ttdeci">#define M3x3_BY_V3x1(a, M, b)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00170">matrix2d.h:170</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00092">matrix1d.h:92</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00063">multidim_array_base.h:63</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classAtom_html_aab210323240ea76e6f866113e590cd22"><div class="ttname"><a href="classAtom.html#aab210323240ea76e6f866113e590cd22">Atom::y</a></div><div class="ttdeci">double y</div><div class="ttdoc">Position Y. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00119">pdb.h:119</a></div></div>
<div class="ttc" id="group__Vectors_html_ga6c6b4d4f88daca5e1d8e171bec3b4af0"><div class="ttname"><a href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a></div><div class="ttdeci">#define VECTOR_R3(v, x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00123">matrix1d.h:123</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a6277e2a7446059985dc9bcf0a4ac1a8f"><div class="ttname"><a href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a></div><div class="ttdeci">doublereal * u</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="classAtomInterpolator_html_a3da6490c9d90461cacdf8a9be6627dcd"><div class="ttname"><a href="classAtomInterpolator.html#a3da6490c9d90461cacdf8a9be6627dcd">AtomInterpolator::atomRadius</a></div><div class="ttdeci">double atomRadius(char atom) const</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00348">pdb.h:348</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a8eb6f9afe59b4924d42d1ea2002148e7"><div class="ttname"><a href="numerical__recipes_8cpp.html#a8eb6f9afe59b4924d42d1ea2002148e7">v0</a></div><div class="ttdeci">double v0</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l06229">numerical_recipes.cpp:6229</a></div></div>
<div class="ttc" id="classMatrix2D_html_a9e4bd9c27982c0d7775f3804bf021687"><div class="ttname"><a href="classMatrix2D.html#a9e4bd9c27982c0d7775f3804bf021687">Matrix2D::getRow</a></div><div class="ttdeci">void getRow(size_t i, Matrix1D&lt; T &gt; &amp;v) const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l00870">matrix2d.cpp:870</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00100">matrix1d.h:100</a></div></div>
<div class="ttc" id="group__Vectors_html_gafe748b92e8aeaa282eb7bafbd2baca37"><div class="ttname"><a href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a></div><div class="ttdeci">#define V3_PLUS_V3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00189">matrix1d.h:189</a></div></div>
<div class="ttc" id="group__Images_html_gaad11fc7e221702e9f1adeb445ba5db9c"><div class="ttname"><a href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a></div><div class="ttdeci">#define IMGPIXEL(I, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00188">xmipp_image_base.h:188</a></div></div>
<div class="ttc" id="group__Macros_html_ga20716e3da0ba25d3c4c9a2421573391f"><div class="ttname"><a href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a></div><div class="ttdeci">#define SPEED_UP_temps012</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00403">xmipp_macros.h:403</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a2d5905ca42e031c3d91374c6eee83486"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d5905ca42e031c3d91374c6eee83486">&#9670;&nbsp;</a></span>globalAtom</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string globalAtom</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l00821">821</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>

</div>
</div>
<a id="a03670ad2c03f04f1be8646970b6dc8dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03670ad2c03f04f1be8646970b6dc8dd">&#9670;&nbsp;</a></span>globalf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt;double&gt; globalf</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l00818">818</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>

</div>
</div>
<a id="aab664bf51f4d185f6d849d750ac86fee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab664bf51f4d185f6d849d750ac86fee">&#9670;&nbsp;</a></span>globalHlpfPrm</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt;double&gt; globalHlpfPrm(3)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac1fe23303abe1c0c359bc1bfc59a5774"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1fe23303abe1c0c359bc1bfc59a5774">&#9670;&nbsp;</a></span>globalM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int globalM</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l00819">819</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>

</div>
</div>
<a id="a70cffbaf2c91fc9c77305106b3b88d62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70cffbaf2c91fc9c77305106b3b88d62">&#9670;&nbsp;</a></span>globalT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double globalT</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l00820">820</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
