<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Xmipp: xmipp/libraries/data/pdb.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5bce755d3f27cf36e7d1a940cfd4182d.html">xmipp</a></li><li class="navelem"><a class="el" href="dir_29dba3f3840f20df3b04d1972e99046b.html">libraries</a></li><li class="navelem"><a class="el" href="dir_02b15c2011e26cf58f557fc966b9a0d4.html">data</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">pdb.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;fstream&gt;</code><br />
<code>#include &lt;string&gt;</code><br />
<code>#include &lt;filesystem&gt;</code><br />
<code>#include &lt;iomanip&gt;</code><br />
<code>#include &lt;sstream&gt;</code><br />
<code>#include &quot;cif++.hpp&quot;</code><br />
<code>#include &quot;<a class="el" href="pdb_8h_source.html">pdb.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="matrix2d_8h_source.html">core/matrix2d.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="multidim__array_8h_source.html">core/multidim_array.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="transformations_8h_source.html">core/transformations.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="xmipp__fftw_8h_source.html">core/xmipp_fftw.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fourier__projection_8h_source.html">data/fourier_projection.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="libraries_2data_2integration_8h_source.html">data/integration.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mask_8h_source.html">data/mask.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="numerical__tools_8h_source.html">data/numerical_tools.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for pdb.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="pdb_8cpp__incl.png" border="0" usemap="#xmipp_2libraries_2data_2pdb_8cpp" alt=""/></div>
<map name="xmipp_2libraries_2data_2pdb_8cpp" id="xmipp_2libraries_2data_2pdb_8cpp">
</map>
</div>
</div>
<p><a href="pdb_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAtomValueFunc.html">AtomValueFunc</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:abdfb60181bc810ec7eee21bcb17ed7dd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#abdfb60181bc810ec7eee21bcb17ed7dd">IOTBX_PDB_HYBRID_36_C_H</a></td></tr>
<tr class="separator:abdfb60181bc810ec7eee21bcb17ed7dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5865fd53e2b881052c2e4949b40c651c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a5865fd53e2b881052c2e4949b40c651c">HY36_WIDTH_4_MIN</a>&#160;&#160;&#160;-999</td></tr>
<tr class="separator:a5865fd53e2b881052c2e4949b40c651c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb30183379954a9e0b3c1bc7338ee153"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#abb30183379954a9e0b3c1bc7338ee153">HY36_WIDTH_4_MAX</a>&#160;&#160;&#160;2436111 /* 10000 + 2*26*36*36*36 - 1 */</td></tr>
<tr class="separator:abb30183379954a9e0b3c1bc7338ee153"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a986ef07aa563dc7c685713b1bf70d669"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a986ef07aa563dc7c685713b1bf70d669">HY36_WIDTH_5_MIN</a>&#160;&#160;&#160;-9999</td></tr>
<tr class="separator:a986ef07aa563dc7c685713b1bf70d669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4200ca5aed3f2b4e16a4f648e2a3600f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a4200ca5aed3f2b4e16a4f648e2a3600f">HY36_WIDTH_5_MAX</a>&#160;&#160;&#160;87440031 /* 100000 + 2*26*36*36*36*36 - 1 */</td></tr>
<tr class="separator:a4200ca5aed3f2b4e16a4f648e2a3600f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a693107837cafaa73db3f5ab5c7895c25"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a693107837cafaa73db3f5ab5c7895c25">INTEGRATION</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a693107837cafaa73db3f5ab5c7895c25"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga1d78a55abdbc481c2bf89f16ce38a955"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#ga1d78a55abdbc481c2bf89f16ce38a955">analyzePDBAtoms</a> (const <a class="el" href="classFileName.html">FileName</a> &amp;fn_pdb, const std::string &amp;typeOfAtom, int &amp;numberOfAtoms, <a class="el" href="structpdbInfo.html">pdbInfo</a> &amp;at_pos)</td></tr>
<tr class="separator:ga1d78a55abdbc481c2bf89f16ce38a955"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0d3e71a203505e6efe26e496d7749841"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#ga0d3e71a203505e6efe26e496d7749841">atomCharge</a> (const std::string &amp;atom)</td></tr>
<tr class="separator:ga0d3e71a203505e6efe26e496d7749841"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4e05007583cdf873be6147d695021c9d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#ga4e05007583cdf873be6147d695021c9d">atomRadius</a> (const std::string &amp;atom)</td></tr>
<tr class="separator:ga4e05007583cdf873be6147d695021c9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7511afdf175c757f48708ff53ddcde73"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#ga7511afdf175c757f48708ff53ddcde73">atomCovalentRadius</a> (const std::string &amp;atom)</td></tr>
<tr class="separator:ga7511afdf175c757f48708ff53ddcde73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8145e748890bee54f3acc43e5b03d1e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#ga8145e748890bee54f3acc43e5b03d1e5">computePDBgeometry</a> (const std::string &amp;fnPDB, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;centerOfMass, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;limit0, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;limitF, const std::string &amp;intensityColumn)</td></tr>
<tr class="separator:ga8145e748890bee54f3acc43e5b03d1e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga85155671d61759cdd1dc09421b201340"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#ga85155671d61759cdd1dc09421b201340">applyGeometryToPDBFile</a> (const std::string &amp;fn_in, const std::string &amp;fn_out, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A, bool centerPDB, const std::string &amp;intensityColumn)</td></tr>
<tr class="separator:ga85155671d61759cdd1dc09421b201340"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50420b85a6567099e12c4e0d5f8e3ea8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a50420b85a6567099e12c4e0d5f8e3ea8">checkExtension</a> (const std::filesystem::path &amp;filePath, const std::list&lt; std::string &gt; &amp;acceptedExtensions, const std::list&lt; std::string &gt; &amp;acceptedCompressions)</td></tr>
<tr class="memdesc:a50420b85a6567099e12c4e0d5f8e3ea8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the file uses a supported extension type.  <a href="#a50420b85a6567099e12c4e0d5f8e3ea8">More...</a><br /></td></tr>
<tr class="separator:a50420b85a6567099e12c4e0d5f8e3ea8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc17c5a4c6ef96f3738b1cf517726513"><td class="memTemplParams" colspan="2">template&lt;typename callable &gt; </td></tr>
<tr class="memitem:abc17c5a4c6ef96f3738b1cf517726513"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#abc17c5a4c6ef96f3738b1cf517726513">readPDB</a> (const <a class="el" href="classFileName.html">FileName</a> &amp;fnPDB, const callable &amp;addAtom)</td></tr>
<tr class="memdesc:abc17c5a4c6ef96f3738b1cf517726513"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read phantom from <a class="el" href="structPDB.html">PDB</a>.  <a href="#abc17c5a4c6ef96f3738b1cf517726513">More...</a><br /></td></tr>
<tr class="separator:abc17c5a4c6ef96f3738b1cf517726513"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bd8e63f0621537c4e4b319ed0ba25ae"><td class="memTemplParams" colspan="2">template&lt;typename callable &gt; </td></tr>
<tr class="memitem:a2bd8e63f0621537c4e4b319ed0ba25ae"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a2bd8e63f0621537c4e4b319ed0ba25ae">readCIF</a> (const std::string &amp;fnCIF, const callable &amp;addAtom, cif::datablock &amp;dataBlock)</td></tr>
<tr class="memdesc:a2bd8e63f0621537c4e4b319ed0ba25ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read phantom from CIF.  <a href="#a2bd8e63f0621537c4e4b319ed0ba25ae">More...</a><br /></td></tr>
<tr class="separator:a2bd8e63f0621537c4e4b319ed0ba25ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75ab8213ef5b9951b95c4cd71e8072ac"><td class="memTemplParams" colspan="2">template&lt;typename callable &gt; </td></tr>
<tr class="memitem:a75ab8213ef5b9951b95c4cd71e8072ac"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a75ab8213ef5b9951b95c4cd71e8072ac">readRichPDB</a> (const <a class="el" href="classFileName.html">FileName</a> &amp;fnPDB, const callable &amp;addAtom, std::vector&lt; double &gt; &amp;intensities, std::vector&lt; std::string &gt; &amp;remarks, const bool pseudoatoms, const double <a class="el" href="lib__vwk_8h.html#a624a8b0f9f8900df6f540fa654e179b3">threshold</a>)</td></tr>
<tr class="memdesc:a75ab8213ef5b9951b95c4cd71e8072ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read rich phantom from either a <a class="el" href="structPDB.html">PDB</a> of CIF file.  <a href="#a75ab8213ef5b9951b95c4cd71e8072ac">More...</a><br /></td></tr>
<tr class="separator:a75ab8213ef5b9951b95c4cd71e8072ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedb9b69d6078b10111bb7bea470e2e53"><td class="memTemplParams" colspan="2">template&lt;typename callable &gt; </td></tr>
<tr class="memitem:aedb9b69d6078b10111bb7bea470e2e53"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#aedb9b69d6078b10111bb7bea470e2e53">readRichCIF</a> (const std::string &amp;fnCIF, const callable &amp;addAtom, std::vector&lt; double &gt; &amp;intensities, const bool pseudoatoms, const double <a class="el" href="lib__vwk_8h.html#a624a8b0f9f8900df6f540fa654e179b3">threshold</a>, cif::datablock &amp;dataBlock)</td></tr>
<tr class="memdesc:aedb9b69d6078b10111bb7bea470e2e53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read rich phantom from CIF.  <a href="#aedb9b69d6078b10111bb7bea470e2e53">More...</a><br /></td></tr>
<tr class="separator:aedb9b69d6078b10111bb7bea470e2e53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae248e2d01ac40a2b06121ac27cad220"><td class="memTemplParams" colspan="2">template&lt;typename callable &gt; </td></tr>
<tr class="memitem:aae248e2d01ac40a2b06121ac27cad220"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#aae248e2d01ac40a2b06121ac27cad220">writePDB</a> (const <a class="el" href="classFileName.html">FileName</a> &amp;fnPDB, bool renumber, const std::vector&lt; std::string &gt; &amp;remarks, const callable &amp;atomList)</td></tr>
<tr class="memdesc:aae248e2d01ac40a2b06121ac27cad220"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write rich phantom to <a class="el" href="structPDB.html">PDB</a> file.  <a href="#aae248e2d01ac40a2b06121ac27cad220">More...</a><br /></td></tr>
<tr class="separator:aae248e2d01ac40a2b06121ac27cad220"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18c915588d7a234d7041625866e7cdec"><td class="memTemplParams" colspan="2">template&lt;typename callable &gt; </td></tr>
<tr class="memitem:a18c915588d7a234d7041625866e7cdec"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a18c915588d7a234d7041625866e7cdec">writeCIF</a> (const std::string &amp;fnCIF, const callable &amp;atomList, cif::datablock &amp;dataBlock)</td></tr>
<tr class="memdesc:a18c915588d7a234d7041625866e7cdec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write rich phantom to CIF file.  <a href="#a18c915588d7a234d7041625866e7cdec">More...</a><br /></td></tr>
<tr class="separator:a18c915588d7a234d7041625866e7cdec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabf9520a0d03a1eda59392aa37d7fc56d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#gabf9520a0d03a1eda59392aa37d7fc56d">atomDescriptors</a> (const std::string &amp;atom, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;descriptors)</td></tr>
<tr class="separator:gabf9520a0d03a1eda59392aa37d7fc56d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9fffa8bfe3a2f60ab76ae5375321e33d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#ga9fffa8bfe3a2f60ab76ae5375321e33d">electronFormFactorFourier</a> (double <a class="el" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;descriptors)</td></tr>
<tr class="separator:ga9fffa8bfe3a2f60ab76ae5375321e33d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac889ae4327c233fb8f01241f692c7d6f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#gac889ae4327c233fb8f01241f692c7d6f">electronFormFactorRealSpace</a> (double r, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;descriptors)</td></tr>
<tr class="separator:gac889ae4327c233fb8f01241f692c7d6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51457d7aed50e11bffd23e2504696f45"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a51457d7aed50e11bffd23e2504696f45">hlpf</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>, int M, const std::string &amp;filterType, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;filter, double reductionFactor=0.8, double ripple=0.01, double deltaw=1.0/8.0)</td></tr>
<tr class="separator:a51457d7aed50e11bffd23e2504696f45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6404f5d19d22bd1f41927de5cafa6ca5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a6404f5d19d22bd1f41927de5cafa6ca5">fhlpf</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;filter, int M, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;convolution)</td></tr>
<tr class="separator:a6404f5d19d22bd1f41927de5cafa6ca5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53200812640bf6ecfcf3dd8e87fd8725"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a53200812640bf6ecfcf3dd8e87fd8725">Hlpf_fitness</a> (double *p, void *<a class="el" href="mpi__classify__CL2D_8cpp.html#a831c08adbb8230fd6a60f4a130923a19">prm</a>)</td></tr>
<tr class="separator:a53200812640bf6ecfcf3dd8e87fd8725"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d41c7d0e542972c688ed6237a509644"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a2d41c7d0e542972c688ed6237a509644">optimizeHlpf</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>, int M, double T, const std::string &amp;atom, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;filter, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;bestPrm)</td></tr>
<tr class="separator:a2d41c7d0e542972c688ed6237a509644"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a048558a4305419364ccfc1b510df4f8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a048558a4305419364ccfc1b510df4f8e">atomRadialProfile</a> (int M, double T, const std::string &amp;atom, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;profile)</td></tr>
<tr class="separator:a048558a4305419364ccfc1b510df4f8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f15a7e8fb17586cc6403532ff2bd9bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a1f15a7e8fb17586cc6403532ff2bd9bd">atomProjectionRadialProfile</a> (int M, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;profileCoefficients, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;projectionProfile)</td></tr>
<tr class="separator:a1f15a7e8fb17586cc6403532ff2bd9bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a276bb08cb169758db38719569831c899"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a276bb08cb169758db38719569831c899">projectAtom</a> (const <a class="el" href="classAtom.html">Atom</a> &amp;atom, <a class="el" href="classProjection.html">Projection</a> &amp;P, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;VP, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;PV, const <a class="el" href="classAtomInterpolator.html">AtomInterpolator</a> &amp;interpolator)</td></tr>
<tr class="separator:a276bb08cb169758db38719569831c899"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7411b6214afc11f4a5a43d0fa28f9004"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#ga7411b6214afc11f4a5a43d0fa28f9004">projectPDB</a> (const <a class="el" href="classPDBPhantom.html">PDBPhantom</a> &amp;phantomPDB, const <a class="el" href="classAtomInterpolator.html">AtomInterpolator</a> &amp;interpolator, <a class="el" href="classProjection.html">Projection</a> &amp;proj, int Ydim, int Xdim, double rot, double tilt, double psi)</td></tr>
<tr class="separator:ga7411b6214afc11f4a5a43d0fa28f9004"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1ae71a9378a4ca0ef298ec1a3786612e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PDBinterface.html#ga1ae71a9378a4ca0ef298ec1a3786612e">distanceHistogramPDB</a> (const <a class="el" href="classPDBPhantom.html">PDBPhantom</a> &amp;phantomPDB, size_t Nnearest, double maxDistance, int Nbins, <a class="el" href="classHistogram1D.html">Histogram1D</a> &amp;hist)</td></tr>
<tr class="separator:ga1ae71a9378a4ca0ef298ec1a3786612e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a585418e13971c1ebd38e73af4d76d6a2"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a585418e13971c1ebd38e73af4d76d6a2">hy36encode</a> (unsigned width, int value, char *result)</td></tr>
<tr class="separator:a585418e13971c1ebd38e73af4d76d6a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8248f1cc700e7409a9e5dc6a9f80212"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#ab8248f1cc700e7409a9e5dc6a9f80212">hy36decode</a> (unsigned width, const char *s, unsigned s_size, int *result)</td></tr>
<tr class="separator:ab8248f1cc700e7409a9e5dc6a9f80212"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a415a71241b7fb6d35414b002656156f9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a415a71241b7fb6d35414b002656156f9">hy36decodeSafe</a> (unsigned width, const char *s, unsigned s_size, int *result)</td></tr>
<tr class="separator:a415a71241b7fb6d35414b002656156f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c7461f600f53acbcb1d4091b3968b9b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a8c7461f600f53acbcb1d4091b3968b9b">hy36encodeSafe</a> (unsigned width, int value, char *result)</td></tr>
<tr class="separator:a8c7461f600f53acbcb1d4091b3968b9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aab664bf51f4d185f6d849d750ac86fee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#aab664bf51f4d185f6d849d750ac86fee">globalHlpfPrm</a> (3)</td></tr>
<tr class="separator:aab664bf51f4d185f6d849d750ac86fee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03670ad2c03f04f1be8646970b6dc8dd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a03670ad2c03f04f1be8646970b6dc8dd">globalf</a></td></tr>
<tr class="separator:a03670ad2c03f04f1be8646970b6dc8dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1fe23303abe1c0c359bc1bfc59a5774"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#ac1fe23303abe1c0c359bc1bfc59a5774">globalM</a></td></tr>
<tr class="separator:ac1fe23303abe1c0c359bc1bfc59a5774"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70cffbaf2c91fc9c77305106b3b88d62"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a70cffbaf2c91fc9c77305106b3b88d62">globalT</a></td></tr>
<tr class="separator:a70cffbaf2c91fc9c77305106b3b88d62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d5905ca42e031c3d91374c6eee83486"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pdb_8cpp.html#a2d5905ca42e031c3d91374c6eee83486">globalAtom</a></td></tr>
<tr class="separator:a2d5905ca42e031c3d91374c6eee83486"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="abb30183379954a9e0b3c1bc7338ee153"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb30183379954a9e0b3c1bc7338ee153">&#9670;&nbsp;</a></span>HY36_WIDTH_4_MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HY36_WIDTH_4_MAX&#160;&#160;&#160;2436111 /* 10000 + 2*26*36*36*36 - 1 */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l00054">54</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>

</div>
</div>
<a id="a5865fd53e2b881052c2e4949b40c651c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5865fd53e2b881052c2e4949b40c651c">&#9670;&nbsp;</a></span>HY36_WIDTH_4_MIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HY36_WIDTH_4_MIN&#160;&#160;&#160;-999</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l00053">53</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>

</div>
</div>
<a id="a4200ca5aed3f2b4e16a4f648e2a3600f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4200ca5aed3f2b4e16a4f648e2a3600f">&#9670;&nbsp;</a></span>HY36_WIDTH_5_MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HY36_WIDTH_5_MAX&#160;&#160;&#160;87440031 /* 100000 + 2*26*36*36*36*36 - 1 */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l00056">56</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>

</div>
</div>
<a id="a986ef07aa563dc7c685713b1bf70d669"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a986ef07aa563dc7c685713b1bf70d669">&#9670;&nbsp;</a></span>HY36_WIDTH_5_MIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HY36_WIDTH_5_MIN&#160;&#160;&#160;-9999</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l00055">55</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>

</div>
</div>
<a id="a693107837cafaa73db3f5ab5c7895c25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a693107837cafaa73db3f5ab5c7895c25">&#9670;&nbsp;</a></span>INTEGRATION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INTEGRATION&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l01355">1355</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>

</div>
</div>
<a id="abdfb60181bc810ec7eee21bcb17ed7dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdfb60181bc810ec7eee21bcb17ed7dd">&#9670;&nbsp;</a></span>IOTBX_PDB_HYBRID_36_C_H</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IOTBX_PDB_HYBRID_36_C_H</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l00047">47</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a1f15a7e8fb17586cc6403532ff2bd9bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f15a7e8fb17586cc6403532ff2bd9bd">&#9670;&nbsp;</a></span>atomProjectionRadialProfile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void atomProjectionRadialProfile </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>profileCoefficients</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>projectionProfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l01356">1356</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;{</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    <a class="code" href="classAtomValueFunc.html">AtomValueFunc</a> atomValue;</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    atomValue.<a class="code" href="classAtomValueFunc.html#ae910deea911de10b749aa2cfc63ba515">profileCoefficients</a>=&amp;profileCoefficients;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    atomValue.<a class="code" href="classAtomValueFunc.html#a42b6b56497f6fe09064d15a289782202">M</a>=M;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">radius</a>=(double)<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(profileCoefficients)/M;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a>=radius*<a class="code" href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">radius</a>;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    projectionProfile.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(profileCoefficients);</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    <a class="code" href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(projectionProfile)</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    {</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        <span class="keywordtype">double</span> r0=(double)<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>/M;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        atomValue.<a class="code" href="classAtomValueFunc.html#a02f10206324ad21105d410c8e25c00a2">r0_2</a>=r0*r0;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        <span class="keywordflow">if</span> (atomValue.<a class="code" href="classAtomValueFunc.html#a02f10206324ad21105d410c8e25c00a2">r0_2</a>&gt;r2)</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;            <span class="keywordflow">continue</span>; <span class="comment">// Because of numerical instabilities</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        <span class="keywordtype">double</span> maxZ=<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(r2-atomValue.<a class="code" href="classAtomValueFunc.html#a02f10206324ad21105d410c8e25c00a2">r0_2</a>);</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="preprocessor">#if INTEGRATION==1</span></div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        <span class="keywordtype">double</span> dz=1/24.0;</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        <span class="keywordtype">double</span> integral=0;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        <span class="keywordflow">for</span> (atomValue.<a class="code" href="classAtomValueFunc.html#aa27aa05d374b83212bc080e04f9b114b">z</a>=-maxZ; atomValue.<a class="code" href="classAtomValueFunc.html#aa27aa05d374b83212bc080e04f9b114b">z</a>&lt;=maxZ; atomValue.<a class="code" href="classAtomValueFunc.html#aa27aa05d374b83212bc080e04f9b114b">z</a>+=dz)</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;        {</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;            projectionProfile(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)+=atomValue();</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        }</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        projectionProfile(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)*=dz;</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        <a class="code" href="classRomberg.html">Romberg</a> Rom(atomValue, atomValue.<a class="code" href="classAtomValueFunc.html#aa27aa05d374b83212bc080e04f9b114b">z</a>,-maxZ,maxZ);</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        projectionProfile(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = Rom();</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    }</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;}</div><div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="classAtomValueFunc_html_aa27aa05d374b83212bc080e04f9b114b"><div class="ttname"><a href="classAtomValueFunc.html#aa27aa05d374b83212bc080e04f9b114b">AtomValueFunc::z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01344">pdb.cpp:1344</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00210">image_operate.cpp:210</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="classAtomValueFunc_html_a02f10206324ad21105d410c8e25c00a2"><div class="ttname"><a href="classAtomValueFunc.html#a02f10206324ad21105d410c8e25c00a2">AtomValueFunc::r0_2</a></div><div class="ttdeci">double r0_2</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01343">pdb.cpp:1343</a></div></div>
<div class="ttc" id="classRomberg_html"><div class="ttname"><a href="classRomberg.html">Romberg</a></div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2integration_8h_source.html#l00189">integration.h:189</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_aa924a84ae5fbf0ba6b4052eb9d92ef60"><div class="ttname"><a href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00554">multidim_array_base.h:554</a></div></div>
<div class="ttc" id="classAtomValueFunc_html"><div class="ttname"><a href="classAtomValueFunc.html">AtomValueFunc</a></div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01339">pdb.cpp:1339</a></div></div>
<div class="ttc" id="classAtomValueFunc_html_ae910deea911de10b749aa2cfc63ba515"><div class="ttname"><a href="classAtomValueFunc.html#ae910deea911de10b749aa2cfc63ba515">AtomValueFunc::profileCoefficients</a></div><div class="ttdeci">const MultidimArray&lt; double &gt; * profileCoefficients</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01345">pdb.cpp:1345</a></div></div>
<div class="ttc" id="classAtomValueFunc_html_a42b6b56497f6fe09064d15a289782202"><div class="ttname"><a href="classAtomValueFunc.html#a42b6b56497f6fe09064d15a289782202">AtomValueFunc::M</a></div><div class="ttdeci">int M</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01342">pdb.cpp:1342</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_ab7a69dabaa7151dae4d7a3998167e2f3"><div class="ttname"><a href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a></div><div class="ttdeci">float r2</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02723">multidim_array.h:2723</a></div></div>
<div class="ttc" id="structblobtype_html_a292968bd7221739a3a58231353f0d0ec"><div class="ttname"><a href="structblobtype.html#a292968bd7221739a3a58231353f0d0ec">blobtype::radius</a></div><div class="ttdeci">double radius</div><div class="ttdoc">Spatial radius in Universal System units. </div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00115">blobs.h:115</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a048558a4305419364ccfc1b510df4f8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a048558a4305419364ccfc1b510df4f8e">&#9670;&nbsp;</a></span>atomRadialProfile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void atomRadialProfile </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>atom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>profile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l01299">1299</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;{</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="comment">// Compute the electron form factor in real space</span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <span class="keywordtype">double</span> largestb1=76.7309/(4*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>);</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <span class="keywordtype">double</span> Rmax=4*<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(2*largestb1);</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="keyword">auto</span> imax=(int)<a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(Rmax/T);</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> descriptors;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <a class="code" href="group__PDBinterface.html#gabf9520a0d03a1eda59392aa37d7fc56d">atomDescriptors</a>(atom, descriptors);</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>(2*imax+1);</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>.setXmippOrigin();</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=-imax; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;=imax; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    {</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        <span class="keywordtype">double</span> r=<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>*T;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)=<a class="code" href="group__PDBinterface.html#gac889ae4327c233fb8f01241f692c7d6f">electronFormFactorRealSpace</a>(r,descriptors);</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    }</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="comment">// Compute the optimal filter</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> filter;</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> bestPrm;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <a class="code" href="pdb_8cpp.html#a2d41c7d0e542972c688ed6237a509644">optimizeHlpf</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>, M, T, atom, filter, bestPrm);</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="comment">// Perform the convolution</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <a class="code" href="pdb_8cpp.html#a6404f5d19d22bd1f41927de5cafa6ca5">fhlpf</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>, filter, M, profile);</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="comment">// Remove zero values</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordtype">int</span> ileft=<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(profile);</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="keywordflow">if</span> (fabs(profile(ileft))&lt;1e-3)</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        <span class="keywordflow">for</span> (ileft=<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(profile)+1; ileft&lt;=0; ileft++)</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;            <span class="keywordflow">if</span> (fabs(profile(ileft))&gt;1e-3)</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <span class="keywordtype">int</span> iright=<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(profile);</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="keywordflow">if</span> (fabs(profile(iright))&lt;1e-3)</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        <span class="keywordflow">for</span> (iright=<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(profile)-1; iright&gt;=0; iright--)</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            <span class="keywordflow">if</span> (fabs(profile(iright))&gt;1e-3)</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    profile.<a class="code" href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">selfWindow</a>(ileft,iright);</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_ac78e0480644752604f2cd3089aeac804"><div class="ttname"><a href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">MultidimArray::selfWindow</a></div><div class="ttdeci">void selfWindow(int n0, int z0, int y0, int x0, int nF, int zF, int yF, int xF, T init_value=0)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00538">multidim_array.h:538</a></div></div>
<div class="ttc" id="group__PDBinterface_html_gac889ae4327c233fb8f01241f692c7d6f"><div class="ttname"><a href="group__PDBinterface.html#gac889ae4327c233fb8f01241f692c7d6f">electronFormFactorRealSpace</a></div><div class="ttdeci">double electronFormFactorRealSpace(double r, const Matrix1D&lt; double &gt; &amp;descriptors)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01080">pdb.cpp:1080</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00210">image_operate.cpp:210</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a633de4b0c14ca52ea2432a3c8a5c4c31"><div class="ttname"><a href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a></div><div class="ttdeci">double * f</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04414">numerical_recipes.cpp:4414</a></div></div>
<div class="ttc" id="group__PDBinterface_html_gabf9520a0d03a1eda59392aa37d7fc56d"><div class="ttname"><a href="group__PDBinterface.html#gabf9520a0d03a1eda59392aa37d7fc56d">atomDescriptors</a></div><div class="ttdeci">void atomDescriptors(const std::string &amp;atom, Matrix1D&lt; double &gt; &amp;descriptors)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00876">pdb.cpp:876</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a2d41c7d0e542972c688ed6237a509644"><div class="ttname"><a href="pdb_8cpp.html#a2d41c7d0e542972c688ed6237a509644">optimizeHlpf</a></div><div class="ttdeci">void optimizeHlpf(MultidimArray&lt; double &gt; &amp;f, int M, double T, const std::string &amp;atom, MultidimArray&lt; double &gt; &amp;filter, Matrix1D&lt; double &gt; &amp;bestPrm)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01278">pdb.cpp:1278</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a6404f5d19d22bd1f41927de5cafa6ca5"><div class="ttname"><a href="pdb_8cpp.html#a6404f5d19d22bd1f41927de5cafa6ca5">fhlpf</a></div><div class="ttdeci">void fhlpf(const MultidimArray&lt; double &gt; &amp;f, const MultidimArray&lt; double &gt; &amp;filter, int M, MultidimArray&lt; double &gt; &amp;convolution)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01127">pdb.cpp:1127</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a50420b85a6567099e12c4e0d5f8e3ea8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50420b85a6567099e12c4e0d5f8e3ea8">&#9670;&nbsp;</a></span>checkExtension()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool checkExtension </td>
          <td>(</td>
          <td class="paramtype">const std::filesystem::path &amp;&#160;</td>
          <td class="paramname"><em>filePath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::list&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>acceptedExtensions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::list&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>acceptedCompressions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if the file uses a supported extension type. </p>
<p>This function checks if the given file path has one of the given supported extensions, with or without compression in any of the accepted compressions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filePath</td><td>File including path. </td></tr>
    <tr><td class="paramname">acceptedExtensions</td><td>List of accepted extensions. </td></tr>
    <tr><td class="paramname">acceptedCompressions</td><td>List of accepted compressions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the extension is valid, false otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l00383">383</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                                                                                                                                                     {</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">// File extension is invalid by default </span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordtype">bool</span> validExtension = <span class="keyword">false</span>;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">// Checking if file extension is in accepted extensions with or without an accepted compression</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="selfile_8cpp.html#a68dd1e65dd7f866de1f6e9033bef9173">find</a>(acceptedExtensions.begin(), acceptedExtensions.end(), filePath.extension()) != acceptedExtensions.end()) {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="comment">// Accepted extension without compression</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        validExtension = <span class="keyword">true</span>;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="selfile_8cpp.html#a68dd1e65dd7f866de1f6e9033bef9173">find</a>(acceptedCompressions.begin(), acceptedCompressions.end(), filePath.extension()) != acceptedCompressions.end()) {</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            <span class="comment">// Accepted compression detected</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="comment">// Checking if next extension is valid</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="keyword">const</span> std::filesystem::path shortedPath = filePath.parent_path().u8string() + <span class="stringliteral">&quot;/&quot;</span> + filePath.stem().u8string();</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="selfile_8cpp.html#a68dd1e65dd7f866de1f6e9033bef9173">find</a>(acceptedExtensions.begin(), acceptedExtensions.end(), shortedPath.extension()) != acceptedExtensions.end()) {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                <span class="comment">// Accepted extension with compression</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                validExtension = <span class="keyword">true</span>;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    }</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="comment">// Returning calculated validity</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">return</span> validExtension;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;}</div><div class="ttc" id="selfile_8cpp_html_a68dd1e65dd7f866de1f6e9033bef9173"><div class="ttname"><a href="selfile_8cpp.html#a68dd1e65dd7f866de1f6e9033bef9173">find</a></div><div class="ttdeci">std::vector&lt; SelLine &gt;::iterator find(std::vector&lt; SelLine &gt; &amp;text, const std::string &amp;img_name)</div><div class="ttdef"><b>Definition:</b> <a href="selfile_8cpp_source.html#l00553">selfile.cpp:553</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6404f5d19d22bd1f41927de5cafa6ca5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6404f5d19d22bd1f41927de5cafa6ca5">&#9670;&nbsp;</a></span>fhlpf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fhlpf </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>filter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>convolution</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l01127">1127</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;{</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="comment">// Expand the two input signals</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="keywordtype">int</span> Nmax=<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(filter);</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> auxF;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> auxFilter;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    auxF=<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    auxFilter=filter;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    auxF.<a class="code" href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">selfWindow</a>(<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(f)-Nmax,<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(f)+Nmax);</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    auxFilter.<a class="code" href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">selfWindow</a>(<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(filter)-Nmax,<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(filter)+Nmax);</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="comment">// Convolve in Fourier</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; std::complex&lt;double&gt;</a> &gt; F;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; std::complex&lt;double&gt;</a> &gt; Filter;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <a class="code" href="group__Fourier.html#ga5fddf4cf6da360abdc8fd7d2f21fcbb9">FourierTransform</a>(auxF,F);</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <a class="code" href="group__Fourier.html#ga5fddf4cf6da360abdc8fd7d2f21fcbb9">FourierTransform</a>(auxFilter,Filter);</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    F*=Filter;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <span class="comment">// Correction for the double phase factor and the double</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="comment">// amplitude factor</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> K1=2*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>*(<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(auxFilter)-1);</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> K2=<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(auxFilter);</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    std::complex&lt;double&gt; aux;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keyword">auto</span> * ptrAux=(<span class="keywordtype">double</span>*)&amp;aux;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <a class="code" href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(F)</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    {</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(F),w);</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        <span class="keywordtype">double</span> arg=w*K1;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga343bb99185c21cb45ddf83ffa06f9198">sincos</a>(arg,ptrAux+1,ptrAux);</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        *ptrAux*=K2;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        *(ptrAux+1)*=K2;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(F,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)*=aux;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    }</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <a class="code" href="group__Fourier.html#gae4499c45aa160e02ddbba4aaae14dece">InverseFourierTransform</a>(F,convolution);</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    convolution.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_ac78e0480644752604f2cd3089aeac804"><div class="ttname"><a href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">MultidimArray::selfWindow</a></div><div class="ttdeci">void selfWindow(int n0, int z0, int y0, int x0, int nF, int zF, int yF, int xF, T init_value=0)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00538">multidim_array.h:538</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a97809f7244a28aaa1c26e29e6e3204ef"><div class="ttname"><a href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a></div><div class="ttdeci">#define A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00539">multidim_array_base.h:539</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a2b83edee7677c7a2b0a4e5ac99baa586"><div class="ttname"><a href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a></div><div class="ttdeci">doublereal * w</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02477">numerical_recipes.cpp:2477</a></div></div>
<div class="ttc" id="group__Fourier_html_gae4499c45aa160e02ddbba4aaae14dece"><div class="ttname"><a href="group__Fourier.html#gae4499c45aa160e02ddbba4aaae14dece">InverseFourierTransform</a></div><div class="ttdeci">void InverseFourierTransform(const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;in, MultidimArray&lt; double &gt; &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8cpp_source.html#l00155">xmipp_fft.cpp:155</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8cpp_source.html#l00200">multidim_array_base.cpp:200</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a633de4b0c14ca52ea2432a3c8a5c4c31"><div class="ttname"><a href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a></div><div class="ttdeci">double * f</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04414">numerical_recipes.cpp:4414</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00091">multidim_array_base.h:91</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga343bb99185c21cb45ddf83ffa06f9198"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga343bb99185c21cb45ddf83ffa06f9198">sincos</a></div><div class="ttdeci">void sincos(const MultidimArray&lt; double &gt; &amp;x, MultidimArray&lt; double &gt; &amp;s, MultidimArray&lt; double &gt; &amp;c)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00354">multidim_array.cpp:354</a></div></div>
<div class="ttc" id="group__Fourier_html_ga5fddf4cf6da360abdc8fd7d2f21fcbb9"><div class="ttname"><a href="group__Fourier.html#ga5fddf4cf6da360abdc8fd7d2f21fcbb9">FourierTransform</a></div><div class="ttdeci">void FourierTransform(const MultidimArray&lt; double &gt; &amp;in, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8cpp_source.html#l00124">xmipp_fft.cpp:124</a></div></div>
<div class="ttc" id="cuda__gpu__reconstruct__fourier_8cpp_html_ac914a5e7c4e25d78f31f6ec3b1a93c5c"><div class="ttname"><a href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a></div><div class="ttdeci">__device__ float FFT_IDX2DIGFREQ(int idx, int size)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gpu__reconstruct__fourier_8cpp_source.html#l00382">cuda_gpu_reconstruct_fourier.cpp:382</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_aa924a84ae5fbf0ba6b4052eb9d92ef60"><div class="ttname"><a href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00554">multidim_array_base.h:554</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a51457d7aed50e11bffd23e2504696f45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51457d7aed50e11bffd23e2504696f45">&#9670;&nbsp;</a></span>hlpf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hlpf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filterType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>filter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>reductionFactor</em> = <code>0.8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ripple</em> = <code>0.01</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltaw</em> = <code>1.0/8.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l01097">1097</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;{</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    filter.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(f));</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    filter.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="keyword">auto</span> Nmax=(int)<a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(M/2.0);</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordflow">if</span> (filterType==<span class="stringliteral">&quot;SimpleAveraging&quot;</span>)</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    {</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        <a class="code" href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(filter)</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)&lt;=Nmax)</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            filter(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)=1.0/(2*Nmax+1);</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    }</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (filterType==<span class="stringliteral">&quot;SincKaiser&quot;</span>)</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    {</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <span class="keywordtype">int</span> lastIdx=<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(filter);</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <a class="code" href="group__Masks.html#ga7289b52c50e1b5e8a8d500fe5e3d2ef0">SincKaiserMask</a>(filter,reductionFactor*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>/M,ripple,deltaw);</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <span class="keywordtype">int</span> newLastIdx=<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(filter);</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        <span class="keywordflow">if</span> (newLastIdx&gt;3*lastIdx)</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            filter.<a class="code" href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">selfWindow</a>(-lastIdx,lastIdx);</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        filter/=filter.<a class="code" href="classMultidimArray.html#aee20bc83b6b9c873a34a703a077fbfb9">sum</a>();</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(f)&gt;<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(filter))</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            filter.<a class="code" href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">selfWindow</a>(<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(f),<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(f));</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;            f.<a class="code" href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">selfWindow</a>(<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(filter),<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(filter));</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    }</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_ac78e0480644752604f2cd3089aeac804"><div class="ttname"><a href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">MultidimArray::selfWindow</a></div><div class="ttdeci">void selfWindow(int n0, int z0, int y0, int x0, int nF, int zF, int yF, int xF, T init_value=0)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00538">multidim_array.h:538</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8cpp_source.html#l00200">multidim_array_base.cpp:200</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00091">multidim_array_base.h:91</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_aa924a84ae5fbf0ba6b4052eb9d92ef60"><div class="ttname"><a href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00554">multidim_array_base.h:554</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02723">multidim_array.h:2723</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="classMultidimArray_html_aee20bc83b6b9c873a34a703a077fbfb9"><div class="ttname"><a href="classMultidimArray.html#aee20bc83b6b9c873a34a703a077fbfb9">MultidimArray::sum</a></div><div class="ttdeci">double sum() const</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03405">multidim_array.h:3405</a></div></div>
<div class="ttc" id="group__Masks_html_ga7289b52c50e1b5e8a8d500fe5e3d2ef0"><div class="ttname"><a href="group__Masks.html#ga7289b52c50e1b5e8a8d500fe5e3d2ef0">SincKaiserMask</a></div><div class="ttdeci">void SincKaiserMask(MultidimArray&lt; double &gt; &amp;mask, double omega, double delta, double Deltaw)</div><div class="ttdef"><b>Definition:</b> <a href="mask_8cpp_source.html#l00139">mask.cpp:139</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a53200812640bf6ecfcf3dd8e87fd8725"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53200812640bf6ecfcf3dd8e87fd8725">&#9670;&nbsp;</a></span>Hlpf_fitness()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Hlpf_fitness </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>prm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l01174">1174</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;{</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keywordtype">double</span> reductionFactor=p[1];</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordtype">double</span> ripple=p[2];</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keywordtype">double</span> deltaw=p[3];</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="keywordflow">if</span> (reductionFactor&lt;0.7 || reductionFactor&gt;1.3)</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        <span class="keywordflow">return</span> 1e38;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keywordflow">if</span> (ripple&lt;0 || ripple&gt;0.2)</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        <span class="keywordflow">return</span> 1e38;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="keywordflow">if</span> (deltaw&lt;1e-3 || deltaw&gt;0.2)</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        <span class="keywordflow">return</span> 1e38;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="comment">// Construct the filter with the current parameters</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> filter;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> auxf;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    auxf=<a class="code" href="pdb_8cpp.html#a03670ad2c03f04f1be8646970b6dc8dd">globalf</a>;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <a class="code" href="pdb_8cpp.html#a51457d7aed50e11bffd23e2504696f45">hlpf</a>(auxf, <a class="code" href="pdb_8cpp.html#ac1fe23303abe1c0c359bc1bfc59a5774">globalM</a>, <span class="stringliteral">&quot;SincKaiser&quot;</span>, filter, reductionFactor,</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;         ripple, deltaw);</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="comment">// Convolve the filter with the atomic profile</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> fhlpfFinelySampled;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <a class="code" href="pdb_8cpp.html#a6404f5d19d22bd1f41927de5cafa6ca5">fhlpf</a>(auxf, filter, <a class="code" href="pdb_8cpp.html#ac1fe23303abe1c0c359bc1bfc59a5774">globalM</a>, fhlpfFinelySampled);</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="comment">// Coarsely sample</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keywordtype">double</span> Rmax=<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(fhlpfFinelySampled)*<a class="code" href="pdb_8cpp.html#a70cffbaf2c91fc9c77305106b3b88d62">globalT</a>;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="keywordtype">int</span> imax=<a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(Rmax/(<a class="code" href="pdb_8cpp.html#ac1fe23303abe1c0c359bc1bfc59a5774">globalM</a>*<a class="code" href="pdb_8cpp.html#a70cffbaf2c91fc9c77305106b3b88d62">globalT</a>));</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> fhlpfCoarselySampled(2*imax+1);</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> splineCoeffsfhlpfFinelySampled;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga098f5c8e7e9c010a3bf7ab82e31828a8">produceSplineCoefficients</a>(<a class="code" href="namespacexmipp__transformation.html#ac5f2bd2937d73c34ed4f6c6c5ff2492aac8f522643bcb55d76296b48480a99c44">xmipp_transformation::BSPLINE3</a>,splineCoeffsfhlpfFinelySampled,fhlpfFinelySampled);</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    fhlpfCoarselySampled.setXmippOrigin();</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <a class="code" href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(fhlpfCoarselySampled)</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    {</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        <span class="keywordtype">double</span> r=<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>*(<a class="code" href="pdb_8cpp.html#ac1fe23303abe1c0c359bc1bfc59a5774">globalM</a>*<a class="code" href="pdb_8cpp.html#a70cffbaf2c91fc9c77305106b3b88d62">globalT</a>)/<a class="code" href="pdb_8cpp.html#a70cffbaf2c91fc9c77305106b3b88d62">globalT</a>;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        fhlpfCoarselySampled(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)=</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;            splineCoeffsfhlpfFinelySampled.<a class="code" href="classMultidimArray.html#af9d3366f28a3aa658ea8fb252214f673">interpolatedElementBSpline1D</a>(r,3);</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    }</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="comment">// Build the frequency response of the convolved and coarsely sampled</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="comment">// atom</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> aux;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> FfilterMag;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> freq;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; std::complex&lt;double&gt;</a> &gt; Ffilter;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    aux=fhlpfCoarselySampled;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    aux.<a class="code" href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">selfWindow</a>(-10*<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(aux),10*<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(aux));</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <a class="code" href="group__Fourier.html#ga5fddf4cf6da360abdc8fd7d2f21fcbb9">FourierTransform</a>(aux,Ffilter);</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <a class="code" href="group__FourierW.html#ga1075fe73c87077296a879f44ded3a2c3">FFT_magnitude</a>(Ffilter,FfilterMag);</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    freq.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Ffilter));</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <a class="code" href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(FfilterMag)</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(FfilterMag),freq(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    freq/=<a class="code" href="pdb_8cpp.html#ac1fe23303abe1c0c359bc1bfc59a5774">globalM</a>*<a class="code" href="pdb_8cpp.html#a70cffbaf2c91fc9c77305106b3b88d62">globalT</a>;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordtype">double</span> amplitudeFactor=fhlpfFinelySampled.<a class="code" href="classMultidimArray.html#aee20bc83b6b9c873a34a703a077fbfb9">sum</a>()/</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                           fhlpfCoarselySampled.sum();</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <span class="comment">// Compute the error in representation</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="namespaceerror.html">error</a>=0;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> descriptors;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <a class="code" href="group__PDBinterface.html#gabf9520a0d03a1eda59392aa37d7fc56d">atomDescriptors</a>(<a class="code" href="pdb_8cpp.html#a2d5905ca42e031c3d91374c6eee83486">globalAtom</a>, descriptors);</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="keywordtype">double</span> iglobalT=1.0/<a class="code" href="pdb_8cpp.html#a70cffbaf2c91fc9c77305106b3b88d62">globalT</a>;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> f1array, f2array;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    f1array.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(FfilterMag);</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    f2array.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(FfilterMag);</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="keywordtype">double</span> Npoints=0;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <a class="code" href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(FfilterMag)</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(freq,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)&gt;=0)</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    {</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        <span class="keywordtype">double</span> f1=<a class="code" href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a>(<a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(FfilterMag,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)*<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(FfilterMag)*amplitudeFactor);</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        <span class="keywordtype">double</span> f2=<a class="code" href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a>(iglobalT*</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                           <a class="code" href="group__PDBinterface.html#ga9fffa8bfe3a2f60ab76ae5375321e33d">electronFormFactorFourier</a>(<a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(freq,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>),descriptors));</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        Npoints++;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <span class="keywordtype">double</span> diff=(f1-f2);</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        error+=diff*diff;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        f1array(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)=f1;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        f2array(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)=f2;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;i=&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot; wi=&quot;</span> &lt;&lt; <a class="code" href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(freq,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; f1=&quot;</span> &lt;&lt; f1 &lt;&lt; <span class="stringliteral">&quot; f2=&quot;</span> &lt;&lt; f2 &lt;&lt; <span class="stringliteral">&quot; diff=&quot;</span> &lt;&lt; diff &lt;&lt; <span class="stringliteral">&quot; err2=&quot;</span> &lt;&lt; diff*diff &lt;&lt; std::endl;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    }</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        f1array.<a class="code" href="classMultidimArray.html#a42596ccc34c8e8c71cf6d4d92804dc45">write</a>(<span class="stringliteral">&quot;PPPf1.txt&quot;</span>);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        f2array.<a class="code" href="classMultidimArray.html#a42596ccc34c8e8c71cf6d4d92804dc45">write</a>(<span class="stringliteral">&quot;PPPf2.txt&quot;</span>);</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Error &quot;</span> &lt;&lt; error/Npoints &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; Npoints &lt;&lt; <span class="stringliteral">&quot; M=&quot;</span> &lt;&lt; <a class="code" href="pdb_8cpp.html#ac1fe23303abe1c0c359bc1bfc59a5774">globalM</a> &lt;&lt; <span class="stringliteral">&quot; T=&quot;</span> &lt;&lt; globalT &lt;&lt; std::endl;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <span class="keywordflow">return</span> error/Npoints;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_ac78e0480644752604f2cd3089aeac804"><div class="ttname"><a href="classMultidimArray.html#ac78e0480644752604f2cd3089aeac804">MultidimArray::selfWindow</a></div><div class="ttdeci">void selfWindow(int n0, int z0, int y0, int x0, int nF, int zF, int yF, int xF, T init_value=0)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00538">multidim_array.h:538</a></div></div>
<div class="ttc" id="classMultidimArray_html_af9d3366f28a3aa658ea8fb252214f673"><div class="ttname"><a href="classMultidimArray.html#af9d3366f28a3aa658ea8fb252214f673">MultidimArray::interpolatedElementBSpline1D</a></div><div class="ttdeci">T interpolatedElementBSpline1D(double x, int SplineDegree=3) const</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00760">multidim_array.cpp:760</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a51457d7aed50e11bffd23e2504696f45"><div class="ttname"><a href="pdb_8cpp.html#a51457d7aed50e11bffd23e2504696f45">hlpf</a></div><div class="ttdeci">void hlpf(MultidimArray&lt; double &gt; &amp;f, int M, const std::string &amp;filterType, MultidimArray&lt; double &gt; &amp;filter, double reductionFactor=0.8, double ripple=0.01, double deltaw=1.0/8.0)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01097">pdb.cpp:1097</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a03670ad2c03f04f1be8646970b6dc8dd"><div class="ttname"><a href="pdb_8cpp.html#a03670ad2c03f04f1be8646970b6dc8dd">globalf</a></div><div class="ttdeci">MultidimArray&lt; double &gt; globalf</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01168">pdb.cpp:1168</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a97809f7244a28aaa1c26e29e6e3204ef"><div class="ttname"><a href="multidim__array__base_8h.html#a97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a></div><div class="ttdeci">#define A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00539">multidim_array_base.h:539</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="pdb_8cpp_html_ac1fe23303abe1c0c359bc1bfc59a5774"><div class="ttname"><a href="pdb_8cpp.html#ac1fe23303abe1c0c359bc1bfc59a5774">globalM</a></div><div class="ttdeci">int globalM</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01169">pdb.cpp:1169</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga098f5c8e7e9c010a3bf7ab82e31828a8"><div class="ttname"><a href="group__GeometricalTransformations.html#ga098f5c8e7e9c010a3bf7ab82e31828a8">produceSplineCoefficients</a></div><div class="ttdeci">void produceSplineCoefficients(int SplineDegree, MultidimArray&lt; double &gt; &amp;coeffs, const MultidimArray&lt; T &gt; &amp;V1)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00041">transformations.cpp:41</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00091">multidim_array_base.h:91</a></div></div>
<div class="ttc" id="classMultidimArray_html_a42596ccc34c8e8c71cf6d4d92804dc45"><div class="ttname"><a href="classMultidimArray.html#a42596ccc34c8e8c71cf6d4d92804dc45">MultidimArray::write</a></div><div class="ttdeci">void write(const FileName &amp;fn) const</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00970">multidim_array.cpp:970</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a70cffbaf2c91fc9c77305106b3b88d62"><div class="ttname"><a href="pdb_8cpp.html#a70cffbaf2c91fc9c77305106b3b88d62">globalT</a></div><div class="ttdeci">double globalT</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01170">pdb.cpp:1170</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_a3aadc7a86770372bb401fbcb4c05a252"><div class="ttname"><a href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a></div><div class="ttdeci">void log10(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00237">image_operate.cpp:237</a></div></div>
<div class="ttc" id="group__Fourier_html_ga5fddf4cf6da360abdc8fd7d2f21fcbb9"><div class="ttname"><a href="group__Fourier.html#ga5fddf4cf6da360abdc8fd7d2f21fcbb9">FourierTransform</a></div><div class="ttdeci">void FourierTransform(const MultidimArray&lt; double &gt; &amp;in, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8cpp_source.html#l00124">xmipp_fft.cpp:124</a></div></div>
<div class="ttc" id="group__PDBinterface_html_ga9fffa8bfe3a2f60ab76ae5375321e33d"><div class="ttname"><a href="group__PDBinterface.html#ga9fffa8bfe3a2f60ab76ae5375321e33d">electronFormFactorFourier</a></div><div class="ttdeci">double electronFormFactorFourier(double f, const Matrix1D&lt; double &gt; &amp;descriptors)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01052">pdb.cpp:1052</a></div></div>
<div class="ttc" id="group__PDBinterface_html_gabf9520a0d03a1eda59392aa37d7fc56d"><div class="ttname"><a href="group__PDBinterface.html#gabf9520a0d03a1eda59392aa37d7fc56d">atomDescriptors</a></div><div class="ttdeci">void atomDescriptors(const std::string &amp;atom, Matrix1D&lt; double &gt; &amp;descriptors)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l00876">pdb.cpp:876</a></div></div>
<div class="ttc" id="cuda__gpu__reconstruct__fourier_8cpp_html_ac914a5e7c4e25d78f31f6ec3b1a93c5c"><div class="ttname"><a href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a></div><div class="ttdeci">__device__ float FFT_IDX2DIGFREQ(int idx, int size)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gpu__reconstruct__fourier_8cpp_source.html#l00382">cuda_gpu_reconstruct_fourier.cpp:382</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a6404f5d19d22bd1f41927de5cafa6ca5"><div class="ttname"><a href="pdb_8cpp.html#a6404f5d19d22bd1f41927de5cafa6ca5">fhlpf</a></div><div class="ttdeci">void fhlpf(const MultidimArray&lt; double &gt; &amp;f, const MultidimArray&lt; double &gt; &amp;filter, int M, MultidimArray&lt; double &gt; &amp;convolution)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01127">pdb.cpp:1127</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_aa924a84ae5fbf0ba6b4052eb9d92ef60"><div class="ttname"><a href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00554">multidim_array_base.h:554</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="namespaceerror_html"><div class="ttname"><a href="namespaceerror.html">error</a></div><div class="ttdef"><b>Definition:</b> <a href="pdb2cif_8cpp_source.html#l00049">pdb2cif.cpp:49</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02723">multidim_array.h:2723</a></div></div>
<div class="ttc" id="group__FourierW_html_ga1075fe73c87077296a879f44ded3a2c3"><div class="ttname"><a href="group__FourierW.html#ga1075fe73c87077296a879f44ded3a2c3">FFT_magnitude</a></div><div class="ttdeci">void FFT_magnitude(const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;v, MultidimArray&lt; double &gt; &amp;mag)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00393">xmipp_fftw.cpp:393</a></div></div>
<div class="ttc" id="classMultidimArray_html_aee20bc83b6b9c873a34a703a077fbfb9"><div class="ttname"><a href="classMultidimArray.html#aee20bc83b6b9c873a34a703a077fbfb9">MultidimArray::sum</a></div><div class="ttdeci">double sum() const</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03405">multidim_array.h:3405</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a2d5905ca42e031c3d91374c6eee83486"><div class="ttname"><a href="pdb_8cpp.html#a2d5905ca42e031c3d91374c6eee83486">globalAtom</a></div><div class="ttdeci">std::string globalAtom</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01171">pdb.cpp:1171</a></div></div>
<div class="ttc" id="namespacexmipp__transformation_html_ac5f2bd2937d73c34ed4f6c6c5ff2492aac8f522643bcb55d76296b48480a99c44"><div class="ttname"><a href="namespacexmipp__transformation.html#ac5f2bd2937d73c34ed4f6c6c5ff2492aac8f522643bcb55d76296b48480a99c44">xmipp_transformation::BSPLINE3</a></div><div class="ttdef"><b>Definition:</b> <a href="transformations__defines_8h_source.html#l00032">transformations_defines.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab8248f1cc700e7409a9e5dc6a9f80212"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8248f1cc700e7409a9e5dc6a9f80212">&#9670;&nbsp;</a></span>hy36decode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* hy36decode </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>s_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>hybrid-36 decoder: converts string s to integer result width: must be 4 (e.g. for residue sequence numbers) or 5 (e.g. for atom serial numbers) s: string to be converted does not have to be null-terminated s_size: size of s must be equal to width, or an error message is returned otherwise result: integer holding the conversion result return value: pointer to error message, if any, or 0 on success Example usage (from C++): int result; const char* errmsg = hy36decode(width, "A1T5", 4, &amp;result); if (errmsg) throw std::runtime_error(errmsg); </p>

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l01885">1885</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;{</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> first_call = 1;</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> digits_values_upper[128U];</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> digits_values_lower[128U];</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>*</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    ie_range = <span class="stringliteral">&quot;internal error hy36decode: integer value out of range.&quot;</span>;</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ab96fca79aa45e2e22226e5938e235299">di</a>;</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span>* errmsg;</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;  <span class="keywordflow">if</span> (first_call) {</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    first_call = 0;</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    <span class="keywordflow">for</span>(i=0;i&lt;128U;i++) digits_values_upper[i] = -1;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <span class="keywordflow">for</span>(i=0;i&lt;128U;i++) digits_values_lower[i] = -1;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <span class="keywordflow">for</span>(i=0;i&lt;36U;i++) {</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;      di = digits_upper()[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      <span class="keywordflow">if</span> (di &lt; 0 || di &gt; 127) {</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;        *result = 0;</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;        <span class="keywordflow">return</span> ie_range;</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;      }</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      digits_values_upper[<a class="code" href="numerical__recipes_8cpp.html#ab96fca79aa45e2e22226e5938e235299">di</a>] = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    }</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    <span class="keywordflow">for</span>(i=0;i&lt;36U;i++) {</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;      di = digits_lower()[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;      <span class="keywordflow">if</span> (di &lt; 0 || di &gt; 127) {</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;        *result = 0;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        <span class="keywordflow">return</span> ie_range;</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      }</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      digits_values_lower[<a class="code" href="numerical__recipes_8cpp.html#ab96fca79aa45e2e22226e5938e235299">di</a>] = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    }</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;  }</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;  <span class="keywordflow">if</span> (s_size == width) {</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    di = s[0];</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    <span class="keywordflow">if</span> (di &gt;= 0 &amp;&amp; di &lt;= 127) {</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;      <span class="keywordflow">if</span> (digits_values_upper[di] &gt;= 10) {</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;        errmsg = decode_pure(digits_values_upper, 36U, s, s_size, result);</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        <span class="keywordflow">if</span> (errmsg == 0) {</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;          <span class="comment">/* result - 10*36**(width-1) + 10**width */</span></div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;          <span class="keywordflow">if</span>      (width == 4U) (*result) -= 456560;</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (width == 5U) (*result) -= 16696160;</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;          <span class="keywordflow">else</span> {</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;            *result = 0;</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;            <span class="keywordflow">return</span> unsupported_width();</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;          }</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;          <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        }</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;      }</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (digits_values_lower[di] &gt;= 10) {</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        errmsg = decode_pure(digits_values_lower, 36U, s, s_size, result);</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;        <span class="keywordflow">if</span> (errmsg == 0) {</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;          <span class="comment">/* result + 16*36**(width-1) + 10**width */</span></div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;          <span class="keywordflow">if</span>      (width == 4U) (*result) += 756496;</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (width == 5U) (*result) += 26973856;</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;          <span class="keywordflow">else</span> {</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;            *result = 0;</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;            <span class="keywordflow">return</span> unsupported_width();</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;          }</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;          <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        }</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;      }</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        errmsg = decode_pure(digits_values_upper, 10U, s, s_size, result);</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        <span class="keywordflow">if</span> (errmsg) <span class="keywordflow">return</span> errmsg;</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;        <span class="keywordflow">if</span> (!(width == 4U || width == 5U)) {</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;          *result = 0;</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;          <span class="keywordflow">return</span> unsupported_width();</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        }</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;      }</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    }</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  }</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;  *result = 0;</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;  <span class="keywordflow">return</span> invalid_number_literal();</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_ab96fca79aa45e2e22226e5938e235299"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab96fca79aa45e2e22226e5938e235299">di</a></div><div class="ttdeci">double * di</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05168">numerical_recipes.cpp:5168</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a415a71241b7fb6d35414b002656156f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a415a71241b7fb6d35414b002656156f9">&#9670;&nbsp;</a></span>hy36decodeSafe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hy36decodeSafe </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>s_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l01961">1961</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;{</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <span class="keyword">auto</span>* errmsg = <a class="code" href="pdb_8cpp.html#ab8248f1cc700e7409a9e5dc6a9f80212">hy36decode</a>(width, s, s_size, result); </div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="keywordflow">if</span> (errmsg) {</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a>, errmsg);</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    }</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00211">xmipp_error.h:211</a></div></div>
<div class="ttc" id="pdb_8cpp_html_ab8248f1cc700e7409a9e5dc6a9f80212"><div class="ttname"><a href="pdb_8cpp.html#ab8248f1cc700e7409a9e5dc6a9f80212">hy36decode</a></div><div class="ttdeci">const char * hy36decode(unsigned width, const char *s, unsigned s_size, int *result)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01885">pdb.cpp:1885</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a></div><div class="ttdoc">Incorrect value received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00195">xmipp_error.h:195</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a585418e13971c1ebd38e73af4d76d6a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a585418e13971c1ebd38e73af4d76d6a2">&#9670;&nbsp;</a></span>hy36encode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* hy36encode </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>hybrid-36 encoder: converts integer value to string result width: must be 4 (e.g. for residue sequence numbers) or 5 (e.g. for atom serial numbers) value: integer value to be converted result: pointer to char array of size width+1 or greater on return result is null-terminated return value: pointer to error message, if any, or 0 on success Example usage (from C++): char result[4+1]; const char* errmsg = hy36encode(4, 12345, result); if (errmsg) throw std::runtime_error(errmsg); </p>

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l01817">1817</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;{</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = value;</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  <span class="keywordflow">if</span> (width == 4U) {</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    <span class="keywordflow">if</span> (i &gt;= -999) {</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;      <span class="keywordflow">if</span> (i &lt; 10000) {</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        encode_pure(digits_upper(), 10U, 4U, i, result);</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;      }</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;      i -= 10000;</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;      <span class="keywordflow">if</span> (i &lt; 1213056 <span class="comment">/* 26*36**3 */</span>) {</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        i += 466560 <span class="comment">/* 10*36**3 */</span>;</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;        encode_pure(digits_upper(), 36U, 0U, i, result);</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;      }</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;      i -= 1213056;</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;      <span class="keywordflow">if</span> (i &lt; 1213056) {</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;        i += 466560;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;        encode_pure(digits_lower(), 36U, 0U, i, result);</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;      }</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    }</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  }</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (width == 5U) {</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="keywordflow">if</span> (i &gt;= -9999) {</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;      <span class="keywordflow">if</span> (i &lt; 100000) {</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        encode_pure(digits_upper(), 10U, 5U, i, result);</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;      }</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      i -= 100000;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;      <span class="keywordflow">if</span> (i &lt; 43670016 <span class="comment">/* 26*36**4 */</span>) {</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;        i += 16796160 <span class="comment">/* 10*36**4 */</span>;</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;        encode_pure(digits_upper(), 36U, 0U, i, result);</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;      }</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;      i -= 43670016;</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      <span class="keywordflow">if</span> (i &lt; 43670016) {</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;        i += 16796160;</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;        encode_pure(digits_lower(), 36U, 0U, i, result);</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;      }</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    }</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  }</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    fill_with_stars(width, result);</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    <span class="keywordflow">return</span> unsupported_width();</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;  }</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;  fill_with_stars(width, result);</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;  <span class="keywordflow">return</span> value_out_of_range();</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;}</div><div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c7461f600f53acbcb1d4091b3968b9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c7461f600f53acbcb1d4091b3968b9b">&#9670;&nbsp;</a></span>hy36encodeSafe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hy36encodeSafe </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l01970">1970</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;{</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* errmsg = <a class="code" href="pdb_8cpp.html#a585418e13971c1ebd38e73af4d76d6a2">hy36encode</a>(width, value, result); </div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    <span class="keywordflow">if</span> (errmsg) {</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a>, errmsg);</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    }</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;}</div><div class="ttc" id="pdb_8cpp_html_a585418e13971c1ebd38e73af4d76d6a2"><div class="ttname"><a href="pdb_8cpp.html#a585418e13971c1ebd38e73af4d76d6a2">hy36encode</a></div><div class="ttdeci">const char * hy36encode(unsigned width, int value, char *result)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01817">pdb.cpp:1817</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00211">xmipp_error.h:211</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a></div><div class="ttdoc">Incorrect value received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00195">xmipp_error.h:195</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2d41c7d0e542972c688ed6237a509644"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d41c7d0e542972c688ed6237a509644">&#9670;&nbsp;</a></span>optimizeHlpf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void optimizeHlpf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>atom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>filter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>bestPrm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Optimize the low pass filter. The optimization is so that the Fourier response of the coarsely downsampled and convolved atom profile resembles as much as possible the ideal atomic response up to the maximum frequency provided by the Nyquist frequency associated to M*T.</p>
<p>f is the electron scattering factor in real space sampled at a sampling rate T. M is the downsampling factor. atom is the name of the atom being optimized. filter is an output parameter with the optimal impulse response sampled at a sampling rate T. bestPrm(0)=reduction function of the cutoff frequency, bestPrm(1)=ripple of the Kaiser selfWindow, bestPrm(2)=deltaw of the Kaiser selfWindow. </p>

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l01278">1278</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;{</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <a class="code" href="pdb_8cpp.html#aab664bf51f4d185f6d849d750ac86fee">globalHlpfPrm</a>(0)=1.0;     <span class="comment">// reduction factor</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <a class="code" href="pdb_8cpp.html#aab664bf51f4d185f6d849d750ac86fee">globalHlpfPrm</a>(1)=0.01;    <span class="comment">// ripple</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <a class="code" href="pdb_8cpp.html#aab664bf51f4d185f6d849d750ac86fee">globalHlpfPrm</a>(2)=1.0/8.0; <span class="comment">// deltaw</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <a class="code" href="pdb_8cpp.html#a03670ad2c03f04f1be8646970b6dc8dd">globalf</a>=<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <a class="code" href="pdb_8cpp.html#ac1fe23303abe1c0c359bc1bfc59a5774">globalM</a>=M;</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <a class="code" href="pdb_8cpp.html#a70cffbaf2c91fc9c77305106b3b88d62">globalT</a>=T;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <a class="code" href="pdb_8cpp.html#a2d5905ca42e031c3d91374c6eee83486">globalAtom</a>=atom;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="volume__align__prog_8cpp.html#a8b50613ae00d92ad08f3d5481b2fe213">fitness</a>;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a4155d511de81aa816513aa52de01d931">iter</a>;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#a2de5b01a4efcb9b1582bb2947efc6bad">steps</a>(3);</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a2de5b01a4efcb9b1582bb2947efc6bad">steps</a>.initConstant(1);</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <a class="code" href="numerical__tools_8cpp.html#aa75684a0e8adbe5ee59bfd1540907ab3">powellOptimizer</a>(<a class="code" href="pdb_8cpp.html#aab664bf51f4d185f6d849d750ac86fee">globalHlpfPrm</a>, 1, 3,</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                    &amp;<a class="code" href="pdb_8cpp.html#a53200812640bf6ecfcf3dd8e87fd8725">Hlpf_fitness</a>, <span class="keyword">nullptr</span>, 0.05, fitness, iter, <a class="code" href="numerical__recipes_8cpp.html#a2de5b01a4efcb9b1582bb2947efc6bad">steps</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    bestPrm=<a class="code" href="pdb_8cpp.html#aab664bf51f4d185f6d849d750ac86fee">globalHlpfPrm</a>;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <a class="code" href="pdb_8cpp.html#a51457d7aed50e11bffd23e2504696f45">hlpf</a>(f, M, <span class="stringliteral">&quot;SincKaiser&quot;</span>, filter, bestPrm(0), bestPrm(1), bestPrm(2));</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;}</div><div class="ttc" id="pdb_8cpp_html_a51457d7aed50e11bffd23e2504696f45"><div class="ttname"><a href="pdb_8cpp.html#a51457d7aed50e11bffd23e2504696f45">hlpf</a></div><div class="ttdeci">void hlpf(MultidimArray&lt; double &gt; &amp;f, int M, const std::string &amp;filterType, MultidimArray&lt; double &gt; &amp;filter, double reductionFactor=0.8, double ripple=0.01, double deltaw=1.0/8.0)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01097">pdb.cpp:1097</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a03670ad2c03f04f1be8646970b6dc8dd"><div class="ttname"><a href="pdb_8cpp.html#a03670ad2c03f04f1be8646970b6dc8dd">globalf</a></div><div class="ttdeci">MultidimArray&lt; double &gt; globalf</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01168">pdb.cpp:1168</a></div></div>
<div class="ttc" id="numerical__tools_8cpp_html_aa75684a0e8adbe5ee59bfd1540907ab3"><div class="ttname"><a href="numerical__tools_8cpp.html#aa75684a0e8adbe5ee59bfd1540907ab3">powellOptimizer</a></div><div class="ttdeci">void powellOptimizer(Matrix1D&lt; double &gt; &amp;p, int i0, int n, double(*f)(double *x, void *), void *prm, double ftol, double &amp;fret, int &amp;iter, const Matrix1D&lt; double &gt; &amp;steps, bool show)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__tools_8cpp_source.html#l00044">numerical_tools.cpp:44</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a4155d511de81aa816513aa52de01d931"><div class="ttname"><a href="numerical__recipes_8cpp.html#a4155d511de81aa816513aa52de01d931">iter</a></div><div class="ttdeci">glob_prnt iter</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04698">numerical_recipes.cpp:4698</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a53200812640bf6ecfcf3dd8e87fd8725"><div class="ttname"><a href="pdb_8cpp.html#a53200812640bf6ecfcf3dd8e87fd8725">Hlpf_fitness</a></div><div class="ttdeci">double Hlpf_fitness(double *p, void *prm)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01174">pdb.cpp:1174</a></div></div>
<div class="ttc" id="pdb_8cpp_html_ac1fe23303abe1c0c359bc1bfc59a5774"><div class="ttname"><a href="pdb_8cpp.html#ac1fe23303abe1c0c359bc1bfc59a5774">globalM</a></div><div class="ttdeci">int globalM</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01169">pdb.cpp:1169</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a633de4b0c14ca52ea2432a3c8a5c4c31"><div class="ttname"><a href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a></div><div class="ttdeci">double * f</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04414">numerical_recipes.cpp:4414</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a70cffbaf2c91fc9c77305106b3b88d62"><div class="ttname"><a href="pdb_8cpp.html#a70cffbaf2c91fc9c77305106b3b88d62">globalT</a></div><div class="ttdeci">double globalT</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01170">pdb.cpp:1170</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a2de5b01a4efcb9b1582bb2947efc6bad"><div class="ttname"><a href="numerical__recipes_8cpp.html#a2de5b01a4efcb9b1582bb2947efc6bad">steps</a></div><div class="ttdeci">double steps</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05166">numerical_recipes.cpp:5166</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="pdb_8cpp_html_aab664bf51f4d185f6d849d750ac86fee"><div class="ttname"><a href="pdb_8cpp.html#aab664bf51f4d185f6d849d750ac86fee">globalHlpfPrm</a></div><div class="ttdeci">Matrix1D&lt; double &gt; globalHlpfPrm(3)</div></div>
<div class="ttc" id="volume__align__prog_8cpp_html_a8b50613ae00d92ad08f3d5481b2fe213"><div class="ttname"><a href="volume__align__prog_8cpp.html#a8b50613ae00d92ad08f3d5481b2fe213">fitness</a></div><div class="ttdeci">double fitness(double *p)</div><div class="ttdef"><b>Definition:</b> <a href="volume__align__prog_8cpp_source.html#l00088">volume_align_prog.cpp:88</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a2d5905ca42e031c3d91374c6eee83486"><div class="ttname"><a href="pdb_8cpp.html#a2d5905ca42e031c3d91374c6eee83486">globalAtom</a></div><div class="ttdeci">std::string globalAtom</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01171">pdb.cpp:1171</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a276bb08cb169758db38719569831c899"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a276bb08cb169758db38719569831c899">&#9670;&nbsp;</a></span>projectAtom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void projectAtom </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classAtom.html">Atom</a> &amp;&#160;</td>
          <td class="paramname"><em>atom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>VP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>PV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAtomInterpolator.html">AtomInterpolator</a> &amp;&#160;</td>
          <td class="paramname"><em>interpolator</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structPDB.html">PDB</a> projection ------------------------------------------------------&mdash; </p>

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l01439">1439</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;{</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;constexpr <span class="keywordtype">float</span> SUBSAMPLING = 2;                  <span class="comment">// for every measure 2x2 line</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="comment">// integrals will be taken to</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="comment">// avoid numerical errors</span></div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;constexpr <span class="keywordtype">float</span> SUBSTEP = 1/(SUBSAMPLING*2.0);</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> origin(3);</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="group__FringeProcessing.html#gad71cd7f2325be81202279ed730355092">direction</a>;</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    VP.<a class="code" href="classMatrix2D.html#a9e4bd9c27982c0d7775f3804bf021687">getRow</a>(2, direction);</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    direction.<a class="code" href="classMatrix1D.html#af8b6ea8f86fcf69738d37b3336f536af">selfTranspose</a>();</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> corner1(3);</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> corner2(3);</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> act(3);</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <a class="code" href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a>;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="comment">// Find center of the feature in the projection plane ...................</span></div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="comment">// Step 1). Project the center to the plane, the result is in the</span></div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <span class="comment">//          universal coord system</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> Center(3);</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(Center, atom.<a class="code" href="classAtom.html#a382da4a2a8d20faa2fd1eca986f44056">x</a>, atom.<a class="code" href="classAtom.html#aab210323240ea76e6f866113e590cd22">y</a>, atom.<a class="code" href="classAtom.html#af1c8b6cd65e2a489b9be339efd7a77ac">z</a>);</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <span class="keywordtype">double</span> max_distance=interpolator.<a class="code" href="classAtomInterpolator.html#a3da6490c9d90461cacdf8a9be6627dcd">atomRadius</a>(atom.<a class="code" href="classAtom.html#a7d9721acafaa5d67ee744348e81235c7">atomType</a>);</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <a class="code" href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a>(origin, VP, Center);</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    <span class="comment">//#define DEBUG_LITTLE</span></div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Actual atom\n&quot;</span>        &lt;&lt; atom.<a class="code" href="classAtom.html#a7d9721acafaa5d67ee744348e81235c7">atomType</a> &lt;&lt; <span class="stringliteral">&quot; (&quot;</span></div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    &lt;&lt; atom.<a class="code" href="classAtom.html#a382da4a2a8d20faa2fd1eca986f44056">x</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; atom.<a class="code" href="classAtom.html#aab210323240ea76e6f866113e590cd22">y</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; atom.<a class="code" href="classAtom.html#af1c8b6cd65e2a489b9be339efd7a77ac">z</a> &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Center              &quot;</span> &lt;&lt; Center.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;VP matrix\n&quot;</span>          &lt;&lt; VP &lt;&lt; std::endl;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;P.direction         &quot;</span> &lt;&lt; P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>.<a class="code" href="classMatrix1D.html#a028505ebdeaf6f62d884c31dcd5127a8">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;direction           &quot;</span> &lt;&lt; direction.<a class="code" href="classMatrix1D.html#a028505ebdeaf6f62d884c31dcd5127a8">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;P.euler matrix      &quot;</span> &lt;&lt; P.<a class="code" href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">euler</a> &lt;&lt; std::endl;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;max_distance        &quot;</span> &lt;&lt; max_distance &lt;&lt; std::endl;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;origin              &quot;</span> &lt;&lt; origin.<a class="code" href="classMatrix2D.html#a8073200797ec6121b2ad960f6a41f52a">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    <span class="comment">// Find limits for projection ...........................................</span></div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="comment">// Choose corners for the projection of this feature. It is supposed</span></div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="comment">// to have at the worst case a projection of size max_distance</span></div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(corner1, max_distance, max_distance, max_distance);</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(corner2, -max_distance, -max_distance, -max_distance);</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Corner1 : &quot;</span> &lt;&lt; corner1.transpose() &lt;&lt; std::endl</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Corner2 : &quot;</span> &lt;&lt; corner2.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <a class="code" href="group__Geometry.html#ga3baa7ca66e02a7a51562325d28e70d47">box_enclosing</a>(corner1, corner2, VP, corner1, corner2);</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Corner1 moves to : &quot;</span> &lt;&lt; corner1.transpose() &lt;&lt; std::endl</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Corner2 moves to : &quot;</span> &lt;&lt; corner2.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <a class="code" href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a>(corner1, origin, corner1);</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <a class="code" href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a>(corner2, origin, corner2);</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Corner1 finally is : &quot;</span> &lt;&lt; corner1.transpose() &lt;&lt; std::endl</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Corner2 finally is : &quot;</span> &lt;&lt; corner2.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <span class="comment">// Discard not necessary components</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    corner1.resize(2);</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    corner2.resize(2);</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <span class="comment">// Clip to image size</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <a class="code" href="group__Vectors.html#ga988b127d529b4cf677e3d31f65bc8403">sortTwoVectors</a>(corner1, corner2);</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1) = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1)), <a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(P()), <a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(P()));</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1) = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1)), <a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(P()), <a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(P()));</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2) = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2)), <a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(P()), <a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(P()));</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2) = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2)), <a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(P()), <a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(P()));</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;corner1      &quot;</span> &lt;&lt; corner1.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;corner2      &quot;</span> &lt;&lt; corner2.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    std::cout.flush();</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="comment">// Check if there is something to project</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1) == <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2))</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1) == <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2))</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <span class="comment">// Study the projection for each point in the projection plane ..........</span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    <span class="comment">// (u,v) are in the deformed projection plane (if any deformation)</span></div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> v = (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1); v &lt;= (int)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2); v++)</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a> = (<span class="keywordtype">int</span>)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1); <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a> &lt;= (int)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2); <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a>++)</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        {</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="cuda__basic__math_8h.html#a2fcd5057894d92219f3d8e11e6ace2ff">length</a> = 0;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;            <span class="comment">//#define DEBUG_EVEN_MORE</span></div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="preprocessor">#ifdef DEBUG_EVEN_MORE</span></div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Studying point (&quot;</span> &lt;&lt; <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; v &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;            std::cout.flush();</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;            <span class="comment">// Perform subsampling ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,</span></div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;            <span class="keywordtype">double</span> u0 = <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a> - (int)(SUBSAMPLING / 2.0) * SUBSTEP;</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#a8eb6f9afe59b4924d42d1ea2002148e7">v0</a> = v - (int)(SUBSAMPLING / 2.0) * SUBSTEP;</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            <span class="keywordtype">double</span> actv = <a class="code" href="numerical__recipes_8cpp.html#a8eb6f9afe59b4924d42d1ea2002148e7">v0</a>;</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> subv = 0; subv &lt; SUBSAMPLING; subv++)</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;            {</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                <span class="keywordtype">double</span> actu = u0;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> subu = 0; subu &lt; SUBSAMPLING; subu++)</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                {</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                    <span class="comment">// Compute the coordinates of point (subu,subv) which is</span></div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                    <span class="comment">// within the plane in the universal coordinate system</span></div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(act) = actu;</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(act) = actv;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(act) = 0;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                    <a class="code" href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a>(act, PV, act);</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                    <span class="comment">// Compute the intersection of a ray which passes through</span></div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                    <span class="comment">// this point and its direction is perpendicular to the</span></div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                    <span class="comment">// projection plane</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                    <span class="keywordtype">double</span> r=<a class="code" href="group__Geometry.html#ga3adf48a1d9643041f01f7bab097a8d44">point_line_distance_3D</a>(Center, act, direction);</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                    <span class="keywordtype">double</span> possible_length=interpolator.</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                                           projectionAtDistance(atom.<a class="code" href="classAtom.html#a7d9721acafaa5d67ee744348e81235c7">atomType</a>,r);</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                    <span class="keywordflow">if</span> (possible_length &gt; 0)</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                        length += possible_length;</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="preprocessor">#ifdef DEBUG_EVEN_MORE</span></div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;Averaging at (&quot;</span> &lt;&lt; actu &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; actv &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;   which in univ. coords is &quot;</span> &lt;&lt; act.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;   r=&quot;</span> &lt;&lt; r &lt;&lt; std::endl;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;   intersection there &quot;</span> &lt;&lt; possible_length &lt;&lt; std::endl;</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                    std::cout.flush();</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                    <span class="comment">// Prepare for next iteration</span></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                    actu += SUBSTEP * 2.0;</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                }</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                actv += SUBSTEP * 2.0;</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;            }</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;            length /= (SUBSAMPLING * SUBSAMPLING);</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;            <span class="comment">//#define DEBUG</span></div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Final value added at position (&quot;</span> &lt;&lt; <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; v &lt;&lt; <span class="stringliteral">&quot;)=&quot;</span></div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;            &lt;&lt; length &lt;&lt; std::endl;</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;            std::cout.flush();</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;            <span class="comment">// Add at the correspondent pixel the found intersection ,,,,,,,,,,</span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;            <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(P, v, <a class="code" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a>) += <a class="code" href="cuda__basic__math_8h.html#a2fcd5057894d92219f3d8e11e6ace2ff">length</a>;</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;        }</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;}</div><div class="ttc" id="classAtom_html_af1c8b6cd65e2a489b9be339efd7a77ac"><div class="ttname"><a href="classAtom.html#af1c8b6cd65e2a489b9be339efd7a77ac">Atom::z</a></div><div class="ttdeci">double z</div><div class="ttdoc">Position Z. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00123">pdb.h:123</a></div></div>
<div class="ttc" id="group__Geometry_html_ga3adf48a1d9643041f01f7bab097a8d44"><div class="ttname"><a href="group__Geometry.html#ga3adf48a1d9643041f01f7bab097a8d44">point_line_distance_3D</a></div><div class="ttdeci">double point_line_distance_3D(const Matrix1D&lt; double &gt; &amp;p, const Matrix1D&lt; double &gt; &amp;a, const Matrix1D&lt; double &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00085">geometry.cpp:85</a></div></div>
<div class="ttc" id="group__Vectors_html_ga988b127d529b4cf677e3d31f65bc8403"><div class="ttname"><a href="group__Vectors.html#ga988b127d529b4cf677e3d31f65bc8403">sortTwoVectors</a></div><div class="ttdeci">void sortTwoVectors(Matrix1D&lt; T &gt; &amp;v1, Matrix1D&lt; T &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01206">matrix1d.h:1206</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="group__FourierProjection_html_gabef83744f4e0571354f31586fb41d357"><div class="ttname"><a href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">Projection::euler</a></div><div class="ttdeci">Matrix2D&lt; double &gt; euler</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00071">fourier_projection.h:71</a></div></div>
<div class="ttc" id="classAtom_html_a382da4a2a8d20faa2fd1eca986f44056"><div class="ttname"><a href="classAtom.html#a382da4a2a8d20faa2fd1eca986f44056">Atom::x</a></div><div class="ttdeci">double x</div><div class="ttdoc">Position X. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00117">pdb.h:117</a></div></div>
<div class="ttc" id="classMatrix2D_html_a8073200797ec6121b2ad960f6a41f52a"><div class="ttname"><a href="classMatrix2D.html#a8073200797ec6121b2ad960f6a41f52a">Matrix2D::transpose</a></div><div class="ttdeci">Matrix2D&lt; T &gt; transpose() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l01314">matrix2d.cpp:1314</a></div></div>
<div class="ttc" id="classAtom_html_a7d9721acafaa5d67ee744348e81235c7"><div class="ttname"><a href="classAtom.html#a7d9721acafaa5d67ee744348e81235c7">Atom::atomType</a></div><div class="ttdeci">char atomType</div><div class="ttdoc">Type. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00114">pdb.h:114</a></div></div>
<div class="ttc" id="classMatrix1D_html_af8b6ea8f86fcf69738d37b3336f536af"><div class="ttname"><a href="classMatrix1D.html#af8b6ea8f86fcf69738d37b3336f536af">Matrix1D::selfTranspose</a></div><div class="ttdeci">void selfTranspose()</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00944">matrix1d.h:944</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="classMatrix1D_html_a028505ebdeaf6f62d884c31dcd5127a8"><div class="ttname"><a href="classMatrix1D.html#a028505ebdeaf6f62d884c31dcd5127a8">Matrix1D::transpose</a></div><div class="ttdeci">Matrix1D&lt; T &gt; transpose() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8cpp_source.html#l00631">matrix1d.cpp:631</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00059">multidim_array_base.h:59</a></div></div>
<div class="ttc" id="group__Macros_html_gad4d08cca0a39849cc247072eaebe7726"><div class="ttname"><a href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a></div><div class="ttdeci">#define CLIP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00260">xmipp_macros.h:260</a></div></div>
<div class="ttc" id="group__Geometry_html_ga3baa7ca66e02a7a51562325d28e70d47"><div class="ttname"><a href="group__Geometry.html#ga3baa7ca66e02a7a51562325d28e70d47">box_enclosing</a></div><div class="ttdeci">void box_enclosing(const Matrix1D&lt; double &gt; &amp;v0, const Matrix1D&lt; double &gt; &amp;vF, const Matrix2D&lt; double &gt; &amp;V, Matrix1D&lt; double &gt; &amp;corner1, Matrix1D&lt; double &gt; &amp;corner2)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00366">geometry.cpp:366</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00085">matrix1d.h:85</a></div></div>
<div class="ttc" id="cuda__basic__math_8h_html_a2fcd5057894d92219f3d8e11e6ace2ff"><div class="ttname"><a href="cuda__basic__math_8h.html#a2fcd5057894d92219f3d8e11e6ace2ff">length</a></div><div class="ttdeci">__host__ __device__ float length(float2 v)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__basic__math_8h_source.html#l00162">cuda_basic_math.h:162</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="group__FringeProcessing_html_gad71cd7f2325be81202279ed730355092"><div class="ttname"><a href="group__FringeProcessing.html#gad71cd7f2325be81202279ed730355092">direction</a></div><div class="ttdeci">void direction(const MultidimArray&lt; double &gt; &amp;orMap, MultidimArray&lt; double &gt; &amp;qualityMap, double lambda, int size, MultidimArray&lt; double &gt; &amp;dirMap, int x, int y)</div><div class="ttdef"><b>Definition:</b> <a href="fringe__processing_8cpp_source.html#l00436">fringe_processing.cpp:436</a></div></div>
<div class="ttc" id="group__FourierProjection_html_ga532f6713fbe228d3ee30f4d3a2766a20"><div class="ttname"><a href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">Projection::direction</a></div><div class="ttdeci">Matrix1D&lt; double &gt; direction</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00062">fourier_projection.h:62</a></div></div>
<div class="ttc" id="group__Matrices_html_gad159332322d687de886a720422e4b757"><div class="ttname"><a href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a></div><div class="ttdeci">#define M3x3_BY_V3x1(a, M, b)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00170">matrix2d.h:170</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00093">matrix1d.h:93</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00063">multidim_array_base.h:63</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classAtom_html_aab210323240ea76e6f866113e590cd22"><div class="ttname"><a href="classAtom.html#aab210323240ea76e6f866113e590cd22">Atom::y</a></div><div class="ttdeci">double y</div><div class="ttdoc">Position Y. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00120">pdb.h:120</a></div></div>
<div class="ttc" id="group__Vectors_html_ga6c6b4d4f88daca5e1d8e171bec3b4af0"><div class="ttname"><a href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a></div><div class="ttdeci">#define VECTOR_R3(v, x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00124">matrix1d.h:124</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a6277e2a7446059985dc9bcf0a4ac1a8f"><div class="ttname"><a href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a></div><div class="ttdeci">doublereal * u</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02230">numerical_recipes.cpp:2230</a></div></div>
<div class="ttc" id="classAtomInterpolator_html_a3da6490c9d90461cacdf8a9be6627dcd"><div class="ttname"><a href="classAtomInterpolator.html#a3da6490c9d90461cacdf8a9be6627dcd">AtomInterpolator::atomRadius</a></div><div class="ttdeci">double atomRadius(char atom) const</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00414">pdb.h:414</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a8eb6f9afe59b4924d42d1ea2002148e7"><div class="ttname"><a href="numerical__recipes_8cpp.html#a8eb6f9afe59b4924d42d1ea2002148e7">v0</a></div><div class="ttdeci">double v0</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l06212">numerical_recipes.cpp:6212</a></div></div>
<div class="ttc" id="classMatrix2D_html_a9e4bd9c27982c0d7775f3804bf021687"><div class="ttname"><a href="classMatrix2D.html#a9e4bd9c27982c0d7775f3804bf021687">Matrix2D::getRow</a></div><div class="ttdeci">void getRow(size_t i, Matrix1D&lt; T &gt; &amp;v) const</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l00871">matrix2d.cpp:871</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00101">matrix1d.h:101</a></div></div>
<div class="ttc" id="group__Vectors_html_gafe748b92e8aeaa282eb7bafbd2baca37"><div class="ttname"><a href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a></div><div class="ttdeci">#define V3_PLUS_V3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00190">matrix1d.h:190</a></div></div>
<div class="ttc" id="group__Images_html_gaad11fc7e221702e9f1adeb445ba5db9c"><div class="ttname"><a href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a></div><div class="ttdeci">#define IMGPIXEL(I, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00186">xmipp_image_base.h:186</a></div></div>
<div class="ttc" id="group__Macros_html_ga20716e3da0ba25d3c4c9a2421573391f"><div class="ttname"><a href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a></div><div class="ttdeci">#define SPEED_UP_temps012</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00403">xmipp_macros.h:403</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2bd8e63f0621537c4e4b319ed0ba25ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bd8e63f0621537c4e4b319ed0ba25ae">&#9670;&nbsp;</a></span>readCIF()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename callable &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void readCIF </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>fnCIF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const callable &amp;&#160;</td>
          <td class="paramname"><em>addAtom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cif::datablock &amp;&#160;</td>
          <td class="paramname"><em>dataBlock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read phantom from CIF. </p>
<p>This function reads the given CIF file and inserts the found atoms inside in the class's atom list.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fnPDB</td><td>CIF file path. </td></tr>
    <tr><td class="paramname">addAtom</td><td>Function to add atoms to class's atom list. </td></tr>
    <tr><td class="paramname">dataBlock</td><td>Data block used to store all of CIF file's fields. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l00462">462</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;{</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="comment">// Parsing mmCIF file</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    cif::file cifFile;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    cifFile.load(fnCIF);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">// Extrayendo datos del archivo en un DataBlock</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    cif::datablock&amp; db = cifFile.front();</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="comment">// Reading Atom section</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">// Typical line:</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">// ATOM   8      C  CD1 . ILE A  1 3    ? 48.271  183.605 19.253  1.00 35.73  ? 3    ILE A CD1 1</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    cif::category&amp; atom_site = db[<span class="stringliteral">&quot;atom_site&quot;</span>];</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">// Iterating through atoms and heteroatoms getting atom id and x,y,z positions</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <a class="code" href="classAtom.html">Atom</a> atom;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [atom_id, x_pos, y_pos, z_pos]: atom_site.find</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        &lt;std::string,<span class="keywordtype">float</span>,<span class="keywordtype">float</span>,<span class="keywordtype">float</span>&gt;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        (</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            cif::key(<span class="stringliteral">&quot;group_PDB&quot;</span>) == <span class="stringliteral">&quot;ATOM&quot;</span> || cif::key(<span class="stringliteral">&quot;group_PDB&quot;</span>) == <span class="stringliteral">&quot;HETATM&quot;</span>,</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <span class="stringliteral">&quot;label_atom_id&quot;</span>,</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            <span class="stringliteral">&quot;Cartn_x&quot;</span>,</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            <span class="stringliteral">&quot;Cartn_y&quot;</span>,</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            <span class="stringliteral">&quot;Cartn_z&quot;</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        ))</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    {</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="comment">// Obtaining:</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="comment">// ATOM   8      C  CD1 . ILE A  1 3    ? 48.271  183.605 19.253  1.00 35.73  ? 3    ILE A CD1 1</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="comment">//               *                        ******  ******* ******</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        atom.<a class="code" href="classAtom.html#a7d9721acafaa5d67ee744348e81235c7">atomType</a> = atom_id[0];</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        atom.<a class="code" href="classAtom.html#a382da4a2a8d20faa2fd1eca986f44056">x</a> = x_pos;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        atom.<a class="code" href="classAtom.html#aab210323240ea76e6f866113e590cd22">y</a> = y_pos;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        atom.<a class="code" href="classAtom.html#af1c8b6cd65e2a489b9be339efd7a77ac">z</a> = z_pos;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        addAtom(atom);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    }</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">// Storing whole datablock</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    dataBlock = db;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;}</div><div class="ttc" id="classAtom_html_af1c8b6cd65e2a489b9be339efd7a77ac"><div class="ttname"><a href="classAtom.html#af1c8b6cd65e2a489b9be339efd7a77ac">Atom::z</a></div><div class="ttdeci">double z</div><div class="ttdoc">Position Z. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00123">pdb.h:123</a></div></div>
<div class="ttc" id="classAtom_html_a382da4a2a8d20faa2fd1eca986f44056"><div class="ttname"><a href="classAtom.html#a382da4a2a8d20faa2fd1eca986f44056">Atom::x</a></div><div class="ttdeci">double x</div><div class="ttdoc">Position X. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00117">pdb.h:117</a></div></div>
<div class="ttc" id="classAtom_html_a7d9721acafaa5d67ee744348e81235c7"><div class="ttname"><a href="classAtom.html#a7d9721acafaa5d67ee744348e81235c7">Atom::atomType</a></div><div class="ttdeci">char atomType</div><div class="ttdoc">Type. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00114">pdb.h:114</a></div></div>
<div class="ttc" id="classAtom_html"><div class="ttname"><a href="classAtom.html">Atom</a></div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00110">pdb.h:110</a></div></div>
<div class="ttc" id="classAtom_html_aab210323240ea76e6f866113e590cd22"><div class="ttname"><a href="classAtom.html#aab210323240ea76e6f866113e590cd22">Atom::y</a></div><div class="ttdeci">double y</div><div class="ttdoc">Position Y. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00120">pdb.h:120</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abc17c5a4c6ef96f3738b1cf517726513"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc17c5a4c6ef96f3738b1cf517726513">&#9670;&nbsp;</a></span>readPDB()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename callable &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void readPDB </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFileName.html">FileName</a> &amp;&#160;</td>
          <td class="paramname"><em>fnPDB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const callable &amp;&#160;</td>
          <td class="paramname"><em>addAtom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read phantom from <a class="el" href="structPDB.html">PDB</a>. </p>
<p>This function reads the given <a class="el" href="structPDB.html">PDB</a> file and inserts the found atoms inside in the class's atom list.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fnPDB</td><td><a class="el" href="structPDB.html">PDB</a> file. </td></tr>
    <tr><td class="paramname">addAtom</td><td>Function to add atoms to class's atom list. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l00416">416</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;{</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">// Open file</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    std::ifstream fh_in;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    fh_in.open(fnPDB.c_str());</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">if</span> (!fh_in)</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aae2056cec6ccd16ef57befd5caa6d5fa7">ERR_IO_NOTEXIST</a>, fnPDB);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">// Process all lines of the file</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    std::string line;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    std::string kind;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <a class="code" href="classAtom.html">Atom</a> atom;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">while</span> (!fh_in.eof())</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="comment">// Read an ATOM line</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        getline(fh_in, line);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keywordflow">if</span> (line == <span class="stringliteral">&quot;&quot;</span>)</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        kind = line.substr(0, 4);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keywordflow">if</span> (kind != <span class="stringliteral">&quot;ATOM&quot;</span> &amp;&amp; kind != <span class="stringliteral">&quot;HETA&quot;</span>)</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="comment">// Extract atom type and position</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="comment">// Typical line:</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="comment">// ATOM    909  CA  ALA A 161      58.775  31.984 111.803  1.00 34.78</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        atom.<a class="code" href="classAtom.html#a7d9721acafaa5d67ee744348e81235c7">atomType</a> = line[13];</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        atom.<a class="code" href="classAtom.html#a382da4a2a8d20faa2fd1eca986f44056">x</a> = <a class="code" href="group__StringUtilities.html#ga9767346b2233af75e82a79632c3530da">textToFloat</a>(line.substr(30, 8));</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        atom.<a class="code" href="classAtom.html#aab210323240ea76e6f866113e590cd22">y</a> = <a class="code" href="group__StringUtilities.html#ga9767346b2233af75e82a79632c3530da">textToFloat</a>(line.substr(38, 8));</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        atom.<a class="code" href="classAtom.html#af1c8b6cd65e2a489b9be339efd7a77ac">z</a> = <a class="code" href="group__StringUtilities.html#ga9767346b2233af75e82a79632c3530da">textToFloat</a>(line.substr(46, 8));</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        addAtom(atom);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">// Close files</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    fh_in.close();</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div><div class="ttc" id="classAtom_html_af1c8b6cd65e2a489b9be339efd7a77ac"><div class="ttname"><a href="classAtom.html#af1c8b6cd65e2a489b9be339efd7a77ac">Atom::z</a></div><div class="ttdeci">double z</div><div class="ttdoc">Position Z. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00123">pdb.h:123</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00211">xmipp_error.h:211</a></div></div>
<div class="ttc" id="classAtom_html_a382da4a2a8d20faa2fd1eca986f44056"><div class="ttname"><a href="classAtom.html#a382da4a2a8d20faa2fd1eca986f44056">Atom::x</a></div><div class="ttdeci">double x</div><div class="ttdoc">Position X. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00117">pdb.h:117</a></div></div>
<div class="ttc" id="classAtom_html_a7d9721acafaa5d67ee744348e81235c7"><div class="ttname"><a href="classAtom.html#a7d9721acafaa5d67ee744348e81235c7">Atom::atomType</a></div><div class="ttdeci">char atomType</div><div class="ttdoc">Type. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00114">pdb.h:114</a></div></div>
<div class="ttc" id="group__StringUtilities_html_ga9767346b2233af75e82a79632c3530da"><div class="ttname"><a href="group__StringUtilities.html#ga9767346b2233af75e82a79632c3530da">textToFloat</a></div><div class="ttdeci">float textToFloat(const char *str)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__strings_8cpp_source.html#l00124">xmipp_strings.cpp:124</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aae2056cec6ccd16ef57befd5caa6d5fa7"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aae2056cec6ccd16ef57befd5caa6d5fa7">ERR_IO_NOTEXIST</a></div><div class="ttdoc">File or directory does not exist. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00136">xmipp_error.h:136</a></div></div>
<div class="ttc" id="classAtom_html"><div class="ttname"><a href="classAtom.html">Atom</a></div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00110">pdb.h:110</a></div></div>
<div class="ttc" id="classAtom_html_aab210323240ea76e6f866113e590cd22"><div class="ttname"><a href="classAtom.html#aab210323240ea76e6f866113e590cd22">Atom::y</a></div><div class="ttdeci">double y</div><div class="ttdoc">Position Y. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00120">pdb.h:120</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aedb9b69d6078b10111bb7bea470e2e53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedb9b69d6078b10111bb7bea470e2e53">&#9670;&nbsp;</a></span>readRichCIF()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename callable &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void readRichCIF </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>fnCIF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const callable &amp;&#160;</td>
          <td class="paramname"><em>addAtom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>intensities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>pseudoatoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cif::datablock &amp;&#160;</td>
          <td class="paramname"><em>dataBlock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read rich phantom from CIF. </p>
<p>This function reads the given CIF file and stores the found atoms, remarks, and intensities. Note: CIF files do not contain segment name, so that data won't be read.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fnPDB</td><td>CIF file path. </td></tr>
    <tr><td class="paramname">addAtom</td><td>Function to add atoms to class's atom list. </td></tr>
    <tr><td class="paramname">intensities</td><td>List of atom intensities. </td></tr>
    <tr><td class="paramname">pseudoatoms</td><td>Flag for returning intensities (stored in B-factors) instead of atoms. false (default) is used when there are no pseudoatoms or when using a threshold. </td></tr>
    <tr><td class="paramname">threshold</td><td>B factor threshold for filtering out for pdb_reduce_pseudoatoms. </td></tr>
    <tr><td class="paramname">dataBlock</td><td>Data block used to store all of CIF file's fields. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l00619">619</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;{</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="comment">// Parsing mmCIF file</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    cif::file cifFile;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    cifFile.load(fnCIF);</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="comment">// Extrayendo datos del archivo en un DataBlock</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    cif::datablock&amp; db = cifFile.front();</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="comment">// Reading Atom section</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    cif::category&amp; atom_site = db[<span class="stringliteral">&quot;atom_site&quot;</span>];</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="comment">// Iterating through atoms and heteroatoms getting atom id and x,y,z positions</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <a class="code" href="classRichAtom.html">RichAtom</a> atom;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [record, serialNumber, atomId, altId, resName, chain, resSeq, seqId, iCode, xPos, yPos, zPos,</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            occupancy, bFactor, charge, authSeqId, authCompId, authAsymId, authAtomId, pdbNum]:</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        atom_site.find&lt;std::string,<span class="keywordtype">int</span>,std::string,std::string,std::string,std::string,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,std::string,<span class="keywordtype">float</span>,</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            <span class="keywordtype">float</span>,<span class="keywordtype">float</span>,<span class="keywordtype">float</span>,<span class="keywordtype">float</span>,std::string,<span class="keywordtype">int</span>,std::string,std::string,std::string,<span class="keywordtype">int</span>&gt;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        (</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            <span class="comment">// Note: search by key is needed to iterate list of atoms. Workaround: use every possible record type for the search</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            cif::key(<span class="stringliteral">&quot;group_PDB&quot;</span>) == <span class="stringliteral">&quot;ATOM&quot;</span> || cif::key(<span class="stringliteral">&quot;group_PDB&quot;</span>) == <span class="stringliteral">&quot;HETATM&quot;</span>,</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            <span class="stringliteral">&quot;group_PDB&quot;</span>,            <span class="comment">// Record:          --&gt;ATOM&lt;--   8      C  CD1 . ILE A  1 3    ? 48.271  183.605 19.253  1.00 35.73  ? 3    ILE A CD1 1</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="stringliteral">&quot;id&quot;</span>,                   <span class="comment">// Serial number:   ATOM   --&gt;8&lt;--      C  CD1 . ILE A  1 3    ? 48.271  183.605 19.253  1.00 35.73  ? 3    ILE A CD1 1</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            <span class="stringliteral">&quot;label_atom_id&quot;</span>,        <span class="comment">// Id:              ATOM   8      C  --&gt;CD1&lt;-- . ILE A  1 3    ? 48.271  183.605 19.253  1.00 35.73  ? 3    ILE A CD1 1</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            <span class="stringliteral">&quot;label_alt_id&quot;</span>,         <span class="comment">// Alt id:          ATOM   8      C  CD1 --&gt;.&lt;-- ILE A  1 3    ? 48.271  183.605 19.253  1.00 35.73  ? 3    ILE A CD1 1</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            <span class="stringliteral">&quot;label_comp_id&quot;</span>,        <span class="comment">// Chain name:      ATOM   8      C  CD1 . --&gt;ILE&lt;-- A  1 3    ? 48.271  183.605 19.253  1.00 35.73  ? 3    ILE A CD1 1</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <span class="stringliteral">&quot;label_asym_id&quot;</span>,        <span class="comment">// Chain location:  ATOM   8      C  CD1 . ILE --&gt;A&lt;--  1 3    ? 48.271  183.605 19.253  1.00 35.73  ? 3    ILE A CD1 1</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            <span class="stringliteral">&quot;label_entity_id&quot;</span>,      <span class="comment">// Residue sequence:ATOM   8      C  CD1 . ILE A  --&gt;1&lt;-- 3    ? 48.271  183.605 19.253  1.00 35.73  ? 3    ILE A CD1 1</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            <span class="stringliteral">&quot;label_seq_id&quot;</span>,         <span class="comment">// Sequence id:     ATOM   8      C  CD1 . ILE A  1 --&gt;3&lt;--    ? 48.271  183.605 19.253  1.00 35.73  ? 3    ILE A CD1 1</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            <span class="stringliteral">&quot;pdbx_PDB_ins_code&quot;</span>,    <span class="comment">// Ins code:        ATOM   8      C  CD1 . ILE A  1 3    --&gt;?&lt;-- 48.271  183.605 19.253  1.00 35.73  ? 3    ILE A CD1 1</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            <span class="stringliteral">&quot;Cartn_x&quot;</span>,              <span class="comment">// X position:      ATOM   8      C  CD1 . ILE A  1 3    ? --&gt;48.271&lt;--  183.605 19.253  1.00 35.73  ? 3    ILE A CD1 1</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            <span class="stringliteral">&quot;Cartn_y&quot;</span>,              <span class="comment">// Y position:      ATOM   8      C  CD1 . ILE A  1 3    ? 48.271  --&gt;183.605&lt;-- 19.253  1.00 35.73  ? 3    ILE A CD1 1</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <span class="stringliteral">&quot;Cartn_z&quot;</span>,              <span class="comment">// Z position:      ATOM   8      C  CD1 . ILE A  1 3    ? 48.271  183.605 --&gt;19.253&lt;--  1.00 35.73  ? 3    ILE A CD1 1</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            <span class="stringliteral">&quot;occupancy&quot;</span>,            <span class="comment">// Occupancy:       ATOM   8      C  CD1 . ILE A  1 3    ? 48.271  183.605 19.253  --&gt;1.00&lt;-- 35.73  ? 3    ILE A CD1 1</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            <span class="stringliteral">&quot;B_iso_or_equiv&quot;</span>,       <span class="comment">// B factor:        ATOM   8      C  CD1 . ILE A  1 3    ? 48.271  183.605 19.253  1.00 --&gt;35.73&lt;--  ? 3    ILE A CD1 1</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            <span class="stringliteral">&quot;pdbx_formal_charge&quot;</span>,   <span class="comment">// Author charge:   ATOM   8      C  CD1 . ILE A  1 3    ? 48.271  183.605 19.253  1.00 35.73  --&gt;?&lt;-- 3    ILE A CD1 1</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            <span class="stringliteral">&quot;auth_seq_id&quot;</span>,          <span class="comment">// Author seq id:   ATOM   8      C  CD1 . ILE A  1 3    ? 48.271  183.605 19.253  1.00 35.73  ? --&gt;3&lt;--    ILE A CD1 1</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <span class="stringliteral">&quot;auth_comp_id&quot;</span>,         <span class="comment">// Author chainname:ATOM   8      C  CD1 . ILE A  1 3    ? 48.271  183.605 19.253  1.00 35.73  ? 3    --&gt;ILE&lt;-- A CD1 1</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            <span class="stringliteral">&quot;auth_asym_id&quot;</span>,         <span class="comment">// Author chain loc:ATOM   8      C  CD1 . ILE A  1 3    ? 48.271  183.605 19.253  1.00 35.73  ? 3    ILE --&gt;A&lt;-- CD1 1</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            <span class="stringliteral">&quot;auth_atom_id&quot;</span>,         <span class="comment">// Author id:       ATOM   8      C  CD1 . ILE A  1 3    ? 48.271  183.605 19.253  1.00 35.73  ? 3    ILE A --&gt;CD1&lt;-- 1</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <span class="stringliteral">&quot;pdbx_PDB_model_num&quot;</span>    <span class="comment">// PDB model number:ATOM   8      C  CD1 . ILE A  1 3    ? 48.271  183.605 19.253  1.00 35.73  ? 3    ILE A CD1 --&gt;1&lt;--</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        ))</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    {</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="comment">// Storing values in atom list</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        atom.<a class="code" href="classRichAtom.html#a2ebbb806d48f8c663900bc6db18629b1">record</a> = record;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        atom.<a class="code" href="classRichAtom.html#afeec2ac638833f9b5f4eb6473908ec28">serial</a> = serialNumber;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        atom.<a class="code" href="classRichAtom.html#a057f70d623841c7cfa24b8bfd0c692e7">name</a> = atomId;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        atom.<a class="code" href="classRichAtom.html#ab0f6d570d8c29187492000c4b01d2f08">atomType</a> = atomId;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        atom.<a class="code" href="classRichAtom.html#a030dc8f422ce221185cb2ae296d2786d">altId</a> = altId;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        atom.<a class="code" href="classRichAtom.html#ae7c5386af1f9abc91293b4d81c5a1bc6">resname</a> = resName;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        atom.<a class="code" href="classRichAtom.html#aaccceebe63b5b2264d110119a95eb455">altloc</a> = chain;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        atom.<a class="code" href="classRichAtom.html#aae09bf2c30874729d81b8514f81d8f77">chainid</a> = chain[0];</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        atom.<a class="code" href="classRichAtom.html#afaa711a9cd6224cd70afbdd7557e3610">resseq</a> = resSeq;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        atom.<a class="code" href="classRichAtom.html#a6284ba1366aced84867663bffac6f81b">seqId</a> = seqId;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        atom.<a class="code" href="classRichAtom.html#a127d9cf8d8dd82ea8ee12077a38cb2ef">icode</a> = iCode;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        atom.<a class="code" href="classRichAtom.html#addc1a7ccf33f9b83c4b6eb129d1b6fdc">x</a> = xPos;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        atom.<a class="code" href="classRichAtom.html#a302a9368cf4603393e0598bf937792b9">y</a> = yPos;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        atom.<a class="code" href="classRichAtom.html#a692750caa66c2e66a01b4fbafad95f4b">z</a> = zPos;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        atom.<a class="code" href="classRichAtom.html#a51c3f2e9d324858548565492af6e6900">occupancy</a> = occupancy;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        atom.<a class="code" href="classRichAtom.html#a489199ee9fccf3ba7a4ddf5a4920330a">bfactor</a> = bFactor;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        atom.<a class="code" href="classRichAtom.html#a77ab18fea07169b94dabf503c2ae125a">charge</a> = charge;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        atom.<a class="code" href="classRichAtom.html#af0fea9ef9706e37b3fa1a4a47f240989">authSeqId</a> = authSeqId;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        atom.<a class="code" href="classRichAtom.html#a9e83a220f7d491920bfe3a5b83c37f24">authCompId</a> = authCompId;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        atom.<a class="code" href="classRichAtom.html#a9dc6cc2791a234524d762a32deec2eff">authAsymId</a> = authAsymId;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        atom.<a class="code" href="classRichAtom.html#af56198b20518c41b6f1b09fa1c958c97">authAtomId</a> = authAtomId;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        atom.<a class="code" href="classRichAtom.html#afb5f30d84b4e21622ecff196c9900bb1">pdbNum</a> = pdbNum;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="comment">// If it is a pseudoatom, insert B factor into intensities</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <span class="keywordflow">if</span>(pseudoatoms) {</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            intensities.push_back(bFactor);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            <span class="comment">// Adding atom if is not pseudoatom and B factor is not greater than set threshold</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            <span class="keywordflow">if</span> (bFactor &gt;= <a class="code" href="lib__vwk_8cpp.html#a2834b5125eb5ac411feb578af1fac2ea">threshold</a>)</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                addAtom(atom);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        }</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    }</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="comment">// Storing whole datablock</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    dataBlock = db;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;}</div><div class="ttc" id="classRichAtom_html_a6284ba1366aced84867663bffac6f81b"><div class="ttname"><a href="classRichAtom.html#a6284ba1366aced84867663bffac6f81b">RichAtom::seqId</a></div><div class="ttdeci">int seqId</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00231">pdb.h:231</a></div></div>
<div class="ttc" id="classRichAtom_html_a77ab18fea07169b94dabf503c2ae125a"><div class="ttname"><a href="classRichAtom.html#a77ab18fea07169b94dabf503c2ae125a">RichAtom::charge</a></div><div class="ttdeci">std::string charge</div><div class="ttdoc">2-char charge with sign 2nd (e.g. 1- or 2+) </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00220">pdb.h:220</a></div></div>
<div class="ttc" id="classRichAtom_html_a2ebbb806d48f8c663900bc6db18629b1"><div class="ttname"><a href="classRichAtom.html#a2ebbb806d48f8c663900bc6db18629b1">RichAtom::record</a></div><div class="ttdeci">std::string record</div><div class="ttdoc">Record Type (&quot;ATOM  &quot; or &quot;HETATM&quot;) </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00178">pdb.h:178</a></div></div>
<div class="ttc" id="classRichAtom_html_aae09bf2c30874729d81b8514f81d8f77"><div class="ttname"><a href="classRichAtom.html#aae09bf2c30874729d81b8514f81d8f77">RichAtom::chainid</a></div><div class="ttdeci">char chainid</div><div class="ttdoc">ChainId. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00202">pdb.h:202</a></div></div>
<div class="ttc" id="classRichAtom_html_afeec2ac638833f9b5f4eb6473908ec28"><div class="ttname"><a href="classRichAtom.html#afeec2ac638833f9b5f4eb6473908ec28">RichAtom::serial</a></div><div class="ttdeci">int serial</div><div class="ttdoc">atom serial number </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00181">pdb.h:181</a></div></div>
<div class="ttc" id="classRichAtom_html"><div class="ttname"><a href="classRichAtom.html">RichAtom</a></div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00174">pdb.h:174</a></div></div>
<div class="ttc" id="classRichAtom_html_ae7c5386af1f9abc91293b4d81c5a1bc6"><div class="ttname"><a href="classRichAtom.html#ae7c5386af1f9abc91293b4d81c5a1bc6">RichAtom::resname</a></div><div class="ttdeci">std::string resname</div><div class="ttdoc">Residue name. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00199">pdb.h:199</a></div></div>
<div class="ttc" id="classRichAtom_html_a9e83a220f7d491920bfe3a5b83c37f24"><div class="ttname"><a href="classRichAtom.html#a9e83a220f7d491920bfe3a5b83c37f24">RichAtom::authCompId</a></div><div class="ttdeci">std::string authCompId</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00237">pdb.h:237</a></div></div>
<div class="ttc" id="classRichAtom_html_ab0f6d570d8c29187492000c4b01d2f08"><div class="ttname"><a href="classRichAtom.html#ab0f6d570d8c29187492000c4b01d2f08">RichAtom::atomType</a></div><div class="ttdeci">std::string atomType</div><div class="ttdoc">atom element type </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00217">pdb.h:217</a></div></div>
<div class="ttc" id="lib__vwk_8cpp_html_a2834b5125eb5ac411feb578af1fac2ea"><div class="ttname"><a href="lib__vwk_8cpp.html#a2834b5125eb5ac411feb578af1fac2ea">threshold</a></div><div class="ttdeci">void threshold(double *phi, unsigned long nvox, double limit)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vwk_8cpp_source.html#l00524">lib_vwk.cpp:524</a></div></div>
<div class="ttc" id="classRichAtom_html_afaa711a9cd6224cd70afbdd7557e3610"><div class="ttname"><a href="classRichAtom.html#afaa711a9cd6224cd70afbdd7557e3610">RichAtom::resseq</a></div><div class="ttdeci">int resseq</div><div class="ttdoc">Residue sequence. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00205">pdb.h:205</a></div></div>
<div class="ttc" id="classRichAtom_html_a302a9368cf4603393e0598bf937792b9"><div class="ttname"><a href="classRichAtom.html#a302a9368cf4603393e0598bf937792b9">RichAtom::y</a></div><div class="ttdeci">double y</div><div class="ttdoc">Position Y. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00187">pdb.h:187</a></div></div>
<div class="ttc" id="classRichAtom_html_a51c3f2e9d324858548565492af6e6900"><div class="ttname"><a href="classRichAtom.html#a51c3f2e9d324858548565492af6e6900">RichAtom::occupancy</a></div><div class="ttdeci">double occupancy</div><div class="ttdoc">Occupancy. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00211">pdb.h:211</a></div></div>
<div class="ttc" id="classRichAtom_html_a030dc8f422ce221185cb2ae296d2786d"><div class="ttname"><a href="classRichAtom.html#a030dc8f422ce221185cb2ae296d2786d">RichAtom::altId</a></div><div class="ttdeci">std::string altId</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00228">pdb.h:228</a></div></div>
<div class="ttc" id="classRichAtom_html_afb5f30d84b4e21622ecff196c9900bb1"><div class="ttname"><a href="classRichAtom.html#afb5f30d84b4e21622ecff196c9900bb1">RichAtom::pdbNum</a></div><div class="ttdeci">int pdbNum</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00246">pdb.h:246</a></div></div>
<div class="ttc" id="classRichAtom_html_a489199ee9fccf3ba7a4ddf5a4920330a"><div class="ttname"><a href="classRichAtom.html#a489199ee9fccf3ba7a4ddf5a4920330a">RichAtom::bfactor</a></div><div class="ttdeci">double bfactor</div><div class="ttdoc">Bfactor. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00214">pdb.h:214</a></div></div>
<div class="ttc" id="classRichAtom_html_addc1a7ccf33f9b83c4b6eb129d1b6fdc"><div class="ttname"><a href="classRichAtom.html#addc1a7ccf33f9b83c4b6eb129d1b6fdc">RichAtom::x</a></div><div class="ttdeci">double x</div><div class="ttdoc">Position X. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00184">pdb.h:184</a></div></div>
<div class="ttc" id="classRichAtom_html_a9dc6cc2791a234524d762a32deec2eff"><div class="ttname"><a href="classRichAtom.html#a9dc6cc2791a234524d762a32deec2eff">RichAtom::authAsymId</a></div><div class="ttdeci">std::string authAsymId</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00240">pdb.h:240</a></div></div>
<div class="ttc" id="classRichAtom_html_af0fea9ef9706e37b3fa1a4a47f240989"><div class="ttname"><a href="classRichAtom.html#af0fea9ef9706e37b3fa1a4a47f240989">RichAtom::authSeqId</a></div><div class="ttdeci">int authSeqId</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00234">pdb.h:234</a></div></div>
<div class="ttc" id="classRichAtom_html_a057f70d623841c7cfa24b8bfd0c692e7"><div class="ttname"><a href="classRichAtom.html#a057f70d623841c7cfa24b8bfd0c692e7">RichAtom::name</a></div><div class="ttdeci">std::string name</div><div class="ttdoc">Name. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00193">pdb.h:193</a></div></div>
<div class="ttc" id="classRichAtom_html_a127d9cf8d8dd82ea8ee12077a38cb2ef"><div class="ttname"><a href="classRichAtom.html#a127d9cf8d8dd82ea8ee12077a38cb2ef">RichAtom::icode</a></div><div class="ttdeci">std::string icode</div><div class="ttdoc">Icode. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00208">pdb.h:208</a></div></div>
<div class="ttc" id="classRichAtom_html_af56198b20518c41b6f1b09fa1c958c97"><div class="ttname"><a href="classRichAtom.html#af56198b20518c41b6f1b09fa1c958c97">RichAtom::authAtomId</a></div><div class="ttdeci">std::string authAtomId</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00243">pdb.h:243</a></div></div>
<div class="ttc" id="classRichAtom_html_a692750caa66c2e66a01b4fbafad95f4b"><div class="ttname"><a href="classRichAtom.html#a692750caa66c2e66a01b4fbafad95f4b">RichAtom::z</a></div><div class="ttdeci">double z</div><div class="ttdoc">Position Z. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00190">pdb.h:190</a></div></div>
<div class="ttc" id="classRichAtom_html_aaccceebe63b5b2264d110119a95eb455"><div class="ttname"><a href="classRichAtom.html#aaccceebe63b5b2264d110119a95eb455">RichAtom::altloc</a></div><div class="ttdeci">std::string altloc</div><div class="ttdoc">Alternate location. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00196">pdb.h:196</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a75ab8213ef5b9951b95c4cd71e8072ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75ab8213ef5b9951b95c4cd71e8072ac">&#9670;&nbsp;</a></span>readRichPDB()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename callable &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void readRichPDB </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFileName.html">FileName</a> &amp;&#160;</td>
          <td class="paramname"><em>fnPDB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const callable &amp;&#160;</td>
          <td class="paramname"><em>addAtom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>intensities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>remarks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>pseudoatoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>threshold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read rich phantom from either a <a class="el" href="structPDB.html">PDB</a> of CIF file. </p>
<p>This function reads the given <a class="el" href="structPDB.html">PDB</a> or CIF file and stores the found atoms, remarks, and intensities.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fnPDB</td><td>PDB/CIF file. </td></tr>
    <tr><td class="paramname">addAtom</td><td>Function to add atoms to class's atom list. </td></tr>
    <tr><td class="paramname">intensities</td><td>List of atom intensities. </td></tr>
    <tr><td class="paramname">remarks</td><td>List of file remarks. </td></tr>
    <tr><td class="paramname">pseudoatoms</td><td>Flag for returning intensities (stored in B-factors) instead of atoms. false (default) is used when there are no pseudoatoms or when using a threshold. </td></tr>
    <tr><td class="paramname">threshold</td><td>B factor threshold for filtering out for pdb_reduce_pseudoatoms. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l00537">537</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;{</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">// Open file</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    std::ifstream fh_in;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    fh_in.open(fnPDB.c_str());</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordflow">if</span> (!fh_in)</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aae2056cec6ccd16ef57befd5caa6d5fa7">ERR_IO_NOTEXIST</a>, fnPDB);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">// Process all lines of the file</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keyword">auto</span> line = std::string(80, <span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    std::string kind;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <a class="code" href="classRichAtom.html">RichAtom</a> atom;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordflow">while</span> (!fh_in.eof())</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    {</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="comment">// Read an ATOM line</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        getline(fh_in, line);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="keywordflow">if</span> (line == <span class="stringliteral">&quot;&quot;</span>)</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        {</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        }</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="comment">// Reading and storing type of atom</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        kind = line.substr(0, 6);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        kind.erase(kind.find_last_not_of(<span class="charliteral">&#39; &#39;</span>) + 1); <span class="comment">// Removing extra spaces if there are any</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="keywordflow">if</span> (kind == <span class="stringliteral">&quot;ATOM&quot;</span> || kind == <span class="stringliteral">&quot;HETATM&quot;</span>)</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        {</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            line.resize (80,<span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            <span class="comment">// Extract atom type and position</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            <span class="comment">// Typical line:</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            <span class="comment">// ATOM    909  CA  ALA A 161      58.775  31.984 111.803  1.00 34.78</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            <span class="comment">// ATOM      2  CA AALA A   1      73.796  56.531  56.644  0.50 84.78           C</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            atom.<a class="code" href="classRichAtom.html#a2ebbb806d48f8c663900bc6db18629b1">record</a> = kind;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            <a class="code" href="pdb_8cpp.html#a415a71241b7fb6d35414b002656156f9">hy36decodeSafe</a>(5, line.substr(6, 5).c_str(), 5, &amp;atom.<a class="code" href="classRichAtom.html#afeec2ac638833f9b5f4eb6473908ec28">serial</a>);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            atom.<a class="code" href="classRichAtom.html#a057f70d623841c7cfa24b8bfd0c692e7">name</a> = line.substr(13, 3);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            atom.<a class="code" href="classRichAtom.html#a057f70d623841c7cfa24b8bfd0c692e7">name</a>.erase(atom.<a class="code" href="classRichAtom.html#a057f70d623841c7cfa24b8bfd0c692e7">name</a>.find_last_not_of(<span class="charliteral">&#39; &#39;</span>) + 1); <span class="comment">// Removing extra spaces if there are any</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            atom.<a class="code" href="classRichAtom.html#aaccceebe63b5b2264d110119a95eb455">altloc</a> = line[16];</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            atom.<a class="code" href="classRichAtom.html#ae7c5386af1f9abc91293b4d81c5a1bc6">resname</a> = line.substr(17, 3);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            atom.<a class="code" href="classRichAtom.html#aae09bf2c30874729d81b8514f81d8f77">chainid</a> = line[21];</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <a class="code" href="pdb_8cpp.html#a415a71241b7fb6d35414b002656156f9">hy36decodeSafe</a>(4, line.substr(22, 4).c_str(), 4, &amp;atom.<a class="code" href="classRichAtom.html#afaa711a9cd6224cd70afbdd7557e3610">resseq</a>);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            atom.<a class="code" href="classRichAtom.html#a127d9cf8d8dd82ea8ee12077a38cb2ef">icode</a> = line[26];</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            atom.<a class="code" href="classRichAtom.html#addc1a7ccf33f9b83c4b6eb129d1b6fdc">x</a> = <a class="code" href="group__StringUtilities.html#ga9767346b2233af75e82a79632c3530da">textToFloat</a>(line.substr(30, 8));</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            atom.<a class="code" href="classRichAtom.html#a302a9368cf4603393e0598bf937792b9">y</a> = <a class="code" href="group__StringUtilities.html#ga9767346b2233af75e82a79632c3530da">textToFloat</a>(line.substr(38, 8));</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            atom.<a class="code" href="classRichAtom.html#a692750caa66c2e66a01b4fbafad95f4b">z</a> = <a class="code" href="group__StringUtilities.html#ga9767346b2233af75e82a79632c3530da">textToFloat</a>(line.substr(46, 8));</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            atom.<a class="code" href="classRichAtom.html#a51c3f2e9d324858548565492af6e6900">occupancy</a> = <a class="code" href="group__StringUtilities.html#ga9767346b2233af75e82a79632c3530da">textToFloat</a>(line.substr(54, 6));</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            atom.<a class="code" href="classRichAtom.html#a489199ee9fccf3ba7a4ddf5a4920330a">bfactor</a> = <a class="code" href="group__StringUtilities.html#ga9767346b2233af75e82a79632c3530da">textToFloat</a>(line.substr(60, 6));</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            atom.<a class="code" href="classRichAtom.html#abcc22f4cf1c1e2b2084edf36a518b0fd">segment</a> = line.substr(72, 4);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            atom.<a class="code" href="classRichAtom.html#ab0f6d570d8c29187492000c4b01d2f08">atomType</a> = line.substr(77, 1);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            atom.<a class="code" href="classRichAtom.html#a77ab18fea07169b94dabf503c2ae125a">charge</a> = line.substr(79, 1);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            atom.<a class="code" href="classRichAtom.html#a77ab18fea07169b94dabf503c2ae125a">charge</a>.erase(atom.<a class="code" href="classRichAtom.html#a77ab18fea07169b94dabf503c2ae125a">charge</a>.find_last_not_of(<span class="charliteral">&#39; &#39;</span>) + 1); <span class="comment">// Converting into empty string if it is a space</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <span class="keywordflow">if</span>(pseudoatoms)</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                intensities.push_back(atom.<a class="code" href="classRichAtom.html#a489199ee9fccf3ba7a4ddf5a4920330a">bfactor</a>);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            </div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="keywordflow">if</span>(!pseudoatoms &amp;&amp; atom.<a class="code" href="classRichAtom.html#a489199ee9fccf3ba7a4ddf5a4920330a">bfactor</a> &gt;= <a class="code" href="lib__vwk_8cpp.html#a2834b5125eb5ac411feb578af1fac2ea">threshold</a>)</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                addAtom(atom);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (kind == <span class="stringliteral">&quot;REMARK&quot;</span>)</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            remarks.push_back(line);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    }</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="comment">// Close files</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    fh_in.close();</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;}</div><div class="ttc" id="classRichAtom_html_abcc22f4cf1c1e2b2084edf36a518b0fd"><div class="ttname"><a href="classRichAtom.html#abcc22f4cf1c1e2b2084edf36a518b0fd">RichAtom::segment</a></div><div class="ttdeci">std::string segment</div><div class="ttdoc">segment name </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00224">pdb.h:224</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00211">xmipp_error.h:211</a></div></div>
<div class="ttc" id="classRichAtom_html_a77ab18fea07169b94dabf503c2ae125a"><div class="ttname"><a href="classRichAtom.html#a77ab18fea07169b94dabf503c2ae125a">RichAtom::charge</a></div><div class="ttdeci">std::string charge</div><div class="ttdoc">2-char charge with sign 2nd (e.g. 1- or 2+) </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00220">pdb.h:220</a></div></div>
<div class="ttc" id="classRichAtom_html_a2ebbb806d48f8c663900bc6db18629b1"><div class="ttname"><a href="classRichAtom.html#a2ebbb806d48f8c663900bc6db18629b1">RichAtom::record</a></div><div class="ttdeci">std::string record</div><div class="ttdoc">Record Type (&quot;ATOM  &quot; or &quot;HETATM&quot;) </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00178">pdb.h:178</a></div></div>
<div class="ttc" id="classRichAtom_html_aae09bf2c30874729d81b8514f81d8f77"><div class="ttname"><a href="classRichAtom.html#aae09bf2c30874729d81b8514f81d8f77">RichAtom::chainid</a></div><div class="ttdeci">char chainid</div><div class="ttdoc">ChainId. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00202">pdb.h:202</a></div></div>
<div class="ttc" id="classRichAtom_html_afeec2ac638833f9b5f4eb6473908ec28"><div class="ttname"><a href="classRichAtom.html#afeec2ac638833f9b5f4eb6473908ec28">RichAtom::serial</a></div><div class="ttdeci">int serial</div><div class="ttdoc">atom serial number </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00181">pdb.h:181</a></div></div>
<div class="ttc" id="classRichAtom_html"><div class="ttname"><a href="classRichAtom.html">RichAtom</a></div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00174">pdb.h:174</a></div></div>
<div class="ttc" id="classRichAtom_html_ae7c5386af1f9abc91293b4d81c5a1bc6"><div class="ttname"><a href="classRichAtom.html#ae7c5386af1f9abc91293b4d81c5a1bc6">RichAtom::resname</a></div><div class="ttdeci">std::string resname</div><div class="ttdoc">Residue name. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00199">pdb.h:199</a></div></div>
<div class="ttc" id="classRichAtom_html_ab0f6d570d8c29187492000c4b01d2f08"><div class="ttname"><a href="classRichAtom.html#ab0f6d570d8c29187492000c4b01d2f08">RichAtom::atomType</a></div><div class="ttdeci">std::string atomType</div><div class="ttdoc">atom element type </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00217">pdb.h:217</a></div></div>
<div class="ttc" id="lib__vwk_8cpp_html_a2834b5125eb5ac411feb578af1fac2ea"><div class="ttname"><a href="lib__vwk_8cpp.html#a2834b5125eb5ac411feb578af1fac2ea">threshold</a></div><div class="ttdeci">void threshold(double *phi, unsigned long nvox, double limit)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vwk_8cpp_source.html#l00524">lib_vwk.cpp:524</a></div></div>
<div class="ttc" id="classRichAtom_html_afaa711a9cd6224cd70afbdd7557e3610"><div class="ttname"><a href="classRichAtom.html#afaa711a9cd6224cd70afbdd7557e3610">RichAtom::resseq</a></div><div class="ttdeci">int resseq</div><div class="ttdoc">Residue sequence. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00205">pdb.h:205</a></div></div>
<div class="ttc" id="classRichAtom_html_a302a9368cf4603393e0598bf937792b9"><div class="ttname"><a href="classRichAtom.html#a302a9368cf4603393e0598bf937792b9">RichAtom::y</a></div><div class="ttdeci">double y</div><div class="ttdoc">Position Y. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00187">pdb.h:187</a></div></div>
<div class="ttc" id="group__StringUtilities_html_ga9767346b2233af75e82a79632c3530da"><div class="ttname"><a href="group__StringUtilities.html#ga9767346b2233af75e82a79632c3530da">textToFloat</a></div><div class="ttdeci">float textToFloat(const char *str)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__strings_8cpp_source.html#l00124">xmipp_strings.cpp:124</a></div></div>
<div class="ttc" id="classRichAtom_html_a51c3f2e9d324858548565492af6e6900"><div class="ttname"><a href="classRichAtom.html#a51c3f2e9d324858548565492af6e6900">RichAtom::occupancy</a></div><div class="ttdeci">double occupancy</div><div class="ttdoc">Occupancy. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00211">pdb.h:211</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aae2056cec6ccd16ef57befd5caa6d5fa7"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aae2056cec6ccd16ef57befd5caa6d5fa7">ERR_IO_NOTEXIST</a></div><div class="ttdoc">File or directory does not exist. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00136">xmipp_error.h:136</a></div></div>
<div class="ttc" id="classRichAtom_html_a489199ee9fccf3ba7a4ddf5a4920330a"><div class="ttname"><a href="classRichAtom.html#a489199ee9fccf3ba7a4ddf5a4920330a">RichAtom::bfactor</a></div><div class="ttdeci">double bfactor</div><div class="ttdoc">Bfactor. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00214">pdb.h:214</a></div></div>
<div class="ttc" id="classRichAtom_html_addc1a7ccf33f9b83c4b6eb129d1b6fdc"><div class="ttname"><a href="classRichAtom.html#addc1a7ccf33f9b83c4b6eb129d1b6fdc">RichAtom::x</a></div><div class="ttdeci">double x</div><div class="ttdoc">Position X. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00184">pdb.h:184</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a415a71241b7fb6d35414b002656156f9"><div class="ttname"><a href="pdb_8cpp.html#a415a71241b7fb6d35414b002656156f9">hy36decodeSafe</a></div><div class="ttdeci">void hy36decodeSafe(unsigned width, const char *s, unsigned s_size, int *result)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01961">pdb.cpp:1961</a></div></div>
<div class="ttc" id="classRichAtom_html_a057f70d623841c7cfa24b8bfd0c692e7"><div class="ttname"><a href="classRichAtom.html#a057f70d623841c7cfa24b8bfd0c692e7">RichAtom::name</a></div><div class="ttdeci">std::string name</div><div class="ttdoc">Name. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00193">pdb.h:193</a></div></div>
<div class="ttc" id="classRichAtom_html_a127d9cf8d8dd82ea8ee12077a38cb2ef"><div class="ttname"><a href="classRichAtom.html#a127d9cf8d8dd82ea8ee12077a38cb2ef">RichAtom::icode</a></div><div class="ttdeci">std::string icode</div><div class="ttdoc">Icode. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00208">pdb.h:208</a></div></div>
<div class="ttc" id="classRichAtom_html_a692750caa66c2e66a01b4fbafad95f4b"><div class="ttname"><a href="classRichAtom.html#a692750caa66c2e66a01b4fbafad95f4b">RichAtom::z</a></div><div class="ttdeci">double z</div><div class="ttdoc">Position Z. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00190">pdb.h:190</a></div></div>
<div class="ttc" id="classRichAtom_html_aaccceebe63b5b2264d110119a95eb455"><div class="ttname"><a href="classRichAtom.html#aaccceebe63b5b2264d110119a95eb455">RichAtom::altloc</a></div><div class="ttdeci">std::string altloc</div><div class="ttdoc">Alternate location. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00196">pdb.h:196</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a18c915588d7a234d7041625866e7cdec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18c915588d7a234d7041625866e7cdec">&#9670;&nbsp;</a></span>writeCIF()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename callable &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void writeCIF </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>fnCIF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const callable &amp;&#160;</td>
          <td class="paramname"><em>atomList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cif::datablock &amp;&#160;</td>
          <td class="paramname"><em>dataBlock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write rich phantom to CIF file. </p>
<p>This function stores all the data of the rich phantom into a CIF file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fnPDB</td><td><a class="el" href="structPDB.html">PDB</a> file path to write to. </td></tr>
    <tr><td class="paramname">atomList</td><td>List of atoms to be stored. </td></tr>
    <tr><td class="paramname">dataBlock</td><td>Data block containing the full CIF file. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l00770">770</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;{</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="comment">// Opening CIF file</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    std::ofstream cifFile(fnCIF);</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="comment">// Creating atom_site category</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    cif::category atomSite(<span class="stringliteral">&quot;atom_site&quot;</span>);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    cif::row_initializer atomSiteInserter;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="comment">// Declaring temporary variables for occupancy, coords, and Bfactor</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    std::stringstream tempStream;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    std::string occupancy;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    std::string xPos;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    std::string yPos;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    std::string zPos;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    std::string bFactor;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="comment">// Inserting data from atom list</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classRichAtom.html">RichAtom</a> atom : atomList) {</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <span class="comment">// Converting occupancy to string with 2 fixed decimals</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        tempStream &lt;&lt; std::fixed &lt;&lt; std::setprecision(2) &lt;&lt; atom.occupancy;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        occupancy = tempStream.str();</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        tempStream.clear();</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        tempStream.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="comment">// Converting xPos to string with 3 fixed decimals</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        tempStream &lt;&lt; std::fixed &lt;&lt; std::setprecision(3) &lt;&lt; atom.x;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        xPos = tempStream.str();</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        tempStream.clear();</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        tempStream.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <span class="comment">// Converting yPos to string with 3 fixed decimals</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        tempStream &lt;&lt; std::fixed &lt;&lt; std::setprecision(3) &lt;&lt; atom.y;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        yPos = tempStream.str();</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        tempStream.clear();</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        tempStream.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <span class="comment">// Converting zPos to string with 3 fixed decimals</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        tempStream &lt;&lt; std::fixed &lt;&lt; std::setprecision(3) &lt;&lt; atom.z;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        zPos = tempStream.str();</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        tempStream.clear();</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        tempStream.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="comment">// Converting bFactor to string with 2 fixed decimals</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        tempStream &lt;&lt; std::fixed &lt;&lt; std::setprecision(2) &lt;&lt; atom.bfactor;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        bFactor = tempStream.str();</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        tempStream.clear();</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        tempStream.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="comment">// Defining row</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <span class="comment">// Empty string or char values are substitued with &quot;.&quot; or &#39;.&#39; (no value)</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        <span class="comment">// No &quot;?&quot; are inserted since it is not allowed by spec</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        atomSiteInserter = {</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            {<span class="stringliteral">&quot;group_PDB&quot;</span>, atom.record.empty() ? <span class="stringliteral">&quot;.&quot;</span> : atom.record},</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            {<span class="stringliteral">&quot;id&quot;</span>, atom.serial},</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            {<span class="stringliteral">&quot;type_symbol&quot;</span>, atom.name.empty() ? <span class="charliteral">&#39;.&#39;</span> : atom.name[0]},</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            {<span class="stringliteral">&quot;label_atom_id&quot;</span>, atom.name.empty() ? <span class="stringliteral">&quot;.&quot;</span> : atom.name},</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            {<span class="stringliteral">&quot;label_alt_id&quot;</span>, atom.altId.empty() ? <span class="stringliteral">&quot;.&quot;</span> : atom.altId},</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            {<span class="stringliteral">&quot;label_comp_id&quot;</span>, atom.resname.empty() ? <span class="stringliteral">&quot;.&quot;</span> : atom.resname},</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            {<span class="stringliteral">&quot;label_asym_id&quot;</span>, atom.altloc.empty() ? <span class="stringliteral">&quot;.&quot;</span> : atom.altloc},</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            {<span class="stringliteral">&quot;label_entity_id&quot;</span>, atom.resseq},</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            {<span class="stringliteral">&quot;label_seq_id&quot;</span>, atom.seqId},</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            {<span class="stringliteral">&quot;pdbx_PDB_ins_code&quot;</span>, atom.icode.empty() ? <span class="stringliteral">&quot;.&quot;</span> : atom.icode},</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            {<span class="stringliteral">&quot;Cartn_x&quot;</span>, xPos},</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            {<span class="stringliteral">&quot;Cartn_y&quot;</span>, yPos},</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            {<span class="stringliteral">&quot;Cartn_z&quot;</span>, zPos},</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            {<span class="stringliteral">&quot;occupancy&quot;</span>, occupancy},</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            {<span class="stringliteral">&quot;B_iso_or_equiv&quot;</span>, bFactor},</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            {<span class="stringliteral">&quot;pdbx_formal_charge&quot;</span>, atom.charge.empty() ? <span class="stringliteral">&quot;.&quot;</span> : atom.charge},</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            {<span class="stringliteral">&quot;auth_seq_id&quot;</span>, atom.authSeqId},</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            {<span class="stringliteral">&quot;auth_comp_id&quot;</span>, atom.authCompId.empty() ? <span class="stringliteral">&quot;.&quot;</span> : atom.authCompId},</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            {<span class="stringliteral">&quot;auth_asym_id&quot;</span>, atom.authAsymId.empty() ? <span class="stringliteral">&quot;.&quot;</span> : atom.authAsymId},</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            {<span class="stringliteral">&quot;auth_atom_id&quot;</span>, atom.authAtomId.empty() ? <span class="stringliteral">&quot;.&quot;</span> : atom.authAtomId},</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            {<span class="stringliteral">&quot;pdbx_PDB_model_num&quot;</span>, atom.pdbNum}</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        };</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <span class="comment">// Inserting row</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        atomSite.emplace(std::move(atomSiteInserter));</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    }</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="comment">// Updating atom list in stored data block</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> categoryIterator = std::find_if(dataBlock.begin(), dataBlock.end(), [](<span class="keyword">const</span> cif::category&amp; cat)</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        { <span class="keywordflow">return</span> cat.name() == <span class="stringliteral">&quot;atom_site&quot;</span>; }); categoryIterator != dataBlock.end()) {</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="keyword">auto</span> nextIterator = std::next(categoryIterator);</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        dataBlock.erase(categoryIterator);</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        dataBlock.insert(nextIterator, atomSite);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    }</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="comment">// Writing datablock to file</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    dataBlock.write(cifFile);</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="comment">// Closing file</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    cifFile.close();</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;}</div><div class="ttc" id="classRichAtom_html"><div class="ttname"><a href="classRichAtom.html">RichAtom</a></div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00174">pdb.h:174</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aae248e2d01ac40a2b06121ac27cad220"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae248e2d01ac40a2b06121ac27cad220">&#9670;&nbsp;</a></span>writePDB()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename callable &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void writePDB </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFileName.html">FileName</a> &amp;&#160;</td>
          <td class="paramname"><em>fnPDB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>renumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>remarks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const callable &amp;&#160;</td>
          <td class="paramname"><em>atomList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write rich phantom to <a class="el" href="structPDB.html">PDB</a> file. </p>
<p>This function stores all the data of the rich phantom into a <a class="el" href="structPDB.html">PDB</a> file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fnPDB</td><td><a class="el" href="structPDB.html">PDB</a> file to write to. </td></tr>
    <tr><td class="paramname">renumber</td><td>Flag for determining if atom's serial numbers must be renumbered or not. </td></tr>
    <tr><td class="paramname">remarks</td><td>List of remarks. </td></tr>
    <tr><td class="paramname">atomList</td><td>List of atoms to be stored. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l00722">722</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;{</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    FILE* fh_out=fopen(fnPDB.c_str(),<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="keywordflow">if</span> (!fh_out)</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aade13cf952393233aecd094ded7043d4a">ERR_IO_NOWRITE</a>, fnPDB);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keywordtype">size_t</span> imax=remarks.size();</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;imax; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#a1e53501a9f854141eabaa1cb9e8e75d6">fprintf</a>(fh_out,<span class="stringliteral">&quot;%s\n&quot;</span>,remarks[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].c_str());</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    imax=atomList.size();</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;imax; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    {</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        <span class="keyword">const</span> <a class="code" href="classRichAtom.html">RichAtom</a> &amp;atom=atomList[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="keywordtype">char</span> serial[5+1];</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <span class="keywordflow">if</span> (!renumber) {</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            <span class="keyword">auto</span>* errmsg3 = <a class="code" href="pdb_8cpp.html#a585418e13971c1ebd38e73af4d76d6a2">hy36encode</a>(5, atom.<a class="code" href="classRichAtom.html#afeec2ac638833f9b5f4eb6473908ec28">serial</a>, serial);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            <span class="keywordflow">if</span> (errmsg3) {</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                <a class="code" href="group__ErrorHandling.html#ga665d0601096fedced6de173b58082ad1">reportWarning</a>(<span class="stringliteral">&quot;Failed to use atom.serial. Using i+1 instead.&quot;</span>);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                renumber=<span class="keyword">true</span>;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                <a class="code" href="pdb_8cpp.html#a8c7461f600f53acbcb1d4091b3968b9b">hy36encodeSafe</a>(5, (<span class="keywordtype">int</span>)<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1, serial);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            }</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        }</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            <span class="comment">// use i+1 instead</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            <a class="code" href="pdb_8cpp.html#a8c7461f600f53acbcb1d4091b3968b9b">hy36encodeSafe</a>(5, (<span class="keywordtype">int</span>)<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1, serial);</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        }</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <span class="keywordtype">char</span> resseq[4+1];</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        <a class="code" href="pdb_8cpp.html#a8c7461f600f53acbcb1d4091b3968b9b">hy36encodeSafe</a>(4, atom.<a class="code" href="classRichAtom.html#afaa711a9cd6224cd70afbdd7557e3610">resseq</a>, resseq);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#a1e53501a9f854141eabaa1cb9e8e75d6">fprintf</a> (fh_out,<span class="stringliteral">&quot;%-6s%5s %-4s%s%-4s%c%4s%s   %8.3f%8.3f%8.3f%6.2f%6.2f      %4s%2s%-2s\n&quot;</span>,</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                atom.<a class="code" href="classRichAtom.html#a2ebbb806d48f8c663900bc6db18629b1">record</a>.c_str(),serial,atom.<a class="code" href="classRichAtom.html#a057f70d623841c7cfa24b8bfd0c692e7">name</a>.c_str(),</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                atom.<a class="code" href="classRichAtom.html#aaccceebe63b5b2264d110119a95eb455">altloc</a>.c_str(),atom.<a class="code" href="classRichAtom.html#ae7c5386af1f9abc91293b4d81c5a1bc6">resname</a>.c_str(),atom.<a class="code" href="classRichAtom.html#aae09bf2c30874729d81b8514f81d8f77">chainid</a>,</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                resseq,atom.<a class="code" href="classRichAtom.html#a127d9cf8d8dd82ea8ee12077a38cb2ef">icode</a>.c_str(),</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                atom.<a class="code" href="classRichAtom.html#addc1a7ccf33f9b83c4b6eb129d1b6fdc">x</a>,atom.<a class="code" href="classRichAtom.html#a302a9368cf4603393e0598bf937792b9">y</a>,atom.<a class="code" href="classRichAtom.html#a692750caa66c2e66a01b4fbafad95f4b">z</a>,atom.<a class="code" href="classRichAtom.html#a51c3f2e9d324858548565492af6e6900">occupancy</a>,atom.<a class="code" href="classRichAtom.html#a489199ee9fccf3ba7a4ddf5a4920330a">bfactor</a>,</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                atom.<a class="code" href="classRichAtom.html#abcc22f4cf1c1e2b2084edf36a518b0fd">segment</a>.c_str(),atom.<a class="code" href="classRichAtom.html#ab0f6d570d8c29187492000c4b01d2f08">atomType</a>.c_str(),atom.<a class="code" href="classRichAtom.html#a77ab18fea07169b94dabf503c2ae125a">charge</a>.c_str());</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    }</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    fclose(fh_out);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;}</div><div class="ttc" id="pdb_8cpp_html_a585418e13971c1ebd38e73af4d76d6a2"><div class="ttname"><a href="pdb_8cpp.html#a585418e13971c1ebd38e73af4d76d6a2">hy36encode</a></div><div class="ttdeci">const char * hy36encode(unsigned width, int value, char *result)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01817">pdb.cpp:1817</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga665d0601096fedced6de173b58082ad1"><div class="ttname"><a href="group__ErrorHandling.html#ga665d0601096fedced6de173b58082ad1">reportWarning</a></div><div class="ttdeci">void reportWarning(const String &amp;what)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8cpp_source.html#l00195">xmipp_error.cpp:195</a></div></div>
<div class="ttc" id="classRichAtom_html_abcc22f4cf1c1e2b2084edf36a518b0fd"><div class="ttname"><a href="classRichAtom.html#abcc22f4cf1c1e2b2084edf36a518b0fd">RichAtom::segment</a></div><div class="ttdeci">std::string segment</div><div class="ttdoc">segment name </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00224">pdb.h:224</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00211">xmipp_error.h:211</a></div></div>
<div class="ttc" id="classRichAtom_html_a77ab18fea07169b94dabf503c2ae125a"><div class="ttname"><a href="classRichAtom.html#a77ab18fea07169b94dabf503c2ae125a">RichAtom::charge</a></div><div class="ttdeci">std::string charge</div><div class="ttdoc">2-char charge with sign 2nd (e.g. 1- or 2+) </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00220">pdb.h:220</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aade13cf952393233aecd094ded7043d4a"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aade13cf952393233aecd094ded7043d4a">ERR_IO_NOWRITE</a></div><div class="ttdoc">Couldn&amp;#39;t write to file. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00140">xmipp_error.h:140</a></div></div>
<div class="ttc" id="classRichAtom_html_a2ebbb806d48f8c663900bc6db18629b1"><div class="ttname"><a href="classRichAtom.html#a2ebbb806d48f8c663900bc6db18629b1">RichAtom::record</a></div><div class="ttdeci">std::string record</div><div class="ttdoc">Record Type (&quot;ATOM  &quot; or &quot;HETATM&quot;) </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00178">pdb.h:178</a></div></div>
<div class="ttc" id="classRichAtom_html_aae09bf2c30874729d81b8514f81d8f77"><div class="ttname"><a href="classRichAtom.html#aae09bf2c30874729d81b8514f81d8f77">RichAtom::chainid</a></div><div class="ttdeci">char chainid</div><div class="ttdoc">ChainId. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00202">pdb.h:202</a></div></div>
<div class="ttc" id="classRichAtom_html_afeec2ac638833f9b5f4eb6473908ec28"><div class="ttname"><a href="classRichAtom.html#afeec2ac638833f9b5f4eb6473908ec28">RichAtom::serial</a></div><div class="ttdeci">int serial</div><div class="ttdoc">atom serial number </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00181">pdb.h:181</a></div></div>
<div class="ttc" id="classRichAtom_html"><div class="ttname"><a href="classRichAtom.html">RichAtom</a></div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00174">pdb.h:174</a></div></div>
<div class="ttc" id="classRichAtom_html_ae7c5386af1f9abc91293b4d81c5a1bc6"><div class="ttname"><a href="classRichAtom.html#ae7c5386af1f9abc91293b4d81c5a1bc6">RichAtom::resname</a></div><div class="ttdeci">std::string resname</div><div class="ttdoc">Residue name. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00199">pdb.h:199</a></div></div>
<div class="ttc" id="classRichAtom_html_ab0f6d570d8c29187492000c4b01d2f08"><div class="ttname"><a href="classRichAtom.html#ab0f6d570d8c29187492000c4b01d2f08">RichAtom::atomType</a></div><div class="ttdeci">std::string atomType</div><div class="ttdoc">atom element type </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00217">pdb.h:217</a></div></div>
<div class="ttc" id="pdb_8cpp_html_a8c7461f600f53acbcb1d4091b3968b9b"><div class="ttname"><a href="pdb_8cpp.html#a8c7461f600f53acbcb1d4091b3968b9b">hy36encodeSafe</a></div><div class="ttdeci">void hy36encodeSafe(unsigned width, int value, char *result)</div><div class="ttdef"><b>Definition:</b> <a href="pdb_8cpp_source.html#l01970">pdb.cpp:1970</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02493">numerical_recipes.cpp:2493</a></div></div>
<div class="ttc" id="classRichAtom_html_afaa711a9cd6224cd70afbdd7557e3610"><div class="ttname"><a href="classRichAtom.html#afaa711a9cd6224cd70afbdd7557e3610">RichAtom::resseq</a></div><div class="ttdeci">int resseq</div><div class="ttdoc">Residue sequence. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00205">pdb.h:205</a></div></div>
<div class="ttc" id="classRichAtom_html_a302a9368cf4603393e0598bf937792b9"><div class="ttname"><a href="classRichAtom.html#a302a9368cf4603393e0598bf937792b9">RichAtom::y</a></div><div class="ttdeci">double y</div><div class="ttdoc">Position Y. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00187">pdb.h:187</a></div></div>
<div class="ttc" id="classRichAtom_html_a51c3f2e9d324858548565492af6e6900"><div class="ttname"><a href="classRichAtom.html#a51c3f2e9d324858548565492af6e6900">RichAtom::occupancy</a></div><div class="ttdeci">double occupancy</div><div class="ttdoc">Occupancy. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00211">pdb.h:211</a></div></div>
<div class="ttc" id="classRichAtom_html_a489199ee9fccf3ba7a4ddf5a4920330a"><div class="ttname"><a href="classRichAtom.html#a489199ee9fccf3ba7a4ddf5a4920330a">RichAtom::bfactor</a></div><div class="ttdeci">double bfactor</div><div class="ttdoc">Bfactor. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00214">pdb.h:214</a></div></div>
<div class="ttc" id="classRichAtom_html_addc1a7ccf33f9b83c4b6eb129d1b6fdc"><div class="ttname"><a href="classRichAtom.html#addc1a7ccf33f9b83c4b6eb129d1b6fdc">RichAtom::x</a></div><div class="ttdeci">double x</div><div class="ttdoc">Position X. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00184">pdb.h:184</a></div></div>
<div class="ttc" id="classRichAtom_html_a057f70d623841c7cfa24b8bfd0c692e7"><div class="ttname"><a href="classRichAtom.html#a057f70d623841c7cfa24b8bfd0c692e7">RichAtom::name</a></div><div class="ttdeci">std::string name</div><div class="ttdoc">Name. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00193">pdb.h:193</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a1e53501a9f854141eabaa1cb9e8e75d6"><div class="ttname"><a href="numerical__recipes_8cpp.html#a1e53501a9f854141eabaa1cb9e8e75d6">fprintf</a></div><div class="ttdeci">fprintf(glob_prnt.io, &quot;\)</div></div>
<div class="ttc" id="classRichAtom_html_a127d9cf8d8dd82ea8ee12077a38cb2ef"><div class="ttname"><a href="classRichAtom.html#a127d9cf8d8dd82ea8ee12077a38cb2ef">RichAtom::icode</a></div><div class="ttdeci">std::string icode</div><div class="ttdoc">Icode. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00208">pdb.h:208</a></div></div>
<div class="ttc" id="classRichAtom_html_a692750caa66c2e66a01b4fbafad95f4b"><div class="ttname"><a href="classRichAtom.html#a692750caa66c2e66a01b4fbafad95f4b">RichAtom::z</a></div><div class="ttdeci">double z</div><div class="ttdoc">Position Z. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00190">pdb.h:190</a></div></div>
<div class="ttc" id="classRichAtom_html_aaccceebe63b5b2264d110119a95eb455"><div class="ttname"><a href="classRichAtom.html#aaccceebe63b5b2264d110119a95eb455">RichAtom::altloc</a></div><div class="ttdeci">std::string altloc</div><div class="ttdoc">Alternate location. </div><div class="ttdef"><b>Definition:</b> <a href="pdb_8h_source.html#l00196">pdb.h:196</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a2d5905ca42e031c3d91374c6eee83486"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d5905ca42e031c3d91374c6eee83486">&#9670;&nbsp;</a></span>globalAtom</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string globalAtom</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l01171">1171</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>

</div>
</div>
<a id="a03670ad2c03f04f1be8646970b6dc8dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03670ad2c03f04f1be8646970b6dc8dd">&#9670;&nbsp;</a></span>globalf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt;double&gt; globalf</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l01168">1168</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>

</div>
</div>
<a id="aab664bf51f4d185f6d849d750ac86fee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab664bf51f4d185f6d849d750ac86fee">&#9670;&nbsp;</a></span>globalHlpfPrm</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt;double&gt; globalHlpfPrm(3)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac1fe23303abe1c0c359bc1bfc59a5774"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1fe23303abe1c0c359bc1bfc59a5774">&#9670;&nbsp;</a></span>globalM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int globalM</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l01169">1169</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>

</div>
</div>
<a id="a70cffbaf2c91fc9c77305106b3b88d62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70cffbaf2c91fc9c77305106b3b88d62">&#9670;&nbsp;</a></span>globalT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double globalT</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pdb_8cpp_source.html#l01170">1170</a> of file <a class="el" href="pdb_8cpp_source.html">pdb.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
