<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Xmipp: xmipp/libraries/reconstruction/angular_projection_matching.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5bce755d3f27cf36e7d1a940cfd4182d.html">xmipp</a></li><li class="navelem"><a class="el" href="dir_29dba3f3840f20df3b04d1972e99046b.html">libraries</a></li><li class="navelem"><a class="el" href="dir_28683db7d591bb6aab1650ae2c6e488e.html">reconstruction</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">angular_projection_matching.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="angular__projection__matching_8h_source.html">angular_projection_matching.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="xmipp__image_8h_source.html">core/xmipp_image.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="metadata__vec_8h_source.html">core/metadata_vec.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fourier__projection_8h_source.html">data/fourier_projection.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ctf_8h_source.html">data/ctf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="filters_8h_source.html">data/filters.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for angular_projection_matching.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="angular__projection__matching_8cpp__incl.png" border="0" usemap="#xmipp_2libraries_2reconstruction_2angular__projection__matching_8cpp" alt=""/></div>
<map name="xmipp_2libraries_2reconstruction_2angular__projection__matching_8cpp" id="xmipp_2libraries_2reconstruction_2angular__projection__matching_8cpp">
</map>
</div>
</div>
<p><a href="angular__projection__matching_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a623b06eaa17f3ec38703913ffeb405b6"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="angular__projection__matching_8cpp.html#a623b06eaa17f3ec38703913ffeb405b6">threadRotationallyAlignOneImage</a> (void *data)</td></tr>
<tr class="separator:a623b06eaa17f3ec38703913ffeb405b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a410b5f1a0c131dee585b138a6a535b5d"><td class="memItemLeft" align="right" valign="top">pthread_mutex_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="angular__projection__matching_8cpp.html#a410b5f1a0c131dee585b138a6a535b5d">update_refs_in_memory_mutex</a> = PTHREAD_MUTEX_INITIALIZER</td></tr>
<tr class="separator:a410b5f1a0c131dee585b138a6a535b5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64015a110ae0539ff44eb52bb19f221d"><td class="memItemLeft" align="right" valign="top">pthread_mutex_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="angular__projection__matching_8cpp.html#a64015a110ae0539ff44eb52bb19f221d">debug_mutex</a> = PTHREAD_MUTEX_INITIALIZER</td></tr>
<tr class="separator:a64015a110ae0539ff44eb52bb19f221d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a623b06eaa17f3ec38703913ffeb405b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a623b06eaa17f3ec38703913ffeb405b6">&#9670;&nbsp;</a></span>threadRotationallyAlignOneImage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* threadRotationallyAlignOneImage </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="angular__projection__matching_8cpp_source.html#l00530">530</a> of file <a class="el" href="angular__projection__matching_8cpp_source.html">angular_projection_matching.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;{</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keyword">auto</span> * thread_data = (<a class="code" href="structstructThreadRotationallyAlignOneImage.html">structThreadRotationallyAlignOneImage</a> *) data;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment">// Variables from above</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordtype">size_t</span> thread_id = thread_data-&gt;thread_id;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <a class="code" href="classProgAngularProjectionMatching.html">ProgAngularProjectionMatching</a> *<a class="code" href="mpi__classify__CL2D_8cpp.html#a831c08adbb8230fd6a60f4a130923a19">prm</a> = thread_data-&gt;prm;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordtype">size_t</span> thread_num = prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#ac043b262d9dc89979be1587b43dbe937">threads</a>;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> *img = thread_data-&gt;img;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordtype">size_t</span> &amp;this_image = thread_data-&gt;this_image;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordtype">int</span> *opt_refno = thread_data-&gt;opt_refno;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordtype">double</span> *opt_psi = thread_data-&gt;opt_psi;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordtype">bool</span> *opt_flip = thread_data-&gt;opt_flip;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keywordtype">double</span> *maxcorr = thread_data-&gt;maxcorr;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">// Local variables</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a>       Maux;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a>       ang, corr;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;int&gt;</a>          indxCorr;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordtype">size_t</span>                      myinit, myfinal, myincr;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordtype">int</span>                         refno;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordtype">bool</span>                        done_once=<span class="keyword">false</span>;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordtype">double</span>                      mean, stddev;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <a class="code" href="classPolar.html">Polar&lt;double&gt;</a>               P;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <a class="code" href="classPolar.html">Polar&lt;std::complex &lt;double&gt;</a> &gt; fP,fPm;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <a class="code" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a>    rotAux;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <a class="code" href="classPolar__fftw__plans.html">Polar_fftw_plans</a>            local_plans;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordtype">size_t</span>                         imgno = this_image - <a class="code" href="xmipp__image__macros_8h.html#a351b4f5340ffda2f0414b8bbd9704347">FIRST_IMAGE</a>;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="preprocessor">#ifdef TIMING</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <a class="code" href="group__GeneralFunctions.html#ga5de338a0f59b7f4fe678fadfeb1c0049">TimeStamp</a> t0,t1,t2;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <a class="code" href="group__GeneralFunctions.html#ga30c9706995a8be40c4b2dbe055cdaede">time_config</a>();</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <a class="code" href="group__GeneralFunctions.html#ga4c1f5b466a107f359a15279ca1781392">annotate_time</a>(&amp;t0);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <a class="code" href="group__GeneralFunctions.html#ga4c1f5b466a107f359a15279ca1781392">annotate_time</a>(&amp;t2);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga098f5c8e7e9c010a3bf7ab82e31828a8">produceSplineCoefficients</a>(<a class="code" href="namespacexmipp__transformation.html#ac5f2bd2937d73c34ed4f6c6c5ff2492aac8f522643bcb55d76296b48480a99c44">xmipp_transformation::BSPLINE3</a>,Maux,*img);</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">// Precalculate polar transform of each translation</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="comment">// This loop is also threaded</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    myinit = thread_id;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    myincr = thread_num;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> itrans = myinit; itrans &lt; prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a037f376e933b93134ca3d6f117e3d756">nr_trans</a>; itrans+=myincr)</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    {</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        P.<a class="code" href="classPolar.html#a0ade05210836a466416ffcb85eb1dd4e">getPolarFromCartesianBSpline</a>(Maux,prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a60f6e7892e2cac3c25be6d46a4f9bdc5">Ri</a>,prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#ab67ae2242d1cd1fd2c1b106b1debff2d">Ro</a>,3,</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                                       (<span class="keywordtype">double</span>)prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a186aaabc17af38165deb81586e606cca">search5d_xoff</a>[itrans],</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                                       (<span class="keywordtype">double</span>)prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a8f71b2ce22933528a9f18e757ef6efac">search5d_yoff</a>[itrans]);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        P.<a class="code" href="classPolar.html#a2067567493494fbc39e0dac08a48c33d">computeAverageAndStddev</a>(mean,stddev);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        P -= mean; <span class="comment">// for normalized cross-correlation coefficient</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keywordflow">if</span> (itrans == myinit)</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            P.<a class="code" href="classPolar.html#a67490e990718a2221935ca2c017db1fb">calculateFftwPlans</a>(local_plans);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <a class="code" href="group__Polar.html#ga02e5b456ea900d6023ee4170514b9864">fourierTransformRings</a>(P,prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#aee78ecf7a18389e52940b9f4bf5dcff6">fP_img</a>[itrans],local_plans,<span class="keyword">false</span>);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <a class="code" href="group__Polar.html#ga02e5b456ea900d6023ee4170514b9864">fourierTransformRings</a>(P,prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a450a2dfc609d2b3003e3e998878082dc">fPm_img</a>[itrans],local_plans,<span class="keyword">true</span>);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a4e644422e07a3dc04ffcc5dbdb34eb52">stddev_img</a>[itrans] = stddev;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        done_once=<span class="keyword">true</span>;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment">// If thread did not have to do any itrans, initialize fftw plans</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">if</span> (!done_once)</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    {</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        P.<a class="code" href="classPolar.html#a0ade05210836a466416ffcb85eb1dd4e">getPolarFromCartesianBSpline</a>(Maux,prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a60f6e7892e2cac3c25be6d46a4f9bdc5">Ri</a>,prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#ab67ae2242d1cd1fd2c1b106b1debff2d">Ro</a>);</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        P.<a class="code" href="classPolar.html#a67490e990718a2221935ca2c017db1fb">calculateFftwPlans</a>(local_plans);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    }</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">// Prepare FFTW plan for rotational correlation</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    corr.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(P.<a class="code" href="classPolar.html#acf509af6f52da260dbfe4384a89cb5a7">getSampleNoOuterRing</a>());</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    rotAux.<a class="code" href="classRotationalCorrelationAux.html#ab6762c27fa075d4c124a5d33a286cd5a">local_transformer</a>.<a class="code" href="classFourierTransformer.html#a18bc840c781555b742d0185fb20925bf">setReal</a>(corr);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    rotAux.<a class="code" href="classRotationalCorrelationAux.html#ab6762c27fa075d4c124a5d33a286cd5a">local_transformer</a>.<a class="code" href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransform</a>();</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="comment">// All threads have to wait until the itrans loop is done</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <a class="code" href="group__Threads.html#ga99a3a59fba69ac42cf6fb51df0dc5b64">barrier_wait</a>(&amp;(prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a1c2f248db52457e702e7d626ba3e6547">thread_barrier</a>));</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="preprocessor">#ifdef TIMING</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordtype">float</span> prepare_img = <a class="code" href="group__GeneralFunctions.html#gac09ae5f9feab6050f92ee446eb09a3d2">elapsed_time</a>(t0);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordtype">float</span> get_refs = 0.;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <a class="code" href="group__GeneralFunctions.html#ga4c1f5b466a107f359a15279ca1781392">annotate_time</a>(&amp;t0);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="comment">//pthread_mutex_lock(  &amp;debug_mutex );</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="comment">// Switch the order of looping through the references every time.</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="comment">// That way, in case max_nr_refs_in_memory&lt;total_nr_refs</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="comment">// the references read in memory for the previous image</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="comment">// will still be there when processing the next image</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="comment">// Every thread processes a part of the references</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">if</span> (prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a9ceadd76e62fefe80a4fc832fca2c00f">loop_forward_refs</a>)</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    {</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        myinit = 0;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        myfinal = prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">mysampling</a>.<a class="code" href="classSampling.html#ad715aeed5db87a8176e98fbc9f73a588">my_neighbors</a>[imgno].size();</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        myincr = +1;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    }</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    {</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        myinit = prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">mysampling</a>.<a class="code" href="classSampling.html#ad715aeed5db87a8176e98fbc9f73a588">my_neighbors</a>[imgno].size() - 1;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        myfinal = -1;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        myincr = -1;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    }</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">// Loop over all relevant &quot;neighbours&quot; (i.e. directions within the search range)</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="comment">//for (int i = myinit; i != myfinal; i+=myincr)</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = myinit; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> != myfinal; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> += myincr)</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>%thread_num == thread_id)</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="preprocessor">#ifdef DEBUG_THREADS</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            pthread_mutex_lock(  &amp;<a class="code" href="angular__projection__matching_8cpp.html#a64015a110ae0539ff44eb52bb19f221d">debug_mutex</a> );</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            std::cerr&lt;&lt;<span class="stringliteral">&quot; thread_id= &quot;</span>&lt;&lt;thread_id&lt;&lt;<span class="stringliteral">&quot; i= &quot;</span>&lt;&lt;<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;myinit&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;myfinal&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;myincr&lt;&lt;std::endl;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            pthread_mutex_unlock(  &amp;<a class="code" href="angular__projection__matching_8cpp.html#a64015a110ae0539ff44eb52bb19f221d">debug_mutex</a> );</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="preprocessor">#ifdef TIMING</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <a class="code" href="group__GeneralFunctions.html#ga4c1f5b466a107f359a15279ca1781392">annotate_time</a>(&amp;t1);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            <span class="comment">// Get pointer to the current reference image</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            <span class="keywordflow">if</span>(prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">mysampling</a>.<a class="code" href="classSampling.html#ad715aeed5db87a8176e98fbc9f73a588">my_neighbors</a>[imgno][<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]==58)</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            {</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                std::cerr &lt;&lt; <span class="stringliteral">&quot;XXXXpointer_allrefs2refsinmemXXXXXX&quot;</span> &lt;&lt;std::endl;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                <span class="keywordflow">for</span> (std::vector&lt;int&gt;::iterator <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = prm-&gt;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                                                    pointer_allrefs2refsinmem.begin();</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                     <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> != prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#acd57f432b75da0e346c9c0df1b3e824f">pointer_allrefs2refsinmem</a>.end();</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                     ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                    std::cerr &lt;&lt; *<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                std::cerr &lt;&lt; <span class="stringliteral">&quot;XXXXpointer_refsinmem2allrefsXXXXXX&quot;</span> &lt;&lt;std::endl;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                <span class="keywordflow">for</span> (std::vector&lt;int&gt;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                     ::iterator <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#aeb35527c73b27e78c3ceb5cd3721f195">pointer_refsinmem2allrefs</a>.begin();</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                     <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> != prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#aeb35527c73b27e78c3ceb5cd3721f195">pointer_refsinmem2allrefs</a>.end();</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                     ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                    std::cerr &lt;&lt; *<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                std::cerr &lt;&lt;std::endl;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            }</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            refno = prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#acd57f432b75da0e346c9c0df1b3e824f">pointer_allrefs2refsinmem</a>[prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">mysampling</a>.<a class="code" href="classSampling.html#ad715aeed5db87a8176e98fbc9f73a588">my_neighbors</a>[imgno][<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]];</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <span class="keywordflow">if</span> (refno == -1)</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            {</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                <span class="comment">// Reference is not stored in memory (anymore): (re-)read from disc</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a2a08cfec5754dfeaa806ea6874fc2139">getCurrentReference</a>(prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">mysampling</a>.<a class="code" href="classSampling.html#ad715aeed5db87a8176e98fbc9f73a588">my_neighbors</a>[imgno][<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>],local_plans);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                refno = prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#acd57f432b75da0e346c9c0df1b3e824f">pointer_allrefs2refsinmem</a>[prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">mysampling</a>.<a class="code" href="classSampling.html#ad715aeed5db87a8176e98fbc9f73a588">my_neighbors</a>[imgno][<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]];</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            }</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="preprocessor">#ifdef TIMING</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            get_refs += <a class="code" href="group__GeneralFunctions.html#gac09ae5f9feab6050f92ee446eb09a3d2">elapsed_time</a>(t1);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            <span class="comment">//#define DEBUG</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            std::cerr &lt;&lt; <span class="stringliteral">&quot;imgno &quot;</span> &lt;&lt; imgno &lt;&lt;std::endl;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            std::cerr&lt;&lt;<span class="stringliteral">&quot;Got refno= &quot;</span>&lt;&lt;refno</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            &lt;&lt;<span class="stringliteral">&quot; pointer= &quot;</span>&lt;&lt;prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">mysampling</a>.<a class="code" href="classSampling.html#ad715aeed5db87a8176e98fbc9f73a588">my_neighbors</a>[imgno][<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]&lt;&lt;std::endl;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="comment">// Loop over all 5D-search translations</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> itrans = 0; itrans &lt; prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a037f376e933b93134ca3d6f117e3d756">nr_trans</a>; itrans++)</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            {</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                std::cerr&lt;&lt; <span class="stringliteral">&quot;prm-&gt;stddev_ref[refno], prm-&gt;stddev_img[itrans]: &quot;</span> &lt;&lt;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a4840d3dcdfe64b6fd3a02096e6c83573">stddev_ref</a>[refno] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a4e644422e07a3dc04ffcc5dbdb34eb52">stddev_img</a>[itrans];</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a>  allCorr, allAng;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                allCorr.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(corr)*2);</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                allAng.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(corr)*2);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                <span class="comment">// A. Check straight image</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                <a class="code" href="group__Polar.html#ga61e0a0f95b718c9957d51cfa6e91daf8">rotationalCorrelation</a>(prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#aee78ecf7a18389e52940b9f4bf5dcff6">fP_img</a>[itrans],</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                                      prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#aadc634e170de9a09b2870fab90bd0dac">fP_ref</a>[refno],</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                                      ang,rotAux);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                corr /= prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a4840d3dcdfe64b6fd3a02096e6c83573">stddev_ref</a>[refno] * prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a4e644422e07a3dc04ffcc5dbdb34eb52">stddev_img</a>[itrans]; <span class="comment">// for normalized ccf</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                memcpy(&amp;<a class="code" href="multidim__array__base_8h.html#a53e37122134100316031eae982abee03">dAi</a>(allCorr,0),&amp;<a class="code" href="multidim__array__base_8h.html#a53e37122134100316031eae982abee03">dAi</a>(corr,0),<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(corr)*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                memcpy(&amp;<a class="code" href="multidim__array__base_8h.html#a53e37122134100316031eae982abee03">dAi</a>(allAng,0),&amp;<a class="code" href="multidim__array__base_8h.html#a53e37122134100316031eae982abee03">dAi</a>(ang,0),<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(ang)*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                <a class="code" href="group__Polar.html#ga61e0a0f95b718c9957d51cfa6e91daf8">rotationalCorrelation</a>(prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a450a2dfc609d2b3003e3e998878082dc">fPm_img</a>[itrans],prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#aadc634e170de9a09b2870fab90bd0dac">fP_ref</a>[refno],ang,rotAux);</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                corr /= prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a4840d3dcdfe64b6fd3a02096e6c83573">stddev_ref</a>[refno] * prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a4e644422e07a3dc04ffcc5dbdb34eb52">stddev_img</a>[itrans]; <span class="comment">// for normalized ccf</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                memcpy(&amp;<a class="code" href="multidim__array__base_8h.html#a53e37122134100316031eae982abee03">dAi</a>(allCorr,<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(corr)),&amp;<a class="code" href="multidim__array__base_8h.html#a53e37122134100316031eae982abee03">dAi</a>(corr,0),<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(corr)*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                memcpy(&amp;<a class="code" href="multidim__array__base_8h.html#a53e37122134100316031eae982abee03">dAi</a>(allAng,<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(corr)),&amp;<a class="code" href="multidim__array__base_8h.html#a53e37122134100316031eae982abee03">dAi</a>(ang,0),<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(corr)*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                <span class="keywordtype">size_t</span> nIter = <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(thread_data-&gt;numOrientations,corr.<a class="code" href="classMultidimArrayBase.html#a93a3570eb9d39368957d015f880f6f6d">getSize</a>());</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                <span class="keywordtype">double</span> bestLastCorr = 99e99;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = 0; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> &lt; nIter; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>++)</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                {</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> = 0; <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> &lt; <a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(allCorr); <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>++)</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                    {</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                        <span class="keywordflow">if</span> ( (<a class="code" href="multidim__array__base_8h.html#aa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a>(allCorr,<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>)&gt; maxcorr[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>]) &amp;&amp; (<a class="code" href="multidim__array__base_8h.html#aa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a>(allCorr,<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>)&lt;bestLastCorr))</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                        {</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                            maxcorr[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>] = <a class="code" href="multidim__array__base_8h.html#aa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a>(allCorr,<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>);</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                            opt_psi[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>] = <a class="code" href="multidim__array__base_8h.html#aa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a>(allAng,<a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a>);</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                            <span class="comment">//FIXME not sure about FIRST_IMAGE</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                            opt_refno[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>] = prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">mysampling</a>.<a class="code" href="classSampling.html#ad715aeed5db87a8176e98fbc9f73a588">my_neighbors</a>[imgno][<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];<span class="comment">/*+FIRST_IMAGE;*/</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                            <span class="keywordflow">if</span> ( <a class="code" href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a> &gt;= <a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(corr))</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                                opt_flip[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>] = <span class="keyword">true</span>;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                            <span class="keywordflow">else</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                                opt_flip[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>] = <span class="keyword">false</span>;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                        }</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                    }</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                    bestLastCorr = maxcorr[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>];</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                }</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                std::cerr&lt;&lt;<span class="stringliteral">&quot;mirror: corr &quot;</span>&lt;&lt;maxcorr;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                <span class="keywordflow">if</span> (opt_flip)</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                    std::cerr&lt;&lt;<span class="stringliteral">&quot;**&quot;</span>;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                std::cerr&lt;&lt;std::endl;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="preprocessor">#undef DEBUG</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            }</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            <span class="comment">//#define DEBUG</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            std::cerr &lt;&lt; <span class="stringliteral">&quot;DEBUG_ROB, imgno:&quot;</span> &lt;&lt; imgno &lt;&lt; std::endl;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            std::cerr &lt;&lt; <span class="stringliteral">&quot;DEBUG_ROB, i:&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            std::cerr &lt;&lt; <span class="stringliteral">&quot;DEBUG_ROB, prm-&gt;mysampling.my_neighbors[imgno][i]:&quot;</span> &lt;&lt; prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">mysampling</a>.<a class="code" href="classSampling.html#ad715aeed5db87a8176e98fbc9f73a588">my_neighbors</a>[imgno][<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; std::endl;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            std::cerr&lt;&lt;<span class="stringliteral">&quot;straight: corr &quot;</span>&lt;&lt;maxcorr&lt;&lt;std::endl;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="preprocessor">#undef DEBUG</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        }</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    }</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="preprocessor">#ifdef TIMING</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keywordtype">float</span> all_rot_align = <a class="code" href="group__GeneralFunctions.html#gac09ae5f9feab6050f92ee446eb09a3d2">elapsed_time</a>(t0);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordtype">float</span> total_rot = <a class="code" href="group__GeneralFunctions.html#gac09ae5f9feab6050f92ee446eb09a3d2">elapsed_time</a>(t2);</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    std::cerr&lt;&lt;<span class="stringliteral">&quot; rotal%% &quot;</span>&lt;&lt;total_rot</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    &lt;&lt;<span class="stringliteral">&quot; =&gt; prep: &quot;</span>&lt;&lt;prepare_img</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    &lt;&lt;<span class="stringliteral">&quot; all_refs: &quot;</span>&lt;&lt;all_rot_align</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    &lt;&lt;<span class="stringliteral">&quot; (of which &quot;</span>&lt;&lt;get_refs</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    &lt;&lt;<span class="stringliteral">&quot; to get &quot;</span>&lt;&lt; prm-&gt;<a class="code" href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">mysampling</a>.<a class="code" href="classSampling.html#ad715aeed5db87a8176e98fbc9f73a588">my_neighbors</a>[imgno].size()</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    &lt;&lt;<span class="stringliteral">&quot; refs for imgno &quot;</span>&lt;&lt;imgno&lt;&lt;<span class="stringliteral">&quot; )&quot;</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    &lt;&lt;std::endl;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="comment">//pthread_mutex_unlock(  &amp;debug_mutex );</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="comment">//std::cerr &lt;&lt; &quot;DEBUG_JM: threadRotationallyAlignOneImage END&quot; &lt;&lt;std::endl;</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;}</div><div class="ttc" id="multidim__array__base_8h_html_a53e37122134100316031eae982abee03"><div class="ttname"><a href="multidim__array__base_8h.html#a53e37122134100316031eae982abee03">dAi</a></div><div class="ttdeci">#define dAi(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00530">multidim_array_base.h:530</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_acd57f432b75da0e346c9c0df1b3e824f"><div class="ttname"><a href="classProgAngularProjectionMatching.html#acd57f432b75da0e346c9c0df1b3e824f">ProgAngularProjectionMatching::pointer_allrefs2refsinmem</a></div><div class="ttdeci">std::vector&lt; int &gt; pointer_allrefs2refsinmem</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00097">angular_projection_matching.h:97</a></div></div>
<div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00982">multidim_array.cpp:982</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a33132687def0129f4c14fa9c068a0d19"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a33132687def0129f4c14fa9c068a0d19">ProgAngularProjectionMatching::mysampling</a></div><div class="ttdeci">Sampling mysampling</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00112">angular_projection_matching.h:112</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a2a08cfec5754dfeaa806ea6874fc2139"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a2a08cfec5754dfeaa806ea6874fc2139">ProgAngularProjectionMatching::getCurrentReference</a></div><div class="ttdeci">void getCurrentReference(int refno, Polar_fftw_plans &amp;local_plans)</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8cpp_source.html#l00408">angular_projection_matching.cpp:408</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a186aaabc17af38165deb81586e606cca"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a186aaabc17af38165deb81586e606cca">ProgAngularProjectionMatching::search5d_xoff</a></div><div class="ttdeci">std::vector&lt; int &gt; search5d_xoff</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00121">angular_projection_matching.h:121</a></div></div>
<div class="ttc" id="classMultidimArray_html_ac0efebfb32ab4e37cf33efca3349aa9b"><div class="ttname"><a href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">MultidimArray::resizeNoCopy</a></div><div class="ttdeci">void resizeNoCopy(const MultidimArray&lt; T1 &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00470">multidim_array.h:470</a></div></div>
<div class="ttc" id="structstructThreadRotationallyAlignOneImage_html"><div class="ttname"><a href="structstructThreadRotationallyAlignOneImage.html">structThreadRotationallyAlignOneImage</a></div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00048">angular_projection_matching.h:48</a></div></div>
<div class="ttc" id="classPolar_html_acf509af6f52da260dbfe4384a89cb5a7"><div class="ttname"><a href="classPolar.html#acf509af6f52da260dbfe4384a89cb5a7">Polar::getSampleNoOuterRing</a></div><div class="ttdeci">int getSampleNoOuterRing() const</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00386">polar.h:386</a></div></div>
<div class="ttc" id="group__Polar_html_ga61e0a0f95b718c9957d51cfa6e91daf8"><div class="ttname"><a href="group__Polar.html#ga61e0a0f95b718c9957d51cfa6e91daf8">rotationalCorrelation</a></div><div class="ttdeci">void rotationalCorrelation(const Polar&lt; std::complex&lt; double &gt; &gt; &amp;M1, const Polar&lt; std::complex&lt; double &gt; &gt; &amp;M2, MultidimArray&lt; double &gt; &amp;angles, RotationalCorrelationAux &amp;aux)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8cpp_source.html#l00099">polar.cpp:99</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a8f71b2ce22933528a9f18e757ef6efac"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a8f71b2ce22933528a9f18e757ef6efac">ProgAngularProjectionMatching::search5d_yoff</a></div><div class="ttdeci">std::vector&lt; int &gt; search5d_yoff</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00121">angular_projection_matching.h:121</a></div></div>
<div class="ttc" id="classPolar_html_a2067567493494fbc39e0dac08a48c33d"><div class="ttname"><a href="classPolar.html#a2067567493494fbc39e0dac08a48c33d">Polar::computeAverageAndStddev</a></div><div class="ttdeci">void computeAverageAndStddev(double &amp;avg, double &amp;stddev, int mode=FULL_CIRCLES) const</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00488">polar.h:488</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_gac09ae5f9feab6050f92ee446eb09a3d2"><div class="ttname"><a href="group__GeneralFunctions.html#gac09ae5f9feab6050f92ee446eb09a3d2">elapsed_time</a></div><div class="ttdeci">double elapsed_time(ProcessorTimeStamp &amp;time, bool _IN_SECS)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00739">xmipp_funcs.cpp:739</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aadc634e170de9a09b2870fab90bd0dac"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aadc634e170de9a09b2870fab90bd0dac">ProgAngularProjectionMatching::fP_ref</a></div><div class="ttdeci">Polar&lt; std::complex&lt; double &gt; &gt; * fP_ref</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00104">angular_projection_matching.h:104</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a49b762d2a516fa75afa9a3c581a8e893"><div class="ttname"><a href="numerical__recipes_8cpp.html#a49b762d2a516fa75afa9a3c581a8e893">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1), &amp;iout, infoqp, &amp;zero,(w+1), &amp;lenw,(iw+1), &amp;leniw, &amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a037f376e933b93134ca3d6f117e3d756"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a037f376e933b93134ca3d6f117e3d756">ProgAngularProjectionMatching::nr_trans</a></div><div class="ttdeci">size_t nr_trans</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00131">angular_projection_matching.h:131</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga30c9706995a8be40c4b2dbe055cdaede"><div class="ttname"><a href="group__GeneralFunctions.html#ga30c9706995a8be40c4b2dbe055cdaede">time_config</a></div><div class="ttdeci">void time_config()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00628">xmipp_funcs.cpp:628</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_aa6b2513810dd91e11450be99106a2463"><div class="ttname"><a href="multidim__array__base_8h.html#aa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a></div><div class="ttdeci">#define DIRECT_A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00526">multidim_array_base.h:526</a></div></div>
<div class="ttc" id="angular__projection__matching_8cpp_html_a64015a110ae0539ff44eb52bb19f221d"><div class="ttname"><a href="angular__projection__matching_8cpp.html#a64015a110ae0539ff44eb52bb19f221d">debug_mutex</a></div><div class="ttdeci">pthread_mutex_t debug_mutex</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8cpp_source.html#l00040">angular_projection_matching.cpp:40</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a18bc840c781555b742d0185fb20925bf"><div class="ttname"><a href="classFourierTransformer.html#a18bc840c781555b742d0185fb20925bf">FourierTransformer::setReal</a></div><div class="ttdeci">void setReal(MultidimArray&lt; double &gt; &amp;img)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00129">xmipp_fftw.cpp:129</a></div></div>
<div class="ttc" id="classPolar_html_a0ade05210836a466416ffcb85eb1dd4e"><div class="ttname"><a href="classPolar.html#a0ade05210836a466416ffcb85eb1dd4e">Polar::getPolarFromCartesianBSpline</a></div><div class="ttdeci">void getPolarFromCartesianBSpline(const MultidimArray&lt; T &gt; &amp;M1, int first_ring, int last_ring, int BsplineOrder=3, double xoff=0., double yoff=0., double oversample1=1., int mode1=FULL_CIRCLES)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00625">polar.h:625</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga098f5c8e7e9c010a3bf7ab82e31828a8"><div class="ttname"><a href="group__GeometricalTransformations.html#ga098f5c8e7e9c010a3bf7ab82e31828a8">produceSplineCoefficients</a></div><div class="ttdeci">void produceSplineCoefficients(int SplineDegree, MultidimArray&lt; double &gt; &amp;coeffs, const MultidimArray&lt; T &gt; &amp;V1)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00040">transformations.cpp:40</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00091">multidim_array_base.h:91</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a4840d3dcdfe64b6fd3a02096e6c83573"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a4840d3dcdfe64b6fd3a02096e6c83573">ProgAngularProjectionMatching::stddev_ref</a></div><div class="ttdeci">double * stddev_ref</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00110">angular_projection_matching.h:110</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a93a3570eb9d39368957d015f880f6f6d"><div class="ttname"><a href="classMultidimArrayBase.html#a93a3570eb9d39368957d015f880f6f6d">MultidimArrayBase::getSize</a></div><div class="ttdeci">size_t getSize() const</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8cpp_source.html#l00169">multidim_array_base.cpp:169</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a9ceadd76e62fefe80a4fc832fca2c00f"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a9ceadd76e62fefe80a4fc832fca2c00f">ProgAngularProjectionMatching::loop_forward_refs</a></div><div class="ttdeci">bool loop_forward_refs</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00115">angular_projection_matching.h:115</a></div></div>
<div class="ttc" id="classFourierTransformer_html_abfdc5699d3c579a26bba39ec679b5adc"><div class="ttname"><a href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransformer::FourierTransform</a></div><div class="ttdeci">void FourierTransform(T &amp;v, T1 &amp;V, bool getCopy=true)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00166">xmipp_fftw.h:166</a></div></div>
<div class="ttc" id="classPolar__fftw__plans_html"><div class="ttname"><a href="classPolar__fftw__plans.html">Polar_fftw_plans</a></div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00052">polar.h:52</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a450a2dfc609d2b3003e3e998878082dc"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a450a2dfc609d2b3003e3e998878082dc">ProgAngularProjectionMatching::fPm_img</a></div><div class="ttdeci">Polar&lt; std::complex&lt; double &gt; &gt; * fPm_img</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00104">angular_projection_matching.h:104</a></div></div>
<div class="ttc" id="group__Macros_html_gac9ae6a207f10c821b06a8c0df153a7d5"><div class="ttname"><a href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a></div><div class="ttdeci">#define XMIPP_MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00181">xmipp_macros.h:181</a></div></div>
<div class="ttc" id="classSampling_html_ad715aeed5db87a8176e98fbc9f73a588"><div class="ttname"><a href="classSampling.html#ad715aeed5db87a8176e98fbc9f73a588">Sampling::my_neighbors</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; size_t &gt; &gt; my_neighbors</div><div class="ttdef"><b>Definition:</b> <a href="sampling_8h_source.html#l00087">sampling.h:87</a></div></div>
<div class="ttc" id="group__Polar_html_ga02e5b456ea900d6023ee4170514b9864"><div class="ttname"><a href="group__Polar.html#ga02e5b456ea900d6023ee4170514b9864">fourierTransformRings</a></div><div class="ttdeci">void fourierTransformRings(Polar&lt; double &gt; &amp;in, Polar&lt; std::complex&lt; double &gt; &gt; &amp;out, Polar_fftw_plans &amp;plans, bool conjugated)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8cpp_source.html#l00034">polar.cpp:34</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a4e644422e07a3dc04ffcc5dbdb34eb52"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a4e644422e07a3dc04ffcc5dbdb34eb52">ProgAngularProjectionMatching::stddev_img</a></div><div class="ttdeci">double * stddev_img</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00110">angular_projection_matching.h:110</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_ac043b262d9dc89979be1587b43dbe937"><div class="ttname"><a href="classProgAngularProjectionMatching.html#ac043b262d9dc89979be1587b43dbe937">ProgAngularProjectionMatching::threads</a></div><div class="ttdeci">int threads</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00127">angular_projection_matching.h:127</a></div></div>
<div class="ttc" id="classPolar_html"><div class="ttname"><a href="classPolar.html">Polar&lt; double &gt;</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_ab67ae2242d1cd1fd2c1b106b1debff2d"><div class="ttname"><a href="classProgAngularProjectionMatching.html#ab67ae2242d1cd1fd2c1b106b1debff2d">ProgAngularProjectionMatching::Ro</a></div><div class="ttdeci">int Ro</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00082">angular_projection_matching.h:82</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aee78ecf7a18389e52940b9f4bf5dcff6"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aee78ecf7a18389e52940b9f4bf5dcff6">ProgAngularProjectionMatching::fP_img</a></div><div class="ttdeci">Polar&lt; std::complex&lt; double &gt; &gt; * fP_img</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00104">angular_projection_matching.h:104</a></div></div>
<div class="ttc" id="classRotationalCorrelationAux_html_ab6762c27fa075d4c124a5d33a286cd5a"><div class="ttname"><a href="classRotationalCorrelationAux.html#ab6762c27fa075d4c124a5d33a286cd5a">RotationalCorrelationAux::local_transformer</a></div><div class="ttdeci">FourierTransformer local_transformer</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00794">polar.h:794</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_aeb35527c73b27e78c3ceb5cd3721f195"><div class="ttname"><a href="classProgAngularProjectionMatching.html#aeb35527c73b27e78c3ceb5cd3721f195">ProgAngularProjectionMatching::pointer_refsinmem2allrefs</a></div><div class="ttdeci">std::vector&lt; int &gt; pointer_refsinmem2allrefs</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00098">angular_projection_matching.h:98</a></div></div>
<div class="ttc" id="classRotationalCorrelationAux_html"><div class="ttname"><a href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a></div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00791">polar.h:791</a></div></div>
<div class="ttc" id="xmipp__image__macros_8h_html_a351b4f5340ffda2f0414b8bbd9704347"><div class="ttname"><a href="xmipp__image__macros_8h.html#a351b4f5340ffda2f0414b8bbd9704347">FIRST_IMAGE</a></div><div class="ttdeci">#define FIRST_IMAGE</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__macros_8h_source.html#l00038">xmipp_image_macros.h:38</a></div></div>
<div class="ttc" id="mpi__classify__CL2D_8cpp_html_a831c08adbb8230fd6a60f4a130923a19"><div class="ttname"><a href="mpi__classify__CL2D_8cpp.html#a831c08adbb8230fd6a60f4a130923a19">prm</a></div><div class="ttdeci">ProgClassifyCL2D * prm</div><div class="ttdef"><b>Definition:</b> <a href="mpi__classify__CL2D_8cpp_source.html#l00035">mpi_classify_CL2D.cpp:35</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga4c1f5b466a107f359a15279ca1781392"><div class="ttname"><a href="group__GeneralFunctions.html#ga4c1f5b466a107f359a15279ca1781392">annotate_time</a></div><div class="ttdeci">void annotate_time(TimeStamp *time)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00646">xmipp_funcs.cpp:646</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a60f6e7892e2cac3c25be6d46a4f9bdc5"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a60f6e7892e2cac3c25be6d46a4f9bdc5">ProgAngularProjectionMatching::Ri</a></div><div class="ttdeci">int Ri</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00082">angular_projection_matching.h:82</a></div></div>
<div class="ttc" id="group__Threads_html_ga99a3a59fba69ac42cf6fb51df0dc5b64"><div class="ttname"><a href="group__Threads.html#ga99a3a59fba69ac42cf6fb51df0dc5b64">barrier_wait</a></div><div class="ttdeci">int barrier_wait(barrier_t *barrier)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__threads_8cpp_source.html#l00382">xmipp_threads.cpp:382</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html_a1c2f248db52457e702e7d626ba3e6547"><div class="ttname"><a href="classProgAngularProjectionMatching.html#a1c2f248db52457e702e7d626ba3e6547">ProgAngularProjectionMatching::thread_barrier</a></div><div class="ttdeci">barrier_t thread_barrier</div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00133">angular_projection_matching.h:133</a></div></div>
<div class="ttc" id="classProgAngularProjectionMatching_html"><div class="ttname"><a href="classProgAngularProjectionMatching.html">ProgAngularProjectionMatching</a></div><div class="ttdef"><b>Definition:</b> <a href="angular__projection__matching_8h_source.html#l00064">angular_projection_matching.h:64</a></div></div>
<div class="ttc" id="classPolar_html_a67490e990718a2221935ca2c017db1fb"><div class="ttname"><a href="classPolar.html#a67490e990718a2221935ca2c017db1fb">Polar::calculateFftwPlans</a></div><div class="ttdeci">void calculateFftwPlans(Polar_fftw_plans &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00708">polar.h:708</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga5de338a0f59b7f4fe678fadfeb1c0049"><div class="ttname"><a href="group__GeneralFunctions.html#ga5de338a0f59b7f4fe678fadfeb1c0049">TimeStamp</a></div><div class="ttdeci">size_t TimeStamp</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8h_source.html#l00823">xmipp_funcs.h:823</a></div></div>
<div class="ttc" id="namespacexmipp__transformation_html_ac5f2bd2937d73c34ed4f6c6c5ff2492aac8f522643bcb55d76296b48480a99c44"><div class="ttname"><a href="namespacexmipp__transformation.html#ac5f2bd2937d73c34ed4f6c6c5ff2492aac8f522643bcb55d76296b48480a99c44">xmipp_transformation::BSPLINE3</a></div><div class="ttdef"><b>Definition:</b> <a href="transformations__defines_8h_source.html#l00032">transformations_defines.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a64015a110ae0539ff44eb52bb19f221d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64015a110ae0539ff44eb52bb19f221d">&#9670;&nbsp;</a></span>debug_mutex</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pthread_mutex_t debug_mutex = PTHREAD_MUTEX_INITIALIZER</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="angular__projection__matching_8cpp_source.html#l00040">40</a> of file <a class="el" href="angular__projection__matching_8cpp_source.html">angular_projection_matching.cpp</a>.</p>

</div>
</div>
<a id="a410b5f1a0c131dee585b138a6a535b5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a410b5f1a0c131dee585b138a6a535b5d">&#9670;&nbsp;</a></span>update_refs_in_memory_mutex</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pthread_mutex_t update_refs_in_memory_mutex = PTHREAD_MUTEX_INITIALIZER</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="angular__projection__matching_8cpp_source.html#l00039">39</a> of file <a class="el" href="angular__projection__matching_8cpp_source.html">angular_projection_matching.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
