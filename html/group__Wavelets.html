<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Xmipp: Wavelets</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a>  </div>
  <div class="headertitle">
<div class="title">Wavelets</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga35de5a5968bf5312998795c8faca73cb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga35de5a5968bf5312998795c8faca73cb">HAAR</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:ga35de5a5968bf5312998795c8faca73cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf7dda95ec4bf156694bbd8eac1af019d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#gaf7dda95ec4bf156694bbd8eac1af019d">DAUB4</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:gaf7dda95ec4bf156694bbd8eac1af019d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4f4614723b76996e11f1dcda8a946f2f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga4f4614723b76996e11f1dcda8a946f2f">DAUB12</a>&#160;&#160;&#160;12</td></tr>
<tr class="separator:ga4f4614723b76996e11f1dcda8a946f2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga346d4411a461be0aabcd80d91f7aed43"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga346d4411a461be0aabcd80d91f7aed43">DAUB20</a>&#160;&#160;&#160;20</td></tr>
<tr class="separator:ga346d4411a461be0aabcd80d91f7aed43"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Wavelet transform</h2></td></tr>
<tr class="memitem:gaf95d660c27fe984d219a81c419c7ddba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#gaf95d660c27fe984d219a81c419c7ddba">Bilib_DWT</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;input, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;result, int iterations, int isign=1)</td></tr>
<tr class="separator:gaf95d660c27fe984d219a81c419c7ddba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5cb8eeb7258f5d05a5a9b1fdae7b2491"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga5cb8eeb7258f5d05a5a9b1fdae7b2491">set_DWT_type</a> (int DWT_type)</td></tr>
<tr class="separator:ga5cb8eeb7258f5d05a5a9b1fdae7b2491"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab61cdb597192ddae3cf7257eb716d3ed"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a> (int size)</td></tr>
<tr class="separator:gab61cdb597192ddae3cf7257eb716d3ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4c3d81cae44d7519925c0a1634a8fedc"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga4c3d81cae44d7519925c0a1634a8fedc"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga4c3d81cae44d7519925c0a1634a8fedc">DWT</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;v, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;result, int isign=1)</td></tr>
<tr class="separator:ga4c3d81cae44d7519925c0a1634a8fedc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6da81c27c1780c116902bb6e720dc52d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga6da81c27c1780c116902bb6e720dc52d">IDWT</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;v, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;result)</td></tr>
<tr class="separator:ga6da81c27c1780c116902bb6e720dc52d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Wavelet related functions</h2></td></tr>
<tr class="memitem:gad8943a584c4fe3eafe22190effbd6c50"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#gad8943a584c4fe3eafe22190effbd6c50">DWT_lowpass2D</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;v, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;result)</td></tr>
<tr class="separator:gad8943a584c4fe3eafe22190effbd6c50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf3291e2f171b751e81d86aaef7d24541"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:gaf3291e2f171b751e81d86aaef7d24541"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a> (int scale, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;I, const std::string &amp;quadrant, int &amp;x1, int &amp;x2)</td></tr>
<tr class="separator:gaf3291e2f171b751e81d86aaef7d24541"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7a48f0c73f02f4f35307ae4597c3f4d3"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga7a48f0c73f02f4f35307ae4597c3f4d3"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga7a48f0c73f02f4f35307ae4597c3f4d3">SelectDWTBlock</a> (int scale, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;I, const std::string &amp;quadrant, int &amp;x1, int &amp;x2, int &amp;y1, int &amp;y2)</td></tr>
<tr class="separator:ga7a48f0c73f02f4f35307ae4597c3f4d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5901cdd694130c81552a2bc256728bbc"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga5901cdd694130c81552a2bc256728bbc"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga5901cdd694130c81552a2bc256728bbc">SelectDWTBlock</a> (int scale, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;I, const std::string &amp;quadrant, int &amp;x1, int &amp;x2, int &amp;y1, int &amp;y2, int &amp;z1, int &amp;z2)</td></tr>
<tr class="separator:ga5901cdd694130c81552a2bc256728bbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab7d31fd1de9a5f5f709bdaa36f93030e"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#gab7d31fd1de9a5f5f709bdaa36f93030e">Quadrant2D</a> (int q)</td></tr>
<tr class="separator:gab7d31fd1de9a5f5f709bdaa36f93030e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0faa94d9847d48812e86f1b12ef348f2"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga0faa94d9847d48812e86f1b12ef348f2">Quadrant3D</a> (int q)</td></tr>
<tr class="separator:ga0faa94d9847d48812e86f1b12ef348f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga70aa9e2ca9a52462e739fede341d4b39"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga70aa9e2ca9a52462e739fede341d4b39">Get_Scale_Quadrant</a> (int size_x, int <a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, int &amp;scale, std::string &amp;quadrant)</td></tr>
<tr class="separator:ga70aa9e2ca9a52462e739fede341d4b39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5c65dfc02483da15312800eeb3f8b89b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga5c65dfc02483da15312800eeb3f8b89b">Get_Scale_Quadrant</a> (int size_x, int size_y, int <a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, int <a class="el" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, int &amp;scale, std::string &amp;quadrant)</td></tr>
<tr class="separator:ga5c65dfc02483da15312800eeb3f8b89b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaae9117cdf458df110d3e3158b9866ddc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#gaae9117cdf458df110d3e3158b9866ddc">Get_Scale_Quadrant</a> (int size_x, int size_y, int size_z, int <a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, int <a class="el" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, int <a class="el" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>, int &amp;scale, std::string &amp;quadrant)</td></tr>
<tr class="separator:gaae9117cdf458df110d3e3158b9866ddc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga23656fc9d337ac193efa522e54b14b1c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga23656fc9d337ac193efa522e54b14b1c">DWT_Imin</a>(s,  smax,  l)</td></tr>
<tr class="separator:ga23656fc9d337ac193efa522e54b14b1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8a33c313d15b15bdd47121737e57e636"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga8a33c313d15b15bdd47121737e57e636">DWT_Imax</a>(s,  smax,  l)</td></tr>
<tr class="separator:ga8a33c313d15b15bdd47121737e57e636"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Wavelet Denoising</h2></td></tr>
<tr class="memitem:ga87edb7b030a5b4f23e7deae8fd10d5fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga87edb7b030a5b4f23e7deae8fd10d5fd">clean_quadrant2D</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, int scale, const std::string &amp;quadrant)</td></tr>
<tr class="separator:ga87edb7b030a5b4f23e7deae8fd10d5fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab6cadb2b7dc1f584fa7a21325afce42d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#gab6cadb2b7dc1f584fa7a21325afce42d">clean_quadrant3D</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, int scale, const std::string &amp;quadrant)</td></tr>
<tr class="separator:gab6cadb2b7dc1f584fa7a21325afce42d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7ef836dca787274c0373a761b81fe1a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga7ef836dca787274c0373a761b81fe1a2">soft_thresholding</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, double th)</td></tr>
<tr class="separator:ga7ef836dca787274c0373a761b81fe1a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad7bc4d37d37162733246058d13c67a15"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#gad7bc4d37d37162733246058d13c67a15">adaptive_soft_thresholding2D</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, int scale)</td></tr>
<tr class="separator:gad7bc4d37d37162733246058d13c67a15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3dc33f1f3c3aafa00e7ef0f54ebc4e58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga3dc33f1f3c3aafa00e7ef0f54ebc4e58">DWT_keep_central_part</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, double R)</td></tr>
<tr class="separator:ga3dc33f1f3c3aafa00e7ef0f54ebc4e58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga39537529673de4a9f59eef92b0a7566a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga39537529673de4a9f59eef92b0a7566a">bayesian_wiener_filtering2D</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;WI, int allowed_scale, double SNR0=0.1, double SNRF=0.2, bool white_noise=false, int tell=0, bool denoise=true)</td></tr>
<tr class="separator:ga39537529673de4a9f59eef92b0a7566a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaea47bb1e655d9b5cf0beb1e7efb177f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#gaea47bb1e655d9b5cf0beb1e7efb177f8">bayesian_wiener_filtering2D</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;WI, int allowed_scale, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;estimatedS)</td></tr>
<tr class="separator:gaea47bb1e655d9b5cf0beb1e7efb177f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5375a4011e66bb37f9e6e636e05e1f5f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga5375a4011e66bb37f9e6e636e05e1f5f">bayesian_wiener_filtering3D</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;WI, int allowed_scale, double SNR0=0.1, double SNRF=0.2, bool white_noise=false, int tell=0, bool denoise=true)</td></tr>
<tr class="separator:ga5375a4011e66bb37f9e6e636e05e1f5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga65e0a5f8c712feea7cd4f83e0ade9996"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga65e0a5f8c712feea7cd4f83e0ade9996">bayesian_wiener_filtering3D</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;WI, int allowed_scale, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;estimatedS)</td></tr>
<tr class="separator:ga65e0a5f8c712feea7cd4f83e0ade9996"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4b7cad67c1ce07b14f17b03089b1bdad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Wavelets.html#ga4b7cad67c1ce07b14f17b03089b1bdad">phaseCongMono</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;PC, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;FT, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Energy, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;lowPass, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Radius, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;H, int nScale, double minWaveLength, double <a class="el" href="image__operate_8cpp.html#aea075da3cfca2b6f88b09cd441a6dc5e">mult</a>, double sigmaOnf)</td></tr>
<tr class="separator:ga4b7cad67c1ce07b14f17b03089b1bdad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga4f4614723b76996e11f1dcda8a946f2f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DAUB12&#160;&#160;&#160;12</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libraries_2data_2wavelet_8h_source.html#l00039">39</a> of file <a class="el" href="libraries_2data_2wavelet_8h_source.html">wavelet.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga346d4411a461be0aabcd80d91f7aed43"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DAUB20&#160;&#160;&#160;20</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libraries_2data_2wavelet_8h_source.html#l00040">40</a> of file <a class="el" href="libraries_2data_2wavelet_8h_source.html">wavelet.h</a>.</p>

</div>
</div>
<a class="anchor" id="gaf7dda95ec4bf156694bbd8eac1af019d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DAUB4&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libraries_2data_2wavelet_8h_source.html#l00038">38</a> of file <a class="el" href="libraries_2data_2wavelet_8h_source.html">wavelet.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga8a33c313d15b15bdd47121737e57e636"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DWT_Imax</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">smax, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">l&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(((l == <span class="charliteral">&#39;0&#39;</span>) ? \</div><div class="line">        pow(2.0, smax - s - 1) - 1 : pow(2.0, smax - s) - 1))</div></div><!-- fragment -->
<p>Definition at line <a class="el" href="libraries_2data_2wavelet_8h_source.html#l00124">124</a> of file <a class="el" href="libraries_2data_2wavelet_8h_source.html">wavelet.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga23656fc9d337ac193efa522e54b14b1c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DWT_Imin</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">smax, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">l&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>(((l == <span class="charliteral">&#39;0&#39;</span>) ? 0 : \</div><div class="line">        pow(2.0, smax - s - 1)))</div></div><!-- fragment -->
<p>Definition at line <a class="el" href="libraries_2data_2wavelet_8h_source.html#l00122">122</a> of file <a class="el" href="libraries_2data_2wavelet_8h_source.html">wavelet.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga35de5a5968bf5312998795c8faca73cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HAAR&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libraries_2data_2wavelet_8h_source.html#l00037">37</a> of file <a class="el" href="libraries_2data_2wavelet_8h_source.html">wavelet.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gad7bc4d37d37162733246058d13c67a15"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adaptive_soft_thresholding2D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scale</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adaptive soft thresholding 2D.</p>
<p>Chang, Yu, Betterli. IEEE Int. Conf. <a class="el" href="classImage.html">Image</a> Processing </p>

<p>Definition at line <a class="el" href="wavelet_8cpp_source.html#l00384">384</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;{</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordtype">double</span> sigma = <a class="code" href="wavelet_8cpp.html#a15dff8de7870f9015b077ab8a926993f">compute_noise_power</a>(I);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s = 0; s &lt;= scale; s++)</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <a class="code" href="wavelet_8cpp.html#ac9aa764f54f159cea5c74f5f5197eabf">adaptive_soft_thresholding_block2D</a>(I, s, <span class="stringliteral">&quot;01&quot;</span>, sigma);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <a class="code" href="wavelet_8cpp.html#ac9aa764f54f159cea5c74f5f5197eabf">adaptive_soft_thresholding_block2D</a>(I, s, <span class="stringliteral">&quot;10&quot;</span>, sigma);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <a class="code" href="wavelet_8cpp.html#ac9aa764f54f159cea5c74f5f5197eabf">adaptive_soft_thresholding_block2D</a>(I, s, <span class="stringliteral">&quot;11&quot;</span>, sigma);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;}</div><div class="ttc" id="wavelet_8cpp_html_ac9aa764f54f159cea5c74f5f5197eabf"><div class="ttname"><a href="wavelet_8cpp.html#ac9aa764f54f159cea5c74f5f5197eabf">adaptive_soft_thresholding_block2D</a></div><div class="ttdeci">void adaptive_soft_thresholding_block2D(MultidimArray&lt; double &gt; &amp;I, int scale, const std::string &amp;quadrant, double sigma)</div><div class="ttdef"><b>Definition:</b> <a href="wavelet_8cpp_source.html#l00321">wavelet.cpp:321</a></div></div>
<div class="ttc" id="wavelet_8cpp_html_a15dff8de7870f9015b077ab8a926993f"><div class="ttname"><a href="wavelet_8cpp.html#a15dff8de7870f9015b077ab8a926993f">compute_noise_power</a></div><div class="ttdeci">double compute_noise_power(MultidimArray&lt; double &gt; &amp;I)</div><div class="ttdef"><b>Definition:</b> <a href="wavelet_8cpp_source.html#l00346">wavelet.cpp:346</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga39537529673de4a9f59eef92b0a7566a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; bayesian_wiener_filtering2D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>WI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>allowed_scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>SNR0</em> = <code>0.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>SNRF</em> = <code>0.2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>white_noise</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tell</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>denoise</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Bayesian, Wiener filtering.</p>
<p>Bijaoui, Signal Processing 2002, 82: 709-712. The Denoising procedure is applied up to the scale given. SNR0 is the smallest SNR and SNRF is the largest SNR.</p>
<p>This function returns the estimated coefficients for S and N at each scale. If denoise is set to false, then S and N coefficients are estimated but they are not applied to the image. </p>

<p>Definition at line <a class="el" href="wavelet_8cpp_source.html#l00605">605</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;{</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="comment">/*Calculate the power of the wavelet transformed image */</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordtype">double</span> powerI = WI.<a class="code" href="classMultidimArray.html#ae9f104cb09328048ed9aa7aec03c792c">sum2</a>();</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="comment">/*Number of pixels and some constraints on SNR*/</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordtype">int</span> Xdim = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(WI);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordtype">int</span> max_scale = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a>(<span class="keywordtype">double</span>(Xdim)) / <a class="code" href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a>(2.0));</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;powerI= &quot;</span> &lt;&lt; powerI &lt;&lt; std::endl;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordtype">double</span> powerWI = WI.<a class="code" href="classMultidimArray.html#ae9f104cb09328048ed9aa7aec03c792c">sum2</a>();</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;powerWI= &quot;</span> &lt;&lt; powerWI &lt;&lt; std::endl;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Ydim = &quot;</span> &lt;&lt; Ydim &lt;&lt; <span class="stringliteral">&quot;  Xdim = &quot;</span> &lt;&lt; Xdim &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Ncoef_total= &quot;</span> &lt;&lt; Ncoef_total &lt;&lt; std::endl;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;max_scale = &quot;</span> &lt;&lt; max_scale &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="comment">/*Calculate the power at each band*/</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="comment">//init the scale vector</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a> scale(<a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(allowed_scale + 1, max_scale - 1));</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <a class="code" href="group__Vectors.html#ga8333ba47b67df6174e1d4cfb85920c71">FOR_ALL_ELEMENTS_IN_MATRIX1D</a>(scale) scale(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordtype">int</span> scale_dim = scale.size();</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="comment">//define some vectors</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D</a>&lt;<span class="keywordtype">double</span>&gt; <a class="code" href="image__operate_8cpp.html#a3a3144c9c4cadd9405b7c938538674b6">power</a>(scale_dim), average(scale_dim), Ncoefs(scale_dim);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D</a>&lt;<span class="keywordtype">int</span>&gt; <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>(2), <a class="code" href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>(2), r(2);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <a class="code" href="namespacestd.html">std</a>::vector&lt;<a class="code" href="namespacestd.html">std</a>::<span class="keywordtype">string</span>&gt; orientation;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    orientation.push_back(&quot;01&quot;);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    orientation.push_back(&quot;10&quot;);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    orientation.push_back(&quot;11&quot;);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keywordtype">int</span> orientationSize=orientation.size();</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordtype">int</span> jmax=scale.size();</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aca6408d1d58d2334ecf5b80c3a9a8881">for</a> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 0;j &lt; jmax;j++)</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    {</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> = 0; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> &lt; orientation.size(); <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>++)</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            <a class="code" href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a>(scale(j), WI, orientation[<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>],</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                           <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(x0), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(xF), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(x0), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(xF));</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga366fce7e331049c17c918db413f1f471">FOR_ALL_ELEMENTS_IN_ARRAY2D_BETWEEN</a>(x0, xF)</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            {</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                <span class="keywordtype">double</span> aux=<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(WI,<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r),<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r));</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(<a class="code" href="image__operate_8cpp.html#a3a3144c9c4cadd9405b7c938538674b6">power</a>,j) += aux*aux;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(average,j) += aux;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            }</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        }</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(Ncoefs,j) = (int)pow(2.0, 2 * (max_scale - <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(scale,j) - 1)) * orientationSize;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(average,j) = <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(average,j) / <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(Ncoefs,j);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    }</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="comment">/*Evaluate the power of the unconsidered part of the image */</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordtype">double</span> power_rest = 0.0;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keywordtype">int</span> Ncoefs_rest = 0;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <a class="code" href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a>(scale(scale_dim - 1), WI, <span class="stringliteral">&quot;00&quot;</span>, <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(x0), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(xF), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(x0), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(xF));</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga366fce7e331049c17c918db413f1f471">FOR_ALL_ELEMENTS_IN_ARRAY2D_BETWEEN</a>(x0, xF)</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    {</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="keywordtype">double</span> aux=<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(WI,<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r),<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r));</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        power_rest += aux*aux;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    }</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    Ncoefs_rest = (int)pow(2.0, 2 * (max_scale - 1 - scale(scale_dim - 1)));</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keywordflow">if</span> (tell)</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;scale = &quot;</span> &lt;&lt; std::endl &lt;&lt; scale &lt;&lt; std::endl;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;power= &quot;</span> &lt;&lt; std::endl &lt;&lt; <a class="code" href="image__operate_8cpp.html#a3a3144c9c4cadd9405b7c938538674b6">power</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;average= &quot;</span> &lt;&lt; std::endl &lt;&lt; average &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Ncoefs= &quot;</span> &lt;&lt; std::endl &lt;&lt; Ncoefs &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;power_rest= &quot;</span> &lt;&lt; power_rest &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Ncoefs_rest= &quot;</span> &lt;&lt; Ncoefs_rest &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;powerI= &quot;</span> &lt;&lt; powerI &lt;&lt; std::endl;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Total sum of powers = &quot;</span> &lt;&lt; power.sum() + power_rest &lt;&lt; std::endl;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Difference powers = &quot;</span> &lt;&lt; powerI - power.sum() - power_rest &lt;&lt; std::endl;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    }</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="comment">/*Solve the Equation System*/</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> estimatedS;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <a class="code" href="wavelet_8cpp.html#a8f991567a8f74cc45217efef6bd6a7f0">bayesian_solve_eq_system</a>(power, average, Ncoefs,</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                             SNR0, SNRF, powerI, power_rest, white_noise, tell, estimatedS);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordflow">if</span> (tell)</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    {</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;estimatedS =\n&quot;</span> &lt;&lt; estimatedS &lt;&lt; std::endl;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="keywordtype">double</span> S = 0, N = 0;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; scale_dim; i++)</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        {</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            N += Ncoefs(i) * estimatedS(i);</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            S += Ncoefs(i) * estimatedS(scale_dim + i);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        }</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;SNR value=&quot;</span> &lt;&lt; S / N &lt;&lt; std::endl &lt;&lt; std::endl;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    }</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="comment">/* Apply the Bijaoui denoising to all scales &gt;= allowed_scale */</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordflow">if</span> (denoise)</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <a class="code" href="group__Wavelets.html#ga39537529673de4a9f59eef92b0a7566a">bayesian_wiener_filtering2D</a>(WI, allowed_scale, estimatedS);</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordflow">return</span> estimatedS;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;}</div><div class="ttc" id="group__Vectors_html_ga58173d9430e8e68017e3698f30382d5d"><div class="ttname"><a href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a></div><div class="ttdeci">#define VEC_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00248">matrix1d.h:248</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9ed4376d9ad511e963caf118a6640b28"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a></div><div class="ttdeci">#define DIRECT_A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00351">multidim_array.h:351</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdef"><b>Definition:</b> <a href="gtest_8h_source.html#l00663">gtest.h:663</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Wavelets_html_ga39537529673de4a9f59eef92b0a7566a"><div class="ttname"><a href="group__Wavelets.html#ga39537529673de4a9f59eef92b0a7566a">bayesian_wiener_filtering2D</a></div><div class="ttdeci">Matrix1D&lt; double &gt; bayesian_wiener_filtering2D(MultidimArray&lt; double &gt; &amp;WI, int allowed_scale, double SNR0, double SNRF, bool white_noise, int tell, bool denoise)</div><div class="ttdef"><b>Definition:</b> <a href="wavelet_8cpp_source.html#l00605">wavelet.cpp:605</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8333ba47b67df6174e1d4cfb85920c71"><div class="ttname"><a href="group__Vectors.html#ga8333ba47b67df6174e1d4cfb85920c71">FOR_ALL_ELEMENTS_IN_MATRIX1D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_MATRIX1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00075">matrix1d.h:75</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_a0994f8f1ab050711112683b89fb90b0b"><div class="ttname"><a href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a></div><div class="ttdeci">void log(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00225">image_operate.cpp:225</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca6408d1d58d2334ecf5b80c3a9a8881"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca6408d1d58d2334ecf5b80c3a9a8881">for</a></div><div class="ttdeci">for(j=1;j&lt;=i__1;++j)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02327">numerical_recipes.cpp:2327</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a8f613ddaea2048e3471a1f4f04ba4b79"><div class="ttname"><a href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a></div><div class="ttdeci">#define xF</div></div>
<div class="ttc" id="group__Macros_html_gac9ae6a207f10c821b06a8c0df153a7d5"><div class="ttname"><a href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a></div><div class="ttdeci">#define XMIPP_MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00181">xmipp_macros.h:181</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_a3a3144c9c4cadd9405b7c938538674b6"><div class="ttname"><a href="image__operate_8cpp.html#a3a3144c9c4cadd9405b7c938538674b6">power</a></div><div class="ttdeci">void power(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00244">image_operate.cpp:244</a></div></div>
<div class="ttc" id="group__Wavelets_html_gaf3291e2f171b751e81d86aaef7d24541"><div class="ttname"><a href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a></div><div class="ttdeci">void SelectDWTBlock(int scale, const MultidimArray&lt; T &gt; &amp;I, const std::string &amp;quadrant, int &amp;x1, int &amp;x2)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00134">wavelet.h:134</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; int &gt;</a></div></div>
<div class="ttc" id="classMultidimArray_html_ae9f104cb09328048ed9aa7aec03c792c"><div class="ttname"><a href="classMultidimArray.html#ae9f104cb09328048ed9aa7aec03c792c">MultidimArray::sum2</a></div><div class="ttdeci">double sum2() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05114">multidim_array.h:5114</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga366fce7e331049c17c918db413f1f471"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga366fce7e331049c17c918db413f1f471">FOR_ALL_ELEMENTS_IN_ARRAY2D_BETWEEN</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D_BETWEEN(corner1, corner2)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00482">multidim_array.h:482</a></div></div>
<div class="ttc" id="wavelet_8cpp_html_a8f991567a8f74cc45217efef6bd6a7f0"><div class="ttname"><a href="wavelet_8cpp.html#a8f991567a8f74cc45217efef6bd6a7f0">bayesian_solve_eq_system</a></div><div class="ttdeci">void bayesian_solve_eq_system(const Matrix1D&lt; double &gt; &amp;power, const Matrix1D&lt; double &gt; &amp;average, const Matrix1D&lt; double &gt; &amp;Ncoefs, double SNR0, double SNRF, double powerI, double power_rest, bool white_noise, int tell, Matrix1D&lt; double &gt; &amp;estimatedS)</div><div class="ttdef"><b>Definition:</b> <a href="wavelet_8cpp_source.html#l00476">wavelet.cpp:476</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaea47bb1e655d9b5cf0beb1e7efb177f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bayesian_wiener_filtering2D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>WI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>allowed_scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>estimatedS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Bayesian, Wiener filtering.</p>
<p>This is the function that really denoise. </p>

<p>Definition at line <a class="el" href="wavelet_8cpp_source.html#l00706">706</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;{</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    std::vector&lt;std::string&gt; orientation;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    orientation.push_back(<span class="stringliteral">&quot;01&quot;</span>);</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    orientation.push_back(<span class="stringliteral">&quot;10&quot;</span>);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    orientation.push_back(<span class="stringliteral">&quot;11&quot;</span>);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordtype">int</span> max_scale = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a>(<span class="keywordtype">double</span>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(WI))) / <a class="code" href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a>(2.0));</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a> scale(<a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(allowed_scale + 1, max_scale - 1));</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <a class="code" href="group__Vectors.html#ga8333ba47b67df6174e1d4cfb85920c71">FOR_ALL_ELEMENTS_IN_MATRIX1D</a>(scale) scale(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aca6408d1d58d2334ecf5b80c3a9a8881">for</a> (<span class="keywordtype">size_t</span> i = 0;i &lt; scale.size();i++)</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    {</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="keywordtype">double</span> N = estimatedS(i);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordtype">double</span> S = estimatedS(i + scale.size());</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> = 0; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> &lt; orientation.size(); <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>++)</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            <a class="code" href="wavelet_8cpp.html#ac03b7215e7a3c5ed2a314bc96f709191">DWT_Bijaoui_denoise_LL2D</a>(WI, scale(i), orientation[<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>], 0, S, N);</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    }</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8333ba47b67df6174e1d4cfb85920c71"><div class="ttname"><a href="group__Vectors.html#ga8333ba47b67df6174e1d4cfb85920c71">FOR_ALL_ELEMENTS_IN_MATRIX1D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_MATRIX1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00075">matrix1d.h:75</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_a0994f8f1ab050711112683b89fb90b0b"><div class="ttname"><a href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a></div><div class="ttdeci">void log(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00225">image_operate.cpp:225</a></div></div>
<div class="ttc" id="wavelet_8cpp_html_ac03b7215e7a3c5ed2a314bc96f709191"><div class="ttname"><a href="wavelet_8cpp.html#ac03b7215e7a3c5ed2a314bc96f709191">DWT_Bijaoui_denoise_LL2D</a></div><div class="ttdeci">void DWT_Bijaoui_denoise_LL2D(MultidimArray&lt; double &gt; &amp;WI, int scale, const std::string &amp;orientation, double mu, double S, double N)</div><div class="ttdef"><b>Definition:</b> <a href="wavelet_8cpp_source.html#l00414">wavelet.cpp:414</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca6408d1d58d2334ecf5b80c3a9a8881"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca6408d1d58d2334ecf5b80c3a9a8881">for</a></div><div class="ttdeci">for(j=1;j&lt;=i__1;++j)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02327">numerical_recipes.cpp:2327</a></div></div>
<div class="ttc" id="group__Macros_html_gac9ae6a207f10c821b06a8c0df153a7d5"><div class="ttname"><a href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a></div><div class="ttdeci">#define XMIPP_MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00181">xmipp_macros.h:181</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; int &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga5375a4011e66bb37f9e6e636e05e1f5f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; bayesian_wiener_filtering3D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>WI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>allowed_scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>SNR0</em> = <code>0.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>SNRF</em> = <code>0.2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>white_noise</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tell</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>denoise</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Bayesian, Wiener filtering.</p>
<p>Bijaoui, Signal Processing 2002, 82: 709-712. The denoising procedure is applied up to the scale given. SNR0 is the smallest SNR and SNRF is the largest SNR.</p>
<p>This function returns the estimated coefficients for S and N at each scale. If denoise is set to false, then S and N coefficients are estimated but they are not applied to the image. </p>

<p>Definition at line <a class="el" href="wavelet_8cpp_source.html#l00728">728</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;{</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="comment">/*Calculate the power of the wavelet transformed image */</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordtype">double</span> powerI = WI.<a class="code" href="classMultidimArray.html#ae9f104cb09328048ed9aa7aec03c792c">sum2</a>();</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="comment">/*Number of pixels and some constraints on SNR*/</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="keywordtype">size_t</span> Xdim=<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(WI);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordtype">int</span> max_scale = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a>(<span class="keywordtype">double</span>(Xdim)) / <a class="code" href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a>(2.0));</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;powerI= &quot;</span> &lt;&lt; powerI &lt;&lt; std::endl;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="keywordtype">double</span> powerWI = WI.<a class="code" href="classMultidimArray.html#ae9f104cb09328048ed9aa7aec03c792c">sum2</a>();</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;powerWI= &quot;</span> &lt;&lt; powerWI &lt;&lt; std::endl;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Zdim= &quot;</span> &lt;&lt; Zdim &lt;&lt; <span class="stringliteral">&quot; Ydim = &quot;</span> &lt;&lt; Ydim &lt;&lt; <span class="stringliteral">&quot;  Xdim = &quot;</span> &lt;&lt; Xdim &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Ncoef_total= &quot;</span> &lt;&lt; Ncoef_total &lt;&lt; std::endl;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;max_scale = &quot;</span> &lt;&lt; max_scale &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="comment">/*Calculate the power at each band*/</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="comment">//init the scale vector</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a> scale(allowed_scale + 1);</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <a class="code" href="group__Vectors.html#ga8333ba47b67df6174e1d4cfb85920c71">FOR_ALL_ELEMENTS_IN_MATRIX1D</a>(scale) scale(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keywordtype">int</span> scale_dim = scale.size();</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="comment">//define some vectors</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D</a>&lt;<span class="keywordtype">double</span>&gt; <a class="code" href="image__operate_8cpp.html#a3a3144c9c4cadd9405b7c938538674b6">power</a>(scale_dim), average(scale_dim), Ncoefs(scale_dim);</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D</a>&lt;<span class="keywordtype">int</span>&gt; <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>(3), <a class="code" href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>(3), r(3);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <a class="code" href="namespacestd.html">std</a>::vector&lt;<a class="code" href="namespacestd.html">std</a>::<span class="keywordtype">string</span>&gt; orientation;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    orientation.push_back(&quot;001&quot;);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    orientation.push_back(&quot;010&quot;);</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    orientation.push_back(&quot;011&quot;);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    orientation.push_back(&quot;100&quot;);</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    orientation.push_back(&quot;101&quot;);</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    orientation.push_back(&quot;110&quot;);</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    orientation.push_back(&quot;111&quot;);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aca6408d1d58d2334ecf5b80c3a9a8881">for</a> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 0;j &lt; scale.size();j++)</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    {</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> = 0; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> &lt; orientation.size(); <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>++)</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        {</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            <a class="code" href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a>(scale(j), WI, orientation[<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>],</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                           <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(x0), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(xF), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(x0), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(xF), <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(x0), <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(xF));</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gacf49ec8e8432f65baabc829653497e12">FOR_ALL_ELEMENTS_IN_ARRAY3D_BETWEEN</a>(x0, xF)</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            {</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                <a class="code" href="image__operate_8cpp.html#a3a3144c9c4cadd9405b7c938538674b6">power</a>(j) += WI(r) * WI(r);</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                average(j) += WI(r);</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            }</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        }</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        Ncoefs(j) = (int)pow(2.0, 3 * (max_scale - scale(j) - 1)) * orientation.size();</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        average(j) = average(j) / Ncoefs(j);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    }</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="comment">/*Evaluate the power of the unconsidered part of the image */</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="keywordtype">double</span> power_rest = 0.0;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="keywordtype">int</span> Ncoefs_rest = 0;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <a class="code" href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a>(scale(scale_dim - 1), WI, <span class="stringliteral">&quot;000&quot;</span>, <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(x0), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(xF), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(x0), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(xF),</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                   <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(x0), <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(xF));</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gacf49ec8e8432f65baabc829653497e12">FOR_ALL_ELEMENTS_IN_ARRAY3D_BETWEEN</a>(x0, xF)</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    power_rest += WI(r) * WI(r);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    Ncoefs_rest = (<span class="keywordtype">int</span>)pow(2.0, 3 * (max_scale - 1 - scale(scale_dim - 1)));</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (tell)</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    {</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;scale = &quot;</span> &lt;&lt; std::endl &lt;&lt; scale &lt;&lt; std::endl;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;power= &quot;</span> &lt;&lt; std::endl &lt;&lt; <a class="code" href="image__operate_8cpp.html#a3a3144c9c4cadd9405b7c938538674b6">power</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;average= &quot;</span> &lt;&lt; std::endl &lt;&lt; average &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Ncoefs= &quot;</span> &lt;&lt; std::endl &lt;&lt; Ncoefs &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;power_rest= &quot;</span> &lt;&lt; power_rest &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Ncoefs_rest= &quot;</span> &lt;&lt; Ncoefs_rest &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;powerI= &quot;</span> &lt;&lt; powerI &lt;&lt; std::endl;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Total sum of powers = &quot;</span> &lt;&lt; power.sum() + power_rest &lt;&lt; std::endl;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Difference powers = &quot;</span> &lt;&lt; powerI - power.sum() - power_rest &lt;&lt; std::endl;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    }</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="comment">/*Solve the Equation System*/</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> estimatedS;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <a class="code" href="wavelet_8cpp.html#a8f991567a8f74cc45217efef6bd6a7f0">bayesian_solve_eq_system</a>(power, average, Ncoefs,</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                             SNR0, SNRF, powerI, power_rest, white_noise, tell, estimatedS);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="keywordflow">if</span> (tell)</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    {</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;estimatedS =\n&quot;</span> &lt;&lt; estimatedS &lt;&lt; std::endl;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <span class="keywordtype">double</span> S = 0, N = 0;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; scale_dim; i++)</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        {</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            N += Ncoefs(i) * estimatedS(i);</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            S += Ncoefs(i) * estimatedS(scale_dim + i);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        }</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;SNR value=&quot;</span> &lt;&lt; S / N &lt;&lt; std::endl &lt;&lt; std::endl;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    }</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="comment">/* Apply the Bijaoui denoising to all scales &gt;= allowed_scale */</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keywordflow">if</span> (denoise)</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <a class="code" href="group__Wavelets.html#ga5375a4011e66bb37f9e6e636e05e1f5f">bayesian_wiener_filtering3D</a>(WI, allowed_scale, estimatedS);</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keywordflow">return</span> estimatedS;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;}</div><div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdef"><b>Definition:</b> <a href="gtest_8h_source.html#l00663">gtest.h:663</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gacf49ec8e8432f65baabc829653497e12"><div class="ttname"><a href="group__MultidimensionalArrays.html#gacf49ec8e8432f65baabc829653497e12">FOR_ALL_ELEMENTS_IN_ARRAY3D_BETWEEN</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D_BETWEEN(corner1, corner2)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00455">multidim_array.h:455</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8333ba47b67df6174e1d4cfb85920c71"><div class="ttname"><a href="group__Vectors.html#ga8333ba47b67df6174e1d4cfb85920c71">FOR_ALL_ELEMENTS_IN_MATRIX1D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_MATRIX1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00075">matrix1d.h:75</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_a0994f8f1ab050711112683b89fb90b0b"><div class="ttname"><a href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a></div><div class="ttdeci">void log(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00225">image_operate.cpp:225</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca6408d1d58d2334ecf5b80c3a9a8881"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca6408d1d58d2334ecf5b80c3a9a8881">for</a></div><div class="ttdeci">for(j=1;j&lt;=i__1;++j)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02327">numerical_recipes.cpp:2327</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a8f613ddaea2048e3471a1f4f04ba4b79"><div class="ttname"><a href="blobs_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a></div><div class="ttdeci">#define xF</div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_a3a3144c9c4cadd9405b7c938538674b6"><div class="ttname"><a href="image__operate_8cpp.html#a3a3144c9c4cadd9405b7c938538674b6">power</a></div><div class="ttdeci">void power(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00244">image_operate.cpp:244</a></div></div>
<div class="ttc" id="group__Wavelets_html_gaf3291e2f171b751e81d86aaef7d24541"><div class="ttname"><a href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a></div><div class="ttdeci">void SelectDWTBlock(int scale, const MultidimArray&lt; T &gt; &amp;I, const std::string &amp;quadrant, int &amp;x1, int &amp;x2)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00134">wavelet.h:134</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="group__Wavelets_html_ga5375a4011e66bb37f9e6e636e05e1f5f"><div class="ttname"><a href="group__Wavelets.html#ga5375a4011e66bb37f9e6e636e05e1f5f">bayesian_wiener_filtering3D</a></div><div class="ttdeci">Matrix1D&lt; double &gt; bayesian_wiener_filtering3D(MultidimArray&lt; double &gt; &amp;WI, int allowed_scale, double SNR0, double SNRF, bool white_noise, int tell, bool denoise)</div><div class="ttdef"><b>Definition:</b> <a href="wavelet_8cpp_source.html#l00728">wavelet.cpp:728</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; int &gt;</a></div></div>
<div class="ttc" id="classMultidimArray_html_ae9f104cb09328048ed9aa7aec03c792c"><div class="ttname"><a href="classMultidimArray.html#ae9f104cb09328048ed9aa7aec03c792c">MultidimArray::sum2</a></div><div class="ttdeci">double sum2() const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05114">multidim_array.h:5114</a></div></div>
<div class="ttc" id="wavelet_8cpp_html_a8f991567a8f74cc45217efef6bd6a7f0"><div class="ttname"><a href="wavelet_8cpp.html#a8f991567a8f74cc45217efef6bd6a7f0">bayesian_solve_eq_system</a></div><div class="ttdeci">void bayesian_solve_eq_system(const Matrix1D&lt; double &gt; &amp;power, const Matrix1D&lt; double &gt; &amp;average, const Matrix1D&lt; double &gt; &amp;Ncoefs, double SNR0, double SNRF, double powerI, double power_rest, bool white_noise, int tell, Matrix1D&lt; double &gt; &amp;estimatedS)</div><div class="ttdef"><b>Definition:</b> <a href="wavelet_8cpp_source.html#l00476">wavelet.cpp:476</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga65e0a5f8c712feea7cd4f83e0ade9996"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bayesian_wiener_filtering3D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>WI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>allowed_scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>estimatedS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Bayesian, Wiener filtering.</p>
<p>This is the function that really denoise. </p>

<p>Definition at line <a class="el" href="wavelet_8cpp_source.html#l00827">827</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;{</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    std::vector&lt;std::string&gt; orientation;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    orientation.push_back(<span class="stringliteral">&quot;001&quot;</span>);</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    orientation.push_back(<span class="stringliteral">&quot;010&quot;</span>);</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    orientation.push_back(<span class="stringliteral">&quot;011&quot;</span>);</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    orientation.push_back(<span class="stringliteral">&quot;100&quot;</span>);</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    orientation.push_back(<span class="stringliteral">&quot;101&quot;</span>);</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    orientation.push_back(<span class="stringliteral">&quot;110&quot;</span>);</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    orientation.push_back(<span class="stringliteral">&quot;111&quot;</span>);</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordtype">int</span> max_scale = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a>(<span class="keywordtype">double</span>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(WI))) / <a class="code" href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a>(2.0));</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;int&gt;</a> scale(<a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(allowed_scale + 1, max_scale - 1));</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gaa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(scale) scale(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aca6408d1d58d2334ecf5b80c3a9a8881">for</a> (<span class="keywordtype">size_t</span> i = 0;i &lt; <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(scale);i++)</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    {</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <span class="keywordtype">double</span> N = estimatedS(i);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <span class="keywordtype">double</span> S = estimatedS(i + <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(scale));</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> = 0; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> &lt; orientation.size(); <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>++)</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            <a class="code" href="wavelet_8cpp.html#a43a3b141e5b0d9d8cc445394e80943b5">DWT_Bijaoui_denoise_LL3D</a>(WI, scale(i), orientation[<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>], 0, S, N);</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    }</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; int &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaa924a84ae5fbf0ba6b4052eb9d92ef60"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00564">multidim_array.h:564</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_a0994f8f1ab050711112683b89fb90b0b"><div class="ttname"><a href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a></div><div class="ttdeci">void log(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00225">image_operate.cpp:225</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca6408d1d58d2334ecf5b80c3a9a8881"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca6408d1d58d2334ecf5b80c3a9a8881">for</a></div><div class="ttdeci">for(j=1;j&lt;=i__1;++j)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02327">numerical_recipes.cpp:2327</a></div></div>
<div class="ttc" id="group__Macros_html_gac9ae6a207f10c821b06a8c0df153a7d5"><div class="ttname"><a href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a></div><div class="ttdeci">#define XMIPP_MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00181">xmipp_macros.h:181</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="wavelet_8cpp_html_a43a3b141e5b0d9d8cc445394e80943b5"><div class="ttname"><a href="wavelet_8cpp.html#a43a3b141e5b0d9d8cc445394e80943b5">DWT_Bijaoui_denoise_LL3D</a></div><div class="ttdeci">void DWT_Bijaoui_denoise_LL3D(MultidimArray&lt; double &gt; &amp;WI, int scale, const std::string &amp;orientation, double mu, double S, double N)</div><div class="ttdef"><b>Definition:</b> <a href="wavelet_8cpp_source.html#l00446">wavelet.cpp:446</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaf95d660c27fe984d219a81c419c7ddba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bilib_DWT </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iterations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>isign</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>B-spline Wavelet transform of a vector.</p>
<p>The B-spline wavelet transform of the input array is computed. The size of the array must be so as to allow the downsampling by 2 as many times as the number of iterations. For instance, if iterations is 1, then it must be a multiple of 2. If iterations is 2, then it must be a multiple of 4. If iterations if 3, then it must be a multiple of 8. And so on.</p>
<p>If the isign=-1 then the inverse wavelet transform is performed. </p>

<p>Definition at line <a class="el" href="wavelet_8cpp_source.html#l00043">43</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">if</span> (iterations &lt; 1)</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa640217ae2418fe91401329baab687564">ERR_INDEX_OUTOFBOUNDS</a>, <span class="stringliteral">&quot;Bilib_DWT: iterations must be &gt;=1&quot;</span>);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">int</span> size_multiple = (int)pow(2.0, (<span class="keywordtype">double</span>) iterations);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(input) % size_multiple != 0)</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aaba89018a8188da52ee900de49a93ed78">ERR_MULTIDIM_SIZE</a>,</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                     (<a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a>)<span class="stringliteral">&quot;Bilib_DWT: Xsize must be a multiple of &quot;</span> +</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                     <a class="code" href="group__StringUtilities.html#ga01d0008bd87a0d41a3927e28b9f44b63">integerToString</a>(size_multiple));</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(input) &gt; 1 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(input) % size_multiple != 0)</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aaba89018a8188da52ee900de49a93ed78">ERR_MULTIDIM_SIZE</a>,</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                     (<a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a>)<span class="stringliteral">&quot;Bilib_DWT 2D: Ysize must be a multiple of &quot;</span> +</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                     <a class="code" href="group__StringUtilities.html#ga01d0008bd87a0d41a3927e28b9f44b63">integerToString</a>(size_multiple));</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(input) &gt; 1 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(input) % size_multiple != 0)</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aaba89018a8188da52ee900de49a93ed78">ERR_MULTIDIM_SIZE</a>,</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                     (<a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a>)<span class="stringliteral">&quot;Bilib_DWT 3D: Zsize must be a multiple of &quot;</span> +</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                     <a class="code" href="group__StringUtilities.html#ga01d0008bd87a0d41a3927e28b9f44b63">integerToString</a>(size_multiple));</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    result.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(input);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="structTWaveletStruct.html">TWaveletStruct</a> TW;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">if</span> (isign == 1)</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        TW.<a class="code" href="structTWaveletStruct.html#ac09e62d795eeb1a0c59bb43a072a72dd">Operation</a> = <span class="stringliteral">&quot;Analysis&quot;</span>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isign == -1)</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        TW.<a class="code" href="structTWaveletStruct.html#ac09e62d795eeb1a0c59bb43a072a72dd">Operation</a> = <span class="stringliteral">&quot;Synthesis&quot;</span>;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a>, (<a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a>)<span class="stringliteral">&quot;waveletTransform: unrecognized isign&quot;</span>);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    TW.<a class="code" href="structTWaveletStruct.html#a0fa202bcb1ea89392753276b7f5069a8">Filter</a> = <span class="stringliteral">&quot;Orthonormal Spline&quot;</span>;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    TW.<a class="code" href="structTWaveletStruct.html#ab5d1445ebe70c4501e807f842a69c620">BoundaryConditions</a> = <span class="stringliteral">&quot;Mirror&quot;</span>;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    TW.<a class="code" href="structTWaveletStruct.html#a1b94f1240171860fdba552c8720409c3">Order</a> = <span class="stringliteral">&quot;1&quot;</span>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    TW.<a class="code" href="structTWaveletStruct.html#af31825a712b3096e790b5423bda89367">Alpha</a> = 0;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">if</span> (isign == 1)</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="comment">// First iteration</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        TW.<a class="code" href="structTWaveletStruct.html#aad2b605cd264595526244acde551afc7">Input</a> = <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(input);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        TW.<a class="code" href="structTWaveletStruct.html#a47f887541ed29e91775f661f1d4150d4">NxOutput</a> = TW.<a class="code" href="structTWaveletStruct.html#a5a7b4da764edfc436e5054fabcaac7f5">NxInput</a> = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(input);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        TW.<a class="code" href="structTWaveletStruct.html#a9e19180fe5a45ba3662ea7af7915d8d9">NyOutput</a> = TW.<a class="code" href="structTWaveletStruct.html#a156d99c7f2f421f7254a93cfc333a469">NyInput</a> = <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(input);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        TW.<a class="code" href="structTWaveletStruct.html#a244209495f0de5357b513040229a385c">NzOutput</a> = TW.<a class="code" href="structTWaveletStruct.html#a086ed1eb7355fa1b783449e494b3a881">NzInput</a> = <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(input);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        TW.<a class="code" href="structTWaveletStruct.html#a92fa07f5c483dd18c5ddd5d75abb211e">Output</a> = <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(result);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="ore_2core_2bilib_2wavelet_8h.html#a6d71c7139ee7391b3d564ee48016b31d">Wavelet</a>(&amp;TW);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="comment">// Subsequent iterations</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; iterations; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <span class="comment">// Size of the Lowest subband</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="keywordtype">int</span> xsize = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(1, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(input) / (<span class="keywordtype">int</span>)pow(2.0, (<span class="keywordtype">double</span>)<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keywordtype">int</span> ysize = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(1, <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(input) / (<span class="keywordtype">int</span>)pow(2.0, (<span class="keywordtype">double</span>)<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <span class="keywordtype">int</span> zsize = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(1, <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(input) / (<span class="keywordtype">int</span>)pow(2.0, (<span class="keywordtype">double</span>)<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <span class="comment">// Pick the Lowest subband</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> input_aux, result_aux;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            input_aux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(zsize, ysize, xsize);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            result_aux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(zsize, ysize, xsize);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga46aa4ed12bd8706cfe1456ec6a8ab768">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D</a>(input_aux)</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(input_aux, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(result, k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="comment">// DWT</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            TW.Input = <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(input_aux);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            TW.NxOutput = TW.NxInput = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(input_aux);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            TW.NyOutput = TW.NyInput = <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(input_aux);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            TW.NzOutput = TW.NzInput = <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(input_aux);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            TW.Output = <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(result_aux);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            <a class="code" href="ore_2core_2bilib_2wavelet_8h.html#a6d71c7139ee7391b3d564ee48016b31d">Wavelet</a>(&amp;TW);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <span class="comment">// Return the subband to the output</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga46aa4ed12bd8706cfe1456ec6a8ab768">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D</a>(input_aux)</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(result, k, i, j) = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(result_aux, k, i, j);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    }</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a> <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (isign == -1)</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="comment">// Subsequent iterations</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = iterations - 1; i &gt;= 1; i--)</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="comment">// Size of the Lowest subband</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keywordtype">int</span> xsize = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(1, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(input) / (<span class="keywordtype">int</span>)pow(2.0, (<span class="keywordtype">double</span>)i));</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keywordtype">int</span> ysize = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(1, <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(input) / (<span class="keywordtype">int</span>)pow(2.0, (<span class="keywordtype">double</span>)i));</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keywordtype">int</span> zsize = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(1, <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(input) / (<span class="keywordtype">int</span>)pow(2.0, (<span class="keywordtype">double</span>)i));</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="comment">// Pick the Lowest subband</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> input_aux, result_aux;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            input_aux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(zsize, ysize, xsize);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            result_aux.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(zsize, ysize, xsize);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga46aa4ed12bd8706cfe1456ec6a8ab768">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D</a>(input_aux)</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(input_aux, k, i, j) = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(input, k, i, j);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="comment">// DWT</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            TW.Input = <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(input_aux);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            TW.NxOutput = TW.NxInput = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(input_aux);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            TW.NyOutput = TW.NyInput = <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(input_aux);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            TW.NzOutput = TW.NzInput = <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(input_aux);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            TW.Output = <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(result_aux);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <a class="code" href="ore_2core_2bilib_2wavelet_8h.html#a6d71c7139ee7391b3d564ee48016b31d">Wavelet</a>(&amp;TW);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="comment">// Return the subband to the output</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga46aa4ed12bd8706cfe1456ec6a8ab768">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D</a>(input_aux)</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(input, k, i, j) = <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(result_aux, k, i, j);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="comment">// First iteration</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        TW.Input = <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(input);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        TW.NxOutput = TW.NxInput = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(input);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        TW.NyOutput = TW.NyInput = <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(input);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        TW.NzOutput = TW.NzInput = <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(input);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        TW.Output = <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(result);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <a class="code" href="ore_2core_2bilib_2wavelet_8h.html#a6d71c7139ee7391b3d564ee48016b31d">Wavelet</a>(&amp;TW);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_a0544c3fe466e421738dae463968b70ba"><div class="ttname"><a href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="ttdeci">else</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02919">numerical_recipes.cpp:2919</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa640217ae2418fe91401329baab687564"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa640217ae2418fe91401329baab687564">ERR_INDEX_OUTOFBOUNDS</a></div><div class="ttdoc">Index out of bounds. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00137">xmipp_error.h:137</a></div></div>
<div class="ttc" id="structTWaveletStruct_html_a086ed1eb7355fa1b783449e494b3a881"><div class="ttname"><a href="structTWaveletStruct.html#a086ed1eb7355fa1b783449e494b3a881">TWaveletStruct::NzInput</a></div><div class="ttdeci">long NzInput</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2bilib_2wavelet_8h_source.html#l00037">wavelet.h:37</a></div></div>
<div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="group__Macros_html_gae0a4180e923e3ffca3989e20e441aa3c"><div class="ttname"><a href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a></div><div class="ttdeci">#define XMIPP_MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00193">xmipp_macros.h:193</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="structTWaveletStruct_html_aad2b605cd264595526244acde551afc7"><div class="ttname"><a href="structTWaveletStruct.html#aad2b605cd264595526244acde551afc7">TWaveletStruct::Input</a></div><div class="ttdeci">double * Input</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2bilib_2wavelet_8h_source.html#l00031">wavelet.h:31</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gac87b223f03097d45f776b44b6aeea9f7"><div class="ttname"><a href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a></div><div class="ttdeci">#define MULTIDIM_ARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00136">multidim_array.h:136</a></div></div>
<div class="ttc" id="namespacetesting_1_1internal_html_a8e8ff5b11e64078831112677156cb111"><div class="ttname"><a href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">testing::internal::string</a></div><div class="ttdeci">::std::string string</div><div class="ttdef"><b>Definition:</b> <a href="gtest_8h_source.html#l01818">gtest.h:1818</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gacac7be97c37bd2e4f801976749de839c"><div class="ttname"><a href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a></div><div class="ttdeci">#define DIRECT_A3D_ELEM(v, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00249">multidim_array.h:249</a></div></div>
<div class="ttc" id="structTWaveletStruct_html"><div class="ttname"><a href="structTWaveletStruct.html">TWaveletStruct</a></div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2bilib_2wavelet_8h_source.html#l00028">wavelet.h:28</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aaba89018a8188da52ee900de49a93ed78"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aaba89018a8188da52ee900de49a93ed78">ERR_MULTIDIM_SIZE</a></div><div class="ttdoc">Incorrect MultidimArray size. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00179">xmipp_error.h:179</a></div></div>
<div class="ttc" id="structTWaveletStruct_html_a0fa202bcb1ea89392753276b7f5069a8"><div class="ttname"><a href="structTWaveletStruct.html#a0fa202bcb1ea89392753276b7f5069a8">TWaveletStruct::Filter</a></div><div class="ttdeci">const char * Filter</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2bilib_2wavelet_8h_source.html#l00052">wavelet.h:52</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="group__StringUtilities_html_ga01d0008bd87a0d41a3927e28b9f44b63"><div class="ttname"><a href="group__StringUtilities.html#ga01d0008bd87a0d41a3927e28b9f44b63">integerToString</a></div><div class="ttdeci">String integerToString(int I, int _width, char fill_with)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__strings_8cpp_source.html#l00261">xmipp_strings.cpp:261</a></div></div>
<div class="ttc" id="structTWaveletStruct_html_a92fa07f5c483dd18c5ddd5d75abb211e"><div class="ttname"><a href="structTWaveletStruct.html#a92fa07f5c483dd18c5ddd5d75abb211e">TWaveletStruct::Output</a></div><div class="ttdeci">double * Output</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2bilib_2wavelet_8h_source.html#l00039">wavelet.h:39</a></div></div>
<div class="ttc" id="structTWaveletStruct_html_ac09e62d795eeb1a0c59bb43a072a72dd"><div class="ttname"><a href="structTWaveletStruct.html#ac09e62d795eeb1a0c59bb43a072a72dd">TWaveletStruct::Operation</a></div><div class="ttdeci">const char * Operation</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2bilib_2wavelet_8h_source.html#l00047">wavelet.h:47</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga46aa4ed12bd8706cfe1456ec6a8ab768"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga46aa4ed12bd8706cfe1456ec6a8ab768">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00332">multidim_array.h:332</a></div></div>
<div class="ttc" id="structTWaveletStruct_html_a244209495f0de5357b513040229a385c"><div class="ttname"><a href="structTWaveletStruct.html#a244209495f0de5357b513040229a385c">TWaveletStruct::NzOutput</a></div><div class="ttdeci">long NzOutput</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2bilib_2wavelet_8h_source.html#l00045">wavelet.h:45</a></div></div>
<div class="ttc" id="structTWaveletStruct_html_a156d99c7f2f421f7254a93cfc333a469"><div class="ttname"><a href="structTWaveletStruct.html#a156d99c7f2f421f7254a93cfc333a469">TWaveletStruct::NyInput</a></div><div class="ttdeci">long NyInput</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2bilib_2wavelet_8h_source.html#l00035">wavelet.h:35</a></div></div>
<div class="ttc" id="ore_2core_2bilib_2wavelet_8h_html_a6d71c7139ee7391b3d564ee48016b31d"><div class="ttname"><a href="ore_2core_2bilib_2wavelet_8h.html#a6d71c7139ee7391b3d564ee48016b31d">Wavelet</a></div><div class="ttdeci">int Wavelet(struct TWaveletStruct *Data)</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="structTWaveletStruct_html_af31825a712b3096e790b5423bda89367"><div class="ttname"><a href="structTWaveletStruct.html#af31825a712b3096e790b5423bda89367">TWaveletStruct::Alpha</a></div><div class="ttdeci">double Alpha</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2bilib_2wavelet_8h_source.html#l00058">wavelet.h:58</a></div></div>
<div class="ttc" id="structTWaveletStruct_html_ab5d1445ebe70c4501e807f842a69c620"><div class="ttname"><a href="structTWaveletStruct.html#ab5d1445ebe70c4501e807f842a69c620">TWaveletStruct::BoundaryConditions</a></div><div class="ttdeci">const char * BoundaryConditions</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2bilib_2wavelet_8h_source.html#l00054">wavelet.h:54</a></div></div>
<div class="ttc" id="structTWaveletStruct_html_a47f887541ed29e91775f661f1d4150d4"><div class="ttname"><a href="structTWaveletStruct.html#a47f887541ed29e91775f661f1d4150d4">TWaveletStruct::NxOutput</a></div><div class="ttdeci">long NxOutput</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2bilib_2wavelet_8h_source.html#l00041">wavelet.h:41</a></div></div>
<div class="ttc" id="structTWaveletStruct_html_a5a7b4da764edfc436e5054fabcaac7f5"><div class="ttname"><a href="structTWaveletStruct.html#a5a7b4da764edfc436e5054fabcaac7f5">TWaveletStruct::NxInput</a></div><div class="ttdeci">long NxInput</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2bilib_2wavelet_8h_source.html#l00033">wavelet.h:33</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a></div><div class="ttdoc">Incorrect value received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00200">xmipp_error.h:200</a></div></div>
<div class="ttc" id="structTWaveletStruct_html_a9e19180fe5a45ba3662ea7af7915d8d9"><div class="ttname"><a href="structTWaveletStruct.html#a9e19180fe5a45ba3662ea7af7915d8d9">TWaveletStruct::NyOutput</a></div><div class="ttdeci">long NyOutput</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2bilib_2wavelet_8h_source.html#l00043">wavelet.h:43</a></div></div>
<div class="ttc" id="structTWaveletStruct_html_a1b94f1240171860fdba552c8720409c3"><div class="ttname"><a href="structTWaveletStruct.html#a1b94f1240171860fdba552c8720409c3">TWaveletStruct::Order</a></div><div class="ttdeci">const char * Order</div><div class="ttdef"><b>Definition:</b> <a href="ore_2core_2bilib_2wavelet_8h_source.html#l00056">wavelet.h:56</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga87edb7b030a5b4f23e7deae8fd10d5fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clean_quadrant2D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>quadrant</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove all information within a quadrant and scale. </p>

<p>Definition at line <a class="el" href="wavelet_8cpp_source.html#l00288">288</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;{</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a> corner1(2), corner2(2);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> r(2);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <a class="code" href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a>(scale, I, quadrant, <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2));</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga366fce7e331049c17c918db413f1f471">FOR_ALL_ELEMENTS_IN_ARRAY2D_BETWEEN</a>(corner1, corner2)</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        I(r) = 0;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;}</div><div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__Wavelets_html_gaf3291e2f171b751e81d86aaef7d24541"><div class="ttname"><a href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a></div><div class="ttdeci">void SelectDWTBlock(int scale, const MultidimArray&lt; T &gt; &amp;I, const std::string &amp;quadrant, int &amp;x1, int &amp;x2)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00134">wavelet.h:134</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; int &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga366fce7e331049c17c918db413f1f471"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga366fce7e331049c17c918db413f1f471">FOR_ALL_ELEMENTS_IN_ARRAY2D_BETWEEN</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D_BETWEEN(corner1, corner2)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00482">multidim_array.h:482</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gab6cadb2b7dc1f584fa7a21325afce42d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clean_quadrant3D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>quadrant</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove all information within a quadrant and scale. </p>

<p>Definition at line <a class="el" href="wavelet_8cpp_source.html#l00297">297</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;{</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordtype">int</span> x1, y1, z1, x2, y2, z2;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a>(scale, I, quadrant, x1, x2, y1, y2, z1, z2);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a> corner1(3), corner2(3);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> r(3);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a>(scale, I, quadrant, <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner1), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(corner2),</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                   <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner1), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(corner2), <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner1), <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(corner2));</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gacf49ec8e8432f65baabc829653497e12">FOR_ALL_ELEMENTS_IN_ARRAY3D_BETWEEN</a>(corner1, corner2) I(r) = 0;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_gacf49ec8e8432f65baabc829653497e12"><div class="ttname"><a href="group__MultidimensionalArrays.html#gacf49ec8e8432f65baabc829653497e12">FOR_ALL_ELEMENTS_IN_ARRAY3D_BETWEEN</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D_BETWEEN(corner1, corner2)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00455">multidim_array.h:455</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__Wavelets_html_gaf3291e2f171b751e81d86aaef7d24541"><div class="ttname"><a href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a></div><div class="ttdeci">void SelectDWTBlock(int scale, const MultidimArray&lt; T &gt; &amp;I, const std::string &amp;quadrant, int &amp;x1, int &amp;x2)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00134">wavelet.h:134</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; int &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga4c3d81cae44d7519925c0a1634a8fedc"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void DWT </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>isign</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>DWT of a <a class="el" href="classMultidimArray.html">MultidimArray</a></p>
<p>The output vector can be the same as the input one. Previously the type of DWT must be set with set_DWT_type. If isign=1 the direct DWT is performed, if isign=-1 the inverse DWT is done. </p>

<p>Definition at line <a class="el" href="libraries_2data_2wavelet_8h_source.html#l00083">83</a> of file <a class="el" href="libraries_2data_2wavelet_8h_source.html">wavelet.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;{</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a03cb6822d714181506765a7df4f70ee7">nn</a>[3];</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> *ptr_nn = nn - 1;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordtype">int</span> dim;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    nn[2] = <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(v);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    nn[1] = <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(v);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    nn[0] = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(v);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(v) == 1 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(v) == 1)</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        dim = 1;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(v) == 1)</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        dim = 2;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        dim = 3;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a>(v, result);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordtype">double</span>* ptr_result = <a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(result) - 1;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="numerical__recipes_8h.html#a3927837f9aad779cf0628f2c9e6eb984">wtn</a>(ptr_result, ptr_nn, dim, isign, <a class="code" href="numerical__recipes_8h.html#a80792186cd76ac646f82d17fe815ea7e">pwt</a>);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_a03cb6822d714181506765a7df4f70ee7"><div class="ttname"><a href="numerical__recipes_8cpp.html#a03cb6822d714181506765a7df4f70ee7">nn</a></div><div class="ttdeci">nn</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04717">numerical_recipes.cpp:4717</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gac87b223f03097d45f776b44b6aeea9f7"><div class="ttname"><a href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a></div><div class="ttdeci">#define MULTIDIM_ARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00136">multidim_array.h:136</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__Vectors_html_gaf36b657319bb585c75cfa14744dab275"><div class="ttname"><a href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a></div><div class="ttdeci">void typeCast(const Matrix1D&lt; T1 &gt; &amp;v1, Matrix1D&lt; T2 &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01904">matrix1d.h:1904</a></div></div>
<div class="ttc" id="numerical__recipes_8h_html_a3927837f9aad779cf0628f2c9e6eb984"><div class="ttname"><a href="numerical__recipes_8h.html#a3927837f9aad779cf0628f2c9e6eb984">wtn</a></div><div class="ttdeci">void wtn(double a[], unsigned long nn[], int ndim, int isign, void(*wtstep)(double[], unsigned long, int))</div></div>
<div class="ttc" id="numerical__recipes_8h_html_a80792186cd76ac646f82d17fe815ea7e"><div class="ttname"><a href="numerical__recipes_8h.html#a80792186cd76ac646f82d17fe815ea7e">pwt</a></div><div class="ttdeci">void pwt(double a[], unsigned long n, int isign)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga3dc33f1f3c3aafa00e7ef0f54ebc4e58"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DWT_keep_central_part </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>R</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Keep central part 2D.</p>
<p>Keep those coefficients in a certain radius. </p>

<p>Definition at line <a class="el" href="wavelet_8cpp_source.html#l00396">396</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;{</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <a class="code" href="classMask.html">Mask</a> mask(<a class="code" href="mask_8h.html#a9a7a8873f792b1c6a824696c82256342">INT_MASK</a>);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    mask.type = <a class="code" href="mask_8h.html#a3bf2f0efbe32bcae4ef27412a56afaaa">BINARY_DWT_CIRCULAR_MASK</a>;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">if</span> (R == -1)</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        mask.R1 = (double)<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I) / 2 + 1;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        mask.R1 = R;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    mask.smin = 0;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    mask.smax = <a class="code" href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I));</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    mask.quadrant = <span class="stringliteral">&quot;xx&quot;</span>;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    mask.resize(I);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    mask.generate_mask();</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    mask.apply_mask(I, I);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;}</div><div class="ttc" id="group__Wavelets_html_gab61cdb597192ddae3cf7257eb716d3ed"><div class="ttname"><a href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a></div><div class="ttdeci">int Get_Max_Scale(int size)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00071">wavelet.h:71</a></div></div>
<div class="ttc" id="classMask_html"><div class="ttname"><a href="classMask.html">Mask</a></div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00366">mask.h:366</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="mask_8h_html_a3bf2f0efbe32bcae4ef27412a56afaaa"><div class="ttname"><a href="mask_8h.html#a3bf2f0efbe32bcae4ef27412a56afaaa">BINARY_DWT_CIRCULAR_MASK</a></div><div class="ttdeci">#define BINARY_DWT_CIRCULAR_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00383">mask.h:383</a></div></div>
<div class="ttc" id="mask_8h_html_a9a7a8873f792b1c6a824696c82256342"><div class="ttname"><a href="mask_8h.html#a9a7a8873f792b1c6a824696c82256342">INT_MASK</a></div><div class="ttdeci">#define INT_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00391">mask.h:391</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gad8943a584c4fe3eafe22190effbd6c50"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DWT_lowpass2D </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>DWT Low pass versions.</p>
<p>This function returns the low pass versions at different scales. The low pass version of the image at scale s is stored in the 01 quadrant of that scale. </p>

<p>Definition at line <a class="el" href="wavelet_8cpp_source.html#l00165">165</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;{</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> dwt, aux;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    result.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(v), <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(v) / 2);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="group__Wavelets.html#ga4c3d81cae44d7519925c0a1634a8fedc">DWT</a>(v, dwt);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordtype">int</span> Nx = <a class="code" href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(v));</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s = 0; s &lt; Nx; s++)</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="comment">// Perform the inverse DWT transform of the low pass</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        dwt.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(dwt) / 2, <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(dwt) / 2);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <a class="code" href="group__Wavelets.html#ga6da81c27c1780c116902bb6e720dc52d">IDWT</a>(dwt, aux);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="comment">// Copy the result to the 01 quadrant of the result</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordtype">int</span> x1, y1, x2, y2, <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <a class="code" href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a>(s, v, <span class="stringliteral">&quot;01&quot;</span>, x1, x2, y1, y2);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">for</span> (y = y1, i = 0; y &lt;= y2; y++, i++)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="keywordflow">for</span> (x = x1, j = 0; x &lt;= x2; x++, j++)</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(result, y, x) = <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(aux, i, j);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="group__Wavelets_html_gab61cdb597192ddae3cf7257eb716d3ed"><div class="ttname"><a href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a></div><div class="ttdeci">int Get_Max_Scale(int size)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00071">wavelet.h:71</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00364">multidim_array.h:364</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad919bbce6f061400a0bc5231a9cd1621"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a></div><div class="ttdeci">static double * y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08506">numerical_recipes.cpp:8506</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Wavelets_html_ga4c3d81cae44d7519925c0a1634a8fedc"><div class="ttname"><a href="group__Wavelets.html#ga4c3d81cae44d7519925c0a1634a8fedc">DWT</a></div><div class="ttdeci">void DWT(const MultidimArray&lt; T &gt; &amp;v, MultidimArray&lt; double &gt; &amp;result, int isign=1)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00083">wavelet.h:83</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Wavelets_html_gaf3291e2f171b751e81d86aaef7d24541"><div class="ttname"><a href="group__Wavelets.html#gaf3291e2f171b751e81d86aaef7d24541">SelectDWTBlock</a></div><div class="ttdeci">void SelectDWTBlock(int scale, const MultidimArray&lt; T &gt; &amp;I, const std::string &amp;quadrant, int &amp;x1, int &amp;x2)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00134">wavelet.h:134</a></div></div>
<div class="ttc" id="group__Wavelets_html_ga6da81c27c1780c116902bb6e720dc52d"><div class="ttname"><a href="group__Wavelets.html#ga6da81c27c1780c116902bb6e720dc52d">IDWT</a></div><div class="ttdeci">void IDWT(const MultidimArray&lt; double &gt; &amp;v, MultidimArray&lt; double &gt; &amp;result)</div><div class="ttdef"><b>Definition:</b> <a href="wavelet_8cpp_source.html#l00159">wavelet.cpp:159</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gab61cdb597192ddae3cf7257eb716d3ed"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Get_Max_Scale </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get maximum scale.</p>
<p>This function returns the maximum scale achievable by the DWT transform of a given size. </p>

<p>Definition at line <a class="el" href="libraries_2data_2wavelet_8h_source.html#l00071">71</a> of file <a class="el" href="libraries_2data_2wavelet_8h_source.html">wavelet.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;{</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a>(static_cast&lt; double &gt;(size)) / <a class="code" href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a>(2.0));</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div><div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_a3aadc7a86770372bb401fbcb4c05a252"><div class="ttname"><a href="image__operate_8cpp.html#a3aadc7a86770372bb401fbcb4c05a252">log10</a></div><div class="ttdeci">void log10(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00234">image_operate.cpp:234</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga70aa9e2ca9a52462e739fede341d4b39"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Get_Scale_Quadrant </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>quadrant</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get scale and quadrant 1D.</p>
<p>Given a point and the maximum size of the image, this routine returns the scale and quadrant it belongs. </p>

<p>Definition at line <a class="el" href="wavelet_8cpp_source.html#l00248">248</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;{</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordtype">double</span> Nx = <a class="code" href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a>(size_x);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    quadrant = <span class="stringliteral">&quot;x&quot;</span>;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    scale = <a class="code" href="wavelet_8cpp.html#a536ed8e9cf3446976e5563c845efd9cd">DWT_Scale</a>(<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, Nx);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    quadrant[0] = <a class="code" href="wavelet_8cpp.html#aa38633e5f68848a9dd49afc5366ac0cc">DWT_Quadrant1D</a>(<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, scale, Nx);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;}</div><div class="ttc" id="group__Wavelets_html_gab61cdb597192ddae3cf7257eb716d3ed"><div class="ttname"><a href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a></div><div class="ttdeci">int Get_Max_Scale(int size)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00071">wavelet.h:71</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="wavelet_8cpp_html_aa38633e5f68848a9dd49afc5366ac0cc"><div class="ttname"><a href="wavelet_8cpp.html#aa38633e5f68848a9dd49afc5366ac0cc">DWT_Quadrant1D</a></div><div class="ttdeci">#define DWT_Quadrant1D(i, s, smax)</div><div class="ttdef"><b>Definition:</b> <a href="wavelet_8cpp_source.html#l00243">wavelet.cpp:243</a></div></div>
<div class="ttc" id="wavelet_8cpp_html_a536ed8e9cf3446976e5563c845efd9cd"><div class="ttname"><a href="wavelet_8cpp.html#a536ed8e9cf3446976e5563c845efd9cd">DWT_Scale</a></div><div class="ttdeci">#define DWT_Scale(i, smax)</div><div class="ttdef"><b>Definition:</b> <a href="wavelet_8cpp_source.html#l00242">wavelet.cpp:242</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga5c65dfc02483da15312800eeb3f8b89b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Get_Scale_Quadrant </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>quadrant</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get scale and quadrant 2D.</p>
<p>Given a point and the maximum size of the image, this routine returns the scale and quadrant it belongs. </p>

<p>Definition at line <a class="el" href="wavelet_8cpp_source.html#l00257">257</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;{</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">double</span> Nx = <a class="code" href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a>(size_x);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordtype">double</span> Ny = <a class="code" href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a>(size_y);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    quadrant = <span class="stringliteral">&quot;xy&quot;</span>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordtype">double</span> scalex = <a class="code" href="wavelet_8cpp.html#a536ed8e9cf3446976e5563c845efd9cd">DWT_Scale</a>(<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, Nx);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordtype">double</span> scaley = <a class="code" href="wavelet_8cpp.html#a536ed8e9cf3446976e5563c845efd9cd">DWT_Scale</a>(<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, Ny);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    scale = (int)(<a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(scalex, scaley));</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    quadrant[1] = <a class="code" href="wavelet_8cpp.html#aa8be326d13e961f1d08019c50f158e2a">DWT_QuadrantnD</a>(<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, scaley, scale, Ny);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    quadrant[0] = <a class="code" href="wavelet_8cpp.html#aa8be326d13e961f1d08019c50f158e2a">DWT_QuadrantnD</a>(<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, scalex, scale, Nx);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;}</div><div class="ttc" id="group__Wavelets_html_gab61cdb597192ddae3cf7257eb716d3ed"><div class="ttname"><a href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a></div><div class="ttdeci">int Get_Max_Scale(int size)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00071">wavelet.h:71</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad919bbce6f061400a0bc5231a9cd1621"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a></div><div class="ttdeci">static double * y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08506">numerical_recipes.cpp:8506</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="wavelet_8cpp_html_aa8be326d13e961f1d08019c50f158e2a"><div class="ttname"><a href="wavelet_8cpp.html#aa8be326d13e961f1d08019c50f158e2a">DWT_QuadrantnD</a></div><div class="ttdeci">#define DWT_QuadrantnD(i, s, sp, smax)</div><div class="ttdef"><b>Definition:</b> <a href="wavelet_8cpp_source.html#l00244">wavelet.cpp:244</a></div></div>
<div class="ttc" id="wavelet_8cpp_html_a536ed8e9cf3446976e5563c845efd9cd"><div class="ttname"><a href="wavelet_8cpp.html#a536ed8e9cf3446976e5563c845efd9cd">DWT_Scale</a></div><div class="ttdeci">#define DWT_Scale(i, smax)</div><div class="ttdef"><b>Definition:</b> <a href="wavelet_8cpp_source.html#l00242">wavelet.cpp:242</a></div></div>
<div class="ttc" id="group__Macros_html_gac9ae6a207f10c821b06a8c0df153a7d5"><div class="ttname"><a href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a></div><div class="ttdeci">#define XMIPP_MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00181">xmipp_macros.h:181</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaae9117cdf458df110d3e3158b9866ddc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Get_Scale_Quadrant </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size_z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>quadrant</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get scale and quadrant 3D.</p>
<p>Given a point and the maximum size of the image, this routine returns the scale and quadrant it belongs. </p>

<p>Definition at line <a class="el" href="wavelet_8cpp_source.html#l00270">270</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;{</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordtype">double</span> Nx = <a class="code" href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a>(size_x);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordtype">double</span> Ny = <a class="code" href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a>(size_y);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordtype">double</span> Nz = <a class="code" href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a>(size_z);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    quadrant = <span class="stringliteral">&quot;xyz&quot;</span>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordtype">double</span> scalex = <a class="code" href="wavelet_8cpp.html#a536ed8e9cf3446976e5563c845efd9cd">DWT_Scale</a>(<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, Nx);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordtype">double</span> scaley = <a class="code" href="wavelet_8cpp.html#a536ed8e9cf3446976e5563c845efd9cd">DWT_Scale</a>(<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, Ny);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordtype">double</span> scalez = <a class="code" href="wavelet_8cpp.html#a536ed8e9cf3446976e5563c845efd9cd">DWT_Scale</a>(<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>, Nz);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    scale = (int)(<a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(scalez, <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(scalex, scaley)));</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    quadrant[2] = <a class="code" href="wavelet_8cpp.html#aa8be326d13e961f1d08019c50f158e2a">DWT_QuadrantnD</a>(<a class="code" href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a>, scalez, scale, Nz);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    quadrant[1] = <a class="code" href="wavelet_8cpp.html#aa8be326d13e961f1d08019c50f158e2a">DWT_QuadrantnD</a>(<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, scaley, scale, Ny);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    quadrant[0] = <a class="code" href="wavelet_8cpp.html#aa8be326d13e961f1d08019c50f158e2a">DWT_QuadrantnD</a>(<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, scalex, scale, Nx);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;}</div><div class="ttc" id="group__Wavelets_html_gab61cdb597192ddae3cf7257eb716d3ed"><div class="ttname"><a href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a></div><div class="ttdeci">int Get_Max_Scale(int size)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00071">wavelet.h:71</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad919bbce6f061400a0bc5231a9cd1621"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a></div><div class="ttdeci">static double * y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08506">numerical_recipes.cpp:8506</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="wavelet_8cpp_html_aa8be326d13e961f1d08019c50f158e2a"><div class="ttname"><a href="wavelet_8cpp.html#aa8be326d13e961f1d08019c50f158e2a">DWT_QuadrantnD</a></div><div class="ttdeci">#define DWT_QuadrantnD(i, s, sp, smax)</div><div class="ttdef"><b>Definition:</b> <a href="wavelet_8cpp_source.html#l00244">wavelet.cpp:244</a></div></div>
<div class="ttc" id="wavelet_8cpp_html_a536ed8e9cf3446976e5563c845efd9cd"><div class="ttname"><a href="wavelet_8cpp.html#a536ed8e9cf3446976e5563c845efd9cd">DWT_Scale</a></div><div class="ttdeci">#define DWT_Scale(i, smax)</div><div class="ttdef"><b>Definition:</b> <a href="wavelet_8cpp_source.html#l00242">wavelet.cpp:242</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aa508e3dbd0e86258b5c69e8a8b6b8295"><div class="ttname"><a href="numerical__recipes_8cpp.html#aa508e3dbd0e86258b5c69e8a8b6b8295">z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08509">numerical_recipes.cpp:8509</a></div></div>
<div class="ttc" id="group__Macros_html_gac9ae6a207f10c821b06a8c0df153a7d5"><div class="ttname"><a href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a></div><div class="ttdeci">#define XMIPP_MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00181">xmipp_macros.h:181</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga6da81c27c1780c116902bb6e720dc52d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IDWT </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>IDWT of a <a class="el" href="classMultidimArray.html">MultidimArray</a>.</p>
<p>The output volume can be the same as the input one. Previously the type of DWT must be set with set_DWT_type. </p>

<p>Definition at line <a class="el" href="wavelet_8cpp_source.html#l00159">159</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;{</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="group__Wavelets.html#ga4c3d81cae44d7519925c0a1634a8fedc">DWT</a>(v, result, -1);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}</div><div class="ttc" id="group__Wavelets_html_ga4c3d81cae44d7519925c0a1634a8fedc"><div class="ttname"><a href="group__Wavelets.html#ga4c3d81cae44d7519925c0a1634a8fedc">DWT</a></div><div class="ttdeci">void DWT(const MultidimArray&lt; T &gt; &amp;v, MultidimArray&lt; double &gt; &amp;result, int isign=1)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00083">wavelet.h:83</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga4b7cad67c1ce07b14f17b03089b1bdad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void phaseCongMono </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>PC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>FT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>lowPass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nScale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>minWaveLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mult</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigmaOnf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Phase congruency filtering.</p>
<p>Phase congruency of an image using monogenic filters. </p><pre class="fragment">   I                     - Image to be processed
   PC                    - Phase congruency indicating edge significance
   FT                    - Local weighted mean phase angle at every point in the
                           image.  A value of pi/2 corresponds to a bright line, 0
                         corresponds to a step and -pi/2 is a dark line.
nscale            5    - Number of wavelet scales, try values 3-6
 minWaveLength    3    - Wavelength of smallest scale filter.
 mult             2.1  - Scaling factor between successive filters.
 sigmaOnf         0.55 - Ratio of the standard deviation of the Gaussian
                         describing the log Gabor filter's transfer function
                         in the frequency domain to the filter center frequency.
</pre><p>References:</p>
<p>Peter Kovesi, "Image Features From Phase Congruency". Videre: A Journal of Computer Vision Research. MIT Press. Volume 1, Number 3, Summer 1999 <a href="http://mitpress.mit.edu/e-journals/Videre/001/v13.html">http://mitpress.mit.edu/e-journals/Videre/001/v13.html</a></p>
<p>Michael Felsberg and Gerald Sommer, "A New Extension of Linear Signal
   Processing for Estimating Local Properties and Detecting Features". DAGM Symposium 2000, Kiel</p>
<p>Michael Felsberg and Gerald Sommer. "The Monogenic Signal" IEEE Transactions on Signal Processing, 49(12):3136-3144, December 2001</p>
<p>Peter Kovesi, "Phase Congruency Detects Corners and Edges". Proceedings DICTA 2003, Sydney Dec 10-12 </p>

<p>Definition at line <a class="el" href="wavelet_8cpp_source.html#l00852">852</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;{</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">//    #define DEBUG</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#aa571c8173dde514963e974e8c1da1945">epsilon</a>= .0001; <span class="comment">// Used to prevent division by zero.</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="comment">//First we set the image origin in the image center</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    I.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="comment">//Image size</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="keywordtype">size_t</span> NR, NC,NZ, NDim;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    I.<a class="code" href="classMultidimArrayBase.html#a3f2d3ac0e6415e0977d19aab3deeefae">getDimensions</a>(NC,NR,NZ,NDim);</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keywordflow">if</span> ( (NZ!=1) || (NDim!=1) )</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa24918e77d512d272bc38188b58f78ac2">ERR_MULTIDIM_DIM</a>,(<a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a>)<span class="stringliteral">&quot;ZDim and NDim has to be equals to one&quot;</span>);</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; std::complex &lt;double&gt;</a> &gt; fftIm;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="comment">// Fourier Transformer</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <a class="code" href="classFourierTransformer.html">FourierTransformer</a> ftrans(FFTW_BACKWARD);<span class="comment">//, ftransh(FFTW_BACKWARD), ftransf(FFTW_BACKWARD);</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    ftrans.FourierTransform(I, fftIm, <span class="keyword">false</span>);</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="keywordflow">if</span> ( (lowPass.<a class="code" href="classMultidimArrayBase.html#af24d9d564a4519c9677df3e782ca1c85">xinit</a> == 0) &amp; (lowPass.<a class="code" href="classMultidimArrayBase.html#a98474cc9f368884d1b3590ee4d201be9">yinit</a> == 0) &amp; (Radius.<a class="code" href="classMultidimArrayBase.html#af24d9d564a4519c9677df3e782ca1c85">xinit</a> == 0) &amp; (Radius.<a class="code" href="classMultidimArrayBase.html#a98474cc9f368884d1b3590ee4d201be9">yinit</a> == 0)</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;          &amp; (H.<a class="code" href="classMultidimArrayBase.html#af24d9d564a4519c9677df3e782ca1c85">xinit</a> == 0) &amp; (H.<a class="code" href="classMultidimArrayBase.html#a98474cc9f368884d1b3590ee4d201be9">yinit</a> == 0) )</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    {</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        H.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(I);</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        lowPass.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(I);</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        Radius.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(I);</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <span class="keywordtype">double</span> cutoff = .4;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = 10;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="keywordtype">double</span> wx,wy;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=<a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(I); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;=<a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(I); ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        {</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I),wy);</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <span class="keywordtype">double</span> wy2=wy*wy;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=<a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(I); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;=<a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(I); ++<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            {</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>,<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I),wx);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                <span class="keywordtype">double</span> wx2=wx*wx;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                <span class="keywordtype">double</span> radius=<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(wy2+wx2);</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                <span class="keywordflow">if</span> (radius &lt; 1e-10) radius=1;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Radius,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)=radius;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                <span class="keywordtype">double</span> *ptr=(<span class="keywordtype">double</span>*)&amp;<a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(H,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                *ptr=wy/radius;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                *(ptr+1)=wx/radius;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(lowPass,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)= 1.0/(1.0+std::pow(radius/cutoff,n));</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            }</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        }</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    }</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> logGabor;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    logGabor.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(I);</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="comment">//Bandpassed image in the frequency domain and in the spatial domain.</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="comment">//h is a Bandpassed monogenic filtering, real part of h contains</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="comment">//convolution result with h1, imaginary part</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="comment">//contains convolution result with h2.</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; std::complex &lt;double&gt;</a> &gt; fftImF, fullFftIm, <a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>,Hc,h;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    fftImF.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(I);</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    Hc.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(I);</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    f.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(I);</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    h.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(I);</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> An,AnTemp;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> temp;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> F;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> h1;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> h2;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> tempMat;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    temp.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(I);</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    An.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(I);</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    F.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(I);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    h1.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(I);</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    h2.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(I);</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    AnTemp.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(I);</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    ftrans.getCompleteFourier(fullFftIm);</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <a class="code" href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a>(fullFftIm,<span class="keyword">false</span>);</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num = 0; num &lt; nScale; ++num)</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    {</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        <span class="keywordtype">double</span> waveLength = minWaveLength;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> numMult=0; numMult &lt; num;numMult++)</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            waveLength*=<a class="code" href="numerical__recipes_8cpp.html#a8d2f0a9cba65f578c1d9c97a482a5309">mult</a>;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <span class="keywordtype">double</span> fo = 1.0/waveLength;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(fullFftIm)</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        {</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#accaf7d230301f601ceef06999fe79c81">temp1</a> =(<a class="code" href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">std::log</a>(<a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Radius,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)/fo));</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#a835865ffa4a194c93b68e552436d5763">temp2</a> = <a class="code" href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">std::log</a>(sigmaOnf);</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(logGabor,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = std::exp(-(temp1*temp1) /(2 * temp2*temp2))*<a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(lowPass,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Radius,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)&lt;=1e-10) (<a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(logGabor,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)=0);</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            <span class="keywordtype">double</span> *ptr= (<span class="keywordtype">double</span>*)&amp;<a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(fullFftIm,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            temp1 = *ptr;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            temp2 = *(ptr+1);</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            ptr= (<span class="keywordtype">double</span>*)&amp;<a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(fftImF,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            *ptr=temp1*<a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(logGabor,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            *(ptr+1)=temp2*<a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(logGabor,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        }</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <a class="code" href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a>(fftImF,<span class="keyword">true</span>);</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        Hc = fftImF*H;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        ftrans.inverseFourierTransform(fftImF,f);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        ftrans.inverseFourierTransform(Hc,h);</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="comment">//ftransf.setFourier(fftImF);</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <span class="comment">//ftransf.inverseFourierTransform();</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <span class="comment">//ftransh.setFourier(Hc);</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="comment">//ftransh.inverseFourierTransform();</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        f.<a class="code" href="classMultidimArray.html#a049faf55649b1be72ed382f55b6acc00">getReal</a>(temp);</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        F += temp;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        AnTemp = temp*temp;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        h.<a class="code" href="classMultidimArray.html#a049faf55649b1be72ed382f55b6acc00">getReal</a>(temp);</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        h1 += temp;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        AnTemp += temp*temp;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        h.<a class="code" href="classMultidimArray.html#ab9304c6bb7440ebc46d1c851eb398948">getImag</a>(temp);</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        h2 += temp;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        AnTemp += temp*temp;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        AnTemp.<a class="code" href="classMultidimArray.html#a641ee4ebe45c9e7d9fb8e6bf1be8cd85">selfSQRT</a>();</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        An += AnTemp;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    }</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    Or.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(I);</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    Or.setXmippOrigin();</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    Ph.resizeNoCopy(I);</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    Ph.setXmippOrigin();</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    Energy.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(I);</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    Energy.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(I)</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    {</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        <span class="keywordtype">double</span> temph1 = <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(h1,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <span class="keywordtype">double</span> temph2 = <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(h2,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        <span class="keywordtype">double</span> tempF =  <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(F,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Or,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = std::atan2(temph1,temph2);</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Ph,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)=  std::atan2(tempF, <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">std::sqrt</a>(temph1*temph1+</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                           temph2*temph2));</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Energy,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">std::sqrt</a>(tempF*tempF+temph1*temph1</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                             + temph2*temph2)+<a class="code" href="numerical__recipes_8cpp.html#aa571c8173dde514963e974e8c1da1945">epsilon</a>;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    }</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <a class="code" href="classFileName.html">FileName</a> fpName1    = <span class="stringliteral">&quot;test1.txt&quot;</span>;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <a class="code" href="classFileName.html">FileName</a> fpName2    = <span class="stringliteral">&quot;test2.txt&quot;</span>;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <a class="code" href="classFileName.html">FileName</a> fpName3    = <span class="stringliteral">&quot;test3.txt&quot;</span>;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <a class="code" href="classFileName.html">FileName</a> fpName4    = <span class="stringliteral">&quot;test4.txt&quot;</span>;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    Or.write(fpName1);</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    Ph.write(fpName2);</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    Energy.<a class="code" href="classMultidimArray.html#a4a4e45352f73539481de04cbda5f3f3d">write</a>(fpName3);</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="preprocessor">    #endif</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;}</div><div class="ttc" id="classMultidimArrayBase_html_a3f2d3ac0e6415e0977d19aab3deeefae"><div class="ttname"><a href="classMultidimArrayBase.html#a3f2d3ac0e6415e0977d19aab3deeefae">MultidimArrayBase::getDimensions</a></div><div class="ttdeci">void getDimensions(size_t &amp;Xdim, size_t &amp;Ydim, size_t &amp;Zdim, size_t &amp;Ndim) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00111">multidim_array.cpp:111</a></div></div>
<div class="ttc" id="classMultidimArray_html_a049faf55649b1be72ed382f55b6acc00"><div class="ttname"><a href="classMultidimArray.html#a049faf55649b1be72ed382f55b6acc00">MultidimArray::getReal</a></div><div class="ttdeci">void getReal(MultidimArray&lt; double &gt; &amp;realImg) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02418">multidim_array.h:2418</a></div></div>
<div class="ttc" id="classMultidimArray_html_ab9304c6bb7440ebc46d1c851eb398948"><div class="ttname"><a href="classMultidimArray.html#ab9304c6bb7440ebc46d1c851eb398948">MultidimArray::getImag</a></div><div class="ttdeci">void getImag(MultidimArray&lt; double &gt; &amp;imagImg) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02423">multidim_array.h:2423</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00364">multidim_array.h:364</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_af24d9d564a4519c9677df3e782ca1c85"><div class="ttname"><a href="classMultidimArrayBase.html#af24d9d564a4519c9677df3e782ca1c85">MultidimArrayBase::xinit</a></div><div class="ttdeci">int xinit</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00747">multidim_array.h:747</a></div></div>
<div class="ttc" id="classMultidimArray_html_ac0efebfb32ab4e37cf33efca3349aa9b"><div class="ttname"><a href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">MultidimArray::resizeNoCopy</a></div><div class="ttdeci">void resizeNoCopy(const MultidimArray&lt; T1 &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01702">multidim_array.h:1702</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="namespacetesting_1_1internal_html_a8e8ff5b11e64078831112677156cb111"><div class="ttname"><a href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">testing::internal::string</a></div><div class="ttdeci">::std::string string</div><div class="ttdef"><b>Definition:</b> <a href="gtest_8h_source.html#l01818">gtest.h:1818</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00065">multidim_array.h:65</a></div></div>
<div class="ttc" id="classMultidimArray_html_a4a4e45352f73539481de04cbda5f3f3d"><div class="ttname"><a href="classMultidimArray.html#a4a4e45352f73539481de04cbda5f3f3d">MultidimArray::write</a></div><div class="ttdeci">void write(const FileName &amp;fn) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05329">multidim_array.h:5329</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a8d2f0a9cba65f578c1d9c97a482a5309"><div class="ttname"><a href="numerical__recipes_8cpp.html#a8d2f0a9cba65f578c1d9c97a482a5309">mult</a></div><div class="ttdeci">i&lt;=ncnstr;i++) cs[i].mult=0.e0;if(nfsip) for(i=1;i&lt;=nob;i++){ob[i].mult=0.e0;ob[i].mult_L=0.e0;}for(i=1;i&lt;=nqpram;i++){ii=k+i;if(clamda[ii]==0.e0 &amp;&amp;clamda[ii+nqpram]==0.e0) continue;else if(clamda[ii]!=0.e0) clamda[ii]=-clamda[ii];else clamda[ii]=clamda[ii+nqpram];}nqnp=nqpram+ncnstr;for(i=1;i&lt;=nqpram;i++) param-&gt; mult[i]</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07007">numerical_recipes.cpp:7007</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00068">xmipp_filename.h:68</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a835865ffa4a194c93b68e552436d5763"><div class="ttname"><a href="numerical__recipes_8cpp.html#a835865ffa4a194c93b68e552436d5763">temp2</a></div><div class="ttdeci">double temp2</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l06233">numerical_recipes.cpp:6233</a></div></div>
<div class="ttc" id="classFourierTransformer_html"><div class="ttname"><a href="classFourierTransformer.html">FourierTransformer</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00060">xmipp_fftw.h:60</a></div></div>
<div class="ttc" id="group__Fourier_html_ga0447bcc3d329ad07e453b0d9b0872468"><div class="ttname"><a href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a></div><div class="ttdeci">void CenterFFT(MultidimArray&lt; T &gt; &amp;v, bool forward)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8h_source.html#l00291">xmipp_fft.h:291</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_a0994f8f1ab050711112683b89fb90b0b"><div class="ttname"><a href="image__operate_8cpp.html#a0994f8f1ab050711112683b89fb90b0b">log</a></div><div class="ttdeci">void log(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00225">image_operate.cpp:225</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00400">multidim_array.h:400</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a633de4b0c14ca52ea2432a3c8a5c4c31"><div class="ttname"><a href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a></div><div class="ttdeci">double * f</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04431">numerical_recipes.cpp:4431</a></div></div>
<div class="ttc" id="classMultidimArray_html_a641ee4ebe45c9e7d9fb8e6bf1be8cd85"><div class="ttname"><a href="classMultidimArray.html#a641ee4ebe45c9e7d9fb8e6bf1be8cd85">MultidimArray::selfSQRT</a></div><div class="ttdeci">void selfSQRT()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05079">multidim_array.h:5079</a></div></div>
<div class="ttc" id="cuda__gpu__reconstruct__fourier_8cpp_html_ac914a5e7c4e25d78f31f6ec3b1a93c5c"><div class="ttname"><a href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a></div><div class="ttdeci">__device__ float FFT_IDX2DIGFREQ(int idx, int size)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gpu__reconstruct__fourier_8cpp_source.html#l00382">cuda_gpu_reconstruct_fourier.cpp:382</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00073">multidim_array.h:73</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa24918e77d512d272bc38188b58f78ac2"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa24918e77d512d272bc38188b58f78ac2">ERR_MULTIDIM_DIM</a></div><div class="ttdoc">Incorrect MultidimArray dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00178">xmipp_error.h:178</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aa571c8173dde514963e974e8c1da1945"><div class="ttname"><a href="numerical__recipes_8cpp.html#aa571c8173dde514963e974e8c1da1945">epsilon</a></div><div class="ttdeci">double epsilon</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05721">numerical_recipes.cpp:5721</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a98474cc9f368884d1b3590ee4d201be9"><div class="ttname"><a href="classMultidimArrayBase.html#a98474cc9f368884d1b3590ee4d201be9">MultidimArrayBase::yinit</a></div><div class="ttdeci">int yinit</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00744">multidim_array.h:744</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_accaf7d230301f601ceef06999fe79c81"><div class="ttname"><a href="numerical__recipes_8cpp.html#accaf7d230301f601ceef06999fe79c81">temp1</a></div><div class="ttdeci">double temp1</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l06233">numerical_recipes.cpp:6233</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gab7d31fd1de9a5f5f709bdaa36f93030e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string Quadrant2D </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>q</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a quadrant number it returns the string associated to it.</p>
<p>That is nothing more than its corresponding binary representation. </p>

<p>Definition at line <a class="el" href="wavelet_8cpp_source.html#l00187">187</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;{</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">switch</span> (q)</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;00&quot;</span>;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;01&quot;</span>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;10&quot;</span>;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;11&quot;</span>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa99ae519fb00e32cc6e716cc01d21cadf">ERR_ARG_INCORRECT</a>,<span class="stringliteral">&quot;Unknown quadrant&quot;</span>);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa99ae519fb00e32cc6e716cc01d21cadf"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa99ae519fb00e32cc6e716cc01d21cadf">ERR_ARG_INCORRECT</a></div><div class="ttdoc">Incorrect argument received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00118">xmipp_error.h:118</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga0faa94d9847d48812e86f1b12ef348f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string Quadrant3D </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>q</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a quadrant number it returns the string associated to it.</p>
<p>That is nothing more than its corresponding binary representation. </p>

<p>Definition at line <a class="el" href="wavelet_8cpp_source.html#l00208">208</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;{</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">switch</span> (q)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;000&quot;</span>;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;001&quot;</span>;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;010&quot;</span>;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;011&quot;</span>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;100&quot;</span>;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;101&quot;</span>;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;110&quot;</span>;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;111&quot;</span>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa99ae519fb00e32cc6e716cc01d21cadf">ERR_ARG_INCORRECT</a>,<span class="stringliteral">&quot;Unknown quadrant&quot;</span>);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa99ae519fb00e32cc6e716cc01d21cadf"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa99ae519fb00e32cc6e716cc01d21cadf">ERR_ARG_INCORRECT</a></div><div class="ttdoc">Incorrect argument received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00118">xmipp_error.h:118</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaf3291e2f171b751e81d86aaef7d24541"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void SelectDWTBlock </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>quadrant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>x1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>x2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Select Block 1D.</p>
<p>Given the scale (s=0 is the finest) and the quadrant "0" (Lower frequencies) or "1"(Higher frequencies) this routine returns the indices that should be explored for this block (x1 and x2 should be included in the for). </p>

<p>Definition at line <a class="el" href="libraries_2data_2wavelet_8h_source.html#l00134">134</a> of file <a class="el" href="libraries_2data_2wavelet_8h_source.html">wavelet.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;{</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordtype">double</span> Nx = <a class="code" href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I));</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    I.<a class="code" href="classMultidimArray.html#a8b4ec0d6f7470776689ca502181e54b1">toLogical</a>(<a class="code" href="group__Wavelets.html#ga23656fc9d337ac193efa522e54b14b1c">DWT_Imin</a>(scale, Nx, quadrant[0]), x1);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    I.<a class="code" href="classMultidimArray.html#a8b4ec0d6f7470776689ca502181e54b1">toLogical</a>(<a class="code" href="group__Wavelets.html#ga8a33c313d15b15bdd47121737e57e636">DWT_Imax</a>(scale, Nx, quadrant[0]), x2);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div><div class="ttc" id="group__Wavelets_html_gab61cdb597192ddae3cf7257eb716d3ed"><div class="ttname"><a href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a></div><div class="ttdeci">int Get_Max_Scale(int size)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00071">wavelet.h:71</a></div></div>
<div class="ttc" id="group__Wavelets_html_ga8a33c313d15b15bdd47121737e57e636"><div class="ttname"><a href="group__Wavelets.html#ga8a33c313d15b15bdd47121737e57e636">DWT_Imax</a></div><div class="ttdeci">#define DWT_Imax(s, smax, l)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00124">wavelet.h:124</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="group__Wavelets_html_ga23656fc9d337ac193efa522e54b14b1c"><div class="ttname"><a href="group__Wavelets.html#ga23656fc9d337ac193efa522e54b14b1c">DWT_Imin</a></div><div class="ttdeci">#define DWT_Imin(s, smax, l)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00122">wavelet.h:122</a></div></div>
<div class="ttc" id="classMultidimArray_html_a8b4ec0d6f7470776689ca502181e54b1"><div class="ttname"><a href="classMultidimArray.html#a8b4ec0d6f7470776689ca502181e54b1">MultidimArray::toLogical</a></div><div class="ttdeci">void toLogical(int k_phys, int i_phys, int j_phys, int &amp;k_log, int &amp;i_log, int &amp;j_log) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02453">multidim_array.h:2453</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga7a48f0c73f02f4f35307ae4597c3f4d3"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void SelectDWTBlock </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>quadrant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>x1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>x2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>y1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>y2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Select Block 2D.</p>
<p>Given the scale (s=0 is the finest) and the quadrant "xy"="00" (Upper left), "01" (Upper right), "10" (Lower left), "11" (Lower right). This routine returns the indices that should be explored for this block (the extremes should be included in the for). </p>

<p>Definition at line <a class="el" href="libraries_2data_2wavelet_8h_source.html#l00153">153</a> of file <a class="el" href="libraries_2data_2wavelet_8h_source.html">wavelet.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;{</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordtype">double</span> Nx = <a class="code" href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I));</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordtype">double</span> Ny = <a class="code" href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a>(<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I));</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    x1 = <a class="code" href="group__Wavelets.html#ga23656fc9d337ac193efa522e54b14b1c">DWT_Imin</a>(scale, Nx, quadrant[0]);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    y1 = <a class="code" href="group__Wavelets.html#ga23656fc9d337ac193efa522e54b14b1c">DWT_Imin</a>(scale, Ny, quadrant[1]);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    x2 = <a class="code" href="group__Wavelets.html#ga8a33c313d15b15bdd47121737e57e636">DWT_Imax</a>(scale, Nx, quadrant[0]);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    y2 = <a class="code" href="group__Wavelets.html#ga8a33c313d15b15bdd47121737e57e636">DWT_Imax</a>(scale, Ny, quadrant[1]);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    I.<a class="code" href="classMultidimArray.html#a8b4ec0d6f7470776689ca502181e54b1">toLogical</a>(y1, x1, y1, x1);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    I.<a class="code" href="classMultidimArray.html#a8b4ec0d6f7470776689ca502181e54b1">toLogical</a>(y2, x2, y2, x2);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;}</div><div class="ttc" id="group__Wavelets_html_gab61cdb597192ddae3cf7257eb716d3ed"><div class="ttname"><a href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a></div><div class="ttdeci">int Get_Max_Scale(int size)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00071">wavelet.h:71</a></div></div>
<div class="ttc" id="group__Wavelets_html_ga8a33c313d15b15bdd47121737e57e636"><div class="ttname"><a href="group__Wavelets.html#ga8a33c313d15b15bdd47121737e57e636">DWT_Imax</a></div><div class="ttdeci">#define DWT_Imax(s, smax, l)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00124">wavelet.h:124</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="group__Wavelets_html_ga23656fc9d337ac193efa522e54b14b1c"><div class="ttname"><a href="group__Wavelets.html#ga23656fc9d337ac193efa522e54b14b1c">DWT_Imin</a></div><div class="ttdeci">#define DWT_Imin(s, smax, l)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00122">wavelet.h:122</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="classMultidimArray_html_a8b4ec0d6f7470776689ca502181e54b1"><div class="ttname"><a href="classMultidimArray.html#a8b4ec0d6f7470776689ca502181e54b1">MultidimArray::toLogical</a></div><div class="ttdeci">void toLogical(int k_phys, int i_phys, int j_phys, int &amp;k_log, int &amp;i_log, int &amp;j_log) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02453">multidim_array.h:2453</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga5901cdd694130c81552a2bc256728bbc"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void SelectDWTBlock </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>quadrant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>x1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>x2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>y1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>y2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>z1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>z2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Select Block 3D.</p>
<p>Given the scale (s=0 is the finest) and the quadrant "xyz"="000", "001", "010", "011", "100", "101", "110", "111". This routine returns the indices that should be explored for this block (the extremes should be included in the for). </p>

<p>Definition at line <a class="el" href="libraries_2data_2wavelet_8h_source.html#l00182">182</a> of file <a class="el" href="libraries_2data_2wavelet_8h_source.html">wavelet.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;{</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordtype">double</span> Nx = <a class="code" href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I));</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">double</span> Ny = <a class="code" href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a>(<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I));</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">double</span> Nz = <a class="code" href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a>(<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(I));</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    x1 = <a class="code" href="group__Wavelets.html#ga23656fc9d337ac193efa522e54b14b1c">DWT_Imin</a>(scale, Nx, quadrant[0]);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    y1 = <a class="code" href="group__Wavelets.html#ga23656fc9d337ac193efa522e54b14b1c">DWT_Imin</a>(scale, Ny, quadrant[1]);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    z1 = <a class="code" href="group__Wavelets.html#ga23656fc9d337ac193efa522e54b14b1c">DWT_Imin</a>(scale, Nz, quadrant[2]);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    x2 = <a class="code" href="group__Wavelets.html#ga8a33c313d15b15bdd47121737e57e636">DWT_Imax</a>(scale, Nx, quadrant[0]);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    y2 = <a class="code" href="group__Wavelets.html#ga8a33c313d15b15bdd47121737e57e636">DWT_Imax</a>(scale, Ny, quadrant[1]);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    z2 = <a class="code" href="group__Wavelets.html#ga8a33c313d15b15bdd47121737e57e636">DWT_Imax</a>(scale, Nz, quadrant[2]);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    I.<a class="code" href="classMultidimArray.html#a8b4ec0d6f7470776689ca502181e54b1">toLogical</a>(z1, y1, x1, z1, y1, x1);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    I.<a class="code" href="classMultidimArray.html#a8b4ec0d6f7470776689ca502181e54b1">toLogical</a>(z2, y2, x2, z2, y2, x2);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;}</div><div class="ttc" id="group__Wavelets_html_gab61cdb597192ddae3cf7257eb716d3ed"><div class="ttname"><a href="group__Wavelets.html#gab61cdb597192ddae3cf7257eb716d3ed">Get_Max_Scale</a></div><div class="ttdeci">int Get_Max_Scale(int size)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00071">wavelet.h:71</a></div></div>
<div class="ttc" id="group__Wavelets_html_ga8a33c313d15b15bdd47121737e57e636"><div class="ttname"><a href="group__Wavelets.html#ga8a33c313d15b15bdd47121737e57e636">DWT_Imax</a></div><div class="ttdeci">#define DWT_Imax(s, smax, l)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00124">wavelet.h:124</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="group__Wavelets_html_ga23656fc9d337ac193efa522e54b14b1c"><div class="ttname"><a href="group__Wavelets.html#ga23656fc9d337ac193efa522e54b14b1c">DWT_Imin</a></div><div class="ttdeci">#define DWT_Imin(s, smax, l)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00122">wavelet.h:122</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="classMultidimArray_html_a8b4ec0d6f7470776689ca502181e54b1"><div class="ttname"><a href="classMultidimArray.html#a8b4ec0d6f7470776689ca502181e54b1">MultidimArray::toLogical</a></div><div class="ttdeci">void toLogical(int k_phys, int i_phys, int j_phys, int &amp;k_log, int &amp;i_log, int &amp;j_log) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02453">multidim_array.h:2453</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga5cb8eeb7258f5d05a5a9b1fdae7b2491"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_DWT_type </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>DWT_type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set DWT type.</p>
<p>The DWT type should be set before starting making transforms. Valid types are: HAAR, DAUB4, DAUB12, DAUB20 </p>

<p>Definition at line <a class="el" href="wavelet_8cpp_source.html#l00154">154</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;{</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="numerical__recipes_8h.html#a256318d4be234940ffe963446d4f516d">pwtset</a>(DWT_type);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;}</div><div class="ttc" id="numerical__recipes_8h_html_a256318d4be234940ffe963446d4f516d"><div class="ttname"><a href="numerical__recipes_8h.html#a256318d4be234940ffe963446d4f516d">pwtset</a></div><div class="ttdeci">void pwtset(int n)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga7ef836dca787274c0373a761b81fe1a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void soft_thresholding </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>th</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Soft thresholding .</p>
<p>Subtract a value from all coefficients, if the the value is greater than the absolute value of the coefficient, that coefficient is set to 0. </p>

<p>Definition at line <a class="el" href="wavelet_8cpp_source.html#l00308">308</a> of file <a class="el" href="wavelet_8cpp_source.html">wavelet.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;{</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(I)</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(I, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)) &gt; th)</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(I, k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) &gt; 0)</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(I, k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) -= th;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(I, k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) += th;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(I, k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 0;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_a0544c3fe466e421738dae463968b70ba"><div class="ttname"><a href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="ttdeci">else</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02919">numerical_recipes.cpp:2919</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00279">multidim_array.h:279</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
