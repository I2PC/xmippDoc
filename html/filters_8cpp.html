<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Xmipp: /home/yunior/Yunior/Projects/Scipion/COSS/xmipp-bundle/src/xmipp/libraries/data/filters.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_dbce2b2c1291334a9ade6207c7a262fa.html">xmipp-bundle</a></li><li class="navelem"><a class="el" href="dir_5ca4f3e8e51f1e22c724fe6427eb943c.html">src</a></li><li class="navelem"><a class="el" href="dir_51a4fe91bde3feaf0f23bad87d0144e4.html">xmipp</a></li><li class="navelem"><a class="el" href="dir_c1f8b3d1b5354b6c120dfc6668096234.html">libraries</a></li><li class="navelem"><a class="el" href="dir_f083b9d43eb51ff5c9ab4698ce0a19c4.html">data</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">filters.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="filters_8h_source.html">filters.h</a>&quot;</code><br />
<code>#include &lt;list&gt;</code><br />
<code>#include &lt;<a class="el" href="xmipp__fftw_8h_source.html">core/xmipp_fftw.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="libraries_2data_2morphology_8h_source.html">morphology.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="libraries_2data_2wavelet_8h_source.html">wavelet.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ctf_8h_source.html">ctf.h</a>&quot;</code><br />
<code>#include &lt;<a class="el" href="fourier__filter_8h_source.html">data/fourier_filter.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for filters.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="filters_8cpp__incl.png" border="0" usemap="#_2home_2yunior_2Yunior_2Projects_2Scipion_2COSS_2xmipp-bundle_2src_2xmipp_2libraries_2data_2filters_8cpp" alt=""/></div>
<map name="_2home_2yunior_2Yunior_2Projects_2Scipion_2COSS_2xmipp-bundle_2src_2xmipp_2libraries_2data_2filters_8cpp" id="_2home_2yunior_2Yunior_2Projects_2Scipion_2COSS_2xmipp-bundle_2src_2xmipp_2libraries_2data_2filters_8cpp">
<area shape="rect" id="node2" href="filters_8h.html" title="filters.h" alt="" coords="795,199,861,225"/>
<area shape="rect" id="node41" href="libraries_2data_2wavelet_8h.html" title="wavelet.h" alt="" coords="845,572,923,599"/>
<area shape="rect" id="node44" href="xmipp__fftw_8h.html" title="core/xmipp_fftw.h" alt="" coords="182,647,309,673"/>
<area shape="rect" id="node48" href="libraries_2data_2morphology_8h.html" title="morphology.h" alt="" coords="6,199,106,225"/>
<area shape="rect" id="node49" href="ctf_8h.html" title="ctf.h" alt="" coords="1379,273,1427,300"/>
<area shape="rect" id="node50" href="fourier__filter_8h.html" title="data/fourier_filter.h" alt="" coords="763,124,893,151"/>
<area shape="rect" id="node4" href="xmipp__image_8h.html" title="core/xmipp_image.h" alt="" coords="1076,423,1215,449"/>
<area shape="rect" id="node32" href="histogram_8h.html" title="core/histogram.h" alt="" coords="537,647,655,673"/>
<area shape="rect" id="node34" href="xmipp__program_8h.html" title="core/xmipp_program.h" alt="" coords="1389,348,1539,375"/>
<area shape="rect" id="node37" href="numerical__tools_8h.html" title="data/numerical_tools.h" alt="" coords="1290,721,1443,748"/>
<area shape="rect" id="node38" href="mask_8h.html" title="data/mask.h" alt="" coords="765,273,859,300"/>
<area shape="rect" id="node43" href="polar_8h.html" title="data/polar.h" alt="" coords="283,572,373,599"/>
<area shape="rect" id="node5" href="xmipp__image__base_8h.html" title="xmipp_image_base.h" alt="" coords="1025,572,1170,599"/>
<area shape="rect" id="node6" href="multidim__array_8h.html" title="multidim_array.h" alt="" coords="494,796,613,823"/>
<area shape="rect" id="node30" href="xmipp__image__generic_8h.html" title="xmipp_image_generic.h" alt="" coords="973,497,1131,524"/>
<area shape="rect" id="node31" href="xmipp__color_8h.html" title="xmipp_color.h" alt="" coords="1885,945,1987,972"/>
<area shape="rect" id="node25" href="transformations_8h.html" title="transformations.h" alt="" coords="1017,647,1140,673"/>
<area shape="rect" id="node27" href="xmipp__datatype_8h.html" title="xmipp_datatype.h" alt="" coords="867,796,992,823"/>
<area shape="rect" id="node28" href="metadata_8h.html" title="metadata.h" alt="" coords="1693,721,1779,748"/>
<area shape="rect" id="node7" href="tsplinebasis_8h.html" title="bilib/tsplinebasis.h" alt="" coords="367,871,497,897"/>
<area shape="rect" id="node8" href="kernel_8h.html" title="bilib/kernel.h" alt="" coords="521,871,615,897"/>
<area shape="rect" id="node9" href="xmipp__strings_8h.html" title="xmipp_strings.h" alt="" coords="1305,1244,1420,1271"/>
<area shape="rect" id="node11" href="matrix1d_8h.html" title="matrix1d.h" alt="" coords="1081,945,1164,972"/>
<area shape="rect" id="node24" href="matrix2d_8h.html" title="matrix2d.h" alt="" coords="1160,871,1243,897"/>
<area shape="rect" id="node13" href="xmipp__funcs_8h.html" title="xmipp_funcs.h" alt="" coords="979,1020,1085,1047"/>
<area shape="rect" id="node21" href="numerical__recipes_8h.html" title="numerical_recipes.h" alt="" coords="1239,1020,1377,1047"/>
<area shape="rect" id="node15" href="xmipp__filename_8h.html" title="xmipp_filename.h" alt="" coords="1533,1095,1657,1121"/>
<area shape="rect" id="node19" href="xmipp__macros_8h.html" title="xmipp_macros.h" alt="" coords="1103,1095,1222,1121"/>
<area shape="rect" id="node20" href="xmipp__error_8h.html" title="xmipp_error.h" alt="" coords="956,1169,1057,1196"/>
<area shape="rect" id="node23" href="xmipp__memory_8h.html" title="xmipp_memory.h" alt="" coords="1247,1095,1369,1121"/>
<area shape="rect" id="node26" href="multidim__array__generic_8h.html" title="multidim_array_generic.h" alt="" coords="698,721,865,748"/>
<area shape="rect" id="node33" href="metadata__label_8h.html" title="metadata_label.h" alt="" coords="1042,721,1163,748"/>
<area shape="rect" id="node35" href="argsprinter_8h.html" title="argsprinter.h" alt="" coords="1613,423,1707,449"/>
<area shape="rect" id="node36" href="xmipp__program__sql_8h.html" title="xmipp_program_sql.h" alt="" coords="1391,423,1537,449"/>
<area shape="rect" id="node39" href="blobs_8h.html" title="blobs.h" alt="" coords="411,497,475,524"/>
<area shape="rect" id="node40" href="args_8h.html" title="core/args.h" alt="" coords="109,1095,195,1121"/>
<area shape="rect" id="node42" href="metadata__extension_8h.html" title="core/metadata_extension.h" alt="" coords="1099,348,1277,375"/>
<area shape="rect" id="node46" href="xmipp__fft_8h.html" title="xmipp_fft.h" alt="" coords="587,721,674,748"/>
</map>
</div>
</div>
<p><a href="filters_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCoordinate2D.html">Coordinate2D</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCoordinate3D.html">Coordinate3D</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a83027de735085322bd4cd7d5bcd166d4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a83027de735085322bd4cd7d5bcd166d4">CHECK_POINT</a>(<a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,  <a class="el" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</td></tr>
<tr class="separator:a83027de735085322bd4cd7d5bcd166d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a597513406ab82aa15c590f0350102a26"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(<a class="el" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,  <a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,  <a class="el" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</td></tr>
<tr class="separator:a597513406ab82aa15c590f0350102a26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a597513406ab82aa15c590f0350102a26"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(<a class="el" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,  <a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,  <a class="el" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</td></tr>
<tr class="separator:a597513406ab82aa15c590f0350102a26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb31dfe59b3610a058f15e7e56af5f66"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#acb31dfe59b3610a058f15e7e56af5f66">CHECK_POINT_DIST</a>(<a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,  <a class="el" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>,  proposedDistance)</td></tr>
<tr class="separator:acb31dfe59b3610a058f15e7e56af5f66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51b0b7efbd2dfcb165c0c76d348deb98"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a51b0b7efbd2dfcb165c0c76d348deb98">SHIFT_THRESHOLD</a>&#160;&#160;&#160;0.95</td></tr>
<tr class="separator:a51b0b7efbd2dfcb165c0c76d348deb98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88152d5f2092351476e38a3366f08468"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a88152d5f2092351476e38a3366f08468">ROTATE_THRESHOLD</a>&#160;&#160;&#160;1.0</td></tr>
<tr class="separator:a88152d5f2092351476e38a3366f08468"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada40da844971a04ec690b5e30c65682f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#ada40da844971a04ec690b5e30c65682f">INITIAL_SHIFT_THRESHOLD</a>&#160;&#160;&#160;<a class="el" href="mpi__classify__CL2D_8cpp.html#a51b0b7efbd2dfcb165c0c76d348deb98">SHIFT_THRESHOLD</a> + 1.0</td></tr>
<tr class="separator:ada40da844971a04ec690b5e30c65682f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00e670b2b5c8951b8ac881ee55bc7df0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a00e670b2b5c8951b8ac881ee55bc7df0">INITIAL_ROTATE_THRESHOLD</a>&#160;&#160;&#160;<a class="el" href="mpi__classify__CL2D_8cpp.html#a88152d5f2092351476e38a3366f08468">ROTATE_THRESHOLD</a> + 1.0</td></tr>
<tr class="separator:a00e670b2b5c8951b8ac881ee55bc7df0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83f10ea672c60fccf3e6e9ae53a70be4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a83f10ea672c60fccf3e6e9ae53a70be4">SHAH_CONVERGENCE_THRESHOLD</a>&#160;&#160;&#160;0.0001</td></tr>
<tr class="separator:a83f10ea672c60fccf3e6e9ae53a70be4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga11b22ba5fdb8431cb8c534ae4a91d554"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga11b22ba5fdb8431cb8c534ae4a91d554">substractBackgroundPlane</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I)</td></tr>
<tr class="separator:ga11b22ba5fdb8431cb8c534ae4a91d554"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa6c14e5ee97aee4c8c4a0db657d610e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gaa6c14e5ee97aee4c8c4a0db657d610e0">substractBackgroundRollingBall</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, int radius)</td></tr>
<tr class="separator:gaa6c14e5ee97aee4c8c4a0db657d610e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad6a9f8505bb986b25457d7e4b91819d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gad6a9f8505bb986b25457d7e4b91819d7">detectBackground</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;vol, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;mask, double alpha, double &amp;final_mean)</td></tr>
<tr class="separator:gad6a9f8505bb986b25457d7e4b91819d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga74734334175800271ab600d627beb04d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga74734334175800271ab600d627beb04d">contrastEnhancement</a> (<a class="el" href="classImage.html">Image</a>&lt; double &gt; *I)</td></tr>
<tr class="separator:ga74734334175800271ab600d627beb04d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa67ede8a062ce8e0c34b4323bb2ca082"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gaa67ede8a062ce8e0c34b4323bb2ca082">regionGrowing2D</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I_in, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I_out, int <a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, int <a class="el" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, float stop_colour, float filling_colour, bool less, int neighbourhood)</td></tr>
<tr class="separator:gaa67ede8a062ce8e0c34b4323bb2ca082"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad85078fda0532473e1cc86b983a12ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#aad85078fda0532473e1cc86b983a12ae">regionGrowing3D</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V_in, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V_out, int <a class="el" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, int <a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, int <a class="el" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, float stop_colour, float filling_colour, bool less)</td></tr>
<tr class="separator:aad85078fda0532473e1cc86b983a12ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6029223e2ee1759507d6fe306db4082a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a6029223e2ee1759507d6fe306db4082a">regionGrowing3DEqualValue</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V_in, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;V_out, int filling_value=0)</td></tr>
<tr class="separator:a6029223e2ee1759507d6fe306db4082a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaedfae28239982fe610a700b1365a919f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gaedfae28239982fe610a700b1365a919f">distanceTransform</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;<a class="el" href="image__find__center_8cpp.html#a26aeebe75887b4360c73659342f5dc61">in</a>, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;out, bool wrap)</td></tr>
<tr class="separator:gaedfae28239982fe610a700b1365a919f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga206a93c383ad7f6ba43c67f18486cc21"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga206a93c383ad7f6ba43c67f18486cc21">labelImage2D</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;label, int neighbourhood)</td></tr>
<tr class="separator:ga206a93c383ad7f6ba43c67f18486cc21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaad2c4bf9d2a76b096825a3c7b9e23b1a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gaad2c4bf9d2a76b096825a3c7b9e23b1a">labelImage3D</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;label)</td></tr>
<tr class="separator:gaad2c4bf9d2a76b096825a3c7b9e23b1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0c5d971c2f1b8bfc8b21c70e3956fef2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga0c5d971c2f1b8bfc8b21c70e3956fef2">removeSmallComponents</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, int size, int neighbourhood)</td></tr>
<tr class="separator:ga0c5d971c2f1b8bfc8b21c70e3956fef2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga59afc9cfbaf887703547ec198600d92d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga59afc9cfbaf887703547ec198600d92d">keepBiggestComponent</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, double percentage, int neighbourhood)</td></tr>
<tr class="separator:ga59afc9cfbaf887703547ec198600d92d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac791e3efb9f9ee463b182ad5400cf748"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gac791e3efb9f9ee463b182ad5400cf748">fillBinaryObject</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, int neighbourhood)</td></tr>
<tr class="separator:gac791e3efb9f9ee463b182ad5400cf748"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga10453d42eeb9ec81876fc0e12bb4b978"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga10453d42eeb9ec81876fc0e12bb4b978">varianceFilter</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, int kernelSize, bool relative)</td></tr>
<tr class="separator:ga10453d42eeb9ec81876fc0e12bb4b978"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac36280d6ded9846f347577939ae33859"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gac36280d6ded9846f347577939ae33859">noisyZonesFilter</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, int kernelSize)</td></tr>
<tr class="separator:gac36280d6ded9846f347577939ae33859"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0d47bf9f39db4d2e7e6422f015cab5b5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga0d47bf9f39db4d2e7e6422f015cab5b5">giniCoeff</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, int varKernelSize)</td></tr>
<tr class="separator:ga0d47bf9f39db4d2e7e6422f015cab5b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae4711a70816fcb6f8b6f72bb1b7dc8e5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gae4711a70816fcb6f8b6f72bb1b7dc8e5">OtsuSegmentation</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V)</td></tr>
<tr class="separator:gae4711a70816fcb6f8b6f72bb1b7dc8e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad571370cecac06c79cfe09ee681c134e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gad571370cecac06c79cfe09ee681c134e">EntropySegmentation</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V)</td></tr>
<tr class="separator:gad571370cecac06c79cfe09ee681c134e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa3fef57b51522c9a6b9534ee50a3ed68"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gaa3fef57b51522c9a6b9534ee50a3ed68">EntropyOtsuSegmentation</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V, double percentil, bool binarizeVolume)</td></tr>
<tr class="separator:gaa3fef57b51522c9a6b9534ee50a3ed68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1af51bdf860cd3d8084129df77c37408"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a1af51bdf860cd3d8084129df77c37408">fastCorrentropy</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, double sigma, const <a class="el" href="classGaussianInterpolator.html">GaussianInterpolator</a> &amp;G, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask)</td></tr>
<tr class="separator:a1af51bdf860cd3d8084129df77c37408"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a984b2433f91d5be4f77ba24a5007d881"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a984b2433f91d5be4f77ba24a5007d881">imedDistance</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I1, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I2)</td></tr>
<tr class="separator:a984b2433f91d5be4f77ba24a5007d881"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c97cc8b6a974935f2da39b63681a786"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a3c97cc8b6a974935f2da39b63681a786">imedNormalizedDistance</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I1, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I2)</td></tr>
<tr class="separator:a3c97cc8b6a974935f2da39b63681a786"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cfc65fe3ad8382906d8e36980a95e30"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a9cfc65fe3ad8382906d8e36980a95e30">correlationMasked</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I1, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I2)</td></tr>
<tr class="separator:a9cfc65fe3ad8382906d8e36980a95e30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad488098c3e788352a3d394f85a4b049a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#ad488098c3e788352a3d394f85a4b049a">correlationWeighted</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I1, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I2)</td></tr>
<tr class="separator:ad488098c3e788352a3d394f85a4b049a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a335c59eb3a310bca39e24fe3ef07c763"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a335c59eb3a310bca39e24fe3ef07c763">svdCorrelation</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I1, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I2, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask)</td></tr>
<tr class="separator:a335c59eb3a310bca39e24fe3ef07c763"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ad54631c5bb3abc50adae7a6fa02c5c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a9ad54631c5bb3abc50adae7a6fa02c5c">covarianceMatrix</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;C)</td></tr>
<tr class="separator:a9ad54631c5bb3abc50adae7a6fa02c5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3a842c1f195d82f091c896d33e4de46"><td class="memItemLeft" align="right" valign="top">template float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#aa3a842c1f195d82f091c896d33e4de46">bestShift</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; float &gt; &amp;, float &amp;, float &amp;, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *, int)</td></tr>
<tr class="separator:aa3a842c1f195d82f091c896d33e4de46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3563db637600632950d47480a21b4b1f"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a3563db637600632950d47480a21b4b1f"><td class="memTemplItemLeft" align="right" valign="top">T&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a3563db637600632950d47480a21b4b1f">bestShift</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;Mcorr, T &amp;shiftX, T &amp;shiftY, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask, int maxShift)</td></tr>
<tr class="separator:a3563db637600632950d47480a21b4b1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb34d431df0cacf7558b0888bb6420fb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#afb34d431df0cacf7558b0888bb6420fb">bestShift</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I1, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;FFTI1, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I2, double &amp;shiftX, double &amp;shiftY, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask, int maxShift)</td></tr>
<tr class="separator:afb34d431df0cacf7558b0888bb6420fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga14f1374af7f27a45531362d95574a84e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga14f1374af7f27a45531362d95574a84e">bestShift</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I1, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I2, double &amp;shiftX, double &amp;shiftY, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask, int maxShift)</td></tr>
<tr class="separator:ga14f1374af7f27a45531362d95574a84e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2e0fa984227ef675e0e54a6b7b14883"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#aa2e0fa984227ef675e0e54a6b7b14883">bestShift</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;FFTI1, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;FFTI2, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Mcorr, double &amp;shiftX, double &amp;shiftY, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask, int maxShift)</td></tr>
<tr class="separator:aa2e0fa984227ef675e0e54a6b7b14883"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga08ab699813e8c2feb0cd4526941ec9ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga08ab699813e8c2feb0cd4526941ec9ee">bestShift</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I1, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I2, double &amp;shiftX, double &amp;shiftY, double &amp;shiftZ, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask)</td></tr>
<tr class="separator:ga08ab699813e8c2feb0cd4526941ec9ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5aae1ce90626f1f1401defcb6f5d6411"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga5aae1ce90626f1f1401defcb6f5d6411">bestNonwrappingShift</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I1, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I2, double &amp;shiftX, double &amp;shiftY, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux)</td></tr>
<tr class="separator:ga5aae1ce90626f1f1401defcb6f5d6411"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9566ae598791299e963633068ebc6318"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a9566ae598791299e963633068ebc6318">bestNonwrappingShift</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I1, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;FFTI1, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I2, double &amp;shiftX, double &amp;shiftY, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux)</td></tr>
<tr class="separator:a9566ae598791299e963633068ebc6318"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga940d7a3dda260c479d250eaf1f844057"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga940d7a3dda260c479d250eaf1f844057">bestShiftRealSpace</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I1, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I2, double &amp;shiftX, double &amp;shiftY, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask, int maxShift, double shiftStep)</td></tr>
<tr class="separator:ga940d7a3dda260c479d250eaf1f844057"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb3985709c3203698f5794da11150d3d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#afb3985709c3203698f5794da11150d3d">computeAlignmentTransforms</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classAlignmentTransforms.html">AlignmentTransforms</a> &amp;ITransforms, <a class="el" href="classAlignmentAux.html">AlignmentAux</a> &amp;aux, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux2)</td></tr>
<tr class="separator:afb3985709c3203698f5794da11150d3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36c35628e0011847e73d801180599cff"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a36c35628e0011847e73d801180599cff">alignImages</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Iref, const <a class="el" href="classAlignmentTransforms.html">AlignmentTransforms</a> &amp;IrefTransforms, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;M, bool wrap, <a class="el" href="classAlignmentAux.html">AlignmentAux</a> &amp;aux, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux2, <a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;aux3)</td></tr>
<tr class="separator:a36c35628e0011847e73d801180599cff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5d6ee7828e9b39286928b59987624bbb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga5d6ee7828e9b39286928b59987624bbb">alignImages</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Iref, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;M, bool wrap, <a class="el" href="classAlignmentAux.html">AlignmentAux</a> &amp;aux, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux2, <a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;aux3)</td></tr>
<tr class="separator:ga5d6ee7828e9b39286928b59987624bbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab9510a1208ace75e1526652928340408"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gab9510a1208ace75e1526652928340408">alignImages</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Iref, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;M, bool wrap)</td></tr>
<tr class="separator:gab9510a1208ace75e1526652928340408"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfc8d89899b538e61a9fa3c3f8955f39"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#acfc8d89899b538e61a9fa3c3f8955f39">alignImagesConsideringMirrors</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Iref, const <a class="el" href="classAlignmentTransforms.html">AlignmentTransforms</a> &amp;IrefTransforms, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;M, <a class="el" href="classAlignmentAux.html">AlignmentAux</a> &amp;aux, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux2, <a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;aux3, bool wrap, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask)</td></tr>
<tr class="separator:acfc8d89899b538e61a9fa3c3f8955f39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec95c3eb10e62d1773b91a721e438b69"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#aec95c3eb10e62d1773b91a721e438b69">alignImagesConsideringMirrors</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Iref, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;M, bool wrap)</td></tr>
<tr class="separator:aec95c3eb10e62d1773b91a721e438b69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac6334758831a66345a55bcc98a59bad8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gac6334758831a66345a55bcc98a59bad8">alignImagesConsideringMirrors</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Iref, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;M, <a class="el" href="classAlignmentAux.html">AlignmentAux</a> &amp;aux, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux2, <a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;aux3, bool wrap, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask)</td></tr>
<tr class="separator:gac6334758831a66345a55bcc98a59bad8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dcc2b7cd1ade97de5cafb69edda818f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a7dcc2b7cd1ade97de5cafb69edda818f">alignSetOfImages</a> (<a class="el" href="classMetaData.html">MetaData</a> &amp;MD, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Iavg, int Niter, bool considerMirror)</td></tr>
<tr class="separator:a7dcc2b7cd1ade97de5cafb69edda818f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa13591c7caa28b7c8ddb2cf9668dbd1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#afa13591c7caa28b7c8ddb2cf9668dbd1">fastBestRotation</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;IrefCyl, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Icyl, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux, <a class="el" href="classVolumeAlignmentAux.html">VolumeAlignmentAux</a> &amp;aux2, double deltaAng)</td></tr>
<tr class="separator:afa13591c7caa28b7c8ddb2cf9668dbd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ff4e1bd1c1d5b8af552e2d5edc86e6e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a4ff4e1bd1c1d5b8af552e2d5edc86e6e">fastBestRotationAroundZ</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;IrefCyl, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux, <a class="el" href="classVolumeAlignmentAux.html">VolumeAlignmentAux</a> &amp;aux2)</td></tr>
<tr class="separator:a4ff4e1bd1c1d5b8af552e2d5edc86e6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1e3569cf3b9d864ee221668f62176c7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#aa1e3569cf3b9d864ee221668f62176c7">fastBestRotationAroundY</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;IrefCyl, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux, <a class="el" href="classVolumeAlignmentAux.html">VolumeAlignmentAux</a> &amp;aux2)</td></tr>
<tr class="separator:aa1e3569cf3b9d864ee221668f62176c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a691119e46a00cb8f1e1f9f0f9cb761f9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a691119e46a00cb8f1e1f9f0f9cb761f9">fastBestRotationAroundX</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;IrefCyl, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux, <a class="el" href="classVolumeAlignmentAux.html">VolumeAlignmentAux</a> &amp;aux2)</td></tr>
<tr class="separator:a691119e46a00cb8f1e1f9f0f9cb761f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7adf26fcd293084cd9467376d581867"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#ac7adf26fcd293084cd9467376d581867">fastBestRotation</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;IrefCylZ, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;IrefCylY, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;IrefCylX, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Icurrent, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Ifinal, char <a class="el" href="image__operate_8cpp.html#aae5e6d8d8a0b1792b5fc6fde13bc4a8c">axis</a>, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;R, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux, <a class="el" href="classVolumeAlignmentAux.html">VolumeAlignmentAux</a> &amp;aux2)</td></tr>
<tr class="separator:ac7adf26fcd293084cd9467376d581867"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6860bccb1be87e0a81459936333c05f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#ac6860bccb1be87e0a81459936333c05f">fastBestRotation</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;IrefCylZ, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;IrefCylY, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;IrefCylX, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, const <a class="el" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a> &amp;eulerAngles, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;R, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux, <a class="el" href="classVolumeAlignmentAux.html">VolumeAlignmentAux</a> &amp;aux2)</td></tr>
<tr class="separator:ac6860bccb1be87e0a81459936333c05f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5442f275245a9a7c2b8ae4c2a7c6ec1d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga5442f275245a9a7c2b8ae4c2a7c6ec1d">bestRotationAroundZ</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Iref, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux, <a class="el" href="classVolumeAlignmentAux.html">VolumeAlignmentAux</a> &amp;aux2)</td></tr>
<tr class="separator:ga5442f275245a9a7c2b8ae4c2a7c6ec1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0d6795838f8d1daa7fb7f01deba9424"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#ac0d6795838f8d1daa7fb7f01deba9424">unnormalizedGaussian2D</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;r, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="image__find__center_8cpp.html#a22f64139a5ad2efe7d615cbf014e88d5">mu</a>, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;sigmainv)</td></tr>
<tr class="separator:ac0d6795838f8d1daa7fb7f01deba9424"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafdda1375d500638b811466a209b1e7d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gafdda1375d500638b811466a209b1e7d7">estimateGaussian2D</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, double &amp;<a class="el" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, double &amp;<a class="el" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;<a class="el" href="image__find__center_8cpp.html#a22f64139a5ad2efe7d615cbf014e88d5">mu</a>, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;sigma, bool estimateMu, int iterations)</td></tr>
<tr class="separator:gafdda1375d500638b811466a209b1e7d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacea6e9b7dc8fc68250563b670b2f9550"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gacea6e9b7dc8fc68250563b670b2f9550">fourierBesselDecomposition</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img_in, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;m_out, double <a class="el" href="image__find__center_8cpp.html#a1f47f51cace576c94f6c1c9483d28a8f">r1</a>, double <a class="el" href="image__find__center_8cpp.html#ab7a69dabaa7151dae4d7a3998167e2f3">r2</a>, int k1, int k2)</td></tr>
<tr class="separator:gacea6e9b7dc8fc68250563b670b2f9550"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa2d7ee82ca1e88ae849446fb4392c484"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gaa2d7ee82ca1e88ae849446fb4392c484">harmonicDecomposition</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img_in, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;v_out)</td></tr>
<tr class="separator:gaa2d7ee82ca1e88ae849446fb4392c484"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0aa8a7a56c678bf69497aa682d14599"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#ae0aa8a7a56c678bf69497aa682d14599">Shah_energy</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;surface_strength, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;edge_strength, double <a class="el" href="libraries_2data_2integration_8cpp.html#a97d832ae23af4f215e801e37e4f94254">K</a>, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;W)</td></tr>
<tr class="separator:ae0aa8a7a56c678bf69497aa682d14599"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b74d4db0a2342e875b5532a3a3da091"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a0b74d4db0a2342e875b5532a3a3da091">Update_surface_Shah</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;surface_strength, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;edge_strength, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;W)</td></tr>
<tr class="separator:a0b74d4db0a2342e875b5532a3a3da091"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab28b4aeb1c2a70160e9ee6a586f079b2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#ab28b4aeb1c2a70160e9ee6a586f079b2">Update_edge_Shah</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;surface_strength, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;edge_strength, double <a class="el" href="libraries_2data_2integration_8cpp.html#a97d832ae23af4f215e801e37e4f94254">K</a>, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;W)</td></tr>
<tr class="separator:ab28b4aeb1c2a70160e9ee6a586f079b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga998cbed84978df5207b2fe4b245bf3f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga998cbed84978df5207b2fe4b245bf3f3">smoothingShah</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;surface_strength, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;edge_strength, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;W, int OuterLoops, int InnerLoops, int RefinementLoops, bool adjust_range)</td></tr>
<tr class="separator:ga998cbed84978df5207b2fe4b245bf3f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6d8d88ce2ecf79280b949eeddf6305bf"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga6d8d88ce2ecf79280b949eeddf6305bf">tomographicDiffusion</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;alpha, double <a class="el" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>)</td></tr>
<tr class="separator:ga6d8d88ce2ecf79280b949eeddf6305bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga38f91d2b897842c80561364893f45101"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga38f91d2b897842c80561364893f45101">rotationalInvariantMoments</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;v_out)</td></tr>
<tr class="separator:ga38f91d2b897842c80561364893f45101"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5e7945db841993a933e1383687c303bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga5e7945db841993a933e1383687c303bf">inertiaMoments</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;v_out, <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a6277e2a7446059985dc9bcf0a4ac1a8f">u</a>)</td></tr>
<tr class="separator:ga5e7945db841993a933e1383687c303bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0503708238bfaf63a342376631e915c0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga0503708238bfaf63a342376631e915c0">fillTriangle</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img, int *tx, int *ty, double color)</td></tr>
<tr class="separator:ga0503708238bfaf63a342376631e915c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga10e4035c55461690348a131999433fe2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga10e4035c55461690348a131999433fe2">localThresholding</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img, double C, double dimLocal, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;result, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *mask)</td></tr>
<tr class="separator:ga10e4035c55461690348a131999433fe2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8552ad520aa2e2a78bcb29f7bca80f51"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga8552ad520aa2e2a78bcb29f7bca80f51">centerImageTranslationally</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux)</td></tr>
<tr class="separator:ga8552ad520aa2e2a78bcb29f7bca80f51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5265e64d6f938b25dd3c82ad9f889a30"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga5265e64d6f938b25dd3c82ad9f889a30">centerImageRotationally</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;aux)</td></tr>
<tr class="separator:ga5265e64d6f938b25dd3c82ad9f889a30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6690cfb805eb563bfb5edcfd53b13051"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga6690cfb805eb563bfb5edcfd53b13051">centerImage</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux, <a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;aux2, int Niter, bool limitShift)</td></tr>
<tr class="separator:ga6690cfb805eb563bfb5edcfd53b13051"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga952148fe1e27177ebcd5ce943191b474"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga952148fe1e27177ebcd5ce943191b474">forcePositive</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V)</td></tr>
<tr class="separator:ga952148fe1e27177ebcd5ce943191b474"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07967d751d0db20fe6a71ce225f0f874"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a07967d751d0db20fe6a71ce225f0f874">computeEdges</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;vol, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;vol_edge)</td></tr>
<tr class="separator:a07967d751d0db20fe6a71ce225f0f874"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71a4fab8b15290c0de30e666fef5b927"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#a71a4fab8b15290c0de30e666fef5b927">forceDWTSparsity</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V, double <a class="el" href="numerical__recipes_8cpp.html#a974b448c3d0a13d483d36ef15de369b5">eps</a>)</td></tr>
<tr class="separator:a71a4fab8b15290c0de30e666fef5b927"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga95d26655a427c11f6980246d08dfc6d2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga95d26655a427c11f6980246d08dfc6d2">denoiseTVenergy</a> (double <a class="el" href="image__find__center_8cpp.html#a22f64139a5ad2efe7d615cbf014e88d5">mu</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;X, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Y, double s, double q, double <a class="el" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>, double sigmag, double <a class="el" href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a>)</td></tr>
<tr class="separator:ga95d26655a427c11f6980246d08dfc6d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa6e7ec16d48ed8b56d7182bdb3ca6bbf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#gaa6e7ec16d48ed8b56d7182bdb3ca6bbf">denoiseTVgradient</a> (double <a class="el" href="image__find__center_8cpp.html#a22f64139a5ad2efe7d615cbf014e88d5">mu</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;X, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Y, double s, double q, double <a class="el" href="numerical__recipes_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>, double sigmag, double <a class="el" href="numerical__recipes_8cpp.html#af72286acf4184005499476fbc853146f">g</a>, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;gradientI)</td></tr>
<tr class="separator:gaa6e7ec16d48ed8b56d7182bdb3ca6bbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga984ebe4f19447b7fe6e0ceaf1c70e2df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga984ebe4f19447b7fe6e0ceaf1c70e2df">denoiseTVproj</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;X, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Y, double <a class="el" href="numerical__recipes_8cpp.html#aca81c35c21e3a5f7f3a8d24504e76664">theta</a>, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;dold)</td></tr>
<tr class="separator:ga984ebe4f19447b7fe6e0ceaf1c70e2df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1f9ae594e89b728ac95ed415c00f937d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Filters.html#ga1f9ae594e89b728ac95ed415c00f937d">denoiseTVFilter</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a9459fc814da4e9b187efc77baecf1c07">xnew</a>, int maxIter)</td></tr>
<tr class="separator:ga1f9ae594e89b728ac95ed415c00f937d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfad7869677e95f1063f85c3d755a4d3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="filters_8cpp.html#acfad7869677e95f1063f85c3d755a4d3">matlab_filter</a> (<a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;B, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;A, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;X, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Y, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Z)</td></tr>
<tr class="separator:acfad7869677e95f1063f85c3d755a4d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a83027de735085322bd4cd7d5bcd166d4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHECK_POINT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{ \</div><div class="line">  int I=<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; \</div><div class="line">        int J=<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>; <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">\</a></div><div class="line"><a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">  if</a> (<a class="code" href="group__MultidimensionalArrays.html#gaf8c7a8e1f2bb1b539a7d1543a01be1b6">INSIDEXY</a>(I_out,J,I))  { \</div><div class="line">   double pixel=<a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(I_out,I,J);<a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">\</a></div><div class="line"><a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">   if</a> (pixel!=filling_colour) <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">\</a></div><div class="line"><a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">    if</a> ((less &amp;&amp; pixel &lt; stop_colour) || \</div><div class="line">     (!less &amp;&amp; pixel &gt; stop_colour)) { \</div><div class="line">     coord.ii=I; \</div><div class="line">     coord.jj=J; <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">\</a></div><div class="line"><a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">     A2D_ELEM</a> (I_out,coord.ii,coord.jj)=filling_colour; \</div><div class="line">     iNeighbours.push_front(coord); \</div><div class="line">    } \</div><div class="line">  } \</div><div class="line">    }</div><div class="ttc" id="group__MultidimensionalArrays_html_ga9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00364">multidim_array.h:364</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaf8c7a8e1f2bb1b539a7d1543a01be1b6"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaf8c7a8e1f2bb1b539a7d1543a01be1b6">INSIDEXY</a></div><div class="ttdeci">#define INSIDEXY(v, x, y)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00094">multidim_array.h:94</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a597513406ab82aa15c590f0350102a26"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHECK_POINT_3D</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{\</div><div class="line">     int I=<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; \</div><div class="line">        int J=<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>; \</div><div class="line">        int <a class="code" href="libraries_2data_2integration_8cpp.html#a97d832ae23af4f215e801e37e4f94254">K</a>=<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>; <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">\</a></div><div class="line"><a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">  if</a> (<a class="code" href="group__MultidimensionalArrays.html#ga926055e98bd03ffd30de3a25aba199f0">INSIDEXYZ</a>(V_out,J,I,K))  { \</div><div class="line">   double voxel=<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(V_out,K,I,J); <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">\</a></div><div class="line"><a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">   if</a> (voxel!=filling_colour) <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">\</a></div><div class="line"><a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">    if</a> ((less &amp;&amp; voxel &lt; stop_colour)|| \</div><div class="line">     (!less &amp;&amp;voxel &gt; stop_colour)) { \</div><div class="line">     coord.ii=I; \</div><div class="line">     coord.jj=J; \</div><div class="line">     coord.kk=<a class="code" href="libraries_2data_2integration_8cpp.html#a97d832ae23af4f215e801e37e4f94254">K</a>; <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">\</a></div><div class="line"><a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">     A3D_ELEM</a> (V_out,coord.kk,coord.ii,coord.jj)=filling_colour; \</div><div class="line">     iNeighbours.push_front(coord); \</div><div class="line">    } \</div><div class="line">  }\</div><div class="line"> }</div><div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="libraries_2data_2integration_8cpp_html_a97d832ae23af4f215e801e37e4f94254"><div class="ttname"><a href="libraries_2data_2integration_8cpp.html#a97d832ae23af4f215e801e37e4f94254">K</a></div><div class="ttdeci">#define K</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2integration_8cpp_source.html#l00118">integration.cpp:118</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga926055e98bd03ffd30de3a25aba199f0"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga926055e98bd03ffd30de3a25aba199f0">INSIDEXYZ</a></div><div class="ttdeci">#define INSIDEXYZ(v, x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00097">multidim_array.h:97</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a597513406ab82aa15c590f0350102a26"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHECK_POINT_3D</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{\</div><div class="line">        int I=<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; \</div><div class="line">        int J=<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>; \</div><div class="line">        int <a class="code" href="libraries_2data_2integration_8cpp.html#a97d832ae23af4f215e801e37e4f94254">K</a>=<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>; <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">\</a></div><div class="line"><a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">  if</a> (<a class="code" href="group__MultidimensionalArrays.html#ga926055e98bd03ffd30de3a25aba199f0">INSIDEXYZ</a>(V_out,J,I,K))  { <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">\</a></div><div class="line"><a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">   if</a> (<a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(V_in,K,I,J)==bgColor &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(V_out,K,I,J)==1) { \</div><div class="line">     coord.ii=I; \</div><div class="line">     coord.jj=J; \</div><div class="line">     coord.kk=<a class="code" href="libraries_2data_2integration_8cpp.html#a97d832ae23af4f215e801e37e4f94254">K</a>; <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">\</a></div><div class="line"><a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">     A3D_ELEM</a> (V_out,coord.kk,coord.ii,coord.jj)=filling_value; \</div><div class="line">     iNeighbours.push_front(coord); \</div><div class="line">    } \</div><div class="line">  }\</div><div class="line"> }\</div><div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="libraries_2data_2integration_8cpp_html_a97d832ae23af4f215e801e37e4f94254"><div class="ttname"><a href="libraries_2data_2integration_8cpp.html#a97d832ae23af4f215e801e37e4f94254">K</a></div><div class="ttdeci">#define K</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2integration_8cpp_source.html#l00118">integration.cpp:118</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga926055e98bd03ffd30de3a25aba199f0"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga926055e98bd03ffd30de3a25aba199f0">INSIDEXYZ</a></div><div class="ttdeci">#define INSIDEXYZ(v, x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00097">multidim_array.h:97</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acb31dfe59b3610a058f15e7e56af5f66"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHECK_POINT_DIST</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">proposedDistance&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{ \</div><div class="line">        int ip=<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; \</div><div class="line">        int jp=<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>; <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">\</a></div><div class="line"><a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">        if</a> (wrap) \</div><div class="line">        { \</div><div class="line">            ip=<a class="code" href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a>(ip,<a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(out),<a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(out));\</div><div class="line">            jp=<a class="code" href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a>(jp,<a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(out),<a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(out));\</div><div class="line">        } <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">\</a></div><div class="line"><a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">        if</a> (ip&gt;=<a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(out) &amp;&amp; ip&lt;=<a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(out) &amp;&amp; \</div><div class="line">            jp&gt;=<a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(out) &amp;&amp; jp&lt;=<a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(out)) <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">\</a></div><div class="line"><a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">            if</a> (out(ip,jp)&gt;proposedDistance) \</div><div class="line">            { \</div><div class="line">                out(ip,jp)=proposedDistance; \</div><div class="line">                toExplore.push_back(ip); \</div><div class="line">                toExplore.push_back(jp); \</div><div class="line">                toExplore.push_back(proposedDistance); \</div><div class="line">            } \</div><div class="line">    }</div><div class="ttc" id="group__MultidimensionalArrays_html_ga494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00065">multidim_array.h:65</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00073">multidim_array.h:73</a></div></div>
<div class="ttc" id="group__Macros_html_ga10de40044d2903ec0d4e7e57c31322aa"><div class="ttname"><a href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a></div><div class="ttdeci">#define intWRAP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00272">xmipp_macros.h:272</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a00e670b2b5c8951b8ac881ee55bc7df0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INITIAL_ROTATE_THRESHOLD&#160;&#160;&#160;<a class="el" href="mpi__classify__CL2D_8cpp.html#a88152d5f2092351476e38a3366f08468">ROTATE_THRESHOLD</a> + 1.0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01961">1961</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ada40da844971a04ec690b5e30c65682f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INITIAL_SHIFT_THRESHOLD&#160;&#160;&#160;<a class="el" href="mpi__classify__CL2D_8cpp.html#a51b0b7efbd2dfcb165c0c76d348deb98">SHIFT_THRESHOLD</a> + 1.0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01960">1960</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a88152d5f2092351476e38a3366f08468"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ROTATE_THRESHOLD&#160;&#160;&#160;1.0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01958">1958</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a83f10ea672c60fccf3e6e9ae53a70be4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHAH_CONVERGENCE_THRESHOLD&#160;&#160;&#160;0.0001</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02618">2618</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a51b0b7efbd2dfcb165c0c76d348deb98"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHIFT_THRESHOLD&#160;&#160;&#160;0.95</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01957">1957</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a36c35628e0011847e73d801180599cff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double alignImages </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Iref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAlignmentTransforms.html">AlignmentTransforms</a> &amp;&#160;</td>
          <td class="paramname"><em>IrefTransforms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wrap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAlignmentAux.html">AlignmentAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01963">1963</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;{</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    I.checkDimension(2);</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    aux.<a class="code" href="classAlignmentAux.html#a9c6da19bb54a40e16a70595105d27ecc">ARS</a>.<a class="code" href="classMatrix2D.html#a1b0afdb4a10ad1857db3db8b64715ba3">initIdentity</a>(3);</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    aux.<a class="code" href="classAlignmentAux.html#af59f0257e50f47658572a12c0920ef49">ASR</a>.<a class="code" href="classMatrix2D.html#a1b0afdb4a10ad1857db3db8b64715ba3">initIdentity</a>(3);</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    aux.<a class="code" href="classAlignmentAux.html#afcd706f974c720c9f780cc74d3871b27">IauxSR</a> = I;</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    aux.<a class="code" href="classAlignmentAux.html#abcc10e2a71b4f7926dcece15352faa55">IauxRS</a> = I;</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    aux.<a class="code" href="classAlignmentAux.html#a98331abee96dee4ad5ef50ccf63b6049">rotationalCorr</a>.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(2 * IrefTransforms.<a class="code" href="classAlignmentTransforms.html#a24488091ee4e477b03fdabc30f334fb0">polarFourierI</a>.<a class="code" href="classPolar.html#aa0bc51b4f86113a872aec6c492a0d5a5">getSampleNoOuterRing</a>() - 1);</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    aux3.<a class="code" href="classRotationalCorrelationAux.html#ab6762c27fa075d4c124a5d33a286cd5a">local_transformer</a>.<a class="code" href="classFourierTransformer.html#a18bc840c781555b742d0185fb20925bf">setReal</a>(aux.<a class="code" href="classAlignmentAux.html#a98331abee96dee4ad5ef50ccf63b6049">rotationalCorr</a>);</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    <span class="keywordtype">double</span> shiftXSR=<a class="code" href="filters_8cpp.html#ada40da844971a04ec690b5e30c65682f">INITIAL_SHIFT_THRESHOLD</a>, shiftYSR=<a class="code" href="filters_8cpp.html#ada40da844971a04ec690b5e30c65682f">INITIAL_SHIFT_THRESHOLD</a>, bestRotSR=<a class="code" href="filters_8cpp.html#a00e670b2b5c8951b8ac881ee55bc7df0">INITIAL_ROTATE_THRESHOLD</a>;</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="keywordtype">double</span> shiftXRS=<a class="code" href="filters_8cpp.html#ada40da844971a04ec690b5e30c65682f">INITIAL_SHIFT_THRESHOLD</a>, shiftYRS=<a class="code" href="filters_8cpp.html#ada40da844971a04ec690b5e30c65682f">INITIAL_SHIFT_THRESHOLD</a>, bestRotRS=<a class="code" href="filters_8cpp.html#a00e670b2b5c8951b8ac881ee55bc7df0">INITIAL_ROTATE_THRESHOLD</a>;</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <span class="comment">// Align the image with the reference</span></div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 3; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    {</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        <span class="comment">// Shift then rotate</span></div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        <span class="keywordflow">if</span> (((shiftXSR &gt; <a class="code" href="filters_8cpp.html#a51b0b7efbd2dfcb165c0c76d348deb98">SHIFT_THRESHOLD</a>) || (shiftXSR &lt; (-<a class="code" href="filters_8cpp.html#a51b0b7efbd2dfcb165c0c76d348deb98">SHIFT_THRESHOLD</a>))) ||</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;            ((shiftYSR &gt; <a class="code" href="filters_8cpp.html#a51b0b7efbd2dfcb165c0c76d348deb98">SHIFT_THRESHOLD</a>) || (shiftYSR &lt; (-<a class="code" href="filters_8cpp.html#a51b0b7efbd2dfcb165c0c76d348deb98">SHIFT_THRESHOLD</a>))))</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        {</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;            <a class="code" href="group__Filters.html#ga5aae1ce90626f1f1401defcb6f5d6411">bestNonwrappingShift</a>(Iref, IrefTransforms.<a class="code" href="classAlignmentTransforms.html#a4e3893b8488dc5fe7928a8cac6a53d8b">FFTI</a>, aux.<a class="code" href="classAlignmentAux.html#afcd706f974c720c9f780cc74d3871b27">IauxSR</a>, shiftXSR, shiftYSR, aux2);</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;            <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(aux.<a class="code" href="classAlignmentAux.html#af59f0257e50f47658572a12c0920ef49">ASR</a>,0,2) += shiftXSR;</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;            <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(aux.<a class="code" href="classAlignmentAux.html#af59f0257e50f47658572a12c0920ef49">ASR</a>,1,2) += shiftYSR;</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a>(<a class="code" href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a>, aux.<a class="code" href="classAlignmentAux.html#afcd706f974c720c9f780cc74d3871b27">IauxSR</a>, I, aux.<a class="code" href="classAlignmentAux.html#af59f0257e50f47658572a12c0920ef49">ASR</a>, <a class="code" href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a>, wrap);</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;        }</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        <span class="keywordflow">if</span> (bestRotSR &gt; <a class="code" href="filters_8cpp.html#a88152d5f2092351476e38a3366f08468">ROTATE_THRESHOLD</a>)</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        {</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;            <a class="code" href="polar_8cpp.html#a29cae209c3de81e800a2dcf343a059c4">polarFourierTransform&lt;true&gt;</a>(aux.<a class="code" href="classAlignmentAux.html#afcd706f974c720c9f780cc74d3871b27">IauxSR</a>, aux.<a class="code" href="classAlignmentAux.html#aeff98b12bf17c6c9c3afb2528aacdcb1">polarFourierI</a>, <span class="keyword">true</span>,</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;                                            <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Iref) / 5, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Iref) / 2, aux.<a class="code" href="classAlignmentAux.html#a30708ba47967afcde187d7dc0dcd3e34">plans</a>, 1);</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;            bestRotSR = <a class="code" href="group__Polar.html#gad480d0d51fe785a56c0173a9dfdc8d38">best_rotation</a>(IrefTransforms.<a class="code" href="classAlignmentTransforms.html#a24488091ee4e477b03fdabc30f334fb0">polarFourierI</a>, aux.<a class="code" href="classAlignmentAux.html#aeff98b12bf17c6c9c3afb2528aacdcb1">polarFourierI</a>, aux3);</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#ga93598c1cf08f43c7a58a096003b2d718">rotation2DMatrix</a>(bestRotSR, aux.<a class="code" href="classAlignmentAux.html#a495684f202b87d8a924d2b10e6c73782">R</a>);</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;            aux.<a class="code" href="classAlignmentAux.html#af59f0257e50f47658572a12c0920ef49">ASR</a> = aux.<a class="code" href="classAlignmentAux.html#a495684f202b87d8a924d2b10e6c73782">R</a> * aux.<a class="code" href="classAlignmentAux.html#af59f0257e50f47658572a12c0920ef49">ASR</a>;</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a>(<a class="code" href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a>, aux.<a class="code" href="classAlignmentAux.html#afcd706f974c720c9f780cc74d3871b27">IauxSR</a>, I, aux.<a class="code" href="classAlignmentAux.html#af59f0257e50f47658572a12c0920ef49">ASR</a>, <a class="code" href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a>, wrap);</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;        }</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;        <span class="comment">// Rotate then shift</span></div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;        <span class="keywordflow">if</span> (bestRotRS &gt; <a class="code" href="filters_8cpp.html#a88152d5f2092351476e38a3366f08468">ROTATE_THRESHOLD</a>)</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;        {</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;            <a class="code" href="polar_8cpp.html#a29cae209c3de81e800a2dcf343a059c4">polarFourierTransform&lt;true&gt;</a>(aux.<a class="code" href="classAlignmentAux.html#abcc10e2a71b4f7926dcece15352faa55">IauxRS</a>, aux.<a class="code" href="classAlignmentAux.html#aeff98b12bf17c6c9c3afb2528aacdcb1">polarFourierI</a>, <span class="keyword">true</span>,</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;                                            <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Iref) / 5, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Iref) / 2, aux.<a class="code" href="classAlignmentAux.html#a30708ba47967afcde187d7dc0dcd3e34">plans</a>, 1);</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;            bestRotRS = <a class="code" href="group__Polar.html#gad480d0d51fe785a56c0173a9dfdc8d38">best_rotation</a>(IrefTransforms.<a class="code" href="classAlignmentTransforms.html#a24488091ee4e477b03fdabc30f334fb0">polarFourierI</a>, aux.<a class="code" href="classAlignmentAux.html#aeff98b12bf17c6c9c3afb2528aacdcb1">polarFourierI</a>, aux3);</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#ga93598c1cf08f43c7a58a096003b2d718">rotation2DMatrix</a>(bestRotRS, aux.<a class="code" href="classAlignmentAux.html#a495684f202b87d8a924d2b10e6c73782">R</a>);</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;            aux.<a class="code" href="classAlignmentAux.html#a9c6da19bb54a40e16a70595105d27ecc">ARS</a> = aux.<a class="code" href="classAlignmentAux.html#a495684f202b87d8a924d2b10e6c73782">R</a> * aux.<a class="code" href="classAlignmentAux.html#a9c6da19bb54a40e16a70595105d27ecc">ARS</a>;</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a>(<a class="code" href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a>, aux.<a class="code" href="classAlignmentAux.html#abcc10e2a71b4f7926dcece15352faa55">IauxRS</a>, I, aux.<a class="code" href="classAlignmentAux.html#a9c6da19bb54a40e16a70595105d27ecc">ARS</a>, <a class="code" href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a>, wrap);</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;        }</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;        <span class="keywordflow">if</span> (((shiftXRS &gt; <a class="code" href="filters_8cpp.html#a51b0b7efbd2dfcb165c0c76d348deb98">SHIFT_THRESHOLD</a>) || (shiftXRS &lt; (-<a class="code" href="filters_8cpp.html#a51b0b7efbd2dfcb165c0c76d348deb98">SHIFT_THRESHOLD</a>))) ||</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;            ((shiftYRS &gt; <a class="code" href="filters_8cpp.html#a51b0b7efbd2dfcb165c0c76d348deb98">SHIFT_THRESHOLD</a>) || (shiftYRS &lt; (-<a class="code" href="filters_8cpp.html#a51b0b7efbd2dfcb165c0c76d348deb98">SHIFT_THRESHOLD</a>))))</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        {</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;            <a class="code" href="group__Filters.html#ga5aae1ce90626f1f1401defcb6f5d6411">bestNonwrappingShift</a>(Iref, IrefTransforms.<a class="code" href="classAlignmentTransforms.html#a4e3893b8488dc5fe7928a8cac6a53d8b">FFTI</a>, aux.<a class="code" href="classAlignmentAux.html#abcc10e2a71b4f7926dcece15352faa55">IauxRS</a>, shiftXRS, shiftYRS, aux2);</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;            <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(aux.<a class="code" href="classAlignmentAux.html#a9c6da19bb54a40e16a70595105d27ecc">ARS</a>,0,2) += shiftXRS;</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;            <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(aux.<a class="code" href="classAlignmentAux.html#a9c6da19bb54a40e16a70595105d27ecc">ARS</a>,1,2) += shiftYRS;</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a>(<a class="code" href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a>, aux.<a class="code" href="classAlignmentAux.html#abcc10e2a71b4f7926dcece15352faa55">IauxRS</a>, I, aux.<a class="code" href="classAlignmentAux.html#a9c6da19bb54a40e16a70595105d27ecc">ARS</a>, <a class="code" href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a>, wrap);</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;        }</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    }</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    <span class="keywordtype">double</span> corrRS = <a class="code" href="group__MultidimensionalArrays.html#ga63cca7e01116967ff451df8b1f8b5a4e">correlationIndex</a>(aux.<a class="code" href="classAlignmentAux.html#abcc10e2a71b4f7926dcece15352faa55">IauxRS</a>, Iref);</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    <span class="keywordtype">double</span> corrSR = <a class="code" href="group__MultidimensionalArrays.html#ga63cca7e01116967ff451df8b1f8b5a4e">correlationIndex</a>(aux.<a class="code" href="classAlignmentAux.html#afcd706f974c720c9f780cc74d3871b27">IauxSR</a>, Iref);</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    <span class="keywordtype">double</span> corr;</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    <span class="keywordflow">if</span> (corrRS &gt; corrSR)</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    {</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;        I = aux.<a class="code" href="classAlignmentAux.html#abcc10e2a71b4f7926dcece15352faa55">IauxRS</a>;</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        M = aux.<a class="code" href="classAlignmentAux.html#a9c6da19bb54a40e16a70595105d27ecc">ARS</a>;</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;        corr = corrRS;</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    }</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    {</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;        I = aux.<a class="code" href="classAlignmentAux.html#afcd706f974c720c9f780cc74d3871b27">IauxSR</a>;</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;        M = aux.<a class="code" href="classAlignmentAux.html#af59f0257e50f47658572a12c0920ef49">ASR</a>;</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;        corr = corrSR;</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    }</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <span class="keywordflow">return</span> corr;</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="classAlignmentAux_html_abcc10e2a71b4f7926dcece15352faa55"><div class="ttname"><a href="classAlignmentAux.html#abcc10e2a71b4f7926dcece15352faa55">AlignmentAux::IauxRS</a></div><div class="ttdeci">MultidimArray&lt; double &gt; IauxRS</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00503">filters.h:503</a></div></div>
<div class="ttc" id="classAlignmentTransforms_html_a4e3893b8488dc5fe7928a8cac6a53d8b"><div class="ttname"><a href="classAlignmentTransforms.html#a4e3893b8488dc5fe7928a8cac6a53d8b">AlignmentTransforms::FFTI</a></div><div class="ttdeci">MultidimArray&lt; std::complex&lt; double &gt; &gt; FFTI</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00514">filters.h:514</a></div></div>
<div class="ttc" id="classAlignmentAux_html_af59f0257e50f47658572a12c0920ef49"><div class="ttname"><a href="classAlignmentAux.html#af59f0257e50f47658572a12c0920ef49">AlignmentAux::ASR</a></div><div class="ttdeci">Matrix2D&lt; double &gt; ASR</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00502">filters.h:502</a></div></div>
<div class="ttc" id="classAlignmentAux_html_afcd706f974c720c9f780cc74d3871b27"><div class="ttname"><a href="classAlignmentAux.html#afcd706f974c720c9f780cc74d3871b27">AlignmentAux::IauxSR</a></div><div class="ttdeci">MultidimArray&lt; double &gt; IauxSR</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00503">filters.h:503</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga3cc15e5dda7c58b9cacb7eee440d6bdc"><div class="ttname"><a href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a></div><div class="ttdeci">void applyGeometry(int SplineDegree, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V2, const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V1, const Matrix2D&lt; double &gt; &amp;A, bool inv, bool wrap, std::complex&lt; double &gt; outside, MultidimArray&lt; double &gt; *BcoeffsPtr)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00517">transformations.cpp:517</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga63cca7e01116967ff451df8b1f8b5a4e"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga63cca7e01116967ff451df8b1f8b5a4e">correlationIndex</a></div><div class="ttdeci">double correlationIndex(const MultidimArray&lt; T &gt; &amp;x, const MultidimArray&lt; T &gt; &amp;y, const MultidimArray&lt; int &gt; *mask=NULL, MultidimArray&lt; double &gt; *Contributions=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05692">multidim_array.h:5692</a></div></div>
<div class="ttc" id="classAlignmentAux_html_a30708ba47967afcde187d7dc0dcd3e34"><div class="ttname"><a href="classAlignmentAux.html#a30708ba47967afcde187d7dc0dcd3e34">AlignmentAux::plans</a></div><div class="ttdeci">Polar_fftw_plans * plans</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00504">filters.h:504</a></div></div>
<div class="ttc" id="group__Filters_html_ga5aae1ce90626f1f1401defcb6f5d6411"><div class="ttname"><a href="group__Filters.html#ga5aae1ce90626f1f1401defcb6f5d6411">bestNonwrappingShift</a></div><div class="ttdeci">void bestNonwrappingShift(const MultidimArray&lt; double &gt; &amp;I1, const MultidimArray&lt; double &gt; &amp;I2, double &amp;shiftX, double &amp;shiftY, CorrelationAux &amp;aux)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l01812">filters.cpp:1812</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Matrices_html_gab40746be05d4bbf352787018922ecc2e"><div class="ttname"><a href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a></div><div class="ttdeci">#define MAT_ELEM(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00117">matrix2d.h:117</a></div></div>
<div class="ttc" id="group__Polar_html_gad480d0d51fe785a56c0173a9dfdc8d38"><div class="ttname"><a href="group__Polar.html#gad480d0d51fe785a56c0173a9dfdc8d38">best_rotation</a></div><div class="ttdeci">double best_rotation(const Polar&lt; std::complex&lt; double &gt; &gt; &amp;I1, const Polar&lt; std::complex&lt; double &gt; &gt; &amp;I2, RotationalCorrelationAux &amp;aux)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8cpp_source.html#l00165">polar.cpp:165</a></div></div>
<div class="ttc" id="filters_8cpp_html_a51b0b7efbd2dfcb165c0c76d348deb98"><div class="ttname"><a href="filters_8cpp.html#a51b0b7efbd2dfcb165c0c76d348deb98">SHIFT_THRESHOLD</a></div><div class="ttdeci">#define SHIFT_THRESHOLD</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l01957">filters.cpp:1957</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a18bc840c781555b742d0185fb20925bf"><div class="ttname"><a href="classFourierTransformer.html#a18bc840c781555b742d0185fb20925bf">FourierTransformer::setReal</a></div><div class="ttdeci">void setReal(MultidimArray&lt; double &gt; &amp;img)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00129">xmipp_fftw.cpp:129</a></div></div>
<div class="ttc" id="filters_8cpp_html_a00e670b2b5c8951b8ac881ee55bc7df0"><div class="ttname"><a href="filters_8cpp.html#a00e670b2b5c8951b8ac881ee55bc7df0">INITIAL_ROTATE_THRESHOLD</a></div><div class="ttdeci">#define INITIAL_ROTATE_THRESHOLD</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l01961">filters.cpp:1961</a></div></div>
<div class="ttc" id="classAlignmentAux_html_aeff98b12bf17c6c9c3afb2528aacdcb1"><div class="ttname"><a href="classAlignmentAux.html#aeff98b12bf17c6c9c3afb2528aacdcb1">AlignmentAux::polarFourierI</a></div><div class="ttdeci">Polar&lt; std::complex&lt; double &gt; &gt; polarFourierI</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00505">filters.h:505</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gac645eb9a88619ee6f5e14c557ab8ef62"><div class="ttname"><a href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a></div><div class="ttdeci">#define LINEAR</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00208">transformations.h:208</a></div></div>
<div class="ttc" id="classAlignmentAux_html_a98331abee96dee4ad5ef50ccf63b6049"><div class="ttname"><a href="classAlignmentAux.html#a98331abee96dee4ad5ef50ccf63b6049">AlignmentAux::rotationalCorr</a></div><div class="ttdeci">MultidimArray&lt; double &gt; rotationalCorr</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00503">filters.h:503</a></div></div>
<div class="ttc" id="filters_8cpp_html_a88152d5f2092351476e38a3366f08468"><div class="ttname"><a href="filters_8cpp.html#a88152d5f2092351476e38a3366f08468">ROTATE_THRESHOLD</a></div><div class="ttdeci">#define ROTATE_THRESHOLD</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l01958">filters.cpp:1958</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga93598c1cf08f43c7a58a096003b2d718"><div class="ttname"><a href="group__GeometricalTransformations.html#ga93598c1cf08f43c7a58a096003b2d718">rotation2DMatrix</a></div><div class="ttdeci">void rotation2DMatrix(T ang, Matrix2D&lt; T &gt; &amp;result, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00212">transformations.cpp:212</a></div></div>
<div class="ttc" id="filters_8cpp_html_ada40da844971a04ec690b5e30c65682f"><div class="ttname"><a href="filters_8cpp.html#ada40da844971a04ec690b5e30c65682f">INITIAL_SHIFT_THRESHOLD</a></div><div class="ttdeci">#define INITIAL_SHIFT_THRESHOLD</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l01960">filters.cpp:1960</a></div></div>
<div class="ttc" id="classRotationalCorrelationAux_html_ab6762c27fa075d4c124a5d33a286cd5a"><div class="ttname"><a href="classRotationalCorrelationAux.html#ab6762c27fa075d4c124a5d33a286cd5a">RotationalCorrelationAux::local_transformer</a></div><div class="ttdeci">FourierTransformer local_transformer</div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00791">polar.h:791</a></div></div>
<div class="ttc" id="classAlignmentAux_html_a495684f202b87d8a924d2b10e6c73782"><div class="ttname"><a href="classAlignmentAux.html#a495684f202b87d8a924d2b10e6c73782">AlignmentAux::R</a></div><div class="ttdeci">Matrix2D&lt; double &gt; R</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00502">filters.h:502</a></div></div>
<div class="ttc" id="transformations_8h_html_a3a4a05e15fc1cc8a66159304e4c33eb1"><div class="ttname"><a href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a></div><div class="ttdeci">#define IS_NOT_INV</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00041">transformations.h:41</a></div></div>
<div class="ttc" id="classAlignmentAux_html_a9c6da19bb54a40e16a70595105d27ecc"><div class="ttname"><a href="classAlignmentAux.html#a9c6da19bb54a40e16a70595105d27ecc">AlignmentAux::ARS</a></div><div class="ttdeci">Matrix2D&lt; double &gt; ARS</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00502">filters.h:502</a></div></div>
<div class="ttc" id="classAlignmentTransforms_html_a24488091ee4e477b03fdabc30f334fb0"><div class="ttname"><a href="classAlignmentTransforms.html#a24488091ee4e477b03fdabc30f334fb0">AlignmentTransforms::polarFourierI</a></div><div class="ttdeci">Polar&lt; std::complex&lt; double &gt; &gt; polarFourierI</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00513">filters.h:513</a></div></div>
<div class="ttc" id="classPolar_html_aa0bc51b4f86113a872aec6c492a0d5a5"><div class="ttname"><a href="classPolar.html#aa0bc51b4f86113a872aec6c492a0d5a5">Polar::getSampleNoOuterRing</a></div><div class="ttdeci">int getSampleNoOuterRing() const </div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00380">polar.h:380</a></div></div>
<div class="ttc" id="classMatrix2D_html_a1b0afdb4a10ad1857db3db8b64715ba3"><div class="ttname"><a href="classMatrix2D.html#a1b0afdb4a10ad1857db3db8b64715ba3">Matrix2D::initIdentity</a></div><div class="ttdeci">void initIdentity()</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00835">matrix2d.h:835</a></div></div>
<div class="ttc" id="polar_8cpp_html_a29cae209c3de81e800a2dcf343a059c4"><div class="ttname"><a href="polar_8cpp.html#a29cae209c3de81e800a2dcf343a059c4">polarFourierTransform&lt; true &gt;</a></div><div class="ttdeci">template void polarFourierTransform&lt; true &gt;(const MultidimArray&lt; double &gt; &amp;in, Polar&lt; std::complex&lt; double &gt; &gt; &amp;out, bool conjugated, int first_ring, int last_ring, Polar_fftw_plans *&amp;plans, int BsplineOrder)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acfc8d89899b538e61a9fa3c3f8955f39"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double alignImagesConsideringMirrors </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Iref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAlignmentTransforms.html">AlignmentTransforms</a> &amp;&#160;</td>
          <td class="paramname"><em>IrefTransforms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAlignmentAux.html">AlignmentAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wrap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>mask</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fast alignment of two images considering mirrors. The transforms of Iref are presumed to be precomputed in IrefTransforms. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02062">2062</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;{</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Imirror;</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> Mmirror;</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    Imirror = I;</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    Imirror.<a class="code" href="classMultidimArray.html#a6db384c048f3f89a1a8d5c36cec07fbc">selfReverseX</a>();</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    Imirror.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    <span class="keywordtype">double</span> corr=<a class="code" href="filters_8cpp.html#a36c35628e0011847e73d801180599cff">alignImages</a>(Iref, IrefTransforms, I, M, wrap, aux, aux2, aux3);</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    <span class="keywordtype">double</span> corrMirror=<a class="code" href="filters_8cpp.html#a36c35628e0011847e73d801180599cff">alignImages</a>(Iref, IrefTransforms, Imirror, Mmirror, wrap, aux, aux2, aux3);</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    <span class="keywordflow">if</span> (mask!=NULL)</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    {</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;        corr = <a class="code" href="group__MultidimensionalArrays.html#ga63cca7e01116967ff451df8b1f8b5a4e">correlationIndex</a>(Iref, I, mask);</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;        corrMirror = <a class="code" href="group__MultidimensionalArrays.html#ga63cca7e01116967ff451df8b1f8b5a4e">correlationIndex</a>(Iref, Imirror, mask);</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    }</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    <span class="keywordtype">double</span> bestCorr = corr;</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <span class="keywordflow">if</span> (corrMirror &gt; bestCorr)</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    {</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        bestCorr = corrMirror;</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;        I = Imirror;</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        M = Mmirror;</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(M,0,0) *= -1;</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;        <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(M,1,0) *= -1;</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    }</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    <span class="keywordflow">return</span> bestCorr;</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="filters_8cpp_html_a36c35628e0011847e73d801180599cff"><div class="ttname"><a href="filters_8cpp.html#a36c35628e0011847e73d801180599cff">alignImages</a></div><div class="ttdeci">double alignImages(const MultidimArray&lt; double &gt; &amp;Iref, const AlignmentTransforms &amp;IrefTransforms, MultidimArray&lt; double &gt; &amp;I, Matrix2D&lt; double &gt; &amp;M, bool wrap, AlignmentAux &amp;aux, CorrelationAux &amp;aux2, RotationalCorrelationAux &amp;aux3)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l01963">filters.cpp:1963</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga63cca7e01116967ff451df8b1f8b5a4e"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga63cca7e01116967ff451df8b1f8b5a4e">correlationIndex</a></div><div class="ttdeci">double correlationIndex(const MultidimArray&lt; T &gt; &amp;x, const MultidimArray&lt; T &gt; &amp;y, const MultidimArray&lt; int &gt; *mask=NULL, MultidimArray&lt; double &gt; *Contributions=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05692">multidim_array.h:5692</a></div></div>
<div class="ttc" id="classMultidimArray_html_a6db384c048f3f89a1a8d5c36cec07fbc"><div class="ttname"><a href="classMultidimArray.html#a6db384c048f3f89a1a8d5c36cec07fbc">MultidimArray::selfReverseX</a></div><div class="ttdeci">void selfReverseX()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05191">multidim_array.h:5191</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="group__Matrices_html_gab40746be05d4bbf352787018922ecc2e"><div class="ttname"><a href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a></div><div class="ttdeci">#define MAT_ELEM(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00117">matrix2d.h:117</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aec95c3eb10e62d1773b91a721e438b69"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double alignImagesConsideringMirrors </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Iref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wrap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Align two images considering mirrors </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02092">2092</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;{</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <a class="code" href="classAlignmentAux.html">AlignmentAux</a> aux;</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    <a class="code" href="classCorrelationAux.html">CorrelationAux</a> aux2;</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;    <a class="code" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> aux3;</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="filters_8cpp.html#acfc8d89899b538e61a9fa3c3f8955f39">alignImagesConsideringMirrors</a>(Iref, I, M, aux, aux2, aux3, wrap, NULL);</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;}</div><div class="ttc" id="classCorrelationAux_html"><div class="ttname"><a href="classCorrelationAux.html">CorrelationAux</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00551">xmipp_fftw.h:551</a></div></div>
<div class="ttc" id="classRotationalCorrelationAux_html"><div class="ttname"><a href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a></div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00788">polar.h:788</a></div></div>
<div class="ttc" id="filters_8cpp_html_acfc8d89899b538e61a9fa3c3f8955f39"><div class="ttname"><a href="filters_8cpp.html#acfc8d89899b538e61a9fa3c3f8955f39">alignImagesConsideringMirrors</a></div><div class="ttdeci">double alignImagesConsideringMirrors(const MultidimArray&lt; double &gt; &amp;Iref, const AlignmentTransforms &amp;IrefTransforms, MultidimArray&lt; double &gt; &amp;I, Matrix2D&lt; double &gt; &amp;M, AlignmentAux &amp;aux, CorrelationAux &amp;aux2, RotationalCorrelationAux &amp;aux3, bool wrap, const MultidimArray&lt; int &gt; *mask)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l02062">filters.cpp:2062</a></div></div>
<div class="ttc" id="classAlignmentAux_html"><div class="ttname"><a href="classAlignmentAux.html">AlignmentAux</a></div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00499">filters.h:499</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7dcc2b7cd1ade97de5cafb69edda818f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void alignSetOfImages </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMetaData.html">MetaData</a> &amp;&#160;</td>
          <td class="paramname"><em>MD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Iavg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Niter</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>considerMirror</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Align a set of images. Align a set of images and produce a class average as well as the set of alignment parameters. The output is in Iavg. The metadata is modified by adding the alignment information (transformation and euclidean distance to the average. The process is iterative, first an average is computed. All images are aligned to the average, and this is updated. The process is run for a given number of iterations. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02111">2111</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;{</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    <a class="code" href="classImage.html">Image&lt;double&gt;</a> I;</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> InewAvg;</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    <a class="code" href="classFileName.html">FileName</a> fnImg;</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    <a class="code" href="classAlignmentAux.html">AlignmentAux</a> aux;</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;    <a class="code" href="classCorrelationAux.html">CorrelationAux</a> aux2;</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    <a class="code" href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a> aux3;</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> M;</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    <span class="keywordtype">size_t</span> Nimgs;</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    <span class="keywordtype">size_t</span> Xdim, Ydim, Zdim;</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    <a class="code" href="group__MetaDataExtension.html#gac0be4f4f5a50390ff4939b437170e700">getImageSize</a>(MD, Xdim, Ydim, Zdim, Nimgs);</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = 0; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> &lt; Niter; ++<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    {</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;        <span class="keywordtype">bool</span> lastIteration = (<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> == (Niter - 1));</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;        InewAvg.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(Ydim, Xdim);</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;        InewAvg.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;        <a class="code" href="group__MetaData.html#ga85652b971edca3acc93a9f1bef2f17f6">FOR_ALL_OBJECTS_IN_METADATA</a>(MD)</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;        {</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;            MD.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a>, fnImg, __iter.objId);</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;            I.<a class="code" href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">read</a>(fnImg);</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;            I().setXmippOrigin();</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;            <span class="keywordtype">double</span> corr;</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;            <span class="keywordflow">if</span> (considerMirror)</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;                corr = <a class="code" href="filters_8cpp.html#acfc8d89899b538e61a9fa3c3f8955f39">alignImagesConsideringMirrors</a>(Iavg, I(), M, aux, aux2,</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;                                                     aux3, <a class="code" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a>);</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;                corr = <a class="code" href="filters_8cpp.html#a36c35628e0011847e73d801180599cff">alignImages</a>(Iavg, I(), M, <a class="code" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a>, aux, aux2, aux3);</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;            InewAvg += I();</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> == 0)</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                Iavg = InewAvg;</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;            <span class="keywordflow">if</span> (lastIteration)</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;            {</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;                <span class="keywordtype">double</span> scale, shiftx, shifty, <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>;</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;                <span class="keywordtype">bool</span> flip;</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;                <a class="code" href="group__GeometricalTransformations.html#gab70aa0d1b7ed21012af53afc71b13930">transformationMatrix2Parameters2D</a>(M, flip, scale, shiftx,</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;                                                  shifty, psi);</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                MD.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af6495a877b8c80b9c45b8156b406b183">MDL_FLIP</a>, flip, __iter.objId);</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                MD.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acb3aa7acca32f4524608635e2e09650e">MDL_SHIFT_X</a>, shiftx, __iter.objId);</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;                MD.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab00882fc483e9a1a7e6af5829a6afb8e">MDL_SHIFT_Y</a>, shifty, __iter.objId);</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;                MD.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a114e3414dd216e4308946a016b5cc46f">MDL_ANGLE_PSI</a>, psi, __iter.objId);</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;                MD.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a13a2ae711ddad715bec00dcfb45d39e7">MDL_MAXCC</a>, corr, __iter.objId);</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;            }</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;        }</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;        InewAvg /= Nimgs;</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;        Iavg = InewAvg;</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;        <a class="code" href="group__Filters.html#ga6690cfb805eb563bfb5edcfd53b13051">centerImage</a>(Iavg, aux2, aux3, 4);</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    }</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gab70aa0d1b7ed21012af53afc71b13930"><div class="ttname"><a href="group__GeometricalTransformations.html#gab70aa0d1b7ed21012af53afc71b13930">transformationMatrix2Parameters2D</a></div><div class="ttdeci">void transformationMatrix2Parameters2D(const Matrix2D&lt; T &gt; &amp;A, bool &amp;flip, T &amp;scale, T &amp;shiftX, T &amp;shiftY, T &amp;psi)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00123">transformations.cpp:123</a></div></div>
<div class="ttc" id="filters_8cpp_html_a36c35628e0011847e73d801180599cff"><div class="ttname"><a href="filters_8cpp.html#a36c35628e0011847e73d801180599cff">alignImages</a></div><div class="ttdeci">double alignImages(const MultidimArray&lt; double &gt; &amp;Iref, const AlignmentTransforms &amp;IrefTransforms, MultidimArray&lt; double &gt; &amp;I, Matrix2D&lt; double &gt; &amp;M, bool wrap, AlignmentAux &amp;aux, CorrelationAux &amp;aux2, RotationalCorrelationAux &amp;aux3)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l01963">filters.cpp:1963</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78acb3aa7acca32f4524608635e2e09650e"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acb3aa7acca32f4524608635e2e09650e">MDL_SHIFT_X</a></div><div class="ttdoc">Shift for the image in the X axis (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00412">metadata_label.h:412</a></div></div>
<div class="ttc" id="group__MetaDataExtension_html_gac0be4f4f5a50390ff4939b437170e700"><div class="ttname"><a href="group__MetaDataExtension.html#gac0be4f4f5a50390ff4939b437170e700">getImageSize</a></div><div class="ttdeci">void getImageSize(const MetaData &amp;md, size_t &amp;Xdim, size_t &amp;Ydim, size_t &amp;Zdim, size_t &amp;Ndim, MDLabel image_label)</div><div class="ttdef"><b>Definition:</b> <a href="metadata__extension_8cpp_source.html#l00260">metadata_extension.cpp:260</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a114e3414dd216e4308946a016b5cc46f"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a114e3414dd216e4308946a016b5cc46f">MDL_ANGLE_PSI</a></div><div class="ttdoc">Special label to be used when gathering MDs in MpiMetadataPrograms. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00054">metadata_label.h:54</a></div></div>
<div class="ttc" id="transformations_8h_html_a43c1de45dbd91827a260224c9c40221b"><div class="ttname"><a href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a></div><div class="ttdeci">#define WRAP</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00043">transformations.h:43</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00068">xmipp_filename.h:68</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="group__Filters_html_ga6690cfb805eb563bfb5edcfd53b13051"><div class="ttname"><a href="group__Filters.html#ga6690cfb805eb563bfb5edcfd53b13051">centerImage</a></div><div class="ttdeci">Matrix2D&lt; double &gt; centerImage(MultidimArray&lt; double &gt; &amp;I, CorrelationAux &amp;aux, RotationalCorrelationAux &amp;aux2, int Niter, bool limitShift)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l03156">filters.cpp:3156</a></div></div>
<div class="ttc" id="classMetaData_html_a2239fbb7e492654f1e2866ab27492a5d"><div class="ttname"><a href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">MetaData::getValue</a></div><div class="ttdeci">bool getValue(MDObject &amp;mdValueOut, size_t id) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00217">metadata.cpp:217</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af6495a877b8c80b9c45b8156b406b183"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af6495a877b8c80b9c45b8156b406b183">MDL_FLIP</a></div><div class="ttdoc">Flip the image? (bool) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00231">metadata_label.h:231</a></div></div>
<div class="ttc" id="group__MetaData_html_ga85652b971edca3acc93a9f1bef2f17f6"><div class="ttname"><a href="group__MetaData.html#ga85652b971edca3acc93a9f1bef2f17f6">FOR_ALL_OBJECTS_IN_METADATA</a></div><div class="ttdeci">#define FOR_ALL_OBJECTS_IN_METADATA(__md)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00081">metadata.h:81</a></div></div>
<div class="ttc" id="classCorrelationAux_html"><div class="ttname"><a href="classCorrelationAux.html">CorrelationAux</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00551">xmipp_fftw.h:551</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a13a2ae711ddad715bec00dcfb45d39e7"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a13a2ae711ddad715bec00dcfb45d39e7">MDL_MAXCC</a></div><div class="ttdoc">Maximum cross-correlation for the image (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00268">metadata_label.h:268</a></div></div>
<div class="ttc" id="classMetaData_html_adf4ee2ad1ad0964990a8a11a2109d578"><div class="ttname"><a href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">MetaData::setValue</a></div><div class="ttdeci">bool setValue(const MDLabel label, const T &amp;valueIn, size_t id)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00550">metadata.h:550</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="classRotationalCorrelationAux_html"><div class="ttname"><a href="classRotationalCorrelationAux.html">RotationalCorrelationAux</a></div><div class="ttdef"><b>Definition:</b> <a href="polar_8h_source.html#l00788">polar.h:788</a></div></div>
<div class="ttc" id="classImageBase_html_a88636b7a7bd4e0e454877e691ee2da84"><div class="ttname"><a href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">ImageBase::read</a></div><div class="ttdeci">int read(const FileName &amp;name, DataMode datamode=DATA, size_t select_img=ALL_IMAGES, bool mapData=false, int mode=WRITE_READONLY)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00061">xmipp_image_base.cpp:61</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab00882fc483e9a1a7e6af5829a6afb8e"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab00882fc483e9a1a7e6af5829a6afb8e">MDL_SHIFT_Y</a></div><div class="ttdoc">Shift for the image in the Y axis (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00415">metadata_label.h:415</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="filters_8cpp_html_acfc8d89899b538e61a9fa3c3f8955f39"><div class="ttname"><a href="filters_8cpp.html#acfc8d89899b538e61a9fa3c3f8955f39">alignImagesConsideringMirrors</a></div><div class="ttdeci">double alignImagesConsideringMirrors(const MultidimArray&lt; double &gt; &amp;Iref, const AlignmentTransforms &amp;IrefTransforms, MultidimArray&lt; double &gt; &amp;I, Matrix2D&lt; double &gt; &amp;M, AlignmentAux &amp;aux, CorrelationAux &amp;aux2, RotationalCorrelationAux &amp;aux3, bool wrap, const MultidimArray&lt; int &gt; *mask)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l02062">filters.cpp:2062</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a></div><div class="ttdoc">Name of an image (std::string) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00235">metadata_label.h:235</a></div></div>
<div class="ttc" id="classAlignmentAux_html"><div class="ttname"><a href="classAlignmentAux.html">AlignmentAux</a></div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00499">filters.h:499</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9566ae598791299e963633068ebc6318"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bestNonwrappingShift </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>FFTI1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>shiftX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>shiftY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Translational search (non-wrapping). Assumes that the FFTI1 is already computed. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01820">1820</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;{</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    I1.checkDimension(2);</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    I2.checkDimension(2);</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <a class="code" href="filters_8cpp.html#aa3a842c1f195d82f091c896d33e4de46">bestShift</a>(I1, FFTI1, I2, shiftX, shiftY, aux);</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    <span class="keywordtype">double</span> bestCorr, corr;</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Iaux;</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <a class="code" href="lib__pwk_8cpp.html#a1b33162134537b4be1f614f7e8094d35">translate</a>(1, Iaux, I1, <a class="code" href="group__Vectors.html#ga97ccb86b4c568b2271da21552034d504">vectorR2</a>(-shiftX, -shiftY), <a class="code" href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a>);</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    <span class="comment">//I1.translate(vectorR2(-shiftX,-shiftY),Iaux, DONT_WRAP);</span></div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    bestCorr = corr = <a class="code" href="filters_8h.html#af0a09d803b5a74b56ec37d25c7636fdb">fastCorrelation</a>(I2, Iaux);</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="keywordtype">double</span> finalX = shiftX;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    <span class="keywordtype">double</span> finalY = shiftY;</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;shiftX=&quot;</span> &lt;&lt; shiftX &lt;&lt; <span class="stringliteral">&quot; shiftY=&quot;</span> &lt;&lt; shiftY</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; corr=&quot;</span> &lt;&lt; corr &lt;&lt; std::endl;</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    ImageXmipp save;</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    save()=I1;</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    save.<a class="code" href="classMultidimArray.html#a4a4e45352f73539481de04cbda5f3f3d">write</a>(<span class="stringliteral">&quot;PPPI1.xmp&quot;</span>);</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    save()=I2;</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    save.<a class="code" href="classMultidimArray.html#a4a4e45352f73539481de04cbda5f3f3d">write</a>(<span class="stringliteral">&quot;PPPI2.xmp&quot;</span>);</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    save()=Iaux;</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    save.<a class="code" href="classMultidimArray.html#a4a4e45352f73539481de04cbda5f3f3d">write</a>(<span class="stringliteral">&quot;PPPpp.xmp&quot;</span>);</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    Iaux.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="keywordtype">double</span> testX = (shiftX &gt; 0) ? (shiftX - <a class="code" href="ctf_8h.html#abf4936ae2557c5a607e2ec4f9fd51313">convertSizeTToDouble</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I1))) : (shiftX + <a class="code" href="ctf_8h.html#abf4936ae2557c5a607e2ec4f9fd51313">convertSizeTToDouble</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I1)));</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="keywordtype">double</span> testY = shiftY;</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <a class="code" href="lib__pwk_8cpp.html#a1b33162134537b4be1f614f7e8094d35">translate</a>(1, Iaux, I1, <a class="code" href="group__Vectors.html#ga97ccb86b4c568b2271da21552034d504">vectorR2</a>(-testX, -testY), <a class="code" href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a>);</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    <span class="comment">//I1.translate(vectorR2(-testX,-testY),Iaux,DONT_WRAP);</span></div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    corr = <a class="code" href="filters_8h.html#af0a09d803b5a74b56ec37d25c7636fdb">fastCorrelation</a>(I2, Iaux);</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    <span class="keywordflow">if</span> (corr &gt; bestCorr)</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        finalX = testX;</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;shiftX=&quot;</span> &lt;&lt; testX &lt;&lt; <span class="stringliteral">&quot; shiftY=&quot;</span> &lt;&lt; testY</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; corr=&quot;</span> &lt;&lt; corr &lt;&lt; std::endl;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    save()=Iaux;</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    save.<a class="code" href="classMultidimArray.html#a4a4e45352f73539481de04cbda5f3f3d">write</a>(<span class="stringliteral">&quot;PPPmp.xmp&quot;</span>);</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    Iaux.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    testX = shiftX;</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    testY = (shiftY &gt; 0) ? (shiftY - <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I1)) : (shiftY + <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I1));</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <a class="code" href="lib__pwk_8cpp.html#a1b33162134537b4be1f614f7e8094d35">translate</a>(1, Iaux, I1, <a class="code" href="group__Vectors.html#ga97ccb86b4c568b2271da21552034d504">vectorR2</a>(-testX, -testY), <a class="code" href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a>);</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    <span class="comment">//I1.translate(vectorR2(-testX,-testY),Iaux,DONT_WRAP);</span></div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    corr = <a class="code" href="filters_8h.html#af0a09d803b5a74b56ec37d25c7636fdb">fastCorrelation</a>(I2, Iaux);</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="keywordflow">if</span> (corr &gt; bestCorr)</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;        finalY = testY;</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;shiftX=&quot;</span> &lt;&lt; testX &lt;&lt; <span class="stringliteral">&quot; shiftY=&quot;</span> &lt;&lt; testY</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; corr=&quot;</span> &lt;&lt; corr &lt;&lt; std::endl;</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    save()=Iaux;</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    save.<a class="code" href="classMultidimArray.html#a4a4e45352f73539481de04cbda5f3f3d">write</a>(<span class="stringliteral">&quot;PPPpm.xmp&quot;</span>);</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    Iaux.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    testX = (shiftX &gt; 0) ? (shiftX - <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I1)) : (shiftX + <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I1));</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    testY = (shiftY &gt; 0) ? (shiftY - <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I1)) : (shiftY + <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I1));</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    <a class="code" href="lib__pwk_8cpp.html#a1b33162134537b4be1f614f7e8094d35">translate</a>(1, Iaux, I1, <a class="code" href="group__Vectors.html#ga97ccb86b4c568b2271da21552034d504">vectorR2</a>(-testX, -testY), <a class="code" href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a>);</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    <span class="comment">//I1.translate(vectorR2(-testX,-testY),Iaux,DONT_WRAP);</span></div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    corr = <a class="code" href="filters_8h.html#af0a09d803b5a74b56ec37d25c7636fdb">fastCorrelation</a>(I2, Iaux);</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    <span class="keywordflow">if</span> (corr &gt; bestCorr)</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    {</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;        finalX = testX;</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        finalY = testY;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    }</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;shiftX=&quot;</span> &lt;&lt; testX &lt;&lt; <span class="stringliteral">&quot; shiftY=&quot;</span> &lt;&lt; testY</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; corr=&quot;</span> &lt;&lt; corr &lt;&lt; std::endl;</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    save()=Iaux;</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    save.<a class="code" href="classMultidimArray.html#a4a4e45352f73539481de04cbda5f3f3d">write</a>(<span class="stringliteral">&quot;PPPmm.xmp&quot;</span>);</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    shiftX = finalX;</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    shiftY = finalY;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;}</div><div class="ttc" id="ctf_8h_html_abf4936ae2557c5a607e2ec4f9fd51313"><div class="ttname"><a href="ctf_8h.html#abf4936ae2557c5a607e2ec4f9fd51313">convertSizeTToDouble</a></div><div class="ttdeci">double convertSizeTToDouble(size_t data)</div><div class="ttdef"><b>Definition:</b> <a href="ctf_8h_source.html#l00059">ctf.h:59</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classMultidimArray_html_a4a4e45352f73539481de04cbda5f3f3d"><div class="ttname"><a href="classMultidimArray.html#a4a4e45352f73539481de04cbda5f3f3d">MultidimArray::write</a></div><div class="ttdeci">void write(const FileName &amp;fn) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05329">multidim_array.h:5329</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="group__Vectors_html_ga97ccb86b4c568b2271da21552034d504"><div class="ttname"><a href="group__Vectors.html#ga97ccb86b4c568b2271da21552034d504">vectorR2</a></div><div class="ttdeci">Matrix1D&lt; double &gt; vectorR2(double x, double y)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8cpp_source.html#l00028">matrix1d.cpp:28</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="transformations_8h_html_a9fbfdbc149e55def0e63127fcb558d13"><div class="ttname"><a href="transformations_8h.html#a9fbfdbc149e55def0e63127fcb558d13">DONT_WRAP</a></div><div class="ttdeci">#define DONT_WRAP</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00042">transformations.h:42</a></div></div>
<div class="ttc" id="filters_8h_html_af0a09d803b5a74b56ec37d25c7636fdb"><div class="ttname"><a href="filters_8h.html#af0a09d803b5a74b56ec37d25c7636fdb">fastCorrelation</a></div><div class="ttdeci">T fastCorrelation(const MultidimArray&lt; T &gt; &amp;x, const MultidimArray&lt; T &gt; &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00322">filters.h:322</a></div></div>
<div class="ttc" id="lib__pwk_8cpp_html_a1b33162134537b4be1f614f7e8094d35"><div class="ttname"><a href="lib__pwk_8cpp.html#a1b33162134537b4be1f614f7e8094d35">translate</a></div><div class="ttdeci">void translate(PDB *pdb_original, PDB *pdb_move, unsigned num_atoms, double x0, double y0, double z0)</div><div class="ttdef"><b>Definition:</b> <a href="lib__pwk_8cpp_source.html#l00125">lib_pwk.cpp:125</a></div></div>
<div class="ttc" id="filters_8cpp_html_aa3a842c1f195d82f091c896d33e4de46"><div class="ttname"><a href="filters_8cpp.html#aa3a842c1f195d82f091c896d33e4de46">bestShift</a></div><div class="ttdeci">template float bestShift(MultidimArray&lt; float &gt; &amp;, float &amp;, float &amp;, const MultidimArray&lt; int &gt; *, int)</div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa3a842c1f195d82f091c896d33e4de46"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">template float bestShift </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; float &gt; &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3563db637600632950d47480a21b4b1f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">T bestShift </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>Mcorr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T &amp;&#160;</td>
          <td class="paramname"><em>shiftX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T &amp;&#160;</td>
          <td class="paramname"><em>shiftY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxShift</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01529">1529</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;{</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <span class="keywordtype">int</span> imax = INT_MIN;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    <span class="keywordtype">int</span> jmax, i_actual, j_actual;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    <span class="keywordtype">double</span> xmax, ymax, avecorr, stdcorr, <a class="code" href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a>;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="keywordtype">bool</span> neighbourhood = <span class="keyword">true</span>;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;<span class="comment">     Warning: for masks with a small number of non-zero pixels, this routine is NOT reliable...</span></div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="comment">     Anyway, maybe using a mask is not a good idea at al...</span></div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="comment">// Adjust statistics within shiftmask to average 0 and stddev 1</span></div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <span class="keywordflow">if</span> (mask != NULL)</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    {</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        <span class="keywordflow">if</span> ((*mask).sum() &lt; 2)</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        {</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;            shiftX = shiftY = 0.;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;        }</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;        {</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;            <a class="code" href="group__Masks.html#ga5bd552c32d3d6b6abd6ddf18677cf647">computeStats_within_binary_mask</a>(*mask, Mcorr, dummy, dummy, avecorr,</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                                            stdcorr);</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;            <span class="keywordtype">double</span> istdcorr = 1.0 / stdcorr;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(Mcorr)</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(*mask, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>))</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(Mcorr, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>) =</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                    (<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(Mcorr, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>) - avecorr)</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                    * istdcorr;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;            <a class="code" href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(Mcorr, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>) = 0.;</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        }</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    }</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        Mcorr.statisticsAdjust((T)0, (T)1);</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <span class="comment">// Look for maximum shift</span></div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (maxShift==-1)</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        Mcorr.maxIndex(imax, jmax);</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    {</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        <span class="keywordtype">int</span> maxShift2=maxShift*maxShift;</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        <span class="keywordtype">double</span> bestCorr=std::numeric_limits&lt;T&gt;::lowest();</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=-maxShift; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;=maxShift; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=-maxShift; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;=maxShift; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;            {</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>*<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>*<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&gt;maxShift2) <span class="comment">// continue if the Euclidean distance is too far</span></div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Mcorr, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)&gt;bestCorr)</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                {</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;                    imax=<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                    jmax=<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                    bestCorr=<a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Mcorr, imax, jmax);</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                }</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;            }</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    }</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">max</a> = <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Mcorr, imax, jmax);</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    <span class="comment">// Estimate n_max around the maximum</span></div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    <span class="keywordtype">int</span> n_max = -1;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <span class="keywordflow">while</span> (neighbourhood)</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    {</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;        n_max++;</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = -n_max; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= n_max &amp;&amp; neighbourhood; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;        {</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;            i_actual = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + imax;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;            <span class="keywordflow">if</span> (i_actual &lt; <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(Mcorr) || i_actual &gt; <a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(Mcorr))</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            {</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                neighbourhood = <span class="keyword">false</span>;</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;            }</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = -n_max; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt;= n_max &amp;&amp; neighbourhood; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;            {</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                j_actual = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + jmax;</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                <span class="keywordflow">if</span> (j_actual &lt; <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(Mcorr) || j_actual &gt; <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(Mcorr))</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                {</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                    neighbourhood = <span class="keyword">false</span>;</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                }</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (max / 1.414 &gt; <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Mcorr, i_actual, j_actual))</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                {</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                    neighbourhood = <span class="keyword">false</span>;</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                }</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;            }</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        }</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    }</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    <span class="comment">// We have the neighbourhood =&gt; looking for the gravity centre</span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    xmax = ymax = 0.;</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <span class="keywordtype">double</span> sumcorr = 0.;</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <span class="keywordflow">if</span> (imax-n_max&lt;<a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(Mcorr))</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;        n_max=<a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(imax-<a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(Mcorr),n_max);</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="keywordflow">if</span> (imax+n_max&gt;<a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(Mcorr))</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;        n_max=<a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(<a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(Mcorr)-imax,n_max);</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="keywordflow">if</span> (jmax-n_max&lt;<a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(Mcorr))</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;        n_max=<a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(jmax-<a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(Mcorr),n_max);</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <span class="keywordflow">if</span> (jmax+n_max&gt;<a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(Mcorr))</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;        n_max=<a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(<a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(Mcorr)-jmax,n_max);</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = -n_max; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= n_max; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    {</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        i_actual = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + imax;</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = -n_max; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt;= n_max; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;        {</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;            j_actual = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + jmax;</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;            <span class="keywordtype">double</span> val = <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Mcorr, i_actual, j_actual);</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;            ymax += i_actual * val;</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;            xmax += j_actual * val;</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;            sumcorr += val;</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        }</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    }</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    <span class="keywordflow">if</span> (sumcorr != 0)</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    {</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;        shiftX = xmax / sumcorr;</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        shiftY = ymax / sumcorr;</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    }</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">max</a>;</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_a0544c3fe466e421738dae463968b70ba"><div class="ttname"><a href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="ttdeci">else</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02919">numerical_recipes.cpp:2919</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_afbbd36781c10524238c70745c6f6f35d"><div class="ttname"><a href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">min</a></div><div class="ttdeci">void min(Image&lt; double &gt; &amp;op1, const Image&lt; double &gt; &amp;op2)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00115">image_operate.cpp:115</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00364">multidim_array.h:364</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00065">multidim_array.h:65</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Masks_html_ga5bd552c32d3d6b6abd6ddf18677cf647"><div class="ttname"><a href="group__Masks.html#ga5bd552c32d3d6b6abd6ddf18677cf647">computeStats_within_binary_mask</a></div><div class="ttdeci">void computeStats_within_binary_mask(const MultidimArray&lt; T1 &gt; &amp;mask, const MultidimArray&lt; T &gt; &amp;m, double &amp;min_val, double &amp;max_val, double &amp;avg, double &amp;stddev)</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00804">mask.h:804</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_ac5474a01d203d14c046620266b2f1954"><div class="ttname"><a href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">max</a></div><div class="ttdeci">void max(Image&lt; double &gt; &amp;op1, const Image&lt; double &gt; &amp;op2)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00125">image_operate.cpp:125</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad03d014386c050f947b2903e44f3b383"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a></div><div class="ttdeci">double dummy</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04652">numerical_recipes.cpp:4652</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00073">multidim_array.h:73</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afb34d431df0cacf7558b0888bb6420fb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double bestShift </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>FFTI1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>shiftX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>shiftY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>mask</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxShift</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Translational search. Assumes that FFTI1 is already computed. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01650">1650</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;{</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    I1.checkDimension(2);</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    I2.checkDimension(2);</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Mcorr;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <a class="code" href="group__FourierW.html#ga6e15438efefae23b564ff2106af3ae29">correlation_matrix</a>(FFTI1, I2, Mcorr, aux);</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="filters_8cpp.html#aa3a842c1f195d82f091c896d33e4de46">bestShift</a>(Mcorr, shiftX, shiftY, mask, maxShift);</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__FourierW_html_ga6e15438efefae23b564ff2106af3ae29"><div class="ttname"><a href="group__FourierW.html#ga6e15438efefae23b564ff2106af3ae29">correlation_matrix</a></div><div class="ttdeci">void correlation_matrix(const MultidimArray&lt; double &gt; &amp;m1, const MultidimArray&lt; double &gt; &amp;m2, MultidimArray&lt; double &gt; &amp;R, CorrelationAux &amp;aux, bool center)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00869">xmipp_fftw.cpp:869</a></div></div>
<div class="ttc" id="filters_8cpp_html_aa3a842c1f195d82f091c896d33e4de46"><div class="ttname"><a href="filters_8cpp.html#aa3a842c1f195d82f091c896d33e4de46">bestShift</a></div><div class="ttdeci">template float bestShift(MultidimArray&lt; float &gt; &amp;, float &amp;, float &amp;, const MultidimArray&lt; int &gt; *, int)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa2e0fa984227ef675e0e54a6b7b14883"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double bestShift </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>FFTI1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>FFTI2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Mcorr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>shiftX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>shiftY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>mask</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxShift</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Translational search. Assumes that FFTI1 and FFTI2 are already computed. Mcorr must already have the right size. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01673">1673</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;{</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <a class="code" href="group__FourierW.html#ga6e15438efefae23b564ff2106af3ae29">correlation_matrix</a>(FFTI1, FFTI2, Mcorr, aux);</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="filters_8cpp.html#aa3a842c1f195d82f091c896d33e4de46">bestShift</a>(Mcorr, shiftX, shiftY, mask, maxShift);</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;}</div><div class="ttc" id="group__FourierW_html_ga6e15438efefae23b564ff2106af3ae29"><div class="ttname"><a href="group__FourierW.html#ga6e15438efefae23b564ff2106af3ae29">correlation_matrix</a></div><div class="ttdeci">void correlation_matrix(const MultidimArray&lt; double &gt; &amp;m1, const MultidimArray&lt; double &gt; &amp;m2, MultidimArray&lt; double &gt; &amp;R, CorrelationAux &amp;aux, bool center)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00869">xmipp_fftw.cpp:869</a></div></div>
<div class="ttc" id="filters_8cpp_html_aa3a842c1f195d82f091c896d33e4de46"><div class="ttname"><a href="filters_8cpp.html#aa3a842c1f195d82f091c896d33e4de46">bestShift</a></div><div class="ttdeci">template float bestShift(MultidimArray&lt; float &gt; &amp;, float &amp;, float &amp;, const MultidimArray&lt; int &gt; *, int)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afb3985709c3203698f5794da11150d3d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void computeAlignmentTransforms </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAlignmentTransforms.html">AlignmentTransforms</a> &amp;&#160;</td>
          <td class="paramname"><em>ITransforms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAlignmentAux.html">AlignmentAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01950">1950</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;{</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    aux2.<a class="code" href="classCorrelationAux.html#ad6fc21194291fb961fd936ebe3a64a35">transformer1</a>.<a class="code" href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransform</a>((<a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;)I, ITransforms.<a class="code" href="classAlignmentTransforms.html#a4e3893b8488dc5fe7928a8cac6a53d8b">FFTI</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    <a class="code" href="polar_8cpp.html#a29cae209c3de81e800a2dcf343a059c4">polarFourierTransform&lt;true&gt;</a>(I, ITransforms.<a class="code" href="classAlignmentTransforms.html#a24488091ee4e477b03fdabc30f334fb0">polarFourierI</a>, <span class="keyword">false</span>, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I) / 5, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I) / 2, aux.<a class="code" href="classAlignmentAux.html#a30708ba47967afcde187d7dc0dcd3e34">plans</a>, 1);</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;}</div><div class="ttc" id="classCorrelationAux_html_ad6fc21194291fb961fd936ebe3a64a35"><div class="ttname"><a href="classCorrelationAux.html#ad6fc21194291fb961fd936ebe3a64a35">CorrelationAux::transformer1</a></div><div class="ttdeci">FourierTransformer transformer1</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00555">xmipp_fftw.h:555</a></div></div>
<div class="ttc" id="classAlignmentTransforms_html_a4e3893b8488dc5fe7928a8cac6a53d8b"><div class="ttname"><a href="classAlignmentTransforms.html#a4e3893b8488dc5fe7928a8cac6a53d8b">AlignmentTransforms::FFTI</a></div><div class="ttdeci">MultidimArray&lt; std::complex&lt; double &gt; &gt; FFTI</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00514">filters.h:514</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classAlignmentAux_html_a30708ba47967afcde187d7dc0dcd3e34"><div class="ttname"><a href="classAlignmentAux.html#a30708ba47967afcde187d7dc0dcd3e34">AlignmentAux::plans</a></div><div class="ttdeci">Polar_fftw_plans * plans</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00504">filters.h:504</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="classFourierTransformer_html_abfdc5699d3c579a26bba39ec679b5adc"><div class="ttname"><a href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransformer::FourierTransform</a></div><div class="ttdeci">void FourierTransform(T &amp;v, T1 &amp;V, bool getCopy=true)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00166">xmipp_fftw.h:166</a></div></div>
<div class="ttc" id="classAlignmentTransforms_html_a24488091ee4e477b03fdabc30f334fb0"><div class="ttname"><a href="classAlignmentTransforms.html#a24488091ee4e477b03fdabc30f334fb0">AlignmentTransforms::polarFourierI</a></div><div class="ttdeci">Polar&lt; std::complex&lt; double &gt; &gt; polarFourierI</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00513">filters.h:513</a></div></div>
<div class="ttc" id="polar_8cpp_html_a29cae209c3de81e800a2dcf343a059c4"><div class="ttname"><a href="polar_8cpp.html#a29cae209c3de81e800a2dcf343a059c4">polarFourierTransform&lt; true &gt;</a></div><div class="ttdeci">template void polarFourierTransform&lt; true &gt;(const MultidimArray&lt; double &gt; &amp;in, Polar&lt; std::complex&lt; double &gt; &gt; &amp;out, bool conjugated, int first_ring, int last_ring, Polar_fftw_plans *&amp;plans, int BsplineOrder)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a07967d751d0db20fe6a71ce225f0f874"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void computeEdges </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>vol_edge</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute edges with Sobel </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l03386">3386</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;{</div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> BSpline_coefs;</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;    BSpline_coefs.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(vol);</div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga007f6aec56f2b0abdb6f4903a22cedf0">produceSplineCoefficients</a>(3, BSpline_coefs, vol);</div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;    vol_edge.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(vol);</div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;</div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(vol)</div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;    {</div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;        <span class="keywordtype">double</span> V_dx;</div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;        <span class="keywordtype">double</span> V_dy;</div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;        <span class="keywordtype">double</span> V_dz;</div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;        V_dx = <a class="code" href="group__GeometricalTransformations.html#ga14f44acb983d41b79d09756b8bee4f4a">interpolatedElementBSplineDiffX</a>(BSpline_coefs, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, 3);</div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;        V_dy = <a class="code" href="group__GeometricalTransformations.html#ga466e6163a69aba9fd7c3f10177b3d6ad">interpolatedElementBSplineDiffY</a>(BSpline_coefs, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, 3);</div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;        V_dz = <a class="code" href="group__GeometricalTransformations.html#ga3fea9b979171920f6d72ceb1317220f0">interpolatedElementBSplineDiffZ</a>(BSpline_coefs, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, 3);</div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(vol_edge,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(</div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;                                       (V_dx * V_dx) + (V_dy * V_dy) + (V_dz * V_dz));</div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;</div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;    }</div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;}</div><div class="ttc" id="group__GeometricalTransformations_html_ga007f6aec56f2b0abdb6f4903a22cedf0"><div class="ttname"><a href="group__GeometricalTransformations.html#ga007f6aec56f2b0abdb6f4903a22cedf0">produceSplineCoefficients</a></div><div class="ttdeci">void produceSplineCoefficients(int SplineDegree, MultidimArray&lt; double &gt; &amp;coeffs, const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V1)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00576">transformations.cpp:576</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00279">multidim_array.h:279</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga3fea9b979171920f6d72ceb1317220f0"><div class="ttname"><a href="group__GeometricalTransformations.html#ga3fea9b979171920f6d72ceb1317220f0">interpolatedElementBSplineDiffZ</a></div><div class="ttdeci">double interpolatedElementBSplineDiffZ(MultidimArray&lt; double &gt; &amp;vol, double x, double y, double z, int SplineDegree)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l01013">transformations.cpp:1013</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga14f44acb983d41b79d09756b8bee4f4a"><div class="ttname"><a href="group__GeometricalTransformations.html#ga14f44acb983d41b79d09756b8bee4f4a">interpolatedElementBSplineDiffX</a></div><div class="ttdeci">double interpolatedElementBSplineDiffX(MultidimArray&lt; double &gt; &amp;vol, double x, double y, double z, int SplineDegree)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00702">transformations.cpp:702</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga466e6163a69aba9fd7c3f10177b3d6ad"><div class="ttname"><a href="group__GeometricalTransformations.html#ga466e6163a69aba9fd7c3f10177b3d6ad">interpolatedElementBSplineDiffY</a></div><div class="ttdeci">double interpolatedElementBSplineDiffY(MultidimArray&lt; double &gt; &amp;vol, double x, double y, double z, int SplineDegree)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00857">transformations.cpp:857</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9cfc65fe3ad8382906d8e36980a95e30"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double correlationMasked </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Masked correlation based on standard deviation values. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01356">1356</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;{</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="keywordtype">double</span> mean1, std1, th1;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    I1.<a class="code" href="classMultidimArray.html#a3e6470485fbdde47cb3238520568c28d">computeAvgStdev</a>(mean1,std1);</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    th1 = std1;</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <span class="comment">// Estimate the mean and stddev within the mask</span></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <span class="keywordtype">double</span> N1=0;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="keywordtype">double</span> sumMI1=0, sumMI2=0;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(I1)</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    {</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        <span class="keywordtype">double</span> p1=<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(I1,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        <span class="keywordtype">double</span> p2=<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(I2,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        <span class="keywordflow">if</span>(p1&gt;th1){</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;            sumMI1+=p1;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;            sumMI2+=p2;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;            N1+=1.0;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        }</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    }</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <span class="keywordtype">double</span> sumMI1I2=0.0, sumMI1I1=0.0, sumMI2I2=0.0;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="keywordtype">double</span> iN1, avgM1, avgM2, corrM1M2;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <span class="keywordflow">if</span> (N1&gt;0){</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        iN1=1.0/N1;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        avgM1=sumMI1*iN1;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;        avgM2=sumMI2*iN1;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    }</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="keywordtype">double</span> p1a, p2a;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(I1)</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    {</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        <span class="keywordtype">double</span> p1=<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(I1,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        <span class="keywordtype">double</span> p2=<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(I2,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        <span class="keywordflow">if</span> (p1&gt;th1){</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;            p1a=p1-avgM1;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;            p2a=p2-avgM2;</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;            sumMI1I1 +=p1a*p1a;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;            sumMI2I2 +=p2a*p2a;</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;            sumMI1I2+=p1a*p2a;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;        }</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    }</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    sumMI1I2*=iN1;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    corrM1M2=sumMI1I2/<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(sumMI1I1*sumMI1I2);</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="keywordflow">return</span> corrM1M2;</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a3e6470485fbdde47cb3238520568c28d"><div class="ttname"><a href="classMultidimArray.html#a3e6470485fbdde47cb3238520568c28d">MultidimArray::computeAvgStdev</a></div><div class="ttdeci">void computeAvgStdev(U &amp;avg, U &amp;stddev) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03422">multidim_array.h:3422</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad488098c3e788352a3d394f85a4b049a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double correlationWeighted </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Weighted correlation based on differences between images. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01405">1405</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;{</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Idiff, I2Aligned;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> M;</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    I1.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    I2.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    I2Aligned=I2;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <a class="code" href="filters_8cpp.html#a36c35628e0011847e73d801180599cff">alignImages</a>(I1, I2Aligned, M, <span class="keyword">false</span>);</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    Idiff=I1;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    Idiff-=I2Aligned;</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <span class="keywordtype">double</span> mean, <a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    Idiff.<a class="code" href="classMultidimArray.html#a3e6470485fbdde47cb3238520568c28d">computeAvgStdev</a>(mean,std);</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    Idiff.<a class="code" href="classMultidimArray.html#a3aa0e8d03bc68f58860621085efc2fdd">selfABS</a>();</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="lib__vwk_8cpp.html#a2834b5125eb5ac411feb578af1fac2ea">threshold</a>=std;</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <span class="comment">// Estimate the mean and stddev within the mask</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="keywordtype">double</span> N=0;</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="keywordtype">double</span> sumWI1=0, sumWI2=0;</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(Idiff)</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    {</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(Idiff,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)&gt;threshold)</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        {</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;            <span class="keywordtype">double</span> p1=<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(I1,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;            <span class="keywordtype">double</span> p2Alg=<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(I2Aligned,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;            sumWI1+=p1;</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;            sumWI2+=p2Alg;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;            N+=1.0;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        }</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    }</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="keywordtype">double</span> sumWI1I2=0.0, sumWI1I1=0.0, sumWI2I2=0.0;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <span class="keywordtype">double</span> iN, avgW1, avgW2, corrW1W2;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    <span class="keywordflow">if</span>(N&gt;0){</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;        iN=1.0/N;</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;        avgW1=sumWI1*iN;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        avgW2=sumWI2*iN;</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    }</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="keywordtype">double</span> p1a, p2a;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(I1)</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    {</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(Idiff,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)&gt;threshold)</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        {</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;            <span class="keywordtype">double</span> p1=<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(I1,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;            <span class="keywordtype">double</span> p2Alg=<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(I2Aligned,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;            p1a=p1-avgW1;</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;            p2a=p2Alg-avgW2;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>=<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(Idiff,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;            <span class="keywordtype">double</span> wp1a=w*p1a;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;            <span class="keywordtype">double</span> wp2a=w*p2a;</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;            sumWI1I1 +=wp1a*p1a;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;            sumWI2I2 +=wp2a*p2a;</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;            sumWI1I2 +=wp1a*p2a;</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        }</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    }</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    sumWI1I2*=iN;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    corrW1W2=sumWI1I2/<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(sumWI1I1*sumWI1I2);</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="keywordflow">return</span> corrW1W2;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="filters_8cpp_html_a36c35628e0011847e73d801180599cff"><div class="ttname"><a href="filters_8cpp.html#a36c35628e0011847e73d801180599cff">alignImages</a></div><div class="ttdeci">double alignImages(const MultidimArray&lt; double &gt; &amp;Iref, const AlignmentTransforms &amp;IrefTransforms, MultidimArray&lt; double &gt; &amp;I, Matrix2D&lt; double &gt; &amp;M, bool wrap, AlignmentAux &amp;aux, CorrelationAux &amp;aux2, RotationalCorrelationAux &amp;aux3)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l01963">filters.cpp:1963</a></div></div>
<div class="ttc" id="classMultidimArray_html_a3e6470485fbdde47cb3238520568c28d"><div class="ttname"><a href="classMultidimArray.html#a3e6470485fbdde47cb3238520568c28d">MultidimArray::computeAvgStdev</a></div><div class="ttdeci">void computeAvgStdev(U &amp;avg, U &amp;stddev) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03422">multidim_array.h:3422</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdef"><b>Definition:</b> <a href="gtest_8h_source.html#l00663">gtest.h:663</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a2b83edee7677c7a2b0a4e5ac99baa586"><div class="ttname"><a href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a></div><div class="ttdeci">doublereal * w</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02494">numerical_recipes.cpp:2494</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="lib__vwk_8cpp_html_a2834b5125eb5ac411feb578af1fac2ea"><div class="ttname"><a href="lib__vwk_8cpp.html#a2834b5125eb5ac411feb578af1fac2ea">threshold</a></div><div class="ttdeci">void threshold(double *phi, unsigned long nvox, double limit)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vwk_8cpp_source.html#l00524">lib_vwk.cpp:524</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="classMultidimArray_html_a3aa0e8d03bc68f58860621085efc2fdd"><div class="ttname"><a href="classMultidimArray.html#a3aa0e8d03bc68f58860621085efc2fdd">MultidimArray::selfABS</a></div><div class="ttdeci">void selfABS()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05002">multidim_array.h:5002</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9ad54631c5bb3abc50adae7a6fa02c5c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceMatrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>C</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Covariance matrix of an image </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01517">1517</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;{</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> mI;</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    I.<a class="code" href="classMultidimArray.html#aedb19deb51361be78c4a1a53b41fece3">copy</a>(mI);</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <a class="code" href="group__Matrices.html#gaaa39e0386aee81396e24bda57f304e5f">subtractColumnMeans</a>(mI);</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <a class="code" href="group__Matrices.html#ga937463fbe2c3bd7e87a9f78b6ed80274">matrixOperation_AtA</a>(mI,C);</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    C*=1.0/(<a class="code" href="ctf_8h.html#abf4936ae2557c5a607e2ec4f9fd51313">convertSizeTToDouble</a>(<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I))-1.0);</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;}</div><div class="ttc" id="ctf_8h_html_abf4936ae2557c5a607e2ec4f9fd51313"><div class="ttname"><a href="ctf_8h.html#abf4936ae2557c5a607e2ec4f9fd51313">convertSizeTToDouble</a></div><div class="ttdeci">double convertSizeTToDouble(size_t data)</div><div class="ttdef"><b>Definition:</b> <a href="ctf_8h_source.html#l00059">ctf.h:59</a></div></div>
<div class="ttc" id="group__Matrices_html_gaaa39e0386aee81396e24bda57f304e5f"><div class="ttname"><a href="group__Matrices.html#gaaa39e0386aee81396e24bda57f304e5f">subtractColumnMeans</a></div><div class="ttdeci">void subtractColumnMeans(Matrix2D&lt; double &gt; &amp;A)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l00363">matrix2d.cpp:363</a></div></div>
<div class="ttc" id="group__Matrices_html_ga937463fbe2c3bd7e87a9f78b6ed80274"><div class="ttname"><a href="group__Matrices.html#ga937463fbe2c3bd7e87a9f78b6ed80274">matrixOperation_AtA</a></div><div class="ttdeci">void matrixOperation_AtA(const Matrix2D&lt; double &gt; &amp;A, Matrix2D&lt; double &gt; &amp;B)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l00569">matrix2d.cpp:569</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="classMultidimArray_html_aedb19deb51361be78c4a1a53b41fece3"><div class="ttname"><a href="classMultidimArray.html#aedb19deb51361be78c4a1a53b41fece3">MultidimArray::copy</a></div><div class="ttdeci">void copy(Matrix2D&lt; T &gt; &amp;op1) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05428">multidim_array.h:5428</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afa13591c7caa28b7c8ddb2cf9668dbd1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double fastBestRotation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>IrefCyl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Icyl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classVolumeAlignmentAux.html">VolumeAlignmentAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltaAng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02162">2162</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;{</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    <a class="code" href="group__FourierW.html#ga6e15438efefae23b564ff2106af3ae29">correlation_matrix</a>(IrefCyl, Icyl, aux2.<a class="code" href="classVolumeAlignmentAux.html#afe115e677fd7df3a31b45cce2950d1f5">corr</a>, aux, <span class="keyword">false</span>);</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(aux2.<a class="code" href="classVolumeAlignmentAux.html#afe115e677fd7df3a31b45cce2950d1f5">corr</a>) = <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(aux2.<a class="code" href="classVolumeAlignmentAux.html#afe115e677fd7df3a31b45cce2950d1f5">corr</a>) = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(aux2.<a class="code" href="classVolumeAlignmentAux.html#afe115e677fd7df3a31b45cce2950d1f5">corr</a>) = 0;</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    <span class="keywordtype">double</span> bestCorr = <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(aux2.<a class="code" href="classVolumeAlignmentAux.html#afe115e677fd7df3a31b45cce2950d1f5">corr</a>,0,<a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(aux2.<a class="code" href="classVolumeAlignmentAux.html#afe115e677fd7df3a31b45cce2950d1f5">corr</a>),0);</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    <span class="keywordtype">double</span> bestAngle = 0;</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(aux2.<a class="code" href="classVolumeAlignmentAux.html#afe115e677fd7df3a31b45cce2950d1f5">corr</a>) + 1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= <a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(aux2.<a class="code" href="classVolumeAlignmentAux.html#afe115e677fd7df3a31b45cce2950d1f5">corr</a>); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    {</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;        <span class="keywordtype">double</span> corr = <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(aux2.<a class="code" href="classVolumeAlignmentAux.html#afe115e677fd7df3a31b45cce2950d1f5">corr</a>,0,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,0);</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;        <span class="keywordflow">if</span> (corr &gt; bestCorr)</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;        {</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;            bestCorr = corr;</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;            bestAngle = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;        }</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    }</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    bestAngle *= deltaAng * 180.0 / <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>;</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    <span class="keywordflow">return</span> -bestAngle;</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="group__FourierW_html_ga6e15438efefae23b564ff2106af3ae29"><div class="ttname"><a href="group__FourierW.html#ga6e15438efefae23b564ff2106af3ae29">correlation_matrix</a></div><div class="ttdeci">void correlation_matrix(const MultidimArray&lt; double &gt; &amp;m1, const MultidimArray&lt; double &gt; &amp;m2, MultidimArray&lt; double &gt; &amp;R, CorrelationAux &amp;aux, bool center)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00869">xmipp_fftw.cpp:869</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="classVolumeAlignmentAux_html_afe115e677fd7df3a31b45cce2950d1f5"><div class="ttname"><a href="classVolumeAlignmentAux.html#afe115e677fd7df3a31b45cce2950d1f5">VolumeAlignmentAux::corr</a></div><div class="ttdeci">MultidimArray&lt; double &gt; corr</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00558">filters.h:558</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00073">multidim_array.h:73</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac7adf26fcd293084cd9467376d581867"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fastBestRotation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>IrefCylZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>IrefCylY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>IrefCylX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Icurrent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Ifinal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>axis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classVolumeAlignmentAux.html">VolumeAlignmentAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02225">2225</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;{</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    <span class="keywordtype">double</span> bestAngle;</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="image__operate_8cpp.html#aae5e6d8d8a0b1792b5fc6fde13bc4a8c">axis</a>==<span class="charliteral">&#39;Z&#39;</span>)</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;        bestAngle = <a class="code" href="filters_8cpp.html#a4ff4e1bd1c1d5b8af552e2d5edc86e6e">fastBestRotationAroundZ</a>(IrefCylZ, Icurrent, aux, aux2);</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="image__operate_8cpp.html#aae5e6d8d8a0b1792b5fc6fde13bc4a8c">axis</a>==<span class="charliteral">&#39;Y&#39;</span>)</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;        bestAngle = <a class="code" href="filters_8cpp.html#aa1e3569cf3b9d864ee221668f62176c7">fastBestRotationAroundY</a>(IrefCylY, Icurrent, aux, aux2);</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;        bestAngle = <a class="code" href="filters_8cpp.html#a691119e46a00cb8f1e1f9f0f9cb761f9">fastBestRotationAroundX</a>(IrefCylX, Icurrent, aux, aux2);</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> Raux;</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a>(bestAngle, <a class="code" href="image__operate_8cpp.html#aae5e6d8d8a0b1792b5fc6fde13bc4a8c">axis</a>, Raux);</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    R=Raux*R;</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a>(<a class="code" href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a>, Ifinal, I, R, <a class="code" href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a>, <a class="code" href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a>);</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;}</div><div class="ttc" id="filters_8cpp_html_aa1e3569cf3b9d864ee221668f62176c7"><div class="ttname"><a href="filters_8cpp.html#aa1e3569cf3b9d864ee221668f62176c7">fastBestRotationAroundY</a></div><div class="ttdeci">double fastBestRotationAroundY(const MultidimArray&lt; double &gt; &amp;IrefCyl, const MultidimArray&lt; double &gt; &amp;I, CorrelationAux &amp;aux, VolumeAlignmentAux &amp;aux2)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l02197">filters.cpp:2197</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga3cc15e5dda7c58b9cacb7eee440d6bdc"><div class="ttname"><a href="group__GeometricalTransformations.html#ga3cc15e5dda7c58b9cacb7eee440d6bdc">applyGeometry</a></div><div class="ttdeci">void applyGeometry(int SplineDegree, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V2, const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V1, const Matrix2D&lt; double &gt; &amp;A, bool inv, bool wrap, std::complex&lt; double &gt; outside, MultidimArray&lt; double &gt; *BcoeffsPtr)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00517">transformations.cpp:517</a></div></div>
<div class="ttc" id="filters_8cpp_html_a4ff4e1bd1c1d5b8af552e2d5edc86e6e"><div class="ttname"><a href="filters_8cpp.html#a4ff4e1bd1c1d5b8af552e2d5edc86e6e">fastBestRotationAroundZ</a></div><div class="ttdeci">double fastBestRotationAroundZ(const MultidimArray&lt; double &gt; &amp;IrefCyl, const MultidimArray&lt; double &gt; &amp;I, CorrelationAux &amp;aux, VolumeAlignmentAux &amp;aux2)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l02183">filters.cpp:2183</a></div></div>
<div class="ttc" id="transformations_8h_html_a43c1de45dbd91827a260224c9c40221b"><div class="ttname"><a href="transformations_8h.html#a43c1de45dbd91827a260224c9c40221b">WRAP</a></div><div class="ttdeci">#define WRAP</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00043">transformations.h:43</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gade7a7cd894f08efccc7d6b6410bbf891"><div class="ttname"><a href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a></div><div class="ttdeci">void rotation3DMatrix(double ang, char axis, Matrix2D&lt; double &gt; &amp;result, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00277">transformations.cpp:277</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aae5e6d8d8a0b1792b5fc6fde13bc4a8c"><div class="ttname"><a href="image__operate_8cpp.html#aae5e6d8d8a0b1792b5fc6fde13bc4a8c">axis</a></div><div class="ttdeci">char axis</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00254">image_operate.cpp:254</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gac645eb9a88619ee6f5e14c557ab8ef62"><div class="ttname"><a href="group__GeometricalTransformations.html#gac645eb9a88619ee6f5e14c557ab8ef62">LINEAR</a></div><div class="ttdeci">#define LINEAR</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00208">transformations.h:208</a></div></div>
<div class="ttc" id="filters_8cpp_html_a691119e46a00cb8f1e1f9f0f9cb761f9"><div class="ttname"><a href="filters_8cpp.html#a691119e46a00cb8f1e1f9f0f9cb761f9">fastBestRotationAroundX</a></div><div class="ttdeci">double fastBestRotationAroundX(const MultidimArray&lt; double &gt; &amp;IrefCyl, const MultidimArray&lt; double &gt; &amp;I, CorrelationAux &amp;aux, VolumeAlignmentAux &amp;aux2)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l02211">filters.cpp:2211</a></div></div>
<div class="ttc" id="transformations_8h_html_a3a4a05e15fc1cc8a66159304e4c33eb1"><div class="ttname"><a href="transformations_8h.html#a3a4a05e15fc1cc8a66159304e4c33eb1">IS_NOT_INV</a></div><div class="ttdeci">#define IS_NOT_INV</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00041">transformations.h:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac6860bccb1be87e0a81459936333c05f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fastBestRotation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>IrefCylZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>IrefCylY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>IrefCylX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a> &amp;&#160;</td>
          <td class="paramname"><em>eulerAngles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classVolumeAlignmentAux.html">VolumeAlignmentAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find a ZYZ rotation that transforms I into Iref. The rotation matrix is returned in R. I is modified to be aligned. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02248">2248</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;{</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    R.<a class="code" href="classMatrix2D.html#a1b0afdb4a10ad1857db3db8b64715ba3">initIdentity</a>(4);</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    <a class="code" href="filters_8cpp.html#afa13591c7caa28b7c8ddb2cf9668dbd1">fastBestRotation</a>(IrefCylZ,IrefCylY,IrefCylX,I,I,aux2.<a class="code" href="classVolumeAlignmentAux.html#a4f6fbb8b5b31f4ff4fa1e0f928e1ba7f">I1</a>,eulerAngles[0],R, aux,aux2);</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    <a class="code" href="filters_8cpp.html#afa13591c7caa28b7c8ddb2cf9668dbd1">fastBestRotation</a>(IrefCylZ,IrefCylY,IrefCylX,I,aux2.<a class="code" href="classVolumeAlignmentAux.html#a4f6fbb8b5b31f4ff4fa1e0f928e1ba7f">I1</a>,aux2.<a class="code" href="classVolumeAlignmentAux.html#a4664efc923a93322025c0a260230d844">I12</a>,eulerAngles[1],R,aux,aux2);</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    <a class="code" href="filters_8cpp.html#afa13591c7caa28b7c8ddb2cf9668dbd1">fastBestRotation</a>(IrefCylZ,IrefCylY,IrefCylX,I,aux2.<a class="code" href="classVolumeAlignmentAux.html#a4664efc923a93322025c0a260230d844">I12</a>,aux2.<a class="code" href="classVolumeAlignmentAux.html#a6284cd1ca2bf016917ab9d85511899c7">I123</a>,eulerAngles[2],R,aux,aux2);</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    I=aux2.<a class="code" href="classVolumeAlignmentAux.html#a6284cd1ca2bf016917ab9d85511899c7">I123</a>;</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;}</div><div class="ttc" id="classVolumeAlignmentAux_html_a4664efc923a93322025c0a260230d844"><div class="ttname"><a href="classVolumeAlignmentAux.html#a4664efc923a93322025c0a260230d844">VolumeAlignmentAux::I12</a></div><div class="ttdeci">MultidimArray&lt; double &gt; I12</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00558">filters.h:558</a></div></div>
<div class="ttc" id="classVolumeAlignmentAux_html_a4f6fbb8b5b31f4ff4fa1e0f928e1ba7f"><div class="ttname"><a href="classVolumeAlignmentAux.html#a4f6fbb8b5b31f4ff4fa1e0f928e1ba7f">VolumeAlignmentAux::I1</a></div><div class="ttdeci">MultidimArray&lt; double &gt; I1</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00558">filters.h:558</a></div></div>
<div class="ttc" id="classVolumeAlignmentAux_html_a6284cd1ca2bf016917ab9d85511899c7"><div class="ttname"><a href="classVolumeAlignmentAux.html#a6284cd1ca2bf016917ab9d85511899c7">VolumeAlignmentAux::I123</a></div><div class="ttdeci">MultidimArray&lt; double &gt; I123</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00558">filters.h:558</a></div></div>
<div class="ttc" id="filters_8cpp_html_afa13591c7caa28b7c8ddb2cf9668dbd1"><div class="ttname"><a href="filters_8cpp.html#afa13591c7caa28b7c8ddb2cf9668dbd1">fastBestRotation</a></div><div class="ttdeci">double fastBestRotation(const MultidimArray&lt; double &gt; &amp;IrefCyl, const MultidimArray&lt; double &gt; &amp;Icyl, CorrelationAux &amp;aux, VolumeAlignmentAux &amp;aux2, double deltaAng)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l02162">filters.cpp:2162</a></div></div>
<div class="ttc" id="classMatrix2D_html_a1b0afdb4a10ad1857db3db8b64715ba3"><div class="ttname"><a href="classMatrix2D.html#a1b0afdb4a10ad1857db3db8b64715ba3">Matrix2D::initIdentity</a></div><div class="ttdeci">void initIdentity()</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00835">matrix2d.h:835</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a691119e46a00cb8f1e1f9f0f9cb761f9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double fastBestRotationAroundX </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>IrefCylX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classVolumeAlignmentAux.html">VolumeAlignmentAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fast best rotation around X </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02211">2211</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;{</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;    <span class="keywordtype">double</span> deltaAng = atan(2.0 / <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I));</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> v(3);</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(v) = 1;</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(v) = 0;</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(v) = 0;</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    <a class="code" href="group__Polar.html#ga191bbb2c43b0978de4379b80f81c42ad">volume_convertCartesianToCylindrical</a>(I, aux2.<a class="code" href="classVolumeAlignmentAux.html#ac7094af03327c56670c1aaac537012c1">Icyl</a>, 3, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I) / 2, 1, 0,</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;                                         2 * <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>, deltaAng, v);</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="filters_8cpp.html#afa13591c7caa28b7c8ddb2cf9668dbd1">fastBestRotation</a>(IrefCyl,aux2.<a class="code" href="classVolumeAlignmentAux.html#ac7094af03327c56670c1aaac537012c1">Icyl</a>,aux,aux2,deltaAng);</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;}</div><div class="ttc" id="classVolumeAlignmentAux_html_ac7094af03327c56670c1aaac537012c1"><div class="ttname"><a href="classVolumeAlignmentAux.html#ac7094af03327c56670c1aaac537012c1">VolumeAlignmentAux::Icyl</a></div><div class="ttdeci">MultidimArray&lt; double &gt; Icyl</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00558">filters.h:558</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="filters_8cpp_html_afa13591c7caa28b7c8ddb2cf9668dbd1"><div class="ttname"><a href="filters_8cpp.html#afa13591c7caa28b7c8ddb2cf9668dbd1">fastBestRotation</a></div><div class="ttdeci">double fastBestRotation(const MultidimArray&lt; double &gt; &amp;IrefCyl, const MultidimArray&lt; double &gt; &amp;Icyl, CorrelationAux &amp;aux, VolumeAlignmentAux &amp;aux2, double deltaAng)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l02162">filters.cpp:2162</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="group__Polar_html_ga191bbb2c43b0978de4379b80f81c42ad"><div class="ttname"><a href="group__Polar.html#ga191bbb2c43b0978de4379b80f81c42ad">volume_convertCartesianToCylindrical</a></div><div class="ttdeci">void volume_convertCartesianToCylindrical(const MultidimArray&lt; double &gt; &amp;in, MultidimArray&lt; double &gt; &amp;out, double Rmin, double Rmax, double deltaR, float angMin, double angMax, float deltaAng, Matrix1D&lt; double &gt; &amp;axis)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8cpp_source.html#l00257">polar.cpp:257</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa1e3569cf3b9d864ee221668f62176c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double fastBestRotationAroundY </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>IrefCylY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classVolumeAlignmentAux.html">VolumeAlignmentAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fast best rotation around Y </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02197">2197</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;{</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    <span class="keywordtype">double</span> deltaAng = atan(2.0 / <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I));</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> v(3);</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(v) = 0;</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(v) = 1;</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(v) = 0;</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    <a class="code" href="group__Polar.html#ga191bbb2c43b0978de4379b80f81c42ad">volume_convertCartesianToCylindrical</a>(I, aux2.<a class="code" href="classVolumeAlignmentAux.html#ac7094af03327c56670c1aaac537012c1">Icyl</a>, 3, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I) / 2, 1, 0,</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;                                         2 * <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>, deltaAng, v);</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;    <span class="keywordflow">return</span> -<a class="code" href="filters_8cpp.html#afa13591c7caa28b7c8ddb2cf9668dbd1">fastBestRotation</a>(IrefCyl,aux2.<a class="code" href="classVolumeAlignmentAux.html#ac7094af03327c56670c1aaac537012c1">Icyl</a>,aux,aux2,deltaAng);</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;}</div><div class="ttc" id="classVolumeAlignmentAux_html_ac7094af03327c56670c1aaac537012c1"><div class="ttname"><a href="classVolumeAlignmentAux.html#ac7094af03327c56670c1aaac537012c1">VolumeAlignmentAux::Icyl</a></div><div class="ttdeci">MultidimArray&lt; double &gt; Icyl</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00558">filters.h:558</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="filters_8cpp_html_afa13591c7caa28b7c8ddb2cf9668dbd1"><div class="ttname"><a href="filters_8cpp.html#afa13591c7caa28b7c8ddb2cf9668dbd1">fastBestRotation</a></div><div class="ttdeci">double fastBestRotation(const MultidimArray&lt; double &gt; &amp;IrefCyl, const MultidimArray&lt; double &gt; &amp;Icyl, CorrelationAux &amp;aux, VolumeAlignmentAux &amp;aux2, double deltaAng)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l02162">filters.cpp:2162</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="group__Polar_html_ga191bbb2c43b0978de4379b80f81c42ad"><div class="ttname"><a href="group__Polar.html#ga191bbb2c43b0978de4379b80f81c42ad">volume_convertCartesianToCylindrical</a></div><div class="ttdeci">void volume_convertCartesianToCylindrical(const MultidimArray&lt; double &gt; &amp;in, MultidimArray&lt; double &gt; &amp;out, double Rmin, double Rmax, double deltaR, float angMin, double angMax, float deltaAng, Matrix1D&lt; double &gt; &amp;axis)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8cpp_source.html#l00257">polar.cpp:257</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4ff4e1bd1c1d5b8af552e2d5edc86e6e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double fastBestRotationAroundZ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>IrefCylZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classVolumeAlignmentAux.html">VolumeAlignmentAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fast best rotation around Z </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02183">2183</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;{</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    <span class="keywordtype">double</span> deltaAng = atan(2.0 / <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I));</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> v(3);</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(v) = 0;</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(v) = 0;</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(v) = 1;</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    <a class="code" href="group__Polar.html#ga191bbb2c43b0978de4379b80f81c42ad">volume_convertCartesianToCylindrical</a>(I, aux2.<a class="code" href="classVolumeAlignmentAux.html#ac7094af03327c56670c1aaac537012c1">Icyl</a>, 3, <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I) / 2, 1, 0,</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;                                         2 * <a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>, deltaAng, v);</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="filters_8cpp.html#afa13591c7caa28b7c8ddb2cf9668dbd1">fastBestRotation</a>(IrefCyl,aux2.<a class="code" href="classVolumeAlignmentAux.html#ac7094af03327c56670c1aaac537012c1">Icyl</a>,aux,aux2,deltaAng);</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;}</div><div class="ttc" id="classVolumeAlignmentAux_html_ac7094af03327c56670c1aaac537012c1"><div class="ttname"><a href="classVolumeAlignmentAux.html#ac7094af03327c56670c1aaac537012c1">VolumeAlignmentAux::Icyl</a></div><div class="ttdeci">MultidimArray&lt; double &gt; Icyl</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00558">filters.h:558</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="filters_8cpp_html_afa13591c7caa28b7c8ddb2cf9668dbd1"><div class="ttname"><a href="filters_8cpp.html#afa13591c7caa28b7c8ddb2cf9668dbd1">fastBestRotation</a></div><div class="ttdeci">double fastBestRotation(const MultidimArray&lt; double &gt; &amp;IrefCyl, const MultidimArray&lt; double &gt; &amp;Icyl, CorrelationAux &amp;aux, VolumeAlignmentAux &amp;aux2, double deltaAng)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l02162">filters.cpp:2162</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="group__Polar_html_ga191bbb2c43b0978de4379b80f81c42ad"><div class="ttname"><a href="group__Polar.html#ga191bbb2c43b0978de4379b80f81c42ad">volume_convertCartesianToCylindrical</a></div><div class="ttdeci">void volume_convertCartesianToCylindrical(const MultidimArray&lt; double &gt; &amp;in, MultidimArray&lt; double &gt; &amp;out, double Rmin, double Rmax, double deltaR, float angMin, double angMax, float deltaAng, Matrix1D&lt; double &gt; &amp;axis)</div><div class="ttdef"><b>Definition:</b> <a href="polar_8cpp_source.html#l00257">polar.cpp:257</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1af51bdf860cd3d8084129df77c37408"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double fastCorrentropy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classGaussianInterpolator.html">GaussianInterpolator</a> &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Correntropy with mask. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01206">1206</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;{</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keywordtype">double</span> retvalxy = 0;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="keywordtype">double</span> isigma = 1.0 / sigma;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="keywordtype">int</span> maskSum = 0;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(x)</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    {</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(mask,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>))</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        {</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;            retvalxy += G.<a class="code" href="classGaussianInterpolator.html#af194ea37b3f0ee9d8439a06af8ac572e">getValue</a>(</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                            isigma</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                            * (<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(x,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                               - <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(y,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)));</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;            ++maskSum;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        }</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    }</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">if</span> (0 == maskSum) {</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa22981b63092f2ecbaee8984f0bc9867c">ERR_NUMERICAL</a>, <span class="stringliteral">&quot;maskSum is zero (0), which would lead to division by zero&quot;</span>);</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    }</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordflow">return</span> (retvalxy / maskSum);</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="classGaussianInterpolator_html_af194ea37b3f0ee9d8439a06af8ac572e"><div class="ttname"><a href="classGaussianInterpolator.html#af194ea37b3f0ee9d8439a06af8ac572e">GaussianInterpolator::getValue</a></div><div class="ttdeci">double getValue(double x) const </div><div class="ttdef"><b>Definition:</b> <a href="numerical__tools_8h_source.html#l00124">numerical_tools.h:124</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa22981b63092f2ecbaee8984f0bc9867c"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa22981b63092f2ecbaee8984f0bc9867c">ERR_NUMERICAL</a></div><div class="ttdoc">Error related to numerical calculation. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00184">xmipp_error.h:184</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a71a4fab8b15290c0de30e666fef5b927"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void forceDWTSparsity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>eps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Force sparsity. Only eps*100 % of the DWT coefficients are kept. It is assumed that the input volume is cubic. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l03408">3408</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;{</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;    <span class="keywordtype">int</span> size0=<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(V);</div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;    <span class="keywordtype">int</span> sizeF=(int)<a class="code" href="group__Macros.html#ga03fdb5946fa314b990ef7a16ee4f1ed1">NEXT_POWER_OF_2</a>(size0);</div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga04c547130530ebaa6ce754df5b0ae089">selfScaleToSize</a>(<a class="code" href="group__GeometricalTransformations.html#gab8a49d8335f45ebd2ba7d86d98322bc0">BSPLINE3</a>,V,sizeF,sizeF,sizeF);</div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> vol_wavelets, vol_wavelets_abs;</div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;    <a class="code" href="group__Wavelets.html#ga5cb8eeb7258f5d05a5a9b1fdae7b2491">set_DWT_type</a>(<a class="code" href="group__Wavelets.html#ga4f4614723b76996e11f1dcda8a946f2f">DAUB12</a>);</div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;    <a class="code" href="group__Wavelets.html#ga4c3d81cae44d7519925c0a1634a8fedc">DWT</a>(V,vol_wavelets);</div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;    vol_wavelets_abs=vol_wavelets;</div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;    vol_wavelets_abs.<a class="code" href="classMultidimArray.html#a3aa0e8d03bc68f58860621085efc2fdd">selfABS</a>();</div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;    <span class="keywordtype">double</span> *begin=<a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(vol_wavelets_abs);</div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;    <span class="keywordtype">double</span> *end=<a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(vol_wavelets_abs)+<a class="code" href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(vol_wavelets_abs);</div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;    <a class="code" href="sorting_8cpp.html#acffaa2cf1dee75a78d918a708a5fb87a">std::sort</a>(begin,end);</div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;    <span class="keywordtype">double</span> threshold1=<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(vol_wavelets_abs,</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;                                           (<span class="keywordtype">long</span> <span class="keywordtype">int</span>)((1.0-<a class="code" href="numerical__recipes_8cpp.html#a974b448c3d0a13d483d36ef15de369b5">eps</a>)*<a class="code" href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(vol_wavelets_abs)));</div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;    vol_wavelets.<a class="code" href="classMultidimArray.html#aa8d8794491b26fc4273820ebfdd63916">threshold</a>(<span class="stringliteral">&quot;abs_below&quot;</span>, threshold1, 0.0);</div><div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;    <a class="code" href="group__Wavelets.html#ga6da81c27c1780c116902bb6e720dc52d">IDWT</a>(vol_wavelets,V);</div><div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga04c547130530ebaa6ce754df5b0ae089">selfScaleToSize</a>(<a class="code" href="group__GeometricalTransformations.html#gab8a49d8335f45ebd2ba7d86d98322bc0">BSPLINE3</a>,V,size0, size0, size0);</div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;}</div><div class="ttc" id="group__Wavelets_html_ga5cb8eeb7258f5d05a5a9b1fdae7b2491"><div class="ttname"><a href="group__Wavelets.html#ga5cb8eeb7258f5d05a5a9b1fdae7b2491">set_DWT_type</a></div><div class="ttdeci">void set_DWT_type(int DWT_type)</div><div class="ttdef"><b>Definition:</b> <a href="wavelet_8cpp_source.html#l00154">wavelet.cpp:154</a></div></div>
<div class="ttc" id="classMultidimArray_html_aa8d8794491b26fc4273820ebfdd63916"><div class="ttname"><a href="classMultidimArray.html#aa8d8794491b26fc4273820ebfdd63916">MultidimArray::threshold</a></div><div class="ttdeci">void threshold(const String &amp;type, T a, T b=0, MultidimArray&lt; int &gt; *mask=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04753">multidim_array.h:4753</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gac87b223f03097d45f776b44b6aeea9f7"><div class="ttname"><a href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a></div><div class="ttdeci">#define MULTIDIM_ARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00136">multidim_array.h:136</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga027a630a86c277b71cda769268764fd1"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a></div><div class="ttdeci">#define MULTIDIM_SIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00125">multidim_array.h:125</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a974b448c3d0a13d483d36ef15de369b5"><div class="ttname"><a href="numerical__recipes_8cpp.html#a974b448c3d0a13d483d36ef15de369b5">eps</a></div><div class="ttdeci">cmache_1 eps</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02290">numerical_recipes.cpp:2290</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga04c547130530ebaa6ce754df5b0ae089"><div class="ttname"><a href="group__GeometricalTransformations.html#ga04c547130530ebaa6ce754df5b0ae089">selfScaleToSize</a></div><div class="ttdeci">void selfScaleToSize(int SplineDegree, MultidimArrayGeneric &amp;V1, int Xdim, int Ydim, int Zdim)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00585">transformations.cpp:585</a></div></div>
<div class="ttc" id="group__Wavelets_html_ga4f4614723b76996e11f1dcda8a946f2f"><div class="ttname"><a href="group__Wavelets.html#ga4f4614723b76996e11f1dcda8a946f2f">DAUB12</a></div><div class="ttdeci">#define DAUB12</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00039">wavelet.h:39</a></div></div>
<div class="ttc" id="group__Wavelets_html_ga4c3d81cae44d7519925c0a1634a8fedc"><div class="ttname"><a href="group__Wavelets.html#ga4c3d81cae44d7519925c0a1634a8fedc">DWT</a></div><div class="ttdeci">void DWT(const MultidimArray&lt; T &gt; &amp;v, MultidimArray&lt; double &gt; &amp;result, int isign=1)</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2wavelet_8h_source.html#l00083">wavelet.h:83</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gab8a49d8335f45ebd2ba7d86d98322bc0"><div class="ttname"><a href="group__GeometricalTransformations.html#gab8a49d8335f45ebd2ba7d86d98322bc0">BSPLINE3</a></div><div class="ttdeci">#define BSPLINE3</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00210">transformations.h:210</a></div></div>
<div class="ttc" id="sorting_8cpp_html_acffaa2cf1dee75a78d918a708a5fb87a"><div class="ttname"><a href="sorting_8cpp.html#acffaa2cf1dee75a78d918a708a5fb87a">sort</a></div><div class="ttdeci">void sort(struct DCEL_T *dcel)</div><div class="ttdef"><b>Definition:</b> <a href="sorting_8cpp_source.html#l00018">sorting.cpp:18</a></div></div>
<div class="ttc" id="group__Macros_html_ga03fdb5946fa314b990ef7a16ee4f1ed1"><div class="ttname"><a href="group__Macros.html#ga03fdb5946fa314b990ef7a16ee4f1ed1">NEXT_POWER_OF_2</a></div><div class="ttdeci">#define NEXT_POWER_OF_2(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00374">xmipp_macros.h:374</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="group__Wavelets_html_ga6da81c27c1780c116902bb6e720dc52d"><div class="ttname"><a href="group__Wavelets.html#ga6da81c27c1780c116902bb6e720dc52d">IDWT</a></div><div class="ttdeci">void IDWT(const MultidimArray&lt; double &gt; &amp;v, MultidimArray&lt; double &gt; &amp;result)</div><div class="ttdef"><b>Definition:</b> <a href="wavelet_8cpp_source.html#l00159">wavelet.cpp:159</a></div></div>
<div class="ttc" id="classMultidimArray_html_a3aa0e8d03bc68f58860621085efc2fdd"><div class="ttname"><a href="classMultidimArray.html#a3aa0e8d03bc68f58860621085efc2fdd">MultidimArray::selfABS</a></div><div class="ttdeci">void selfABS()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05002">multidim_array.h:5002</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a984b2433f91d5be4f77ba24a5007d881"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double imedDistance </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>IMED distance. See Wang, L et al. On the Euclidean distance of images. IEEE PAMI 27: 1334-1339 (2005) </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01231">1231</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;{</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="comment">// [x,y]=meshgrid([-3:1:3],[-3:1:3])</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="comment">// format long  // w=1/sqrt(2*pi)*exp(-0.5*(x.*x+y.*y))</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="keywordtype">double</span> *refW;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>[49]={</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;            0.000049233388666,   0.000599785460091,   0.002688051941039,   0.004431848411938,   0.002688051941039,   0.000599785460091,   0.000049233388666,</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;            0.000599785460091,   0.007306882745281,   0.032747176537767,   0.053990966513188,   0.032747176537767,   0.007306882745281,   0.000599785460091,</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;            0.002688051941039,   0.032747176537767,   0.146762663173740,   0.241970724519143,   0.146762663173740,   0.032747176537767,   0.002688051941039,</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;            0.004431848411938,   0.053990966513188,   0.241970724519143,   0.398942280401433,   0.241970724519143,   0.053990966513188,   0.004431848411938,</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;            0.002688051941039,   0.032747176537767,   0.146762663173740,   0.241970724519143,   0.146762663173740,   0.032747176537767,   0.002688051941039,</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;            0.000599785460091,   0.007306882745281,   0.032747176537767,   0.053990966513188,   0.032747176537767,   0.007306882745281,   0.000599785460091,</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;            0.000049233388666,   0.000599785460091,   0.002688051941039,   0.004431848411938,   0.002688051941039,   0.000599785460091,   0.000049233388666};</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> diffImage = I1 - I2;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keywordtype">double</span>  imed = 0;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keywordtype">int</span> imiddle=<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I1)/2;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="keywordtype">int</span> jmiddle=<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I1)/2;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <span class="keywordtype">int</span> R2max=imiddle*imiddle;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="keywordtype">int</span> ysize=(int)<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I1);</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="keywordtype">int</span> xsize=(int)<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I1);</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=3; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;ysize-3; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    {</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <span class="keywordtype">int</span> i2=(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-imiddle)*(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-imiddle);</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=3; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;xsize-3; ++<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        {</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;            <span class="keywordtype">int</span> j2=(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>-jmiddle)*(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>-jmiddle);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;            <span class="keywordflow">if</span> (i2+j2&gt;R2max) <span class="comment">// Measure only within the maximum circle</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            <span class="keywordtype">double</span> diffi=<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(diffImage,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#ad2289c67cc7ca1c54d70d173b37d8820">index</a>=0;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=-3; ii&lt;=3; ++ii)</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            {</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                refW = &amp;w[<a class="code" href="numerical__recipes_8cpp.html#ad2289c67cc7ca1c54d70d173b37d8820">index</a>];</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                index = index + 7;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                <span class="keywordtype">double</span> *diffj=&amp;<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(diffImage,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+ii,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>-3);</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                <span class="keywordtype">double</span>  imedAux=(*refW++)*(*diffj++);</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                imedAux+=(*refW++)*(*diffj++);</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                imedAux+=(*refW++)*(*diffj++);</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                imedAux+=(*refW++)*(*diffj++);</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                imedAux+=(*refW++)*(*diffj++);</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                imedAux+=(*refW++)*(*diffj++);</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                imedAux+=(*refW++)*(*diffj++);</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                imed+=imedAux*diffi;</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;            }</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        }</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    }</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(imed);</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9ed4376d9ad511e963caf118a6640b28"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a></div><div class="ttdeci">#define DIRECT_A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00351">multidim_array.h:351</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a2b83edee7677c7a2b0a4e5ac99baa586"><div class="ttname"><a href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a></div><div class="ttdeci">doublereal * w</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02494">numerical_recipes.cpp:2494</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad2289c67cc7ca1c54d70d173b37d8820"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad2289c67cc7ca1c54d70d173b37d8820">index</a></div><div class="ttdeci">viol index</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05214">numerical_recipes.cpp:5214</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3c97cc8b6a974935f2da39b63681a786"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double imedNormalizedDistance </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>IMED normalized distance. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01283">1283</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;{</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="comment">// [x,y]=meshgrid([-3:1:3],[-3:1:3])</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="comment">// format long</span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="comment">// w=1/sqrt(2*pi)*exp(-0.5*(x.*x+y.*y))</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>[7][7]={</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;            {0.000049233388666,   0.000599785460091,   0.002688051941039,   0.004431848411938,   0.002688051941039,   0.000599785460091,   0.000049233388666},</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;            {0.000599785460091,   0.007306882745281,   0.032747176537767,   0.053990966513188,   0.032747176537767,   0.007306882745281,   0.000599785460091},</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;            {0.002688051941039,   0.032747176537767,   0.146762663173740,   0.241970724519143,   0.146762663173740,   0.032747176537767,   0.002688051941039},</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;            {0.004431848411938,   0.053990966513188,   0.241970724519143,   0.398942280401433,   0.241970724519143,   0.053990966513188,   0.004431848411938},</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;            {0.002688051941039,   0.032747176537767,   0.146762663173740,   0.241970724519143,   0.146762663173740,   0.032747176537767,   0.002688051941039},</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;            {0.000599785460091,   0.007306882745281,   0.032747176537767,   0.053990966513188,   0.032747176537767,   0.007306882745281,   0.000599785460091},</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;            {0.000049233388666,   0.000599785460091,   0.002688051941039,   0.004431848411938,   0.002688051941039,   0.000599785460091,   0.000049233388666}</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    };</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="keywordtype">int</span> imiddle=<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I1)/2;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="keywordtype">int</span> jmiddle=<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I1)/2;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="keywordtype">int</span> R2max=imiddle*imiddle;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="comment">// Measure the average of both images</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keywordtype">double</span> avg1=0, avg2=0;</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="keywordtype">double</span> N=0;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <span class="keywordtype">int</span> ydim=<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(I1);</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <span class="keywordtype">int</span> xdim=<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I1);</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=3; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;ydim-3; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    {</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        <span class="keywordtype">int</span> i2=(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-imiddle)*(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-imiddle);</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=3; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;xdim-3; ++<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        {</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;            <span class="keywordtype">int</span> j2=(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>-jmiddle)*(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>-jmiddle);</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;            <span class="keywordflow">if</span> (i2+j2&gt;R2max) <span class="comment">// Measure only within the maximum circle</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;            avg1+=<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(I1,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            avg2+=<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(I2,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;            ++N;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        }</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    }</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    avg1/=N;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    avg2/=N;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="keywordtype">double</span> diffAvg=avg1-avg2;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordtype">double</span> imed = 0, imed1=0, imed2=0;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=3; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;ydim-3; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    {</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        <span class="keywordtype">int</span> i2=(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-imiddle)*(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-imiddle);</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=3; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;xdim-3; ++<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        {</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;            <span class="keywordtype">int</span> j2=(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>-jmiddle)*(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>-jmiddle);</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;            <span class="keywordflow">if</span> (i2+j2&gt;R2max) <span class="comment">// Measure only within the maximum circle</span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;            <span class="keywordtype">double</span> subtractedI1ij=<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(I1,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)-avg1;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;            <span class="keywordtype">double</span> subtractedI2ij=<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(I2,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)-avg2;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            <span class="keywordtype">double</span> diffi=<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(I1,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)-<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(I2,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)-diffAvg;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=-3; ii&lt;=3; ++ii)</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;            {</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                <span class="keywordtype">int</span> i_ii=<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+ii;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj=-3; jj&lt;=3; ++jj)</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                {</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                    <span class="keywordtype">int</span> j_jj=<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>+jj;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                    <span class="comment">//double diffj=DIRECT_A2D_ELEM(I1,i_ii,j_jj)-DIRECT_A2D_ELEM(I2,i_ii,j_jj)-diffAvg;</span></div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                    <span class="keywordtype">double</span> diffj=<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(I1,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)-<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(I2,i_ii,j_jj)-diffAvg;</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                    <span class="keywordtype">double</span> wiijj=w[ii+3][jj+3];</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                    imed+=wiijj*diffi*diffj;</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                    imed1+=wiijj*subtractedI1ij*(<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(I1,i_ii,j_jj)-avg1);</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                    imed2+=wiijj*subtractedI2ij*(<a class="code" href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a>(I2,i_ii,j_jj)-avg2);</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                }</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;            }</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        }</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    }</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    <span class="keywordflow">return</span> imed/<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>((imed1+imed2)/2);</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga9ed4376d9ad511e963caf118a6640b28"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9ed4376d9ad511e963caf118a6640b28">DIRECT_A2D_ELEM</a></div><div class="ttdeci">#define DIRECT_A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00351">multidim_array.h:351</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a2b83edee7677c7a2b0a4e5ac99baa586"><div class="ttname"><a href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a></div><div class="ttdeci">doublereal * w</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02494">numerical_recipes.cpp:2494</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acfad7869677e95f1063f85c3d755a4d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void matlab_filter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l04096">4096</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;{</div><div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(A,0)!=1.0)</div><div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;        {</div><div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;            A/=<a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(A,0);</div><div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;            B/=<a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(B,0);</div><div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;        }</div><div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;</div><div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;        <span class="keywordtype">size_t</span> input_size = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(X);</div><div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;        <span class="keywordtype">size_t</span> filter_order = <a class="code" href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">std::max</a>(<a class="code" href="group__Vectors.html#gad6524c4e36da91aae3fb6f8564112364">VEC_XSIZE</a>(A),<a class="code" href="group__Vectors.html#gad6524c4e36da91aae3fb6f8564112364">VEC_XSIZE</a>(B));</div><div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#gad6524c4e36da91aae3fb6f8564112364">VEC_XSIZE</a>(B)!=filter_order)</div><div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;            B.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(filter_order);</div><div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#gad6524c4e36da91aae3fb6f8564112364">VEC_XSIZE</a>(A)!=filter_order)</div><div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;            A.<a class="code" href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">resize</a>(filter_order);</div><div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;        Y.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(input_size);</div><div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;        Z.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(filter_order);</div><div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;</div><div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; input_size; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;        {</div><div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;            <span class="keywordtype">size_t</span> <a class="code" href="structblobtype.html#a4036b7fa8f0373d57c8f500c140ada64">order</a> = filter_order - 1;</div><div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;            <span class="keywordflow">while</span> (order)</div><div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;            {</div><div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;= order)</div><div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;                {</div><div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#gaa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a>(Z,order - 1) = <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(B,order) * <a class="code" href="group__MultidimensionalArrays.html#gaa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a>(X,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - order) -</div><div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;                                                   <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(A,order) * <a class="code" href="group__MultidimensionalArrays.html#gaa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a>(Y,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - order) + <a class="code" href="group__MultidimensionalArrays.html#gaa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a>(Z,order);</div><div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;                }</div><div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;                --<a class="code" href="structblobtype.html#a4036b7fa8f0373d57c8f500c140ada64">order</a>;</div><div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;            }</div><div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gaa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a>(Y,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(B,0) * <a class="code" href="group__MultidimensionalArrays.html#gaa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a>(X,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) + <a class="code" href="group__MultidimensionalArrays.html#gaa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a>(Z,0);</div><div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;        }</div><div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;}</div><div class="ttc" id="group__Vectors_html_ga58173d9430e8e68017e3698f30382d5d"><div class="ttname"><a href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a></div><div class="ttdeci">#define VEC_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00248">matrix1d.h:248</a></div></div>
<div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="group__Vectors_html_gad6524c4e36da91aae3fb6f8564112364"><div class="ttname"><a href="group__Vectors.html#gad6524c4e36da91aae3fb6f8564112364">VEC_XSIZE</a></div><div class="ttdeci">#define VEC_XSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00080">matrix1d.h:80</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMatrix1D_html_a79a482948ae334cbefaef7c7839cd934"><div class="ttname"><a href="classMatrix1D.html#a79a482948ae334cbefaef7c7839cd934">Matrix1D::resize</a></div><div class="ttdeci">void resize(size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00451">matrix1d.h:451</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_ac5474a01d203d14c046620266b2f1954"><div class="ttname"><a href="image__operate_8cpp.html#ac5474a01d203d14c046620266b2f1954">max</a></div><div class="ttdeci">void max(Image&lt; double &gt; &amp;op1, const Image&lt; double &gt; &amp;op2)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00125">image_operate.cpp:125</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaa6b2513810dd91e11450be99106a2463"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a></div><div class="ttdeci">#define DIRECT_A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00536">multidim_array.h:536</a></div></div>
<div class="ttc" id="structblobtype_html_a4036b7fa8f0373d57c8f500c140ada64"><div class="ttname"><a href="structblobtype.html#a4036b7fa8f0373d57c8f500c140ada64">blobtype::order</a></div><div class="ttdeci">int order</div><div class="ttdoc">Derivation order and Bessel function order. </div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00119">blobs.h:119</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aad85078fda0532473e1cc86b983a12ae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void regionGrowing3D </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>stop_colour</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>filling_colour</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>less</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Region growing for volumes</p>
<p>Given a position inside a volume this function grows a region with (filling_colour) until it finds a border of value (stop_colour). If the point is outside the volume then nothing is done.</p>
<p>If less is true the region is grown in sucha a way that all voxels in its border are greater than the region voxels. If less is false the region is grown so that all voxels on its border are smaller than the region voxels. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l00404">404</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;{</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    V_in.checkDimension(3);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    std::list&lt;Coordinate3D&gt; iNeighbours; <span class="comment">/* A list for neighbour voxels */</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordtype">int</span> iCurrentk, iCurrenti, iCurrentj; <span class="comment">/* Coordinates of the current voxel considered */</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">/* First task is copying the input volume into the output one */</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    V_out = V_in;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="comment">/**** Then the region growing is done in output volume ****/</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">/* Insert at the beginning of the list the seed coordinates */</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="structCoordinate3D.html">Coordinate3D</a> coord;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    coord.<a class="code" href="structCoordinate3D.html#ad5baa5670cdcedef91c78d7fa535bd5c">ii</a> = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    coord.<a class="code" href="structCoordinate3D.html#a1a7adb52246f0cca34f1f11ae9e51cc2">jj</a> = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    coord.<a class="code" href="structCoordinate3D.html#ab75dd4f72405d0c8fe613fcc6197b6d8">kk</a> = <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    iNeighbours.push_front(coord);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">/* Fill the seed coordinates */</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(V_out, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = filling_colour;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">while</span> (!iNeighbours.empty())</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="comment">/* Take the current pixel to explore */</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        coord = iNeighbours.front();</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        iNeighbours.pop_front();</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        iCurrenti = coord.<a class="code" href="structCoordinate3D.html#ad5baa5670cdcedef91c78d7fa535bd5c">ii</a>;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        iCurrentj = coord.<a class="code" href="structCoordinate3D.html#a1a7adb52246f0cca34f1f11ae9e51cc2">jj</a>;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        iCurrentk = coord.<a class="code" href="structCoordinate3D.html#ab75dd4f72405d0c8fe613fcc6197b6d8">kk</a>;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="comment">/* a macro for doing exploration of a voxel. If the voxel has a value</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">         lower than stop_colour, its filled with filling colour and added to the</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">         list for exploring its neighbours */</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="preprocessor">#define CHECK_POINT_3D(k,i,j) \</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="preprocessor"> {\</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="preprocessor">     int I=i; \</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="preprocessor">        int J=j; \</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="preprocessor">        int K=k; \</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="preprocessor">  if (INSIDEXYZ(V_out,J,I,K))  { \</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="preprocessor">   double voxel=A3D_ELEM(V_out,K,I,J); \</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="preprocessor">   if (voxel!=filling_colour) \</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="preprocessor">    if ((less &amp;&amp; voxel &lt; stop_colour)|| \</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="preprocessor">     (!less &amp;&amp;voxel &gt; stop_colour)) { \</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="preprocessor">     coord.ii=I; \</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="preprocessor">     coord.jj=J; \</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="preprocessor">     coord.kk=K; \</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="preprocessor">     A3D_ELEM (V_out,coord.kk,coord.ii,coord.jj)=filling_colour; \</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="preprocessor">     iNeighbours.push_front(coord); \</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="preprocessor">    } \</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="preprocessor">  }\</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="preprocessor"> }</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="comment">/* Make the exploration of the pixel neighbours */</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk, iCurrenti, iCurrentj - 1);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk, iCurrenti, iCurrentj + 1);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk, iCurrenti - 1, iCurrentj);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk, iCurrenti - 1, iCurrentj - 1);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk, iCurrenti - 1, iCurrentj + 1);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk, iCurrenti + 1, iCurrentj);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk, iCurrenti + 1, iCurrentj - 1);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk, iCurrenti + 1, iCurrentj + 1);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk - 1, iCurrenti, iCurrentj);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk - 1, iCurrenti, iCurrentj - 1);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk - 1, iCurrenti, iCurrentj + 1);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk - 1, iCurrenti - 1, iCurrentj);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk - 1, iCurrenti - 1, iCurrentj - 1);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk - 1, iCurrenti - 1, iCurrentj + 1);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk - 1, iCurrenti + 1, iCurrentj);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk - 1, iCurrenti + 1, iCurrentj - 1);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk - 1, iCurrenti + 1, iCurrentj + 1);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk + 1, iCurrenti, iCurrentj);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk + 1, iCurrenti, iCurrentj - 1);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk + 1, iCurrenti, iCurrentj + 1);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk + 1, iCurrenti - 1, iCurrentj + 1);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk + 1, iCurrenti - 1, iCurrentj - 1);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk + 1, iCurrenti - 1, iCurrentj + 1);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk + 1, iCurrenti + 1, iCurrentj + 1);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk + 1, iCurrenti + 1, iCurrentj - 1);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk + 1, iCurrenti + 1, iCurrentj + 1);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    }</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="structCoordinate3D_html"><div class="ttname"><a href="structCoordinate3D.html">Coordinate3D</a></div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00396">filters.cpp:396</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="filters_8cpp_html_a597513406ab82aa15c590f0350102a26"><div class="ttname"><a href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a></div><div class="ttdeci">#define CHECK_POINT_3D(k, i, j)</div></div>
<div class="ttc" id="structCoordinate3D_html_a1a7adb52246f0cca34f1f11ae9e51cc2"><div class="ttname"><a href="structCoordinate3D.html#a1a7adb52246f0cca34f1f11ae9e51cc2">Coordinate3D::jj</a></div><div class="ttdeci">int jj</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00399">filters.cpp:399</a></div></div>
<div class="ttc" id="structCoordinate3D_html_ab75dd4f72405d0c8fe613fcc6197b6d8"><div class="ttname"><a href="structCoordinate3D.html#ab75dd4f72405d0c8fe613fcc6197b6d8">Coordinate3D::kk</a></div><div class="ttdeci">int kk</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00400">filters.cpp:400</a></div></div>
<div class="ttc" id="structCoordinate3D_html_ad5baa5670cdcedef91c78d7fa535bd5c"><div class="ttname"><a href="structCoordinate3D.html#ad5baa5670cdcedef91c78d7fa535bd5c">Coordinate3D::ii</a></div><div class="ttdeci">int ii</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00398">filters.cpp:398</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6029223e2ee1759507d6fe306db4082a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void regionGrowing3DEqualValue </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>V_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>filling_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Region growing with equal values for volumes</p>
<p>Given a position inside a volume this function grows a region with (filling_value) until it finds a border. If the point is outside the volume then nothing is done.</p>
<p>The growing only considers those voxels with value equal to the selected voxel </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l00489">489</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;{</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    V_in.checkDimension(3);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    std::list&lt;Coordinate3D&gt; iNeighbours; <span class="comment">/* A list for neighbour voxels */</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordtype">int</span> iCurrentk, iCurrenti, iCurrentj; <span class="comment">/* Coordinates of the current voxel considered */</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="comment">/* First task is copying the input volume into the output one */</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    V_out.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(V_in);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    V_out.<a class="code" href="classMultidimArray.html#a239f45b043ed7715dec4d44ceef74dce">initConstant</a>(1);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">/**** Then the region growing is done in output volume ****/</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">/* Insert at the beginning of the list the seed coordinates */</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <a class="code" href="structCoordinate3D.html">Coordinate3D</a> coord;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    coord.<a class="code" href="structCoordinate3D.html#ad5baa5670cdcedef91c78d7fa535bd5c">ii</a> = <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(V_in);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    coord.<a class="code" href="structCoordinate3D.html#a1a7adb52246f0cca34f1f11ae9e51cc2">jj</a> = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(V_in);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    coord.<a class="code" href="structCoordinate3D.html#ab75dd4f72405d0c8fe613fcc6197b6d8">kk</a> = <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(V_in);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    iNeighbours.push_front(coord);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">/* Fill the seed coordinates */</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordtype">double</span> bgColor = <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(V_in, <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(V_in), <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(V_in), <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(V_in));</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(V_out, <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(V_out), <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(V_out), <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(V_out)) = 0;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">while</span> (!iNeighbours.empty())</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    {</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="comment">/* Take the current pixel to explore */</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        coord = iNeighbours.front();</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        iNeighbours.pop_front();</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        iCurrenti = coord.<a class="code" href="structCoordinate3D.html#ad5baa5670cdcedef91c78d7fa535bd5c">ii</a>;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        iCurrentj = coord.<a class="code" href="structCoordinate3D.html#a1a7adb52246f0cca34f1f11ae9e51cc2">jj</a>;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        iCurrentk = coord.<a class="code" href="structCoordinate3D.html#ab75dd4f72405d0c8fe613fcc6197b6d8">kk</a>;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="comment">/* a macro for doing exploration of a voxel. If the voxel has a value</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">         lower than stop_colour, its filled with filling colour and added to the</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">         list for exploring its neighbours */</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="preprocessor">#undef CHECK_POINT_3D</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="preprocessor">#define CHECK_POINT_3D(k,i,j) \</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="preprocessor"> {\</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="preprocessor">        int I=i; \</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="preprocessor">        int J=j; \</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="preprocessor">        int K=k; \</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="preprocessor">  if (INSIDEXYZ(V_out,J,I,K))  { \</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="preprocessor">   if (A3D_ELEM(V_in,K,I,J)==bgColor &amp;&amp; A3D_ELEM(V_out,K,I,J)==1) { \</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="preprocessor">     coord.ii=I; \</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="preprocessor">     coord.jj=J; \</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="preprocessor">     coord.kk=K; \</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="preprocessor">     A3D_ELEM (V_out,coord.kk,coord.ii,coord.jj)=filling_value; \</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="preprocessor">     iNeighbours.push_front(coord); \</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="preprocessor">    } \</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="preprocessor">  }\</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="preprocessor"> }\</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="comment">/* Make the exploration of the pixel neighbours */</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk, iCurrenti, iCurrentj - 1);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk, iCurrenti, iCurrentj + 1);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk, iCurrenti - 1, iCurrentj);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk, iCurrenti - 1, iCurrentj - 1);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk, iCurrenti - 1, iCurrentj + 1);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk, iCurrenti + 1, iCurrentj);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk, iCurrenti + 1, iCurrentj - 1);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk, iCurrenti + 1, iCurrentj + 1);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk - 1, iCurrenti, iCurrentj);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk - 1, iCurrenti, iCurrentj - 1);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk - 1, iCurrenti, iCurrentj + 1);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk - 1, iCurrenti - 1, iCurrentj);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk - 1, iCurrenti - 1, iCurrentj - 1);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk - 1, iCurrenti - 1, iCurrentj + 1);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk - 1, iCurrenti + 1, iCurrentj);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk - 1, iCurrenti + 1, iCurrentj - 1);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk - 1, iCurrenti + 1, iCurrentj + 1);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk + 1, iCurrenti, iCurrentj);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk + 1, iCurrenti, iCurrentj - 1);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk + 1, iCurrenti, iCurrentj + 1);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk + 1, iCurrenti - 1, iCurrentj + 1);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk + 1, iCurrenti - 1, iCurrentj - 1);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk + 1, iCurrenti - 1, iCurrentj + 1);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk + 1, iCurrenti + 1, iCurrentj + 1);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk + 1, iCurrenti + 1, iCurrentj - 1);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <a class="code" href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a>(iCurrentk + 1, iCurrenti + 1, iCurrentj + 1);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    }</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="classMultidimArray_html_ac0efebfb32ab4e37cf33efca3349aa9b"><div class="ttname"><a href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">MultidimArray::resizeNoCopy</a></div><div class="ttdeci">void resizeNoCopy(const MultidimArray&lt; T1 &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01702">multidim_array.h:1702</a></div></div>
<div class="ttc" id="classMultidimArray_html_a239f45b043ed7715dec4d44ceef74dce"><div class="ttname"><a href="classMultidimArray.html#a239f45b043ed7715dec4d44ceef74dce">MultidimArray::initConstant</a></div><div class="ttdeci">void initConstant(T val)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04309">multidim_array.h:4309</a></div></div>
<div class="ttc" id="structCoordinate3D_html"><div class="ttname"><a href="structCoordinate3D.html">Coordinate3D</a></div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00396">filters.cpp:396</a></div></div>
<div class="ttc" id="filters_8cpp_html_a597513406ab82aa15c590f0350102a26"><div class="ttname"><a href="filters_8cpp.html#a597513406ab82aa15c590f0350102a26">CHECK_POINT_3D</a></div><div class="ttdeci">#define CHECK_POINT_3D(k, i, j)</div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="structCoordinate3D_html_a1a7adb52246f0cca34f1f11ae9e51cc2"><div class="ttname"><a href="structCoordinate3D.html#a1a7adb52246f0cca34f1f11ae9e51cc2">Coordinate3D::jj</a></div><div class="ttdeci">int jj</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00399">filters.cpp:399</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="structCoordinate3D_html_ab75dd4f72405d0c8fe613fcc6197b6d8"><div class="ttname"><a href="structCoordinate3D.html#ab75dd4f72405d0c8fe613fcc6197b6d8">Coordinate3D::kk</a></div><div class="ttdeci">int kk</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00400">filters.cpp:400</a></div></div>
<div class="ttc" id="structCoordinate3D_html_ad5baa5670cdcedef91c78d7fa535bd5c"><div class="ttname"><a href="structCoordinate3D.html#ad5baa5670cdcedef91c78d7fa535bd5c">Coordinate3D::ii</a></div><div class="ttdeci">int ii</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00398">filters.cpp:398</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae0aa8a7a56c678bf69497aa682d14599"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Shah_energy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>surface_strength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>edge_strength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>K</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>W</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02416">2416</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;{</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    img.checkDimension(2);</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    <span class="keywordtype">int</span> Ydim1 = <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(img) - 1;</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    <span class="keywordtype">int</span> Xdim1 = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(img) - 1;</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    <span class="keywordtype">double</span> Kinv = 1.0 / <a class="code" href="libraries_2data_2integration_8cpp.html#a97d832ae23af4f215e801e37e4f94254">K</a>;</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    <span class="comment">/* Calculate surface energy */</span></div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    <span class="keywordtype">double</span> E1 = 0.0, E2 = 0.0, E3 = 0.0, E4 = 0.0;</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    <span class="keywordtype">double</span> w0 = <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(W,0);</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    <span class="keywordtype">double</span> w1 = <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(W,1);</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    <span class="keywordtype">double</span> w2 = <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(W,2);</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;    <span class="keywordtype">double</span> w3 = <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(W,3);</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; Ydim1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    {</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;        <span class="keywordtype">int</span> ip1 = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1;</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;        <span class="keywordtype">int</span> im1 = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1;</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 1; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; Xdim1; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;        {</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;            <span class="keywordtype">int</span> jp1 = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + 1;</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;            <span class="keywordtype">int</span> jm1 = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - 1;</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;            <span class="comment">/* Calculate data matching terms */</span></div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;            <span class="keywordtype">double</span> D = <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(img, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;            <span class="keywordtype">double</span> F = <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(surface_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;            <span class="keywordtype">double</span> S = <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(edge_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;            <span class="keywordtype">double</span> diff = D - F;</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;            E1 += w0 * diff * diff;</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;            E3 += w2 * <a class="code" href="libraries_2data_2integration_8cpp.html#a97d832ae23af4f215e801e37e4f94254">K</a> * S * S;</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;            <span class="comment">/* Calculate first derivative terms */</span></div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;            <span class="keywordtype">double</span> Fx = 0.5</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;                        * (<a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(surface_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, jp1)</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;                           - <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(surface_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, jm1));</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;            <span class="keywordtype">double</span> Fy = 0.5</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;                        * (<a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(surface_strength, ip1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;                           - <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(surface_strength, im1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;            <span class="keywordtype">double</span> Sx =</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;                0.5</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;                * (<a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(edge_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, jp1)</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;                   - <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(edge_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, jm1));</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;            <span class="keywordtype">double</span> Sy =</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;                0.5</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;                * (<a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(edge_strength, ip1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;                   - <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(edge_strength, im1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;            <span class="keywordtype">double</span> S_1 = 1 - S;</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;            E2 += w1 * S_1 * S_1 * (Fx * Fx + Fy * Fy);</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;            E4 += w3 * Kinv * (Sx * Sx + Sy * Sy);</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;        }</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    }</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    <span class="keywordflow">return</span> E1 + E2 + E3 + E4; <span class="comment">// Total energy</span></div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;}</div><div class="ttc" id="group__Vectors_html_ga58173d9430e8e68017e3698f30382d5d"><div class="ttname"><a href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a></div><div class="ttdeci">#define VEC_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00248">matrix1d.h:248</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gafa02b309a507bf04daf9f31fa828ce4f"><div class="ttname"><a href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a></div><div class="ttdeci">#define dAij(M, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00355">multidim_array.h:355</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="libraries_2data_2integration_8cpp_html_a97d832ae23af4f215e801e37e4f94254"><div class="ttname"><a href="libraries_2data_2integration_8cpp.html#a97d832ae23af4f215e801e37e4f94254">K</a></div><div class="ttdeci">#define K</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2integration_8cpp_source.html#l00118">integration.cpp:118</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a335c59eb3a310bca39e24fe3ef07c763"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double svdCorrelation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>mask</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>SVD correlation. </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l01473">1473</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;{</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <span class="comment">// Copy input images into matrix2Ds</span></div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> mI1, mI2;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    I1.<a class="code" href="classMultidimArray.html#aedb19deb51361be78c4a1a53b41fece3">copy</a>(mI1);</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    I2.<a class="code" href="classMultidimArray.html#aedb19deb51361be78c4a1a53b41fece3">copy</a>(mI2);</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="comment">// SVD Decomposition of I1</span></div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> U1, V1;</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> W1;</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <a class="code" href="group__Matrices.html#ga46eb206e2830820e657b26bf82969b85">svdcmp</a>(mI1,U1,W1,V1);</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="comment">// Express I2 in the basis of I1</span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> aux, W2;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <a class="code" href="group__Matrices.html#ga02463bd10e74507e895a1560f03ebcf9">matrixOperation_AB</a>(mI2,V1,aux);</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <a class="code" href="group__Matrices.html#gab0b66c453466f2a6eba8722d887a42bf">matrixOperation_AtB</a>(U1,aux,W2);</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <span class="comment">// Make W2 to be diagonal</span></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <a class="code" href="group__Matrices.html#ga80aee91a3508fa5d1df6fc0ee3693b06">FOR_ALL_ELEMENTS_IN_MATRIX2D</a>(W2)</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>!=<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        <a class="code" href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a>(W2,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)=0.0;</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="comment">// Recover I2p</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <a class="code" href="group__Matrices.html#ga1614eafcd0598c1869e90004deef91f2">matrixOperation_ABt</a>(W2,V1,aux);</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <a class="code" href="group__Matrices.html#ga02463bd10e74507e895a1560f03ebcf9">matrixOperation_AB</a>(U1,aux,mI2);</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="comment">// Measure correlation</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray</a>&lt;<span class="keywordtype">double</span>&gt; I2p;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    I2p=mI2;</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;<span class="comment">//  Image&lt;double&gt; save;</span></div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="comment">//  save()=I1;</span></div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="comment">//  save.write(&quot;PPPI1.xmp&quot;);</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="comment">//  save()=I2;</span></div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="comment">//  save.write(&quot;PPPI2.xmp&quot;);</span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="comment">//  save()=I2p;</span></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="comment">//  save.write(&quot;PPPI2p.xmp&quot;);</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="comment">//  std::cout &lt;&lt; &quot;Correlation= &quot; &lt;&lt; correlationIndex(I1,I2p,mask) &lt;&lt; std::endl;</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="comment">//  std::cout &lt;&lt; &quot;Press any key\n&quot;;</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="comment">//  char c; std::cin &gt;&gt; c;</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <span class="comment">// double ratio=I2p.computeStddev()/I2.computeStddev();</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a5ea9a6a7bd724d30070df9316ccc8199">return</a> <a class="code" href="group__MultidimensionalArrays.html#ga63cca7e01116967ff451df8b1f8b5a4e">correlationIndex</a>(I1,I2p,mask); <span class="comment">//*ratio;</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;}</div><div class="ttc" id="group__Matrices_html_ga80aee91a3508fa5d1df6fc0ee3693b06"><div class="ttname"><a href="group__Matrices.html#ga80aee91a3508fa5d1df6fc0ee3693b06">FOR_ALL_ELEMENTS_IN_MATRIX2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_MATRIX2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00105">matrix2d.h:105</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="group__Matrices_html_ga02463bd10e74507e895a1560f03ebcf9"><div class="ttname"><a href="group__Matrices.html#ga02463bd10e74507e895a1560f03ebcf9">matrixOperation_AB</a></div><div class="ttdeci">void matrixOperation_AB(const Matrix2D&lt; double &gt; &amp;A, const Matrix2D&lt; double &gt; &amp;B, Matrix2D&lt; double &gt; &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l00544">matrix2d.cpp:544</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga63cca7e01116967ff451df8b1f8b5a4e"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga63cca7e01116967ff451df8b1f8b5a4e">correlationIndex</a></div><div class="ttdeci">double correlationIndex(const MultidimArray&lt; T &gt; &amp;x, const MultidimArray&lt; T &gt; &amp;y, const MultidimArray&lt; int &gt; *mask=NULL, MultidimArray&lt; double &gt; *Contributions=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05692">multidim_array.h:5692</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Matrices_html_gab40746be05d4bbf352787018922ecc2e"><div class="ttname"><a href="group__Matrices.html#gab40746be05d4bbf352787018922ecc2e">MAT_ELEM</a></div><div class="ttdeci">#define MAT_ELEM(m, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00117">matrix2d.h:117</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Matrices_html_gab0b66c453466f2a6eba8722d887a42bf"><div class="ttname"><a href="group__Matrices.html#gab0b66c453466f2a6eba8722d887a42bf">matrixOperation_AtB</a></div><div class="ttdeci">void matrixOperation_AtB(const Matrix2D&lt; double &gt; &amp;A, const Matrix2D&lt; double &gt; &amp;B, Matrix2D&lt; double &gt; &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l00608">matrix2d.cpp:608</a></div></div>
<div class="ttc" id="group__Matrices_html_ga1614eafcd0598c1869e90004deef91f2"><div class="ttname"><a href="group__Matrices.html#ga1614eafcd0598c1869e90004deef91f2">matrixOperation_ABt</a></div><div class="ttdeci">void matrixOperation_ABt(const Matrix2D&lt; double &gt; &amp;A, const Matrix2D&lt; double &gt; &amp;B, Matrix2D&lt; double &gt; &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l00595">matrix2d.cpp:595</a></div></div>
<div class="ttc" id="group__Matrices_html_ga46eb206e2830820e657b26bf82969b85"><div class="ttname"><a href="group__Matrices.html#ga46eb206e2830820e657b26bf82969b85">svdcmp</a></div><div class="ttdeci">void svdcmp(const Matrix2D&lt; T &gt; &amp;a, Matrix2D&lt; double &gt; &amp;u, Matrix1D&lt; double &gt; &amp;w, Matrix2D&lt; double &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01827">matrix2d.h:1827</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classMultidimArray_html_aedb19deb51361be78c4a1a53b41fece3"><div class="ttname"><a href="classMultidimArray.html#aedb19deb51361be78c4a1a53b41fece3">MultidimArray::copy</a></div><div class="ttdeci">void copy(Matrix2D&lt; T &gt; &amp;op1) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l05428">multidim_array.h:5428</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a5ea9a6a7bd724d30070df9316ccc8199"><div class="ttname"><a href="numerical__recipes_8cpp.html#a5ea9a6a7bd724d30070df9316ccc8199">return</a></div><div class="ttdeci">return</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02411">numerical_recipes.cpp:2411</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac0d6795838f8d1daa7fb7f01deba9424"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double unnormalizedGaussian2D </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>mu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>sigmainv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Unnormalized 2D gaussian value using covariance</p>
<p>This function returns the value of a multivariate (2D) gaussian function at the point r (column vector of dimension 2).</p>
<p>G(r,mu,sigma)=exp(-0.5 * (r-mu)^t sigma^-1 (r-mu)) </p>

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02286">2286</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;{</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r) - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(mu);</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a> = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r) - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(mu);</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;    <span class="keywordflow">return</span> exp(</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;               -0.5</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;               * (sigmainv(0, 0) * x * x + 2 * sigmainv(0, 1) * x * y</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                  + sigmainv(1, 1) * y * y));</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_ad919bbce6f061400a0bc5231a9cd1621"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a></div><div class="ttdeci">static double * y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08506">numerical_recipes.cpp:8506</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab28b4aeb1c2a70160e9ee6a586f079b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Update_edge_Shah </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>surface_strength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>edge_strength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>K</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>W</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02557">2557</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;{</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    img.checkDimension(2);</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;    <span class="keywordtype">double</span> Diff = 0.0, Norm = 0.0;</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    <span class="keywordtype">size_t</span> Ydim1 = <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(img) - 1;</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    <span class="keywordtype">size_t</span> Xdim1 = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(img) - 1;</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;    <span class="keywordtype">double</span> Kinv = 1.0 / <a class="code" href="libraries_2data_2integration_8cpp.html#a97d832ae23af4f215e801e37e4f94254">K</a>;</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    <span class="comment">/* Update edge estimate */</span></div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    <span class="keywordtype">double</span> w1 = <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(W,1);</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    <span class="keywordtype">double</span> w2 = <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(W,2);</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    <span class="keywordtype">double</span> w3 = <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(W,3);</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; Ydim1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;    {</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;        <span class="keywordtype">int</span> ip1 = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1;</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;        <span class="keywordtype">int</span> im1 = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1;</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 1; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; Xdim1; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;        {</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;            <span class="keywordtype">int</span> jp1 = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + 1;</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;            <span class="keywordtype">int</span> jm1 = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - 1;</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;            <span class="comment">/* Calculate first and second derivative terms */</span></div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;            <span class="keywordtype">double</span> Fx = 0.5</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;                        * (<a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(surface_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, jp1)</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;                           - <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(surface_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, jm1));</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;            <span class="keywordtype">double</span> Fy = 0.5</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;                        * (<a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(surface_strength, ip1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;                           - <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(surface_strength, im1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;            <span class="keywordtype">double</span> Constant = w1 * (Fx * Fx + Fy * Fy);</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;            <span class="comment">/* Calculate weights for central pixel and neighbors */</span></div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;            <span class="keywordtype">double</span> Central = w2 * <a class="code" href="libraries_2data_2integration_8cpp.html#a97d832ae23af4f215e801e37e4f94254">K</a> + w3 * Kinv * 4;</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;            <span class="keywordtype">double</span> Neighbors = w3 * Kinv</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;                               * (<a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(edge_strength, im1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) + <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(edge_strength, ip1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;                                  + <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(edge_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, jm1)</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;                                  + <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(edge_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, jp1));</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;            <span class="comment">/* Calculate new S value */</span></div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;            <span class="keywordtype">double</span> Old_edge_strength = <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(edge_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;            <span class="keywordtype">double</span> S = (Constant + Neighbors) / (Constant + Central);</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;            <span class="keywordflow">if</span> (S &lt; 0)</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(edge_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) *= 0.5;</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (S &gt; 1)</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(edge_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 0.5</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;                                            * (<a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(edge_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) + 1);</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(edge_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = S;</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;            <span class="comment">// Compute the difference.</span></div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;            Diff += fabs(<a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(edge_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) - Old_edge_strength);</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;            Norm += fabs(Old_edge_strength);</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;        }</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;    }</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;    <span class="keywordflow">return</span> Diff / Norm; <span class="comment">// Return the relative difference.</span></div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;}</div><div class="ttc" id="group__Vectors_html_ga58173d9430e8e68017e3698f30382d5d"><div class="ttname"><a href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a></div><div class="ttdeci">#define VEC_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00248">matrix1d.h:248</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gafa02b309a507bf04daf9f31fa828ce4f"><div class="ttname"><a href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a></div><div class="ttdeci">#define dAij(M, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00355">multidim_array.h:355</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="libraries_2data_2integration_8cpp_html_a97d832ae23af4f215e801e37e4f94254"><div class="ttname"><a href="libraries_2data_2integration_8cpp.html#a97d832ae23af4f215e801e37e4f94254">K</a></div><div class="ttdeci">#define K</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2integration_8cpp_source.html#l00118">integration.cpp:118</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0b74d4db0a2342e875b5532a3a3da091"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Update_surface_Shah </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>surface_strength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>edge_strength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>W</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="filters_8cpp_source.html#l02479">2479</a> of file <a class="el" href="filters_8cpp_source.html">filters.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;{</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    img.checkDimension(2);</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;    <span class="keywordtype">double</span> Diff = 0.0, Norm = 0.0;</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    <span class="keywordtype">size_t</span> Ydim1 = <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(img) - 1;</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    <span class="keywordtype">size_t</span> Xdim1 = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(img) - 1;</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    <span class="comment">/* Update surface estimate */</span></div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;    <span class="keywordtype">double</span> w0 = <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(W,0);</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    <span class="keywordtype">double</span> w1 = <a class="code" href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a>(W,1);</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; Ydim1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    {</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;        <span class="keywordtype">int</span> ip1 = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1;</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;        <span class="keywordtype">int</span> im1 = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1;</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> = 1; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt; Xdim1; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;        {</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;            <span class="keywordtype">int</span> jp1 = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + 1;</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;            <span class="keywordtype">int</span> jm1 = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - 1;</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;            <span class="comment">/* Calculate edge partial derivative terms */</span></div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;            <span class="keywordtype">double</span> S = <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(edge_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;            <span class="keywordtype">double</span> Sx =</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;                0.5</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;                * (<a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(edge_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, jp1)</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;                   - <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(edge_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, jm1));</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;            <span class="keywordtype">double</span> Sy =</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;                0.5</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;                * (<a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(edge_strength, ip1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;                   - <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(edge_strength, im1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;            <span class="keywordtype">double</span> nS = 1 - S;</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;            <span class="keywordtype">double</span> nS2 = nS * nS;</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;            <span class="comment">/* Calculate surface partial derivative terms (excluding central pixel) */</span></div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;            <span class="keywordtype">double</span> F, D;</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;            F = D = <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(img, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;            <span class="keywordtype">double</span> SS_i_jp1 = <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(surface_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, jp1);</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;            <span class="keywordtype">double</span> SS_i_jm1 = <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(surface_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, jm1);</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;            <span class="keywordtype">double</span> SS_ip1_j = <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(surface_strength, ip1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;            <span class="keywordtype">double</span> SS_im1_j = <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(surface_strength, im1, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;            <span class="keywordtype">double</span> Fx = 0.5 * (SS_i_jp1 - SS_i_jm1);</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;            <span class="keywordtype">double</span> Fy = 0.5 * (SS_ip1_j - SS_im1_j);</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;            <span class="keywordtype">double</span> Fxx = SS_i_jp1 + SS_i_jm1;</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;            <span class="keywordtype">double</span> Fyy = SS_ip1_j + SS_im1_j;</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;            <span class="comment">/* Calculate surface partial derivative weights */</span></div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;            <span class="keywordtype">double</span> wFx = 4 * w1 * nS * Sx;</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;            <span class="keywordtype">double</span> wFy = 4 * w1 * nS * Sy;</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;            <span class="keywordtype">double</span> wFxx = -2 * w1 * nS2;</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;            <span class="keywordtype">double</span> wFyy = -2 * w1 * nS2;</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;            <span class="comment">/* Calculate new surface value */</span></div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;            <span class="keywordtype">double</span> Constant = -2 * w0 * D;</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;            <span class="keywordtype">double</span> Central = -2 * w0 + 2 * wFxx + 2 * wFyy;</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;            <span class="keywordtype">double</span> Neighbors = wFx * Fx + wFy * Fy + wFxx * Fxx + wFyy * Fyy;</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;            <span class="keywordflow">if</span> (fabs(Central) &gt; <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>)</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;                F = (Constant + Neighbors) / Central;</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;            F = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(F, 0, 1);</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;            <span class="comment">// Compute the difference.</span></div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;            <span class="keywordtype">double</span> SS_i_j = <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(surface_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;            Diff += fabs(SS_i_j - F);</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;            Norm += fabs(SS_i_j);</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;            <span class="comment">// Update the new value.</span></div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a>(surface_strength, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = F;</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;        }</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    }</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    <span class="keywordflow">return</span> Diff / Norm; <span class="comment">// Return the relative difference.</span></div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;}</div><div class="ttc" id="group__Vectors_html_ga58173d9430e8e68017e3698f30382d5d"><div class="ttname"><a href="group__Vectors.html#ga58173d9430e8e68017e3698f30382d5d">VEC_ELEM</a></div><div class="ttdeci">#define VEC_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00248">matrix1d.h:248</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Macros_html_gad4d08cca0a39849cc247072eaebe7726"><div class="ttname"><a href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a></div><div class="ttdeci">#define CLIP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00260">xmipp_macros.h:260</a></div></div>
<div class="ttc" id="group__Macros_html_gad584f97e936242b173add43261376ba5"><div class="ttname"><a href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a></div><div class="ttdeci">#define XMIPP_EQUAL_ACCURACY</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00119">xmipp_macros.h:119</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gafa02b309a507bf04daf9f31fa828ce4f"><div class="ttname"><a href="group__MultidimensionalArrays.html#gafa02b309a507bf04daf9f31fa828ce4f">dAij</a></div><div class="ttdeci">#define dAij(M, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00355">multidim_array.h:355</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
