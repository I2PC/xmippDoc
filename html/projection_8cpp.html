<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Xmipp: /home/yunior/Yunior/Projects/Scipion/COSS/xmipp-bundle/src/xmipp/libraries/data/projection.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_dbce2b2c1291334a9ade6207c7a262fa.html">xmipp-bundle</a></li><li class="navelem"><a class="el" href="dir_5ca4f3e8e51f1e22c724fe6427eb943c.html">src</a></li><li class="navelem"><a class="el" href="dir_51a4fe91bde3feaf0f23bad87d0144e4.html">xmipp</a></li><li class="navelem"><a class="el" href="dir_c1f8b3d1b5354b6c120dfc6668096234.html">libraries</a></li><li class="navelem"><a class="el" href="dir_f083b9d43eb51ff5c9ab4698ce0a19c4.html">data</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">projection.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="projection_8h_source.html">projection.h</a>&quot;</code><br />
<code>#include &lt;<a class="el" href="geometry_8h_source.html">core/geometry.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for projection.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="projection_8cpp__incl.png" border="0" usemap="#_2home_2yunior_2Yunior_2Projects_2Scipion_2COSS_2xmipp-bundle_2src_2xmipp_2libraries_2data_2projection_8cpp" alt=""/></div>
<map name="_2home_2yunior_2Yunior_2Projects_2Scipion_2COSS_2xmipp-bundle_2src_2xmipp_2libraries_2data_2projection_8cpp" id="_2home_2yunior_2Yunior_2Projects_2Scipion_2COSS_2xmipp-bundle_2src_2xmipp_2libraries_2data_2projection_8cpp">
<area shape="rect" id="node2" href="projection_8h.html" title="projection.h" alt="" coords="1431,124,1521,151"/>
<area shape="rect" id="node19" href="geometry_8h.html" title="geometry.h" alt="" coords="94,721,181,748"/>
<area shape="rect" id="node3" href="xmipp__image_8h.html" title="core/xmipp_image.h" alt="" coords="1288,423,1427,449"/>
<area shape="rect" id="node38" href="xmipp__threads_8h.html" title="core/xmipp_threads.h" alt="" coords="2439,273,2585,300"/>
<area shape="rect" id="node40" href="grids_8h.html" title="grids.h" alt="" coords="323,348,384,375"/>
<area shape="rect" id="node42" href="basis_8h.html" title="basis.h" alt="" coords="1781,199,1845,225"/>
<area shape="rect" id="node46" href="xmipp__program_8h.html" title="core/xmipp_program.h" alt="" coords="2055,348,2206,375"/>
<area shape="rect" id="node49" href="fourier__projection_8h.html" title="data/fourier_projection.h" alt="" coords="1277,273,1438,300"/>
<area shape="rect" id="node4" href="xmipp__image__base_8h.html" title="xmipp_image_base.h" alt="" coords="1265,572,1410,599"/>
<area shape="rect" id="node6" href="multidim__array_8h.html" title="multidim_array.h" alt="" coords="1777,871,1895,897"/>
<area shape="rect" id="node36" href="xmipp__image__generic_8h.html" title="xmipp_image_generic.h" alt="" coords="1161,497,1319,524"/>
<area shape="rect" id="node37" href="xmipp__color_8h.html" title="xmipp_color.h" alt="" coords="2449,721,2551,748"/>
<area shape="rect" id="node5" href="xmipp__image__macros_8h.html" title="xmipp_image_macros.h" alt="" coords="1489,647,1649,673"/>
<area shape="rect" id="node16" href="transformations_8h.html" title="transformations.h" alt="" coords="1673,647,1796,673"/>
<area shape="rect" id="node18" href="xmipp__datatype_8h.html" title="xmipp_datatype.h" alt="" coords="419,871,544,897"/>
<area shape="rect" id="node20" href="metadata_8h.html" title="metadata.h" alt="" coords="2286,721,2373,748"/>
<area shape="rect" id="node24" href="rwDM3_8h.html" title="rwDM3.h" alt="" coords="2036,647,2111,673"/>
<area shape="rect" id="node25" href="rwDM4_8h.html" title="rwDM4.h" alt="" coords="2135,647,2209,673"/>
<area shape="rect" id="node26" href="rwIMAGIC_8h.html" title="rwIMAGIC.h" alt="" coords="459,647,554,673"/>
<area shape="rect" id="node27" href="rwMRC_8h.html" title="rwMRC.h" alt="" coords="578,647,657,673"/>
<area shape="rect" id="node28" href="rwINF_8h.html" title="rwINF.h" alt="" coords="681,647,751,673"/>
<area shape="rect" id="node29" href="rwRAW_8h.html" title="rwRAW.h" alt="" coords="775,647,854,673"/>
<area shape="rect" id="node30" href="rwSPIDER_8h.html" title="rwSPIDER.h" alt="" coords="879,647,977,673"/>
<area shape="rect" id="node31" href="rwSPE_8h.html" title="rwSPE.h" alt="" coords="1001,647,1076,673"/>
<area shape="rect" id="node32" href="rwTIA_8h.html" title="rwTIA.h" alt="" coords="1101,647,1169,673"/>
<area shape="rect" id="node33" href="rwJPEG_8h.html" title="rwJPEG.h" alt="" coords="1193,647,1276,673"/>
<area shape="rect" id="node34" href="rwTIFF_8h.html" title="rwTIFF.h" alt="" coords="1300,647,1375,673"/>
<area shape="rect" id="node35" href="rwEM_8h.html" title="rwEM.h" alt="" coords="1399,647,1465,673"/>
<area shape="rect" id="node7" href="tsplinebasis_8h.html" title="bilib/tsplinebasis.h" alt="" coords="1773,945,1902,972"/>
<area shape="rect" id="node8" href="kernel_8h.html" title="bilib/kernel.h" alt="" coords="2130,945,2225,972"/>
<area shape="rect" id="node9" href="xmipp__strings_8h.html" title="xmipp_strings.h" alt="" coords="1883,1095,1997,1121"/>
<area shape="rect" id="node11" href="matrix1d_8h.html" title="matrix1d.h" alt="" coords="1977,1020,2060,1047"/>
<area shape="rect" id="node13" href="matrix2d_8h.html" title="matrix2d.h" alt="" coords="1667,945,1749,972"/>
<area shape="rect" id="node14" href="xmipp__error_8h.html" title="xmipp_error.h" alt="" coords="1548,1020,1649,1047"/>
<area shape="rect" id="node17" href="multidim__array__generic_8h.html" title="multidim_array_generic.h" alt="" coords="409,796,575,823"/>
<area shape="rect" id="node41" href="args_8h.html" title="core/args.h" alt="" coords="1555,945,1642,972"/>
<area shape="rect" id="node43" href="blobs_8h.html" title="blobs.h" alt="" coords="1781,273,1845,300"/>
<area shape="rect" id="node44" href="xmipp__image__over_8h.html" title="xmipp_image_over.h" alt="" coords="1673,348,1815,375"/>
<area shape="rect" id="node45" href="splines_8h.html" title="splines.h" alt="" coords="1920,273,1995,300"/>
<area shape="rect" id="node47" href="argsprinter_8h.html" title="argsprinter.h" alt="" coords="2055,423,2150,449"/>
<area shape="rect" id="node48" href="xmipp__program__sql_8h.html" title="xmipp_program_sql.h" alt="" coords="2175,423,2321,449"/>
<area shape="rect" id="node50" href="xmipp__fftw_8h.html" title="core/xmipp_fftw.h" alt="" coords="530,721,657,748"/>
</map>
</div>
</div>
<p><a href="projection_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a94ec8a7a5cf5c289d292aef5777c4c14"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="projection_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(proj))</td></tr>
<tr class="separator:a94ec8a7a5cf5c289d292aef5777c4c14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f613ddaea2048e3471a1f4f04ba4b79"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="projection_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(proj))</td></tr>
<tr class="separator:a8f613ddaea2048e3471a1f4f04ba4b79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d9521fd31b2e16413d1b78836953d53"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="projection_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(proj))</td></tr>
<tr class="separator:a0d9521fd31b2e16413d1b78836953d53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a132f3924593d07b0a1f55b3f22e92ba6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="projection_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a>&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(proj))</td></tr>
<tr class="separator:a132f3924593d07b0a1f55b3f22e92ba6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab17807a5400b7a54607c87513d0edf80"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="projection_8cpp.html#ab17807a5400b7a54607c87513d0edf80">xDim</a>&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(proj))</td></tr>
<tr class="separator:ab17807a5400b7a54607c87513d0edf80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a151b09680d4024bb8c942ec71983b77f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="projection_8cpp.html#a151b09680d4024bb8c942ec71983b77f">yDim</a>&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(proj))</td></tr>
<tr class="separator:a151b09680d4024bb8c942ec71983b77f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25410267ae5c8881fa80cb0267e1c2c9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="projection_8cpp.html#a25410267ae5c8881fa80cb0267e1c2c9">wrap_as_Crystal</a>(<a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>,  <a class="el" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>,  xw,  yw)</td></tr>
<tr class="separator:a25410267ae5c8881fa80cb0267e1c2c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53a673a2160df38bb7db83bb2285dfd0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="projection_8cpp.html#a53a673a2160df38bb7db83bb2285dfd0">xc</a>&#160;&#160;&#160;<a class="el" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rc)</td></tr>
<tr class="separator:a53a673a2160df38bb7db83bb2285dfd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1e8fe6c0c8c7b525c7ab029d7d91a09"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="projection_8cpp.html#ab1e8fe6c0c8c7b525c7ab029d7d91a09">yc</a>&#160;&#160;&#160;<a class="el" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rc)</td></tr>
<tr class="separator:ab1e8fe6c0c8c7b525c7ab029d7d91a09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab81d9253b246f09be9999505d515d517"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="projection_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>&#160;&#160;&#160;<a class="el" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r)</td></tr>
<tr class="separator:ab81d9253b246f09be9999505d515d517"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afffa29183d9c97e35c9e6b263445fd3e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="projection_8cpp.html#afffa29183d9c97e35c9e6b263445fd3e">y</a>&#160;&#160;&#160;<a class="el" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r)</td></tr>
<tr class="separator:afffa29183d9c97e35c9e6b263445fd3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2d518daea4ed16be8fb7fc8038929813"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="projection_8cpp.html#a2d518daea4ed16be8fb7fc8038929813">projectVolume</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V, <a class="el" href="classProjection.html">Projection</a> &amp;P, int Ydim, int Xdim, double rot, double tilt, double psi, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; *roffset)</td></tr>
<tr class="separator:a2d518daea4ed16be8fb7fc8038929813"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a125751740b29feb4f536731abe705b6a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="projection_8cpp.html#a125751740b29feb4f536731abe705b6a">projectVolumeOffCentered</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V, <a class="el" href="classProjection.html">Projection</a> &amp;P, int Ydim, int Xdim)</td></tr>
<tr class="separator:a125751740b29feb4f536731abe705b6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afaefa09ed28fafff7cf217bfe29f1efe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="projection_8cpp.html#afaefa09ed28fafff7cf217bfe29f1efe">singleWBP</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V, <a class="el" href="classProjection.html">Projection</a> &amp;P)</td></tr>
<tr class="separator:afaefa09ed28fafff7cf217bfe29f1efe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5822d132674cef78f61512b773206e12"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="projection_8cpp.html#a5822d132674cef78f61512b773206e12">project_Crystal_SimpleGrid</a> (<a class="el" href="classImage.html">Image</a>&lt; double &gt; &amp;vol, const <a class="el" href="classSimpleGrid.html">SimpleGrid</a> &amp;grid, const <a class="el" href="classBasis.html">Basis</a> &amp;basis, <a class="el" href="classProjection.html">Projection</a> &amp;proj, <a class="el" href="classProjection.html">Projection</a> &amp;norm_proj, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;shift, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;aint, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;bint, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;D, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;Dinv, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, int FORW, int eq_mode)</td></tr>
<tr class="separator:a5822d132674cef78f61512b773206e12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2637994d6a53467e26f07e5a6568d9c3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="projection_8cpp.html#a2637994d6a53467e26f07e5a6568d9c3">project_Crystal_Volume</a> (<a class="el" href="group__Grids.html#gae3eeb15b316a9800a7c35372dfd57460">GridVolume</a> &amp;vol, const <a class="el" href="classBasis.html">Basis</a> &amp;basis, <a class="el" href="classProjection.html">Projection</a> &amp;proj, <a class="el" href="classProjection.html">Projection</a> &amp;norm_proj, int Ydim, int Xdim, double rot, double tilt, double psi, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;shift, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;aint, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;bint, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;D, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;Dinv, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;mask, int FORW, int eq_mode)</td></tr>
<tr class="separator:a2637994d6a53467e26f07e5a6568d9c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c95065c2aa1d113758a2621cfaa65b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="projection_8cpp.html#a8c95065c2aa1d113758a2621cfaa65b6">count_eqs_in_projection</a> (<a class="el" href="classGridVolumeT.html">GridVolumeT</a>&lt; int &gt; &amp;GVNeq, const <a class="el" href="classBasis.html">Basis</a> &amp;basis, <a class="el" href="classProjection.html">Projection</a> &amp;read_proj)</td></tr>
<tr class="separator:a8c95065c2aa1d113758a2621cfaa65b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a3e46756d453b695deb8da52e590ef0b1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__Threads.html#ga0b86c483ccff385c24a8a278870af9f7">barrier_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="projection_8cpp.html#a3e46756d453b695deb8da52e590ef0b1">project_barrier</a></td></tr>
<tr class="separator:a3e46756d453b695deb8da52e590ef0b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b8971032d8e98145e6691683950fe8c"><td class="memItemLeft" align="right" valign="top">pthread_mutex_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="projection_8cpp.html#a6b8971032d8e98145e6691683950fe8c">project_mutex</a> = PTHREAD_MUTEX_INITIALIZER</td></tr>
<tr class="separator:a6b8971032d8e98145e6691683950fe8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef66df64a8ff60fcb4b1aed8341af3b1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structproject__thread__params.html">project_thread_params</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="projection_8cpp.html#aef66df64a8ff60fcb4b1aed8341af3b1">project_threads</a></td></tr>
<tr class="separator:aef66df64a8ff60fcb4b1aed8341af3b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a25410267ae5c8881fa80cb0267e1c2c9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define wrap_as_Crystal</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">xw, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">yw&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">xw=(int) <a class="code" href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a>(<a class="code" href="projection_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>,<a class="code" href="projection_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>,<a class="code" href="projection_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a>); \</div><div class="line">    yw=(int) <a class="code" href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a>(<a class="code" href="projection_8cpp.html#afffa29183d9c97e35c9e6b263445fd3e">y</a>,<a class="code" href="projection_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>,<a class="code" href="projection_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a>);</div><div class="ttc" id="projection_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="projection_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">#define x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02490">numerical_recipes.cpp:2490</a></div></div>
<div class="ttc" id="projection_8cpp_html_a8f613ddaea2048e3471a1f4f04ba4b79"><div class="ttname"><a href="projection_8cpp.html#a8f613ddaea2048e3471a1f4f04ba4b79">xF</a></div><div class="ttdeci">#define xF</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l00030">projection.cpp:30</a></div></div>
<div class="ttc" id="projection_8cpp_html_a132f3924593d07b0a1f55b3f22e92ba6"><div class="ttname"><a href="projection_8cpp.html#a132f3924593d07b0a1f55b3f22e92ba6">yF</a></div><div class="ttdeci">#define yF</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l00032">projection.cpp:32</a></div></div>
<div class="ttc" id="projection_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="projection_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l00029">projection.cpp:29</a></div></div>
<div class="ttc" id="projection_8cpp_html_afffa29183d9c97e35c9e6b263445fd3e"><div class="ttname"><a href="projection_8cpp.html#afffa29183d9c97e35c9e6b263445fd3e">y</a></div><div class="ttdeci">#define y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08527">numerical_recipes.cpp:8527</a></div></div>
<div class="ttc" id="group__Macros_html_ga10de40044d2903ec0d4e7e57c31322aa"><div class="ttname"><a href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a></div><div class="ttdeci">#define intWRAP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00272">xmipp_macros.h:272</a></div></div>
<div class="ttc" id="projection_8cpp_html_a0d9521fd31b2e16413d1b78836953d53"><div class="ttname"><a href="projection_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a></div><div class="ttdeci">#define y0</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l00031">projection.cpp:31</a></div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="projection_8cpp_source.html#l00747">747</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab81d9253b246f09be9999505d515d517"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double * x&#160;&#160;&#160;<a class="el" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="numerical__recipes_8cpp_source.html#l02490">2490</a> of file <a class="el" href="numerical__recipes_8cpp_source.html">numerical_recipes.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a94ec8a7a5cf5c289d292aef5777c4c14"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define x0&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(proj))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="projection_8cpp_source.html#l00029">29</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a53a673a2160df38bb7db83bb2285dfd0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define xc&#160;&#160;&#160;<a class="el" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rc)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab17807a5400b7a54607c87513d0edf80"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define xDim&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(proj))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="projection_8cpp_source.html#l00033">33</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a8f613ddaea2048e3471a1f4f04ba4b79"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define xF&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(proj))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="projection_8cpp_source.html#l00030">30</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="afffa29183d9c97e35c9e6b263445fd3e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void y&#160;&#160;&#160;<a class="el" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="numerical__recipes_8cpp_source.html#l08527">8527</a> of file <a class="el" href="numerical__recipes_8cpp_source.html">numerical_recipes.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a0d9521fd31b2e16413d1b78836953d53"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define y0&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(proj))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="projection_8cpp_source.html#l00031">31</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab1e8fe6c0c8c7b525c7ab029d7d91a09"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define yc&#160;&#160;&#160;<a class="el" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rc)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a151b09680d4024bb8c942ec71983b77f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define yDim&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(proj))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="projection_8cpp_source.html#l00034">34</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a132f3924593d07b0a1f55b3f22e92ba6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define yF&#160;&#160;&#160;<a class="el" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(<a class="el" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(proj))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="projection_8cpp_source.html#l00032">32</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a8c95065c2aa1d113758a2621cfaa65b6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void count_eqs_in_projection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classGridVolumeT.html">GridVolumeT</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>GVNeq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBasis.html">Basis</a> &amp;&#160;</td>
          <td class="paramname"><em>basis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>read_proj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Count equations in volume. For Component AVeraing (CAV), the number of equations in which each basis is involved is needed. </p>

<p>Definition at line <a class="el" href="projection_8cpp_source.html#l01173">1173</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;{</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; GVNeq.<a class="code" href="classGridVolumeT.html#a8273923cc41926a2c0a65ab8dd2eadff">VolumesNo</a>(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;        <a class="code" href="projection_8h.html#a1201a233513c7ea40b5e37eddee155de">project_SimpleGrid</a>(&amp;(GVNeq(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)), &amp;(GVNeq.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)), &amp;basis,</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                           &amp;read_proj, &amp;read_proj, <a class="code" href="blobs_8cpp.html#a6ddfdda7a062d10cff4a72b76b44aeb8">FORWARD</a>, <a class="code" href="projection_8h.html#a419ca555dc06cbc2c73ee335bc9c0cf4">COUNT_EQ</a>, NULL, NULL);</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;}</div><div class="ttc" id="projection_8h_html_a419ca555dc06cbc2c73ee335bc9c0cf4"><div class="ttname"><a href="projection_8h.html#a419ca555dc06cbc2c73ee335bc9c0cf4">COUNT_EQ</a></div><div class="ttdeci">#define COUNT_EQ</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00164">projection.h:164</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classGridVolumeT_html_a15c952085d4d666a36edd51858c90d0a"><div class="ttname"><a href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">GridVolumeT::grid</a></div><div class="ttdeci">const SimpleGrid &amp; grid(size_t n) const </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00991">grids.h:991</a></div></div>
<div class="ttc" id="classGridVolumeT_html_a8273923cc41926a2c0a65ab8dd2eadff"><div class="ttname"><a href="classGridVolumeT.html#a8273923cc41926a2c0a65ab8dd2eadff">GridVolumeT::VolumesNo</a></div><div class="ttdeci">size_t VolumesNo() const </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l01016">grids.h:1016</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a6ddfdda7a062d10cff4a72b76b44aeb8"><div class="ttname"><a href="blobs_8cpp.html#a6ddfdda7a062d10cff4a72b76b44aeb8">FORWARD</a></div><div class="ttdeci">#define FORWARD</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l01071">blobs.cpp:1071</a></div></div>
<div class="ttc" id="projection_8h_html_a1201a233513c7ea40b5e37eddee155de"><div class="ttname"><a href="projection_8h.html#a1201a233513c7ea40b5e37eddee155de">project_SimpleGrid</a></div><div class="ttdeci">void project_SimpleGrid(Image&lt; T &gt; *vol, const SimpleGrid *grid, const Basis *basis, Projection *proj, Projection *norm_proj, int FORW, int eq_mode, const Image&lt; int &gt; *VNeq, Matrix2D&lt; double &gt; *M, const MultidimArray&lt; int &gt; *mask=NULL, double ray_length=-1.0, int thread_id=-1, int num_threads=1)</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00390">projection.h:390</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5822d132674cef78f61512b773206e12"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void project_Crystal_SimpleGrid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classImage.html">Image</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classSimpleGrid.html">SimpleGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBasis.html">Basis</a> &amp;&#160;</td>
          <td class="paramname"><em>basis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>proj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>norm_proj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>aint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>bint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Dinv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>FORW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>eq_mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="projection_8cpp_source.html#l00751">751</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;{</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> prjX(3);                <span class="comment">// Coordinate: Projection of the</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> prjY(3);                <span class="comment">// 3 grid vectors</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> prjZ(3);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> prjOrigin(3);           <span class="comment">// Coordinate: Where in the 2D</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="comment">// projection plane the origin of</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="comment">// the grid projects</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> prjaint(3);             <span class="comment">// Coordinate: Projection of the</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> prjbint(3);             <span class="comment">// 2 deformed lattice vectors</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> prjDir;                 <span class="comment">// Direction of projection</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="comment">// in the deformed space</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> actprj(3);              <span class="comment">// Coord: Actual position inside</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="comment">// the projection plane</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> defactprj(3);           <span class="comment">// Coord: Actual position inside</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="comment">// the deformed projection plane</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> beginZ(3);              <span class="comment">// Coord: Plane coordinates of the</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="comment">// projection of the 3D point</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="comment">// (z0,YY(lowest),XX(lowest))</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> beginY(3);              <span class="comment">// Coord: Plane coordinates of the</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="comment">// projection of the 3D point</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="comment">// (z0,y0,XX(lowest))</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> footprint_size(2);      <span class="comment">// The footprint is supposed</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="comment">// to be defined between</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="comment">// (-vmax,+vmax) in the Y axis,</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="comment">// and (-umax,+umax) in the X axis</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="comment">// This footprint size is the</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="comment">// R2 vector (umax,vmax).</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> deffootprint_size(2);   <span class="comment">// The footprint size</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="comment">// in the deformed space</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="keywordtype">int</span> XX_corner2, XX_corner1;              <span class="comment">// Coord: Corners of the</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordtype">int</span> YY_corner2, YY_corner1;              <span class="comment">// footprint when it is projected</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="comment">// onto the projection plane</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> rc(2), r(2);            <span class="comment">// Position vector which will</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="comment">// move from corner1 to corner2.</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="comment">// In rc the wrapping is not</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="comment">// considered, while it is in r</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordtype">int</span>           foot_V, foot_U;            <span class="comment">// Img Coord: coordinate</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="comment">// corresponding to the blobprint</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="comment">// point which matches with this</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="comment">// pixel position</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordtype">double</span>        vol_corr=0.;               <span class="comment">// Correction for a volume element</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="keywordtype">int</span>           N_eq;                      <span class="comment">// Number of equations in which</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="comment">// a blob is involved</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordtype">int</span>           <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>;                   <span class="comment">// volume element indexes</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <a class="code" href="group__Macros.html#ga0714b7b60ab5b804af1c9b124863178e">SPEED_UP_temps01</a>;                        <span class="comment">// Auxiliary variables for</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="comment">// fast multiplications</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="comment">// Check that it is a blob volume .......................................</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">if</span> (basis.<a class="code" href="classBasis.html#a12a694f7cef08beaf6f7d51b2837432c">type</a> != <a class="code" href="classBasis.html#aa73185836d4dd144f8591d827d8f952ca5e21d65cbd3255eed09cafb1d2ad0143">Basis::blobs</a>)</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a>, <span class="stringliteral">&quot;project_Crystal_SimpleGrid: Cannot project other than &quot;</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                     <span class="stringliteral">&quot;blob volumes&quot;</span>);</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="comment">// Compute the deformed direction of projection .........................</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> Eulerg;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    Eulerg = proj.<a class="code" href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">euler</a> * D;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="comment">// Compute deformation in the projection space ..........................</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="comment">// The following two vectors are defined in the deformed volume space</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(actprj, <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(aint), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(aint), 0);</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    grid.<a class="code" href="classSimpleGrid.html#a9d9d55f6ddeb12f700f090fe74dd1652">Gdir_project_to_plane</a>(actprj, Eulerg, prjaint);</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(actprj, <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(bint), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(bint), 0);</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    grid.<a class="code" href="classSimpleGrid.html#a9d9d55f6ddeb12f700f090fe74dd1652">Gdir_project_to_plane</a>(actprj, Eulerg, prjbint);</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="comment">//#define DEBUG_LITTLE</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordtype">double</span> rot, tilt, <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <a class="code" href="group__Geometry.html#gaa0889ad000c2166f766c927fc7c2f58c">Euler_matrix2angles</a>(proj.<a class="code" href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">euler</a>, rot, tilt, psi);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;rot= &quot;</span>  &lt;&lt; rot &lt;&lt; <span class="stringliteral">&quot; tilt= &quot;</span> &lt;&lt; tilt</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; psi= &quot;</span> &lt;&lt; psi &lt;&lt; std::endl;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;D\n&quot;</span> &lt;&lt; D &lt;&lt; std::endl;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Eulerf\n&quot;</span> &lt;&lt; proj.<a class="code" href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">euler</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Eulerg\n&quot;</span> &lt;&lt; Eulerg &lt;&lt; std::endl;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;aint    &quot;</span> &lt;&lt; aint.<a class="code" href="classMatrix1D.html#a8849e36416cde2a57914953a815d4b43">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;bint    &quot;</span> &lt;&lt; bint.<a class="code" href="classMatrix1D.html#a8849e36416cde2a57914953a815d4b43">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;prjaint &quot;</span> &lt;&lt; prjaint.<a class="code" href="classMatrix1D.html#a8849e36416cde2a57914953a815d4b43">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;prjbint &quot;</span> &lt;&lt; prjbint.<a class="code" href="classMatrix1D.html#a8849e36416cde2a57914953a815d4b43">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    std::cout.flush();</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="comment">// Project grid axis ....................................................</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="comment">// These vectors ((1,0,0),(0,1,0),...) are referred to the grid</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="comment">// coord. system and the result is a 2D vector in the image plane</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="comment">// The unit size within the image plane is 1, ie, the same as for</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="comment">// the universal grid.</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="comment">// Be careful that these grid vectors are defined in the deformed</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="comment">// volume space, and the projection are defined in the deformed</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="comment">// projections,</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(actprj, 1, 0, 0);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    grid.<a class="code" href="classSimpleGrid.html#a9d9d55f6ddeb12f700f090fe74dd1652">Gdir_project_to_plane</a>(actprj, Eulerg, prjX);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(actprj, 0, 1, 0);</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    grid.<a class="code" href="classSimpleGrid.html#a9d9d55f6ddeb12f700f090fe74dd1652">Gdir_project_to_plane</a>(actprj, Eulerg, prjY);</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(actprj, 0, 0, 1);</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    grid.<a class="code" href="classSimpleGrid.html#a9d9d55f6ddeb12f700f090fe74dd1652">Gdir_project_to_plane</a>(actprj, Eulerg, prjZ);</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="comment">// This time the origin of the grid is in the universal coord system</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="comment">// but in the deformed space</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <a class="code" href="group__Geometry.html#gade8f7976e3d84a594d4728bf8f4c029e">Uproject_to_plane</a>(grid.<a class="code" href="classSimpleGrid.html#a2eb28005f2a2af28ca2fab40772a2561">origin</a>, Eulerg, prjOrigin);</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="comment">// This is a correction used by the crystallographic symmetries</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    prjOrigin += <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(shift) * prjaint + <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(shift) * prjbint;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;prjX      &quot;</span> &lt;&lt; prjX.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;prjY      &quot;</span> &lt;&lt; prjY.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;prjZ      &quot;</span> &lt;&lt; prjZ.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;prjOrigin &quot;</span> &lt;&lt; prjOrigin.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    std::cout.flush();</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="comment">// Now I will impose that prja becomes (Xdim,0) and prjb, (0,Ydim)</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="comment">// A is a matrix such that</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">// A*prjaint=(Xdim,0)&#39;</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="comment">// A*prjbint=(0,Ydim)&#39;</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> A(2, 2), Ainv(2, 2);</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    A(0, 0) = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(prjbint) * <a class="code" href="projection_8cpp.html#ab17807a5400b7a54607c87513d0edf80">xDim</a>;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    A(0, 1) = -<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(prjbint) * <a class="code" href="projection_8cpp.html#ab17807a5400b7a54607c87513d0edf80">xDim</a>;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    A(1, 0) = -<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(prjaint) * <a class="code" href="projection_8cpp.html#a151b09680d4024bb8c942ec71983b77f">yDim</a>;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    A(1, 1) = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(prjaint) * <a class="code" href="projection_8cpp.html#a151b09680d4024bb8c942ec71983b77f">yDim</a>;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordtype">double</span> nor = 1 / (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(prjaint) * <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(prjbint) - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(prjbint) * <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(prjaint));</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <a class="code" href="group__Matrices.html#ga74d7e752302a7af72125514181123234">M2x2_BY_CT</a>(A, A, nor);</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <a class="code" href="group__Matrices.html#ga94eb0766edba2c7042e6db51141ce02b">M2x2_INV</a>(Ainv, A);</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;A\n&quot;</span> &lt;&lt; A &lt;&lt; std::endl;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Ainv\n&quot;</span> &lt;&lt; Ainv &lt;&lt; std::endl;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Check that A*prjaint=(Xdim,0)    &quot;</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    &lt;&lt; (A*<a class="code" href="group__Vectors.html#ga97ccb86b4c568b2271da21552034d504">vectorR2</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(prjaint), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(prjaint))).<a class="code" href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Check that A*prjbint=(0,Ydim)    &quot;</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    &lt;&lt; (A*<a class="code" href="group__Vectors.html#ga97ccb86b4c568b2271da21552034d504">vectorR2</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(prjbint), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(prjbint))).<a class="code" href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Check that Ainv*(Xdim,0)=prjaint &quot;</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    &lt;&lt; (Ainv*<a class="code" href="group__Vectors.html#ga97ccb86b4c568b2271da21552034d504">vectorR2</a>(<a class="code" href="projection_8cpp.html#ab17807a5400b7a54607c87513d0edf80">xDim</a>, 0)).<a class="code" href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Check that Ainv*(0,Ydim)=prjbint &quot;</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    &lt;&lt; (Ainv*<a class="code" href="group__Vectors.html#ga97ccb86b4c568b2271da21552034d504">vectorR2</a>(0, <a class="code" href="projection_8cpp.html#a151b09680d4024bb8c942ec71983b77f">yDim</a>)).<a class="code" href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    std::cout.flush();</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="comment">// Footprint size .......................................................</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="comment">// The following vectors are integer valued vectors, but they are</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="comment">// stored as real ones to make easier operations with other vectors.</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="comment">// Look out that this footprint size is in the deformed projection,</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="comment">// that is why it is not a square footprint but a parallelogram</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="comment">// and we have to look for the smaller rectangle which surrounds it</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(footprint_size) = basis.<a class="code" href="classBasis.html#af8314ea940eb8cacc15fda550ea5c8d3">blobprint</a>.<a class="code" href="classImageOver.html#adbd8f34a9b3347029cad356b483ec7a1">umax</a>();</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(footprint_size) = basis.<a class="code" href="classBasis.html#af8314ea940eb8cacc15fda550ea5c8d3">blobprint</a>.<a class="code" href="classImageOver.html#a208d4d8e607248a8985d723a736d0dae">vmax</a>();</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    N_eq = (2 * basis.<a class="code" href="classBasis.html#af8314ea940eb8cacc15fda550ea5c8d3">blobprint</a>.<a class="code" href="classImageOver.html#adbd8f34a9b3347029cad356b483ec7a1">umax</a>() + 1) * (2 * basis.<a class="code" href="classBasis.html#af8314ea940eb8cacc15fda550ea5c8d3">blobprint</a>.<a class="code" href="classImageOver.html#a208d4d8e607248a8985d723a736d0dae">vmax</a>() + 1);</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> c1(3), c2(3);</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(c1)           = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(footprint_size);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(c1)           = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(footprint_size);</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(c2)           = -<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(c1);</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(c2)           = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(c1);</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <a class="code" href="group__Matrices.html#gaec08782c566ba3c8c093b909f562e953">M2x2_BY_V2x1</a>(c1, A, c1);</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <a class="code" href="group__Matrices.html#gaec08782c566ba3c8c093b909f562e953">M2x2_BY_V2x1</a>(c2, A, c2);</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(deffootprint_size) = <a class="code" href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a>(fabs(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(c1)), fabs(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(c2)));</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(deffootprint_size) = <a class="code" href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a>(fabs(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(c1)), fabs(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(c2)));</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Footprint_size &quot;</span> &lt;&lt; footprint_size.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;c1: &quot;</span> &lt;&lt; c1.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;c2: &quot;</span> &lt;&lt; c2.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Deformed Footprint_size &quot;</span> &lt;&lt; deffootprint_size.transpose()</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    &lt;&lt; std::endl;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    std::cout.flush();</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="comment">// This type conversion gives more speed</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="keywordtype">int</span> ZZ_lowest = (int) <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(grid.<a class="code" href="classSimpleGrid.html#ac11364ea0ab16392eef9db243986bc5a">lowest</a>);</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordtype">int</span> YY_lowest = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>((<span class="keywordtype">int</span>) <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(grid.<a class="code" href="classSimpleGrid.html#ac11364ea0ab16392eef9db243986bc5a">lowest</a>), <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(mask));</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="keywordtype">int</span> XX_lowest = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>((<span class="keywordtype">int</span>) <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(grid.<a class="code" href="classSimpleGrid.html#ac11364ea0ab16392eef9db243986bc5a">lowest</a>), <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(mask));</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="keywordtype">int</span> ZZ_highest = (int) <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(grid.<a class="code" href="classSimpleGrid.html#a9b2b5818f2b06e553c3c6a2a6d2a8951">highest</a>);</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="keywordtype">int</span> YY_highest = <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>((<span class="keywordtype">int</span>) <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(grid.<a class="code" href="classSimpleGrid.html#a9b2b5818f2b06e553c3c6a2a6d2a8951">highest</a>), <a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(mask));</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keywordtype">int</span> XX_highest = <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>((<span class="keywordtype">int</span>) <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(grid.<a class="code" href="classSimpleGrid.html#a9b2b5818f2b06e553c3c6a2a6d2a8951">highest</a>), <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(mask));</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="comment">// Project the whole grid ...............................................</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="comment">// Corner of the plane defined by Z. These coordinates try to be within</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="comment">// the valid indexes of the projection (defined between STARTING and</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="comment">// FINISHING values, but it could be that they may lie outside.</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="comment">// These coordinates need not to be integer, in general, they are</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="comment">// real vectors.</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="comment">// The vectors returned by the projection routines are R3 but we</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="comment">// are only interested in their first 2 components, ie, in the</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="comment">// in-plane components</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    beginZ = (double)XX_lowest * prjX + (<span class="keywordtype">double</span>)YY_lowest * prjY + (double)ZZ_lowest * prjZ + prjOrigin;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="preprocessor">#ifdef DEBUG_LITTLE</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;BeginZ     &quot;</span> &lt;&lt; beginZ.transpose()             &lt;&lt; std::endl;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Mask       &quot;</span>;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    mask.<a class="code" href="classMultidimArrayBase.html#abc7b530b6ceca036c864f9925332ff5f">printShape</a>();</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Vol        &quot;</span>;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    vol().printShape();</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Proj       &quot;</span>;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    proj().printShape();</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Norm Proj  &quot;</span>;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    norm_proj().printShape();</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;Footprint  &quot;;</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="comment">//footprint().printShape();</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="comment">//std::cout &lt;&lt; std::endl;</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;Footprint2 &quot;;</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="comment">//footprint2().printShape();</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="comment">//std::cout &lt;&lt; std::endl;</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> grid_index(3);</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keywordflow">for</span> (k = ZZ_lowest; k &lt;= ZZ_highest; k++)</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    {</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <span class="comment">// Corner of the row defined by Y</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        beginY = beginZ;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="keywordflow">for</span> (i = YY_lowest; i &lt;= YY_highest; i++)</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        {</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            <span class="comment">// First point in the row</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            actprj = beginY;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            <span class="keywordflow">for</span> (j = XX_lowest; j &lt;= XX_highest; j++)</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            {</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(grid_index, j, i, k);</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;Visiting &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; j &lt;&lt; std::endl;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                <span class="comment">// Be careful that you cannot skip any blob, although its</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                <span class="comment">// value be 0, because it is useful for norm_proj</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                <span class="comment">// unless it doesn&#39;t belong to the reconstruction mask</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(mask, i, j) &amp;&amp; grid.<a class="code" href="classSimpleGrid.html#a994c588b47cb75878dc35dd42d14718f">is_interesting</a>(grid_index))</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                {</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                    <span class="comment">// Look for the position in the deformed projection</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                    <a class="code" href="group__Matrices.html#gaec08782c566ba3c8c093b909f562e953">M2x2_BY_V2x1</a>(defactprj, A, actprj);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                    <span class="comment">// Search for integer corners for this blob</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                    XX_corner1 = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(defactprj) - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(deffootprint_size));</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                    YY_corner1 = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(defactprj) - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(deffootprint_size));</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                    XX_corner2 = <a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(defactprj) + <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(deffootprint_size));</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                    YY_corner2 = <a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(defactprj) + <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(deffootprint_size));</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;  k= &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot; i= &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; j= &quot;</span> &lt;&lt; j &lt;&lt; std::endl;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;  Actual position: &quot;</span> &lt;&lt; actprj.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;  Deformed position: &quot;</span> &lt;&lt; defactprj.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;  Blob corners: (&quot;</span> &lt;&lt; XX_corner1 &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; YY_corner1</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;) (&quot;</span> &lt;&lt; XX_corner2 &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; YY_corner2 &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                    std::cout.flush();</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                    <span class="comment">// Now there is no way that both corners collapse into a line,</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                    <span class="comment">// since the projection points are wrapped</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                    <span class="keywordflow">if</span> (!FORW)</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                        vol_corr = 0;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                    <span class="comment">// Effectively project this blob</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                    <span class="comment">// (xc,yc) is the position of the considered pixel</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                    <span class="comment">// in the crystal undeformed projection</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                    <span class="comment">// When wrapping and deformation are considered then x and</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                    <span class="comment">// y are used</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="preprocessor">#define xc XX(rc)</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="preprocessor">#define yc YY(rc)</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="preprocessor">#define x  XX(r)</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="preprocessor">#define y  YY(r)</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                    <span class="keywordflow">for</span> (<a class="code" href="projection_8cpp.html#afffa29183d9c97e35c9e6b263445fd3e">y</a> = YY_corner1; <a class="code" href="projection_8cpp.html#afffa29183d9c97e35c9e6b263445fd3e">y</a> &lt;= YY_corner2; <a class="code" href="projection_8cpp.html#afffa29183d9c97e35c9e6b263445fd3e">y</a>++)</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                        <span class="keywordflow">for</span> (<a class="code" href="projection_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> = XX_corner1; <a class="code" href="projection_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a> &lt;= XX_corner2; <a class="code" href="projection_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>++)</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                        {</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                            <span class="comment">// Compute position in undeformed space and</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                            <span class="comment">// corresponding sample in the blob footprint</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                            <a class="code" href="group__Matrices.html#gaec08782c566ba3c8c093b909f562e953">M2x2_BY_V2x1</a>(rc, Ainv, r);</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                            <a class="code" href="xmipp__image__over_8h.html#a26486cdc744270937159a9255fd4dd41">OVER2IMG</a>(basis.<a class="code" href="classBasis.html#af8314ea940eb8cacc15fda550ea5c8d3">blobprint</a>, <a class="code" href="projection_8cpp.html#ab1e8fe6c0c8c7b525c7ab029d7d91a09">yc</a> - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(actprj), <a class="code" href="projection_8cpp.html#a53a673a2160df38bb7db83bb2285dfd0">xc</a> - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(actprj),</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                                     foot_V, foot_U);</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                            std::cout &lt;&lt; <span class="stringliteral">&quot;    Studying: &quot;</span> &lt;&lt; r.transpose()</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;--&gt; &quot;</span> &lt;&lt; rc.transpose()</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;dist (&quot;</span> &lt;&lt; <a class="code" href="projection_8cpp.html#a53a673a2160df38bb7db83bb2285dfd0">xc</a> - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(actprj)</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="projection_8cpp.html#ab1e8fe6c0c8c7b525c7ab029d7d91a09">yc</a> - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(actprj) &lt;&lt; <span class="stringliteral">&quot;) --&gt; &quot;</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                            &lt;&lt; foot_U &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; foot_V &lt;&lt; std::endl;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                            std::cout.flush();</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(basis.<a class="code" href="classBasis.html#af8314ea940eb8cacc15fda550ea5c8d3">blobprint</a>).outside(foot_V, foot_U))</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                            <span class="comment">// Wrap positions</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                            <span class="keywordtype">int</span> yw, xw;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                            <a class="code" href="projection_8cpp.html#a25410267ae5c8881fa80cb0267e1c2c9">wrap_as_Crystal</a>(<a class="code" href="projection_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, <a class="code" href="projection_8cpp.html#afffa29183d9c97e35c9e6b263445fd3e">y</a>, xw, yw);</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                            std::cout &lt;&lt; <span class="stringliteral">&quot;      After wrapping &quot;</span> &lt;&lt; xw &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; yw &lt;&lt; std::endl;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                            std::cout &lt;&lt; <span class="stringliteral">&quot;      Value added = &quot;</span> &lt;&lt; <a class="code" href="group__Images.html#ga9b8f3c798427474abfd9070b6f482249">VOLVOXEL</a>(vol, k, i, j) *</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                            <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(basis.<a class="code" href="classBasis.html#af8314ea940eb8cacc15fda550ea5c8d3">blobprint</a>, foot_V, foot_U) &lt;&lt; <span class="stringliteral">&quot; Blob value = &quot;</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                            &lt;&lt; <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(basis.<a class="code" href="classBasis.html#af8314ea940eb8cacc15fda550ea5c8d3">blobprint</a>, foot_V, foot_U)</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; Blob^2 &quot;</span> &lt;&lt; <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(basis.<a class="code" href="classBasis.html#aa98a82b3be7c72135cdd3af50bba7b73">blobprint2</a>, foot_V, foot_U)</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                            &lt;&lt; std::endl;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                            std::cout.flush();</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                            <span class="keywordflow">if</span> (FORW)</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                            {</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                                <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(proj, yw, xw) += <a class="code" href="group__Images.html#ga9b8f3c798427474abfd9070b6f482249">VOLVOXEL</a>(vol, k, i, j) *</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                                                          <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(basis.<a class="code" href="classBasis.html#af8314ea940eb8cacc15fda550ea5c8d3">blobprint</a>, foot_V, foot_U);</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                                <span class="keywordflow">switch</span> (eq_mode)</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                                {</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                                <span class="keywordflow">case</span> <a class="code" href="projection_8h.html#a58501ca6361694382e88cdd054cf0d72">CAVARTK</a>:</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                                <span class="keywordflow">case</span> <a class="code" href="projection_8h.html#a346270884b099bcddb6e6b64d0f10111">ARTK</a>:</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                                    <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(norm_proj, yw, xw) +=</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                                        <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(basis.<a class="code" href="classBasis.html#aa98a82b3be7c72135cdd3af50bba7b73">blobprint2</a>, foot_V, foot_U);</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                                }</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                            }</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                            <span class="keywordflow">else</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                            {</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                                vol_corr += <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(norm_proj, yw, xw) *</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                                            <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(basis.<a class="code" href="classBasis.html#af8314ea940eb8cacc15fda550ea5c8d3">blobprint</a>, foot_V, foot_U);</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                            }</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                        }</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="preprocessor">#ifdef DEBUG_INTERMIDIATE</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                    proj.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;inter.xmp&quot;</span>);</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                    norm_proj.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;inter_norm.xmp&quot;</span>);</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;Press any key\n&quot;</span>;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                    <span class="keywordtype">char</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                    std::cin &gt;&gt; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                    <span class="keywordflow">if</span> (!FORW)</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                        <span class="keywordflow">switch</span> (eq_mode)</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                        {</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="projection_8h.html#a346270884b099bcddb6e6b64d0f10111">ARTK</a>:</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                            <a class="code" href="group__Images.html#ga9b8f3c798427474abfd9070b6f482249">VOLVOXEL</a>(vol, k, i, j) += vol_corr;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="projection_8h.html#a58501ca6361694382e88cdd054cf0d72">CAVARTK</a>:</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                            <a class="code" href="group__Images.html#ga9b8f3c798427474abfd9070b6f482249">VOLVOXEL</a>(vol, k, i, j) += vol_corr / N_eq;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                        }</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                }</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                <span class="comment">// Prepare for next iteration</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                <a class="code" href="group__Vectors.html#ga43b95e9bbf36d0aff1e421a35e113682">V2_PLUS_V2</a>(actprj, actprj, prjX);</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            }</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;            <a class="code" href="group__Vectors.html#ga43b95e9bbf36d0aff1e421a35e113682">V2_PLUS_V2</a>(beginY, beginY, prjY);</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        }</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <a class="code" href="group__Vectors.html#ga43b95e9bbf36d0aff1e421a35e113682">V2_PLUS_V2</a>(beginZ, beginZ, prjZ);</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    }</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="comment">//#define DEBUG_AT_THE_END</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="preprocessor">#ifdef DEBUG_AT_THE_END</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    proj.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;inter.xmp&quot;</span>);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    norm_proj.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;inter_norm.xmp&quot;</span>);</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Press any key\n&quot;</span>;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keywordtype">char</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    std::cin &gt;&gt; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;}</div><div class="ttc" id="classMatrix1D_html_a8849e36416cde2a57914953a815d4b43"><div class="ttname"><a href="classMatrix1D.html#a8849e36416cde2a57914953a815d4b43">Matrix1D::transpose</a></div><div class="ttdeci">Matrix1D&lt; T &gt; transpose() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01466">matrix1d.h:1466</a></div></div>
<div class="ttc" id="projection_8cpp_html_ab1e8fe6c0c8c7b525c7ab029d7d91a09"><div class="ttname"><a href="projection_8cpp.html#ab1e8fe6c0c8c7b525c7ab029d7d91a09">yc</a></div><div class="ttdeci">#define yc</div></div>
<div class="ttc" id="projection_8cpp_html_a151b09680d4024bb8c942ec71983b77f"><div class="ttname"><a href="projection_8cpp.html#a151b09680d4024bb8c942ec71983b77f">yDim</a></div><div class="ttdeci">#define yDim</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l00034">projection.cpp:34</a></div></div>
<div class="ttc" id="group__Images_html_ga9b8f3c798427474abfd9070b6f482249"><div class="ttname"><a href="group__Images.html#ga9b8f3c798427474abfd9070b6f482249">VOLVOXEL</a></div><div class="ttdeci">#define VOLVOXEL(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00204">xmipp_image_base.h:204</a></div></div>
<div class="ttc" id="group__Macros_html_gae0a4180e923e3ffca3989e20e441aa3c"><div class="ttname"><a href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a></div><div class="ttdeci">#define XMIPP_MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00193">xmipp_macros.h:193</a></div></div>
<div class="ttc" id="classSimpleGrid_html_a9b2b5818f2b06e553c3c6a2a6d2a8951"><div class="ttname"><a href="classSimpleGrid.html#a9b2b5818f2b06e553c3c6a2a6d2a8951">SimpleGrid::highest</a></div><div class="ttdeci">Matrix1D&lt; double &gt; highest</div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00160">grids.h:160</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00364">multidim_array.h:364</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="classBasis_html_aa73185836d4dd144f8591d827d8f952ca5e21d65cbd3255eed09cafb1d2ad0143"><div class="ttname"><a href="classBasis.html#aa73185836d4dd144f8591d827d8f952ca5e21d65cbd3255eed09cafb1d2ad0143">Basis::blobs</a></div><div class="ttdef"><b>Definition:</b> <a href="basis_8h_source.html#l00049">basis.h:49</a></div></div>
<div class="ttc" id="projection_8cpp_html_ab17807a5400b7a54607c87513d0edf80"><div class="ttname"><a href="projection_8cpp.html#ab17807a5400b7a54607c87513d0edf80">xDim</a></div><div class="ttdeci">#define xDim</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l00033">projection.cpp:33</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="classSimpleGrid_html_a994c588b47cb75878dc35dd42d14718f"><div class="ttname"><a href="classSimpleGrid.html#a994c588b47cb75878dc35dd42d14718f">SimpleGrid::is_interesting</a></div><div class="ttdeci">bool is_interesting(const Matrix1D&lt; double &gt; &amp;uv) const </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00369">grids.h:369</a></div></div>
<div class="ttc" id="group__FourierProjection_html_gabef83744f4e0571354f31586fb41d357"><div class="ttname"><a href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">Projection::euler</a></div><div class="ttdeci">Matrix2D&lt; double &gt; euler</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00074">fourier_projection.h:74</a></div></div>
<div class="ttc" id="classImageBase_html_ae81a8c11a832924c2bda0909882c3168"><div class="ttname"><a href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">ImageBase::write</a></div><div class="ttdeci">void write(const FileName &amp;name=&quot;&quot;, size_t select_img=ALL_IMAGES, bool isStack=false, int mode=WRITE_OVERWRITE, CastWriteMode castMode=CW_CAST, int _swapWrite=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00210">xmipp_image_base.cpp:210</a></div></div>
<div class="ttc" id="classImageOver_html_a208d4d8e607248a8985d723a736d0dae"><div class="ttname"><a href="classImageOver.html#a208d4d8e607248a8985d723a736d0dae">ImageOver::vmax</a></div><div class="ttdeci">int vmax() const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__over_8h_source.html#l00335">xmipp_image_over.h:335</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00065">multidim_array.h:65</a></div></div>
<div class="ttc" id="classBasis_html_a12a694f7cef08beaf6f7d51b2837432c"><div class="ttname"><a href="classBasis.html#a12a694f7cef08beaf6f7d51b2837432c">Basis::type</a></div><div class="ttdeci">tBasisFunction type</div><div class="ttdoc">Basis function to use. </div><div class="ttdef"><b>Definition:</b> <a href="basis_8h_source.html#l00052">basis.h:52</a></div></div>
<div class="ttc" id="projection_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="projection_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">#define x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02490">numerical_recipes.cpp:2490</a></div></div>
<div class="ttc" id="classBasis_html_aa98a82b3be7c72135cdd3af50bba7b73"><div class="ttname"><a href="classBasis.html#aa98a82b3be7c72135cdd3af50bba7b73">Basis::blobprint2</a></div><div class="ttdeci">ImageOver blobprint2</div><div class="ttdoc">Square of the footprint. </div><div class="ttdef"><b>Definition:</b> <a href="basis_8h_source.html#l00074">basis.h:74</a></div></div>
<div class="ttc" id="group__Images_html_ga6096c97ad2ba182701f4877c206acb94"><div class="ttname"><a href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a></div><div class="ttdeci">#define IMGMATRIX(I)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00171">xmipp_image_base.h:171</a></div></div>
<div class="ttc" id="classSimpleGrid_html_ac11364ea0ab16392eef9db243986bc5a"><div class="ttname"><a href="classSimpleGrid.html#ac11364ea0ab16392eef9db243986bc5a">SimpleGrid::lowest</a></div><div class="ttdeci">Matrix1D&lt; double &gt; lowest</div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00157">grids.h:157</a></div></div>
<div class="ttc" id="group__Vectors_html_ga43b95e9bbf36d0aff1e421a35e113682"><div class="ttname"><a href="group__Vectors.html#ga43b95e9bbf36d0aff1e421a35e113682">V2_PLUS_V2</a></div><div class="ttdeci">#define V2_PLUS_V2(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00137">matrix1d.h:137</a></div></div>
<div class="ttc" id="classImageOver_html_adbd8f34a9b3347029cad356b483ec7a1"><div class="ttname"><a href="classImageOver.html#adbd8f34a9b3347029cad356b483ec7a1">ImageOver::umax</a></div><div class="ttdeci">int umax() const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__over_8h_source.html#l00322">xmipp_image_over.h:322</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Macros_html_ga2f0eecb0f7856721f56faff8f27b0dc1"><div class="ttname"><a href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a></div><div class="ttdeci">#define FLOOR(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00240">xmipp_macros.h:240</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__Matrices_html_gaec08782c566ba3c8c093b909f562e953"><div class="ttname"><a href="group__Matrices.html#gaec08782c566ba3c8c093b909f562e953">M2x2_BY_V2x1</a></div><div class="ttdeci">#define M2x2_BY_V2x1(a, M, b)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00226">matrix2d.h:226</a></div></div>
<div class="ttc" id="primitive__FST_8cpp_html_af9ecdf0e10481a405f601d27aafd8599"><div class="ttname"><a href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a></div><div class="ttdeci">void transpose(double *array, int size)</div><div class="ttdef"><b>Definition:</b> <a href="primitive__FST_8cpp_source.html#l00121">primitive_FST.cpp:121</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="group__Macros_html_ga0714b7b60ab5b804af1c9b124863178e"><div class="ttname"><a href="group__Macros.html#ga0714b7b60ab5b804af1c9b124863178e">SPEED_UP_temps01</a></div><div class="ttdeci">#define SPEED_UP_temps01</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00398">xmipp_macros.h:398</a></div></div>
<div class="ttc" id="projection_8h_html_a58501ca6361694382e88cdd054cf0d72"><div class="ttname"><a href="projection_8h.html#a58501ca6361694382e88cdd054cf0d72">CAVARTK</a></div><div class="ttdeci">#define CAVARTK</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00166">projection.h:166</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_abc7b530b6ceca036c864f9925332ff5f"><div class="ttname"><a href="classMultidimArrayBase.html#abc7b530b6ceca036c864f9925332ff5f">MultidimArrayBase::printShape</a></div><div class="ttdeci">void printShape(std::ostream &amp;out=std::cout) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00281">multidim_array.cpp:281</a></div></div>
<div class="ttc" id="group__Vectors_html_ga97ccb86b4c568b2271da21552034d504"><div class="ttname"><a href="group__Vectors.html#ga97ccb86b4c568b2271da21552034d504">vectorR2</a></div><div class="ttdeci">Matrix1D&lt; double &gt; vectorR2(double x, double y)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8cpp_source.html#l00028">matrix1d.cpp:28</a></div></div>
<div class="ttc" id="projection_8h_html_a346270884b099bcddb6e6b64d0f10111"><div class="ttname"><a href="projection_8h.html#a346270884b099bcddb6e6b64d0f10111">ARTK</a></div><div class="ttdeci">#define ARTK</div><div class="ttdef"><b>Definition:</b> <a href="projection_8h_source.html#l00162">projection.h:162</a></div></div>
<div class="ttc" id="group__Macros_html_gac9ae6a207f10c821b06a8c0df153a7d5"><div class="ttname"><a href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a></div><div class="ttdeci">#define XMIPP_MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00181">xmipp_macros.h:181</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="group__Matrices_html_ga74d7e752302a7af72125514181123234"><div class="ttname"><a href="group__Matrices.html#ga74d7e752302a7af72125514181123234">M2x2_BY_CT</a></div><div class="ttdeci">#define M2x2_BY_CT(M2, M1, k)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00238">matrix2d.h:238</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00073">multidim_array.h:73</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="projection_8cpp_html_afffa29183d9c97e35c9e6b263445fd3e"><div class="ttname"><a href="projection_8cpp.html#afffa29183d9c97e35c9e6b263445fd3e">y</a></div><div class="ttdeci">#define y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08527">numerical_recipes.cpp:8527</a></div></div>
<div class="ttc" id="classSimpleGrid_html_a2eb28005f2a2af28ca2fab40772a2561"><div class="ttname"><a href="classSimpleGrid.html#a2eb28005f2a2af28ca2fab40772a2561">SimpleGrid::origin</a></div><div class="ttdeci">Matrix1D&lt; double &gt; origin</div><div class="ttdoc">Origin of the grid in the Universal coordinate system. </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00164">grids.h:164</a></div></div>
<div class="ttc" id="classSimpleGrid_html_a9d9d55f6ddeb12f700f090fe74dd1652"><div class="ttname"><a href="classSimpleGrid.html#a9d9d55f6ddeb12f700f090fe74dd1652">SimpleGrid::Gdir_project_to_plane</a></div><div class="ttdeci">void Gdir_project_to_plane(const Matrix1D&lt; double &gt; &amp;gr, double rot, double tilt, double psi, Matrix1D&lt; double &gt; &amp;result) const </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00440">grids.h:440</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="group__Geometry_html_gaa0889ad000c2166f766c927fc7c2f58c"><div class="ttname"><a href="group__Geometry.html#gaa0889ad000c2166f766c927fc7c2f58c">Euler_matrix2angles</a></div><div class="ttdeci">void Euler_matrix2angles(const Matrix2D&lt; double &gt; &amp;A, double &amp;alpha, double &amp;beta, double &amp;gamma, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00836">geometry.cpp:836</a></div></div>
<div class="ttc" id="group__Vectors_html_ga6c6b4d4f88daca5e1d8e171bec3b4af0"><div class="ttname"><a href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a></div><div class="ttdeci">#define VECTOR_R3(v, x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00127">matrix1d.h:127</a></div></div>
<div class="ttc" id="xmipp__image__over_8h_html_a26486cdc744270937159a9255fd4dd41"><div class="ttname"><a href="xmipp__image__over_8h.html#a26486cdc744270937159a9255fd4dd41">OVER2IMG</a></div><div class="ttdeci">#define OVER2IMG(IO, v, u, iv, iu)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__over_8h_source.html#l00196">xmipp_image_over.h:196</a></div></div>
<div class="ttc" id="projection_8cpp_html_a25410267ae5c8881fa80cb0267e1c2c9"><div class="ttname"><a href="projection_8cpp.html#a25410267ae5c8881fa80cb0267e1c2c9">wrap_as_Crystal</a></div><div class="ttdeci">#define wrap_as_Crystal(x, y, xw, yw)</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l00747">projection.cpp:747</a></div></div>
<div class="ttc" id="group__Matrices_html_ga94eb0766edba2c7042e6db51141ce02b"><div class="ttname"><a href="group__Matrices.html#ga94eb0766edba2c7042e6db51141ce02b">M2x2_INV</a></div><div class="ttdeci">#define M2x2_INV(Ainv, A)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00287">matrix2d.h:287</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a></div><div class="ttdoc">Incorrect value received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00200">xmipp_error.h:200</a></div></div>
<div class="ttc" id="group__Geometry_html_gade8f7976e3d84a594d4728bf8f4c029e"><div class="ttname"><a href="group__Geometry.html#gade8f7976e3d84a594d4728bf8f4c029e">Uproject_to_plane</a></div><div class="ttdeci">void Uproject_to_plane(const Matrix1D&lt; double &gt; &amp;point, const Matrix1D&lt; double &gt; &amp;direction, double distance, Matrix1D&lt; double &gt; &amp;result)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00038">geometry.cpp:38</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a046e290d67d4e9e20547aae0fab90070"><div class="ttname"><a href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a></div><div class="ttdeci">double fmax</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05183">numerical_recipes.cpp:5183</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="group__Images_html_gaad11fc7e221702e9f1adeb445ba5db9c"><div class="ttname"><a href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a></div><div class="ttdeci">#define IMGPIXEL(I, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00176">xmipp_image_base.h:176</a></div></div>
<div class="ttc" id="classBasis_html_af8314ea940eb8cacc15fda550ea5c8d3"><div class="ttname"><a href="classBasis.html#af8314ea940eb8cacc15fda550ea5c8d3">Basis::blobprint</a></div><div class="ttdeci">ImageOver blobprint</div><div class="ttdoc">Blob footprint. </div><div class="ttdef"><b>Definition:</b> <a href="basis_8h_source.html#l00071">basis.h:71</a></div></div>
<div class="ttc" id="projection_8cpp_html_a53a673a2160df38bb7db83bb2285dfd0"><div class="ttname"><a href="projection_8cpp.html#a53a673a2160df38bb7db83bb2285dfd0">xc</a></div><div class="ttdeci">#define xc</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2637994d6a53467e26f07e5a6568d9c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void project_Crystal_Volume </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__Grids.html#gae3eeb15b316a9800a7c35372dfd57460">GridVolume</a> &amp;&#160;</td>
          <td class="paramname"><em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBasis.html">Basis</a> &amp;&#160;</td>
          <td class="paramname"><em>basis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>proj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>norm_proj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>aint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>bint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Dinv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>FORW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>eq_mode</em> = <code><a class="el" href="projection_8h.html#a346270884b099bcddb6e6b64d0f10111">ARTK</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Project a crystal basis volume. This function projects a crystal deformed basis volume, ie, in the documentation volume g. However the angles given must be those for volume f, the undeformed one. You must supply the deformed lattice vectors, and the matrix to pass from the deformed to the undeformed vectors (D and Dinv). a=D*ai;</p>
<p>Valid eq_modes are ARTK, CAVARTK and CAV. </p>

<p>Definition at line <a class="el" href="projection_8cpp_source.html#l01124">1124</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;{</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="comment">// If projecting forward initialise projections</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <span class="keywordflow">if</span> (FORW)</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    {</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        proj.<a class="code" href="group__FourierProjection.html#ga0996d67a36d07d6eb3373022c24c7952">reset</a>(Ydim, Xdim);</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        proj.<a class="code" href="group__FourierProjection.html#ga38fc7e819f167ed62bf63c13e1058aab">setAngles</a>(rot, tilt, <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>);</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        norm_proj().resize(proj());</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    }</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="comment">// Project each subvolume</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; vol.<a class="code" href="classGridVolumeT.html#a8273923cc41926a2c0a65ab8dd2eadff">VolumesNo</a>(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    {</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        <a class="code" href="projection_8cpp.html#a5822d132674cef78f61512b773206e12">project_Crystal_SimpleGrid</a>(vol(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>), vol.<a class="code" href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">grid</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>), basis,</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                                   proj, norm_proj, shift, aint, bint, D, Dinv, mask, FORW, eq_mode);</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        <a class="code" href="classImage.html">Image&lt;double&gt;</a> save;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        save = norm_proj;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <span class="keywordflow">if</span> (FORW)</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            save.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>((<a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a>)<span class="stringliteral">&quot;PPPnorm_FORW&quot;</span> + (<span class="keywordtype">char</span>)(48 + <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            save.write((<a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a>)<span class="stringliteral">&quot;PPPnorm_BACK&quot;</span> + (<span class="keywordtype">char</span>)(48 + <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    }</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;}</div><div class="ttc" id="group__FourierProjection_html_ga0996d67a36d07d6eb3373022c24c7952"><div class="ttname"><a href="group__FourierProjection.html#ga0996d67a36d07d6eb3373022c24c7952">Projection::reset</a></div><div class="ttdeci">void reset(int Ydim, int Xdim)</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8cpp_source.html#l00034">fourier_projection.cpp:34</a></div></div>
<div class="ttc" id="projection_8cpp_html_a5822d132674cef78f61512b773206e12"><div class="ttname"><a href="projection_8cpp.html#a5822d132674cef78f61512b773206e12">project_Crystal_SimpleGrid</a></div><div class="ttdeci">void project_Crystal_SimpleGrid(Image&lt; double &gt; &amp;vol, const SimpleGrid &amp;grid, const Basis &amp;basis, Projection &amp;proj, Projection &amp;norm_proj, const Matrix1D&lt; double &gt; &amp;shift, const Matrix1D&lt; double &gt; &amp;aint, const Matrix1D&lt; double &gt; &amp;bint, const Matrix2D&lt; double &gt; &amp;D, const Matrix2D&lt; double &gt; &amp;Dinv, const MultidimArray&lt; int &gt; &amp;mask, int FORW, int eq_mode)</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l00751">projection.cpp:751</a></div></div>
<div class="ttc" id="namespacetesting_1_1internal_html_a8e8ff5b11e64078831112677156cb111"><div class="ttname"><a href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">testing::internal::string</a></div><div class="ttdeci">::std::string string</div><div class="ttdef"><b>Definition:</b> <a href="gtest_8h_source.html#l01818">gtest.h:1818</a></div></div>
<div class="ttc" id="classImageBase_html_ae81a8c11a832924c2bda0909882c3168"><div class="ttname"><a href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">ImageBase::write</a></div><div class="ttdeci">void write(const FileName &amp;name=&quot;&quot;, size_t select_img=ALL_IMAGES, bool isStack=false, int mode=WRITE_OVERWRITE, CastWriteMode castMode=CW_CAST, int _swapWrite=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00210">xmipp_image_base.cpp:210</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classGridVolumeT_html_a15c952085d4d666a36edd51858c90d0a"><div class="ttname"><a href="classGridVolumeT.html#a15c952085d4d666a36edd51858c90d0a">GridVolumeT::grid</a></div><div class="ttdeci">const SimpleGrid &amp; grid(size_t n) const </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l00991">grids.h:991</a></div></div>
<div class="ttc" id="classGridVolumeT_html_a8273923cc41926a2c0a65ab8dd2eadff"><div class="ttname"><a href="classGridVolumeT.html#a8273923cc41926a2c0a65ab8dd2eadff">GridVolumeT::VolumesNo</a></div><div class="ttdeci">size_t VolumesNo() const </div><div class="ttdef"><b>Definition:</b> <a href="grids_8h_source.html#l01016">grids.h:1016</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="group__FourierProjection_html_ga38fc7e819f167ed62bf63c13e1058aab"><div class="ttname"><a href="group__FourierProjection.html#ga38fc7e819f167ed62bf63c13e1058aab">Projection::setAngles</a></div><div class="ttdeci">void setAngles(double _rot, double _tilt, double _psi)</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8cpp_source.html#l00041">fourier_projection.cpp:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2d518daea4ed16be8fb7fc8038929813"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void projectVolume </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>roffset</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>From voxel volumes. The voxel volume is projected onto a projection plane defined by (rot, tilt, psi) (1st, 2nd and 3rd <a class="el" href="classEuler.html">Euler</a> angles) . The projection is previously is resized to Ydim x Xdim and initialized to 0. The projection itself, from now on, will keep the <a class="el" href="classEuler.html">Euler</a> angles.</p>
<p>The offset is a 3D vector specifying the offset that must be applied when going from the projection space to the universal space</p>
<p>rproj=E*r+roffset =&gt; r=E^t (rproj-roffset)</p>
<p>Set it to NULL if you don't want to use it </p>

<p>Definition at line <a class="el" href="projection_8cpp_source.html#l00326">326</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;{</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">// Initialise projection</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    P.<a class="code" href="group__FourierProjection.html#ga0996d67a36d07d6eb3373022c24c7952">reset</a>(Ydim, Xdim);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    P.<a class="code" href="group__FourierProjection.html#ga38fc7e819f167ed62bf63c13e1058aab">setAngles</a>(rot, tilt, <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">// Compute the distance for this line crossing one voxel</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordtype">int</span> x_0 = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(V), x_F = <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(V);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordtype">int</span> y_0 = <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(V), y_F = <a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(V);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordtype">int</span> z_0 = <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(V), z_F = <a class="code" href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(V);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// Distances in X and Y between the center of the projection pixel begin</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">// computed and each computed ray</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordtype">double</span> step = 1.0 / 3.0;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// Avoids divisions by zero and allows orthogonal rays computation</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) == 0)</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) = <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) == 0)</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) = <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) == 0)</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) = <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">// Some precalculated variables</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordtype">int</span> x_sign = <a class="code" href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>));</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordtype">int</span> y_sign = <a class="code" href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>));</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordtype">int</span> z_sign = <a class="code" href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a>(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>));</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordtype">double</span> half_x_sign = 0.5 * x_sign;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordtype">double</span> half_y_sign = 0.5 * y_sign;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordtype">double</span> half_z_sign = 0.5 * z_sign;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordtype">double</span> iXXP_direction=1.0/<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordtype">double</span> iYYP_direction=1.0/<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordtype">double</span> iZZP_direction=1.0/<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;mP = P();</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a>  v(3);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> r_p(3); <span class="comment">// r_p are the coordinates of the</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">// pixel being projected in the</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">// coordinate system attached to the</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">// projection</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> p1(3);  <span class="comment">// coordinates of the pixel in the</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">// universal space</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> p1_shifted(3); <span class="comment">// shifted half a pixel</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(mP)</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    {</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordtype">double</span> ray_sum = 0.0;    <span class="comment">// Line integral value</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="comment">// Computes 4 different rays for each pixel.</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rays_per_pixel = 0; rays_per_pixel &lt; 4; rays_per_pixel++)</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        {</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="comment">// universal coordinate system</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <span class="keywordflow">switch</span> (rays_per_pixel)</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            {</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(r_p, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - step, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - step, 0);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(r_p, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> - step, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + step, 0);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(r_p, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + step, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - step, 0);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(r_p, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> + step, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + step, 0);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="comment">// Express r_p in the universal coordinate system</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="keywordflow">if</span> (roffset!=NULL)</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                r_p-=*roffset;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            <a class="code" href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a>(p1, P.<a class="code" href="group__FourierProjection.html#ga7c0ae2d78ba098df1b33115e94918f18">eulert</a>, r_p);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p1_shifted)=<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p1)-half_x_sign;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p1_shifted)=<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p1)-half_y_sign;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(p1_shifted)=<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(p1)-half_z_sign;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="comment">// Compute the minimum and maximum alpha for the ray</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <span class="comment">// intersecting the given volume</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            <span class="keywordtype">double</span> alpha_xmin = (x_0 - 0.5 - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p1))* iXXP_direction;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <span class="keywordtype">double</span> alpha_xmax = (x_F + 0.5 - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p1))* iXXP_direction;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            <span class="keywordtype">double</span> alpha_ymin = (y_0 - 0.5 - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p1))* iYYP_direction;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            <span class="keywordtype">double</span> alpha_ymax = (y_F + 0.5 - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p1))* iYYP_direction;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            <span class="keywordtype">double</span> alpha_zmin = (z_0 - 0.5 - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(p1))* iZZP_direction;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="keywordtype">double</span> alpha_zmax = (z_F + 0.5 - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(p1))* iZZP_direction;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <span class="keywordtype">double</span> auxMin, auxMax;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <span class="keywordflow">if</span> (alpha_xmin&lt;alpha_xmax)</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                auxMin=alpha_xmin;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                auxMax=alpha_xmax;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            }</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            {</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                auxMin=alpha_xmax;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                auxMax=alpha_xmin;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            }</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            <span class="keywordtype">double</span> alpha_min=auxMin;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="keywordtype">double</span> alpha_max=auxMax;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="keywordflow">if</span> (alpha_ymin&lt;alpha_ymax)</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                auxMin=alpha_ymin;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                auxMax=alpha_ymax;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            {</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                auxMin=alpha_ymax;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                auxMax=alpha_ymin;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            }</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            alpha_min=<a class="code" href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a>(auxMin,alpha_min);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            alpha_max=fmin(auxMax,alpha_max);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <span class="keywordflow">if</span> (alpha_zmin&lt;alpha_zmax)</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            {</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                auxMin=alpha_zmin;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                auxMax=alpha_zmax;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            }</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            {</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                auxMin=alpha_zmax;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                auxMax=alpha_zmin;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            }</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            alpha_min=<a class="code" href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a>(auxMin,alpha_min);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            alpha_max=fmin(auxMax,alpha_max);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            <span class="keywordflow">if</span> (alpha_max - alpha_min &lt; <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>)</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Pixel:  &quot;</span> &lt;&lt; r_p.transpose() &lt;&lt; std::endl</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Univ:   &quot;</span> &lt;&lt; p1.transpose() &lt;&lt; std::endl</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Dir:    &quot;</span> &lt;&lt; P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>.<a class="code" href="classMatrix1D.html#a8849e36416cde2a57914953a815d4b43">transpose</a>() &lt;&lt; std::endl</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Alpha x:&quot;</span> &lt;&lt; alpha_xmin &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; alpha_xmax &lt;&lt; std::endl</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; (p1 + alpha_xmin*P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>).<a class="code" href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a>() &lt;&lt; std::endl</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; (p1 + alpha_xmax*P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>).<a class="code" href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a>() &lt;&lt; std::endl</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Alpha y:&quot;</span> &lt;&lt; alpha_ymin &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; alpha_ymax &lt;&lt; std::endl</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; (p1 + alpha_ymin*P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>).<a class="code" href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a>() &lt;&lt; std::endl</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; (p1 + alpha_ymax*P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>).<a class="code" href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a>() &lt;&lt; std::endl</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Alpha z:&quot;</span> &lt;&lt; alpha_zmin &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; alpha_zmax &lt;&lt; std::endl</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; (p1 + alpha_zmin*P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>).<a class="code" href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a>() &lt;&lt; std::endl</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; (p1 + alpha_zmax*P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>).<a class="code" href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a>() &lt;&lt; std::endl</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;alpha  :&quot;</span> &lt;&lt; alpha_min  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; alpha_max  &lt;&lt; std::endl</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            &lt;&lt; std::endl;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="comment">// Compute the first point in the volume intersecting the ray</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="keywordtype">double</span> zz_idxd, yy_idxd, xx_idxd;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <span class="keywordtype">int</span>    zz_idx , yy_idx , xx_idx;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <a class="code" href="group__Vectors.html#ga0c31197d639e9b7b7b8abe4eaebbaa5b">V3_BY_CT</a>(v, P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>, alpha_min);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            <a class="code" href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a>(v, p1, v);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="comment">// Compute the index of the first voxel</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            xx_idx = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(v));</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            yy_idx = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(v));</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            zz_idx = <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(v));</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            xx_idxd = xx_idx = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(xx_idx, x_0, x_F);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            yy_idxd = yy_idx = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(yy_idx, y_0, y_F);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            zz_idxd = zz_idx = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(zz_idx, z_0, z_F);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;First voxel: &quot;</span> &lt;&lt; v.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;   First index: &quot;</span> &lt;&lt; idx.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;   Alpha_min: &quot;</span> &lt;&lt; alpha_min &lt;&lt; std::endl;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            <span class="comment">// Follow the ray</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="structblobtype.html#ae713f8fc66da6e18d0bc2ff381bda22f">alpha</a> = alpha_min;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            <span class="keywordflow">do</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            {</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot; \n\nCurrent Value: &quot;</span> &lt;&lt; V(zz_idx, yy_idx, xx_idx) &lt;&lt; std::endl;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                <span class="keywordtype">double</span> alpha_x = (xx_idxd - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p1_shifted))* iXXP_direction;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                <span class="keywordtype">double</span> alpha_y = (yy_idxd - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p1_shifted))* iYYP_direction;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                <span class="keywordtype">double</span> alpha_z = (zz_idxd - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(p1_shifted))* iZZP_direction;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                <span class="comment">// Which dimension will ray move next step into?, it isn&#39;t necessary to be only</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                <span class="comment">// one.</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                <span class="keywordtype">double</span> diffx = fabs(alpha-alpha_x);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                <span class="keywordtype">double</span> diffy = fabs(alpha-alpha_y);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                <span class="keywordtype">double</span> diffz = fabs(alpha-alpha_z);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                <span class="keywordtype">int</span> diff_source=0;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                <span class="keywordtype">double</span> diff_alpha=diffx;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                <span class="keywordflow">if</span> (diffy&lt;diff_alpha)</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                {</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                    diff_source=1;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                    diff_alpha=diffy;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                }</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                <span class="keywordflow">if</span> (diffz&lt;diff_alpha)</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                {</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                    diff_source=2;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                    diff_alpha=diffz;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                }</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                ray_sum += diff_alpha * <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(V, zz_idx, yy_idx, xx_idx);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                <span class="keywordflow">switch</span> (diff_source)</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                {</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                    alpha = alpha_x;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                    xx_idx += x_sign;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                    xx_idxd = xx_idx;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                    alpha = alpha_y;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                    yy_idx += y_sign;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                    yy_idxd = yy_idx;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                <span class="keywordflow">default</span>:</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                    alpha = alpha_z;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                    zz_idx += z_sign;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                    zz_idxd = zz_idx;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                }</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;Alpha x,y,z: &quot;</span> &lt;&lt; alpha_x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; alpha_y</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; alpha_z &lt;&lt; <span class="stringliteral">&quot; ---&gt; &quot;</span> &lt;&lt; alpha &lt;&lt; std::endl;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(v) += diff_alpha * <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(v) += diff_alpha * <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(v) += diff_alpha * <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;    Next entry point: &quot;</span> &lt;&lt; v.transpose() &lt;&lt; std::endl</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;    Index: &quot;</span> &lt;&lt; idx.transpose() &lt;&lt; std::endl</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;    diff_alpha: &quot;</span> &lt;&lt; diff_alpha &lt;&lt; std::endl</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;    ray_sum: &quot;</span> &lt;&lt; ray_sum &lt;&lt; std::endl</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;    Alfa tot: &quot;</span> &lt;&lt; alpha &lt;&lt; <span class="stringliteral">&quot;alpha_max: &quot;</span> &lt;&lt; alpha_max &lt;&lt;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                std::endl;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            }</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            <span class="keywordflow">while</span> ((alpha_max - alpha) &gt; <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        } <span class="comment">// for</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(<a class="code" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(P), <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = ray_sum * 0.25;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Assigning P(&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt;&lt; <span class="stringliteral">&quot;)=&quot;</span> &lt;&lt; ray_sum &lt;&lt; std::endl;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    }</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;}</div><div class="ttc" id="group__FourierProjection_html_ga7c0ae2d78ba098df1b33115e94918f18"><div class="ttname"><a href="group__FourierProjection.html#ga7c0ae2d78ba098df1b33115e94918f18">Projection::eulert</a></div><div class="ttdeci">Matrix2D&lt; double &gt; eulert</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00082">fourier_projection.h:82</a></div></div>
<div class="ttc" id="classMatrix1D_html_a8849e36416cde2a57914953a815d4b43"><div class="ttname"><a href="classMatrix1D.html#a8849e36416cde2a57914953a815d4b43">Matrix1D::transpose</a></div><div class="ttdeci">Matrix1D&lt; T &gt; transpose() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01466">matrix1d.h:1466</a></div></div>
<div class="ttc" id="structblobtype_html_ae713f8fc66da6e18d0bc2ff381bda22f"><div class="ttname"><a href="structblobtype.html#ae713f8fc66da6e18d0bc2ff381bda22f">blobtype::alpha</a></div><div class="ttdeci">double alpha</div><div class="ttdoc">Smoothness parameter. </div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00122">blobs.h:122</a></div></div>
<div class="ttc" id="group__FourierProjection_html_ga0996d67a36d07d6eb3373022c24c7952"><div class="ttname"><a href="group__FourierProjection.html#ga0996d67a36d07d6eb3373022c24c7952">Projection::reset</a></div><div class="ttdeci">void reset(int Ydim, int Xdim)</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8cpp_source.html#l00034">fourier_projection.cpp:34</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00364">multidim_array.h:364</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga706d2ce724d393d4d759a46225bbc6c1"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a></div><div class="ttdeci">#define FINISHINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00081">multidim_array.h:81</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00065">multidim_array.h:65</a></div></div>
<div class="ttc" id="group__Images_html_ga6096c97ad2ba182701f4877c206acb94"><div class="ttname"><a href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a></div><div class="ttdeci">#define IMGMATRIX(I)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00171">xmipp_image_base.h:171</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Macros_html_gad4d08cca0a39849cc247072eaebe7726"><div class="ttname"><a href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a></div><div class="ttdeci">#define CLIP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00260">xmipp_macros.h:260</a></div></div>
<div class="ttc" id="group__Vectors_html_ga0c31197d639e9b7b7b8abe4eaebbaa5b"><div class="ttname"><a href="group__Vectors.html#ga0c31197d639e9b7b7b8abe4eaebbaa5b">V3_BY_CT</a></div><div class="ttdeci">#define V3_BY_CT(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00241">matrix1d.h:241</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="primitive__FST_8cpp_html_af9ecdf0e10481a405f601d27aafd8599"><div class="ttname"><a href="primitive__FST_8cpp.html#af9ecdf0e10481a405f601d27aafd8599">transpose</a></div><div class="ttdeci">void transpose(double *array, int size)</div><div class="ttdef"><b>Definition:</b> <a href="primitive__FST_8cpp_source.html#l00121">primitive_FST.cpp:121</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00400">multidim_array.h:400</a></div></div>
<div class="ttc" id="group__Macros_html_gad584f97e936242b173add43261376ba5"><div class="ttname"><a href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a></div><div class="ttdeci">#define XMIPP_EQUAL_ACCURACY</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00119">xmipp_macros.h:119</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="group__FourierProjection_html_ga532f6713fbe228d3ee30f4d3a2766a20"><div class="ttname"><a href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">Projection::direction</a></div><div class="ttdeci">Matrix1D&lt; double &gt; direction</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00065">fourier_projection.h:65</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Matrices_html_gad159332322d687de886a720422e4b757"><div class="ttname"><a href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a></div><div class="ttdeci">#define M3x3_BY_V3x1(a, M, b)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00171">matrix2d.h:171</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00073">multidim_array.h:73</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="group__Vectors_html_ga6c6b4d4f88daca5e1d8e171bec3b4af0"><div class="ttname"><a href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a></div><div class="ttdeci">#define VECTOR_R3(v, x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00127">matrix1d.h:127</a></div></div>
<div class="ttc" id="group__FourierProjection_html_ga38fc7e819f167ed62bf63c13e1058aab"><div class="ttname"><a href="group__FourierProjection.html#ga38fc7e819f167ed62bf63c13e1058aab">Projection::setAngles</a></div><div class="ttdeci">void setAngles(double _rot, double _tilt, double _psi)</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8cpp_source.html#l00041">fourier_projection.cpp:41</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a046e290d67d4e9e20547aae0fab90070"><div class="ttname"><a href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a></div><div class="ttdeci">double fmax</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05183">numerical_recipes.cpp:5183</a></div></div>
<div class="ttc" id="group__Macros_html_ga95ed41486ca0ed53262e4b8934d4afac"><div class="ttname"><a href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a></div><div class="ttdeci">#define SGN(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00155">xmipp_macros.h:155</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="group__Vectors_html_gafe748b92e8aeaa282eb7bafbd2baca37"><div class="ttname"><a href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a></div><div class="ttdeci">#define V3_PLUS_V3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00193">matrix1d.h:193</a></div></div>
<div class="ttc" id="group__Macros_html_ga20716e3da0ba25d3c4c9a2421573391f"><div class="ttname"><a href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a></div><div class="ttdeci">#define SPEED_UP_temps012</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00403">xmipp_macros.h:403</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a125751740b29feb4f536731abe705b6a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void projectVolumeOffCentered </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>From voxel volumes, off-centered tilt axis. This routine projects a volume that is rotating (angle) degrees around the axis defined by the two angles (axisRot,axisTilt) and that passes through the point raxis. The projection can be further inplane rotated and shifted through the parameters (inplaneRot) and (rinplane).</p>
<p>All vectors involved must be 3D.</p>
<p>The projection model is rproj=H Rinplane Raxis r + Rinplane (I-Raxis) raxis + rinplane</p>
<p>Where Raxis is the 3D rotation matrix given by the axis and the angle. </p>

<p>Definition at line <a class="el" href="projection_8cpp_source.html#l00575">575</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;{</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> roffset(3);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    P.<a class="code" href="classImageBase.html#a3964353e84f19595f0f14fb34561e31e">getShifts</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(roffset), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(roffset), <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(roffset));</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <a class="code" href="projection_8cpp.html#a2d518daea4ed16be8fb7fc8038929813">projectVolume</a>(V, P, Ydim, Xdim, P.<a class="code" href="classImageBase.html#a13fcf9a8cfa4f71952ec2fa8e65e1de3">rot</a>(), P.<a class="code" href="classImageBase.html#a3782bd402af72b87daaf60b1ecedac5a">tilt</a>(), P.<a class="code" href="classImageBase.html#a2a29e596597eb3fa6d1c185dfa14aa9e">psi</a>(), &amp;roffset);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;}</div><div class="ttc" id="projection_8cpp_html_a2d518daea4ed16be8fb7fc8038929813"><div class="ttname"><a href="projection_8cpp.html#a2d518daea4ed16be8fb7fc8038929813">projectVolume</a></div><div class="ttdeci">void projectVolume(MultidimArray&lt; double &gt; &amp;V, Projection &amp;P, int Ydim, int Xdim, double rot, double tilt, double psi, const Matrix1D&lt; double &gt; *roffset)</div><div class="ttdef"><b>Definition:</b> <a href="projection_8cpp_source.html#l00326">projection.cpp:326</a></div></div>
<div class="ttc" id="classImageBase_html_a3782bd402af72b87daaf60b1ecedac5a"><div class="ttname"><a href="classImageBase.html#a3782bd402af72b87daaf60b1ecedac5a">ImageBase::tilt</a></div><div class="ttdeci">double tilt(const size_t n=0) const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00296">xmipp_image_base.cpp:296</a></div></div>
<div class="ttc" id="classImageBase_html_a13fcf9a8cfa4f71952ec2fa8e65e1de3"><div class="ttname"><a href="classImageBase.html#a13fcf9a8cfa4f71952ec2fa8e65e1de3">ImageBase::rot</a></div><div class="ttdeci">double rot(const size_t n=0) const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00283">xmipp_image_base.cpp:283</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="classImageBase_html_a2a29e596597eb3fa6d1c185dfa14aa9e"><div class="ttname"><a href="classImageBase.html#a2a29e596597eb3fa6d1c185dfa14aa9e">ImageBase::psi</a></div><div class="ttdeci">double psi(const size_t n=0) const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00309">xmipp_image_base.cpp:309</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="classImageBase_html_a3964353e84f19595f0f14fb34561e31e"><div class="ttname"><a href="classImageBase.html#a3964353e84f19595f0f14fb34561e31e">ImageBase::getShifts</a></div><div class="ttdeci">void getShifts(double &amp;xoff, double &amp;yoff, double &amp;zoff, const size_t n=0) const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00455">xmipp_image_base.cpp:455</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afaefa09ed28fafff7cf217bfe29f1efe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void singleWBP </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>P</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Single Weighted Back <a class="el" href="classProjection.html">Projection</a>. Projects a single particle into a voxels volume by updating its components this way: Voxel(i,j,k) = Voxel(i,j,k) + Pixel( x,y) * Distance.</p>
<p>Where:</p>
<ul>
<li>Voxel(i,j,k) is the voxel the ray is crossing.</li>
<li>Pixel( y,z ) is the value of the pixel where the ray departs from.</li>
<li>Distance is the distance the ray goes through the Voxel. </li>
</ul>

<p>Definition at line <a class="el" href="projection_8cpp_source.html#l00590">590</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;{</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <a class="code" href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a>;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">// Compute the distance for this line crossing one voxel</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordtype">int</span> x_0 = <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(V), x_F = <a class="code" href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(V);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordtype">int</span> y_0 = <a class="code" href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(V), y_F = <a class="code" href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(V);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordtype">int</span> z_0 = <a class="code" href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a>(V), z_F = <a class="code" href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a>(V);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="comment">// Avoids divisions by zero and allows orthogonal rays computation</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) == 0)</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) = <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) == 0)</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) = <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) == 0)</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>) = <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="comment">// Some precalculated variables</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keywordtype">int</span> x_sign = <a class="code" href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>));</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordtype">int</span> y_sign = <a class="code" href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>));</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordtype">int</span> z_sign = <a class="code" href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a>(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>));</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordtype">double</span> half_x_sign = 0.5 * x_sign;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordtype">double</span> half_y_sign = 0.5 * y_sign;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordtype">double</span> half_z_sign = 0.5 * z_sign;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;mP = P();</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> r_p(3); <span class="comment">// r_p are the coordinates of the</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="comment">// pixel being projected in the</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="comment">// coordinate system attached to the</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="comment">// projection</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> p1(3);  <span class="comment">// coordinates of the pixel in the</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a>  v(3);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a>    idx(3);</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(mP)</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    {</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="comment">// Computes 4 different rays for each pixel.</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(r_p, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, 0);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <span class="comment">// Express r_p in the universal coordinate system</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <a class="code" href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a>(p1, P.<a class="code" href="group__FourierProjection.html#ga7c0ae2d78ba098df1b33115e94918f18">eulert</a>, r_p);</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="comment">// Compute the minimum and maximum alpha for the ray</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="comment">// intersecting the given volume</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="keywordtype">double</span> alpha_xmin = (x_0 - 0.5 - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p1)) / <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <span class="keywordtype">double</span> alpha_xmax = (x_F + 0.5 - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p1)) / <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="keywordtype">double</span> alpha_ymin = (y_0 - 0.5 - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p1)) / <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="keywordtype">double</span> alpha_ymax = (y_F + 0.5 - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p1)) / <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <span class="keywordtype">double</span> alpha_zmin = (z_0 - 0.5 - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(p1)) / <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="keywordtype">double</span> alpha_zmax = (z_F + 0.5 - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(p1)) / <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="keywordtype">double</span> alpha_min = <a class="code" href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a>(fmin(alpha_xmin, alpha_xmax),</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                                fmin(alpha_ymin, alpha_ymax));</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        alpha_min = <a class="code" href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a>(alpha_min, fmin(alpha_zmin, alpha_zmax));</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="keywordtype">double</span> alpha_max = fmin(<a class="code" href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a>(alpha_xmin, alpha_xmax),</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                                <a class="code" href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a>(alpha_ymin, alpha_ymax));</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        alpha_max = fmin(alpha_max, <a class="code" href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a>(alpha_zmin, alpha_zmax));</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <span class="keywordflow">if</span> (alpha_max - alpha_min &lt; <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>)</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="comment">// Compute the first point in the volume intersecting the ray</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <a class="code" href="group__Vectors.html#ga0c31197d639e9b7b7b8abe4eaebbaa5b">V3_BY_CT</a>(v, P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>, alpha_min);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <a class="code" href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a>(v, p1, v);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <span class="comment">// Compute the index of the first voxel</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(idx) = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(v)), x_0, x_F);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(idx) = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(v)), y_0, y_F);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(idx) = <a class="code" href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a>(<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(v)), z_0, z_F);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;First voxel: &quot;</span> &lt;&lt; v.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;   First index: &quot;</span> &lt;&lt; idx.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;   Alpha_min: &quot;</span> &lt;&lt; alpha_min &lt;&lt; std::endl;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="comment">// Follow the ray</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structblobtype.html#ae713f8fc66da6e18d0bc2ff381bda22f">alpha</a> = alpha_min;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="keywordflow">do</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot; \n\nCurrent Value: &quot;</span> &lt;&lt; V(<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(idx), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(idx), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(idx)) &lt;&lt; std::endl;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            <span class="keywordtype">double</span> alpha_x = (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(idx) + half_x_sign - <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p1)) / <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            <span class="keywordtype">double</span> alpha_y = (<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(idx) + half_y_sign - <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p1)) / <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            <span class="keywordtype">double</span> alpha_z = (<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(idx) + half_z_sign - <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(p1)) / <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(P.<a class="code" href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">direction</a>);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            <span class="comment">// Which dimension will ray move next step into?, it isn&#39;t necessary to be only</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            <span class="comment">// one.</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            <span class="keywordtype">double</span> diffx = <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(alpha - alpha_x);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            <span class="keywordtype">double</span> diffy = <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(alpha - alpha_y);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            <span class="keywordtype">double</span> diffz = <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(alpha - alpha_z);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            <span class="keywordtype">double</span> diff_alpha = fmin(fmin(diffx, diffy), diffz);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(V, <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(idx), <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(idx), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(idx)) += diff_alpha * <a class="code" href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(P(), <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(diff_alpha - diffx) &lt;= <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>)</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            {</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                alpha = alpha_x;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(idx) += x_sign;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            }</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(diff_alpha - diffy) &lt;= <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>)</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            {</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                alpha = alpha_y;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(idx) += y_sign;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            }</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(diff_alpha - diffz) &lt;= <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>)</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            {</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                alpha = alpha_z;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(idx) += z_sign;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            }</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        }</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="keywordflow">while</span> ((alpha_max - alpha) &gt; <a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>);</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Assigning P(&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt;&lt; <span class="stringliteral">&quot;)=&quot;</span> &lt;&lt; ray_sum &lt;&lt; std::endl;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    }</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;}</div><div class="ttc" id="group__FourierProjection_html_ga7c0ae2d78ba098df1b33115e94918f18"><div class="ttname"><a href="group__FourierProjection.html#ga7c0ae2d78ba098df1b33115e94918f18">Projection::eulert</a></div><div class="ttdeci">Matrix2D&lt; double &gt; eulert</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00082">fourier_projection.h:82</a></div></div>
<div class="ttc" id="structblobtype_html_ae713f8fc66da6e18d0bc2ff381bda22f"><div class="ttname"><a href="structblobtype.html#ae713f8fc66da6e18d0bc2ff381bda22f">blobtype::alpha</a></div><div class="ttdeci">double alpha</div><div class="ttdoc">Smoothness parameter. </div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00122">blobs.h:122</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00364">multidim_array.h:364</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga706d2ce724d393d4d759a46225bbc6c1"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga706d2ce724d393d4d759a46225bbc6c1">FINISHINGZ</a></div><div class="ttdeci">#define FINISHINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00081">multidim_array.h:81</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00065">multidim_array.h:65</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Macros_html_gad4d08cca0a39849cc247072eaebe7726"><div class="ttname"><a href="group__Macros.html#gad4d08cca0a39849cc247072eaebe7726">CLIP</a></div><div class="ttdeci">#define CLIP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00260">xmipp_macros.h:260</a></div></div>
<div class="ttc" id="group__Vectors_html_ga0c31197d639e9b7b7b8abe4eaebbaa5b"><div class="ttname"><a href="group__Vectors.html#ga0c31197d639e9b7b7b8abe4eaebbaa5b">V3_BY_CT</a></div><div class="ttdeci">#define V3_BY_CT(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00241">matrix1d.h:241</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaafa1c5d5357089a5b720807481b8c50b"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaafa1c5d5357089a5b720807481b8c50b">STARTINGZ</a></div><div class="ttdeci">#define STARTINGZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00077">multidim_array.h:77</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00069">multidim_array.h:69</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00400">multidim_array.h:400</a></div></div>
<div class="ttc" id="group__Macros_html_gad584f97e936242b173add43261376ba5"><div class="ttname"><a href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a></div><div class="ttdeci">#define XMIPP_EQUAL_ACCURACY</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00119">xmipp_macros.h:119</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="group__FourierProjection_html_ga532f6713fbe228d3ee30f4d3a2766a20"><div class="ttname"><a href="group__FourierProjection.html#ga532f6713fbe228d3ee30f4d3a2766a20">Projection::direction</a></div><div class="ttdeci">Matrix1D&lt; double &gt; direction</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00065">fourier_projection.h:65</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Matrices_html_gad159332322d687de886a720422e4b757"><div class="ttname"><a href="group__Matrices.html#gad159332322d687de886a720422e4b757">M3x3_BY_V3x1</a></div><div class="ttdeci">#define M3x3_BY_V3x1(a, M, b)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00171">matrix2d.h:171</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00073">multidim_array.h:73</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_ga6c6b4d4f88daca5e1d8e171bec3b4af0"><div class="ttname"><a href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a></div><div class="ttdeci">#define VECTOR_R3(v, x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00127">matrix1d.h:127</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a046e290d67d4e9e20547aae0fab90070"><div class="ttname"><a href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a></div><div class="ttdeci">double fmax</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05183">numerical_recipes.cpp:5183</a></div></div>
<div class="ttc" id="group__Macros_html_ga95ed41486ca0ed53262e4b8934d4afac"><div class="ttname"><a href="group__Macros.html#ga95ed41486ca0ed53262e4b8934d4afac">SGN</a></div><div class="ttdeci">#define SGN(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00155">xmipp_macros.h:155</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="group__Vectors_html_gafe748b92e8aeaa282eb7bafbd2baca37"><div class="ttname"><a href="group__Vectors.html#gafe748b92e8aeaa282eb7bafbd2baca37">V3_PLUS_V3</a></div><div class="ttdeci">#define V3_PLUS_V3(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00193">matrix1d.h:193</a></div></div>
<div class="ttc" id="group__Macros_html_ga20716e3da0ba25d3c4c9a2421573391f"><div class="ttname"><a href="group__Macros.html#ga20716e3da0ba25d3c4c9a2421573391f">SPEED_UP_temps012</a></div><div class="ttdeci">#define SPEED_UP_temps012</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00403">xmipp_macros.h:403</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a3e46756d453b695deb8da52e590ef0b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__Threads.html#ga0b86c483ccff385c24a8a278870af9f7">barrier_t</a> project_barrier</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="projection_8cpp_source.html#l00038">38</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a6b8971032d8e98145e6691683950fe8c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pthread_mutex_t project_mutex = PTHREAD_MUTEX_INITIALIZER</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="projection_8cpp_source.html#l00039">39</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aef66df64a8ff60fcb4b1aed8341af3b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structproject__thread__params.html">project_thread_params</a>* project_threads</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="projection_8cpp_source.html#l00040">40</a> of file <a class="el" href="projection_8cpp_source.html">projection.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
