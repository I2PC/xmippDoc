<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Xmipp: Phantom Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classPhantom-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Phantom Class Reference<div class="ingroups"><a class="el" href="group__Phantoms.html">Phantoms</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="phantom_8h_source.html">phantom.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for Phantom:</div>
<div class="dyncontent">
<div class="center"><img src="classPhantom__coll__graph.png" border="0" usemap="#Phantom_coll__map" alt="Collaboration graph"/></div>
<map name="Phantom_coll__map" id="Phantom_coll__map">
<area shape="rect" id="node2" href="classFileName.html" title="FileName" alt="" coords="5,81,84,108"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a0f6f1092a1871dfe3ec86d02afca46df"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a0f6f1092a1871dfe3ec86d02afca46df">Phantom</a> ()</td></tr>
<tr class="separator:a0f6f1092a1871dfe3ec86d02afca46df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8122f601943a883d85d1d03553b19667"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a8122f601943a883d85d1d03553b19667">Phantom</a> (const <a class="el" href="classFileName.html">FileName</a> &amp;fn_phantom)</td></tr>
<tr class="separator:a8122f601943a883d85d1d03553b19667"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac18bbb5c4653d0995f1d058a283738e7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#ac18bbb5c4653d0995f1d058a283738e7">~Phantom</a> ()</td></tr>
<tr class="separator:ac18bbb5c4653d0995f1d058a283738e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeea31372789c73608719546292722cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#afeea31372789c73608719546292722cb">clear</a> ()</td></tr>
<tr class="separator:afeea31372789c73608719546292722cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addfd18592183e95d5182c9eecaef2222"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#addfd18592183e95d5182c9eecaef2222">FeatNo</a> ()</td></tr>
<tr class="separator:addfd18592183e95d5182c9eecaef2222"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70e20afd95da70daa72707ec3d85ecbc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFeature.html">Feature</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a70e20afd95da70daa72707ec3d85ecbc">operator()</a> (int <a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</td></tr>
<tr class="separator:a70e20afd95da70daa72707ec3d85ecbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c755fad485e51ab88d40a1229bfe945"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classFeature.html">Feature</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a1c755fad485e51ab88d40a1229bfe945">operator()</a> (int <a class="el" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) const </td></tr>
<tr class="separator:a1c755fad485e51ab88d40a1229bfe945"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae37d631998602cc6ceded77de112e4e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#ae37d631998602cc6ceded77de112e4e7">add</a> (<a class="el" href="classFeature.html">Feature</a> *<a class="el" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>)</td></tr>
<tr class="separator:ae37d631998602cc6ceded77de112e4e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff7c2737ca1cc05bd4d9c930b96ed270"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPhantom.html">Phantom</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#aff7c2737ca1cc05bd4d9c930b96ed270">operator=</a> (const <a class="el" href="classPhantom.html">Phantom</a> &amp;P)</td></tr>
<tr class="memdesc:aff7c2737ca1cc05bd4d9c930b96ed270"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assignment.  <a href="#aff7c2737ca1cc05bd4d9c930b96ed270">More...</a><br /></td></tr>
<tr class="separator:aff7c2737ca1cc05bd4d9c930b96ed270"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a650378436050d48f60679ba7435f640b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a650378436050d48f60679ba7435f640b">assign</a> (const <a class="el" href="classPhantom.html">Phantom</a> &amp;P)</td></tr>
<tr class="separator:a650378436050d48f60679ba7435f640b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60ec9a98be53ca2cfabe195c311d26d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a60ec9a98be53ca2cfabe195c311d26d2">prepare</a> ()</td></tr>
<tr class="memdesc:a60ec9a98be53ca2cfabe195c311d26d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare for work.  <a href="#a60ec9a98be53ca2cfabe195c311d26d2">More...</a><br /></td></tr>
<tr class="separator:a60ec9a98be53ca2cfabe195c311d26d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a4539f42fa8e43065718ed276ee3ebb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a0a4539f42fa8e43065718ed276ee3ebb">max_distance</a> () const </td></tr>
<tr class="memdesc:a0a4539f42fa8e43065718ed276ee3ebb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the maximum distance of any feature to the volume center.  <a href="#a0a4539f42fa8e43065718ed276ee3ebb">More...</a><br /></td></tr>
<tr class="separator:a0a4539f42fa8e43065718ed276ee3ebb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3998b8ff9f2524f94d263aea70ea6034"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a3998b8ff9f2524f94d263aea70ea6034">volume</a> () const </td></tr>
<tr class="memdesc:a3998b8ff9f2524f94d263aea70ea6034"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the volume of all the features.  <a href="#a3998b8ff9f2524f94d263aea70ea6034">More...</a><br /></td></tr>
<tr class="separator:a3998b8ff9f2524f94d263aea70ea6034"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6e22a11d2edae0aabebad15e982112a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#ab6e22a11d2edae0aabebad15e982112a">read</a> (const <a class="el" href="classFileName.html">FileName</a> &amp;fn_phantom, bool apply_scale=true)</td></tr>
<tr class="separator:ab6e22a11d2edae0aabebad15e982112a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9536e9dacdeb45c3a2abb7061121d59f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a9536e9dacdeb45c3a2abb7061121d59f">write</a> (const <a class="el" href="classFileName.html">FileName</a> &amp;fn_phantom=&quot;&quot;)</td></tr>
<tr class="separator:a9536e9dacdeb45c3a2abb7061121d59f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa22801183cc6354029379eb3547c4ab7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#aa22801183cc6354029379eb3547c4ab7">voxel_inside_any_feat</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;r, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;aux1, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;aux2) const </td></tr>
<tr class="separator:aa22801183cc6354029379eb3547c4ab7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca9f83d30578397cc3be9a1d98c7bd63"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#aca9f83d30578397cc3be9a1d98c7bd63">voxel_inside_any_feat</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;r) const </td></tr>
<tr class="separator:aca9f83d30578397cc3be9a1d98c7bd63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9764f4155bb8be100c7cffb521536197"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a9764f4155bb8be100c7cffb521536197">any_feature_intersects_sphere</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;r, double radius, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;aux1, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;aux2, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;aux3) const </td></tr>
<tr class="separator:a9764f4155bb8be100c7cffb521536197"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06f6d9d535484186f98e6d4ab3eee482"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a06f6d9d535484186f98e6d4ab3eee482">any_feature_intersects_sphere</a> (const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;r, double radius) const </td></tr>
<tr class="separator:a06f6d9d535484186f98e6d4ab3eee482"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e4f9762ff9c771ac287c0c7237848bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a4e4f9762ff9c771ac287c0c7237848bf">draw_in</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V)</td></tr>
<tr class="separator:a4e4f9762ff9c771ac287c0c7237848bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a386c1d4016613a28f7efac5a6c5787f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a386c1d4016613a28f7efac5a6c5787f8">label</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V)</td></tr>
<tr class="separator:a386c1d4016613a28f7efac5a6c5787f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1c033b91d3a7aa54cf90f137f152554"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#ac1c033b91d3a7aa54cf90f137f152554">sketch_in</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;V, int clean=<a class="el" href="phantom_8h.html#a9b138cb57885319876cd956babcf38c1">DONT_CLEAN</a>, double colour=2)</td></tr>
<tr class="separator:ac1c033b91d3a7aa54cf90f137f152554"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37c522b67cfd1f5552ec6d535c50cf5e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a37c522b67cfd1f5552ec6d535c50cf5e">shift</a> (double shiftX, double shiftY, double shiftZ)</td></tr>
<tr class="separator:a37c522b67cfd1f5552ec6d535c50cf5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade1a7ab8032d3194d0fc49409fd1133a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#ade1a7ab8032d3194d0fc49409fd1133a">rotate</a> (const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;E)</td></tr>
<tr class="separator:ade1a7ab8032d3194d0fc49409fd1133a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac53954a765a251bc106359ed7424ca0e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#ac53954a765a251bc106359ed7424ca0e">selfApplyGeometry</a> (const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;A, int inv)</td></tr>
<tr class="separator:ac53954a765a251bc106359ed7424ca0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa9738c948a9df13fdd2bb0f5657793a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#afa9738c948a9df13fdd2bb0f5657793a">project_to</a> (<a class="el" href="classProjection.html">Projection</a> &amp;P, int Ydim, int Xdim, double rot, double tilt, double psi, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; *A=NULL) const </td></tr>
<tr class="separator:afa9738c948a9df13fdd2bb0f5657793a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d61fc6e7312e9dbd882f611e184b360"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a3d61fc6e7312e9dbd882f611e184b360">project_to</a> (<a class="el" href="classProjection.html">Projection</a> &amp;P, double rot, double tilt, double psi, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; *A=NULL) const </td></tr>
<tr class="separator:a3d61fc6e7312e9dbd882f611e184b360"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37d7660140e436c4960eb4922f06e945"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a37d7660140e436c4960eb4922f06e945">project_to</a> (<a class="el" href="classProjection.html">Projection</a> &amp;P, const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;VP, double disappearing_th=1.0) const </td></tr>
<tr class="separator:a37d7660140e436c4960eb4922f06e945"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadfdf29586936b4be2e3d517788a4534"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#aadfdf29586936b4be2e3d517788a4534">surface</a> (double <a class="el" href="splines_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>, double radius, int <a class="el" href="group__FringeProcessing.html#gad71cd7f2325be81202279ed730355092">direction</a>, <a class="el" href="classImage.html">Image</a>&lt; double &gt; *P) const </td></tr>
<tr class="separator:aadfdf29586936b4be2e3d517788a4534"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a37fc05be4b1941a82a04df83b8672c3a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFileName.html">FileName</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a37fc05be4b1941a82a04df83b8672c3a">fn</a></td></tr>
<tr class="memdesc:a37fc05be4b1941a82a04df83b8672c3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filename.  <a href="#a37fc05be4b1941a82a04df83b8672c3a">More...</a><br /></td></tr>
<tr class="separator:a37fc05be4b1941a82a04df83b8672c3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb218fc635f5c078cba041e538ea76b8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">xdim</a></td></tr>
<tr class="memdesc:afb218fc635f5c078cba041e538ea76b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Final volume X dimension.  <a href="#afb218fc635f5c078cba041e538ea76b8">More...</a><br /></td></tr>
<tr class="separator:afb218fc635f5c078cba041e538ea76b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a614b76f0cf1bb8cfe7b98047f2b8dc7a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">ydim</a></td></tr>
<tr class="memdesc:a614b76f0cf1bb8cfe7b98047f2b8dc7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Final volume Y dimension.  <a href="#a614b76f0cf1bb8cfe7b98047f2b8dc7a">More...</a><br /></td></tr>
<tr class="separator:a614b76f0cf1bb8cfe7b98047f2b8dc7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaeb13139ea6fdc791e551a83d2f4ece"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a></td></tr>
<tr class="memdesc:aaaeb13139ea6fdc791e551a83d2f4ece"><td class="mdescLeft">&#160;</td><td class="mdescRight">Final volume Z dimension.  <a href="#aaaeb13139ea6fdc791e551a83d2f4ece">More...</a><br /></td></tr>
<tr class="separator:aaaeb13139ea6fdc791e551a83d2f4ece"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97a780e1b83fef7587ac4f48b8ea0fb5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a97a780e1b83fef7587ac4f48b8ea0fb5">Background_Density</a></td></tr>
<tr class="memdesc:a97a780e1b83fef7587ac4f48b8ea0fb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Final volume background density.  <a href="#a97a780e1b83fef7587ac4f48b8ea0fb5">More...</a><br /></td></tr>
<tr class="separator:a97a780e1b83fef7587ac4f48b8ea0fb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6b0d6771b22d06535000de7ba3b7f52"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#ad6b0d6771b22d06535000de7ba3b7f52">current_scale</a></td></tr>
<tr class="memdesc:ad6b0d6771b22d06535000de7ba3b7f52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Has been the scale applied?  <a href="#ad6b0d6771b22d06535000de7ba3b7f52">More...</a><br /></td></tr>
<tr class="separator:ad6b0d6771b22d06535000de7ba3b7f52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43164ae1928635229333ce41c01e2f35"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a43164ae1928635229333ce41c01e2f35">param_file_scale</a></td></tr>
<tr class="memdesc:a43164ae1928635229333ce41c01e2f35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Param file scale.  <a href="#a43164ae1928635229333ce41c01e2f35">More...</a><br /></td></tr>
<tr class="separator:a43164ae1928635229333ce41c01e2f35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08e07a6c798f13f5c87488704dd89791"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a08e07a6c798f13f5c87488704dd89791">phantom_scale</a></td></tr>
<tr class="memdesc:a08e07a6c798f13f5c87488704dd89791"><td class="mdescLeft">&#160;</td><td class="mdescRight">Param file scale.  <a href="#a08e07a6c798f13f5c87488704dd89791">More...</a><br /></td></tr>
<tr class="separator:a08e07a6c798f13f5c87488704dd89791"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab37a930cd36cd7d25a11da6bb0f3ce7f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classFeature.html">Feature</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a></td></tr>
<tr class="memdesc:ab37a930cd36cd7d25a11da6bb0f3ce7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">List with the features.  <a href="#ab37a930cd36cd7d25a11da6bb0f3ce7f">More...</a><br /></td></tr>
<tr class="separator:ab37a930cd36cd7d25a11da6bb0f3ce7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a4c9ed4267360de6b707902f0b0b1f902"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPhantom.html#a4c9ed4267360de6b707902f0b0b1f902">operator&lt;&lt;</a> (std::ostream &amp;o, const <a class="el" href="classPhantom.html">Phantom</a> &amp;<a class="el" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>)</td></tr>
<tr class="separator:a4c9ed4267360de6b707902f0b0b1f902"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classPhantom.html">Phantom</a> class. The phantom class is simply a list (STL vector) of features plus some information about the size of the final volume to generate and its background density. This is the class that will interact with the reconstruction programs as the features classes themselves haven't got enough information to generate the final volume. The file format to generate the phantom is described in the previous page (<a class="el" href="group__Phantoms.html">Phantoms</a>).</p>
<p>This class is thought to be filled from a file, and doesn't give many facilities to update it from program. This is something to do.</p>
<p>Here goes an example of how to manage loops in the phantom class, </p><div class="fragment"><div class="line"><span class="comment">// Show all features</span></div><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;=P.FeatNo(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++) std::cout &lt;&lt; P(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="phantom_8h_source.html#l01385">1385</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a0f6f1092a1871dfe3ec86d02afca46df"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Phantom::Phantom </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Empty constructor. The empty phantom is 0x0x0, background density=0, no feature is inside and no name. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02039">2039</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;{</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <a class="code" href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">xdim</a> = <a class="code" href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">ydim</a> = <a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a> = 0;</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    <a class="code" href="classPhantom.html#a97a780e1b83fef7587ac4f48b8ea0fb5">Background_Density</a> = 0;</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    <a class="code" href="classPhantom.html#a37fc05be4b1941a82a04df83b8672c3a">fn</a> = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <a class="code" href="classPhantom.html#ad6b0d6771b22d06535000de7ba3b7f52">current_scale</a> = 1;</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    <a class="code" href="classPhantom.html#a08e07a6c798f13f5c87488704dd89791">phantom_scale</a> = 1.;</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;}</div><div class="ttc" id="classPhantom_html_a08e07a6c798f13f5c87488704dd89791"><div class="ttname"><a href="classPhantom.html#a08e07a6c798f13f5c87488704dd89791">Phantom::phantom_scale</a></div><div class="ttdeci">double phantom_scale</div><div class="ttdoc">Param file scale. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01410">phantom.h:1410</a></div></div>
<div class="ttc" id="classPhantom_html_a614b76f0cf1bb8cfe7b98047f2b8dc7a"><div class="ttname"><a href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">Phantom::ydim</a></div><div class="ttdeci">int ydim</div><div class="ttdoc">Final volume Y dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01395">phantom.h:1395</a></div></div>
<div class="ttc" id="classPhantom_html_a37fc05be4b1941a82a04df83b8672c3a"><div class="ttname"><a href="classPhantom.html#a37fc05be4b1941a82a04df83b8672c3a">Phantom::fn</a></div><div class="ttdeci">FileName fn</div><div class="ttdoc">Filename. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01389">phantom.h:1389</a></div></div>
<div class="ttc" id="classPhantom_html_a97a780e1b83fef7587ac4f48b8ea0fb5"><div class="ttname"><a href="classPhantom.html#a97a780e1b83fef7587ac4f48b8ea0fb5">Phantom::Background_Density</a></div><div class="ttdeci">double Background_Density</div><div class="ttdoc">Final volume background density. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01401">phantom.h:1401</a></div></div>
<div class="ttc" id="classPhantom_html_aaaeb13139ea6fdc791e551a83d2f4ece"><div class="ttname"><a href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">Phantom::zdim</a></div><div class="ttdeci">int zdim</div><div class="ttdoc">Final volume Z dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01398">phantom.h:1398</a></div></div>
<div class="ttc" id="classPhantom_html_afb218fc635f5c078cba041e538ea76b8"><div class="ttname"><a href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">Phantom::xdim</a></div><div class="ttdeci">int xdim</div><div class="ttdoc">Final volume X dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01392">phantom.h:1392</a></div></div>
<div class="ttc" id="classPhantom_html_ad6b0d6771b22d06535000de7ba3b7f52"><div class="ttname"><a href="classPhantom.html#ad6b0d6771b22d06535000de7ba3b7f52">Phantom::current_scale</a></div><div class="ttdeci">double current_scale</div><div class="ttdoc">Has been the scale applied? </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01404">phantom.h:1404</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8122f601943a883d85d1d03553b19667"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Phantom::Phantom </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFileName.html">FileName</a> &amp;&#160;</td>
          <td class="paramname"><em>fn_phantom</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Construct from a phantom file. Construct the phantom according to the specifications of the given file. The file must accomplish the structure given in <a class="el" href="group__Phantoms.html">Phantoms</a>. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l01423">1423</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    {</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        <a class="code" href="classPhantom.html#ab6e22a11d2edae0aabebad15e982112a">read</a>(fn_phantom);</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    }</div><div class="ttc" id="classPhantom_html_ab6e22a11d2edae0aabebad15e982112a"><div class="ttname"><a href="classPhantom.html#ab6e22a11d2edae0aabebad15e982112a">Phantom::read</a></div><div class="ttdeci">void read(const FileName &amp;fn_phantom, bool apply_scale=true)</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l02155">phantom.cpp:2155</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac18bbb5c4653d0995f1d058a283738e7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Phantom::~Phantom </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Destructor. All features are freed. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l01430">1430</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    {</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        <a class="code" href="classPhantom.html#afeea31372789c73608719546292722cb">clear</a>();</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    }</div><div class="ttc" id="classPhantom_html_afeea31372789c73608719546292722cb"><div class="ttname"><a href="classPhantom.html#afeea31372789c73608719546292722cb">Phantom::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l02048">phantom.cpp:2048</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ae37d631998602cc6ceded77de112e4e7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Phantom::add </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classFeature.html">Feature</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add a feature to the phantom. This function allows you to add new features at the end of the phantom. \ Ex: <a class="el" href="classSphere.html">Sphere</a> S; S.radius(); S.prepare(); Phantom.add(&amp;S); </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l01463">1463</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    {</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.push_back(f);</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    }</div><div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9764f4155bb8be100c7cffb521536197"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Phantom::any_feature_intersects_sphere </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>aux1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>aux2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>aux3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Speeded up sphere intersecting any feature. This function returns the first feature in the list intersecting a sphere with center r in R3 and the given radius. In none, 0 is returned. This speeded up function needs two vectors with dimension 3 externally resized. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02483">2483</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;{</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    <span class="keywordtype">bool</span> intersects;</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    {</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;        intersects = <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;intersects_sphere(r, radius, aux1, aux2, aux3);</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;        <span class="keywordflow">if</span> (intersects)</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1;</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    }</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;}</div><div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a06f6d9d535484186f98e6d4ab3eee482"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Phantom::any_feature_intersects_sphere </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p><a class="el" href="classSphere.html">Sphere</a> intersecting feature. This function is based in the previous one. It makes the same but you needn't supply the auxiliar vectors. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l01542">1542</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    {</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> aux1(3), aux2(3), aux3(3);</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classPhantom.html#a9764f4155bb8be100c7cffb521536197">any_feature_intersects_sphere</a>(r, radius, aux1, aux2, aux3);</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    }</div><div class="ttc" id="classPhantom_html_a9764f4155bb8be100c7cffb521536197"><div class="ttname"><a href="classPhantom.html#a9764f4155bb8be100c7cffb521536197">Phantom::any_feature_intersects_sphere</a></div><div class="ttdeci">int any_feature_intersects_sphere(const Matrix1D&lt; double &gt; &amp;r, double radius, Matrix1D&lt; double &gt; &amp;aux1, Matrix1D&lt; double &gt; &amp;aux2, Matrix1D&lt; double &gt; &amp;aux3) const </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l02483">phantom.cpp:2483</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a650378436050d48f60679ba7435f640b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Phantom::assign </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classPhantom.html">Phantom</a> &amp;&#160;</td>
          <td class="paramname"><em>P</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Another function for assignment. </p>

</div>
</div>
<a class="anchor" id="afeea31372789c73608719546292722cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Phantom::clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Clear the phantom. Force the phantom to be empty. All features are freed. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02048">2048</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;{</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    <a class="code" href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">xdim</a> = <a class="code" href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">ydim</a> = <a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a> = 0;</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    <a class="code" href="classPhantom.html#a97a780e1b83fef7587ac4f48b8ea0fb5">Background_Density</a> = 0;</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    <a class="code" href="classPhantom.html#a37fc05be4b1941a82a04df83b8672c3a">fn</a> = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;        <span class="keyword">delete</span> <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.clear();</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;}</div><div class="ttc" id="classPhantom_html_a614b76f0cf1bb8cfe7b98047f2b8dc7a"><div class="ttname"><a href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">Phantom::ydim</a></div><div class="ttdeci">int ydim</div><div class="ttdoc">Final volume Y dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01395">phantom.h:1395</a></div></div>
<div class="ttc" id="classPhantom_html_a37fc05be4b1941a82a04df83b8672c3a"><div class="ttname"><a href="classPhantom.html#a37fc05be4b1941a82a04df83b8672c3a">Phantom::fn</a></div><div class="ttdeci">FileName fn</div><div class="ttdoc">Filename. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01389">phantom.h:1389</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classPhantom_html_a97a780e1b83fef7587ac4f48b8ea0fb5"><div class="ttname"><a href="classPhantom.html#a97a780e1b83fef7587ac4f48b8ea0fb5">Phantom::Background_Density</a></div><div class="ttdeci">double Background_Density</div><div class="ttdoc">Final volume background density. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01401">phantom.h:1401</a></div></div>
<div class="ttc" id="classPhantom_html_aaaeb13139ea6fdc791e551a83d2f4ece"><div class="ttname"><a href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">Phantom::zdim</a></div><div class="ttdeci">int zdim</div><div class="ttdoc">Final volume Z dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01398">phantom.h:1398</a></div></div>
<div class="ttc" id="classPhantom_html_afb218fc635f5c078cba041e538ea76b8"><div class="ttname"><a href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">Phantom::xdim</a></div><div class="ttdeci">int xdim</div><div class="ttdoc">Final volume X dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01392">phantom.h:1392</a></div></div>
<div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4e4f9762ff9c771ac287c0c7237848bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Phantom::draw_in </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Draw the phantom in the volume. The volume is cleaned, resized to the phantom size and its origin is set at the center of the volume. Then every feature is drawn into the volume </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02499">2499</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;{</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;    V.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a>, <a class="code" href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">ydim</a>, <a class="code" href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">xdim</a>);</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;    V.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;    V.<a class="code" href="classMultidimArray.html#a239f45b043ed7715dec4d44ceef74dce">initConstant</a>(<a class="code" href="classPhantom.html#a97a780e1b83fef7587ac4f48b8ea0fb5">Background_Density</a>);</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;        <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classPhantom.html#a4e4f9762ff9c771ac287c0c7237848bf">draw_in</a>(V);</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="classPhantom_html_a614b76f0cf1bb8cfe7b98047f2b8dc7a"><div class="ttname"><a href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">Phantom::ydim</a></div><div class="ttdeci">int ydim</div><div class="ttdoc">Final volume Y dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01395">phantom.h:1395</a></div></div>
<div class="ttc" id="classMultidimArray_html_a239f45b043ed7715dec4d44ceef74dce"><div class="ttname"><a href="classMultidimArray.html#a239f45b043ed7715dec4d44ceef74dce">MultidimArray::initConstant</a></div><div class="ttdeci">void initConstant(T val)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04309">multidim_array.h:4309</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="classPhantom_html_a4e4f9762ff9c771ac287c0c7237848bf"><div class="ttname"><a href="classPhantom.html#a4e4f9762ff9c771ac287c0c7237848bf">Phantom::draw_in</a></div><div class="ttdeci">void draw_in(MultidimArray&lt; double &gt; &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l02499">phantom.cpp:2499</a></div></div>
<div class="ttc" id="classPhantom_html_a97a780e1b83fef7587ac4f48b8ea0fb5"><div class="ttname"><a href="classPhantom.html#a97a780e1b83fef7587ac4f48b8ea0fb5">Phantom::Background_Density</a></div><div class="ttdeci">double Background_Density</div><div class="ttdoc">Final volume background density. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01401">phantom.h:1401</a></div></div>
<div class="ttc" id="classPhantom_html_aaaeb13139ea6fdc791e551a83d2f4ece"><div class="ttname"><a href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">Phantom::zdim</a></div><div class="ttdeci">int zdim</div><div class="ttdoc">Final volume Z dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01398">phantom.h:1398</a></div></div>
<div class="ttc" id="classPhantom_html_afb218fc635f5c078cba041e538ea76b8"><div class="ttname"><a href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">Phantom::xdim</a></div><div class="ttdeci">int xdim</div><div class="ttdoc">Final volume X dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01392">phantom.h:1392</a></div></div>
<div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="addfd18592183e95d5182c9eecaef2222"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Phantom::FeatNo </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the number of features in the list. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l01440">1440</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    {</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.size();</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    }</div><div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a386c1d4016613a28f7efac5a6c5787f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Phantom::label </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Label a volume after the phantom. The volume is cleaned, resized to the phantom size and its origin is set at the center of the volume. Then every feature is drawn into the volume using different densities. Background has got density 0, the border for first feature density -1, the first feature has got density 1, the second 2 and its border -2, ... </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02510">2510</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;{</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> r(3), aux1(3), aux2(3);</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    V.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a>, <a class="code" href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">ydim</a>, <a class="code" href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">xdim</a>);</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;    V.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(V)</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    {</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;        <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(r) = <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>;</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r) = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;        <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r) = <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;        <span class="keywordtype">int</span> sel_feat = <a class="code" href="classPhantom.html#aa22801183cc6354029379eb3547c4ab7">voxel_inside_any_feat</a>(r, aux1, aux2);</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;        <span class="comment">// If it is not in the background, check that it is completely</span></div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;        <span class="comment">// inside the feature, if not set it to border.</span></div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;        <span class="keywordflow">if</span> (sel_feat != 0)</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[sel_feat-1]-&gt;voxel_inside(r, aux1, aux2) != 8)</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;                sel_feat = -sel_feat;</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a>(V, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = sel_feat;</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    }</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="classPhantom_html_a614b76f0cf1bb8cfe7b98047f2b8dc7a"><div class="ttname"><a href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">Phantom::ydim</a></div><div class="ttdeci">int ydim</div><div class="ttdoc">Final volume Y dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01395">phantom.h:1395</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00279">multidim_array.h:279</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga89215e4d7147d966ae7d7de9fa932e21"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga89215e4d7147d966ae7d7de9fa932e21">A3D_ELEM</a></div><div class="ttdeci">#define A3D_ELEM(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00263">multidim_array.h:263</a></div></div>
<div class="ttc" id="classPhantom_html_aa22801183cc6354029379eb3547c4ab7"><div class="ttname"><a href="classPhantom.html#aa22801183cc6354029379eb3547c4ab7">Phantom::voxel_inside_any_feat</a></div><div class="ttdeci">int voxel_inside_any_feat(const Matrix1D&lt; double &gt; &amp;r, Matrix1D&lt; double &gt; &amp;aux1, Matrix1D&lt; double &gt; &amp;aux2) const </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l02463">phantom.cpp:2463</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="classPhantom_html_aaaeb13139ea6fdc791e551a83d2f4ece"><div class="ttname"><a href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">Phantom::zdim</a></div><div class="ttdeci">int zdim</div><div class="ttdoc">Final volume Z dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01398">phantom.h:1398</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classPhantom_html_afb218fc635f5c078cba041e538ea76b8"><div class="ttname"><a href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">Phantom::xdim</a></div><div class="ttdeci">int xdim</div><div class="ttdoc">Final volume X dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01392">phantom.h:1392</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0a4539f42fa8e43065718ed276ee3ebb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Phantom::max_distance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the maximum distance of any feature to the volume center. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02137">2137</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;{</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    <span class="keywordtype">double</span> retval = 0;</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;        retval = <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(retval, <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classPhantom.html#a0a4539f42fa8e43065718ed276ee3ebb">max_distance</a> + <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;Center.module());</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;    <span class="keywordflow">return</span> retval;</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;}</div><div class="ttc" id="group__Macros_html_gae0a4180e923e3ffca3989e20e441aa3c"><div class="ttname"><a href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a></div><div class="ttdeci">#define XMIPP_MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00193">xmipp_macros.h:193</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classPhantom_html_a0a4539f42fa8e43065718ed276ee3ebb"><div class="ttname"><a href="classPhantom.html#a0a4539f42fa8e43065718ed276ee3ebb">Phantom::max_distance</a></div><div class="ttdeci">double max_distance() const </div><div class="ttdoc">Return the maximum distance of any feature to the volume center. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l02137">phantom.cpp:2137</a></div></div>
<div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a70e20afd95da70daa72707ec3d85ecbc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classFeature.html">Feature</a>* Phantom::operator() </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Access to a feature pointer. You can address each one of the features using this operator, remember that features are numbered as 1, 2, ... <a class="el" href="classPhantom.html#addfd18592183e95d5182c9eecaef2222">FeatNo()</a> </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l01448">1448</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    {</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-1];</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    }</div><div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1c755fad485e51ab88d40a1229bfe945"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classFeature.html">Feature</a>* Phantom::operator() </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constant Access to a feature pointer. Same as the previous one but with constant access. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l01455">1455</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    {</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-1];</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    }</div><div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aff7c2737ca1cc05bd4d9c930b96ed270"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPhantom.html">Phantom</a> &amp; Phantom::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classPhantom.html">Phantom</a> &amp;&#160;</td>
          <td class="paramname"><em>P</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assignment. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02058">2058</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;{</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    <span class="keywordflow">if</span> (&amp;P == <span class="keyword">this</span>)</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    <a class="code" href="classPhantom.html#afeea31372789c73608719546292722cb">clear</a>();</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    <a class="code" href="classPhantom.html#a37fc05be4b1941a82a04df83b8672c3a">fn</a> = P.<a class="code" href="classPhantom.html#a37fc05be4b1941a82a04df83b8672c3a">fn</a>;</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    <a class="code" href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">xdim</a> = P.<a class="code" href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">xdim</a>;</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    <a class="code" href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">ydim</a> = P.<a class="code" href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">ydim</a>;</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    <a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a> = P.<a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a>;</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <a class="code" href="classPhantom.html#a08e07a6c798f13f5c87488704dd89791">phantom_scale</a> = P.<a class="code" href="classPhantom.html#a08e07a6c798f13f5c87488704dd89791">phantom_scale</a>;</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    <a class="code" href="classPhantom.html#a97a780e1b83fef7587ac4f48b8ea0fb5">Background_Density</a> = P.<a class="code" href="classPhantom.html#a97a780e1b83fef7587ac4f48b8ea0fb5">Background_Density</a>;</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    <a class="code" href="classSphere.html">Sphere</a>     *sph;</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <a class="code" href="classBlob.html">Blob</a>       *blo;</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    <a class="code" href="classGaussian.html">Gaussian</a>   *gau;</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    <a class="code" href="classCylinder.html">Cylinder</a>   *cyl;</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    <a class="code" href="classDCylinder.html">DCylinder</a>  *dcy;</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    <a class="code" href="classCube.html">Cube</a>       *cub;</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    <a class="code" href="classEllipsoid.html">Ellipsoid</a>  *ell;</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    <a class="code" href="classCone.html">Cone</a>       *con;</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; P.<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;        <span class="keywordflow">if</span> (P.<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;Type == <span class="stringliteral">&quot;sph&quot;</span>)</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;        {</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;            sph = <span class="keyword">new</span> <a class="code" href="classSphere.html">Sphere</a>;</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;            *sph = *((<a class="code" href="classSphere.html">Sphere</a> *)    P.<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;            <a class="code" href="classPhantom.html#ae37d631998602cc6ceded77de112e4e7">add</a>(sph);</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        }</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P.<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;Type == <span class="stringliteral">&quot;blo&quot;</span>)</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        {</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;            blo = <span class="keyword">new</span> <a class="code" href="classBlob.html">Blob</a>;</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;            *blo = *((<a class="code" href="classBlob.html">Blob</a> *)      P.<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;            <a class="code" href="classPhantom.html#ae37d631998602cc6ceded77de112e4e7">add</a>(blo);</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        }</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P.<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;Type == <span class="stringliteral">&quot;gau&quot;</span>)</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;        {</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;            gau = <span class="keyword">new</span> <a class="code" href="classGaussian.html">Gaussian</a>;</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;            *gau = *((<a class="code" href="classGaussian.html">Gaussian</a> *)  P.<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;            <a class="code" href="classPhantom.html#ae37d631998602cc6ceded77de112e4e7">add</a>(gau);</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;        }</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P.<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;Type == <span class="stringliteral">&quot;cyl&quot;</span>)</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;        {</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;            cyl = <span class="keyword">new</span> <a class="code" href="classCylinder.html">Cylinder</a>;</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;            *cyl = *((<a class="code" href="classCylinder.html">Cylinder</a> *)  P.<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;            <a class="code" href="classPhantom.html#ae37d631998602cc6ceded77de112e4e7">add</a>(cyl);</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;        }</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P.<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;Type == <span class="stringliteral">&quot;dcy&quot;</span>)</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;        {</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;            dcy = <span class="keyword">new</span> <a class="code" href="classDCylinder.html">DCylinder</a>;</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;            *dcy = *((<a class="code" href="classDCylinder.html">DCylinder</a> *) P.<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;            <a class="code" href="classPhantom.html#ae37d631998602cc6ceded77de112e4e7">add</a>(dcy);</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;        }</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P.<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;Type == <span class="stringliteral">&quot;cub&quot;</span>)</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;        {</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;            cub = <span class="keyword">new</span> <a class="code" href="classCube.html">Cube</a>;</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;            *cub = *((<a class="code" href="classCube.html">Cube</a> *)      P.<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;            <a class="code" href="classPhantom.html#ae37d631998602cc6ceded77de112e4e7">add</a>(cub);</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;        }</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P.<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;Type == <span class="stringliteral">&quot;ell&quot;</span>)</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;        {</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;            ell = <span class="keyword">new</span> <a class="code" href="classEllipsoid.html">Ellipsoid</a>;</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;            *ell = *((<a class="code" href="classEllipsoid.html">Ellipsoid</a> *) P.<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;            <a class="code" href="classPhantom.html#ae37d631998602cc6ceded77de112e4e7">add</a>(ell);</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;        }</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (P.<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;Type == <span class="stringliteral">&quot;con&quot;</span>)</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;        {</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;            con = <span class="keyword">new</span> <a class="code" href="classCone.html">Cone</a>;</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;            *con = *((<a class="code" href="classCone.html">Cone</a>      *) P.<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;            <a class="code" href="classPhantom.html#ae37d631998602cc6ceded77de112e4e7">add</a>(con);</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;        }</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;}</div><div class="ttc" id="classCone_html"><div class="ttname"><a href="classCone.html">Cone</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01274">phantom.h:1274</a></div></div>
<div class="ttc" id="classBlob_html"><div class="ttname"><a href="classBlob.html">Blob</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00572">phantom.h:572</a></div></div>
<div class="ttc" id="classPhantom_html_a08e07a6c798f13f5c87488704dd89791"><div class="ttname"><a href="classPhantom.html#a08e07a6c798f13f5c87488704dd89791">Phantom::phantom_scale</a></div><div class="ttdeci">double phantom_scale</div><div class="ttdoc">Param file scale. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01410">phantom.h:1410</a></div></div>
<div class="ttc" id="classPhantom_html_a614b76f0cf1bb8cfe7b98047f2b8dc7a"><div class="ttname"><a href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">Phantom::ydim</a></div><div class="ttdeci">int ydim</div><div class="ttdoc">Final volume Y dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01395">phantom.h:1395</a></div></div>
<div class="ttc" id="classGaussian_html"><div class="ttname"><a href="classGaussian.html">Gaussian</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00676">phantom.h:676</a></div></div>
<div class="ttc" id="classCylinder_html"><div class="ttname"><a href="classCylinder.html">Cylinder</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00780">phantom.h:780</a></div></div>
<div class="ttc" id="classPhantom_html_a37fc05be4b1941a82a04df83b8672c3a"><div class="ttname"><a href="classPhantom.html#a37fc05be4b1941a82a04df83b8672c3a">Phantom::fn</a></div><div class="ttdeci">FileName fn</div><div class="ttdoc">Filename. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01389">phantom.h:1389</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classEllipsoid_html"><div class="ttname"><a href="classEllipsoid.html">Ellipsoid</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01154">phantom.h:1154</a></div></div>
<div class="ttc" id="classCube_html"><div class="ttname"><a href="classCube.html">Cube</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01034">phantom.h:1034</a></div></div>
<div class="ttc" id="classPhantom_html_a97a780e1b83fef7587ac4f48b8ea0fb5"><div class="ttname"><a href="classPhantom.html#a97a780e1b83fef7587ac4f48b8ea0fb5">Phantom::Background_Density</a></div><div class="ttdeci">double Background_Density</div><div class="ttdoc">Final volume background density. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01401">phantom.h:1401</a></div></div>
<div class="ttc" id="classPhantom_html_ae37d631998602cc6ceded77de112e4e7"><div class="ttname"><a href="classPhantom.html#ae37d631998602cc6ceded77de112e4e7">Phantom::add</a></div><div class="ttdeci">void add(Feature *f)</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01463">phantom.h:1463</a></div></div>
<div class="ttc" id="classDCylinder_html"><div class="ttname"><a href="classDCylinder.html">DCylinder</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00911">phantom.h:911</a></div></div>
<div class="ttc" id="classPhantom_html_aaaeb13139ea6fdc791e551a83d2f4ece"><div class="ttname"><a href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">Phantom::zdim</a></div><div class="ttdeci">int zdim</div><div class="ttdoc">Final volume Z dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01398">phantom.h:1398</a></div></div>
<div class="ttc" id="classPhantom_html_afb218fc635f5c078cba041e538ea76b8"><div class="ttname"><a href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">Phantom::xdim</a></div><div class="ttdeci">int xdim</div><div class="ttdoc">Final volume X dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01392">phantom.h:1392</a></div></div>
<div class="ttc" id="classSphere_html"><div class="ttname"><a href="classSphere.html">Sphere</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00473">phantom.h:473</a></div></div>
<div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
<div class="ttc" id="classPhantom_html_afeea31372789c73608719546292722cb"><div class="ttname"><a href="classPhantom.html#afeea31372789c73608719546292722cb">Phantom::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l02048">phantom.cpp:2048</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a60ec9a98be53ca2cfabe195c311d26d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Phantom::prepare </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepare for work. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02130">2130</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;{</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;        <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classPhantom.html#a60ec9a98be53ca2cfabe195c311d26d2">prepare</a>();</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;}</div><div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classPhantom_html_a60ec9a98be53ca2cfabe195c311d26d2"><div class="ttname"><a href="classPhantom.html#a60ec9a98be53ca2cfabe195c311d26d2">Phantom::prepare</a></div><div class="ttdeci">void prepare()</div><div class="ttdoc">Prepare for work. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l02130">phantom.cpp:2130</a></div></div>
<div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afa9738c948a9df13fdd2bb0f5657793a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Phantom::project_to </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>A</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Project phantom from a direction. The direction is specified by the 3 <a class="el" href="classEuler.html">Euler</a> angles (as usual, rot=1st, tilt=2nd, psi=3rd), the projection size is (Ydim x Xdim) given in the function call, the projection logical origin is set at the physical center of the image. The projection is cleaned and then the projection of the phantom is computed. A matrix A (3x3) can be supplied in order to apply a deformation in the projection plane. A must be such that </p><div class="fragment"><div class="line">deformed position=A*undeformed position</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02576">2576</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;{</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Ydim=&quot;</span> &lt;&lt; Ydim &lt;&lt; <span class="stringliteral">&quot; Xdim=&quot;</span> &lt;&lt; Xdim &lt;&lt; std::endl</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;rot=&quot;</span> &lt;&lt; rot &lt;&lt; <span class="stringliteral">&quot; tilt=&quot;</span> &lt;&lt; tilt &lt;&lt; <span class="stringliteral">&quot; psi=&quot;</span> &lt;&lt; <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a> &lt;&lt; std::endl</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;A\n&quot;</span> &lt;&lt; A;</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    <span class="comment">// Initialise projection</span></div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;    P().initZeros(Ydim, Xdim);</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;    P().setXmippOrigin();</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;    P.<a class="code" href="group__FourierProjection.html#ga38fc7e819f167ed62bf63c13e1058aab">setAngles</a>(rot, tilt, <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>);</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;    <span class="comment">// Compute volume to Projection matrix</span></div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> VP = P.<a class="code" href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">euler</a>;</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;    <span class="keywordflow">if</span> (A != NULL)</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;        VP = (*A) * VP;</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> PV = VP.<a class="code" href="classMatrix2D.html#add8d2052c53fcf6689908614f67b9ee6">inv</a>();</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;    <span class="comment">// Project all features</span></div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;        <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classPhantom.html#afa9738c948a9df13fdd2bb0f5657793a">project_to</a>(P, VP, PV);</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;}</div><div class="ttc" id="classMatrix2D_html_add8d2052c53fcf6689908614f67b9ee6"><div class="ttname"><a href="classMatrix2D.html#add8d2052c53fcf6689908614f67b9ee6">Matrix2D::inv</a></div><div class="ttdeci">void inv(Matrix2D&lt; T &gt; &amp;result) const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01648">matrix2d.h:1648</a></div></div>
<div class="ttc" id="group__FourierProjection_html_gabef83744f4e0571354f31586fb41d357"><div class="ttname"><a href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">Projection::euler</a></div><div class="ttdeci">Matrix2D&lt; double &gt; euler</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00074">fourier_projection.h:74</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="group__FourierProjection_html_ga38fc7e819f167ed62bf63c13e1058aab"><div class="ttname"><a href="group__FourierProjection.html#ga38fc7e819f167ed62bf63c13e1058aab">Projection::setAngles</a></div><div class="ttdeci">void setAngles(double _rot, double _tilt, double _psi)</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8cpp_source.html#l00041">fourier_projection.cpp:41</a></div></div>
<div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
<div class="ttc" id="classPhantom_html_afa9738c948a9df13fdd2bb0f5657793a"><div class="ttname"><a href="classPhantom.html#afa9738c948a9df13fdd2bb0f5657793a">Phantom::project_to</a></div><div class="ttdeci">void project_to(Projection &amp;P, int Ydim, int Xdim, double rot, double tilt, double psi, const Matrix2D&lt; double &gt; *A=NULL) const </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l02576">phantom.cpp:2576</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3d61fc6e7312e9dbd882f611e184b360"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Phantom::project_to </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>A</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Project phantom from a direction. The same as before but this time the projection is supposed to be already resized and with the right center. The phantom projection is added to the already drawn projection. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02600">2600</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;{</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;    P.<a class="code" href="group__FourierProjection.html#ga38fc7e819f167ed62bf63c13e1058aab">setAngles</a>(rot, tilt, <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>);</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;    <span class="comment">// Compute volume to Projection matrix</span></div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> VP = P.<a class="code" href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">euler</a>;</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;    <span class="keywordflow">if</span> (A != NULL)</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;        VP = (*A) * VP;</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> PV = VP.<a class="code" href="classMatrix2D.html#add8d2052c53fcf6689908614f67b9ee6">inv</a>();</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;    <span class="comment">// Project all features</span></div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;        <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classPhantom.html#afa9738c948a9df13fdd2bb0f5657793a">project_to</a>(P, VP, PV);</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;}</div><div class="ttc" id="classMatrix2D_html_add8d2052c53fcf6689908614f67b9ee6"><div class="ttname"><a href="classMatrix2D.html#add8d2052c53fcf6689908614f67b9ee6">Matrix2D::inv</a></div><div class="ttdeci">void inv(Matrix2D&lt; T &gt; &amp;result) const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01648">matrix2d.h:1648</a></div></div>
<div class="ttc" id="group__FourierProjection_html_gabef83744f4e0571354f31586fb41d357"><div class="ttname"><a href="group__FourierProjection.html#gabef83744f4e0571354f31586fb41d357">Projection::euler</a></div><div class="ttdeci">Matrix2D&lt; double &gt; euler</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8h_source.html#l00074">fourier_projection.h:74</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="group__FourierProjection_html_ga38fc7e819f167ed62bf63c13e1058aab"><div class="ttname"><a href="group__FourierProjection.html#ga38fc7e819f167ed62bf63c13e1058aab">Projection::setAngles</a></div><div class="ttdeci">void setAngles(double _rot, double _tilt, double _psi)</div><div class="ttdef"><b>Definition:</b> <a href="fourier__projection_8cpp_source.html#l00041">fourier_projection.cpp:41</a></div></div>
<div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
<div class="ttc" id="classPhantom_html_afa9738c948a9df13fdd2bb0f5657793a"><div class="ttname"><a href="classPhantom.html#afa9738c948a9df13fdd2bb0f5657793a">Phantom::project_to</a></div><div class="ttdeci">void project_to(Projection &amp;P, int Ydim, int Xdim, double rot, double tilt, double psi, const Matrix2D&lt; double &gt; *A=NULL) const </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l02576">phantom.cpp:2576</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a37d7660140e436c4960eb4922f06e945"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Phantom::project_to </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classProjection.html">Projection</a> &amp;&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>VP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>disappearing_th</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Project phantom using a conversion matrix. The same as before but this time the projection is supposed to be already resized and with the right center. The phantom projection is added to the already drawn projeciton. <a class="el" href="classEuler.html">Euler</a> angles of the projection are not set and the phantom volume is projected to the projection plane making use of the matrix provided (3x3) which is the needed transformation from the volume to the projection plane. Inside the projection plane only the first two coordinates are valid. If disappearing_th &lt; 1 then the ith phantom feature is skiped with a provability = 1-disappearing_th </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02616">2616</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;{</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> PV = VP.<a class="code" href="classMatrix2D.html#add8d2052c53fcf6689908614f67b9ee6">inv</a>();</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;    <span class="comment">// Project all features</span></div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    {</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__GeneralFunctions.html#ga882088c3e41f9fdd7c357e868c001ed5">rnd_unif</a>(0, 1) &lt; disappearing_th)</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;            <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classPhantom.html#afa9738c948a9df13fdd2bb0f5657793a">project_to</a>(P, VP, PV);</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    }</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;}</div><div class="ttc" id="classMatrix2D_html_add8d2052c53fcf6689908614f67b9ee6"><div class="ttname"><a href="classMatrix2D.html#add8d2052c53fcf6689908614f67b9ee6">Matrix2D::inv</a></div><div class="ttdeci">void inv(Matrix2D&lt; T &gt; &amp;result) const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01648">matrix2d.h:1648</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga882088c3e41f9fdd7c357e868c001ed5"><div class="ttname"><a href="group__GeneralFunctions.html#ga882088c3e41f9fdd7c357e868c001ed5">rnd_unif</a></div><div class="ttdeci">double rnd_unif()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00431">xmipp_funcs.cpp:431</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
<div class="ttc" id="classPhantom_html_afa9738c948a9df13fdd2bb0f5657793a"><div class="ttname"><a href="classPhantom.html#afa9738c948a9df13fdd2bb0f5657793a">Phantom::project_to</a></div><div class="ttdeci">void project_to(Projection &amp;P, int Ydim, int Xdim, double rot, double tilt, double psi, const Matrix2D&lt; double &gt; *A=NULL) const </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l02576">phantom.cpp:2576</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab6e22a11d2edae0aabebad15e982112a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Phantom::read </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFileName.html">FileName</a> &amp;&#160;</td>
          <td class="paramname"><em>fn_phantom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>apply_scale</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read a phantom file. The file must accomplish the structure given in <a class="el" href="group__Phantoms.html">Phantoms</a> .</p>
<p>If you don't apply the scale then all spatial coordinates are expressed in the given scale units. I.e., if the scale is 0.25 that means that every voxel in the voxel phantom represent 4 length units (usually Angstroms). If the scale is applied, then coordinates are expressed in voxel edge units. Otherwise, coordinates are expressed in length units (usually Angstroms).</p>
<p>We recommend apply_scale=false only if you plan to modify the description file without produstd::cing projections, voxel phantoms, ... </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02155">2155</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;{</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    FILE *fh_phantom;</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    <span class="keywordtype">char</span> line[256];</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    <span class="keywordtype">int</span> Global_Feature_Read = 0; <span class="comment">// Indicates if the line with volume dimensions</span></div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    <span class="comment">// has been already read</span></div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="keywordtype">int</span>        stat;</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    <a class="code" href="classSphere.html">Sphere</a>     *sph;</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    <a class="code" href="classBlob.html">Blob</a>       *blo;</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    <a class="code" href="classGaussian.html">Gaussian</a>   *gau;</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    <a class="code" href="classCylinder.html">Cylinder</a>   *cyl;</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    <a class="code" href="classDCylinder.html">DCylinder</a>  *dcy;</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    <a class="code" href="classCube.html">Cube</a>       *cub;</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    <a class="code" href="classEllipsoid.html">Ellipsoid</a>  *ell;</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    <a class="code" href="classCone.html">Cone</a>       *con;</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    <a class="code" href="classFeature.html">Feature</a>    *feat, *scaled_feat;</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    <a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a> feat_type;</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    <span class="keywordtype">double</span>     scale = 1.;          <span class="comment">// The scale factor is not stored</span></div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    <span class="keywordtype">char</span>       straux[6];</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    <span class="comment">// Clear actual phantom</span></div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    <a class="code" href="classPhantom.html#afeea31372789c73608719546292722cb">clear</a>();</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    <span class="keywordflow">if</span> (fn_phantom.<a class="code" href="classFileName.html#a1a69f3a90c51e46490576d28f9eddfab">isMetaData</a>())</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    {</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;        <a class="code" href="classMetaData.html">MetaData</a> MD1;  <span class="comment">//MetaData for the first block (phantom parameters)</span></div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;        <a class="code" href="classMetaData.html">MetaData</a> MD2; <span class="comment">//MetaData for the second block (phantom parameters)</span></div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        std::vector &lt;double&gt; TempVec; <span class="comment">// A temporary vector for reading vector data</span></div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;        <span class="keywordtype">size_t</span> objId;</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;        <span class="comment">// Assign different blocks to different MetaDatas</span></div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;        MD1.<a class="code" href="classMetaData.html#ab7f8d43d77647ade923e6cd63eafdd03">read</a>((<a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a>)<span class="stringliteral">&quot;block1@&quot;</span>+fn_phantom.c_str());</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;        MD2.<a class="code" href="classMetaData.html#ab7f8d43d77647ade923e6cd63eafdd03">read</a>((<a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a>)<span class="stringliteral">&quot;block2@&quot;</span>+fn_phantom.c_str());</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;        <span class="comment">// Read the first block containing parameters of phantom</span></div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;        objId = MD1.<a class="code" href="classMetaData.html#a9f88f42faff8bfbc1952c50e2a6ffc42">firstObject</a>();</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;        MD1.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acebb0cf3608de7954405665047173186">MDL_DIMENSIONS_3D</a>, TempVec, objId);</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;        <span class="keywordflow">if</span> (TempVec.size()&lt;3)</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;            <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aab06d98c5deb993d88b1121766274b6e8">ERR_ARG_MISSING</a>, <a class="code" href="classMDL.html#a8203710a5af76f8877c4a59f0d8fcb6b">MDL::label2Str</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acebb0cf3608de7954405665047173186">MDL_DIMENSIONS_3D</a>) + <span class="stringliteral">&quot; problems with project dimensions&quot;</span>);</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;        <a class="code" href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">xdim</a> = (int)TempVec[0];</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;        <a class="code" href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">ydim</a> = (int)TempVec[1];</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;        <a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a> = (int)TempVec[2];</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;        <span class="keywordflow">if</span> (!MD1.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a32492cfdbf6a8f2ef9fe7e77b3e0e164">MDL_PHANTOM_BGDENSITY</a>, <a class="code" href="classPhantom.html#a97a780e1b83fef7587ac4f48b8ea0fb5">Background_Density</a>, objId))</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;            <a class="code" href="classPhantom.html#a97a780e1b83fef7587ac4f48b8ea0fb5">Background_Density</a> = 0;</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;        <span class="keywordflow">if</span> (!MD1.<a class="code" href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aad487c1de68c3a3b8f44773ee776d87c">MDL_SCALE</a>, scale, objId))</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;            scale = 1;</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;        <span class="keywordflow">if</span> (apply_scale)</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;        {</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;            <a class="code" href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">xdim</a> = (int) <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(scale * <a class="code" href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">xdim</a>);</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;            <a class="code" href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">ydim</a> = (int) <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(scale * <a class="code" href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">ydim</a>);</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;            <a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a> = (int) <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(scale * <a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a>);</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;            <a class="code" href="classPhantom.html#ad6b0d6771b22d06535000de7ba3b7f52">current_scale</a> = 1;</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;        }</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;            <a class="code" href="classPhantom.html#ad6b0d6771b22d06535000de7ba3b7f52">current_scale</a> = scale;</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;        <span class="comment">// Read the second block</span></div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;        <a class="code" href="classMDRow.html">MDRow</a> FeatureRow;</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;        <a class="code" href="group__MetaData.html#ga85652b971edca3acc93a9f1bef2f17f6">FOR_ALL_OBJECTS_IN_METADATA</a>(MD2)</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        {</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;            MD2.<a class="code" href="classMetaData.html#a3f9ef726946a752c76a6bc622e2092c9">getRow</a>(FeatureRow, __iter.objId);</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;            <span class="keywordflow">if</span>(!FeatureRow.<a class="code" href="classMDRow.html#a05a9538d1fe892459ed8405862ea0f76">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acecdff1b6573be9445a251278b6d72e6">MDL_PHANTOM_FEATURE_TYPE</a>, feat_type))</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;                <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aab06d98c5deb993d88b1121766274b6e8">ERR_ARG_MISSING</a>, <a class="code" href="classMDL.html#a8203710a5af76f8877c4a59f0d8fcb6b">MDL::label2Str</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acecdff1b6573be9445a251278b6d72e6">MDL_PHANTOM_FEATURE_TYPE</a>) + <span class="stringliteral">&quot; feature type not present&quot;</span>);</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;            <span class="keywordflow">if</span> (feat_type == <span class="stringliteral">&quot;sph&quot;</span>)</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;            {</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;                sph = <span class="keyword">new</span> <a class="code" href="classSphere.html">Sphere</a>;</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;                feat = sph;</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;                sph-&gt;<a class="code" href="classFeature.html#a1843de345993d7491c653d769ee029b6">read</a>(FeatureRow);</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;            }</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (feat_type == <span class="stringliteral">&quot;blo&quot;</span>)</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;            {</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;                blo = <span class="keyword">new</span> <a class="code" href="classBlob.html">Blob</a>;</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;                feat = blo;</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                blo-&gt;<a class="code" href="classFeature.html#a1843de345993d7491c653d769ee029b6">read</a>(FeatureRow);</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;            }</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (feat_type == <span class="stringliteral">&quot;gau&quot;</span>)</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;            {</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                gau = <span class="keyword">new</span> <a class="code" href="classGaussian.html">Gaussian</a>;</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                feat = gau;</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                gau-&gt;<a class="code" href="classFeature.html#a1843de345993d7491c653d769ee029b6">read</a>(FeatureRow);</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;            }</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (feat_type == <span class="stringliteral">&quot;cyl&quot;</span>)</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;            {</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;                cyl = <span class="keyword">new</span> <a class="code" href="classCylinder.html">Cylinder</a>;</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;                feat = cyl;</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                cyl-&gt;<a class="code" href="classFeature.html#a1843de345993d7491c653d769ee029b6">read</a>(FeatureRow);</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;            }</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (feat_type == <span class="stringliteral">&quot;dcy&quot;</span>)</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;            {</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;                dcy = <span class="keyword">new</span> <a class="code" href="classDCylinder.html">DCylinder</a>;</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;                feat = dcy;</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;                dcy-&gt;<a class="code" href="classFeature.html#a1843de345993d7491c653d769ee029b6">read</a>(FeatureRow);</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;            }</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (feat_type == <span class="stringliteral">&quot;cub&quot;</span>)</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;            {</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;                cub = <span class="keyword">new</span> <a class="code" href="classCube.html">Cube</a>;</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;                feat = cub;</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;                cub-&gt;<a class="code" href="classFeature.html#a1843de345993d7491c653d769ee029b6">read</a>(FeatureRow);</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;            }</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (feat_type == <span class="stringliteral">&quot;ell&quot;</span>)</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;            {</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;                ell = <span class="keyword">new</span> <a class="code" href="classEllipsoid.html">Ellipsoid</a>;</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;                feat = ell;</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                ell-&gt;<a class="code" href="classFeature.html#a1843de345993d7491c653d769ee029b6">read</a>(FeatureRow);</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;            }</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (feat_type == <span class="stringliteral">&quot;con&quot;</span>)</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;            {</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;                con = <span class="keyword">new</span> <a class="code" href="classCone.html">Cone</a>;</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;                feat = con;</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;                con-&gt;<a class="code" href="classFeature.html#a1843de345993d7491c653d769ee029b6">read</a>(FeatureRow);</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;            }</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;                <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa99ae519fb00e32cc6e716cc01d21cadf">ERR_ARG_INCORRECT</a>, <a class="code" href="classMDL.html#a8203710a5af76f8877c4a59f0d8fcb6b">MDL::label2Str</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acecdff1b6573be9445a251278b6d72e6">MDL_PHANTOM_FEATURE_TYPE</a>) + <span class="stringliteral">&quot;Unknown feature type&quot;</span>);</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;            <span class="keywordflow">if</span> (apply_scale)</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;            {</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;                scaled_feat = feat-&gt;<a class="code" href="classFeature.html#a2f1c9056e82930b80b6eddc70e9f251b">scale</a>(scale);</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;                scaled_feat-&gt;<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a> = scaled_feat-&gt;<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a> * scale;</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;                <span class="keyword">delete</span> feat;</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;                <span class="comment">// Store feature</span></div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;                <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.push_back(scaled_feat);</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;            }</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;                <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.push_back(feat);</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;        }</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    }</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    {</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;        <span class="comment">// Open Volume Description File</span></div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;        <span class="keywordflow">if</span> ((fh_phantom = fopen(fn_phantom.c_str(), <span class="stringliteral">&quot;r&quot;</span>)) == NULL)</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;            <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aabda7431146b956debfa7f89164af1790">ERR_IO_NOTOPEN</a>, (<a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a>)<span class="stringliteral">&quot;Phantom::read: Cannot open the phantom file: &quot;</span></div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;                         + fn_phantom);</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;        <a class="code" href="classPhantom.html#a37fc05be4b1941a82a04df83b8672c3a">fn</a> = fn_phantom;</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;        <span class="keywordtype">size_t</span> lineNumber = 0;</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;        <span class="comment">// Read the file</span></div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;        <span class="keywordflow">while</span> (fgets(line, 256, fh_phantom) != NULL)</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;        {</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;            ++lineNumber;</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;            <span class="keywordflow">if</span> (line[0] == 0)</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;            <span class="keywordflow">if</span> (line[0] == <span class="charliteral">&#39;#&#39;</span>)</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;            <span class="keywordflow">if</span> (line[0] == <span class="charliteral">&#39;\n&#39;</span>)</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;            <span class="comment">// Read volume dimensions and global density .........................</span></div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;            <span class="keywordflow">if</span> (Global_Feature_Read == 0)</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;            {</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;                Global_Feature_Read = 1;</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;                stat = sscanf(line, <span class="stringliteral">&quot;%d %d %d %lf %lf&quot;</span>, &amp;xdim, &amp;ydim, &amp;<a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a>,</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;                              &amp;<a class="code" href="classPhantom.html#a97a780e1b83fef7587ac4f48b8ea0fb5">Background_Density</a>, &amp;scale);</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;                <span class="keywordflow">if</span> (stat &lt; 3)</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;                    <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa3841b4acd9ccaecf1f418cb40b1537f1">ERR_IO_NOREAD</a>, <span class="stringliteral">&quot;Phantom::read: check the volume&quot;</span></div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;                                 <span class="stringliteral">&quot; dimensions and global density in volume description file&quot;</span>);</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;                <span class="keywordflow">if</span> (stat &lt;= 3)</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;                    <a class="code" href="classPhantom.html#a97a780e1b83fef7587ac4f48b8ea0fb5">Background_Density</a> = 0;</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;                <span class="keywordflow">if</span> (stat &lt;= 4)</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;                    scale = 1;</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;                <span class="keywordflow">if</span> (apply_scale)</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;                {</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;                    xdim = (int) <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(scale * xdim);</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;                    ydim = (int) <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(scale * ydim);</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;                    <a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a> = (int) <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(scale * <a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a>);</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;                    <a class="code" href="classPhantom.html#ad6b0d6771b22d06535000de7ba3b7f52">current_scale</a> = 1;</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;                }</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;                    <a class="code" href="classPhantom.html#ad6b0d6771b22d06535000de7ba3b7f52">current_scale</a> = scale;</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;            }</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;            <span class="comment">// Read feature description ..........................................</span></div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;            stat = sscanf(line, <span class="stringliteral">&quot;%s&quot;</span>, straux);</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;            feat_type = straux;</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;            <span class="keywordflow">if</span> (stat != 1)</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;                <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa3841b4acd9ccaecf1f418cb40b1537f1">ERR_IO_NOREAD</a>, <a class="code" href="group__StringUtilities.html#gaa405c9a5b808e428554e540028085dd3">formatString</a>(<span class="stringliteral">&quot;Phantom::read: Not correct feature type in line number %ld : \n%s&quot;</span>,lineNumber, line));</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;            <span class="keywordflow">if</span> (feat_type == <span class="stringliteral">&quot;sph&quot;</span>)</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;            {</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;                sph = <span class="keyword">new</span> <a class="code" href="classSphere.html">Sphere</a>;</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;                feat = sph;</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;                sph-&gt;<a class="code" href="classFeature.html#ade99a9be8ccf32211771399d3f9e607f">readCommon</a>(line);</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;                sph-&gt;<a class="code" href="classSphere.html#a15894367cf89506be509fdaec8d748ce">read_specific</a>(line);</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;            }</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (feat_type == <span class="stringliteral">&quot;blo&quot;</span>)</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;            {</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;                blo = <span class="keyword">new</span> <a class="code" href="classBlob.html">Blob</a>;</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;                feat = blo;</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;                blo-&gt;<a class="code" href="classFeature.html#ade99a9be8ccf32211771399d3f9e607f">readCommon</a>(line);</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;                blo-&gt;<a class="code" href="classBlob.html#a12493fd84fb6d16b4e0b2940cd103b07">read_specific</a>(line);</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;            }</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (feat_type == <span class="stringliteral">&quot;gau&quot;</span>)</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;            {</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;                gau = <span class="keyword">new</span> <a class="code" href="classGaussian.html">Gaussian</a>;</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;                feat = gau;</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;                gau-&gt;<a class="code" href="classFeature.html#ade99a9be8ccf32211771399d3f9e607f">readCommon</a>(line);</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;                gau-&gt;<a class="code" href="classGaussian.html#aaf20d9e77d59aca5da9422294ef54f52">read_specific</a>(line);</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;            }</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (feat_type == <span class="stringliteral">&quot;cyl&quot;</span>)</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;            {</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;                cyl = <span class="keyword">new</span> <a class="code" href="classCylinder.html">Cylinder</a>;</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;                feat = cyl;</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;                cyl-&gt;<a class="code" href="classFeature.html#ade99a9be8ccf32211771399d3f9e607f">readCommon</a>(line);</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;                cyl-&gt;<a class="code" href="classCylinder.html#a8b62fef96bc25f700bbab4cd0747274d">read_specific</a>(line);</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;            }</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (feat_type == <span class="stringliteral">&quot;dcy&quot;</span>)</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;            {</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;                dcy = <span class="keyword">new</span> <a class="code" href="classDCylinder.html">DCylinder</a>;</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;                feat = dcy;</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;                dcy-&gt;<a class="code" href="classFeature.html#ade99a9be8ccf32211771399d3f9e607f">readCommon</a>(line);</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;                dcy-&gt;<a class="code" href="classDCylinder.html#a95ce625713908c7072949e0aeccdfc1b">read_specific</a>(line);</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;            }</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (feat_type == <span class="stringliteral">&quot;cub&quot;</span>)</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;            {</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;                cub = <span class="keyword">new</span> <a class="code" href="classCube.html">Cube</a>;</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;                feat = cub;</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;                cub-&gt;<a class="code" href="classFeature.html#ade99a9be8ccf32211771399d3f9e607f">readCommon</a>(line);</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                cub-&gt;<a class="code" href="classCube.html#a37d70206bc2e4bf4854370439711626b">read_specific</a>(line);</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;            }</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (feat_type == <span class="stringliteral">&quot;ell&quot;</span>)</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;            {</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;                ell = <span class="keyword">new</span> <a class="code" href="classEllipsoid.html">Ellipsoid</a>;</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;                feat = ell;</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;                ell-&gt;<a class="code" href="classFeature.html#ade99a9be8ccf32211771399d3f9e607f">readCommon</a>(line);</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;                ell-&gt;<a class="code" href="classEllipsoid.html#a0d281a4a72ee24653e735544db554f85">read_specific</a>(line);</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;            }</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (feat_type == <span class="stringliteral">&quot;con&quot;</span>)</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;            {</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;                con = <span class="keyword">new</span> <a class="code" href="classCone.html">Cone</a>;</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;                feat = con;</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;                con-&gt;<a class="code" href="classFeature.html#ade99a9be8ccf32211771399d3f9e607f">readCommon</a>(line);</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;                con-&gt;<a class="code" href="classCone.html#abcf97052741e400986c297ed3d1eb351">read_specific</a>(line);</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;            }</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;                <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa3841b4acd9ccaecf1f418cb40b1537f1">ERR_IO_NOREAD</a>, (<a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a>)<span class="stringliteral">&quot;Phantom::read: Unknown feature type: &quot;</span> + line);</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;            <span class="comment">// Scale and Store feature</span></div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;            <span class="keywordflow">if</span> (apply_scale)</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;            {</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;                scaled_feat = feat-&gt;<a class="code" href="classFeature.html#a2f1c9056e82930b80b6eddc70e9f251b">scale</a>(scale);</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;                scaled_feat-&gt;<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a> = scaled_feat-&gt;<a class="code" href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Center</a> * scale;</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;                <span class="keyword">delete</span> feat;</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;                <span class="comment">// Store feature</span></div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;                <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.push_back(scaled_feat);</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;            }</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;                <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.push_back(feat);</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;        }</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;        fclose(fh_phantom);</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;        <a class="code" href="classPhantom.html#a08e07a6c798f13f5c87488704dd89791">phantom_scale</a> = scale;</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    }</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aab06d98c5deb993d88b1121766274b6e8"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aab06d98c5deb993d88b1121766274b6e8">ERR_ARG_MISSING</a></div><div class="ttdoc">Argument missing. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00119">xmipp_error.h:119</a></div></div>
<div class="ttc" id="classCone_html"><div class="ttname"><a href="classCone.html">Cone</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01274">phantom.h:1274</a></div></div>
<div class="ttc" id="classBlob_html"><div class="ttname"><a href="classBlob.html">Blob</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00572">phantom.h:572</a></div></div>
<div class="ttc" id="classPhantom_html_a08e07a6c798f13f5c87488704dd89791"><div class="ttname"><a href="classPhantom.html#a08e07a6c798f13f5c87488704dd89791">Phantom::phantom_scale</a></div><div class="ttdeci">double phantom_scale</div><div class="ttdoc">Param file scale. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01410">phantom.h:1410</a></div></div>
<div class="ttc" id="classPhantom_html_a614b76f0cf1bb8cfe7b98047f2b8dc7a"><div class="ttname"><a href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">Phantom::ydim</a></div><div class="ttdeci">int ydim</div><div class="ttdoc">Final volume Y dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01395">phantom.h:1395</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="classFeature_html_ade99a9be8ccf32211771399d3f9e607f"><div class="ttname"><a href="classFeature.html#ade99a9be8ccf32211771399d3f9e607f">Feature::readCommon</a></div><div class="ttdeci">void readCommon(char *line)</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l00276">phantom.cpp:276</a></div></div>
<div class="ttc" id="classGaussian_html_aaf20d9e77d59aca5da9422294ef54f52"><div class="ttname"><a href="classGaussian.html#aaf20d9e77d59aca5da9422294ef54f52">Gaussian::read_specific</a></div><div class="ttdeci">void read_specific(char *line)</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l00358">phantom.cpp:358</a></div></div>
<div class="ttc" id="classFeature_html_a45423ae0a78ea69cbf18bf69ebd13119"><div class="ttname"><a href="classFeature.html#a45423ae0a78ea69cbf18bf69ebd13119">Feature::Center</a></div><div class="ttdeci">Matrix1D&lt; double &gt; Center</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00113">phantom.h:113</a></div></div>
<div class="ttc" id="namespacetesting_1_1internal_html_a8e8ff5b11e64078831112677156cb111"><div class="ttname"><a href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">testing::internal::string</a></div><div class="ttdeci">::std::string string</div><div class="ttdef"><b>Definition:</b> <a href="gtest_8h_source.html#l01818">gtest.h:1818</a></div></div>
<div class="ttc" id="classFeature_html_a1843de345993d7491c653d769ee029b6"><div class="ttname"><a href="classFeature.html#a1843de345993d7491c653d769ee029b6">Feature::read</a></div><div class="ttdeci">void read(MDRow &amp;row)</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l00312">phantom.cpp:312</a></div></div>
<div class="ttc" id="classSphere_html_a15894367cf89506be509fdaec8d748ce"><div class="ttname"><a href="classSphere.html#a15894367cf89506be509fdaec8d748ce">Sphere::read_specific</a></div><div class="ttdeci">void read_specific(char *line)</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l00321">phantom.cpp:321</a></div></div>
<div class="ttc" id="classMetaData_html"><div class="ttname"><a href="classMetaData.html">MetaData</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00234">metadata.h:234</a></div></div>
<div class="ttc" id="classMetaData_html_ab7f8d43d77647ade923e6cd63eafdd03"><div class="ttname"><a href="classMetaData.html#ab7f8d43d77647ade923e6cd63eafdd03">MetaData::read</a></div><div class="ttdeci">void read(const FileName &amp;inFile, const std::vector&lt; MDLabel &gt; *desiredLabels=NULL, bool decomposeStack=true)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l01447">metadata.cpp:1447</a></div></div>
<div class="ttc" id="classMetaData_html_a3f9ef726946a752c76a6bc622e2092c9"><div class="ttname"><a href="classMetaData.html#a3f9ef726946a752c76a6bc622e2092c9">MetaData::getRow</a></div><div class="ttdeci">bool getRow(MDRow &amp;row, size_t id) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00321">metadata.cpp:321</a></div></div>
<div class="ttc" id="classGaussian_html"><div class="ttname"><a href="classGaussian.html">Gaussian</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00676">phantom.h:676</a></div></div>
<div class="ttc" id="classCube_html_a37d70206bc2e4bf4854370439711626b"><div class="ttname"><a href="classCube.html#a37d70206bc2e4bf4854370439711626b">Cube::read_specific</a></div><div class="ttdeci">void read_specific(char *line)</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l00426">phantom.cpp:426</a></div></div>
<div class="ttc" id="classCylinder_html"><div class="ttname"><a href="classCylinder.html">Cylinder</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00780">phantom.h:780</a></div></div>
<div class="ttc" id="classPhantom_html_a37fc05be4b1941a82a04df83b8672c3a"><div class="ttname"><a href="classPhantom.html#a37fc05be4b1941a82a04df83b8672c3a">Phantom::fn</a></div><div class="ttdeci">FileName fn</div><div class="ttdoc">Filename. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01389">phantom.h:1389</a></div></div>
<div class="ttc" id="classCone_html_abcf97052741e400986c297ed3d1eb351"><div class="ttname"><a href="classCone.html#abcf97052741e400986c297ed3d1eb351">Cone::read_specific</a></div><div class="ttdeci">void read_specific(char *line)</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l00476">phantom.cpp:476</a></div></div>
<div class="ttc" id="classMDRow_html_a05a9538d1fe892459ed8405862ea0f76"><div class="ttname"><a href="classMDRow.html#a05a9538d1fe892459ed8405862ea0f76">MDRow::getValue</a></div><div class="ttdeci">bool getValue(MDLabel label, T &amp;d) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l01130">metadata_label.h:1130</a></div></div>
<div class="ttc" id="classMetaData_html_a2239fbb7e492654f1e2866ab27492a5d"><div class="ttname"><a href="classMetaData.html#a2239fbb7e492654f1e2866ab27492a5d">MetaData::getValue</a></div><div class="ttdeci">bool getValue(MDObject &amp;mdValueOut, size_t id) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00217">metadata.cpp:217</a></div></div>
<div class="ttc" id="classEllipsoid_html"><div class="ttname"><a href="classEllipsoid.html">Ellipsoid</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01154">phantom.h:1154</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa99ae519fb00e32cc6e716cc01d21cadf"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa99ae519fb00e32cc6e716cc01d21cadf">ERR_ARG_INCORRECT</a></div><div class="ttdoc">Incorrect argument received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00118">xmipp_error.h:118</a></div></div>
<div class="ttc" id="classFeature_html"><div class="ttname"><a href="classFeature.html">Feature</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00087">phantom.h:87</a></div></div>
<div class="ttc" id="classCube_html"><div class="ttname"><a href="classCube.html">Cube</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01034">phantom.h:1034</a></div></div>
<div class="ttc" id="classFeature_html_a2f1c9056e82930b80b6eddc70e9f251b"><div class="ttname"><a href="classFeature.html#a2f1c9056e82930b80b6eddc70e9f251b">Feature::scale</a></div><div class="ttdeci">virtual Feature * scale(double factor) const =0</div></div>
<div class="ttc" id="group__MetaData_html_ga85652b971edca3acc93a9f1bef2f17f6"><div class="ttname"><a href="group__MetaData.html#ga85652b971edca3acc93a9f1bef2f17f6">FOR_ALL_OBJECTS_IN_METADATA</a></div><div class="ttdeci">#define FOR_ALL_OBJECTS_IN_METADATA(__md)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00081">metadata.h:81</a></div></div>
<div class="ttc" id="classPhantom_html_a97a780e1b83fef7587ac4f48b8ea0fb5"><div class="ttname"><a href="classPhantom.html#a97a780e1b83fef7587ac4f48b8ea0fb5">Phantom::Background_Density</a></div><div class="ttdeci">double Background_Density</div><div class="ttdoc">Final volume background density. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01401">phantom.h:1401</a></div></div>
<div class="ttc" id="classDCylinder_html_a95ce625713908c7072949e0aeccdfc1b"><div class="ttname"><a href="classDCylinder.html#a95ce625713908c7072949e0aeccdfc1b">DCylinder::read_specific</a></div><div class="ttdeci">void read_specific(char *line)</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l00402">phantom.cpp:402</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa3841b4acd9ccaecf1f418cb40b1537f1"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa3841b4acd9ccaecf1f418cb40b1537f1">ERR_IO_NOREAD</a></div><div class="ttdoc">Couldn&amp;#39;t read from file. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00144">xmipp_error.h:144</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78aad487c1de68c3a3b8f44773ee776d87c"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aad487c1de68c3a3b8f44773ee776d87c">MDL_SCALE</a></div><div class="ttdoc">scaling factor for an image or volume (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00385">metadata_label.h:385</a></div></div>
<div class="ttc" id="classDCylinder_html"><div class="ttname"><a href="classDCylinder.html">DCylinder</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00911">phantom.h:911</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a32492cfdbf6a8f2ef9fe7e77b3e0e164"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a32492cfdbf6a8f2ef9fe7e77b3e0e164">MDL_PHANTOM_BGDENSITY</a></div><div class="ttdoc">Phantom background density (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00320">metadata_label.h:320</a></div></div>
<div class="ttc" id="classBlob_html_a12493fd84fb6d16b4e0b2940cd103b07"><div class="ttname"><a href="classBlob.html#a12493fd84fb6d16b4e0b2940cd103b07">Blob::read_specific</a></div><div class="ttdeci">void read_specific(char *line)</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l00338">phantom.cpp:338</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78acecdff1b6573be9445a251278b6d72e6"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acecdff1b6573be9445a251278b6d72e6">MDL_PHANTOM_FEATURE_TYPE</a></div><div class="ttdoc">Type of the feature (Sphere, Blob, ...) (std::string) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00325">metadata_label.h:325</a></div></div>
<div class="ttc" id="classCylinder_html_a8b62fef96bc25f700bbab4cd0747274d"><div class="ttname"><a href="classCylinder.html#a8b62fef96bc25f700bbab4cd0747274d">Cylinder::read_specific</a></div><div class="ttdeci">void read_specific(char *line)</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l00377">phantom.cpp:377</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aabda7431146b956debfa7f89164af1790"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aabda7431146b956debfa7f89164af1790">ERR_IO_NOTOPEN</a></div><div class="ttdoc">File cannot be open. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00142">xmipp_error.h:142</a></div></div>
<div class="ttc" id="classPhantom_html_aaaeb13139ea6fdc791e551a83d2f4ece"><div class="ttname"><a href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">Phantom::zdim</a></div><div class="ttdeci">int zdim</div><div class="ttdoc">Final volume Z dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01398">phantom.h:1398</a></div></div>
<div class="ttc" id="classFileName_html_a1a69f3a90c51e46490576d28f9eddfab"><div class="ttname"><a href="classFileName.html#a1a69f3a90c51e46490576d28f9eddfab">FileName::isMetaData</a></div><div class="ttdeci">bool isMetaData(bool failIfNotExists=true) const </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8cpp_source.html#l00548">xmipp_filename.cpp:548</a></div></div>
<div class="ttc" id="classMDL_html_a8203710a5af76f8877c4a59f0d8fcb6b"><div class="ttname"><a href="classMDL.html#a8203710a5af76f8877c4a59f0d8fcb6b">MDL::label2Str</a></div><div class="ttdeci">static String label2Str(const MDLabel label)</div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8cpp_source.html#l00141">metadata_label.cpp:141</a></div></div>
<div class="ttc" id="classPhantom_html_afb218fc635f5c078cba041e538ea76b8"><div class="ttname"><a href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">Phantom::xdim</a></div><div class="ttdeci">int xdim</div><div class="ttdoc">Final volume X dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01392">phantom.h:1392</a></div></div>
<div class="ttc" id="group__StringUtilities_html_gaa405c9a5b808e428554e540028085dd3"><div class="ttname"><a href="group__StringUtilities.html#gaa405c9a5b808e428554e540028085dd3">formatString</a></div><div class="ttdeci">String formatString(const char *format,...)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__strings_8cpp_source.html#l00610">xmipp_strings.cpp:610</a></div></div>
<div class="ttc" id="classSphere_html"><div class="ttname"><a href="classSphere.html">Sphere</a></div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l00473">phantom.h:473</a></div></div>
<div class="ttc" id="classPhantom_html_ad6b0d6771b22d06535000de7ba3b7f52"><div class="ttname"><a href="classPhantom.html#ad6b0d6771b22d06535000de7ba3b7f52">Phantom::current_scale</a></div><div class="ttdeci">double current_scale</div><div class="ttdoc">Has been the scale applied? </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01404">phantom.h:1404</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78acebb0cf3608de7954405665047173186"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acebb0cf3608de7954405665047173186">MDL_DIMENSIONS_3D</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00357">metadata_label.h:357</a></div></div>
<div class="ttc" id="classMDRow_html"><div class="ttname"><a href="classMDRow.html">MDRow</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l01087">metadata_label.h:1087</a></div></div>
<div class="ttc" id="classMetaData_html_a9f88f42faff8bfbc1952c50e2a6ffc42"><div class="ttname"><a href="classMetaData.html#a9f88f42faff8bfbc1952c50e2a6ffc42">MetaData::firstObject</a></div><div class="ttdeci">size_t firstObject() const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00849">metadata.cpp:849</a></div></div>
<div class="ttc" id="classEllipsoid_html_a0d281a4a72ee24653e735544db554f85"><div class="ttname"><a href="classEllipsoid.html#a0d281a4a72ee24653e735544db554f85">Ellipsoid::read_specific</a></div><div class="ttdeci">void read_specific(char *line)</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l00451">phantom.cpp:451</a></div></div>
<div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
<div class="ttc" id="classPhantom_html_afeea31372789c73608719546292722cb"><div class="ttname"><a href="classPhantom.html#afeea31372789c73608719546292722cb">Phantom::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l02048">phantom.cpp:2048</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ade1a7ab8032d3194d0fc49409fd1133a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Phantom::rotate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>E</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Rotate. Rotate a phantom after a given 3D rotation. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02551">2551</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;{</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;        <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classPhantom.html#ade1a7ab8032d3194d0fc49409fd1133a">rotate</a>(E);</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;}</div><div class="ttc" id="classPhantom_html_ade1a7ab8032d3194d0fc49409fd1133a"><div class="ttname"><a href="classPhantom.html#ade1a7ab8032d3194d0fc49409fd1133a">Phantom::rotate</a></div><div class="ttdeci">void rotate(const Matrix2D&lt; double &gt; &amp;E)</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l02551">phantom.cpp:2551</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac53954a765a251bc106359ed7424ca0e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Phantom::selfApplyGeometry </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>inv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply a general geometric transformation. The transformation must be defined by a 4x4 matrix that can be generated using the geometric functions in xmippGeometry or xmippMatrix2D. The inv argument is either IS_INV or IS_NOT_INV. Matrices coming out from xmippGeometry for rotations, shifts, ... are not INV.</p>
<p>An exception is thrown if the matrix A is not valid. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02558">2558</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;{</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a>(A) != 4) || (<a class="code" href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a>(A) != 4))</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a>, <span class="stringliteral">&quot;Apply_geom3D: geometrical transformation is not 4x4&quot;</span>);</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    <span class="keywordflow">if</span> (A.<a class="code" href="classMatrix2D.html#aa4b62ee9cbc7a16d480d2a9b90df2758">isIdentity</a>())</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> T;</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    <span class="keywordflow">if</span> (inv == <a class="code" href="transformations_8h.html#a855436c9d0ed5174df8917d5239d7597">IS_INV</a>)</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;        T = A.<a class="code" href="classMatrix2D.html#add8d2052c53fcf6689908614f67b9ee6">inv</a>();</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;        T = A;</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;        <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classPhantom.html#ac53954a765a251bc106359ed7424ca0e">selfApplyGeometry</a>(T);</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;}</div><div class="ttc" id="group__Matrices_html_ga43e28f6079b3652588d5b76ff199ff1e"><div class="ttname"><a href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a></div><div class="ttdeci">#define MAT_YSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00125">matrix2d.h:125</a></div></div>
<div class="ttc" id="classMatrix2D_html_add8d2052c53fcf6689908614f67b9ee6"><div class="ttname"><a href="classMatrix2D.html#add8d2052c53fcf6689908614f67b9ee6">Matrix2D::inv</a></div><div class="ttdeci">void inv(Matrix2D&lt; T &gt; &amp;result) const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01648">matrix2d.h:1648</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa297d00ca1a4aefa6badbbe0f85dbf9fb">ERR_MATRIX_SIZE</a></div><div class="ttdoc">Problem with matrix size. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00157">xmipp_error.h:157</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="transformations_8h_html_a855436c9d0ed5174df8917d5239d7597"><div class="ttname"><a href="transformations_8h.html#a855436c9d0ed5174df8917d5239d7597">IS_INV</a></div><div class="ttdeci">#define IS_INV</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l00040">transformations.h:40</a></div></div>
<div class="ttc" id="classMatrix2D_html_aa4b62ee9cbc7a16d480d2a9b90df2758"><div class="ttname"><a href="classMatrix2D.html#aa4b62ee9cbc7a16d480d2a9b90df2758">Matrix2D::isIdentity</a></div><div class="ttdeci">bool isIdentity() const </div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l01759">matrix2d.h:1759</a></div></div>
<div class="ttc" id="group__Matrices_html_gacd5c6ac63f21fdbbd4343a9caf1ee9c6"><div class="ttname"><a href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a></div><div class="ttdeci">#define MAT_XSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00121">matrix2d.h:121</a></div></div>
<div class="ttc" id="classPhantom_html_ac53954a765a251bc106359ed7424ca0e"><div class="ttname"><a href="classPhantom.html#ac53954a765a251bc106359ed7424ca0e">Phantom::selfApplyGeometry</a></div><div class="ttdeci">void selfApplyGeometry(const Matrix2D&lt; double &gt; &amp;A, int inv)</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l02558">phantom.cpp:2558</a></div></div>
<div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a37c522b67cfd1f5552ec6d535c50cf5e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Phantom::shift </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shiftX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shiftY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shiftZ</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Shift. Shift all features in the phantom a given amount of voxels. See <a class="el" href="classFeature.html#a747114489bb6e6fcfe2f8d196d7f6ec1">Feature::shift</a>. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02544">2544</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;{</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;        <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classPhantom.html#a37c522b67cfd1f5552ec6d535c50cf5e">shift</a>(shiftX, shiftY, shiftZ);</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;}</div><div class="ttc" id="classPhantom_html_a37c522b67cfd1f5552ec6d535c50cf5e"><div class="ttname"><a href="classPhantom.html#a37c522b67cfd1f5552ec6d535c50cf5e">Phantom::shift</a></div><div class="ttdeci">void shift(double shiftX, double shiftY, double shiftZ)</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l02544">phantom.cpp:2544</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac1c033b91d3a7aa54cf90f137f152554"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Phantom::sketch_in </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>clean</em> = <code><a class="el" href="phantom_8h.html#a9b138cb57885319876cd956babcf38c1">DONT_CLEAN</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>colour</em> = <code>2</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sketch the surface of the phantom in the volume. This function allows you to draw only the surface of every feature (see <a class="el" href="classFeature.html#af92c06440e165f40c303e893564326f3">Feature::sketch_in</a> to see when a voxel is said to belong to the feature surface). The input volume might be cleaned (resized and the logical origin set at the physical center) or not according to the labels CLEAN or DONT_CLEAN (by default). The grey level for those voxels can be defined (by default, 2) and the colour is assigned </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02532">2532</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;{</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;    <span class="keywordflow">if</span> (clean)</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;    {</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;        V.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(<a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a>, <a class="code" href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">ydim</a>, <a class="code" href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">xdim</a>);</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;        V.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    }</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;        <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classPhantom.html#ac1c033b91d3a7aa54cf90f137f152554">sketch_in</a>(V, colour);</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="classPhantom_html_a614b76f0cf1bb8cfe7b98047f2b8dc7a"><div class="ttname"><a href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">Phantom::ydim</a></div><div class="ttdeci">int ydim</div><div class="ttdoc">Final volume Y dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01395">phantom.h:1395</a></div></div>
<div class="ttc" id="classPhantom_html_ac1c033b91d3a7aa54cf90f137f152554"><div class="ttname"><a href="classPhantom.html#ac1c033b91d3a7aa54cf90f137f152554">Phantom::sketch_in</a></div><div class="ttdeci">void sketch_in(MultidimArray&lt; double &gt; &amp;V, int clean=DONT_CLEAN, double colour=2)</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l02532">phantom.cpp:2532</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="classPhantom_html_aaaeb13139ea6fdc791e551a83d2f4ece"><div class="ttname"><a href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">Phantom::zdim</a></div><div class="ttdeci">int zdim</div><div class="ttdoc">Final volume Z dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01398">phantom.h:1398</a></div></div>
<div class="ttc" id="classPhantom_html_afb218fc635f5c078cba041e538ea76b8"><div class="ttname"><a href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">Phantom::xdim</a></div><div class="ttdeci">int xdim</div><div class="ttdoc">Final volume X dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01392">phantom.h:1392</a></div></div>
<div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aadfdf29586936b4be2e3d517788a4534"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Phantom::surface </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classImage.html">Image</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>P</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Surface of the phantom as in AFM. This function produces the surface of a phantom in a given image when measuring rays go POS_NEG or NEG_POS (from Z positive to Z negative, and viceversa). If rays reach point z0 and the phantom is not reached the surface for that point is z0, otherwise it is the z of the last voxel which is still outside the phantom.</p>
<p>This function throws an exception if z0 is outside the volume definition. If z0 is equal to zdim then it is not used.</p>
<p>The radius is the probe radius for the surface generation.</p>
<p>If the output image is not resized, it is resized to the Y and X dimensions of the phantom. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02630">2630</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;{</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a> != <a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a>)</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a> &lt; <a class="code" href="group__Macros.html#gaf809d730a6aa2f55cd4c3d0251f433a7">FIRST_XMIPP_INDEX</a>(<a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a>) || <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a> &gt; <a class="code" href="group__Macros.html#ga37ce421600f14de73f7006bf40cc5b3a">LAST_XMIPP_INDEX</a>(<a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a>))</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;            <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa640217ae2418fe91401329baab687564">ERR_INDEX_OUTOFBOUNDS</a>, <span class="stringliteral">&quot;Phantom::surface: z0 outside phantom&quot;</span>);</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Direction: &quot;</span> &lt;&lt; <a class="code" href="group__FringeProcessing.html#gad71cd7f2325be81202279ed730355092">direction</a> &lt;&lt; std::endl;</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;z0:        &quot;</span> &lt;&lt; <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>        &lt;&lt; std::endl;</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;zdim:      &quot;</span> &lt;&lt; <a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a>      &lt;&lt; std::endl;</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;</div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> aux1(3), aux2(3), aux3(3), r(3);</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>((*P)()) == 0)</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    {</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;        (*P)().resize(<a class="code" href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">ydim</a>, <a class="code" href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">xdim</a>);</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;        (*P)().setXmippOrigin();</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;    }</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(<a class="code" href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a>(*P))</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;    {</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Processing (&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;        <span class="comment">// Init ray</span></div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>;</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__FringeProcessing.html#gad71cd7f2325be81202279ed730355092">direction</a> == <a class="code" href="phantom_8h.html#ab244db15afdaaa0c02b4bb9709436137">POS_NEG</a>)</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;            k = <a class="code" href="group__Macros.html#ga37ce421600f14de73f7006bf40cc5b3a">LAST_XMIPP_INDEX</a>(<a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a>) + 1;</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;            k = <a class="code" href="group__Macros.html#gaf809d730a6aa2f55cd4c3d0251f433a7">FIRST_XMIPP_INDEX</a>(<a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a>) - 1;</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;        <span class="keywordtype">bool</span> finished;</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;        finished = <span class="keyword">false</span>;</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Initial k=&quot;</span> &lt;&lt; k &lt;&lt; std::endl;</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;        <span class="comment">// Check that it is not inside and move ray</span></div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;        <span class="comment">// at the end k takes the right value for the image</span></div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;        <span class="keywordflow">while</span> (!finished)</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;        {</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;            <a class="code" href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a>(r, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, k);</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Checking &quot;</span> &lt;&lt; r.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;            <span class="comment">// If it is inside move a step backward and finish</span></div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classPhantom.html#a9764f4155bb8be100c7cffb521536197">any_feature_intersects_sphere</a>(r, radius, aux1, aux2, aux3))</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;            {</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;                finished = <span class="keyword">true</span>;</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="group__FringeProcessing.html#gad71cd7f2325be81202279ed730355092">direction</a> == <a class="code" href="phantom_8h.html#ab244db15afdaaa0c02b4bb9709436137">POS_NEG</a>)</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;                    k++;</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;                    k--;</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;            }</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;            {</div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;                <span class="comment">// Else, move until you find z0</span></div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a> != <a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a>)</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="group__FringeProcessing.html#gad71cd7f2325be81202279ed730355092">direction</a> == <a class="code" href="phantom_8h.html#ab244db15afdaaa0c02b4bb9709436137">POS_NEG</a>)</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;                    {</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;                        k--;</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;                        <span class="keywordflow">if</span> (k &lt; <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>)</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;                        {</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;                            finished = <span class="keyword">true</span>;</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;                            k = <a class="code" href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a>(<a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>);</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;                        }</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;                    }</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;                    {</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;                        k++;</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;                        <span class="keywordflow">if</span> (k &gt; <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>)</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;                        {</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;                            finished = <span class="keyword">true</span>;</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;                            k = <a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>(<a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>);</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;                        }</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;                    }</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;                <span class="comment">// or you reach the end of the volume</span></div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="group__FringeProcessing.html#gad71cd7f2325be81202279ed730355092">direction</a> == <a class="code" href="phantom_8h.html#ab244db15afdaaa0c02b4bb9709436137">POS_NEG</a>)</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;                    {</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;                        k--;</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;                        <span class="keywordflow">if</span> (k &lt; <a class="code" href="group__Macros.html#gaf809d730a6aa2f55cd4c3d0251f433a7">FIRST_XMIPP_INDEX</a>(<a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a>))</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;                        {</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;                            finished = <span class="keyword">true</span>;</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;                        }</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;                    }</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;                    {</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;                        k++;</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;                        <span class="keywordflow">if</span> (k &gt; <a class="code" href="group__Macros.html#ga37ce421600f14de73f7006bf40cc5b3a">LAST_XMIPP_INDEX</a>(<a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a>))</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;                        {</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;                            finished = <span class="keyword">true</span>;</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;                        }</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;                    }</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;            }</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;        }</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;        <a class="code" href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a>(*P, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>;</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;    }</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;}</div><div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa640217ae2418fe91401329baab687564"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa640217ae2418fe91401329baab687564">ERR_INDEX_OUTOFBOUNDS</a></div><div class="ttdoc">Index out of bounds. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00137">xmipp_error.h:137</a></div></div>
<div class="ttc" id="classPhantom_html_a614b76f0cf1bb8cfe7b98047f2b8dc7a"><div class="ttname"><a href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">Phantom::ydim</a></div><div class="ttdeci">int ydim</div><div class="ttdoc">Final volume Y dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01395">phantom.h:1395</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="classPhantom_html_a9764f4155bb8be100c7cffb521536197"><div class="ttname"><a href="classPhantom.html#a9764f4155bb8be100c7cffb521536197">Phantom::any_feature_intersects_sphere</a></div><div class="ttdeci">int any_feature_intersects_sphere(const Matrix1D&lt; double &gt; &amp;r, double radius, Matrix1D&lt; double &gt; &amp;aux1, Matrix1D&lt; double &gt; &amp;aux2, Matrix1D&lt; double &gt; &amp;aux3) const </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l02483">phantom.cpp:2483</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a3f5c4dfb0dff56801752771f78265fbe"><div class="ttname"><a href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a></div><div class="ttdeci">#define z0</div></div>
<div class="ttc" id="group__Images_html_ga6096c97ad2ba182701f4877c206acb94"><div class="ttname"><a href="group__Images.html#ga6096c97ad2ba182701f4877c206acb94">IMGMATRIX</a></div><div class="ttdeci">#define IMGMATRIX(I)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00171">xmipp_image_base.h:171</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Macros_html_ga2f0eecb0f7856721f56faff8f27b0dc1"><div class="ttname"><a href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a></div><div class="ttdeci">#define FLOOR(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00240">xmipp_macros.h:240</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00400">multidim_array.h:400</a></div></div>
<div class="ttc" id="group__Macros_html_ga4ec18a98c812ab4d498c8111c193aa17"><div class="ttname"><a href="group__Macros.html#ga4ec18a98c812ab4d498c8111c193aa17">CEIL</a></div><div class="ttdeci">#define CEIL(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00225">xmipp_macros.h:225</a></div></div>
<div class="ttc" id="group__FringeProcessing_html_gad71cd7f2325be81202279ed730355092"><div class="ttname"><a href="group__FringeProcessing.html#gad71cd7f2325be81202279ed730355092">direction</a></div><div class="ttdeci">void direction(const MultidimArray&lt; double &gt; &amp;orMap, MultidimArray&lt; double &gt; &amp;qualityMap, double lambda, int size, MultidimArray&lt; double &gt; &amp;dirMap, int x, int y)</div><div class="ttdef"><b>Definition:</b> <a href="fringe__processing_8cpp_source.html#l00436">fringe_processing.cpp:436</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="phantom_8h_html_ab244db15afdaaa0c02b4bb9709436137"><div class="ttname"><a href="phantom_8h.html#ab244db15afdaaa0c02b4bb9709436137">POS_NEG</a></div><div class="ttdeci">#define POS_NEG</div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01629">phantom.h:1629</a></div></div>
<div class="ttc" id="classPhantom_html_aaaeb13139ea6fdc791e551a83d2f4ece"><div class="ttname"><a href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">Phantom::zdim</a></div><div class="ttdeci">int zdim</div><div class="ttdoc">Final volume Z dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01398">phantom.h:1398</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Macros_html_gaf809d730a6aa2f55cd4c3d0251f433a7"><div class="ttname"><a href="group__Macros.html#gaf809d730a6aa2f55cd4c3d0251f433a7">FIRST_XMIPP_INDEX</a></div><div class="ttdeci">#define FIRST_XMIPP_INDEX(size)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00439">xmipp_macros.h:439</a></div></div>
<div class="ttc" id="classPhantom_html_afb218fc635f5c078cba041e538ea76b8"><div class="ttname"><a href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">Phantom::xdim</a></div><div class="ttdeci">int xdim</div><div class="ttdoc">Final volume X dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01392">phantom.h:1392</a></div></div>
<div class="ttc" id="group__Vectors_html_ga6c6b4d4f88daca5e1d8e171bec3b4af0"><div class="ttname"><a href="group__Vectors.html#ga6c6b4d4f88daca5e1d8e171bec3b4af0">VECTOR_R3</a></div><div class="ttdeci">#define VECTOR_R3(v, x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00127">matrix1d.h:127</a></div></div>
<div class="ttc" id="group__Macros_html_ga37ce421600f14de73f7006bf40cc5b3a"><div class="ttname"><a href="group__Macros.html#ga37ce421600f14de73f7006bf40cc5b3a">LAST_XMIPP_INDEX</a></div><div class="ttdeci">#define LAST_XMIPP_INDEX(size)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00448">xmipp_macros.h:448</a></div></div>
<div class="ttc" id="group__Images_html_gaad11fc7e221702e9f1adeb445ba5db9c"><div class="ttname"><a href="group__Images.html#gaad11fc7e221702e9f1adeb445ba5db9c">IMGPIXEL</a></div><div class="ttdeci">#define IMGPIXEL(I, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00176">xmipp_image_base.h:176</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3998b8ff9f2524f94d263aea70ea6034"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Phantom::volume </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the volume of all the features. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02146">2146</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;{</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <span class="keywordtype">double</span> retval = 0;</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;        retval += <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classPhantom.html#a3998b8ff9f2524f94d263aea70ea6034">volume</a>();</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    <span class="keywordflow">return</span> retval;</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;}</div><div class="ttc" id="classPhantom_html_a3998b8ff9f2524f94d263aea70ea6034"><div class="ttname"><a href="classPhantom.html#a3998b8ff9f2524f94d263aea70ea6034">Phantom::volume</a></div><div class="ttdeci">double volume() const </div><div class="ttdoc">Return the volume of all the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l02146">phantom.cpp:2146</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa22801183cc6354029379eb3547c4ab7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Phantom::voxel_inside_any_feat </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>aux1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>aux2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Speeded up voxel inside any feature. This function tells you if the voxel of size 1x1x1 whose center is at position r is inside any of the features. A voxel is said to be inside a feature if it shares at least 1 corner with the feature. This function returns the first feature of the list containing the voxel. Features are numbered as 1, 2, ... If the voxel is not in any feature the function returns 0.</p>
<p>aux1 and aux2, are two vectors of dimension 3. They must be supplied in order to gain speed in the calculations. This is very useful when checking if many voxels are inside any feature. See also <a class="el" href="classFeature.html#a86351acf111729baa92dfc2a5b659ba7">Feature::voxel_inside</a> to know more. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02463">2463</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;{</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    <span class="keywordtype">int</span> inside, current_i;</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    <span class="keywordtype">double</span> current_density;</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    current_i = 0;</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    current_density = <a class="code" href="classPhantom.html#a97a780e1b83fef7587ac4f48b8ea0fb5">Background_Density</a>;</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    {</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;        inside = <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;voxel_inside(r, aux1, aux2);</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;        <span class="keywordflow">if</span> (inside != 0 &amp;&amp; <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;Density &gt; current_density)</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;        {</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;            current_i = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1;</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;            current_density = <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;Density;</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;        }</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    }</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;    <span class="keywordflow">return</span> current_i;</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;}</div><div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classPhantom_html_a97a780e1b83fef7587ac4f48b8ea0fb5"><div class="ttname"><a href="classPhantom.html#a97a780e1b83fef7587ac4f48b8ea0fb5">Phantom::Background_Density</a></div><div class="ttdeci">double Background_Density</div><div class="ttdoc">Final volume background density. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01401">phantom.h:1401</a></div></div>
<div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aca9f83d30578397cc3be9a1d98c7bd63"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Phantom::voxel_inside_any_feat </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Voxel inside any feature. The same as the previous one but you needn't supply the extra auxiliar vectors. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l01523">1523</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>
<div class="fragment"><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    {</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> aux1(3), aux2(3);</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classPhantom.html#aa22801183cc6354029379eb3547c4ab7">voxel_inside_any_feat</a>(r, aux1, aux2);</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    }</div><div class="ttc" id="classPhantom_html_aa22801183cc6354029379eb3547c4ab7"><div class="ttname"><a href="classPhantom.html#aa22801183cc6354029379eb3547c4ab7">Phantom::voxel_inside_any_feat</a></div><div class="ttdeci">int voxel_inside_any_feat(const Matrix1D&lt; double &gt; &amp;r, Matrix1D&lt; double &gt; &amp;aux1, Matrix1D&lt; double &gt; &amp;aux2) const </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8cpp_source.html#l02463">phantom.cpp:2463</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9536e9dacdeb45c3a2abb7061121d59f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Phantom::write </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFileName.html">FileName</a> &amp;&#160;</td>
          <td class="paramname"><em>fn_phantom</em> = <code>&quot;&quot;</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write a phantom file in the standard feature format. You may rename the file or not giving a different name in the write call. </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02423">2423</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;{</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    <a class="code" href="classMetaData.html">MetaData</a> MD1;  <span class="comment">//MetaData for phanto global parameters</span></div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    <a class="code" href="classMetaData.html">MetaData</a> MD2;  <span class="comment">//MetaData for Feature parameters</span></div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    std::vector&lt;double&gt; FCVect(3);  <span class="comment">//For the center of feature</span></div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    <span class="keywordtype">size_t</span> id;</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    <span class="comment">// Write global parameters to the first block</span></div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    std::vector&lt;double&gt; PCVector;  <span class="comment">//For the center of Phantom</span></div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    MD1.<a class="code" href="classMetaData.html#aea7da3ed03bab479250fd4017c43c924">setColumnFormat</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    <span class="keywordtype">id</span> = MD1.<a class="code" href="classMetaData.html#acd6018636eda733443f3df6c61978faa">addObject</a>();</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;    PCVector.push_back(<a class="code" href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">xdim</a>);</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    PCVector.push_back(<a class="code" href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">ydim</a>);</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    PCVector.push_back(<a class="code" href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">zdim</a>);</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    MD1.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acebb0cf3608de7954405665047173186">MDL_DIMENSIONS_3D</a>, PCVector, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    MD1.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a32492cfdbf6a8f2ef9fe7e77b3e0e164">MDL_PHANTOM_BGDENSITY</a>, <a class="code" href="classPhantom.html#a97a780e1b83fef7587ac4f48b8ea0fb5">Background_Density</a>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPhantom.html#ad6b0d6771b22d06535000de7ba3b7f52">current_scale</a> != 1)</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;        MD1.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aad487c1de68c3a3b8f44773ee776d87c">MDL_SCALE</a>, <a class="code" href="classPhantom.html#ad6b0d6771b22d06535000de7ba3b7f52">current_scale</a>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;        MD1.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aad487c1de68c3a3b8f44773ee776d87c">MDL_SCALE</a>, 1.0, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;    MD1.<a class="code" href="classMetaData.html#a163fee49247af4f55802e8480503b342">write</a>((<a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a>)<span class="stringliteral">&quot;block1@&quot;</span>+fn_phantom.c_str(), <a class="code" href="group__MetaData.html#ggaf446b6aff4a8c034231bfa3e1484bc47aca6136ade8aaab2a5da1a8f56f8c6dd0">MD_OVERWRITE</a>);</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;    <span class="comment">// Write specific parameters</span></div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    <a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a> SAddAssign;  <span class="comment">// string variab for feature operation (+/=)</span></div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;    {</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;        <span class="keywordtype">id</span> = MD2.<a class="code" href="classMetaData.html#acd6018636eda733443f3df6c61978faa">addObject</a>();</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;        SAddAssign = <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;Add_Assign;</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;        MD2.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acecdff1b6573be9445a251278b6d72e6">MDL_PHANTOM_FEATURE_TYPE</a>,<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;Type, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;        MD2.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aece849675970cf461aee160553150539">MDL_PHANTOM_FEATURE_OPERATION</a>, SAddAssign, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;        MD2.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aa8a3fe90d0810c653bc9a8a5a23719e1">MDL_PHANTOM_FEATURE_DENSITY</a>, <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;Density, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;        FCVect[0] = <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;Center);</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;        FCVect[1] = <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;Center);</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;        FCVect[2] = <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(<a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;Center);</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;        MD2.<a class="code" href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">setValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ae62481e20c2f0bd4e58fbe55d2bb4a7a">MDL_PHANTOM_FEATURE_CENTER</a>, FCVect, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;        <a class="code" href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">VF</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;feat_printm(MD2, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    }</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    MD2.<a class="code" href="classMetaData.html#a163fee49247af4f55802e8480503b342">write</a>((<a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a>)<span class="stringliteral">&quot;block2@&quot;</span>+fn_phantom.c_str(), <a class="code" href="group__MetaData.html#ggaf446b6aff4a8c034231bfa3e1484bc47ae658bd63b5c203ea5e350a42881a57ca">MD_APPEND</a>);</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;}</div><div class="ttc" id="classMetaData_html_a163fee49247af4f55802e8480503b342"><div class="ttname"><a href="classMetaData.html#a163fee49247af4f55802e8480503b342">MetaData::write</a></div><div class="ttdeci">void write(const FileName &amp;outFile, WriteModeMetaData mode=MD_OVERWRITE) const </div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00907">metadata.cpp:907</a></div></div>
<div class="ttc" id="classPhantom_html_a614b76f0cf1bb8cfe7b98047f2b8dc7a"><div class="ttname"><a href="classPhantom.html#a614b76f0cf1bb8cfe7b98047f2b8dc7a">Phantom::ydim</a></div><div class="ttdeci">int ydim</div><div class="ttdoc">Final volume Y dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01395">phantom.h:1395</a></div></div>
<div class="ttc" id="namespacetesting_1_1internal_html_a8e8ff5b11e64078831112677156cb111"><div class="ttname"><a href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">testing::internal::string</a></div><div class="ttdeci">::std::string string</div><div class="ttdef"><b>Definition:</b> <a href="gtest_8h_source.html#l01818">gtest.h:1818</a></div></div>
<div class="ttc" id="classMetaData_html"><div class="ttname"><a href="classMetaData.html">MetaData</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00234">metadata.h:234</a></div></div>
<div class="ttc" id="classMetaData_html_acd6018636eda733443f3df6c61978faa"><div class="ttname"><a href="classMetaData.html#acd6018636eda733443f3df6c61978faa">MetaData::addObject</a></div><div class="ttdeci">size_t addObject()</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00750">metadata.cpp:750</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78aa8a3fe90d0810c653bc9a8a5a23719e1"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aa8a3fe90d0810c653bc9a8a5a23719e1">MDL_PHANTOM_FEATURE_DENSITY</a></div><div class="ttdoc">The density of the feature (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00322">metadata_label.h:322</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="classPhantom_html_a97a780e1b83fef7587ac4f48b8ea0fb5"><div class="ttname"><a href="classPhantom.html#a97a780e1b83fef7587ac4f48b8ea0fb5">Phantom::Background_Density</a></div><div class="ttdeci">double Background_Density</div><div class="ttdoc">Final volume background density. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01401">phantom.h:1401</a></div></div>
<div class="ttc" id="group__MetaData_html_ggaf446b6aff4a8c034231bfa3e1484bc47ae658bd63b5c203ea5e350a42881a57ca"><div class="ttname"><a href="group__MetaData.html#ggaf446b6aff4a8c034231bfa3e1484bc47ae658bd63b5c203ea5e350a42881a57ca">MD_APPEND</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00060">metadata.h:60</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78aad487c1de68c3a3b8f44773ee776d87c"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aad487c1de68c3a3b8f44773ee776d87c">MDL_SCALE</a></div><div class="ttdoc">scaling factor for an image or volume (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00385">metadata_label.h:385</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a32492cfdbf6a8f2ef9fe7e77b3e0e164"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a32492cfdbf6a8f2ef9fe7e77b3e0e164">MDL_PHANTOM_BGDENSITY</a></div><div class="ttdoc">Phantom background density (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00320">metadata_label.h:320</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78acecdff1b6573be9445a251278b6d72e6"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acecdff1b6573be9445a251278b6d72e6">MDL_PHANTOM_FEATURE_TYPE</a></div><div class="ttdoc">Type of the feature (Sphere, Blob, ...) (std::string) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00325">metadata_label.h:325</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78aece849675970cf461aee160553150539"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78aece849675970cf461aee160553150539">MDL_PHANTOM_FEATURE_OPERATION</a></div><div class="ttdoc">Operation in case of overlapping features (+,-) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00323">metadata_label.h:323</a></div></div>
<div class="ttc" id="classMetaData_html_adf4ee2ad1ad0964990a8a11a2109d578"><div class="ttname"><a href="classMetaData.html#adf4ee2ad1ad0964990a8a11a2109d578">MetaData::setValue</a></div><div class="ttdeci">bool setValue(const MDLabel label, const T &amp;valueIn, size_t id)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00550">metadata.h:550</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78ae62481e20c2f0bd4e58fbe55d2bb4a7a"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ae62481e20c2f0bd4e58fbe55d2bb4a7a">MDL_PHANTOM_FEATURE_CENTER</a></div><div class="ttdoc">Center of the feature (vector double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00321">metadata_label.h:321</a></div></div>
<div class="ttc" id="classPhantom_html_aaaeb13139ea6fdc791e551a83d2f4ece"><div class="ttname"><a href="classPhantom.html#aaaeb13139ea6fdc791e551a83d2f4ece">Phantom::zdim</a></div><div class="ttdeci">int zdim</div><div class="ttdoc">Final volume Z dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01398">phantom.h:1398</a></div></div>
<div class="ttc" id="classPhantom_html_afb218fc635f5c078cba041e538ea76b8"><div class="ttname"><a href="classPhantom.html#afb218fc635f5c078cba041e538ea76b8">Phantom::xdim</a></div><div class="ttdeci">int xdim</div><div class="ttdoc">Final volume X dimension. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01392">phantom.h:1392</a></div></div>
<div class="ttc" id="classMetaData_html_aea7da3ed03bab479250fd4017c43c924"><div class="ttname"><a href="classMetaData.html#aea7da3ed03bab479250fd4017c43c924">MetaData::setColumnFormat</a></div><div class="ttdeci">void setColumnFormat(bool column)</div><div class="ttdef"><b>Definition:</b> <a href="metadata_8cpp_source.html#l00620">metadata.cpp:620</a></div></div>
<div class="ttc" id="classPhantom_html_ad6b0d6771b22d06535000de7ba3b7f52"><div class="ttname"><a href="classPhantom.html#ad6b0d6771b22d06535000de7ba3b7f52">Phantom::current_scale</a></div><div class="ttdeci">double current_scale</div><div class="ttdoc">Has been the scale applied? </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01404">phantom.h:1404</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78acebb0cf3608de7954405665047173186"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acebb0cf3608de7954405665047173186">MDL_DIMENSIONS_3D</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00357">metadata_label.h:357</a></div></div>
<div class="ttc" id="group__MetaData_html_ggaf446b6aff4a8c034231bfa3e1484bc47aca6136ade8aaab2a5da1a8f56f8c6dd0"><div class="ttname"><a href="group__MetaData.html#ggaf446b6aff4a8c034231bfa3e1484bc47aca6136ade8aaab2a5da1a8f56f8c6dd0">MD_OVERWRITE</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata_8h_source.html#l00059">metadata.h:59</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
<div class="ttc" id="classPhantom_html_ab37a930cd36cd7d25a11da6bb0f3ce7f"><div class="ttname"><a href="classPhantom.html#ab37a930cd36cd7d25a11da6bb0f3ce7f">Phantom::VF</a></div><div class="ttdeci">std::vector&lt; Feature * &gt; VF</div><div class="ttdoc">List with the features. </div><div class="ttdef"><b>Definition:</b> <a href="phantom_8h_source.html#l01413">phantom.h:1413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="a4c9ed4267360de6b707902f0b0b1f902"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream&amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classPhantom.html">Phantom</a> &amp;&#160;</td>
          <td class="paramname"><em>f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Show a phantom file. The more descriptive format is used instead of the standard <a class="el" href="classFeature.html">Feature</a> format </p>

<p>Definition at line <a class="el" href="phantom_8cpp_source.html#l02411">2411</a> of file <a class="el" href="phantom_8cpp_source.html">phantom.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;{</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Phantom ---------------------------------------\n&quot;</span>;</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Dimensions: &quot;</span> &lt;&lt; P.xdim &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; P.ydim &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; P.zdim &lt;&lt; std::endl;</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Background density: &quot;</span> &lt;&lt; P.Background_Density &lt;&lt; std::endl;</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;phantom_scale : &quot;</span> &lt;&lt; P.phantom_scale &lt;&lt; std::endl;</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; P.VF.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;        o &lt;&lt; P.VF[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    <span class="keywordflow">return</span> o;</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;}</div><div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a97a780e1b83fef7587ac4f48b8ea0fb5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Phantom::Background_Density</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Final volume background density. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l01401">1401</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad6b0d6771b22d06535000de7ba3b7f52"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Phantom::current_scale</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Has been the scale applied? </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l01404">1404</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>

</div>
</div>
<a class="anchor" id="a37fc05be4b1941a82a04df83b8672c3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classFileName.html">FileName</a> Phantom::fn</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Filename. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l01389">1389</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>

</div>
</div>
<a class="anchor" id="a43164ae1928635229333ce41c01e2f35"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Phantom::param_file_scale</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Param file scale. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l01407">1407</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>

</div>
</div>
<a class="anchor" id="a08e07a6c798f13f5c87488704dd89791"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Phantom::phantom_scale</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Param file scale. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l01410">1410</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab37a930cd36cd7d25a11da6bb0f3ce7f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classFeature.html">Feature</a>*&gt; Phantom::VF</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>List with the features. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l01413">1413</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>

</div>
</div>
<a class="anchor" id="afb218fc635f5c078cba041e538ea76b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Phantom::xdim</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Final volume X dimension. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l01392">1392</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>

</div>
</div>
<a class="anchor" id="a614b76f0cf1bb8cfe7b98047f2b8dc7a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Phantom::ydim</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Final volume Y dimension. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l01395">1395</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>

</div>
</div>
<a class="anchor" id="aaaeb13139ea6fdc791e551a83d2f4ece"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Phantom::zdim</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Final volume Z dimension. </p>

<p>Definition at line <a class="el" href="phantom_8h_source.html#l01398">1398</a> of file <a class="el" href="phantom_8h_source.html">phantom.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/yunior/Yunior/Projects/Scipion/COSS/xmipp-bundle/src/xmipp/libraries/data/<a class="el" href="phantom_8h_source.html">phantom.h</a></li>
<li>/home/yunior/Yunior/Projects/Scipion/COSS/xmipp-bundle/src/xmipp/libraries/data/<a class="el" href="phantom_8cpp_source.html">phantom.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
