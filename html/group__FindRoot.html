<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Xmipp: Find root</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v3.23.11-Nereus</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Find root<div class="ingroups"><a class="el" href="group__Libraries.html">Libraries</a> &raquo; <a class="el" href="group__BilibLibrary.html">Bilib library</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Find root:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__FindRoot.png" border="0" alt="" usemap="#group____FindRoot"/>
<map name="group____FindRoot" id="group____FindRoot">
</map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga7e378201892bf8970518d567355bea1e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FindRoot.html#ga7e378201892bf8970518d567355bea1e">RootBracket</a> (int(*Function)(double, void *, double *), void *AuxilliaryData, double *LowerBound, double *UpperBound, double *LowerSample, double *UpperSample, double Tolerance, int *ValidBracket, int *Status)</td></tr>
<tr class="separator:ga7e378201892bf8970518d567355bea1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafd984fbffcf137be0d19c97d057bcf06"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FindRoot.html#gafd984fbffcf137be0d19c97d057bcf06">RootFindBisection</a> (int(*Function)(double, void *, double *), void *AuxilliaryData, double *Root, double LowerBound, double UpperBound, double Tolerance, int *Status)</td></tr>
<tr class="separator:gafd984fbffcf137be0d19c97d057bcf06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaebd2e20c636b0d4e711d5188403697e8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FindRoot.html#gaebd2e20c636b0d4e711d5188403697e8">RootFindBrent</a> (int(*Function)(double, void *, double *), void *AuxilliaryData, double *Root, double LowerBound, double UpperBound, double Tolerance, int *Status)</td></tr>
<tr class="separator:gaebd2e20c636b0d4e711d5188403697e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga7e378201892bf8970518d567355bea1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7e378201892bf8970518d567355bea1e">&#9670;&nbsp;</a></span>RootBracket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RootBracket </td>
          <td>(</td>
          <td class="paramtype">int(*)(double, void *, double *)&#160;</td>
          <td class="paramname"><em>Function</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>AuxilliaryData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>LowerBound</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>UpperBound</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>LowerSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>UpperSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Tolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ValidBracket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find root by bracketing. Bracketing of a root of (Function) inside the interval [LowerBound, UpperBound]. The purpose is to search for a pair of arguments for which 'Function' differs in sign. The search is conducted within [LowerBound, UpperBound]. At most [(UpperBound - LowerBound) / Tolerance] function evaluations are performed. Even-order roots cannot be bracketed. The evaluation of Function at LowerBound (UpperBound) is returned in LowerSample (UpperSample)</p>
<p>success: return(!ERROR); failure: return(ERROR)</p>
<p>the function 'Function' must be declared as follows: </p><div class="fragment"><div class="line"><span class="keyword">extern</span> <span class="keywordtype">int</span> myFunction(<span class="keywordtype">double</span> myArgument, <span class="keywordtype">void</span> *AuxilliaryData, <span class="keywordtype">double</span> *myResult);</div></div><!-- fragment --><p> It must return ERROR upon failure, and !ERROR upon success</p>
<p>It is evaluated for the value of the variable 'myArgument'. The result of the function evaluation must be returned in 'myResult'. The generic pointer 'AuxilliaryData' can be used to pass additional parameters.</p>
<p>What follows is a developed example of the function f(x) = a * x^2 + b * x + c (a, b, and c are free parameters)</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>myStruct {</div><div class="line">   <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">extern</span> <span class="keywordtype">int</span> myFunction (</div><div class="line">   <span class="keywordtype">double</span>  myArgument,</div><div class="line">   <span class="keywordtype">void</span>    *AuxilliaryData,</div><div class="line">   <span class="keywordtype">double</span>  *myResult) {</div><div class="line">   <span class="keyword">struct </span>myStruct myData;</div><div class="line"></div><div class="line">   myData = *((<span class="keyword">struct </span>myStruct *)AuxilliaryData);</div><div class="line">   *myResult = myArgument * (myArgument * myData.a + myData.b) + myData.c;</div><div class="line">   <span class="keywordflow">return</span>(!<a class="code" href="configs_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a class="code" href="CTPL_2example_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>() {</div><div class="line">   <span class="keyword">struct </span>myStruct myData;</div><div class="line">   <span class="keywordtype">double</span> LowerBound = -100.0, UpperBound = 100.0;</div><div class="line">   <span class="keywordtype">double</span> LowerSample, UpperSample;</div><div class="line">   <span class="keywordtype">double</span> Tolerance = <a class="code" href="geometry_8h.html#aafe5d2c4dc0edd9840f20e885dcae6ad">FLT_EPSILON</a>;</div><div class="line">   <span class="keywordtype">int</span>    ValidBracket;</div><div class="line">   <span class="keywordtype">int</span>    Status;</div><div class="line"></div><div class="line">   myData.a = 1.0;</div><div class="line">   myData.b = 5.0;</div><div class="line">   myData.c = 4.0;</div><div class="line">   <a class="code" href="group__FindRoot.html#ga7e378201892bf8970518d567355bea1e">RootBracket</a>(*myFunction, (<span class="keywordtype">void</span> *)&amp;myData, &amp;LowerBound, &amp;UpperBound,</div><div class="line">      &amp;LowerSample, &amp;UpperSample, Tolerance, &amp;ValidBracket, &amp;Status);</div><div class="line">   <span class="keywordflow">return</span>(0);</div><div class="line">}</div></div><!-- fragment --> 
</div>
</div>
<a id="gafd984fbffcf137be0d19c97d057bcf06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafd984fbffcf137be0d19c97d057bcf06">&#9670;&nbsp;</a></span>RootFindBisection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RootFindBisection </td>
          <td>(</td>
          <td class="paramtype">int(*)(double, void *, double *)&#160;</td>
          <td class="paramname"><em>Function</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>AuxilliaryData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LowerBound</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>UpperBound</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Tolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find a root by bisection. Search for a root of (Function) inside the bracketing interval [LowerBound, UpperBound]. The strategy proceeds by iteratively cutting the interval in two equal parts. Even-order roots generally cannot be found. Only one root is returned, even if there are several ones. Tolerance is relative to the size of the bracketing interval</p>
<p>success: return(!ERROR); failure: return(ERROR)</p>
<p>The function 'Function' must be declared as follows: </p><div class="fragment"><div class="line"><span class="keyword">extern</span> <span class="keywordtype">int</span> myFunction(<span class="keywordtype">double</span> myArgument, <span class="keywordtype">void</span> *AuxilliaryData, <span class="keywordtype">double</span> *myResult);</div></div><!-- fragment --><p> It must return ERROR upon failure, and !ERROR upon success. It is evaluated for the value of the variable 'myArgument'. The result of the function evaluation must be returned in 'myResult'. The generic pointer 'AuxilliaryData' can be used to pass additional parameters.</p>
<p>What follows is a developed example of the function f(x) = a * x^2 + b * x + c (a, b, and c are free parameters) </p><div class="fragment"><div class="line"><span class="keyword">struct </span>myStruct {</div><div class="line">   <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">extern</span> <span class="keywordtype">int</span> myFunction (</div><div class="line">   <span class="keywordtype">double</span>  myArgument,</div><div class="line">   <span class="keywordtype">void</span>    *AuxilliaryData,</div><div class="line">   <span class="keywordtype">double</span>  *myResult) {</div><div class="line">   <span class="keyword">struct </span>myStruct myData;</div><div class="line"></div><div class="line">   myData = *((<span class="keyword">struct </span>myStruct *)AuxilliaryData);</div><div class="line">   *myResult = myArgument * (myArgument * myData.a + myData.b) + myData.c;</div><div class="line">   <span class="keywordflow">return</span>(!<a class="code" href="configs_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a class="code" href="CTPL_2example_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>() {</div><div class="line">   <span class="keyword">struct </span>myStruct myData;</div><div class="line">   <span class="keywordtype">double</span> LowerBound = -100.0, UpperBound = 100.0;</div><div class="line">   <span class="keywordtype">double</span> Root;</div><div class="line">   <span class="keywordtype">double</span> Tolerance = <a class="code" href="geometry_8h.html#aafe5d2c4dc0edd9840f20e885dcae6ad">FLT_EPSILON</a>;</div><div class="line">   <span class="keywordtype">int</span>    Status;</div><div class="line"></div><div class="line">   myData.a = 1.0;</div><div class="line">   myData.b = 5.0;</div><div class="line">   myData.c = 4.0;</div><div class="line">   <a class="code" href="group__FindRoot.html#ga7e378201892bf8970518d567355bea1e">RootBracket</a>(*myFunction, (<span class="keywordtype">void</span> *)&amp;myData, &amp;LowerBound, &amp;UpperBound, Tolerance, &amp;Status);</div><div class="line">   <a class="code" href="group__FindRoot.html#gafd984fbffcf137be0d19c97d057bcf06">RootFindBisection</a>(*myFunction, (<span class="keywordtype">void</span> *)&amp;myData, &amp;Root, LowerBound,</div><div class="line">      UpperBound, Tolerance, &amp;Status);</div><div class="line">   <span class="keywordflow">return</span>(0);</div><div class="line">}</div></div><!-- fragment --> 
</div>
</div>
<a id="gaebd2e20c636b0d4e711d5188403697e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaebd2e20c636b0d4e711d5188403697e8">&#9670;&nbsp;</a></span>RootFindBrent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RootFindBrent </td>
          <td>(</td>
          <td class="paramtype">int(*)(double, void *, double *)&#160;</td>
          <td class="paramname"><em>Function</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>AuxilliaryData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LowerBound</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>UpperBound</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Tolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find root using Brent algorithm. Search for a root of (Function) inside the bracketing interval [LowerBound, UpperBound]. The strategy proceeds by fitting an inverse quadratic function and by using the root that belong to the interval. If any even-order roots generally cannot be found. Only one root is returned, even if there are several ones. Tolerance is relative to the size of the bracketing interval.</p>
<p>success: return(!ERROR); failure: return(ERROR)</p>
<p>The function 'Function' must be declared as follows: </p><div class="fragment"><div class="line"><span class="keyword">extern</span> <span class="keywordtype">int</span> myFunction(<span class="keywordtype">double</span> myArgument, <span class="keywordtype">void</span> *AuxilliaryData, <span class="keywordtype">double</span> *myResult);</div></div><!-- fragment --><p>It must return ERROR upon failure, and !ERROR upon success. It is evaluated for the value of the variable 'myArgument'. The result of the function evaluation must be returned in 'myResult'. The generic pointer 'AuxilliaryData' can be used to pass additional parameters.</p>
<p>What follows is a developed example of the function f(x) = a * x^2 + b * x + c (a, b, and c are free parameters) </p><div class="fragment"><div class="line"><span class="keyword">struct </span>myStruct {</div><div class="line">   <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">extern</span> <span class="keywordtype">int</span> myFunction (</div><div class="line">   <span class="keywordtype">double</span>  myArgument,</div><div class="line">   <span class="keywordtype">void</span>    *AuxilliaryData,</div><div class="line">   <span class="keywordtype">double</span>  *myResult) {</div><div class="line">   <span class="keyword">struct </span>myStruct myData;</div><div class="line"></div><div class="line">   myData = *((<span class="keyword">struct </span>myStruct *)AuxilliaryData);</div><div class="line">   *myResult = myArgument * (myArgument * myData.a + myData.b) + myData.c;</div><div class="line">   <span class="keywordflow">return</span>(!<a class="code" href="configs_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a class="code" href="CTPL_2example_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>() {</div><div class="line">   <span class="keyword">struct </span>myStruct myData;</div><div class="line">   <span class="keywordtype">double</span> LowerBound = -100.0, UpperBound = 100.0;</div><div class="line">   <span class="keywordtype">double</span> Root;</div><div class="line">   <span class="keywordtype">double</span> Tolerance = <a class="code" href="geometry_8h.html#aafe5d2c4dc0edd9840f20e885dcae6ad">FLT_EPSILON</a>;</div><div class="line">   <span class="keywordtype">int</span>    Status;</div><div class="line"></div><div class="line">   myData.a = 1.0;</div><div class="line">   myData.b = 5.0;</div><div class="line">   myData.c = 4.0;</div><div class="line">   <a class="code" href="group__FindRoot.html#ga7e378201892bf8970518d567355bea1e">RootBracket</a>(*myFunction, (<span class="keywordtype">void</span> *)&amp;myData, &amp;LowerBound, &amp;UpperBound, Tolerance, &amp;Status);</div><div class="line">   <a class="code" href="group__FindRoot.html#gafd984fbffcf137be0d19c97d057bcf06">RootFindBisection</a>(*myFunction, (<span class="keywordtype">void</span> *)&amp;myData, &amp;Root, LowerBound,</div><div class="line">      UpperBound, Tolerance, &amp;Status);</div><div class="line">   <span class="keywordflow">return</span>(0);</div><div class="line">}</div></div><!-- fragment --> 
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
