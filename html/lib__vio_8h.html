<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Xmipp: /home/yunior/Yunior/Projects/Scipion/COSS/xmipp-bundle/src/xmipp/external/sh_alignment/lib_vio.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_dbce2b2c1291334a9ade6207c7a262fa.html">xmipp-bundle</a></li><li class="navelem"><a class="el" href="dir_5ca4f3e8e51f1e22c724fe6427eb943c.html">src</a></li><li class="navelem"><a class="el" href="dir_51a4fe91bde3feaf0f23bad87d0144e4.html">xmipp</a></li><li class="navelem"><a class="el" href="dir_c1f35c60d3a5ad04ce6251391132afb4.html">external</a></li><li class="navelem"><a class="el" href="dir_ef667b205093c97f01d42e376bb94d82.html">sh_alignment</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">lib_vio.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="lib__vio_8h__dep__incl.png" border="0" usemap="#_2home_2yunior_2Yunior_2Projects_2Scipion_2COSS_2xmipp-bundle_2src_2xmipp_2external_2sh__alignment_2lib__vio_8hdep" alt=""/></div>
<map name="_2home_2yunior_2Yunior_2Projects_2Scipion_2COSS_2xmipp-bundle_2src_2xmipp_2external_2sh__alignment_2lib__vio_8hdep" id="_2home_2yunior_2Yunior_2Projects_2Scipion_2COSS_2xmipp-bundle_2src_2xmipp_2external_2sh__alignment_2lib__vio_8hdep">
<area shape="rect" id="node2" href="lib__vio_8cpp.html" title="/home/yunior/Yunior\l/Projects/Scipion/COSS\l/xmipp&#45;bundle/src/xmipp\l/external/sh_alignment/lib\l_vio.cpp" alt="" coords="23,124,193,209"/>
</map>
</div>
</div>
<p><a href="lib__vio_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa6a42a7e0a69b7da72558548e4ed4331"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#aa6a42a7e0a69b7da72558548e4ed4331">read_vol</a> (char *, double *, double *, double *, double *, unsigned *, unsigned *, unsigned *, double **)</td></tr>
<tr class="separator:aa6a42a7e0a69b7da72558548e4ed4331"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9cd58347d660e9c4e766dfbfc1b67d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#ae9cd58347d660e9c4e766dfbfc1b67d2">write_vol</a> (char *, double, double, double, double, unsigned, unsigned, unsigned, double *)</td></tr>
<tr class="separator:ae9cd58347d660e9c4e766dfbfc1b67d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a80f1657984a28fe6cb98d3b2f6e006"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a4a80f1657984a28fe6cb98d3b2f6e006">read_situs</a> (char *, double *, double *, double *, double *, unsigned *, unsigned *, unsigned *, double **)</td></tr>
<tr class="separator:a4a80f1657984a28fe6cb98d3b2f6e006"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87bd7d4efe511eba251a44119c531fde"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a87bd7d4efe511eba251a44119c531fde">write_situs</a> (char *, double, double, double, double, unsigned, unsigned, unsigned, double *)</td></tr>
<tr class="separator:a87bd7d4efe511eba251a44119c531fde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7436bdc9767e8d4e6cc896aaa1b7eea4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a7436bdc9767e8d4e6cc896aaa1b7eea4">read_ascii</a> (char *, unsigned long, double **)</td></tr>
<tr class="separator:a7436bdc9767e8d4e6cc896aaa1b7eea4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1079b4554d46f1a586daf8fa754d8b5b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a1079b4554d46f1a586daf8fa754d8b5b">read_xplor</a> (char *, int *, int *, double *, double *, double *, double *, double *, double *, int *, int *, int *, unsigned *, unsigned *, unsigned *, double **)</td></tr>
<tr class="separator:a1079b4554d46f1a586daf8fa754d8b5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad049ab70b26b408f32e0801a33c25c32"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#ad049ab70b26b408f32e0801a33c25c32">xplor_skip_to_number</a> (FILE **, char **)</td></tr>
<tr class="separator:ad049ab70b26b408f32e0801a33c25c32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a890a5b56e76cc6081ad68dded6b2996f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a890a5b56e76cc6081ad68dded6b2996f">read_mrc</a> (char *, int *, int *, int *, unsigned *, unsigned *, unsigned *, int *, int *, int *, double *, double *, double *, double *, double *, double *, double *, double *, double *, double **)</td></tr>
<tr class="separator:a890a5b56e76cc6081ad68dded6b2996f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36d074c214f7e1d4f7550a98a908ea8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a36d074c214f7e1d4f7550a98a908ea8e">read_spider</a> (char *, unsigned *, unsigned *, unsigned *, double **)</td></tr>
<tr class="separator:a36d074c214f7e1d4f7550a98a908ea8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb14c3d22ada5b68932762e56bc7704d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#acb14c3d22ada5b68932762e56bc7704d">dump_binary_and_exit</a> (char *, char *, int)</td></tr>
<tr class="separator:acb14c3d22ada5b68932762e56bc7704d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c923cac1bb099147449e6ad35d48b1a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a9c923cac1bb099147449e6ad35d48b1a">read_float</a> (float *, FILE *, int)</td></tr>
<tr class="separator:a9c923cac1bb099147449e6ad35d48b1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a6e926ba587aa400cfe242f734645da"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a6a6e926ba587aa400cfe242f734645da">read_short_float</a> (float *, FILE *, int)</td></tr>
<tr class="separator:a6a6e926ba587aa400cfe242f734645da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d60980cc71594dadfc2975fc2545b89"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a1d60980cc71594dadfc2975fc2545b89">read_float_empty</a> (FILE *)</td></tr>
<tr class="separator:a1d60980cc71594dadfc2975fc2545b89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2273d65fc0bdcd326715c05bd80b5296"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a2273d65fc0bdcd326715c05bd80b5296">read_char_float</a> (float *, FILE *)</td></tr>
<tr class="separator:a2273d65fc0bdcd326715c05bd80b5296"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5359ae732d6d62ee90a909de5f9a15cb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a5359ae732d6d62ee90a909de5f9a15cb">read_char</a> (char *, FILE *)</td></tr>
<tr class="separator:a5359ae732d6d62ee90a909de5f9a15cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87645c3bf06e778dce03738464787e14"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a87645c3bf06e778dce03738464787e14">read_int</a> (int *, FILE *, int)</td></tr>
<tr class="separator:a87645c3bf06e778dce03738464787e14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0d226c6a91a8329be397fe7fa9e8b78"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#ac0d226c6a91a8329be397fe7fa9e8b78">count_floats</a> (FILE **)</td></tr>
<tr class="separator:ac0d226c6a91a8329be397fe7fa9e8b78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96fb52deeb7a0ec9aae07b73d5c6b596"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a96fb52deeb7a0ec9aae07b73d5c6b596">test_registration</a> (float, float, float, float)</td></tr>
<tr class="separator:a96fb52deeb7a0ec9aae07b73d5c6b596"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a703cc859679dea0d81d8f196b4106fc8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a703cc859679dea0d81d8f196b4106fc8">test_situs</a> (char *)</td></tr>
<tr class="separator:a703cc859679dea0d81d8f196b4106fc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa92db1e9d1c9014e046e261841f87dbe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#aa92db1e9d1c9014e046e261841f87dbe">have_situs_suffix</a> (char *)</td></tr>
<tr class="separator:aa92db1e9d1c9014e046e261841f87dbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02617a2398aa37bd1097a45e30a403ed"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a02617a2398aa37bd1097a45e30a403ed">test_situs_header_and_suffix</a> (char *)</td></tr>
<tr class="separator:a02617a2398aa37bd1097a45e30a403ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07826e1d79820e093c758043e689a842"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a07826e1d79820e093c758043e689a842">test_mrc</a> (char *, int)</td></tr>
<tr class="separator:a07826e1d79820e093c758043e689a842"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bd024a616ab43b061e852856b44b549"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a8bd024a616ab43b061e852856b44b549">test_spider</a> (char *, int)</td></tr>
<tr class="separator:a8bd024a616ab43b061e852856b44b549"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8fa92ca661d88178fbf58a6ce3db4c7"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#ad8fa92ca661d88178fbf58a6ce3db4c7">permuted_index</a> (int, unsigned long, unsigned, unsigned, unsigned)</td></tr>
<tr class="separator:ad8fa92ca661d88178fbf58a6ce3db4c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab475318046e1779bc138dcb8c95b205a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#ab475318046e1779bc138dcb8c95b205a">permute_map</a> (int, unsigned, unsigned, unsigned, unsigned *, unsigned *, unsigned *, int, int, int, int *, int *, int *, double *, double **)</td></tr>
<tr class="separator:ab475318046e1779bc138dcb8c95b205a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a739551ee3744d0e57948b94f1798f7eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a739551ee3744d0e57948b94f1798f7eb">permute_dimensions</a> (int, unsigned, unsigned, unsigned, unsigned *, unsigned *, unsigned *, int, int, int, int *, int *, int *)</td></tr>
<tr class="separator:a739551ee3744d0e57948b94f1798f7eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b6c7e4a0aac9ab279213be7cd0bb239"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a0b6c7e4a0aac9ab279213be7cd0bb239">permute_print_info</a> (int, unsigned, unsigned, unsigned, unsigned, unsigned, unsigned, int, int, int, int, int, int)</td></tr>
<tr class="separator:a0b6c7e4a0aac9ab279213be7cd0bb239"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65f22554066cada7f2ff20d21414d912"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a65f22554066cada7f2ff20d21414d912">set_origin_get_mode</a> (int, int, int, double, double, double, double, double, double, double *, double *, double *)</td></tr>
<tr class="separator:a65f22554066cada7f2ff20d21414d912"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b6728037b39050c0dcba6a551c6ef01"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a4b6728037b39050c0dcba6a551c6ef01">assert_cubic_map</a> (int, int, double, double, double, double, double, double, unsigned, unsigned, unsigned, int, int, int, double, double, double, double *, double *, double *, double *, unsigned *, unsigned *, unsigned *, double **)</td></tr>
<tr class="separator:a4b6728037b39050c0dcba6a551c6ef01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa105c42118bdd32c5249052b51eec62f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#aa105c42118bdd32c5249052b51eec62f">interpolate_skewed_map_to_cubic</a> (double **, unsigned *, unsigned *, unsigned *, double *, double *, double *, double *, double *, unsigned, unsigned, unsigned, int, int, int, double, double, double, double, double, double, double, double, double)</td></tr>
<tr class="separator:aa105c42118bdd32c5249052b51eec62f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a990fdb9a5ea78d3efc3abe8a60028bf2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a990fdb9a5ea78d3efc3abe8a60028bf2">write_xplor</a> (char *, double, double, double, double, unsigned, unsigned, unsigned, double *)</td></tr>
<tr class="separator:a990fdb9a5ea78d3efc3abe8a60028bf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3d0d90b373709280a67174a4da57e38"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#aa3d0d90b373709280a67174a4da57e38">write_mrc</a> (int, char *, double, double, double, double, unsigned, unsigned, unsigned, double *)</td></tr>
<tr class="separator:aa3d0d90b373709280a67174a4da57e38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a337699c29e71f3db1d19d6fd5cff79ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib__vio_8h.html#a337699c29e71f3db1d19d6fd5cff79ef">write_spider</a> (char *, double, double, double, double, unsigned, unsigned, unsigned, double *)</td></tr>
<tr class="separator:a337699c29e71f3db1d19d6fd5cff79ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a4b6728037b39050c0dcba6a551c6ef01"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void assert_cubic_map </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l01326">1326</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;{</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nvox;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <span class="keywordtype">double</span> *pp2;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  <span class="keywordtype">double</span> origx, origy, origz;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  <span class="comment">/* distinguish between cubic, orthonormal, and skewed */</span></div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  <span class="keywordflow">if</span> (cubic) {</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <a class="code" href="lib__vio_8cpp.html#a0830557602c8f16c2053ae8cf69b898d">set_origin_get_mode</a>(nxstart, nystart, nzstart, widthx, widthy, widthz, </div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                        xorigin, yorigin, zorigin, porigx, porigy, porigz);</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Cubic lattice present. \n&quot;</span>);</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    *pwidth = widthx;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    *pextx = nx;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    *pexty = ny;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    *pextz = nz;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    <span class="keywordflow">if</span> (orom) {</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;      <a class="code" href="lib__vio_8cpp.html#a0830557602c8f16c2053ae8cf69b898d">set_origin_get_mode</a>(nxstart, nystart, nzstart, widthx, widthy, widthz, </div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                          xorigin, yorigin, zorigin, &amp;origx, &amp;origy, &amp;origz);</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Orthogonal lattice with unequal spacings in x, y, z detected.\n&quot;</span>);</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Interpolating map to cubic lattice using smallest detected spacing rounded to nearest 0.1 Angstrom.\n&quot;</span>);</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      <span class="comment">/* for interpolation, find minimum voxel spacing, rounded to nearest 0.1 Angstrom for good measure */</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      *pwidth = widthx;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      <span class="keywordflow">if</span> (widthy &lt; *pwidth) *pwidth = widthy;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      <span class="keywordflow">if</span> (widthz &lt; *pwidth) *pwidth = widthz;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      *pwidth = <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(*pwidth * 10.0 + 0.5) / 10.0;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      <span class="comment">/* the new map will have the maximum box dimensions that do not exceed the old map */</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      <a class="code" href="lib__vwk_8cpp.html#a03f724ac8816bd2ad3640bfd4fbf439d">interpolate_map</a>(&amp;pp2, pextx, pexty, pextz, porigx, porigy, porigz,</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                      *pwidth, *pwidth, *pwidth, *pphi, nx, ny, nz, origx,</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                      origy, origz, widthx, widthy, widthz);</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      nvox = *pextx * *pexty * *pextz;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      <a class="code" href="lib__vec_8cpp.html#a73bce9367158a5adaa503abe7990b350">cp_vect_destroy</a>(pphi, &amp;pp2, nvox);</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Skewed, non-orthogonal lattice detected.\n&quot;</span>);</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Interpolating skewed map to cubic lattice using smallest detected spacing rounded to nearest 0.1 Angstrom.\n&quot;</span>);</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="comment">/* here, the new map will have the minimum box dimensions that fully enclose the old map */</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;      <a class="code" href="lib__vio_8cpp.html#a7ad98266e41a0e3f6c013067a64cd5ba">interpolate_skewed_map_to_cubic</a>(&amp;pp2, pextx, pexty, pextz, porigx, porigy,</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                                      porigz, pwidth, *pphi, nx, ny, nz, </div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                                      nxstart, nystart, nzstart, xorigin, </div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                                      yorigin, zorigin, widthx, widthy, widthz,</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                                      alpha, <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>, <a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a>);</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      nvox = *pextx * *pexty * *pextz;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      <a class="code" href="lib__vec_8cpp.html#a73bce9367158a5adaa503abe7990b350">cp_vect_destroy</a>(pphi, &amp;pp2, nvox);</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    }</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  }</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  <span class="comment">/* check for registration of lattice with origin of coordinate system */</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="lib__vio_8cpp.html#a91c5b032bb0a4497df72b7bb71cbf1a7">test_registration</a>(*porigx, *porigy, *porigz, *pwidth) == 0) </div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a>(stderr, <span class="stringliteral">&quot;lib_vio&gt; Input grid not in register with origin of coordinate system.\n&quot;</span>);</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;}</div><div class="ttc" id="lib__vio_8cpp_html_a91c5b032bb0a4497df72b7bb71cbf1a7"><div class="ttname"><a href="lib__vio_8cpp.html#a91c5b032bb0a4497df72b7bb71cbf1a7">test_registration</a></div><div class="ttdeci">int test_registration(float origx, float origy, float origz, float width)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00917">lib_vio.cpp:917</a></div></div>
<div class="ttc" id="lib__vec_8cpp_html_a73bce9367158a5adaa503abe7990b350"><div class="ttname"><a href="lib__vec_8cpp.html#a73bce9367158a5adaa503abe7990b350">cp_vect_destroy</a></div><div class="ttdeci">void cp_vect_destroy(double **pvect1, double **pvect2, unsigned long len)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vec_8cpp_source.html#l00051">lib_vec.cpp:51</a></div></div>
<div class="ttc" id="cuda__basic__math_8h_html_a2065eb145275f878c1d045c9f3fb1cc7"><div class="ttname"><a href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a></div><div class="ttdeci">__host__ __device__ float2 floor(const float2 v)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__basic__math_8h_source.html#l00175">cuda_basic_math.h:175</a></div></div>
<div class="ttc" id="namespacealglib_html_a038c39f3bfe0dff667a2cb6bebfed764"><div class="ttname"><a href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">alglib::beta</a></div><div class="ttdeci">double beta(const double a, const double b)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l00962">specialfunctions.cpp:962</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_acf097d43154f3f002dbb9692ce4c55f7"><div class="ttname"><a href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a></div><div class="ttdeci">double * gamma</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07616">numerical_recipes.cpp:7616</a></div></div>
<div class="ttc" id="lib__vwk_8cpp_html_a03f724ac8816bd2ad3640bfd4fbf439d"><div class="ttname"><a href="lib__vwk_8cpp.html#a03f724ac8816bd2ad3640bfd4fbf439d">interpolate_map</a></div><div class="ttdeci">void interpolate_map(double **outmap, unsigned *out_extx, unsigned *out_exty, unsigned *out_extz, double *out_origx, double *out_origy, double *out_origz, double out_widthx, double out_widthy, double out_widthz, double *inmap, unsigned in_extx, unsigned in_exty, unsigned in_extz, double in_origx, double in_origy, double in_origz, double in_widthx, double in_widthy, double in_widthz)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vwk_8cpp_source.html#l00082">lib_vwk.cpp:82</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a0830557602c8f16c2053ae8cf69b898d"><div class="ttname"><a href="lib__vio_8cpp.html#a0830557602c8f16c2053ae8cf69b898d">set_origin_get_mode</a></div><div class="ttdeci">int set_origin_get_mode(int nxstart, int nystart, int nzstart, double widthx, double widthy, double widthz, double xorigin, double yorigin, double zorigin, double *origx, double *origy, double *origz)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l01307">lib_vio.cpp:1307</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a7ad98266e41a0e3f6c013067a64cd5ba"><div class="ttname"><a href="lib__vio_8cpp.html#a7ad98266e41a0e3f6c013067a64cd5ba">interpolate_skewed_map_to_cubic</a></div><div class="ttdeci">void interpolate_skewed_map_to_cubic(double **pphiout, unsigned *pextx, unsigned *pexty, unsigned *pextz, double *porigx, double *porigy, double *porigz, double *pwidth, double *phiin, unsigned nx, unsigned ny, unsigned nz, int nxstart, int nystart, int nzstart, double xorigin, double yorigin, double zorigin, double widthx, double widthy, double widthz, double alpha, double beta, double gamma)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l01388">lib_vio.cpp:1388</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae453b7a848a8a559dee492de32116c99"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a></div><div class="ttdeci">fprintf(glob_prnt.io,&quot;\n&quot;)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac0d226c6a91a8329be397fe7fa9e8b78"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long count_floats </td>
          <td>(</td>
          <td class="paramtype">FILE **&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l00902">902</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;{</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> finl = 0;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  rewind(*fin);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="keywordflow">for</span> (; ;) {</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="keywordflow">if</span> (fgetc(*fin) == EOF) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    ++finl;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  }</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  rewind(*fin);</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="keywordflow">return</span> finl / 4;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acb14c3d22ada5b68932762e56bc7704d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dump_binary_and_exit </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l00774">774</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;{</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  FILE *fin, *fout;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="keywordtype">float</span> *phi;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nfloat;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  fin = fopen(in_file, <span class="stringliteral">&quot;rb&quot;</span>);</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <span class="keywordflow">if</span> (fin == NULL) {</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <a class="code" href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a>(70910, <span class="stringliteral">&quot;lib_vio&quot;</span>, in_file);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  }</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  nfloat = <a class="code" href="lib__vio_8cpp.html#ab5adcb6c287e9f0f0ee518791eb852bb">count_floats</a>(&amp;fin);</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  phi = (<span class="keywordtype">float</span> *) <a class="code" href="lib__vec_8cpp.html#a3dba0f046e5df31593bc2200d38cfd61">alloc_vect</a>(nfloat, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <span class="keywordflow">for</span> (count = 0; count &lt; nfloat; count++)</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(phi + count, fin, swap);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Binary data read as 32-bit &#39;float&#39; type from file %s\n&quot;</span>, in_file);</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="keywordflow">if</span> (swap) printf(<span class="stringliteral">&quot;lib_vio&gt; The byte order (endianism) has been swapped.\n&quot;</span>);</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  fclose(fin);</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  fout = fopen(out_file, <span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="keywordflow">if</span> (fout == NULL) {</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <a class="code" href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a>(70940, <span class="stringliteral">&quot;lib_vio&quot;</span>, out_file);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  }</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Writing ASCII data... \n&quot;</span>);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="keywordflow">for</span> (count = 0; count &lt; nfloat; count++) {</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordflow">if</span> ((count + 1) % 10 == 0) <a class="code" href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a>(fout, <span class="stringliteral">&quot; %10.6f \n&quot;</span>, *(phi + count));</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a>(fout, <span class="stringliteral">&quot; %10.6f &quot;</span>, *(phi + count));</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  }</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  fclose(fout);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; ASCII dump of binary file %s written to file %s. \n&quot;</span>, in_file, out_file);</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Open / check ASCII file with text editor and extract map densities. \n&quot;</span>);</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Then convert with map2map tool, option 1: ASCII.\n&quot;</span>);</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  exit(1);</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;}</div><div class="ttc" id="lib__vio_8cpp_html_a3caa01c8a1d9e955d617ed7d8fd77405"><div class="ttname"><a href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a></div><div class="ttdeci">int read_float(float *currfloat, FILE *fin, int swap)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00817">lib_vio.cpp:817</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_ab5adcb6c287e9f0f0ee518791eb852bb"><div class="ttname"><a href="lib__vio_8cpp.html#ab5adcb6c287e9f0f0ee518791eb852bb">count_floats</a></div><div class="ttdeci">unsigned long count_floats(FILE **fin)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00902">lib_vio.cpp:902</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_ae76582a4cbab89aa99fcf38effea84e5"><div class="ttname"><a href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a></div><div class="ttdeci">void error_open_filename(int error_number, const char *program, char *argv)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00067">lib_err.cpp:67</a></div></div>
<div class="ttc" id="lib__vec_8cpp_html_a3dba0f046e5df31593bc2200d38cfd61"><div class="ttname"><a href="lib__vec_8cpp.html#a3dba0f046e5df31593bc2200d38cfd61">alloc_vect</a></div><div class="ttdeci">void * alloc_vect(unsigned int n, size_t elem_size)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vec_8cpp_source.html#l00071">lib_vec.cpp:71</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae453b7a848a8a559dee492de32116c99"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a></div><div class="ttdeci">fprintf(glob_prnt.io,&quot;\n&quot;)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa92db1e9d1c9014e046e261841f87dbe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int have_situs_suffix </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l00981">981</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;{</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  <span class="keywordtype">int</span> vl;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  <span class="keywordtype">int</span> situs_format = 0;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  vl = strlen(vol_file);</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  <span class="keywordflow">if</span> (vl &gt; 4) {</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">if</span> (strstr(vol_file + (vl - 4), <span class="stringliteral">&quot;.sit&quot;</span>) != NULL) situs_format = 1;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="keywordflow">if</span> (strstr(vol_file + (vl - 4), <span class="stringliteral">&quot;.SIT&quot;</span>) != NULL) situs_format = 1;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  }</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <span class="keywordflow">if</span> (vl &gt; 6) {</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">if</span> (strstr(vol_file + (vl - 6), <span class="stringliteral">&quot;.situs&quot;</span>) != NULL) situs_format = 1;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordflow">if</span> (strstr(vol_file + (vl - 6), <span class="stringliteral">&quot;.SITUS&quot;</span>) != NULL) situs_format = 1;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  }</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <span class="keywordflow">return</span> situs_format;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa105c42118bdd32c5249052b51eec62f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void interpolate_skewed_map_to_cubic </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l01388">1388</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;{</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> pnvox;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  <span class="keywordtype">double</span> ax, ay, az, bx, by, bz, cx, cy, cz, aix, aiy, aiz, bix, biy, biz, cix, ciy, ciz;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;  <span class="keywordtype">double</span> t1x, t1y, t2x, t2y, t3x, t3y, t4x, t4y, cdet, scz;</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  <span class="keywordtype">double</span> ux[8], uy[8], uz[8], uxmin, uxmax, uymin, uymax, uzmin, uzmax;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  <span class="keywordtype">double</span> xpos, ypos, zpos, gx, gy, gz, <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>, <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>, <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>, x1, y1, z1;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;  <span class="keywordtype">double</span> endox, endoy, endoz;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, indx, indy, indz;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  <span class="keywordtype">double</span> origx, origy, origz;</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;  <span class="comment">/* forward transform skewed -&gt; rectangular (ax,ay,az,bx,by,bz,cx,cy,cz) */</span></div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;  <span class="comment">/* compute unit cell vectors a b c by intersection of projections in a,b plane; Bronstein &amp; Semendjajew 2.6.6.1 */</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;  ax = 1.0;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;  ay = 0.0;</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;  az = 0.0;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;  bx = cos(<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * <a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a> / 180.0);</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;  by = sin(<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * <a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a> / 180.0);</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  bz = 0.0;</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;  t1x = cos(<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * (<a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a> + alpha) / 180.0);</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  t1y = sin(<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * (<a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a> + alpha) / 180.0);</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;  t2x = cos(<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * (<a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a> - alpha) / 180.0);</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;  t2y = sin(<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * (<a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a> - alpha) / 180.0);</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  t3x = cos(<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a> / 180.0);</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;  t3y = sin(<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a> / 180.0);</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  t4x = cos(<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a> / 180.0);</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  t4y = -1.0 * sin(<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a> / 180.0);</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;  cdet = (t4y - t3y) * (t2x - t1x) - (t2y - t1y) * (t4x - t3x);</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  <span class="keywordflow">if</span> (fabs(cdet) &lt; 1E-15) {</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <a class="code" href="lib__err_8cpp.html#a221d661e40558ad74e59d386e946b8a1">error_divide_zero</a>(71330, <span class="stringliteral">&quot;lib_vio&quot;</span>);</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;  }</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  cx = ((t4x - t3x) * (t1y * t2x - t2y * t1x) - </div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        (t2x - t1x) * (t3y * t4x - t4y * t3x)) / cdet;</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  cy = ((t4y - t3y) * (t1y * t2x - t2y * t1x) - </div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        (t2y - t1y) * (t3y * t4x - t4y * t3x)) / cdet;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  scz = 1.0 - (cx * cx + cy * cy);</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  <span class="keywordflow">if</span> (scz &lt; 0.0) {</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <a class="code" href="lib__err_8cpp.html#aca6159162702ed06e97263f32fb78d9b">error_sqrt_negative</a>(71340, <span class="stringliteral">&quot;lib_vio&quot;</span>);</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  }</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;  cz = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(scz);</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  <span class="comment">/* inverse transform rectangular -&gt; skewed (aix,aiy,aiz,bix,biy,biz,cix,ciy,ciz) */</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  aix = 1.0;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  aiy = 0.0;</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;  aiz = 0.0;</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  bix = -bx / by;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  biy = 1.0 / by;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  biz = 0.0;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  cix = (bx * cy - cx * by) / (by * cz);</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  ciy = -cy / (by * cz);</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  ciz = 1.0 / cz;</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  <span class="comment">/* assign origin and map it to skewed coordinates if it is not yet skewed */</span></div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="lib__vio_8cpp.html#a0830557602c8f16c2053ae8cf69b898d">set_origin_get_mode</a>(nxstart, nystart, nzstart, widthx, widthy, widthz, xorigin, yorigin, zorigin, &amp;origx, &amp;origy, &amp;origz)) {</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    gx = aix * origx + bix * origy + cix * origz;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    gy = aiy * origx + biy * origy + ciy * origz;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    gz = aiz * origx + biz * origy + ciz * origz;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    origx = gx;</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    origy = gy;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    origz = gz;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  }</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  <span class="comment">/* compute actual x y z extent of the skewed map: */</span></div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  endox = origx + (nx - 1) * widthx;</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  endoy = origy + (ny - 1) * widthy;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;  endoz = origz + (nz - 1) * widthz;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  ux[0] = ax * origx + bx * origy + cx * origz;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  uy[0] = ay * origx + by * origy + cy * origz;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;  uz[0] = az * origx + bz * origy + cz * origz;</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  ux[1] = ax * endox + bx * origy + cx * origz;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  uy[1] = ay * endox + by * origy + cy * origz;</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;  uz[1] = az * endox + bz * origy + cz * origz;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  ux[2] = ax * origx + bx * endoy + cx * origz;</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  uy[2] = ay * origx + by * endoy + cy * origz;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;  uz[2] = az * origx + bz * endoy + cz * origz;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  ux[3] = ax * origx + bx * origy + cx * endoz;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  uy[3] = ay * origx + by * origy + cy * endoz;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  uz[3] = az * origx + bz * origy + cz * endoz;</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  ux[4] = ax * endox + bx * endoy + cx * origz;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  uy[4] = ay * endox + by * endoy + cy * origz;</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  uz[4] = az * endox + bz * endoy + cz * origz;</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  ux[5] = ax * origx + bx * endoy + cx * endoz;</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  uy[5] = ay * origx + by * endoy + cy * endoz;</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  uz[5] = az * origx + bz * endoy + cz * endoz;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  ux[6] = ax * endox + bx * origy + cx * endoz;</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;  uy[6] = ay * endox + by * origy + cy * endoz;</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  uz[6] = az * endox + bz * origy + cz * endoz;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  ux[7] = ax * endox + bx * endoy + cx * endoz;</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;  uy[7] = ay * endox + by * endoy + cy * endoz;</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  uz[7] = az * endox + bz * endoy + cz * endoz;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  uxmin = 1E20;</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; 8; i++) <span class="keywordflow">if</span> (ux[i] &lt; uxmin) uxmin = ux[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  uymin = 1E20;</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; 8; i++) <span class="keywordflow">if</span> (uy[i] &lt; uymin) uymin = uy[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  uzmin = 1E20;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; 8; i++) <span class="keywordflow">if</span> (uz[i] &lt; uzmin) uzmin = uz[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  uxmax = -1E20;</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; 8; i++) if (ux[i] &gt; uxmax) uxmax = ux[i];</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;  uymax = -1E20;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; 8; i++) if (uy[i] &gt; uymax) uymax = uy[i];</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  uzmax = -1E20;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; 8; i++) if (uz[i] &gt; uzmax) uzmax = uz[i];</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  <span class="comment">/* for interpolation, find minimum voxel spacing, rounded to nearest 0.1 Angstrom for good measure */</span></div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  *pwidth = widthx; <span class="comment">/* ax = 1 */</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  <span class="keywordflow">if</span> ((widthy * by) &lt; *pwidth) *pwidth = widthy * by;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  <span class="keywordflow">if</span> ((widthz * cz) &lt; *pwidth) *pwidth = widthz * cz;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  *pwidth = <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(*pwidth * 10.0 + 0.5) / 10.0;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  <span class="comment">/* compute output origin */</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  <span class="comment">/* we start pphiout at or below lower bound of phiin, and assert the new origin is in register with origin of the orthogonal coordinate system */</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  *porigx = *pwidth * <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(uxmin / *pwidth);</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  *porigy = *pwidth * <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(uymin / *pwidth);</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  *porigz = *pwidth * <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(uzmin / *pwidth);</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  <span class="comment">/* compute output map dimensions */</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  <span class="comment">/* we end pphiout at or above upper bound of phiin */</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  *pextx = (int)(ceil(uxmax / *pwidth) - <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(uxmin / *pwidth) + 1.5);</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  *pexty = (int)(ceil(uymax / *pwidth) - <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(uymin / *pwidth) + 1.5);</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  *pextz = (int)(ceil(uzmax / *pwidth) - <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(uzmin / *pwidth) + 1.5);</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  pnvox = *pextx * *pexty * *pextz;</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  <span class="comment">/* create output map, and loop through its cubic lattice to perform interpolation */</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  <a class="code" href="lib__vec_8cpp.html#a44e7aedec778e3afa2bfb2579f2f5c76">do_vect</a>(pphiout, pnvox);</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  <span class="keywordflow">for</span> (indz = 0; indz &lt; (int)*pextz; indz++)</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="keywordflow">for</span> (indy = 0; indy &lt; (int)*pexty; indy++)</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;      <span class="keywordflow">for</span> (indx = 0; indx &lt; (int)*pextx; indx++) {</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        <span class="comment">/* determine position in orthogonal coordinates */</span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        xpos = *porigx + indx * *pwidth;</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        ypos = *porigy + indy * *pwidth;</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        zpos = *porigz + indz * *pwidth;</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        <span class="comment">/* compute position of probe cube within skewed map in voxel units */</span></div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        gx = (aix * xpos + bix * ypos + cix * zpos - origx) / widthx;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        gy = (aiy * xpos + biy * ypos + ciy * zpos - origy) / widthy;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        gz = (aiz * xpos + biz * ypos + ciz * zpos - origz) / widthz;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        x0 = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(gx);</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        y0 = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(gy);</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        z0 = (int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(gz);</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        x1 = x0 + 1;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        y1 = y0 + 1;</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        z1 = z0 + 1;</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;        <span class="comment">/* if probe cube is fully within skewed map, do interpolate */</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;        <span class="keywordflow">if</span> (x0 &gt;= 0 &amp;&amp; x1 &lt; (<span class="keywordtype">int</span>)nx &amp;&amp; y0 &gt;= 0 &amp;&amp; y1 &lt; (int)ny &amp;&amp; </div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;            z0 &gt;= 0 &amp;&amp; z1 &lt; (<span class="keywordtype">int</span>)nz) {</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;          a = gx - <a class="code" href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a>;</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;          b = gy - <a class="code" href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a>;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;          c = gz - <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;          *(*pphiout + <a class="code" href="lib__vwk_8cpp.html#a8101287e9fd64ebd4bb0b666f0e16019">gidz_general</a>(indz, indy, indx, *pexty, *pextx)) =</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;            a * b * c * *(phiin + <a class="code" href="lib__vwk_8cpp.html#a8101287e9fd64ebd4bb0b666f0e16019">gidz_general</a>(z1, y1, x1, ny, nx)) +</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;            (1 - a) * b * c * *(phiin + <a class="code" href="lib__vwk_8cpp.html#a8101287e9fd64ebd4bb0b666f0e16019">gidz_general</a>(z1, y1, x0, ny, nx)) +</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;            a * (1 - b) * c * *(phiin + <a class="code" href="lib__vwk_8cpp.html#a8101287e9fd64ebd4bb0b666f0e16019">gidz_general</a>(z1, y0, x1, ny, nx)) +</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            a * b * (1 - c) * *(phiin + <a class="code" href="lib__vwk_8cpp.html#a8101287e9fd64ebd4bb0b666f0e16019">gidz_general</a>(z0, y1, x1, ny, nx)) +</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;            a * (1 - b) * (1 - <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>) * *(phiin + <a class="code" href="lib__vwk_8cpp.html#a8101287e9fd64ebd4bb0b666f0e16019">gidz_general</a>(z0, y0, x1, ny, nx)) +</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;            (1 - a) * b * (1 - <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>) * *(phiin + <a class="code" href="lib__vwk_8cpp.html#a8101287e9fd64ebd4bb0b666f0e16019">gidz_general</a>(z0, y1, x0, ny, nx)) +</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            (1 - a) * (1 - <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>) * c * *(phiin + <a class="code" href="lib__vwk_8cpp.html#a8101287e9fd64ebd4bb0b666f0e16019">gidz_general</a>(z1, y0, x0, ny, nx)) +</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;            (1 - a) * (1 - <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>) * (1 - c) * *(phiin + <a class="code" href="lib__vwk_8cpp.html#a8101287e9fd64ebd4bb0b666f0e16019">gidz_general</a>(z0, y0, x0, ny, nx));</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        }</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;      }</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Conversion to cubic lattice completed. \n&quot;</span>);</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;}</div><div class="ttc" id="cuda__basic__math_8h_html_a2065eb145275f878c1d045c9f3fb1cc7"><div class="ttname"><a href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a></div><div class="ttdeci">__host__ __device__ float2 floor(const float2 v)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__basic__math_8h_source.html#l00175">cuda_basic_math.h:175</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="namespacealglib_html_a038c39f3bfe0dff667a2cb6bebfed764"><div class="ttname"><a href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">alglib::beta</a></div><div class="ttdeci">double beta(const double a, const double b)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l00962">specialfunctions.cpp:962</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="lib__vwk_8cpp_html_a8101287e9fd64ebd4bb0b666f0e16019"><div class="ttname"><a href="lib__vwk_8cpp.html#a8101287e9fd64ebd4bb0b666f0e16019">gidz_general</a></div><div class="ttdeci">unsigned long gidz_general(int k, int j, int i, unsigned ey, unsigned ex)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vwk_8cpp_source.html#l00032">lib_vwk.cpp:32</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a3f5c4dfb0dff56801752771f78265fbe"><div class="ttname"><a href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a></div><div class="ttdeci">#define z0</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_acf097d43154f3f002dbb9692ce4c55f7"><div class="ttname"><a href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a></div><div class="ttdeci">double * gamma</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07616">numerical_recipes.cpp:7616</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af090b2fbbd2916bfb2e493c5162969d6"><div class="ttname"><a href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a></div><div class="ttdeci">doublereal * b</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a0830557602c8f16c2053ae8cf69b898d"><div class="ttname"><a href="lib__vio_8cpp.html#a0830557602c8f16c2053ae8cf69b898d">set_origin_get_mode</a></div><div class="ttdeci">int set_origin_get_mode(int nxstart, int nystart, int nzstart, double widthx, double widthy, double widthz, double xorigin, double yorigin, double zorigin, double *origx, double *origy, double *origz)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l01307">lib_vio.cpp:1307</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a0d9521fd31b2e16413d1b78836953d53"><div class="ttname"><a href="blobs_8cpp.html#a0d9521fd31b2e16413d1b78836953d53">y0</a></div><div class="ttdeci">#define y0</div></div>
<div class="ttc" id="blobs_8cpp_html_a94ec8a7a5cf5c289d292aef5777c4c14"><div class="ttname"><a href="blobs_8cpp.html#a94ec8a7a5cf5c289d292aef5777c4c14">x0</a></div><div class="ttdeci">#define x0</div></div>
<div class="ttc" id="lib__err_8cpp_html_aca6159162702ed06e97263f32fb78d9b"><div class="ttname"><a href="lib__err_8cpp.html#aca6159162702ed06e97263f32fb78d9b">error_sqrt_negative</a></div><div class="ttdeci">void error_sqrt_negative(int error_number, const char *program)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00222">lib_err.cpp:222</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_a221d661e40558ad74e59d386e946b8a1"><div class="ttname"><a href="lib__err_8cpp.html#a221d661e40558ad74e59d386e946b8a1">error_divide_zero</a></div><div class="ttdeci">void error_divide_zero(int error_number, const char *program)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00217">lib_err.cpp:217</a></div></div>
<div class="ttc" id="lib__vec_8cpp_html_a44e7aedec778e3afa2bfb2579f2f5c76"><div class="ttname"><a href="lib__vec_8cpp.html#a44e7aedec778e3afa2bfb2579f2f5c76">do_vect</a></div><div class="ttdeci">void do_vect(double **pvect, unsigned long len)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vec_8cpp_source.html#l00032">lib_vec.cpp:32</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af2a333b1670df64a88d3a2f22210d155"><div class="ttname"><a href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a></div><div class="ttdeci">doublereal * a</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a739551ee3744d0e57948b94f1798f7eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void permute_dimensions </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l01220">1220</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;{</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  <span class="keywordflow">switch</span> (ordermode) {</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      *nx = nc;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      *ny = nr;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      *nz = ns;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      *nxstart = ncstart;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      *nystart = nrstart;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      *nzstart = nsstart;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      *nx = nc;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;      *ny = ns;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      *nz = nr;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      *nxstart = ncstart;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      *nystart = nsstart;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;      *nzstart = nrstart;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      *nx = nr;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      *ny = nc;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      *nz = ns;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      *nxstart = nrstart;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;      *nystart = ncstart;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;      *nzstart = nsstart;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      *nx = ns;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;      *ny = nc;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      *nz = nr;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      *nxstart = nsstart;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      *nystart = ncstart;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      *nzstart = nrstart;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      *nx = nr;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      *ny = ns;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      *nz = nc;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      *nxstart = nrstart;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      *nystart = nsstart;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      *nzstart = ncstart;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;      *nx = ns;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;      *ny = nr;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      *nz = nc;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      *nxstart = nsstart;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;      *nystart = nrstart;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;      *nzstart = ncstart;</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;      <a class="code" href="lib__err_8cpp.html#a9edf89d84a6492ca867bde8c52cd801a">error_option</a>(70212, <span class="stringliteral">&quot;lib_vio&quot;</span>);</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  }</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;}</div><div class="ttc" id="lib__err_8cpp_html_a9edf89d84a6492ca867bde8c52cd801a"><div class="ttname"><a href="lib__err_8cpp.html#a9edf89d84a6492ca867bde8c52cd801a">error_option</a></div><div class="ttdeci">void error_option(int error_number, const char *program)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00061">lib_err.cpp:61</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab475318046e1779bc138dcb8c95b205a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void permute_map </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l01198">1198</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;{</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nvox, count;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  <span class="comment">/* create permuted map pphi */</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  nvox = nc * nr * ns;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  <a class="code" href="lib__vec_8cpp.html#a44e7aedec778e3afa2bfb2579f2f5c76">do_vect</a>(pphi, nvox);</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  <span class="keywordflow">for</span> (count = 0; count &lt; nvox; count++) </div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    *(*pphi + <a class="code" href="lib__vio_8cpp.html#a3accb2bfe860c264d694c3950d888676">permuted_index</a>(ordermode, count, nc, nr, ns)) = *(phi + count);</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <a class="code" href="lib__vec_8cpp.html#aae41642ab5fb260fdb9eac7b173a552e">free_vect_and_zero_ptr</a>((<span class="keywordtype">void</span>**)&amp;phi);</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  <span class="comment">/* permute the map dimensions */</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  <a class="code" href="lib__vio_8cpp.html#a582e4133e395041e58d0b8abe7f90a93">permute_dimensions</a>(ordermode, nc, nr, ns, nx, ny, nz, ncstart, nrstart, </div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                     nsstart, nxstart, nystart, nzstart);</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;}</div><div class="ttc" id="lib__vec_8cpp_html_aae41642ab5fb260fdb9eac7b173a552e"><div class="ttname"><a href="lib__vec_8cpp.html#aae41642ab5fb260fdb9eac7b173a552e">free_vect_and_zero_ptr</a></div><div class="ttdeci">void free_vect_and_zero_ptr(void **pvect)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vec_8cpp_source.html#l00083">lib_vec.cpp:83</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a3accb2bfe860c264d694c3950d888676"><div class="ttname"><a href="lib__vio_8cpp.html#a3accb2bfe860c264d694c3950d888676">permuted_index</a></div><div class="ttdeci">unsigned long permuted_index(int ordermode, unsigned long count, unsigned nc, unsigned nr, unsigned ns)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l01165">lib_vio.cpp:1165</a></div></div>
<div class="ttc" id="lib__vec_8cpp_html_a44e7aedec778e3afa2bfb2579f2f5c76"><div class="ttname"><a href="lib__vec_8cpp.html#a44e7aedec778e3afa2bfb2579f2f5c76">do_vect</a></div><div class="ttdeci">void do_vect(double **pvect, unsigned long len)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vec_8cpp_source.html#l00032">lib_vec.cpp:32</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a582e4133e395041e58d0b8abe7f90a93"><div class="ttname"><a href="lib__vio_8cpp.html#a582e4133e395041e58d0b8abe7f90a93">permute_dimensions</a></div><div class="ttdeci">void permute_dimensions(int ordermode, unsigned nc, unsigned nr, unsigned ns, unsigned *nx, unsigned *ny, unsigned *nz, int ncstart, int nrstart, int nsstart, int *nxstart, int *nystart, int *nzstart)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l01220">lib_vio.cpp:1220</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0b6c7e4a0aac9ab279213be7cd0bb239"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void permute_print_info </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l01282">1282</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;{</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  <span class="keywordflow">if</span> (ordermode &gt; 1) {</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Map parameters BEFORE selected axis permutation: \n&quot;</span>);</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;       NC = %8d  (# columns)\n&quot;</span>, nc);</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;       NR = %8d  (# rows)\n&quot;</span>, nr);</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;       NS = %8d  (# sections)\n&quot;</span>, ns);</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;  NCSTART = %8d  (index of first column, counting from 0)\n&quot;</span>, ncstart);</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;  NRSTART = %8d  (index of first row, counting from 0)\n&quot;</span>, nrstart);</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;  NSSTART = %8d  (index of first section, counting from 0)\n&quot;</span>, nsstart);</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Map parameters AFTER selected axis permutation: \n&quot;</span>);</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;       NX = %8d  (# X fields)\n&quot;</span>, nx);</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;       NY = %8d  (# Y fields)\n&quot;</span>, ny);</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;       NZ = %8d  (# Z fields)\n&quot;</span>, nz);</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;  NXSTART = %8d  (X index of first voxel, counting from 0)\n&quot;</span>, nxstart);</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;  NYSTART = %8d  (Y index of first voxel, counting from 0)\n&quot;</span>, nystart);</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;  NZSTART = %8d  (Z index of first voxel, counting from 0)\n&quot;</span>, nzstart);</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; C,R,S = X,Y,Z (no axis permutation). \n&quot;</span>);</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  }</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad8fa92ca661d88178fbf58a6ce3db4c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long permuted_index </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>long</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l01165">1165</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;{</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="keywordtype">unsigned</span> ic, <a class="code" href="image__find__center_8cpp.html#a108a1d0fcea4288c9e48f5dc4fa0a1b0">ir</a>, is;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ncr, q;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  ncr = nc * nr;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  is = count / ncr;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  q = count - is * ncr;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  ir = q / nc;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  ic = q - ir * nc;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  <span class="keywordflow">switch</span> (ordermode) {</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      <span class="keywordflow">return</span> ic + ir * nc + is * nc * nr;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      <span class="keywordflow">return</span> ic + is * nc + ir * nc * ns;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      <span class="keywordflow">return</span> ir + ic * nr + is * nr * nc;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      <span class="keywordflow">return</span> is + ic * ns + ir * ns * nc;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      <span class="keywordflow">return</span> ir + is * nr + ic * nr * ns;</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      <span class="keywordflow">return</span> is + ir * ns + ic * ns * nr;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      <a class="code" href="lib__err_8cpp.html#a9edf89d84a6492ca867bde8c52cd801a">error_option</a>(70210, <span class="stringliteral">&quot;lib_vio&quot;</span>);</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  }</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;}</div><div class="ttc" id="lib__err_8cpp_html_a9edf89d84a6492ca867bde8c52cd801a"><div class="ttname"><a href="lib__err_8cpp.html#a9edf89d84a6492ca867bde8c52cd801a">error_option</a></div><div class="ttdeci">void error_option(int error_number, const char *program)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00061">lib_err.cpp:61</a></div></div>
<div class="ttc" id="image__find__center_8cpp_html_a108a1d0fcea4288c9e48f5dc4fa0a1b0"><div class="ttname"><a href="image__find__center_8cpp.html#a108a1d0fcea4288c9e48f5dc4fa0a1b0">ir</a></div><div class="ttdeci">int ir</div><div class="ttdef"><b>Definition:</b> <a href="image__find__center_8cpp_source.html#l00054">image_find_center.cpp:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7436bdc9767e8d4e6cc896aaa1b7eea4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_ascii </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>long</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l00163">163</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;{</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  FILE *fin;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordtype">float</span> currfloat;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  fin = fopen(vol_file, <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordflow">if</span> (fin == NULL) {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a>(70310, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Reading ASCII data... \n&quot;</span>);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <a class="code" href="lib__vec_8cpp.html#a44e7aedec778e3afa2bfb2579f2f5c76">do_vect</a>(fphi, nvox);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordflow">for</span> (count = 0; count &lt; nvox; count++) {</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">if</span> (fscanf(fin, <span class="stringliteral">&quot;%e&quot;</span>, &amp;currfloat) != 1) {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <a class="code" href="lib__err_8cpp.html#aa73a803f0e59a0f38121ff368c0fa55c">error_unreadable_file_short</a>(70330 , <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      *(*fphi + count) = currfloat;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordflow">if</span> (fscanf(fin, <span class="stringliteral">&quot;%e&quot;</span>, &amp;currfloat) != EOF) {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="lib__err_8cpp.html#a9c0a91bc7428bdff26fbefa4521dc26d">error_unreadable_file_long</a>(70340 , <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Volumetric data read from file %s\n&quot;</span>, vol_file);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  fclose(fin);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div><div class="ttc" id="lib__err_8cpp_html_ae76582a4cbab89aa99fcf38effea84e5"><div class="ttname"><a href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a></div><div class="ttdeci">void error_open_filename(int error_number, const char *program, char *argv)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00067">lib_err.cpp:67</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_a9c0a91bc7428bdff26fbefa4521dc26d"><div class="ttname"><a href="lib__err_8cpp.html#a9c0a91bc7428bdff26fbefa4521dc26d">error_unreadable_file_long</a></div><div class="ttdeci">void error_unreadable_file_long(int error_number, const char *program, const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00148">lib_err.cpp:148</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_aa73a803f0e59a0f38121ff368c0fa55c"><div class="ttname"><a href="lib__err_8cpp.html#aa73a803f0e59a0f38121ff368c0fa55c">error_unreadable_file_short</a></div><div class="ttdeci">void error_unreadable_file_short(int error_number, const char *program, const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00143">lib_err.cpp:143</a></div></div>
<div class="ttc" id="lib__vec_8cpp_html_a44e7aedec778e3afa2bfb2579f2f5c76"><div class="ttname"><a href="lib__vec_8cpp.html#a44e7aedec778e3afa2bfb2579f2f5c76">do_vect</a></div><div class="ttdeci">void do_vect(double **pvect, unsigned long len)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vec_8cpp_source.html#l00032">lib_vec.cpp:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5359ae732d6d62ee90a909de5f9a15cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_char </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l00874">874</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;{</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <span class="keywordflow">if</span> (fread(currchar, 1, 1, fin) != 1) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2273d65fc0bdcd326715c05bd80b5296"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_char_float </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l00863">863</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;{</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  <span class="keywordtype">char</span> currchar;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="keywordflow">if</span> (fread(&amp;currchar, 1, 1, fin) != 1) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  *currfloat = (float)currchar;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9c923cac1bb099147449e6ad35d48b1a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_float </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l00817">817</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;{</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *cptr, tmp;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <span class="keywordflow">if</span> (fread(currfloat, 4, 1, fin) != 1) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <span class="keywordflow">if</span> (swap == 1) {</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    cptr = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)currfloat;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    tmp = cptr[0];</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    cptr[0] = cptr[3];</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    cptr[3] = tmp;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    tmp = cptr[1];</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    cptr[1] = cptr[2];</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    cptr[2] = tmp;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  }</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1d60980cc71594dadfc2975fc2545b89"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_float_empty </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l00854">854</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;{</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="keywordtype">float</span> currfloat;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="keywordflow">if</span> (fread(&amp;currfloat, 4, 1, fin) != 1) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a87645c3bf06e778dce03738464787e14"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_int </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l00883">883</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;{</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *cptr, tmp;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="keywordflow">if</span> (fread(currlong, 4, 1, fin) != 1) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="keywordflow">if</span> (swap == 1) {</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    cptr = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)currlong;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    tmp = cptr[0];</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    cptr[0] = cptr[3];</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    cptr[3] = tmp;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    tmp = cptr[1];</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    cptr[1] = cptr[2];</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    cptr[2] = tmp;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  }</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a890a5b56e76cc6081ad68dded6b2996f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_mrc </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l00369">369</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;{</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count, nvox;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  FILE *fin;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordtype">int</span> nc_tmp, nr_tmp, ns_tmp, mx, my, mz;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a>;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordtype">float</span> a_tmp, b_tmp, g_tmp;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keywordtype">float</span> x_tmp, y_tmp, z_tmp;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keywordtype">int</span> testa, testb, testg;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keywordtype">float</span> xlen, ylen, zlen;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, swap, header_ok = 1;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keywordtype">int</span> mapc, mapr, maps;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keywordtype">float</span> <a class="code" href="numerical__recipes_8cpp.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a>, <a class="code" href="numerical__recipes_8cpp.html#ae1dcd09f9c8de5971c9a85494ab952e9">dmax</a>, dmean, <a class="code" href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a>, currfloat, cfunsigned, prevfloat = 0.0f, pfunsigned = 0.0f, <a class="code" href="group__Filters.html#ga21987af66fc45fb745dcfde4c095c95a">rms</a>;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keywordtype">double</span> totdiffsigned = 0.0, totdiffunsigned = 0.0;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordtype">int</span> n_range_viol0, n_range_viol1;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordtype">char</span> mapchar1, mapchar2, mapchar3, mapchar4;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keywordtype">char</span> machstchar1, machstchar2, machstchar3, machstchar4;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordtype">int</span> ispg, nsymbt, lskflg;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordtype">float</span> skwmat11, skwmat12, skwmat13, skwmat21, skwmat22, skwmat23, skwmat31, skwmat32, skwmat33, skwtrn1, skwtrn2, skwtrn3;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  n_range_viol0 = <a class="code" href="lib__vio_8cpp.html#a86acc90388953ea01f3bc85feab1e035">test_mrc</a>(vol_file, 0);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  n_range_viol1 = <a class="code" href="lib__vio_8cpp.html#a86acc90388953ea01f3bc85feab1e035">test_mrc</a>(vol_file, 1);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keywordflow">if</span> (n_range_viol0 &lt; n_range_viol1) { <span class="comment">/* guess endianism */</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    swap = 0;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">if</span> (n_range_viol0 &gt; 0) {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Warning: %i header field range violations detected in file %s \n&quot;</span>, n_range_viol0, vol_file);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    }</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    swap = 1;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">if</span> (n_range_viol1 &gt; 0) {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Warning: %i header field range violations detected in file %s \n&quot;</span>, n_range_viol1, vol_file);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="comment">/* read header */</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  fin = fopen(vol_file, <span class="stringliteral">&quot;rb&quot;</span>);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordflow">if</span> (fin == NULL) {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <a class="code" href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a>(70620, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  }</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Reading header information from MRC or CCP4 file %s \n&quot;</span>, vol_file);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;nc_tmp, fin, swap);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;nr_tmp, fin, swap);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;ns_tmp, fin, swap);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  *nc = nc_tmp;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  *nr = nr_tmp;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  *ns = ns_tmp;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;mode, fin, swap);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(ncstart, fin, swap);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(nrstart, fin, swap);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(nsstart, fin, swap);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;mx, fin, swap);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;my, fin, swap);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;mz, fin, swap);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;xlen, fin, swap);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;ylen, fin, swap);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;zlen, fin, swap);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;a_tmp, fin, swap);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;b_tmp, fin, swap);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;g_tmp, fin, swap);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  *alpha = a_tmp;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  *<a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a> = b_tmp;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  *<a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a> = g_tmp;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;mapc, fin, swap);</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;mapr, fin, swap);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;maps, fin, swap);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;dmin, fin, swap);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;dmax, fin, swap);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;dmean, fin, swap);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;ispg, fin, swap);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;nsymbt, fin, swap);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;lskflg, fin, swap);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;skwmat11, fin, swap);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;skwmat12, fin, swap);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;skwmat13, fin, swap);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;skwmat21, fin, swap);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;skwmat22, fin, swap);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;skwmat23, fin, swap);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;skwmat31, fin, swap);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;skwmat32, fin, swap);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;skwmat33, fin, swap);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;skwtrn1, fin, swap);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;skwtrn2, fin, swap);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;skwtrn3, fin, swap);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="keywordflow">for</span> (i = 38; i &lt; 50; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;dummy, fin, swap);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;x_tmp, fin, swap);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;y_tmp, fin, swap);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;z_tmp, fin, swap);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  *xorigin = x_tmp;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  *yorigin = y_tmp;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  *zorigin = z_tmp;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a2be17e8a02c1f24c50001c6195d1e3bf">read_char</a>(&amp;mapchar1, fin);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a2be17e8a02c1f24c50001c6195d1e3bf">read_char</a>(&amp;mapchar2, fin);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a2be17e8a02c1f24c50001c6195d1e3bf">read_char</a>(&amp;mapchar3, fin);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a2be17e8a02c1f24c50001c6195d1e3bf">read_char</a>(&amp;mapchar4, fin);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a2be17e8a02c1f24c50001c6195d1e3bf">read_char</a>(&amp;machstchar1, fin);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a2be17e8a02c1f24c50001c6195d1e3bf">read_char</a>(&amp;machstchar2, fin);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a2be17e8a02c1f24c50001c6195d1e3bf">read_char</a>(&amp;machstchar3, fin);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a2be17e8a02c1f24c50001c6195d1e3bf">read_char</a>(&amp;machstchar4, fin);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;<a class="code" href="group__Filters.html#ga21987af66fc45fb745dcfde4c095c95a">rms</a>, fin, swap);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordflow">if</span> (header_ok == 0) {</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <a class="code" href="lib__err_8cpp.html#a5ace2fcbdc86ea9066751e53edd6f943">error_file_header</a>(70650, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  }</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="comment">/* print some info */</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;       NC = %8d  (# columns)\n&quot;</span>, *nc);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;       NR = %8d  (# rows)\n&quot;</span>, *nr);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;       NS = %8d  (# sections)\n&quot;</span>, *ns);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     MODE = %8d  (data type: 0: 8-bit, 1: 16-bit; 2: 32-bit)\n&quot;</span>, mode);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;  NCSTART = %8d  (index of first column, counting from 0)\n&quot;</span>, *ncstart);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;  NRSTART = %8d  (index of first row, counting from 0)\n&quot;</span>, *nrstart);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;  NSSTART = %8d  (index of first section, counting from 0)\n&quot;</span>, *nsstart);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;       MX = %8d  (# of X intervals in unit cell)\n&quot;</span>, mx);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;       MY = %8d  (# of Y intervals in unit cell)\n&quot;</span>, my);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;       MZ = %8d  (# of Z intervals in unit cell)\n&quot;</span>, mz);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; X length = %8.3f  (unit cell dimension)\n&quot;</span>, xlen);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Y length = %8.3f  (unit cell dimension)\n&quot;</span>, ylen);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Z length = %8.3f  (unit cell dimension)\n&quot;</span>, zlen);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    Alpha = %8.3f  (unit cell angle)\n&quot;</span>, *alpha);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     Beta = %8.3f  (unit cell angle)\n&quot;</span>, *<a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    Gamma = %8.3f  (unit cell angle)\n&quot;</span>, *<a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a>);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     MAPC = %8d  (columns axis: 1=X,2=Y,3=Z)\n&quot;</span>, mapc);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     MAPR = %8d  (rows axis: 1=X,2=Y,3=Z)\n&quot;</span>, mapr);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     MAPS = %8d  (sections axis: 1=X,2=Y,3=Z)\n&quot;</span>, maps);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     DMIN = %8.3f  (minimum density value - ignored)\n&quot;</span>, dmin);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     DMAX = %8.3f  (maximum density value - ignored)\n&quot;</span>, dmax);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    DMEAN = %8.3f  (mean density value - ignored)\n&quot;</span>, dmean);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     ISPG = %8d  (space group number - ignored)\n&quot;</span>, ispg);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   NSYMBT = %8d  (# bytes storing symmetry operators)\n&quot;</span>, nsymbt);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   LSKFLG = %8d  (skew matrix flag: 0:none, 1:follows)\n&quot;</span>, lskflg);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keywordflow">if</span> (lskflg != 0) {</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Warning: Will compute skew parameters from the above header info.\n&quot;</span>);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The following skew parameters in the header will be ignored:\n&quot;</span>);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      S11 = %8.3f  (skew matrix element 11)\n&quot;</span>, skwmat11);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      S12 = %8.3f  (skew matrix element 12)\n&quot;</span>, skwmat12);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      S13 = %8.3f  (skew matrix element 13)\n&quot;</span>, skwmat13);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      S21 = %8.3f  (skew matrix element 21)\n&quot;</span>, skwmat21);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      S22 = %8.3f  (skew matrix element 22)\n&quot;</span>, skwmat22);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      S23 = %8.3f  (skew matrix element 23)\n&quot;</span>, skwmat23);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      S31 = %8.3f  (skew matrix element 31)\n&quot;</span>, skwmat31);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      S32 = %8.3f  (skew matrix element 32)\n&quot;</span>, skwmat32);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      S33 = %8.3f  (skew matrix element 33)\n&quot;</span>, skwmat33);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;       T1 = %8.3f  (skew translation element 1)\n&quot;</span>, skwtrn1);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;       T2 = %8.3f  (skew translation element 2)\n&quot;</span>, skwtrn2);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;       T3 = %8.3f  (skew translation element 3)\n&quot;</span>, skwtrn3);</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; End of skew parameters warning.\n&quot;</span>);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  }</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;  XORIGIN = %8.3f  (X origin - MRC2000 only)\n&quot;</span>, *xorigin);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;  YORIGIN = %8.3f  (Y origin - MRC2000 only)\n&quot;</span>, *yorigin);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;  ZORIGIN = %8.3f  (Z origin - MRC2000 only)\n&quot;</span>, *zorigin);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;      MAP =      %c%c%c%c (map string)\n&quot;</span>, mapchar1, mapchar2, mapchar3, mapchar4);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   MACHST = %d %d %d %d (machine stamp - ignored)\n&quot;</span>, machstchar1, machstchar2, machstchar3, machstchar4);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;      RMS = %8.3f  (density rms deviation -ignored)\n&quot;</span>, <a class="code" href="group__Filters.html#ga21987af66fc45fb745dcfde4c095c95a">rms</a>);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordflow">if</span> (mapchar1 != <span class="charliteral">&#39;M&#39;</span> || mapchar2 != <span class="charliteral">&#39;A&#39;</span> || mapchar3 != <span class="charliteral">&#39;P&#39;</span>) {</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Warning: MAP string not detected. It appears this is an older (pre-2000) or unconventional MRC format.\n&quot;</span>);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; If in doubt use the map2map tool in manual mode and/or inspect the results.\n&quot;</span>);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  }</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="comment">/* extract data based on file type mode, currently supports 8-bit, 16-bit, and 32-bit */</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="comment">/* note: fphi will contain data in the order of the input file, no axis permutation yet */</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  nvox = *nc * *nr * *ns;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="keywordflow">switch</span> (mode) {</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordflow">case</span> 0: <span class="comment">/* char - converted to float, testing for signed-ness*/</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      rewind(fin);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <a class="code" href="lib__vec_8cpp.html#a44e7aedec778e3afa2bfb2579f2f5c76">do_vect</a>(fphi, nvox);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="keywordflow">for</span> (count = 0; count &lt; 256; ++count) <span class="keywordflow">if</span> (<a class="code" href="lib__vio_8cpp.html#adb9f66153b4470a8bd2891a44aa99025">read_float_empty</a>(fin) == 0) <a class="code" href="lib__err_8cpp.html#a92055236cfeb5aab7d647a0b6ab19a69">error_file_convert</a>(70642, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      <span class="keywordflow">for</span> (count = 0; count &lt; (<span class="keywordtype">unsigned</span> long)nsymbt; ++count) <span class="keywordflow">if</span> (<a class="code" href="lib__vio_8cpp.html#a1054251386c216ffca99c86817e97f41">read_char_float</a>(&amp;currfloat, fin) == 0) <a class="code" href="lib__err_8cpp.html#a92055236cfeb5aab7d647a0b6ab19a69">error_file_convert</a>(70643, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <span class="keywordflow">for</span> (count = 0; count &lt; nvox; ++count) {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="lib__vio_8cpp.html#a1054251386c216ffca99c86817e97f41">read_char_float</a>(&amp;currfloat, fin) == 0) <a class="code" href="lib__err_8cpp.html#a92055236cfeb5aab7d647a0b6ab19a69">error_file_convert</a>(70651, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;          *(*fphi + count) = currfloat;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;          <span class="keywordflow">if</span> (currfloat &lt; 0) cfunsigned = currfloat + 256.0;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;          <span class="keywordflow">else</span> cfunsigned = currfloat;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;          totdiffsigned += fabs(currfloat - prevfloat);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;          totdiffunsigned += fabs(cfunsigned - pfunsigned);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;          prevfloat = currfloat;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;          pfunsigned = cfunsigned;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        }</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      }</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      fclose(fin);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <span class="keywordflow">if</span> (totdiffsigned &gt; totdiffunsigned) {</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keywordflow">for</span> (count = 0; count &lt; nvox; count++) <span class="keywordflow">if</span> (*(*fphi + count) &lt; 0) *(*fphi + count) += 256.0;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        printf(<span class="stringliteral">&quot;lib_vio&gt; Warning: It appears the MODE 0 data type uses the unsigned 8-bit convention, adding 256 to negative values.\n&quot;</span>);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        printf(<span class="stringliteral">&quot;lib_vio&gt; If in doubt use the map2map tool in manual mode and/or inspect the results.\n&quot;</span>);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordflow">case</span> 1: <span class="comment">/* 16-bit float */</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      rewind(fin);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      <a class="code" href="lib__vec_8cpp.html#a44e7aedec778e3afa2bfb2579f2f5c76">do_vect</a>(fphi, nvox);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="keywordflow">for</span> (count = 0; count &lt; 256; ++count) <span class="keywordflow">if</span> (<a class="code" href="lib__vio_8cpp.html#adb9f66153b4470a8bd2891a44aa99025">read_float_empty</a>(fin) == 0) {</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;          <a class="code" href="lib__err_8cpp.html#a92055236cfeb5aab7d647a0b6ab19a69">error_file_convert</a>(70644, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        }</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      <span class="keywordflow">for</span> (count = 0; count &lt; (<span class="keywordtype">unsigned</span> long)nsymbt; ++count) <span class="keywordflow">if</span> (<a class="code" href="lib__vio_8cpp.html#a1054251386c216ffca99c86817e97f41">read_char_float</a>(&amp;currfloat, fin) == 0) {</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;          <a class="code" href="lib__err_8cpp.html#a92055236cfeb5aab7d647a0b6ab19a69">error_file_convert</a>(70645, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        }</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      <span class="keywordflow">for</span> (count = 0; count &lt; nvox; ++count) {</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="lib__vio_8cpp.html#a63e126231ae19d447fe077c65d5f2508">read_short_float</a>(&amp;currfloat, fin, swap) == 0) {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;          <a class="code" href="lib__err_8cpp.html#a92055236cfeb5aab7d647a0b6ab19a69">error_file_convert</a>(70652, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;          *(*fphi + count) = currfloat;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        }</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      }</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      fclose(fin);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordflow">case</span> 2: <span class="comment">/* 32-bit float */</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      rewind(fin);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <a class="code" href="lib__vec_8cpp.html#a44e7aedec778e3afa2bfb2579f2f5c76">do_vect</a>(fphi, nvox);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <span class="keywordflow">for</span> (count = 0; count &lt; 256; ++count) <span class="keywordflow">if</span> (<a class="code" href="lib__vio_8cpp.html#adb9f66153b4470a8bd2891a44aa99025">read_float_empty</a>(fin) == 0) {</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;          <a class="code" href="lib__err_8cpp.html#a92055236cfeb5aab7d647a0b6ab19a69">error_file_convert</a>(70646, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <span class="keywordflow">for</span> (count = 0; count &lt; (<span class="keywordtype">unsigned</span> long)nsymbt; ++count) <span class="keywordflow">if</span> (<a class="code" href="lib__vio_8cpp.html#a1054251386c216ffca99c86817e97f41">read_char_float</a>(&amp;currfloat, fin) == 0) {</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;          <a class="code" href="lib__err_8cpp.html#a92055236cfeb5aab7d647a0b6ab19a69">error_file_convert</a>(70647, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        }</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      <span class="keywordflow">for</span> (count = 0; count &lt; nvox; ++count) {</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;currfloat, fin, swap) == 0) {</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;          <a class="code" href="lib__err_8cpp.html#a92055236cfeb5aab7d647a0b6ab19a69">error_file_convert</a>(70653, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;          *(*fphi + count) = currfloat;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        }</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      }</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      fclose(fin);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <a class="code" href="lib__err_8cpp.html#ac6ef54a2905bc58fbb21a5485edd5718">error_file_float_mode</a>(70654, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  }</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="comment">/* assign voxel spacing parameters */</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  *widthx = xlen / (double) mx;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  *widthy = ylen / (double) my;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  *widthz = zlen / (double) mz;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="comment">/* test for orthogonal and cubic lattice */</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  testa = (int)<a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(100 * *alpha + 0.5);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  testb = (int)<a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(100 * *<a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a> + 0.5);</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  testg = (int)<a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(100 * *<a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a> + 0.5);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keywordflow">if</span> (testa != 9000 || testb != 9000 || testg != 9000) *orom = 0;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="keywordflow">if</span> (*orom == 0 || <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>((*widthx - *widthy) * 1000 + 0.5) != 0 || <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>((*widthy - *widthz) * 1000 + 0.5) != 0 || <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>((*widthx - *widthz) * 1000 + 0.5) != 0) *cubic = 0;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="comment">/* set axis permutation mode */</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  *ordermode = 7;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="keywordflow">if</span> (mapc == 1 &amp;&amp; mapr == 2 &amp;&amp; maps == 3) {</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    *ordermode = 1;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  }</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keywordflow">if</span> (mapc == 1 &amp;&amp; mapr == 3 &amp;&amp; maps == 2) {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    *ordermode = 2;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  }</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="keywordflow">if</span> (mapc == 2 &amp;&amp; mapr == 1 &amp;&amp; maps == 3) {</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    *ordermode = 3;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  }</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="keywordflow">if</span> (mapc == 2 &amp;&amp; mapr == 3 &amp;&amp; maps == 1) {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    *ordermode = 4;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  }</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="keywordflow">if</span> (mapc == 3 &amp;&amp; mapr == 1 &amp;&amp; maps == 2) {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    *ordermode = 5;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  }</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="keywordflow">if</span> (mapc == 3 &amp;&amp; mapr == 2 &amp;&amp; maps == 1) {</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    *ordermode = 6;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="keywordflow">if</span> (*ordermode == 7) {</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <a class="code" href="lib__err_8cpp.html#a9a57aa0546dd4cb3054bd6bc765c9333">error_axis_assignment</a>(70680, <span class="stringliteral">&quot;lib_vio&quot;</span>);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  }</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Volumetric data read from file %s\n&quot;</span>, vol_file);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;}</div><div class="ttc" id="cuda__basic__math_8h_html_a2065eb145275f878c1d045c9f3fb1cc7"><div class="ttname"><a href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a></div><div class="ttdeci">__host__ __device__ float2 floor(const float2 v)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__basic__math_8h_source.html#l00175">cuda_basic_math.h:175</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a3caa01c8a1d9e955d617ed7d8fd77405"><div class="ttname"><a href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a></div><div class="ttdeci">int read_float(float *currfloat, FILE *fin, int swap)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00817">lib_vio.cpp:817</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_ad1ce8a1e6c5ee330c1d694393302b1e6"><div class="ttname"><a href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a></div><div class="ttdeci">int read_int(int *currlong, FILE *fin, int swap)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00883">lib_vio.cpp:883</a></div></div>
<div class="ttc" id="namespacealglib_html_a038c39f3bfe0dff667a2cb6bebfed764"><div class="ttname"><a href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">alglib::beta</a></div><div class="ttdeci">double beta(const double a, const double b)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l00962">specialfunctions.cpp:962</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_acf097d43154f3f002dbb9692ce4c55f7"><div class="ttname"><a href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a></div><div class="ttdeci">double * gamma</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07616">numerical_recipes.cpp:7616</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a63e126231ae19d447fe077c65d5f2508"><div class="ttname"><a href="lib__vio_8cpp.html#a63e126231ae19d447fe077c65d5f2508">read_short_float</a></div><div class="ttdeci">int read_short_float(float *currfloat, FILE *fin, int swap)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00836">lib_vio.cpp:836</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_ae76582a4cbab89aa99fcf38effea84e5"><div class="ttname"><a href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a></div><div class="ttdeci">void error_open_filename(int error_number, const char *program, char *argv)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00067">lib_err.cpp:67</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a0978a1b8e1dc8878376a50a88725223d"><div class="ttname"><a href="numerical__recipes_8cpp.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a></div><div class="ttdeci">#define dmin(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02129">numerical_recipes.cpp:2129</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a2be17e8a02c1f24c50001c6195d1e3bf"><div class="ttname"><a href="lib__vio_8cpp.html#a2be17e8a02c1f24c50001c6195d1e3bf">read_char</a></div><div class="ttdeci">int read_char(char *currchar, FILE *fin)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00874">lib_vio.cpp:874</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a74e37497baeb87072fb1730874e59adb"><div class="ttname"><a href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a></div><div class="ttdeci">void mode</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04428">numerical_recipes.cpp:4428</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad03d014386c050f947b2903e44f3b383"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a></div><div class="ttdeci">double dummy</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04652">numerical_recipes.cpp:4652</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_a9a57aa0546dd4cb3054bd6bc765c9333"><div class="ttname"><a href="lib__err_8cpp.html#a9a57aa0546dd4cb3054bd6bc765c9333">error_axis_assignment</a></div><div class="ttdeci">void error_axis_assignment(int error_number, const char *program)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00198">lib_err.cpp:198</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a86acc90388953ea01f3bc85feab1e035"><div class="ttname"><a href="lib__vio_8cpp.html#a86acc90388953ea01f3bc85feab1e035">test_mrc</a></div><div class="ttdeci">int test_mrc(char *vol_file, int swap)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l01010">lib_vio.cpp:1010</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae1dcd09f9c8de5971c9a85494ab952e9"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae1dcd09f9c8de5971c9a85494ab952e9">dmax</a></div><div class="ttdeci">#define dmax(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02130">numerical_recipes.cpp:2130</a></div></div>
<div class="ttc" id="group__Filters_html_ga21987af66fc45fb745dcfde4c095c95a"><div class="ttname"><a href="group__Filters.html#ga21987af66fc45fb745dcfde4c095c95a">rms</a></div><div class="ttdeci">double rms(const MultidimArray&lt; T &gt; &amp;x, const MultidimArray&lt; T &gt; &amp;y, const MultidimArray&lt; int &gt; *mask=NULL, MultidimArray&lt; double &gt; *Contributions=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8h_source.html#l00776">filters.h:776</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_a92055236cfeb5aab7d647a0b6ab19a69"><div class="ttname"><a href="lib__err_8cpp.html#a92055236cfeb5aab7d647a0b6ab19a69">error_file_convert</a></div><div class="ttdeci">void error_file_convert(int error_number, const char *program, const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00183">lib_err.cpp:183</a></div></div>
<div class="ttc" id="lib__vec_8cpp_html_a44e7aedec778e3afa2bfb2579f2f5c76"><div class="ttname"><a href="lib__vec_8cpp.html#a44e7aedec778e3afa2bfb2579f2f5c76">do_vect</a></div><div class="ttdeci">void do_vect(double **pvect, unsigned long len)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vec_8cpp_source.html#l00032">lib_vec.cpp:32</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_adb9f66153b4470a8bd2891a44aa99025"><div class="ttname"><a href="lib__vio_8cpp.html#adb9f66153b4470a8bd2891a44aa99025">read_float_empty</a></div><div class="ttdeci">int read_float_empty(FILE *fin)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00854">lib_vio.cpp:854</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a1054251386c216ffca99c86817e97f41"><div class="ttname"><a href="lib__vio_8cpp.html#a1054251386c216ffca99c86817e97f41">read_char_float</a></div><div class="ttdeci">int read_char_float(float *currfloat, FILE *fin)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00863">lib_vio.cpp:863</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_a5ace2fcbdc86ea9066751e53edd6f943"><div class="ttname"><a href="lib__err_8cpp.html#a5ace2fcbdc86ea9066751e53edd6f943">error_file_header</a></div><div class="ttdeci">void error_file_header(int error_number, const char *program, const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00188">lib_err.cpp:188</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_ac6ef54a2905bc58fbb21a5485edd5718"><div class="ttname"><a href="lib__err_8cpp.html#ac6ef54a2905bc58fbb21a5485edd5718">error_file_float_mode</a></div><div class="ttdeci">void error_file_float_mode(int error_number, const char *program, const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00193">lib_err.cpp:193</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6a6e926ba587aa400cfe242f734645da"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_short_float </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l00836">836</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;{</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *cptr, tmp;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="keywordtype">short</span> currshort;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <span class="keywordflow">if</span> (fread(&amp;currshort, 2, 1, fin) != 1) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="keywordflow">if</span> (swap == 1) {</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    cptr = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)&amp;currshort;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    tmp = cptr[0];</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    cptr[0] = cptr[1];</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    cptr[1] = tmp;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  }</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  *currfloat = (float)currshort;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4a80f1657984a28fe6cb98d3b2f6e006"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_situs </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l00080">80</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;{</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nvox, count;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordtype">double</span> dorigx, dorigy, dorigz, dwidth;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordtype">double</span> phitest, dtemp;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *program = <span class="stringliteral">&quot;lib_vio&quot;</span>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  FILE *fin;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  fin = fopen(vol_file, <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">if</span> (fin == NULL) {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a>(13010, program, vol_file);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="comment">/* read header and print information */</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordflow">if</span> (7 != fscanf(fin, <span class="stringliteral">&quot;%le %le %le %le %d %d %d&quot;</span>, &amp;dwidth, &amp;dorigx, &amp;dorigy, &amp;dorigz, extx, exty, extz)) <a class="code" href="lib__err_8cpp.html#ac6d02ca0be80e0f032a14d068c0df4a4">error_fscanf</a>(program, vol_file);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  *width = dwidth;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  *origx = dorigx;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  *origy = dorigy;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  *origz = dorigz;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Situs formatted map file %s - Header information: \n&quot;</span>, vol_file);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Columns, rows, and sections: x=1-%d, y=1-%d, z=1-%d\n&quot;</span>, *extx, *exty, *extz);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; 3D coordinates of first voxel: (%f,%f,%f)\n&quot;</span>, *origx, *origy, *origz);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Voxel size in Angstrom: %f \n&quot;</span>, *width);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  nvox = *extx * *exty * *extz;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="comment">/* allocate memory and read data */</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Reading density data... \n&quot;</span>);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  *phi = (<span class="keywordtype">double</span> *) <a class="code" href="lib__vec_8cpp.html#a3dba0f046e5df31593bc2200d38cfd61">alloc_vect</a>(nvox, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordflow">for</span> (count = 0; count &lt; nvox; count++) {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">if</span> (fscanf(fin, <span class="stringliteral">&quot;%le&quot;</span>, &amp;dtemp) != 1) {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <a class="code" href="lib__err_8cpp.html#a9c0a91bc7428bdff26fbefa4521dc26d">error_unreadable_file_long</a>(13030, program, vol_file);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    } <span class="keywordflow">else</span> *(*phi + count) = dtemp;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">if</span> (fscanf(fin, <span class="stringliteral">&quot;%le&quot;</span>, &amp;phitest) != EOF) {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="lib__err_8cpp.html#a9c0a91bc7428bdff26fbefa4521dc26d">error_unreadable_file_long</a>(13040, program, vol_file);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  fclose(fin);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Volumetric data read from file %s\n&quot;</span>, vol_file);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;}</div><div class="ttc" id="lib__err_8cpp_html_ae76582a4cbab89aa99fcf38effea84e5"><div class="ttname"><a href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a></div><div class="ttdeci">void error_open_filename(int error_number, const char *program, char *argv)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00067">lib_err.cpp:67</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_ac6d02ca0be80e0f032a14d068c0df4a4"><div class="ttname"><a href="lib__err_8cpp.html#ac6d02ca0be80e0f032a14d068c0df4a4">error_fscanf</a></div><div class="ttdeci">void error_fscanf(const char *program, const char *file)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00046">lib_err.cpp:46</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_a9c0a91bc7428bdff26fbefa4521dc26d"><div class="ttname"><a href="lib__err_8cpp.html#a9c0a91bc7428bdff26fbefa4521dc26d">error_unreadable_file_long</a></div><div class="ttdeci">void error_unreadable_file_long(int error_number, const char *program, const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00148">lib_err.cpp:148</a></div></div>
<div class="ttc" id="lib__vec_8cpp_html_a3dba0f046e5df31593bc2200d38cfd61"><div class="ttname"><a href="lib__vec_8cpp.html#a3dba0f046e5df31593bc2200d38cfd61">alloc_vect</a></div><div class="ttdeci">void * alloc_vect(unsigned int n, size_t elem_size)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vec_8cpp_source.html#l00071">lib_vec.cpp:71</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a36d074c214f7e1d4f7550a98a908ea8e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_spider </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l00644">644</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;{</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nvox;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  FILE *fin;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, swap, header_ok = 1, headlen;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keywordtype">float</span> <a class="code" href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a>, currfloat;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordtype">float</span> nslice, nrow, iform, imami, <a class="code" href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a>, fmin, av, sig, nsam, headrec;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="keywordtype">float</span> iangle, phi, <a class="code" href="numerical__recipes_8cpp.html#aca81c35c21e3a5f7f3a8d24504e76664">theta</a>, <a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a>, xoff, yoff, zoff, scale, labbyt, lenbyt;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordtype">float</span> istack, inuse, maxim, kangle, phi1, theta1, psi1, phi2, theta2, psi2;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keywordtype">int</span> n_range_viol0, n_range_viol1;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  n_range_viol0 = <a class="code" href="lib__vio_8cpp.html#a3b2bd1e045389b672e28c8907dede4c0">test_spider</a>(vol_file, 0);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  n_range_viol1 = <a class="code" href="lib__vio_8cpp.html#a3b2bd1e045389b672e28c8907dede4c0">test_spider</a>(vol_file, 1);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="keywordflow">if</span> (n_range_viol0 &lt; n_range_viol1) { <span class="comment">/* guess endianism */</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    swap = 0;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">if</span> (n_range_viol0 &gt; 0) {</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Warning: %i header field range violations detected \n&quot;</span>, n_range_viol0);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    }</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    swap = 1;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">if</span> (n_range_viol1 &gt; 0) {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Warning: %i header field range violations detected \n&quot;</span>, n_range_viol1);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    }</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  }</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="comment">/* read header */</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  fin = fopen(vol_file, <span class="stringliteral">&quot;rb&quot;</span>);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="keywordflow">if</span> (fin == NULL) {</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <a class="code" href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a>(70820, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  }</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Reading header information from SPIDER file %s \n&quot;</span>, vol_file);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;nslice, fin, swap);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;nrow, fin, swap);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;dummy, fin, swap);</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;dummy, fin, swap);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;iform, fin, swap);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;imami, fin, swap);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;fmax, fin, swap);</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;fmin, fin, swap);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;av, fin, swap);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;sig, fin, swap);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;dummy, fin, swap);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;nsam, fin, swap);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;headrec, fin, swap);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;iangle, fin, swap);</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;phi, fin, swap);</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;theta, fin, swap);</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;gamma, fin, swap);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;xoff, fin, swap);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;yoff, fin, swap);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;zoff, fin, swap);</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;scale, fin, swap);</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;labbyt, fin, swap);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;lenbyt, fin, swap);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;istack, fin, swap);</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;inuse, fin, swap);</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;maxim, fin, swap);</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; 4; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;dummy, fin, swap);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;kangle, fin, swap);</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;phi1, fin, swap);</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;theta1, fin, swap);</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;psi1, fin, swap);</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;phi2, fin, swap);</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;theta2, fin, swap);</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;psi2, fin, swap);</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="keywordflow">if</span> (header_ok == 0) {</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <a class="code" href="lib__err_8cpp.html#a5ace2fcbdc86ea9066751e53edd6f943">error_file_header</a>(70850, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  }</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="comment">/* print some info */</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   NSLICE = %8.f  (# sections)\n&quot;</span>, nslice);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     NROW = %8.f  (# rows)\n&quot;</span>, nrow);</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    IFORM = %8.f  (file type specifier - ignored)\n&quot;</span>, iform);</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    IMAMI = %8.f  (flag: 1 = the maximum and minimum are computed - ignored)\n&quot;</span>, imami);</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     FMAX = %8.3f  (maximum density value - ignored)\n&quot;</span>, fmax);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     FMIN = %8.3f  (minimum density value - ignored)\n&quot;</span>, fmin);</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;       AV = %8.3f  (average density value - ignored)\n&quot;</span>, av);</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;      SIG = %8.3f  (density rms deviation - ignored)\n&quot;</span>, sig);</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     NSAM = %8.f  (# columns)\n&quot;</span>, nsam);</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;  HEADREC = %8.f  (number of records in file header)\n&quot;</span>, headrec);</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   IANGLE = %8.f  (flag: 1 = tilt angles filled - ignored)\n&quot;</span>, iangle);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;      PHI = %8.3f  (tilt angle - ignored)\n&quot;</span>, phi);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    THETA = %8.3f  (tilt angle - ignored)\n&quot;</span>, theta);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    GAMMA = %8.3f  (tilt angle - ignored)\n&quot;</span>, gamma);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     XOFF = %8.3f  (X offset - ignored)\n&quot;</span>, xoff);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     YOFF = %8.3f  (Y offset - ignored)\n&quot;</span>, yoff);</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     ZOFF = %8.3f  (Z offset - ignored)\n&quot;</span>, zoff);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    SCALE = %8.3f  (scale factor - ignored)\n&quot;</span>, scale);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   LABBYT = %8.f  (total number of bytes in header)\n&quot;</span>, labbyt);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   LENBYT = %8.f  (record length in bytes)\n&quot;</span>, lenbyt);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   ISTACK = %8.f  (flag; file contains a stack of images - ignored)\n&quot;</span>, istack);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    INUSE = %8.f  (flag; this image in stack is used - ignored)\n&quot;</span>, inuse);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    MAXIM = %8.f  (maximum image used in stack - ignored)\n&quot;</span>, maxim);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   KANGLE = %8.f  (flag: additional angles set - ignored)\n&quot;</span>, kangle);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     PHI1 = %8.3f  (additional rotation - ignored)\n&quot;</span>, phi1);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   THETA1 = %8.3f  (additional rotation - ignored)\n&quot;</span>, theta1);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     PSI1 = %8.3f  (additional rotation - ignored)\n&quot;</span>, psi1);</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     PHI2 = %8.3f  (additional rotation - ignored)\n&quot;</span>, phi2);</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   THETA2 = %8.3f  (additional rotation - ignored)\n&quot;</span>, theta2);</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     PSI2 = %8.3f  (additional rotation - ignored)\n&quot;</span>, psi2);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  *extx = (<span class="keywordtype">unsigned</span> int)nsam;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  *exty = (<span class="keywordtype">unsigned</span> int)nrow;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  *extz = (<span class="keywordtype">unsigned</span> int)nslice;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  nvox = *extx * *exty * *extz;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  headlen = *extx * (int)ceil(256 / (*extx * 1.0));</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <a class="code" href="lib__vec_8cpp.html#a44e7aedec778e3afa2bfb2579f2f5c76">do_vect</a>(fphi, nvox);</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  rewind(fin);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="keywordflow">for</span> (count = 0; count &lt; (<span class="keywordtype">unsigned</span> long)headlen; ++count) <span class="keywordflow">if</span> (<a class="code" href="lib__vio_8cpp.html#adb9f66153b4470a8bd2891a44aa99025">read_float_empty</a>(fin) == 0) {</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <a class="code" href="lib__err_8cpp.html#a92055236cfeb5aab7d647a0b6ab19a69">error_file_convert</a>(70841, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    }</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="keywordflow">for</span> (count = 0; count &lt; nvox; ++count) <span class="keywordflow">if</span> (<a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;currfloat, fin, swap) == 0) {</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      <a class="code" href="lib__err_8cpp.html#a92055236cfeb5aab7d647a0b6ab19a69">error_file_convert</a>(70842, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      *(*fphi + count) = currfloat;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    }</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  fclose(fin);</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="comment">/* notes and error checks */</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="keywordflow">if</span> (((<span class="keywordtype">int</span>) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(100 * (<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*headlen - labbyt) + 0.5)) != 0) {</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <a class="code" href="lib__err_8cpp.html#ae238ad48af3cae86b0ad814bda58a405">error_spider_header</a>(70860, <span class="stringliteral">&quot;lib_vio&quot;</span>);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  }</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Volumetric data read from file %s\n&quot;</span>, vol_file);</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;}</div><div class="ttc" id="cuda__basic__math_8h_html_a2065eb145275f878c1d045c9f3fb1cc7"><div class="ttname"><a href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a></div><div class="ttdeci">__host__ __device__ float2 floor(const float2 v)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__basic__math_8h_source.html#l00175">cuda_basic_math.h:175</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a3caa01c8a1d9e955d617ed7d8fd77405"><div class="ttname"><a href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a></div><div class="ttdeci">int read_float(float *currfloat, FILE *fin, int swap)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00817">lib_vio.cpp:817</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a3b2bd1e045389b672e28c8907dede4c0"><div class="ttname"><a href="lib__vio_8cpp.html#a3b2bd1e045389b672e28c8907dede4c0">test_spider</a></div><div class="ttdeci">int test_spider(char *vol_file, int swap)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l01089">lib_vio.cpp:1089</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_acf097d43154f3f002dbb9692ce4c55f7"><div class="ttname"><a href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a></div><div class="ttdeci">double * gamma</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07616">numerical_recipes.cpp:7616</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca81c35c21e3a5f7f3a8d24504e76664"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca81c35c21e3a5f7f3a8d24504e76664">theta</a></div><div class="ttdeci">double theta</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l06233">numerical_recipes.cpp:6233</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_ae76582a4cbab89aa99fcf38effea84e5"><div class="ttname"><a href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a></div><div class="ttdeci">void error_open_filename(int error_number, const char *program, char *argv)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00067">lib_err.cpp:67</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad03d014386c050f947b2903e44f3b383"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a></div><div class="ttdeci">double dummy</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04652">numerical_recipes.cpp:4652</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_a92055236cfeb5aab7d647a0b6ab19a69"><div class="ttname"><a href="lib__err_8cpp.html#a92055236cfeb5aab7d647a0b6ab19a69">error_file_convert</a></div><div class="ttdeci">void error_file_convert(int error_number, const char *program, const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00183">lib_err.cpp:183</a></div></div>
<div class="ttc" id="lib__vec_8cpp_html_a44e7aedec778e3afa2bfb2579f2f5c76"><div class="ttname"><a href="lib__vec_8cpp.html#a44e7aedec778e3afa2bfb2579f2f5c76">do_vect</a></div><div class="ttdeci">void do_vect(double **pvect, unsigned long len)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vec_8cpp_source.html#l00032">lib_vec.cpp:32</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_adb9f66153b4470a8bd2891a44aa99025"><div class="ttname"><a href="lib__vio_8cpp.html#adb9f66153b4470a8bd2891a44aa99025">read_float_empty</a></div><div class="ttdeci">int read_float_empty(FILE *fin)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00854">lib_vio.cpp:854</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_ae238ad48af3cae86b0ad814bda58a405"><div class="ttname"><a href="lib__err_8cpp.html#ae238ad48af3cae86b0ad814bda58a405">error_spider_header</a></div><div class="ttdeci">void error_spider_header(int error_number, const char *program)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00207">lib_err.cpp:207</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a046e290d67d4e9e20547aae0fab90070"><div class="ttname"><a href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a></div><div class="ttdeci">double fmax</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05183">numerical_recipes.cpp:5183</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_a5ace2fcbdc86ea9066751e53edd6f943"><div class="ttname"><a href="lib__err_8cpp.html#a5ace2fcbdc86ea9066751e53edd6f943">error_file_header</a></div><div class="ttdeci">void error_file_header(int error_number, const char *program, const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00188">lib_err.cpp:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa6a42a7e0a69b7da72558548e4ed4331"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_vol </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l00025">25</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordtype">int</span> n_range_viol0, n_range_viol1, n_range_viol2;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordtype">int</span> ordermode = 7, cubic = 1, orom = 1;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordtype">unsigned</span> nc, nr, ns;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">unsigned</span> nx, ny, nz;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">int</span> nxstart = 0, nystart = 0, nzstart = 0;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">int</span> ncstart = 0, nrstart = 0, nsstart = 0;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">double</span> widthx, widthy, widthz;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">double</span> xorigin, yorigin, zorigin;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">double</span> alpha, <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>, <a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a>;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">double</span> *phi_raw;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  n_range_viol0 = <a class="code" href="lib__vio_8cpp.html#a86acc90388953ea01f3bc85feab1e035">test_mrc</a>(vol_file, 0);</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  n_range_viol1 = <a class="code" href="lib__vio_8cpp.html#a86acc90388953ea01f3bc85feab1e035">test_mrc</a>(vol_file, 1);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  n_range_viol2 = <a class="code" href="lib__vio_8cpp.html#a5c8660eb8000fa1bfe7add78ea9db827">test_situs</a>(vol_file);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordflow">if</span> (n_range_viol2 &lt; n_range_viol0 &amp;&amp; n_range_viol2 &lt; n_range_viol1) </div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="lib__vio_8cpp.html#a0391ff875d8f494646c4073c9e36a929">read_situs</a>(vol_file, width, origx, origy, origz, extx, exty, extz, phi);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="lib__vio_8cpp.html#afba87d6f80c3adfb06a4cead9131d7a2">read_mrc</a>(vol_file, &amp;orom, &amp;cubic, &amp;ordermode, &amp;nc, &amp;nr, &amp;ns, &amp;ncstart, </div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;             &amp;nrstart, &amp;nsstart, &amp;widthx, &amp;widthy, &amp;widthz, &amp;xorigin, &amp;yorigin, </div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;             &amp;zorigin, &amp;alpha, &amp;beta, &amp;gamma, &amp;phi_raw);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="lib__vio_8cpp.html#a0a9e05171dd8d30dc89d17b3a5e7e837">permute_map</a>(ordermode, nc, nr, ns, &amp;nx, &amp;ny, &amp;nz, ncstart, nrstart, nsstart,</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                &amp;nxstart, &amp;nystart, &amp;nzstart, phi_raw, phi);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="lib__vio_8cpp.html#a033283610c126034a79dfa2c1a545df6">permute_print_info</a>(ordermode, nc, nr, ns, nx, ny, nz, ncstart, nrstart, </div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                       nsstart, nxstart, nystart, nzstart);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="lib__vio_8cpp.html#a84520feff27af72ce56df8602a457722">assert_cubic_map</a>(orom, cubic, alpha, beta, gamma, widthx, widthy, widthz, </div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                     nx, ny, nz, nxstart, nystart, nzstart, xorigin, yorigin, </div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                     zorigin, width, origx, origy, origz, extx, exty, extz, phi);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; \n&quot;</span>);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  }</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;}</div><div class="ttc" id="lib__vio_8cpp_html_a84520feff27af72ce56df8602a457722"><div class="ttname"><a href="lib__vio_8cpp.html#a84520feff27af72ce56df8602a457722">assert_cubic_map</a></div><div class="ttdeci">void assert_cubic_map(int orom, int cubic, double alpha, double beta, double gamma, double widthx, double widthy, double widthz, unsigned nx, unsigned ny, unsigned nz, int nxstart, int nystart, int nzstart, double xorigin, double yorigin, double zorigin, double *pwidth, double *porigx, double *porigy, double *porigz, unsigned *pextx, unsigned *pexty, unsigned *pextz, double **pphi)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l01326">lib_vio.cpp:1326</a></div></div>
<div class="ttc" id="namespacealglib_html_a038c39f3bfe0dff667a2cb6bebfed764"><div class="ttname"><a href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">alglib::beta</a></div><div class="ttdeci">double beta(const double a, const double b)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l00962">specialfunctions.cpp:962</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a0a9e05171dd8d30dc89d17b3a5e7e837"><div class="ttname"><a href="lib__vio_8cpp.html#a0a9e05171dd8d30dc89d17b3a5e7e837">permute_map</a></div><div class="ttdeci">void permute_map(int ordermode, unsigned nc, unsigned nr, unsigned ns, unsigned *nx, unsigned *ny, unsigned *nz, int ncstart, int nrstart, int nsstart, int *nxstart, int *nystart, int *nzstart, double *phi, double **pphi)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l01198">lib_vio.cpp:1198</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_acf097d43154f3f002dbb9692ce4c55f7"><div class="ttname"><a href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a></div><div class="ttdeci">double * gamma</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07616">numerical_recipes.cpp:7616</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a86acc90388953ea01f3bc85feab1e035"><div class="ttname"><a href="lib__vio_8cpp.html#a86acc90388953ea01f3bc85feab1e035">test_mrc</a></div><div class="ttdeci">int test_mrc(char *vol_file, int swap)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l01010">lib_vio.cpp:1010</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a0391ff875d8f494646c4073c9e36a929"><div class="ttname"><a href="lib__vio_8cpp.html#a0391ff875d8f494646c4073c9e36a929">read_situs</a></div><div class="ttdeci">void read_situs(char *vol_file, double *width, double *origx, double *origy, double *origz, unsigned *extx, unsigned *exty, unsigned *extz, double **phi)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00080">lib_vio.cpp:80</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_afba87d6f80c3adfb06a4cead9131d7a2"><div class="ttname"><a href="lib__vio_8cpp.html#afba87d6f80c3adfb06a4cead9131d7a2">read_mrc</a></div><div class="ttdeci">void read_mrc(char *vol_file, int *orom, int *cubic, int *ordermode, unsigned *nc, unsigned *nr, unsigned *ns, int *ncstart, int *nrstart, int *nsstart, double *widthx, double *widthy, double *widthz, double *xorigin, double *yorigin, double *zorigin, double *alpha, double *beta, double *gamma, double **fphi)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00369">lib_vio.cpp:369</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a033283610c126034a79dfa2c1a545df6"><div class="ttname"><a href="lib__vio_8cpp.html#a033283610c126034a79dfa2c1a545df6">permute_print_info</a></div><div class="ttdeci">void permute_print_info(int ordermode, unsigned nc, unsigned nr, unsigned ns, unsigned nx, unsigned ny, unsigned nz, int ncstart, int nrstart, int nsstart, int nxstart, int nystart, int nzstart)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l01282">lib_vio.cpp:1282</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a5c8660eb8000fa1bfe7add78ea9db827"><div class="ttname"><a href="lib__vio_8cpp.html#a5c8660eb8000fa1bfe7add78ea9db827">test_situs</a></div><div class="ttdeci">int test_situs(char *vol_file)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00937">lib_vio.cpp:937</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1079b4554d46f1a586daf8fa754d8b5b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_xplor </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l00191">191</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;{</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nvox;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  FILE *fin;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keywordtype">int</span> idummy, <a class="code" href="numerical__recipes_8cpp.html#ad604cff3eb5d475cdc9f8eb5ab570fee">done</a>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordtype">char</span> *nextline;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordtype">float</span> a_tmp, b_tmp, g_tmp, currfloat;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordtype">long</span> mx, my, mz, mxend, myend, mzend;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordtype">long</span> mxstart, mystart, mzstart;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordtype">int</span> testa, testb, testg;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordtype">float</span> xlen, ylen, zlen;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordtype">int</span> indx, indy, indz;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  nextline = (<span class="keywordtype">char</span> *) <a class="code" href="lib__vec_8cpp.html#a3dba0f046e5df31593bc2200d38cfd61">alloc_vect</a>(<a class="code" href="lib__vio_8cpp.html#a533bff314f05d9446d545c66fb899c8b">FLENGTH</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  fin = fopen(vol_file, <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordflow">if</span> (fin == NULL) {</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a>(70420, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  }</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="comment">/* ignore header length line */</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <a class="code" href="lib__vio_8cpp.html#a0bcf52f51ef286fcb7d84ce20e5c8fed">xplor_skip_to_number</a>(&amp;fin, &amp;nextline);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">/* read index line */</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <a class="code" href="lib__vio_8cpp.html#a0bcf52f51ef286fcb7d84ce20e5c8fed">xplor_skip_to_number</a>(&amp;fin, &amp;nextline);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordflow">if</span> (sscanf(nextline, <span class="stringliteral">&quot;%8ld%8ld%8ld%8ld%8ld%8ld%8ld%8ld%8ld&quot;</span>, &amp;mx, &amp;mxstart, &amp;mxend, &amp;my, &amp;mystart, &amp;myend, &amp;mz, &amp;mzstart, &amp;mzend) != 9) {</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="lib__err_8cpp.html#a7995851596a4b9a6466483f7e1a075e1">error_xplor_file_indexing</a>(70430, <span class="stringliteral">&quot;lib_vio&quot;</span>);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  *extx = mxend - mxstart + 1;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  *exty = myend - mystart + 1;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  *extz = mzend - mzstart + 1;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  nvox = *extx * *exty * *extz;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; X-PLOR map indexing (counting from 0): \n&quot;</span>);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;       NA = %8ld  (# of X intervals in unit cell) \n&quot;</span>, mx);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     AMIN = %8ld  (start index X) \n&quot;</span>, mxstart);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     AMAX = %8ld  (end index X) \n&quot;</span>, mxend);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;       NB = %8ld  (# of Y intervals in unit cell) \n&quot;</span>, my);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     BMIN = %8ld  (start index Y) \n&quot;</span>, mystart);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     BMAX = %8ld  (end index Y) \n&quot;</span>, myend);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;       NC = %8ld  (# of Z intervals in unit cell) \n&quot;</span>, mz);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     CMIN = %8ld  (start index Z) \n&quot;</span>, mzstart);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     CMAX = %8ld  (end index Z) \n&quot;</span>, mzend);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">/* read unit cell info and determine grid width and origin */</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <a class="code" href="lib__vio_8cpp.html#a0bcf52f51ef286fcb7d84ce20e5c8fed">xplor_skip_to_number</a>(&amp;fin, &amp;nextline);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">if</span> (sscanf(nextline, <span class="stringliteral">&quot;%12f%12f%12f%12f%12f%12f&quot;</span>, &amp;xlen, &amp;ylen, &amp;zlen, &amp;a_tmp, &amp;b_tmp, &amp;g_tmp) != 6) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="lib__err_8cpp.html#a85100834404404da117423718d71b3e2">error_xplor_file_unit_cell</a>(70440, <span class="stringliteral">&quot;lib_vio&quot;</span>);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    *alpha = a_tmp;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    *<a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a> = b_tmp;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    *<a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a> = g_tmp;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  }</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; X-PLOR unit cell info: \n&quot;</span>);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;        A = %8.3f  (unit cell dimension) \n&quot;</span>, xlen);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;        B = %8.3f  (unit cell dimension) \n&quot;</span>, ylen);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;        C = %8.3f  (unit cell dimension) \n&quot;</span>, zlen);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    ALPHA = %8.3f  (unit cell angle) \n&quot;</span>, *alpha);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     BETA = %8.3f  (unit cell angle) \n&quot;</span>, *<a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    GAMMA = %8.3f  (unit cell angle) \n&quot;</span>, *<a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a>);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="comment">/* assign voxel spacing parameters */</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  *widthx = xlen / (double) mx;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  *widthy = ylen / (double) my;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  *widthz = zlen / (double) mz;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  *nxstart = mxstart;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  *nystart = mystart;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  *nzstart = mzstart;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="comment">/* test for orthogonal and cubic lattice */</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  testa = (int)<a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(100 * *alpha + 0.5);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  testb = (int)<a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(100 * *<a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a> + 0.5);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  testg = (int)<a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(100 * *<a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a> + 0.5);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordflow">if</span> (testa != 9000 || testb != 9000 || testg != 9000) *orom = 0;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordflow">if</span> (*orom == 0 || <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>((*widthx - *widthy) * 1000 + 0.5) != 0 || </div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>((*widthy - *widthz) * 1000 + 0.5) != 0 || </div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>((*widthx - *widthz) * 1000 + 0.5) != 0) </div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    *cubic = 0;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">/* read ZYX info */</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordflow">for</span> (done = 0; done == 0;) { <span class="comment">/* read next line and check if it contains ZYX */</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">if</span> (fgets(nextline, <a class="code" href="lib__vio_8cpp.html#a533bff314f05d9446d545c66fb899c8b">FLENGTH</a>, fin) == NULL) {</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <a class="code" href="lib__err_8cpp.html#a0746ee51a615d0031df0efdb4f47431f">error_EOF_ZYX_mode</a>(70450, <span class="stringliteral">&quot;lib_vio&quot;</span>);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    }</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordflow">if</span> (*nextline == <span class="charliteral">&#39;Z&#39;</span> &amp;&amp; *(nextline + 1) == <span class="charliteral">&#39;Y&#39;</span> &amp;&amp; *(nextline + 2) == <span class="charliteral">&#39;X&#39;</span>) {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      done = 1;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">if</span> (*nextline == <span class="charliteral">&#39;z&#39;</span> &amp;&amp; *(nextline + 1) == <span class="charliteral">&#39;y&#39;</span> &amp;&amp; *(nextline + 2) == <span class="charliteral">&#39;x&#39;</span>) {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      done = 1;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="comment">/* read sections */</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <a class="code" href="lib__vec_8cpp.html#a44e7aedec778e3afa2bfb2579f2f5c76">do_vect</a>(fphi, nvox);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordflow">for</span> (indz = 0; indz &lt; (int)*extz; indz++) {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">/* skip section header and read section number */</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="lib__vio_8cpp.html#a0bcf52f51ef286fcb7d84ce20e5c8fed">xplor_skip_to_number</a>(&amp;fin, &amp;nextline);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">if</span> (sscanf(nextline, <span class="stringliteral">&quot;%8d&quot;</span>, &amp;idummy) != 1) {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <a class="code" href="lib__err_8cpp.html#a8964593efb39473f6e9eaae7ef7a8d75">error_xplor_file_map_section</a>(70470, <span class="stringliteral">&quot;lib_vio&quot;</span>);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">if</span> (idummy != indz) {</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <a class="code" href="lib__err_8cpp.html#acefda890abc43be51a3466b0b65e92a2">error_xplor_file_map_section_number</a>(70480, <span class="stringliteral">&quot;lib_vio&quot;</span>);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">/* read section data */</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">for</span> (indy = 0; indy &lt; (int)*exty; indy++) <span class="keywordflow">for</span> (indx = 0; indx &lt; (int)*extx; indx++) {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordflow">if</span> (fscanf(fin, <span class="stringliteral">&quot;%12f&quot;</span>, &amp;currfloat) != 1) {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;          <a class="code" href="lib__err_8cpp.html#aa73a803f0e59a0f38121ff368c0fa55c">error_unreadable_file_short</a>(70490, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;          *(*fphi + <a class="code" href="lib__vwk_8cpp.html#a8101287e9fd64ebd4bb0b666f0e16019">gidz_general</a>(indz, indy, indx, *exty, *extx)) = currfloat;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      }</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="comment">/* read end of data marker */</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <a class="code" href="lib__vio_8cpp.html#a0bcf52f51ef286fcb7d84ce20e5c8fed">xplor_skip_to_number</a>(&amp;fin, &amp;nextline);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordflow">if</span> (sscanf(nextline, <span class="stringliteral">&quot;%8d&quot;</span>, &amp;idummy) != 1 || idummy != -9999) {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="lib__err_8cpp.html#a7a0810708101cd310bdb115c36a86701">error_xplor_maker</a>(<span class="stringliteral">&quot;lib_vio&quot;</span>);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  }</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  fclose(fin);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <a class="code" href="lib__vec_8cpp.html#aae41642ab5fb260fdb9eac7b173a552e">free_vect_and_zero_ptr</a>((<span class="keywordtype">void</span>**)&amp;nextline);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Volumetric data read from file %s\n&quot;</span>, vol_file);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;}</div><div class="ttc" id="lib__vio_8cpp_html_a0bcf52f51ef286fcb7d84ce20e5c8fed"><div class="ttname"><a href="lib__vio_8cpp.html#a0bcf52f51ef286fcb7d84ce20e5c8fed">xplor_skip_to_number</a></div><div class="ttdeci">void xplor_skip_to_number(FILE **fin, char **nextline)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00327">lib_vio.cpp:327</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_a8964593efb39473f6e9eaae7ef7a8d75"><div class="ttname"><a href="lib__err_8cpp.html#a8964593efb39473f6e9eaae7ef7a8d75">error_xplor_file_map_section</a></div><div class="ttdeci">void error_xplor_file_map_section(int error_number, const char *program)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00163">lib_err.cpp:163</a></div></div>
<div class="ttc" id="cuda__basic__math_8h_html_a2065eb145275f878c1d045c9f3fb1cc7"><div class="ttname"><a href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a></div><div class="ttdeci">__host__ __device__ float2 floor(const float2 v)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__basic__math_8h_source.html#l00175">cuda_basic_math.h:175</a></div></div>
<div class="ttc" id="lib__vec_8cpp_html_aae41642ab5fb260fdb9eac7b173a552e"><div class="ttname"><a href="lib__vec_8cpp.html#aae41642ab5fb260fdb9eac7b173a552e">free_vect_and_zero_ptr</a></div><div class="ttdeci">void free_vect_and_zero_ptr(void **pvect)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vec_8cpp_source.html#l00083">lib_vec.cpp:83</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_a7995851596a4b9a6466483f7e1a075e1"><div class="ttname"><a href="lib__err_8cpp.html#a7995851596a4b9a6466483f7e1a075e1">error_xplor_file_indexing</a></div><div class="ttdeci">void error_xplor_file_indexing(int error_number, const char *program)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00153">lib_err.cpp:153</a></div></div>
<div class="ttc" id="namespacealglib_html_a038c39f3bfe0dff667a2cb6bebfed764"><div class="ttname"><a href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">alglib::beta</a></div><div class="ttdeci">double beta(const double a, const double b)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l00962">specialfunctions.cpp:962</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_acefda890abc43be51a3466b0b65e92a2"><div class="ttname"><a href="lib__err_8cpp.html#acefda890abc43be51a3466b0b65e92a2">error_xplor_file_map_section_number</a></div><div class="ttdeci">void error_xplor_file_map_section_number(int error_number, const char *program)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00168">lib_err.cpp:168</a></div></div>
<div class="ttc" id="lib__vwk_8cpp_html_a8101287e9fd64ebd4bb0b666f0e16019"><div class="ttname"><a href="lib__vwk_8cpp.html#a8101287e9fd64ebd4bb0b666f0e16019">gidz_general</a></div><div class="ttdeci">unsigned long gidz_general(int k, int j, int i, unsigned ey, unsigned ex)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vwk_8cpp_source.html#l00032">lib_vwk.cpp:32</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_acf097d43154f3f002dbb9692ce4c55f7"><div class="ttname"><a href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a></div><div class="ttdeci">double * gamma</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07616">numerical_recipes.cpp:7616</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad604cff3eb5d475cdc9f8eb5ab570fee"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad604cff3eb5d475cdc9f8eb5ab570fee">done</a></div><div class="ttdeci">done</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07655">numerical_recipes.cpp:7655</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_ae76582a4cbab89aa99fcf38effea84e5"><div class="ttname"><a href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a></div><div class="ttdeci">void error_open_filename(int error_number, const char *program, char *argv)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00067">lib_err.cpp:67</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a533bff314f05d9446d545c66fb899c8b"><div class="ttname"><a href="lib__vio_8cpp.html#a533bff314f05d9446d545c66fb899c8b">FLENGTH</a></div><div class="ttdeci">#define FLENGTH</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00022">lib_vio.cpp:22</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_a0746ee51a615d0031df0efdb4f47431f"><div class="ttname"><a href="lib__err_8cpp.html#a0746ee51a615d0031df0efdb4f47431f">error_EOF_ZYX_mode</a></div><div class="ttdeci">void error_EOF_ZYX_mode(int error_number, const char *program)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00173">lib_err.cpp:173</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_aa73a803f0e59a0f38121ff368c0fa55c"><div class="ttname"><a href="lib__err_8cpp.html#aa73a803f0e59a0f38121ff368c0fa55c">error_unreadable_file_short</a></div><div class="ttdeci">void error_unreadable_file_short(int error_number, const char *program, const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00143">lib_err.cpp:143</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_a7a0810708101cd310bdb115c36a86701"><div class="ttname"><a href="lib__err_8cpp.html#a7a0810708101cd310bdb115c36a86701">error_xplor_maker</a></div><div class="ttdeci">void error_xplor_maker(const char *program)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00179">lib_err.cpp:179</a></div></div>
<div class="ttc" id="lib__vec_8cpp_html_a44e7aedec778e3afa2bfb2579f2f5c76"><div class="ttname"><a href="lib__vec_8cpp.html#a44e7aedec778e3afa2bfb2579f2f5c76">do_vect</a></div><div class="ttdeci">void do_vect(double **pvect, unsigned long len)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vec_8cpp_source.html#l00032">lib_vec.cpp:32</a></div></div>
<div class="ttc" id="lib__vec_8cpp_html_a3dba0f046e5df31593bc2200d38cfd61"><div class="ttname"><a href="lib__vec_8cpp.html#a3dba0f046e5df31593bc2200d38cfd61">alloc_vect</a></div><div class="ttdeci">void * alloc_vect(unsigned int n, size_t elem_size)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vec_8cpp_source.html#l00071">lib_vec.cpp:71</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_a85100834404404da117423718d71b3e2"><div class="ttname"><a href="lib__err_8cpp.html#a85100834404404da117423718d71b3e2">error_xplor_file_unit_cell</a></div><div class="ttdeci">void error_xplor_file_unit_cell(int error_number, const char *program)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00158">lib_err.cpp:158</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a65f22554066cada7f2ff20d21414d912"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int set_origin_get_mode </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l01307">1307</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;{</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <span class="keywordflow">if</span> (fabs(xorigin) &lt; 0.0001 &amp;&amp; fabs(yorigin) &lt; 0.0001 &amp;&amp; fabs(zorigin) &lt; 0.0001) { <span class="comment">/* seem to have crystallographic origin */</span></div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Using crystallographic (CCP4) style origin defined by unit cell start indices.\n&quot;</span>);</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    *origx = nxstart * widthx;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    *origy = nystart * widthy;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    *origz = nzstart * widthz;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  } <span class="keywordflow">else</span> { <span class="comment">/* seem to have MRC2000 */</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Using MRC2000 style origin defined by [X,Y,Z]ORIGIN fields.\n&quot;</span>);</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    *origx = xorigin;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    *origy = yorigin;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    *origz = zorigin;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  }</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a07826e1d79820e093c758043e689a842"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int test_mrc </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l01010">1010</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;{</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  FILE *fin;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  <span class="keywordtype">int</span> nc, nr, ns, mx, my, mz;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a>, ncstart, nrstart, nsstart;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <span class="keywordtype">float</span> xlen, ylen, zlen;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, header_ok = 1, n_range_viols = 0;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="keywordtype">int</span> mapc, mapr, maps;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="keywordtype">float</span> alpha, <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>, <a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a>;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="keywordtype">float</span> <a class="code" href="numerical__recipes_8cpp.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a>, <a class="code" href="numerical__recipes_8cpp.html#ae1dcd09f9c8de5971c9a85494ab952e9">dmax</a>, dmean, <a class="code" href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a>, xorigin, yorigin, zorigin;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  fin = fopen(vol_file, <span class="stringliteral">&quot;rb&quot;</span>);</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="keywordflow">if</span> (fin == NULL) {</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <a class="code" href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a>(71010, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  }</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="comment">/* read header info */</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;nc, fin, swap);</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;nr, fin, swap);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;ns, fin, swap);</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;mode, fin, swap);</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;ncstart, fin, swap);</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;nrstart, fin, swap);</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;nsstart, fin, swap);</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;mx, fin, swap);</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;my, fin, swap);</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;mz, fin, swap);</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;xlen, fin, swap);</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;ylen, fin, swap);</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;zlen, fin, swap);</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;alpha, fin, swap);</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;beta, fin, swap);</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;gamma, fin, swap);</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;mapc, fin, swap);</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;mapr, fin, swap);</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a>(&amp;maps, fin, swap);</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;dmin, fin, swap);</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;dmax, fin, swap);</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;dmean, fin, swap);</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="keywordflow">for</span> (i = 23; i &lt; 50; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;dummy, fin, swap);</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;xorigin, fin, swap);</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;yorigin, fin, swap);</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;zorigin, fin, swap);</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  fclose(fin);</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <span class="keywordflow">if</span> (header_ok == 0) {</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <a class="code" href="lib__err_8cpp.html#a5ace2fcbdc86ea9066751e53edd6f943">error_file_header</a>(71020, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  }</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  n_range_viols += (nc &gt; 5000);</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  n_range_viols += (nc &lt; 0);</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  n_range_viols += (nr &gt; 5000);</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  n_range_viols += (nr &lt; 0);</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  n_range_viols += (ns &gt; 5000);</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  n_range_viols += (ns &lt; 0);</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  n_range_viols += (ncstart &gt; 5000);</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  n_range_viols += (ncstart &lt; -5000);</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  n_range_viols += (nrstart &gt; 5000);</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  n_range_viols += (nrstart &lt; -5000);</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  n_range_viols += (nsstart &gt; 5000);</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  n_range_viols += (nsstart &lt; -5000);</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  n_range_viols += (mx &gt; 5000);</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  n_range_viols += (mx &lt; 0);</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  n_range_viols += (my &gt; 5000);</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  n_range_viols += (my &lt; 0);</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  n_range_viols += (mz &gt; 5000);</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  n_range_viols += (mz &lt; 0);</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  n_range_viols += (alpha &gt; 360.0f);</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  n_range_viols += (alpha &lt; -360.0f);</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  n_range_viols += (beta &gt; 360.0f);</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  n_range_viols += (beta &lt; -360.0f);</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  n_range_viols += (gamma &gt; 360.0f);</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  n_range_viols += (gamma &lt; -360.0f);</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  <span class="keywordflow">return</span> n_range_viols;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;}</div><div class="ttc" id="lib__vio_8cpp_html_a3caa01c8a1d9e955d617ed7d8fd77405"><div class="ttname"><a href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a></div><div class="ttdeci">int read_float(float *currfloat, FILE *fin, int swap)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00817">lib_vio.cpp:817</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_ad1ce8a1e6c5ee330c1d694393302b1e6"><div class="ttname"><a href="lib__vio_8cpp.html#ad1ce8a1e6c5ee330c1d694393302b1e6">read_int</a></div><div class="ttdeci">int read_int(int *currlong, FILE *fin, int swap)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00883">lib_vio.cpp:883</a></div></div>
<div class="ttc" id="namespacealglib_html_a038c39f3bfe0dff667a2cb6bebfed764"><div class="ttname"><a href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">alglib::beta</a></div><div class="ttdeci">double beta(const double a, const double b)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l00962">specialfunctions.cpp:962</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_acf097d43154f3f002dbb9692ce4c55f7"><div class="ttname"><a href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a></div><div class="ttdeci">double * gamma</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07616">numerical_recipes.cpp:7616</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_ae76582a4cbab89aa99fcf38effea84e5"><div class="ttname"><a href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a></div><div class="ttdeci">void error_open_filename(int error_number, const char *program, char *argv)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00067">lib_err.cpp:67</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a0978a1b8e1dc8878376a50a88725223d"><div class="ttname"><a href="numerical__recipes_8cpp.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a></div><div class="ttdeci">#define dmin(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02129">numerical_recipes.cpp:2129</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a74e37497baeb87072fb1730874e59adb"><div class="ttname"><a href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a></div><div class="ttdeci">void mode</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04428">numerical_recipes.cpp:4428</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad03d014386c050f947b2903e44f3b383"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a></div><div class="ttdeci">double dummy</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04652">numerical_recipes.cpp:4652</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae1dcd09f9c8de5971c9a85494ab952e9"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae1dcd09f9c8de5971c9a85494ab952e9">dmax</a></div><div class="ttdeci">#define dmax(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02130">numerical_recipes.cpp:2130</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_a5ace2fcbdc86ea9066751e53edd6f943"><div class="ttname"><a href="lib__err_8cpp.html#a5ace2fcbdc86ea9066751e53edd6f943">error_file_header</a></div><div class="ttdeci">void error_file_header(int error_number, const char *program, const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00188">lib_err.cpp:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a96fb52deeb7a0ec9aae07b73d5c6b596"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int test_registration </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l00917">917</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;{</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <span class="keywordtype">float</span> xreg, xreg1, yreg, yreg1, zreg, zreg1;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  xreg = fabs(fmod(origx + 0.00001 * width, width));</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  xreg1 = fabs(fmod(origx - 0.00001 * width, width));</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  yreg = fabs(fmod(origy + 0.00001 * width, width));</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  yreg1 = fabs(fmod(origy - 0.00001 * width, width));</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  zreg = fabs(fmod(origz + 0.00001 * width, width));</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  zreg1 = fabs(fmod(origz - 0.00001 * width, width));</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="keywordflow">if</span> (xreg1 &lt; xreg) xreg = xreg1;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="keywordflow">if</span> (yreg1 &lt; yreg) yreg = yreg1;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="keywordflow">if</span> (zreg1 &lt; zreg) zreg = zreg1;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="keywordflow">if</span> (xreg + yreg + zreg &gt; 0.0001 * width) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a703cc859679dea0d81d8f196b4106fc8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int test_situs </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l00937">937</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;{</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  FILE *fin;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="keywordtype">double</span> width, origx, origy, origz;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="keywordtype">unsigned</span> extx, exty, extz;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <span class="keywordtype">int</span> header_ok = 1, n_range_viols = 0;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  fin = fopen(vol_file, <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="keywordflow">if</span> (fin == NULL) {</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <a class="code" href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a>(71010, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  }</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="comment">/* read header */</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="keywordflow">if</span> (fscanf(fin, <span class="stringliteral">&quot;%le&quot;</span>, &amp;width) != 1) header_ok *= 0;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <span class="keywordflow">if</span> (fscanf(fin, <span class="stringliteral">&quot;%le&quot;</span>, &amp;origx) != 1) header_ok *= 0;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <span class="keywordflow">if</span> (fscanf(fin, <span class="stringliteral">&quot;%le&quot;</span>, &amp;origy) != 1) header_ok *= 0;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <span class="keywordflow">if</span> (fscanf(fin, <span class="stringliteral">&quot;%le&quot;</span>, &amp;origz) != 1) header_ok *= 0;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <span class="keywordflow">if</span> (fscanf(fin, <span class="stringliteral">&quot;%d&quot;</span>, &amp;extx) != 1) header_ok *= 0;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <span class="keywordflow">if</span> (fscanf(fin, <span class="stringliteral">&quot;%d&quot;</span>, &amp;exty) != 1) header_ok *= 0;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <span class="keywordflow">if</span> (fscanf(fin, <span class="stringliteral">&quot;%d&quot;</span>, &amp;extz) != 1) header_ok *= 0;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  fclose(fin);</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <span class="keywordflow">if</span> (header_ok == 0) <span class="keywordflow">return</span> 999999; <span class="comment">/* worst case, can&#39;t read data */</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    n_range_viols += (extx &gt; 5000);</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    n_range_viols += (extx &lt; 0);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    n_range_viols += (exty &gt; 5000);</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    n_range_viols += (exty &lt; 0);</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    n_range_viols += (extz &gt; 5000);</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    n_range_viols += (extz &lt; 0);</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    n_range_viols += (width &gt; 2000);</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    n_range_viols += (width &lt; 0);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    n_range_viols += (origx &gt; 1e6);</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    n_range_viols += (origx &lt; -1e6);</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    n_range_viols += (origy &gt; 1e6);</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    n_range_viols += (origy &lt; -1e6);</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    n_range_viols += (origz &gt; 1e6);</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    n_range_viols += (origz &lt; -1e6);</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="keywordflow">return</span> 2 * n_range_viols;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  }</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;}</div><div class="ttc" id="lib__err_8cpp_html_ae76582a4cbab89aa99fcf38effea84e5"><div class="ttname"><a href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a></div><div class="ttdeci">void error_open_filename(int error_number, const char *program, char *argv)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00067">lib_err.cpp:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a02617a2398aa37bd1097a45e30a403ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int test_situs_header_and_suffix </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l01001">1001</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;{</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="lib__vio_8cpp.html#ac4f0a80c9d2a0e00b49cd04e910f1b2c">have_situs_suffix</a>(vol_file) == 0) <span class="keywordflow">return</span> 999999;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="lib__vio_8cpp.html#a5c8660eb8000fa1bfe7add78ea9db827">test_situs</a>(vol_file);</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;}</div><div class="ttc" id="lib__vio_8cpp_html_ac4f0a80c9d2a0e00b49cd04e910f1b2c"><div class="ttname"><a href="lib__vio_8cpp.html#ac4f0a80c9d2a0e00b49cd04e910f1b2c">have_situs_suffix</a></div><div class="ttdeci">int have_situs_suffix(char *vol_file)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00981">lib_vio.cpp:981</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a5c8660eb8000fa1bfe7add78ea9db827"><div class="ttname"><a href="lib__vio_8cpp.html#a5c8660eb8000fa1bfe7add78ea9db827">test_situs</a></div><div class="ttdeci">int test_situs(char *vol_file)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00937">lib_vio.cpp:937</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8bd024a616ab43b061e852856b44b549"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int test_spider </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l01089">1089</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;{</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  FILE *fin;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, header_ok = 1, n_range_viols = 0, headlen;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="keywordtype">float</span> <a class="code" href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a>;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <span class="keywordtype">float</span> nslice, nrow, iform, imami, <a class="code" href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a>, fmin, av, sig, nsam, headrec;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="keywordtype">float</span> iangle, phi, <a class="code" href="numerical__recipes_8cpp.html#aca81c35c21e3a5f7f3a8d24504e76664">theta</a>, <a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a>, xoff, yoff, zoff, scale, labbyt, lenbyt;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <span class="keywordtype">float</span> istack, inuse, maxim, kangle, phi1, theta1, psi1, phi2, theta2, psi2;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  fin = fopen(vol_file, <span class="stringliteral">&quot;rb&quot;</span>);</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  <span class="keywordflow">if</span> (fin == NULL) {</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <a class="code" href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a>(71210, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  }</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="comment">/* read header info */</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;nslice, fin, swap);</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;nrow, fin, swap);</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;dummy, fin, swap);</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;dummy, fin, swap);</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;iform, fin, swap);</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;imami, fin, swap);</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;fmax, fin, swap);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;fmin, fin, swap);</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;av, fin, swap);</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;sig, fin, swap);</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;dummy, fin, swap);</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;nsam, fin, swap);</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;headrec, fin, swap);</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;iangle, fin, swap);</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;phi, fin, swap);</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;theta, fin, swap);</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;gamma, fin, swap);</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;xoff, fin, swap);</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;yoff, fin, swap);</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;zoff, fin, swap);</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;scale, fin, swap);</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;labbyt, fin, swap);</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;lenbyt, fin, swap);</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;istack, fin, swap);</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;inuse, fin, swap);</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;maxim, fin, swap);</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; 4; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;dummy, fin, swap);</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;kangle, fin, swap);</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;phi1, fin, swap);</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;theta1, fin, swap);</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;psi1, fin, swap);</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;phi2, fin, swap);</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;theta2, fin, swap);</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  header_ok *= <a class="code" href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a>(&amp;psi2, fin, swap);</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  fclose(fin);</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <span class="keywordflow">if</span> (header_ok == 0) {</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <a class="code" href="lib__err_8cpp.html#a5ace2fcbdc86ea9066751e53edd6f943">error_file_header</a>(71220, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  }</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  headlen = (int)(nsam * ceil(256 / (nsam * 1.0)));</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  n_range_viols += (((int) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(100 * (4 * headlen - labbyt) + 0.5)) != 0);</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  n_range_viols += (headrec &gt; 1e10);</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  n_range_viols += (headrec &lt;= 1e-10);</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  n_range_viols += (labbyt &gt; 1e10);</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  n_range_viols += (labbyt &lt;= 1e-10);</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  n_range_viols += (lenbyt &gt; 1e10);</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  n_range_viols += (lenbyt &lt;= 1e-10);</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  n_range_viols += (nslice &gt; 1e10);</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  n_range_viols += (nslice &lt; 1e-10);</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  n_range_viols += (nrow &gt; 1e10);</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  n_range_viols += (nrow &lt; 1e-10);</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  n_range_viols += (nsam &gt; 1e10);</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  n_range_viols += (nsam &lt; 1e-10);</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  <span class="keywordflow">return</span> 2 * n_range_viols;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;}</div><div class="ttc" id="cuda__basic__math_8h_html_a2065eb145275f878c1d045c9f3fb1cc7"><div class="ttname"><a href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a></div><div class="ttdeci">__host__ __device__ float2 floor(const float2 v)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__basic__math_8h_source.html#l00175">cuda_basic_math.h:175</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a3caa01c8a1d9e955d617ed7d8fd77405"><div class="ttname"><a href="lib__vio_8cpp.html#a3caa01c8a1d9e955d617ed7d8fd77405">read_float</a></div><div class="ttdeci">int read_float(float *currfloat, FILE *fin, int swap)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00817">lib_vio.cpp:817</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_acf097d43154f3f002dbb9692ce4c55f7"><div class="ttname"><a href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a></div><div class="ttdeci">double * gamma</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07616">numerical_recipes.cpp:7616</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca81c35c21e3a5f7f3a8d24504e76664"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca81c35c21e3a5f7f3a8d24504e76664">theta</a></div><div class="ttdeci">double theta</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l06233">numerical_recipes.cpp:6233</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_ae76582a4cbab89aa99fcf38effea84e5"><div class="ttname"><a href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a></div><div class="ttdeci">void error_open_filename(int error_number, const char *program, char *argv)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00067">lib_err.cpp:67</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad03d014386c050f947b2903e44f3b383"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a></div><div class="ttdeci">double dummy</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04652">numerical_recipes.cpp:4652</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a046e290d67d4e9e20547aae0fab90070"><div class="ttname"><a href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a></div><div class="ttdeci">double fmax</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05183">numerical_recipes.cpp:5183</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_a5ace2fcbdc86ea9066751e53edd6f943"><div class="ttname"><a href="lib__err_8cpp.html#a5ace2fcbdc86ea9066751e53edd6f943">error_file_header</a></div><div class="ttdeci">void error_file_header(int error_number, const char *program, const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00188">lib_err.cpp:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa3d0d90b373709280a67174a4da57e38"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_mrc </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l01646">1646</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;{</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;  FILE *fout;</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;  <span class="keywordtype">long</span> nxstart, nystart, nzstart;</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  <span class="keywordtype">float</span> xorigin, yorigin, zorigin;</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count, pnvox;</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;  <span class="keywordtype">long</span> nx, ny, nz, mx, my, mz;</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  <span class="keywordtype">long</span> <a class="code" href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a> = 2;</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;  <span class="keywordtype">int</span> modesel = 1;</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  <span class="keywordtype">float</span> xlen, ylen, zlen, alpha, <a class="code" href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">beta</a>, <a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a>;</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;  <span class="keywordtype">long</span> mapc, mapr, maps;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;  <span class="keywordtype">long</span> ispg = 1, nlabl = 0;</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;  <span class="keywordtype">float</span> <a class="code" href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a> = 0.0f;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ae1dcd09f9c8de5971c9a85494ab952e9">dmax</a>, <a class="code" href="numerical__recipes_8cpp.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a>, dav, dsig;</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  <span class="keywordtype">float</span> <a class="code" href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a>, fmin, fav, fsig;</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  <span class="keywordtype">double</span> dshift, dscale;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;  <span class="keywordtype">char</span> dummychar = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;  <span class="keywordtype">char</span> mapstring[4];</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;  <span class="keywordtype">char</span> machstring[4];</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, wmaperr;</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;  <span class="keywordtype">long</span> lskflg = 0;</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  <span class="keywordtype">float</span> skwmat11 = 1.0f, skwmat12 = 0.0f, skwmat13 = 0.0f, skwmat21 = 0.0f;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;  <span class="keywordtype">float</span> skwmat22 = 1.0f, skwmat23 = 0.0f, skwmat31 = 0.0f, skwmat32 = 0.0f;</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  <span class="keywordtype">float</span>  skwmat33 = 1.0f, skwtrn1 = 0.0f, skwtrn2 = 0.0f, skwtrn3 = 0.0f;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  <span class="keywordtype">char</span> endchar[4] = {1, 1, 0, 0};</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;  fout = fopen(vol_file, <span class="stringliteral">&quot;wb&quot;</span>);</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;  <span class="keywordflow">if</span> (fout == NULL) {</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <a class="code" href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a>(71420, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;  }</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  <span class="comment">/* set initial values of map parameters */</span></div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  pnvox = pextx * pexty * pextz;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;  nx = pextx;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;  ny = pexty;</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;  nz = pextz;</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;  mapstring[0]  = <span class="charliteral">&#39;M&#39;</span>;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;  mapstring[1]  = <span class="charliteral">&#39;A&#39;</span>;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  mapstring[2]  = <span class="charliteral">&#39;P&#39;</span>;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;  mapstring[3]  = <span class="charliteral">&#39; &#39;</span>;</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;  <span class="keywordflow">if</span> (*((<span class="keywordtype">int</span> *)endchar) &gt; 65536) {   <span class="comment">/* big endian */</span></div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    machstring[0]  = 17;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    machstring[1]  = 17;</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  } <span class="keywordflow">else</span> { <span class="comment">/* little endian */</span></div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    machstring[0]  = 68;</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    machstring[1]  = 65;</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  }</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  machstring[2]  = 0;</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  machstring[3]  = 0;</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  <a class="code" href="lib__vwk_8cpp.html#a96951be7381dde64fa9234aafc9034cc">calc_map_info</a>(pphi, pnvox, &amp;dmax, &amp;dmin, &amp;dav, &amp;dsig);</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;  fmax = <a class="code" href="numerical__recipes_8cpp.html#ae1dcd09f9c8de5971c9a85494ab952e9">dmax</a>;</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  fmin = <a class="code" href="numerical__recipes_8cpp.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a>;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;  fav = dav;</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  fsig = dsig;</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  xorigin = porigx;</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;  yorigin = porigy;</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  zorigin = porigz;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  mx = pextx;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;  my = pexty;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  mz = pextz;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  xlen = pwidth * mx;</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;  ylen = pwidth * my;</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;  zlen = pwidth * mz;</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;  alpha = 90.0f;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  beta = 90.0f;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  gamma = 90.0f;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  mapc = 1;</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  mapr = 2;</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  maps = 3;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <span class="comment">/* if grid is not in register with origin, we set the CCP4 start indices to zero */</span></div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="lib__vio_8cpp.html#a91c5b032bb0a4497df72b7bb71cbf1a7">test_registration</a>(porigx, porigy, porigz, pwidth) == 0) {</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    nxstart = 0;</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    nystart = 0;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    nzstart = 0;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    nxstart = (long)<a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>((porigx / pwidth) + 0.5);</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    nystart = (long)<a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>((porigy / pwidth) + 0.5);</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    nzstart = (long)<a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>((porigz / pwidth) + 0.5);</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  }</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  <span class="comment">/* optional manual override of variable map parameters */</span></div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  <span class="keywordflow">if</span> (automode == 0) {</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Manual override of MRC / CCP4 header fields.\n&quot;</span>);</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; \n&quot;</span>);</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned data type is 32-bit floats (MODE 2)\n&quot;</span>);</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Select one of the following options: \n&quot;</span>);</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      1: keep MODE 2, 32-bit floats \n&quot;</span>);</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      2: MODE 0, signed 8-bit (range -127...128 as in CCP4), clip any out-of range\n&quot;</span>);</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      3: MODE 0, signed 8-bit (range -127...128 as in CCP4), scale to fit\n&quot;</span>);</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      4: MODE 0, signed 8-bit (range -127...128 as in CCP4), shift and scale to fit\n&quot;</span>);</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      5: MODE 0, unsigned 8-bit (range 0...255 as in old MRC), clip any out-of range\n&quot;</span>);</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      6: MODE 0, unsigned 8-bit (range 0...255 as in old MRC), scale pos., clip neg.\n&quot;</span>);</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      7: MODE 0, unsigned 8-bit (range 0...255 as in old MRC), shift and scale to fit\n&quot;</span>);</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; \n&quot;</span>);</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Enter selection number: &quot;</span>);</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    modesel = <a class="code" href="lib__std_8cpp.html#aceb173c6bb65ad6efbefdfa950caf449">readln_int</a>();</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <span class="keywordflow">if</span> (modesel &lt; 1 &amp;&amp; modesel &gt; 7) {</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      modesel = 1;</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;      mode = 2;</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Did not recognize value, assuming MODE 2, 32-bit floats. \n&quot;</span>);</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (modesel &gt; 1) mode = 0;</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Note: The written data is not affected by changing the following header values.\n&quot;</span>);</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned CCP4-style NC field (# columns) is %ld \n&quot;</span>, nx);</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Enter the same or a new value: &quot;</span>);</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    nx = <a class="code" href="lib__std_8cpp.html#aceb173c6bb65ad6efbefdfa950caf449">readln_int</a>();</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned CCP4-style NR field (# rows) is %ld \n&quot;</span>, ny);</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Enter the same or a new value: &quot;</span>);</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    ny = <a class="code" href="lib__std_8cpp.html#aceb173c6bb65ad6efbefdfa950caf449">readln_int</a>();</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned CCP4-style NS field (# sections) is %ld \n&quot;</span>, nz);</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Enter the same or a new value: &quot;</span>);</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    nz = <a class="code" href="lib__std_8cpp.html#aceb173c6bb65ad6efbefdfa950caf449">readln_int</a>();</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    <span class="keywordflow">if</span> (((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)nx * (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)ny * (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)nz) != pnvox) {</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; \n&quot;</span>);</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;      <a class="code" href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a>(stderr, <span class="stringliteral">&quot;lib_vio&gt; Warning: NC * NR * NS does not match the total number of voxels in the map.\n&quot;</span>);</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; \n&quot;</span>);</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    }</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned CCP4-style NCSTART field (column start index) is %ld \n&quot;</span>, nxstart);</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <span class="keywordflow">if</span> (nxstart == 0 &amp;&amp; <a class="code" href="lib__vio_8cpp.html#a91c5b032bb0a4497df72b7bb71cbf1a7">test_registration</a>(porigx, porigy, porigz, pwidth) == 0) {</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Set to zero by default because input grid not in register with origin of coordinate system.\n&quot;</span>);</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    }</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Enter the same or a new value: &quot;</span>);</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    nxstart = <a class="code" href="lib__std_8cpp.html#aceb173c6bb65ad6efbefdfa950caf449">readln_int</a>();</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned CCP4-style NRSTART field (row start index) is %ld \n&quot;</span>, nystart);</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <span class="keywordflow">if</span> (nxstart == 0 &amp;&amp; <a class="code" href="lib__vio_8cpp.html#a91c5b032bb0a4497df72b7bb71cbf1a7">test_registration</a>(porigx, porigy, porigz, pwidth) == 0) {</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Set to zero by default because input grid not in register with origin of coordinate system.\n&quot;</span>);</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    }</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Enter the same or a new value: &quot;</span>);</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    nystart = <a class="code" href="lib__std_8cpp.html#aceb173c6bb65ad6efbefdfa950caf449">readln_int</a>();</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned CCP4-style NSSTART field (section start index) is %ld \n&quot;</span>, nzstart);</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    <span class="keywordflow">if</span> (nxstart == 0 &amp;&amp; <a class="code" href="lib__vio_8cpp.html#a91c5b032bb0a4497df72b7bb71cbf1a7">test_registration</a>(porigx, porigy, porigz, pwidth) == 0) {</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Set to zero by default because input grid not in register with origin of coordinate system.\n&quot;</span>);</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    }</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Enter the same or a new value: &quot;</span>);</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    nzstart = <a class="code" href="lib__std_8cpp.html#aceb173c6bb65ad6efbefdfa950caf449">readln_int</a>();</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned MX field (# of X intervals in the unit cell) is %ld \n&quot;</span>, mx);</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Enter the same or a new value: &quot;</span>);</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    mx = <a class="code" href="lib__std_8cpp.html#aceb173c6bb65ad6efbefdfa950caf449">readln_int</a>();</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned MY field (# of Y intervals in the unit cell) is %ld \n&quot;</span>, my);</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Enter the same or a new value: &quot;</span>);</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    my = <a class="code" href="lib__std_8cpp.html#aceb173c6bb65ad6efbefdfa950caf449">readln_int</a>();</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned MZ field (# of Z intervals in the unit cell) is %ld \n&quot;</span>, mz);</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Enter the same or a new value: &quot;</span>);</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    mz = <a class="code" href="lib__std_8cpp.html#aceb173c6bb65ad6efbefdfa950caf449">readln_int</a>();</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned X unit cell dimension is %f Angstrom\n&quot;</span>, xlen);</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Enter the same or a new value: &quot;</span>);</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    xlen = <a class="code" href="lib__std_8cpp.html#aea3509ee0bdfe490b27b271f78788dc1">readln_double</a>();</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned Y unit cell dimension is %f Angstrom\n&quot;</span>, ylen);</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Enter the same or a new value: &quot;</span>);</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    ylen = <a class="code" href="lib__std_8cpp.html#aea3509ee0bdfe490b27b271f78788dc1">readln_double</a>();</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned Z unit cell dimension is %f Angstrom\n&quot;</span>, zlen);</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Enter the same or a new value: &quot;</span>);</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    zlen = <a class="code" href="lib__std_8cpp.html#aea3509ee0bdfe490b27b271f78788dc1">readln_double</a>();</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned unit cell angle alpha is %f degrees \n&quot;</span>, alpha);</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Enter the same or a new value: &quot;</span>);</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    alpha = <a class="code" href="lib__std_8cpp.html#aea3509ee0bdfe490b27b271f78788dc1">readln_double</a>();</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned unit cell angle beta is %f degrees \n&quot;</span>, beta);</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Enter the same or a new value: &quot;</span>);</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    beta = <a class="code" href="lib__std_8cpp.html#aea3509ee0bdfe490b27b271f78788dc1">readln_double</a>();</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned unit cell angle gamma is %f degrees \n&quot;</span>, gamma);</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Enter the same or a new value: &quot;</span>);</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    gamma = <a class="code" href="lib__std_8cpp.html#aea3509ee0bdfe490b27b271f78788dc1">readln_double</a>();</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned MAPC field (axis order) is %ld \n&quot;</span>, mapc);</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Enter the same or a new value: &quot;</span>);</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    mapc = <a class="code" href="lib__std_8cpp.html#aceb173c6bb65ad6efbefdfa950caf449">readln_int</a>();</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    wmaperr = 1;</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    <span class="keywordflow">if</span> (mapc == 1 || mapc == 2 || mapc == 3) wmaperr = 0;</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="keywordflow">if</span> (wmaperr) {</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;      mapc = 1;</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;      mapr = 2;</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;      maps = 3;</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Inconsistent axis order values, assuming mapc = 1, mapr = 2, maps = 3. \n&quot;</span>);</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned MAPR field (axis order) is %ld \n&quot;</span>, mapr);</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Enter the same or a new value: &quot;</span>);</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;      mapr = <a class="code" href="lib__std_8cpp.html#aceb173c6bb65ad6efbefdfa950caf449">readln_int</a>();</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;      wmaperr = 1;</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;      <span class="keywordflow">if</span> (mapc == 1 &amp;&amp; mapr == 2) wmaperr = 0;</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;      <span class="keywordflow">if</span> (mapc == 1 &amp;&amp; mapr == 3) wmaperr = 0;</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;      <span class="keywordflow">if</span> (mapc == 2 &amp;&amp; mapr == 1) wmaperr = 0;</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;      <span class="keywordflow">if</span> (mapc == 2 &amp;&amp; mapr == 3) wmaperr = 0;</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;      <span class="keywordflow">if</span> (mapc == 3 &amp;&amp; mapr == 1) wmaperr = 0;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;      <span class="keywordflow">if</span> (mapc == 3 &amp;&amp; mapr == 2) wmaperr = 0;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;      <span class="keywordflow">if</span> (wmaperr) {</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;        mapc = 1;</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;        mapr = 2;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;        maps = 3;</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;        printf(<span class="stringliteral">&quot;lib_vio&gt; Inconsistent axis order values, assuming mapc = 1, mapr = 2, maps = 3. \n&quot;</span>);</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;        printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned MAPS field (axis order) is %ld \n&quot;</span>, maps);</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;        printf(<span class="stringliteral">&quot;lib_vio&gt; Enter the same or a new value: &quot;</span>);</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;        maps = <a class="code" href="lib__std_8cpp.html#aceb173c6bb65ad6efbefdfa950caf449">readln_int</a>();</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;        wmaperr = 1;</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;        <span class="keywordflow">if</span> (mapc == 1 &amp;&amp; mapr == 2 &amp;&amp; maps == 3) wmaperr = 0;</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        <span class="keywordflow">if</span> (mapc == 1 &amp;&amp; mapr == 3 &amp;&amp; maps == 2) wmaperr = 0;</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;        <span class="keywordflow">if</span> (mapc == 2 &amp;&amp; mapr == 1 &amp;&amp; maps == 3) wmaperr = 0;</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;        <span class="keywordflow">if</span> (mapc == 2 &amp;&amp; mapr == 3 &amp;&amp; maps == 1) wmaperr = 0;</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;        <span class="keywordflow">if</span> (mapc == 3 &amp;&amp; mapr == 1 &amp;&amp; maps == 2) wmaperr = 0;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;        <span class="keywordflow">if</span> (mapc == 3 &amp;&amp; mapr == 2 &amp;&amp; maps == 1) wmaperr = 0;</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;        <span class="keywordflow">if</span> (wmaperr) {</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;          mapc = 1;</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;          mapr = 2;</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;          maps = 3;</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;          printf(<span class="stringliteral">&quot;lib_vio&gt; Inconsistent axis order values, assuming mapc = 1, mapr = 2, maps = 3. \n&quot;</span>);</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;        }</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;      }</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    }</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned MRC2000-style XORIGIN field is %f Angstrom\n&quot;</span>, xorigin);</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Enter the same or a new value: &quot;</span>);</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    xorigin = <a class="code" href="lib__std_8cpp.html#aea3509ee0bdfe490b27b271f78788dc1">readln_double</a>();</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned MRC2000-style YORIGIN field is %f Angstrom\n&quot;</span>, yorigin);</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Enter the same or a new value: &quot;</span>);</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    yorigin = <a class="code" href="lib__std_8cpp.html#aea3509ee0bdfe490b27b271f78788dc1">readln_double</a>();</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The currently assigned MRC2000-style ZORIGIN field is %f Angstrom\n&quot;</span>, zorigin);</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Enter the same or a new value: &quot;</span>);</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    zorigin = <a class="code" href="lib__std_8cpp.html#aea3509ee0bdfe490b27b271f78788dc1">readln_double</a>();</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;  } <span class="comment">/* end manual override */</span></div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;  <span class="comment">/* adjust MODE 0 maps as necessary */</span></div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;  <span class="keywordflow">switch</span> (modesel) {</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="lib__vwk_8cpp.html#ad690ce7363ee3fdbb85a857a24575b7c">clipped</a>(pphi, pnvox, 127.0, -128.0)) </div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;        printf(<span class="stringliteral">&quot;lib_vio&gt; Density values were clipped to fit signed 8-bit data format.\n&quot;</span>);</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      <span class="keywordflow">else</span> </div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;        printf(<span class="stringliteral">&quot;lib_vio&gt; Density values already fit signed 8-bit data format, no clipping necessary.\n&quot;</span>);</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      dscale = dmax / 127.0;</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;      <span class="keywordflow">if</span> (dmin / -128.0 &gt; dscale) </div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;        dscale = dmin / -128.0;</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Density values will be rescaled to fit signed 8-bit data format.\n&quot;</span>);</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Scaling factor (by which values will be divided): %f .\n&quot;</span>, dscale);</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;      <a class="code" href="lib__vwk_8cpp.html#ac76a998ec878a9c9957ccb0d8bdfcf34">normalize</a>(pphi, pnvox, dscale);</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;      dscale = (dmax - <a class="code" href="numerical__recipes_8cpp.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a>) / 255.0;</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      dshift = (dmax + <a class="code" href="numerical__recipes_8cpp.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a>) / 2.0 + 0.5 * dscale;</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Density values will be centered and rescaled to fit signed 8-bit data format.\n&quot;</span>);</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Center offset value (will be added to map): %f .\n&quot;</span>, -dshift);</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Scaling factor (by which values will be divided): %f .\n&quot;</span>, dscale);</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      <a class="code" href="lib__vwk_8cpp.html#a8a4b63a24398d6d78aa4bdbff51dcdfd">floatshift</a>(pphi, pnvox, dshift);</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;      <a class="code" href="lib__vwk_8cpp.html#ac76a998ec878a9c9957ccb0d8bdfcf34">normalize</a>(pphi, pnvox, dscale);</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="lib__vwk_8cpp.html#ad690ce7363ee3fdbb85a857a24575b7c">clipped</a>(pphi, pnvox, 255.0, 0.0)) printf(<span class="stringliteral">&quot;lib_vio&gt; Density values were clipped to fit unsigned 8-bit data format.\n&quot;</span>);</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;lib_vio&gt; Density values already fit unsigned 8-bit data format, no clipping necessary.\n&quot;</span>);</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      dscale = dmax / 255.0;</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Density values will be rescaled to fit unsigned 8-bit data format.\n&quot;</span>);</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Scaling factor (by which values will be divided): %f .\n&quot;</span>, dscale);</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      <a class="code" href="lib__vwk_8cpp.html#ac76a998ec878a9c9957ccb0d8bdfcf34">normalize</a>(pphi, pnvox, dscale);</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="lib__vwk_8cpp.html#ad690ce7363ee3fdbb85a857a24575b7c">clipped</a>(pphi, pnvox, 256.0, 0.0)) printf(<span class="stringliteral">&quot;lib_vio&gt; Negative density values were clipped to fit unsigned 8-bit data format.\n&quot;</span>);</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      dscale = (dmax - <a class="code" href="numerical__recipes_8cpp.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a>) / 255.0;</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;      dshift = (dmax + <a class="code" href="numerical__recipes_8cpp.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a>) / 2.0 - 127.5 * dscale;</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Density values will be centered and rescaled to fit unsigned 8-bit data format.\n&quot;</span>);</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Center offset value (will be added to map): %f .\n&quot;</span>, -dshift);</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      printf(<span class="stringliteral">&quot;lib_vio&gt; Scaling factor (by which values will be divided): %f .\n&quot;</span>, dscale);</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;      <a class="code" href="lib__vwk_8cpp.html#a8a4b63a24398d6d78aa4bdbff51dcdfd">floatshift</a>(pphi, pnvox, dshift);</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      <a class="code" href="lib__vwk_8cpp.html#ac76a998ec878a9c9957ccb0d8bdfcf34">normalize</a>(pphi, pnvox, dscale);</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;      <a class="code" href="lib__err_8cpp.html#a9edf89d84a6492ca867bde8c52cd801a">error_option</a>(70211, <span class="stringliteral">&quot;lib_vio&quot;</span>);</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;  }</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  <span class="comment">/* recompute map statistics and then adjust unsigned MODE 0 values for storage as signed */</span></div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;  <span class="keywordflow">if</span> (modesel &gt; 1) {</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <a class="code" href="lib__vwk_8cpp.html#a96951be7381dde64fa9234aafc9034cc">calc_map_info</a>(pphi, pnvox, &amp;dmax, &amp;dmin, &amp;dav, &amp;dsig);</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    fmax = <a class="code" href="numerical__recipes_8cpp.html#ae1dcd09f9c8de5971c9a85494ab952e9">dmax</a>;</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    fmin = <a class="code" href="numerical__recipes_8cpp.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a>;</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    fav = dav;</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    fsig = dsig;</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;  }</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;  <span class="keywordflow">if</span> (modesel &gt; 4) {</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Converting the unsigned 8-bit (0...255) values to signed (-128...127) for storage (ISO/IEC 10967).\n&quot;</span>);</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The conversion subtracts 256 from density values above 127.\n&quot;</span>);</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Check your software documentation if the `unsigned` convention is supported for MODE 0 maps.\n&quot;</span>);</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    <span class="keywordflow">for</span> (count = 0; count &lt; pnvox; count++) if (*(pphi + count) &gt;= 127.5) *(pphi + count) -= 256.0;</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;  }</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;  <span class="comment">/* Warning */</span></div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  <span class="comment">/* Do not recompute map statistics after unsigned to signed conversion */</span></div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;  <span class="comment">/* write header */</span></div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Writing MRC / CCP4 (binary) volumetric map \n&quot;</span>);</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;  wmaperr = 0;</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;nx, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;ny, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;nz, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;mode, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;nxstart, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;nystart, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;nzstart, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;mx, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;my, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;mz, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;xlen, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;ylen, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;zlen, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;alpha, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;beta, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;gamma, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;mapc, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;mapr, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;maps, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;fmin, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;fmax, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;fav, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;ispg, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;dummy, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;lskflg, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;skwmat11, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;skwmat12, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;skwmat13, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;skwmat21, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;skwmat22, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;skwmat23, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;skwmat31, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;skwmat32, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;skwmat33, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;skwtrn1, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;skwtrn2, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;skwtrn3, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;  <span class="keywordflow">for</span> (i = 38; i &lt; 50; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) <span class="keywordflow">if</span> (fwrite(&amp;dummy, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;xorigin, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;yorigin, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;zorigin, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;  <span class="keywordflow">if</span> (fwrite(mapstring, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  <span class="keywordflow">if</span> (fwrite(machstring, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;fsig, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;nlabl, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; 800; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) <span class="keywordflow">if</span> (fwrite(&amp;dummychar, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;  <span class="comment">/* write actual data */</span></div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;  <span class="keywordflow">switch</span> (mode) {</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;      <span class="keywordflow">for</span> (count = 0; count &lt; pnvox; count++) {</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        dummy = <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>(*(pphi + count) + 0.5);</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;        <span class="keywordflow">if</span> (dummy &lt; -128 || dummy &gt; 127) wmaperr = 1;</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;        dummychar = (char)dummy;</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        <span class="keywordflow">if</span> (fwrite(&amp;dummychar, 1, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      }</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      <span class="keywordflow">for</span> (count = 0; count &lt; pnvox; count++) {</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;        dummy = *(pphi + count);</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        <span class="keywordflow">if</span> (fwrite(&amp;dummy, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      }</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;      wmaperr = 1;</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;  }</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;  <span class="keywordflow">if</span> (wmaperr != 0) {</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    <a class="code" href="lib__err_8cpp.html#a6f26b1ef460a302cadce538c09e8a8f5">error_write_filename</a>(71430, <span class="stringliteral">&quot;lib_vio&quot;</span>);</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;  }</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;  fclose(fout);</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  <span class="comment">/* print some info */</span></div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Volumetric map written to file %s \n&quot;</span>, vol_file);</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Header information: \n&quot;</span>);</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;       NC = %8ld  (# columns)\n&quot;</span>, nx);</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;       NR = %8ld  (# rows)\n&quot;</span>, ny);</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;       NS = %8ld  (# sections)\n&quot;</span>, nz);</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     MODE = %8ld  (data type: 0: 8-bit char, 2: 32-bit float)\n&quot;</span>, mode);</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;  NCSTART = %8ld  (index of first column, counting from 0)\n&quot;</span>, nxstart);</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;  NRSTART = %8ld  (index of first row, counting from 0)\n&quot;</span>, nystart);</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;  NSSTART = %8ld  (index of first section, counting from 0)\n&quot;</span>, nzstart);</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;       MX = %8ld  (# of X intervals in unit cell)\n&quot;</span>, mx);</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;       MY = %8ld  (# of Y intervals in unit cell)\n&quot;</span>, my);</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;       MZ = %8ld  (# of Z intervals in unit cell)\n&quot;</span>, mz);</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; X length = %8.3f  (unit cell dimension)\n&quot;</span>, xlen);</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Y length = %8.3f  (unit cell dimension)\n&quot;</span>, ylen);</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Z length = %8.3f  (unit cell dimension)\n&quot;</span>, zlen);</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    Alpha = %8.3f  (unit cell angle)\n&quot;</span>, alpha);</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     Beta = %8.3f  (unit cell angle)\n&quot;</span>, beta);</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    Gamma = %8.3f  (unit cell angle)\n&quot;</span>, gamma);</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     MAPC = %8ld  (columns axis: 1=X,2=Y,3=Z)\n&quot;</span>, mapc);</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     MAPR = %8ld  (rows axis: 1=X,2=Y,3=Z)\n&quot;</span>, mapr);</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     MAPS = %8ld  (sections axis: 1=X,2=Y,3=Z)\n&quot;</span>, maps);</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     DMIN = %8.3f  (minimum density value)\n&quot;</span>, fmin);</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     DMAX = %8.3f  (maximum density value)\n&quot;</span>, fmax);</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    DMEAN = %8.3f  (mean density value)\n&quot;</span>, fav);</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     ISPG = %8ld  (space group number)\n&quot;</span>, ispg);</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   NSYMBT = %8d  (# bytes used for storing symmetry operators)\n&quot;</span>, 0);</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   LSKFLG = %8ld  (skew matrix flag: 0:none, 1:follows)\n&quot;</span>, lskflg);</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;  <span class="keywordflow">if</span> (lskflg != 0) {</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      S11 = %8.3f  (skew matrix element 11)\n&quot;</span>, skwmat11);</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      S12 = %8.3f  (skew matrix element 12)\n&quot;</span>, skwmat12);</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      S13 = %8.3f  (skew matrix element 13)\n&quot;</span>, skwmat13);</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      S21 = %8.3f  (skew matrix element 21)\n&quot;</span>, skwmat21);</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      S22 = %8.3f  (skew matrix element 22)\n&quot;</span>, skwmat22);</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      S23 = %8.3f  (skew matrix element 23)\n&quot;</span>, skwmat23);</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      S31 = %8.3f  (skew matrix element 31)\n&quot;</span>, skwmat31);</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      S32 = %8.3f  (skew matrix element 32)\n&quot;</span>, skwmat32);</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;      S33 = %8.3f  (skew matrix element 33)\n&quot;</span>, skwmat33);</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;       T1 = %8.3f  (skew translation element 1)\n&quot;</span>, skwtrn1);</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;       T2 = %8.3f  (skew translation element 2)\n&quot;</span>, skwtrn2);</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt;       T3 = %8.3f  (skew translation element 3)\n&quot;</span>, skwtrn3);</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;  }</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;  XORIGIN = %8.3f  (X origin - MRC2000 only)\n&quot;</span>, xorigin);</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;  YORIGIN = %8.3f  (Y origin - MRC2000 only)\n&quot;</span>, yorigin);</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;  ZORIGIN = %8.3f  (Z origin - MRC2000 only)\n&quot;</span>, zorigin);</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;      MAP =      %c%c%c%c (map string)\n&quot;</span>, mapstring[0], mapstring[1], mapstring[2], mapstring[3]);</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   MACHST = %d %d %d %d (machine stamp)\n&quot;</span>, machstring[0], machstring[1], machstring[2], machstring[3]);</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;      RMS = %8.3f  (density rmsd)\n&quot;</span>, fsig);</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;  <span class="comment">/* if auto mode and grid is not in register with origin, issue a warning */</span></div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;  <span class="keywordflow">if</span> (automode == 1 &amp;&amp; <a class="code" href="lib__vio_8cpp.html#a91c5b032bb0a4497df72b7bb71cbf1a7">test_registration</a>(porigx, porigy, porigz, pwidth) == 0) {</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Input grid not in register with origin of coordinate system.\n&quot;</span>);</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The origin information was saved only in the MRC2000 format fields.\n&quot;</span>);</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; The CCP4 start indexing was set to zero.\n&quot;</span>);</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; To invoke a crystallographic CCP4 indexing, you can force an interpolation \n&quot;</span>);</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; by converting to an intermediate X-PLOR map using the map2map tool. \n&quot;</span>);</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;  }</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;}</div><div class="ttc" id="lib__vio_8cpp_html_a91c5b032bb0a4497df72b7bb71cbf1a7"><div class="ttname"><a href="lib__vio_8cpp.html#a91c5b032bb0a4497df72b7bb71cbf1a7">test_registration</a></div><div class="ttdeci">int test_registration(float origx, float origy, float origz, float width)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00917">lib_vio.cpp:917</a></div></div>
<div class="ttc" id="cuda__basic__math_8h_html_a2065eb145275f878c1d045c9f3fb1cc7"><div class="ttname"><a href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a></div><div class="ttdeci">__host__ __device__ float2 floor(const float2 v)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__basic__math_8h_source.html#l00175">cuda_basic_math.h:175</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_a9edf89d84a6492ca867bde8c52cd801a"><div class="ttname"><a href="lib__err_8cpp.html#a9edf89d84a6492ca867bde8c52cd801a">error_option</a></div><div class="ttdeci">void error_option(int error_number, const char *program)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00061">lib_err.cpp:61</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_a6f26b1ef460a302cadce538c09e8a8f5"><div class="ttname"><a href="lib__err_8cpp.html#a6f26b1ef460a302cadce538c09e8a8f5">error_write_filename</a></div><div class="ttdeci">void error_write_filename(int error_number, const char *program)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00227">lib_err.cpp:227</a></div></div>
<div class="ttc" id="namespacealglib_html_a038c39f3bfe0dff667a2cb6bebfed764"><div class="ttname"><a href="namespacealglib.html#a038c39f3bfe0dff667a2cb6bebfed764">alglib::beta</a></div><div class="ttdeci">double beta(const double a, const double b)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l00962">specialfunctions.cpp:962</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_acf097d43154f3f002dbb9692ce4c55f7"><div class="ttname"><a href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a></div><div class="ttdeci">double * gamma</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07616">numerical_recipes.cpp:7616</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="lib__vwk_8cpp_html_a96951be7381dde64fa9234aafc9034cc"><div class="ttname"><a href="lib__vwk_8cpp.html#a96951be7381dde64fa9234aafc9034cc">calc_map_info</a></div><div class="ttdeci">void calc_map_info(double *phi, unsigned long nvox, double *maxdens, double *mindens, double *ave, double *sig)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vwk_8cpp_source.html#l00491">lib_vwk.cpp:491</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_ae76582a4cbab89aa99fcf38effea84e5"><div class="ttname"><a href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a></div><div class="ttdeci">void error_open_filename(int error_number, const char *program, char *argv)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00067">lib_err.cpp:67</a></div></div>
<div class="ttc" id="lib__std_8cpp_html_aea3509ee0bdfe490b27b271f78788dc1"><div class="ttname"><a href="lib__std_8cpp.html#aea3509ee0bdfe490b27b271f78788dc1">readln_double</a></div><div class="ttdeci">double readln_double()</div><div class="ttdef"><b>Definition:</b> <a href="lib__std_8cpp_source.html#l00038">lib_std.cpp:38</a></div></div>
<div class="ttc" id="lib__std_8cpp_html_aceb173c6bb65ad6efbefdfa950caf449"><div class="ttname"><a href="lib__std_8cpp.html#aceb173c6bb65ad6efbefdfa950caf449">readln_int</a></div><div class="ttdeci">int readln_int()</div><div class="ttdef"><b>Definition:</b> <a href="lib__std_8cpp_source.html#l00019">lib_std.cpp:19</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a0978a1b8e1dc8878376a50a88725223d"><div class="ttname"><a href="numerical__recipes_8cpp.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a></div><div class="ttdeci">#define dmin(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02129">numerical_recipes.cpp:2129</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a74e37497baeb87072fb1730874e59adb"><div class="ttname"><a href="numerical__recipes_8cpp.html#a74e37497baeb87072fb1730874e59adb">mode</a></div><div class="ttdeci">void mode</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04428">numerical_recipes.cpp:4428</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad03d014386c050f947b2903e44f3b383"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a></div><div class="ttdeci">double dummy</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04652">numerical_recipes.cpp:4652</a></div></div>
<div class="ttc" id="lib__vwk_8cpp_html_a8a4b63a24398d6d78aa4bdbff51dcdfd"><div class="ttname"><a href="lib__vwk_8cpp.html#a8a4b63a24398d6d78aa4bdbff51dcdfd">floatshift</a></div><div class="ttdeci">void floatshift(double *phi, unsigned long nvox, double dens)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vwk_8cpp_source.html#l00594">lib_vwk.cpp:594</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae1dcd09f9c8de5971c9a85494ab952e9"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae1dcd09f9c8de5971c9a85494ab952e9">dmax</a></div><div class="ttdeci">#define dmax(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02130">numerical_recipes.cpp:2130</a></div></div>
<div class="ttc" id="lib__vwk_8cpp_html_ad690ce7363ee3fdbb85a857a24575b7c"><div class="ttname"><a href="lib__vwk_8cpp.html#ad690ce7363ee3fdbb85a857a24575b7c">clipped</a></div><div class="ttdeci">int clipped(double *phi, unsigned long nvox, double max, double min)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vwk_8cpp_source.html#l00603">lib_vwk.cpp:603</a></div></div>
<div class="ttc" id="lib__vwk_8cpp_html_ac76a998ec878a9c9957ccb0d8bdfcf34"><div class="ttname"><a href="lib__vwk_8cpp.html#ac76a998ec878a9c9957ccb0d8bdfcf34">normalize</a></div><div class="ttdeci">void normalize(double *phi, unsigned long nvox, double factor)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vwk_8cpp_source.html#l00581">lib_vwk.cpp:581</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae453b7a848a8a559dee492de32116c99"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a></div><div class="ttdeci">fprintf(glob_prnt.io,&quot;\n&quot;)</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a046e290d67d4e9e20547aae0fab90070"><div class="ttname"><a href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a></div><div class="ttdeci">double fmax</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05183">numerical_recipes.cpp:5183</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a87bd7d4efe511eba251a44119c531fde"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_situs </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l00127">127</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;{</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nvox, count;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *program = <span class="stringliteral">&quot;lib_vio&quot;</span>;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  FILE *fout;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  nvox = extx * exty * extz;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  fout = fopen(vol_file, <span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">if</span> (fout == NULL) {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a>(13210, program, vol_file);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  }</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Writing density data... \n&quot;</span>);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <a class="code" href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a>(fout, <span class="stringliteral">&quot;%f %f %f %f %d %d %d\n&quot;</span>, width, origx, origy, origz, extx, exty, extz);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <a class="code" href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a>(fout, <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">for</span> (count = 0; count &lt; nvox; count++) {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> ((count + 1) % 10 == 0) <a class="code" href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a>(fout, <span class="stringliteral">&quot; %10.6f \n&quot;</span>, *(phi + count));</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a>(fout, <span class="stringliteral">&quot; %10.6f &quot;</span>, *(phi + count));</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  fclose(fout);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Volumetric data written in Situs format to file %s \n&quot;</span>, vol_file);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="comment">/* header information */</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Situs formatted map file %s - Header information: \n&quot;</span>, vol_file);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Columns, rows, and sections: x=1-%d, y=1-%d, z=1-%d\n&quot;</span>, extx, exty, extz);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; 3D coordinates of first voxel: (%f,%f,%f)\n&quot;</span>, origx, origy, origz);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Voxel size in Angstrom: %f \n&quot;</span>, width);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div><div class="ttc" id="lib__err_8cpp_html_ae76582a4cbab89aa99fcf38effea84e5"><div class="ttname"><a href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a></div><div class="ttdeci">void error_open_filename(int error_number, const char *program, char *argv)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00067">lib_err.cpp:67</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae453b7a848a8a559dee492de32116c99"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a></div><div class="ttdeci">fprintf(glob_prnt.io,&quot;\n&quot;)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a337699c29e71f3db1d19d6fd5cff79ef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_spider </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l02072">2072</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;{</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;  FILE *fout;</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count, pnvox;</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;  <span class="keywordtype">float</span> nslice, nrow, iform, imami, nsam, headrec;</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ae1dcd09f9c8de5971c9a85494ab952e9">dmax</a>, <a class="code" href="numerical__recipes_8cpp.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a>, dav, dsig;</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;  <span class="keywordtype">float</span> <a class="code" href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a>, fmin, fav, fsig;</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;  <span class="keywordtype">float</span> iangle, phi, <a class="code" href="numerical__recipes_8cpp.html#aca81c35c21e3a5f7f3a8d24504e76664">theta</a>, xoff, yoff, zoff, scale, labbyt, lenbyt, irec;</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;  <span class="keywordtype">float</span> istack, inuse, maxim, kangle, phi1, theta1, psi1, phi2, theta2, psi2;</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  <span class="keywordtype">float</span> <a class="code" href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a>;</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;  <span class="keywordtype">float</span> <a class="code" href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a>;</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, headlen, wmaperr;</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;  fout = fopen(vol_file, <span class="stringliteral">&quot;wb&quot;</span>);</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  <span class="keywordflow">if</span> (fout == NULL) {</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    <a class="code" href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a>(71460, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;  }</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  <span class="comment">/* set map parameters */</span></div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;  pnvox = pextx * pexty * pextz;</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;  nsam = pextx;</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;  nrow = pexty;</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;  nslice = pextz;</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;  iform = 3.0f;</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  imami = 1.0f;</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;  istack = 0.0f;</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;  inuse = -1.0f;</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;  maxim = 0.0f;</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;  kangle = 0.0f;</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;  phi1 = 0.0f;</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;  theta1 = 0.0f;</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;  psi1 = 0.0f;</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;  phi2 = 0.0f;</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;  theta2 = 0.0f;</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  psi2 = 0.0f;</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;  scale = 0.0f;</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  dummy = 0.0f;</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;  phi = 0;</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;  theta = 0;</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;  gamma = 0;</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;  xoff = 0;</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  yoff = 0;</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;  zoff = 0;</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;  iangle = 0;</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;  <span class="comment">/* compute density info */</span></div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;  <a class="code" href="lib__vwk_8cpp.html#a96951be7381dde64fa9234aafc9034cc">calc_map_info</a>(pphi, pnvox, &amp;dmax, &amp;dmin, &amp;dav, &amp;dsig);</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;  fmax = <a class="code" href="numerical__recipes_8cpp.html#ae1dcd09f9c8de5971c9a85494ab952e9">dmax</a>;</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  fmin = <a class="code" href="numerical__recipes_8cpp.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a>;</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;  fav = dav;</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  fsig = dsig;</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;  <span class="comment">/* write map */</span></div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;  headrec = ceil(256.0<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a> / (pextx * 1.0<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>));</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;  lenbyt = nsam * 4.0f;</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;  labbyt = headrec * lenbyt;</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;  irec = nslice * nrow + headrec;</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;  headlen = (int)(headrec * nsam);</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;\n&quot;</span>);</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Writing SPIDER (binary) volumetric map... \n&quot;</span>);</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;  wmaperr = 0;</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;nslice, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;nrow, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;irec, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;dummy, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;iform, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;imami, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;fmax, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;fmin, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;fav, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;fsig, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;dummy, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;nsam, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;headrec, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;iangle, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;phi, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;theta, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;gamma, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;xoff, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;yoff, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;zoff, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;scale, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;labbyt, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;lenbyt, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;istack, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;inuse, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;maxim, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; 4; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) <span class="keywordflow">if</span> (fwrite(&amp;dummy, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;kangle, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;phi1, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;theta1, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;psi1, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;phi2, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;theta2, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;  <span class="keywordflow">if</span> (fwrite(&amp;psi2, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; (headlen - 37); ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) <span class="keywordflow">if</span> (fwrite(&amp;dummy, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;  <span class="keywordflow">for</span> (count = 0; count &lt; pnvox; count++) {</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    dummy = *(pphi + count);</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    <span class="keywordflow">if</span> (fwrite(&amp;dummy, 4, 1, fout) != 1) wmaperr = 1;</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;  }</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;  <span class="keywordflow">if</span> (wmaperr != 0) {</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    <a class="code" href="lib__err_8cpp.html#a6f26b1ef460a302cadce538c09e8a8f5">error_write_filename</a>(71470, <span class="stringliteral">&quot;lib_vio&quot;</span>);</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;  }</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;  fclose(fout);</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;  <span class="comment">/* print some info */</span></div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   SPIDER map written to file %s \n&quot;</span>, vol_file);</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   SPIDER map indexing: \n&quot;</span>);</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   NSLICE = %8.f  (# sections)\n&quot;</span>, nslice);</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     NROW = %8.f  (# rows)\n&quot;</span>, nrow);</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    IFORM = %8.f  (file type specifier)\n&quot;</span>, iform);</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    IMAMI = %8.f  (flag: =1 the maximum and minimum values are computed)\n&quot;</span>, imami);</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     FMAX = %8.3f  (maximum density value)\n&quot;</span>, fmax);</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     FMIN = %8.3f  (minimum density value)\n&quot;</span>, fmin);</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;       AV = %8.3f  (average density value)\n&quot;</span>, fav);</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;      SIG = %8.3f  (standard deviation of density distribution)\n&quot;</span>, fsig);</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     NSAM = %8.f  (# columns)\n&quot;</span>, nsam);</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;  HEADREC = %8.f  (number of records in file header)\n&quot;</span>, headrec);</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   IANGLE = %8.f  (flag: =1 tilt angles filled)\n&quot;</span>, iangle);</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;      PHI = %8.3f  (tilt angle)\n&quot;</span>, phi);</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    THETA = %8.3f  (tilt angle)\n&quot;</span>, theta);</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    GAMMA = %8.3f  (tilt angle)\n&quot;</span>, gamma);</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     XOFF = %8.3f  (X offset)\n&quot;</span>, xoff);</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     YOFF = %8.3f  (Y offset)\n&quot;</span>, yoff);</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     ZOFF = %8.3f  (Z offset)\n&quot;</span>, zoff);</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    SCALE = %8.3f  (scale factor)\n&quot;</span>, scale);</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   LABBYT = %8.f  (total number of bytes in header)\n&quot;</span>, labbyt);</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   LENBYT = %8.f  (record length in bytes)\n&quot;</span>, lenbyt);</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   ISTACK = %8.f  (flag; file contains a stack of images)\n&quot;</span>, istack);</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    INUSE = %8.f  (flag; this image in stack is used)\n&quot;</span>, inuse);</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    MAXIM = %8.f  (maximum image used in stack)\n&quot;</span>, maxim);</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   KANGLE = %8.f  (flag; additional angles set)\n&quot;</span>, kangle);</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     PHI1 = %8.3f  (additional rotation)\n&quot;</span>, phi1);</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   THETA1 = %8.3f  (additional rotation)\n&quot;</span>, theta1);</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     PSI1 = %8.3f  (additional rotation)\n&quot;</span>, psi1);</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     PHI2 = %8.3f  (additional rotation)\n&quot;</span>, phi2);</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;   THETA2 = %8.3f  (additional rotation)\n&quot;</span>, theta2);</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     PSI2 = %8.3f  (additional rotation)\n&quot;</span>, psi2);</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Warning: The voxel spacing %f has not been saved to the SPIDER map.\n&quot;</span>, pwidth);</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Warning: The map origin %f,%f,%f (first voxel position) has not been saved to the SPIDER map.\n&quot;</span>, porigx, porigy, porigz);</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;}</div><div class="ttc" id="lib__err_8cpp_html_a6f26b1ef460a302cadce538c09e8a8f5"><div class="ttname"><a href="lib__err_8cpp.html#a6f26b1ef460a302cadce538c09e8a8f5">error_write_filename</a></div><div class="ttdeci">void error_write_filename(int error_number, const char *program)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00227">lib_err.cpp:227</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_acf097d43154f3f002dbb9692ce4c55f7"><div class="ttname"><a href="numerical__recipes_8cpp.html#acf097d43154f3f002dbb9692ce4c55f7">gamma</a></div><div class="ttdeci">double * gamma</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07616">numerical_recipes.cpp:7616</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="lib__vwk_8cpp_html_a96951be7381dde64fa9234aafc9034cc"><div class="ttname"><a href="lib__vwk_8cpp.html#a96951be7381dde64fa9234aafc9034cc">calc_map_info</a></div><div class="ttdeci">void calc_map_info(double *phi, unsigned long nvox, double *maxdens, double *mindens, double *ave, double *sig)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vwk_8cpp_source.html#l00491">lib_vwk.cpp:491</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca81c35c21e3a5f7f3a8d24504e76664"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca81c35c21e3a5f7f3a8d24504e76664">theta</a></div><div class="ttdeci">double theta</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l06233">numerical_recipes.cpp:6233</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_ae76582a4cbab89aa99fcf38effea84e5"><div class="ttname"><a href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a></div><div class="ttdeci">void error_open_filename(int error_number, const char *program, char *argv)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00067">lib_err.cpp:67</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a0978a1b8e1dc8878376a50a88725223d"><div class="ttname"><a href="numerical__recipes_8cpp.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a></div><div class="ttdeci">#define dmin(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02129">numerical_recipes.cpp:2129</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a633de4b0c14ca52ea2432a3c8a5c4c31"><div class="ttname"><a href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a></div><div class="ttdeci">double * f</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04431">numerical_recipes.cpp:4431</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad03d014386c050f947b2903e44f3b383"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a></div><div class="ttdeci">double dummy</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04652">numerical_recipes.cpp:4652</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae1dcd09f9c8de5971c9a85494ab952e9"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae1dcd09f9c8de5971c9a85494ab952e9">dmax</a></div><div class="ttdeci">#define dmax(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02130">numerical_recipes.cpp:2130</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a046e290d67d4e9e20547aae0fab90070"><div class="ttname"><a href="numerical__recipes_8cpp.html#a046e290d67d4e9e20547aae0fab90070">fmax</a></div><div class="ttdeci">double fmax</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05183">numerical_recipes.cpp:5183</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae9cd58347d660e9c4e766dfbfc1b67d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_vol </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l00065">65</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;{</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="lib__vio_8cpp.html#ac4f0a80c9d2a0e00b49cd04e910f1b2c">have_situs_suffix</a>(vol_file)) </div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="lib__vio_8cpp.html#a21a033d514cfb2e73046cb7ba787df52">write_situs</a>(vol_file, width, origx, origy, origz, extx, exty, extz, phi);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordflow">else</span> </div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="lib__vio_8cpp.html#a1022a30cf8a25e7f9e5176e2a88d4dd5">write_mrc</a>(1, vol_file, width, origx, origy, origz, extx, exty, extz, phi);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;}</div><div class="ttc" id="lib__vio_8cpp_html_a21a033d514cfb2e73046cb7ba787df52"><div class="ttname"><a href="lib__vio_8cpp.html#a21a033d514cfb2e73046cb7ba787df52">write_situs</a></div><div class="ttdeci">void write_situs(char *vol_file, double width, double origx, double origy, double origz, unsigned extx, unsigned exty, unsigned extz, double *phi)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00127">lib_vio.cpp:127</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a1022a30cf8a25e7f9e5176e2a88d4dd5"><div class="ttname"><a href="lib__vio_8cpp.html#a1022a30cf8a25e7f9e5176e2a88d4dd5">write_mrc</a></div><div class="ttdeci">void write_mrc(int automode, char *vol_file, double pwidth, double porigx, double porigy, double porigz, unsigned pextx, unsigned pexty, unsigned pextz, double *pphi)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l01646">lib_vio.cpp:1646</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_ac4f0a80c9d2a0e00b49cd04e910f1b2c"><div class="ttname"><a href="lib__vio_8cpp.html#ac4f0a80c9d2a0e00b49cd04e910f1b2c">have_situs_suffix</a></div><div class="ttdeci">int have_situs_suffix(char *vol_file)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00981">lib_vio.cpp:981</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a990fdb9a5ea78d3efc3abe8a60028bf2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_xplor </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l01565">1565</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;{</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;  FILE *fout;</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;  <span class="keywordtype">long</span> mxstart, mystart, mzstart, mxend, myend, mzend;</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  <span class="keywordtype">unsigned</span> indx, indy, indz;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count;</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  <span class="keywordtype">unsigned</span> extx2, exty2, extz2;</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  <span class="keywordtype">double</span> origx2, origy2, origz2;</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <span class="keywordtype">double</span> *pphi2;</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  fout = fopen(vol_file, <span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;  <span class="keywordflow">if</span> (fout == NULL) {</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <a class="code" href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a>(71410, <span class="stringliteral">&quot;lib_vio&quot;</span>, vol_file);</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;  }</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;  <span class="comment">/* X-PLOR does not support free origin definitions, must work within indexing constraints */</span></div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;  <span class="comment">/* if necessary, bring into register with coordinate system origin (for integer start indices) */</span></div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="lib__vio_8cpp.html#a91c5b032bb0a4497df72b7bb71cbf1a7">test_registration</a>(porigx, porigy, porigz, pwidth) == 0) {</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Input grid not in register with origin of coordinate system.\n&quot;</span>);</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    printf(<span class="stringliteral">&quot;lib_vio&gt; Data will be interpolated to fit crystallographic X-PLOR format.\n&quot;</span>);</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  }</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;  <a class="code" href="lib__vwk_8cpp.html#a03f724ac8816bd2ad3640bfd4fbf439d">interpolate_map</a>(&amp;pphi2, &amp;extx2, &amp;exty2, &amp;extz2, &amp;origx2, &amp;origy2, &amp;origz2,</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                  pwidth, pwidth, pwidth, pphi, pextx, pexty, pextz, porigx,</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                  porigy, porigz, pwidth, pwidth, pwidth);</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;  <span class="comment">/* compute indices */</span></div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  mxstart = (long) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>((origx2 / pwidth) + 0.5);</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  mystart = (long) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>((origy2 / pwidth) + 0.5);</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  mzstart = (long) <a class="code" href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a>((origz2 / pwidth) + 0.5);</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;  mxend = mxstart + extx2 - 1;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  myend = mystart + exty2 - 1;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  mzend = mzstart + extz2 - 1;</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  <span class="comment">/* write map */</span></div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;\n&quot;</span>);</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; Writing X-PLOR formatted (ASCII) volumetric map \n&quot;</span>);</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  <a class="code" href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a>(fout, <span class="stringliteral">&quot; \n&quot;</span>);</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  <a class="code" href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a>(fout, <span class="stringliteral">&quot; 2 !NTITLE \n&quot;</span>);</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  <a class="code" href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a>(fout, <span class="stringliteral">&quot;REMARKS FILENAME=\&quot;%s\&quot; \n&quot;</span>, vol_file);</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  <a class="code" href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a>(fout, <span class="stringliteral">&quot;REMARKS created by the Situs lib_vio library\n&quot;</span>);</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  <a class="code" href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a>(fout, <span class="stringliteral">&quot;%8d%8ld%8ld%8d%8ld%8ld%8d%8ld%8ld\n&quot;</span>, extx2, mxstart, mxend, exty2, mystart, myend, extz2, mzstart, mzend);</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  <a class="code" href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a>(fout, <span class="stringliteral">&quot;%12.5E%12.5E%12.5E%12.5E%12.5E%12.5E\n&quot;</span>, extx2 * pwidth, exty2 * pwidth, extz2 * pwidth, 90.0, 90.0, 90.0);</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  <a class="code" href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a>(fout, <span class="stringliteral">&quot;ZYX\n&quot;</span>);</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  <span class="keywordflow">for</span> (indz = 0; indz &lt; extz2; indz++) {</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a>(fout, <span class="stringliteral">&quot;%8d\n&quot;</span>, indz);</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    count = 0;</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="keywordflow">for</span> (indy = 0; indy &lt; exty2; indy++) <span class="keywordflow">for</span> (indx = 0; indx &lt; extx2; indx++) {</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;        <span class="keywordflow">if</span> ((count + 1) % 6 == 0) <a class="code" href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a>(fout, <span class="stringliteral">&quot;%12.5E \n&quot;</span>, *(pphi2 + <a class="code" href="lib__vwk_8cpp.html#a8101287e9fd64ebd4bb0b666f0e16019">gidz_general</a>(indz, indy, indx, exty2, extx2)));</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;        <span class="keywordflow">else</span> <a class="code" href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a>(fout, <span class="stringliteral">&quot;%12.5E&quot;</span>, *(pphi2 + <a class="code" href="lib__vwk_8cpp.html#a8101287e9fd64ebd4bb0b666f0e16019">gidz_general</a>(indz, indy, indx, exty2, extx2)));</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        ++count;</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      }</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    <span class="keywordflow">if</span> ((count) % 6 != 0) <a class="code" href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a>(fout, <span class="stringliteral">&quot; \n&quot;</span>);</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  }</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  <a class="code" href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a>(fout, <span class="stringliteral">&quot;%8d\n&quot;</span>, -9999);</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  fclose(fout);</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  <span class="comment">/* print some info */</span></div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; X-PLOR map written to file %s \n&quot;</span>, vol_file);</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; X-PLOR map indexing (counting from 0): \n&quot;</span>);</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;       NA = %8d  (# of X intervals in unit cell) \n&quot;</span>, extx2);</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     AMIN = %8ld  (start index X) \n&quot;</span>, mxstart);</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     AMAX = %8ld  (end index X) \n&quot;</span>, mxend);</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;       NB = %8d  (# of Y intervals in unit cell) \n&quot;</span>, exty2);</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     BMIN = %8ld  (start index Y) \n&quot;</span>, mystart);</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     BMAX = %8ld  (end index Y) \n&quot;</span>, myend);</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;       NC = %8d  (# of Z intervals in unit cell) \n&quot;</span>, extz2);</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     CMIN = %8ld  (start index Z) \n&quot;</span>, mzstart);</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     CMAX = %8ld  (end index Z) \n&quot;</span>, mzend);</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt; X-PLOR unit cell (based on the extent of the input density map): \n&quot;</span>);</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;        A = %8.3f  (unit cell dimension) \n&quot;</span>, extx2 * pwidth);</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;        B = %8.3f  (unit cell dimension) \n&quot;</span>, exty2 * pwidth);</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;        C = %8.3f  (unit cell dimension) \n&quot;</span>, extz2 * pwidth);</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    ALPHA = %8.3f  (unit cell angle) \n&quot;</span>, 90.0);</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;     BETA = %8.3f  (unit cell angle) \n&quot;</span>, 90.0);</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  printf(<span class="stringliteral">&quot;lib_vio&gt;    GAMMA = %8.3f  (unit cell angle) \n&quot;</span>, 90.0);</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;}</div><div class="ttc" id="lib__vio_8cpp_html_a91c5b032bb0a4497df72b7bb71cbf1a7"><div class="ttname"><a href="lib__vio_8cpp.html#a91c5b032bb0a4497df72b7bb71cbf1a7">test_registration</a></div><div class="ttdeci">int test_registration(float origx, float origy, float origz, float width)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00917">lib_vio.cpp:917</a></div></div>
<div class="ttc" id="cuda__basic__math_8h_html_a2065eb145275f878c1d045c9f3fb1cc7"><div class="ttname"><a href="cuda__basic__math_8h.html#a2065eb145275f878c1d045c9f3fb1cc7">floor</a></div><div class="ttdeci">__host__ __device__ float2 floor(const float2 v)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__basic__math_8h_source.html#l00175">cuda_basic_math.h:175</a></div></div>
<div class="ttc" id="lib__vwk_8cpp_html_a8101287e9fd64ebd4bb0b666f0e16019"><div class="ttname"><a href="lib__vwk_8cpp.html#a8101287e9fd64ebd4bb0b666f0e16019">gidz_general</a></div><div class="ttdeci">unsigned long gidz_general(int k, int j, int i, unsigned ey, unsigned ex)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vwk_8cpp_source.html#l00032">lib_vwk.cpp:32</a></div></div>
<div class="ttc" id="lib__vwk_8cpp_html_a03f724ac8816bd2ad3640bfd4fbf439d"><div class="ttname"><a href="lib__vwk_8cpp.html#a03f724ac8816bd2ad3640bfd4fbf439d">interpolate_map</a></div><div class="ttdeci">void interpolate_map(double **outmap, unsigned *out_extx, unsigned *out_exty, unsigned *out_extz, double *out_origx, double *out_origy, double *out_origz, double out_widthx, double out_widthy, double out_widthz, double *inmap, unsigned in_extx, unsigned in_exty, unsigned in_extz, double in_origx, double in_origy, double in_origz, double in_widthx, double in_widthy, double in_widthz)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vwk_8cpp_source.html#l00082">lib_vwk.cpp:82</a></div></div>
<div class="ttc" id="lib__err_8cpp_html_ae76582a4cbab89aa99fcf38effea84e5"><div class="ttname"><a href="lib__err_8cpp.html#ae76582a4cbab89aa99fcf38effea84e5">error_open_filename</a></div><div class="ttdeci">void error_open_filename(int error_number, const char *program, char *argv)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00067">lib_err.cpp:67</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae453b7a848a8a559dee492de32116c99"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae453b7a848a8a559dee492de32116c99">fprintf</a></div><div class="ttdeci">fprintf(glob_prnt.io,&quot;\n&quot;)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad049ab70b26b408f32e0801a33c25c32"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void xplor_skip_to_number </td>
          <td>(</td>
          <td class="paramtype">FILE **&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="lib__vio_8cpp_source.html#l00327">327</a> of file <a class="el" href="lib__vio_8cpp_source.html">lib_vio.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;{</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="numerical__recipes_8cpp.html#ad604cff3eb5d475cdc9f8eb5ab570fee">done</a>, foundletter;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">for</span> (done = 0; done == 0;) { <span class="comment">/* read next line */</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">if</span> (fgets(*nextline, <a class="code" href="lib__vio_8cpp.html#a533bff314f05d9446d545c66fb899c8b">FLENGTH</a>, *fin) == NULL) {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <a class="code" href="lib__err_8cpp.html#a7f156754770910c52574fe319755a1f3">error_EOF</a>(70510, <span class="stringliteral">&quot;lib_vio&quot;</span>);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="lib__vio_8cpp.html#a533bff314f05d9446d545c66fb899c8b">FLENGTH</a>; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) </div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keywordflow">if</span> ((*(*nextline + i) == <span class="charliteral">&#39;!&#39;</span>) || (*(*nextline + i) == <span class="charliteral">&#39;\n&#39;</span>)) {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        *(*nextline + <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    foundletter = 0;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">for</span> (i = 0; * (*nextline + <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) != <span class="charliteral">&#39;\0&#39;</span>; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) { <span class="comment">/* check if it contains ABC FGHIJKLMNOPQRSTUVWXYZ (or lower case) */</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="keywordflow">if</span> (*(*nextline + i) &gt; 64 &amp;&amp; *(*nextline + <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt; 68) {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        foundletter = 1;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="keywordflow">if</span> (*(*nextline + i) &gt; 69 &amp;&amp; *(*nextline + <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt; 91) {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        foundletter = 1;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="keywordflow">if</span> (*(*nextline + i) &gt; 96 &amp;&amp; *(*nextline + <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt; 100) {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        foundletter = 1;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      }</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="keywordflow">if</span> (*(*nextline + i) &gt; 101 &amp;&amp; *(*nextline + <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt; 123) {</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        foundletter = 1;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      }</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    }</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">if</span> (foundletter == 0) <span class="keywordflow">for</span> (i = 0; * (*nextline + <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) != <span class="charliteral">&#39;\0&#39;</span>; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">if</span> (*(*nextline + i) &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; *(*nextline + <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;= <span class="charliteral">&#39;9&#39;</span>) {</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;          done = 1;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  }</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;}</div><div class="ttc" id="lib__err_8cpp_html_a7f156754770910c52574fe319755a1f3"><div class="ttname"><a href="lib__err_8cpp.html#a7f156754770910c52574fe319755a1f3">error_EOF</a></div><div class="ttdeci">void error_EOF(int error_number, const char *program)</div><div class="ttdef"><b>Definition:</b> <a href="lib__err_8cpp_source.html#l00101">lib_err.cpp:101</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad604cff3eb5d475cdc9f8eb5ab570fee"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad604cff3eb5d475cdc9f8eb5ab570fee">done</a></div><div class="ttdeci">done</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l07655">numerical_recipes.cpp:7655</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="lib__vio_8cpp_html_a533bff314f05d9446d545c66fb899c8b"><div class="ttname"><a href="lib__vio_8cpp.html#a533bff314f05d9446d545c66fb899c8b">FLENGTH</a></div><div class="ttdeci">#define FLENGTH</div><div class="ttdef"><b>Definition:</b> <a href="lib__vio_8cpp_source.html#l00022">lib_vio.cpp:22</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
