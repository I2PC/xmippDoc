<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Xmipp: POCSClass Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classPOCSClass-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">POCSClass Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for POCSClass:</div>
<div class="dyncontent">
<div class="center"><img src="classPOCSClass__coll__graph.png" border="0" usemap="#POCSClass_coll__map" alt="Collaboration graph"/></div>
<map name="POCSClass_coll__map" id="POCSClass_coll__map">
<area shape="rect" id="node2" href="classBasicARTParameters.html" title="BasicARTParameters" alt="" coords="1723,427,1872,453"/>
<area shape="rect" id="node3" href="structReconsInfo.html" title="ReconsInfo" alt="" coords="681,756,771,783"/>
<area shape="rect" id="node4" href="classMDRow.html" title="MDRow" alt="" coords="399,761,469,788"/>
<area shape="rect" id="node13" href="classImageBase.html" title="Image base class. " alt="" coords="682,559,770,585"/>
<area shape="rect" id="node5" href="classMDObject.html" title="MDObject" alt="" coords="171,761,252,788"/>
<area shape="rect" id="node6" href="unionObjectData.html" title="ObjectData" alt="" coords="5,761,93,788"/>
<area shape="rect" id="node7" href="classFileName.html" title="FileName" alt="" coords="172,577,251,604"/>
<area shape="rect" id="node15" href="structImageFHandler.html" title="ImageFHandler" alt="" coords="379,489,489,516"/>
<area shape="rect" id="node9" href="classMatrix2D.html" title="Matrix2D\&lt; double \&gt;" alt="" coords="1213,396,1351,423"/>
<area shape="rect" id="node10" href="classBasis.html" title="Basis" alt="" coords="1531,509,1586,536"/>
<area shape="rect" id="node22" href="classSymList.html" title="SymList" alt="" coords="1523,329,1594,356"/>
<area shape="rect" id="node11" href="classImageOver.html" title="ImageOver" alt="" coords="1239,569,1325,596"/>
<area shape="rect" id="node12" href="classImage.html" title="Image\&lt; double \&gt;" alt="" coords="996,560,1116,587"/>
<area shape="rect" id="node14" href="classMultidimArrayBase.html" title="MultidimArrayBase" alt="" coords="368,433,500,460"/>
<area shape="rect" id="node17" href="classMultidimArray.html" title="MultidimArray\&lt; double \&gt;" alt="" coords="644,445,808,472"/>
<area shape="rect" id="node20" href="classMultidimArray.html" title="MultidimArray\&lt; int \&gt;" alt="" coords="832,184,972,211"/>
<area shape="rect" id="node16" href="structArrayDim.html" title="ArrayDim" alt="" coords="395,540,473,567"/>
<area shape="rect" id="node18" href="structblobtype.html" title="blobtype" alt="" coords="1247,519,1317,545"/>
<area shape="rect" id="node19" href="classMatrix1D.html" title="Matrix1D\&lt; double \&gt;" alt="" coords="1213,636,1351,663"/>
<area shape="rect" id="node21" href="classGridVolumeT.html" title="GridVolumeT\&lt; int \&gt;" alt="" coords="1491,457,1627,484"/>
<area shape="rect" id="node23" href="classMatrix1D.html" title="Matrix1D\&lt; int \&gt;" alt="" coords="1225,283,1339,309"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:ac19e5506188442b77942f6b0831e6e5d"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5d">t_POCS_status</a> { <br />
&#160;&#160;<a class="el" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da58169edf9e0b88fcf44c510a3eee761a">POCS_measuring</a>, 
<a class="el" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da800f75faea201af058001dfa37f0812f">POCS_use</a>, 
<a class="el" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da6f79f6ab5ae216b1d7ed53d9156b0eb8">POCS_lowering</a>, 
<a class="el" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5dafc03fe9e94b77008426f4f3cfab94ae7">POCS_N_measure</a>, 
<br />
&#160;&#160;<a class="el" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da5de1131db109b490ef756dc8b1926075">POCS_N_use</a>
<br />
 }</td></tr>
<tr class="separator:ac19e5506188442b77942f6b0831e6e5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a74131aa55870fbb4b5e68528183d0510"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#a74131aa55870fbb4b5e68528183d0510">POCSClass</a> (<a class="el" href="classBasicARTParameters.html">BasicARTParameters</a> *_prm, int _Zoutput_volume_size, int _Youtput_volume_size, int _Xoutput_volume_size)</td></tr>
<tr class="memdesc:a74131aa55870fbb4b5e68528183d0510"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a74131aa55870fbb4b5e68528183d0510">More...</a><br /></td></tr>
<tr class="separator:a74131aa55870fbb4b5e68528183d0510"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a4445c7fd27fe251d6e87a8826b0b44"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#a9a4445c7fd27fe251d6e87a8826b0b44">newIteration</a> ()</td></tr>
<tr class="memdesc:a9a4445c7fd27fe251d6e87a8826b0b44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start New ART iteration.  <a href="#a9a4445c7fd27fe251d6e87a8826b0b44">More...</a><br /></td></tr>
<tr class="separator:a9a4445c7fd27fe251d6e87a8826b0b44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae047cd338c205cf1d00efb33b3f6bacb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#ae047cd338c205cf1d00efb33b3f6bacb">newProjection</a> ()</td></tr>
<tr class="memdesc:ae047cd338c205cf1d00efb33b3f6bacb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start new <a class="el" href="classProjection.html">Projection</a>.  <a href="#ae047cd338c205cf1d00efb33b3f6bacb">More...</a><br /></td></tr>
<tr class="separator:ae047cd338c205cf1d00efb33b3f6bacb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fcb60318673b535f767b1d7f6519619"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#a8fcb60318673b535f767b1d7f6519619">apply</a> (<a class="el" href="group__Grids.html#gae3eeb15b316a9800a7c35372dfd57460">GridVolume</a> &amp;vol_basis, int it, int images)</td></tr>
<tr class="memdesc:a8fcb60318673b535f767b1d7f6519619"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply.  <a href="#a8fcb60318673b535f767b1d7f6519619">More...</a><br /></td></tr>
<tr class="separator:a8fcb60318673b535f767b1d7f6519619"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ada1e8f6f527e85dc00749baef8d2163d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5d">t_POCS_status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#ada1e8f6f527e85dc00749baef8d2163d">POCS_state</a></td></tr>
<tr class="separator:ada1e8f6f527e85dc00749baef8d2163d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a92a40c401df6ace27fc56b8cddd6a7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#a7a92a40c401df6ace27fc56b8cddd6a7">POCS_avg</a></td></tr>
<tr class="separator:a7a92a40c401df6ace27fc56b8cddd6a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a259ae302d14c1ae1bb47d5b15451a5ba"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#a259ae302d14c1ae1bb47d5b15451a5ba">POCS_stddev</a></td></tr>
<tr class="separator:a259ae302d14c1ae1bb47d5b15451a5ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abefd1229f22187fe0d15d5a9f599f80d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#abefd1229f22187fe0d15d5a9f599f80d">POCS_min</a></td></tr>
<tr class="separator:abefd1229f22187fe0d15d5a9f599f80d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fb42b066a56507830b54f66a0e592e5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#a2fb42b066a56507830b54f66a0e592e5">POCS_max</a></td></tr>
<tr class="separator:a2fb42b066a56507830b54f66a0e592e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2db4f5e3ce6842a1b53e27a62974bbc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#ac2db4f5e3ce6842a1b53e27a62974bbc">POCS_mean_error</a></td></tr>
<tr class="separator:ac2db4f5e3ce6842a1b53e27a62974bbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5770149fd930324d690bf796a4c9cd95"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#a5770149fd930324d690bf796a4c9cd95">POCS_max_error</a></td></tr>
<tr class="separator:a5770149fd930324d690bf796a4c9cd95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc19a7b6e04a784704f70056e523484d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#adc19a7b6e04a784704f70056e523484d">POCS_global_mean_error</a></td></tr>
<tr class="separator:adc19a7b6e04a784704f70056e523484d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62ffae5a53218868ab198499fb555cfd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#a62ffae5a53218868ab198499fb555cfd">POCS_freq</a></td></tr>
<tr class="separator:a62ffae5a53218868ab198499fb555cfd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acce4fbabdaeee07a28e9ff0b9ca060e7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#acce4fbabdaeee07a28e9ff0b9ca060e7">POCS_i</a></td></tr>
<tr class="separator:acce4fbabdaeee07a28e9ff0b9ca060e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31d2b73819d0fb5a8e9fd0187220c83a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#a31d2b73819d0fb5a8e9fd0187220c83a">POCS_vec_i</a></td></tr>
<tr class="separator:a31d2b73819d0fb5a8e9fd0187220c83a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec07a4b6292c9feec0ddf1312c9b7e2a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#aec07a4b6292c9feec0ddf1312c9b7e2a">POCS_used</a></td></tr>
<tr class="separator:aec07a4b6292c9feec0ddf1312c9b7e2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd6cb3a9f882dc7b0bd7265b9550100e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#abd6cb3a9f882dc7b0bd7265b9550100e">POCS_N</a></td></tr>
<tr class="separator:abd6cb3a9f882dc7b0bd7265b9550100e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac43cc91155b27dd7a794c1fe2ba58dc9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#ac43cc91155b27dd7a794c1fe2ba58dc9">Zoutput_volume_size</a></td></tr>
<tr class="separator:ac43cc91155b27dd7a794c1fe2ba58dc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4df5a32e160f4bdf98cff5903cbe6e01"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#a4df5a32e160f4bdf98cff5903cbe6e01">Youtput_volume_size</a></td></tr>
<tr class="separator:a4df5a32e160f4bdf98cff5903cbe6e01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a457330b2e6f9628f650474fffb8b6581"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#a457330b2e6f9628f650474fffb8b6581">Xoutput_volume_size</a></td></tr>
<tr class="separator:a457330b2e6f9628f650474fffb8b6581"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99eb852d1fb46367e9880c00e04c89bb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#a99eb852d1fb46367e9880c00e04c89bb">apply_POCS</a></td></tr>
<tr class="separator:a99eb852d1fb46367e9880c00e04c89bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbe3c38bb89ddc3324aa79c5cd7dae6a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#adbe3c38bb89ddc3324aa79c5cd7dae6a">POCS_errors</a></td></tr>
<tr class="separator:adbe3c38bb89ddc3324aa79c5cd7dae6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc788a73b8842ccd221231025f438bff"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classBasicARTParameters.html">BasicARTParameters</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a></td></tr>
<tr class="separator:adc788a73b8842ccd221231025f438bff"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>POCS structure </p>

<p>Definition at line <a class="el" href="recons__misc_8h_source.html#l00110">110</a> of file <a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>.</p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="ac19e5506188442b77942f6b0831e6e5d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5d">POCSClass::t_POCS_status</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="ac19e5506188442b77942f6b0831e6e5da58169edf9e0b88fcf44c510a3eee761a"></a>POCS_measuring&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ac19e5506188442b77942f6b0831e6e5da800f75faea201af058001dfa37f0812f"></a>POCS_use&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ac19e5506188442b77942f6b0831e6e5da6f79f6ab5ae216b1d7ed53d9156b0eb8"></a>POCS_lowering&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ac19e5506188442b77942f6b0831e6e5dafc03fe9e94b77008426f4f3cfab94ae7"></a>POCS_N_measure&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ac19e5506188442b77942f6b0831e6e5da5de1131db109b490ef756dc8b1926075"></a>POCS_N_use&#160;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="recons__misc_8h_source.html#l00113">113</a> of file <a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                 {<a class="code" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da58169edf9e0b88fcf44c510a3eee761a">POCS_measuring</a>, <a class="code" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da800f75faea201af058001dfa37f0812f">POCS_use</a>, <a class="code" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da6f79f6ab5ae216b1d7ed53d9156b0eb8">POCS_lowering</a>, <a class="code" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5dafc03fe9e94b77008426f4f3cfab94ae7">POCS_N_measure</a>,</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                  <a class="code" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da5de1131db109b490ef756dc8b1926075">POCS_N_use</a>} <a class="code" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5d">t_POCS_status</a>;</div><div class="ttc" id="classPOCSClass_html_ac19e5506188442b77942f6b0831e6e5da800f75faea201af058001dfa37f0812f"><div class="ttname"><a href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da800f75faea201af058001dfa37f0812f">POCSClass::POCS_use</a></div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00113">recons_misc.h:113</a></div></div>
<div class="ttc" id="classPOCSClass_html_ac19e5506188442b77942f6b0831e6e5da6f79f6ab5ae216b1d7ed53d9156b0eb8"><div class="ttname"><a href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da6f79f6ab5ae216b1d7ed53d9156b0eb8">POCSClass::POCS_lowering</a></div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00113">recons_misc.h:113</a></div></div>
<div class="ttc" id="classPOCSClass_html_ac19e5506188442b77942f6b0831e6e5da58169edf9e0b88fcf44c510a3eee761a"><div class="ttname"><a href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da58169edf9e0b88fcf44c510a3eee761a">POCSClass::POCS_measuring</a></div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00113">recons_misc.h:113</a></div></div>
<div class="ttc" id="classPOCSClass_html_ac19e5506188442b77942f6b0831e6e5da5de1131db109b490ef756dc8b1926075"><div class="ttname"><a href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da5de1131db109b490ef756dc8b1926075">POCSClass::POCS_N_use</a></div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00114">recons_misc.h:114</a></div></div>
<div class="ttc" id="classPOCSClass_html_ac19e5506188442b77942f6b0831e6e5dafc03fe9e94b77008426f4f3cfab94ae7"><div class="ttname"><a href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5dafc03fe9e94b77008426f4f3cfab94ae7">POCSClass::POCS_N_measure</a></div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00113">recons_misc.h:113</a></div></div>
<div class="ttc" id="classPOCSClass_html_ac19e5506188442b77942f6b0831e6e5d"><div class="ttname"><a href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5d">POCSClass::t_POCS_status</a></div><div class="ttdeci">t_POCS_status</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00113">recons_misc.h:113</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a74131aa55870fbb4b5e68528183d0510"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">POCSClass::POCSClass </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBasicARTParameters.html">BasicARTParameters</a> *&#160;</td>
          <td class="paramname"><em>_prm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_Zoutput_volume_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_Youtput_volume_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_Xoutput_volume_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>

<p>Definition at line <a class="el" href="recons__misc_8cpp_source.html#l00692">692</a> of file <a class="el" href="recons__misc_8cpp_source.html">recons_misc.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;{</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a> = _prm;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <a class="code" href="classPOCSClass.html#ada1e8f6f527e85dc00749baef8d2163d">POCS_state</a> = <a class="code" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da58169edf9e0b88fcf44c510a3eee761a">POCS_measuring</a>;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <a class="code" href="classPOCSClass.html#a62ffae5a53218868ab198499fb555cfd">POCS_freq</a> = <a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#ga496489504335f4d309dc5bc4d11c2334">POCS_freq</a>;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <a class="code" href="classPOCSClass.html#acce4fbabdaeee07a28e9ff0b9ca060e7">POCS_i</a> = 0;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <a class="code" href="classPOCSClass.html#a31d2b73819d0fb5a8e9fd0187220c83a">POCS_vec_i</a> = 0;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <a class="code" href="classPOCSClass.html#aec07a4b6292c9feec0ddf1312c9b7e2a">POCS_used</a> = 0;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <a class="code" href="classPOCSClass.html#abd6cb3a9f882dc7b0bd7265b9550100e">POCS_N</a> = 0;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <a class="code" href="classPOCSClass.html#adbe3c38bb89ddc3324aa79c5cd7dae6a">POCS_errors</a>.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(<a class="code" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5dafc03fe9e94b77008426f4f3cfab94ae7">POCS_N_measure</a>);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <a class="code" href="classPOCSClass.html#ac43cc91155b27dd7a794c1fe2ba58dc9">Zoutput_volume_size</a> = _Zoutput_volume_size;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <a class="code" href="classPOCSClass.html#a4df5a32e160f4bdf98cff5903cbe6e01">Youtput_volume_size</a> = _Youtput_volume_size;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <a class="code" href="classPOCSClass.html#a457330b2e6f9628f650474fffb8b6581">Xoutput_volume_size</a> = _Xoutput_volume_size;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <a class="code" href="classPOCSClass.html#a99eb852d1fb46367e9880c00e04c89bb">apply_POCS</a> = (<a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#gac3d363bc6c8fd5a252578e819c4e2ad0">surface_mask</a> != NULL ||</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                  <a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#ga606a18405bff343b07e63d030945bece">positivity</a> || (<a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#ga04077e16909199aa5474dfaad844f51c">force_sym</a> != 0 &amp;&amp; !<a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#ga17ad569e5da6ecef719cbf04544501cb">is_crystal</a>) ||</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                  <a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#ga259f029f574034a2527cadf62aaccad4">known_volume</a> != -1);</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;}</div><div class="ttc" id="group__BasicART_html_ga17ad569e5da6ecef719cbf04544501cb"><div class="ttname"><a href="group__BasicART.html#ga17ad569e5da6ecef719cbf04544501cb">BasicARTParameters::is_crystal</a></div><div class="ttdeci">bool is_crystal</div><div class="ttdoc">Is this a crystal 0 means NO 1 YES. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00249">basic_art.h:249</a></div></div>
<div class="ttc" id="group__BasicART_html_ga606a18405bff343b07e63d030945bece"><div class="ttname"><a href="group__BasicART.html#ga606a18405bff343b07e63d030945bece">BasicARTParameters::positivity</a></div><div class="ttdeci">bool positivity</div><div class="ttdoc">Apply positivity constraint. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00243">basic_art.h:243</a></div></div>
<div class="ttc" id="classPOCSClass_html_a99eb852d1fb46367e9880c00e04c89bb"><div class="ttname"><a href="classPOCSClass.html#a99eb852d1fb46367e9880c00e04c89bb">POCSClass::apply_POCS</a></div><div class="ttdeci">bool apply_POCS</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00131">recons_misc.h:131</a></div></div>
<div class="ttc" id="classPOCSClass_html_a31d2b73819d0fb5a8e9fd0187220c83a"><div class="ttname"><a href="classPOCSClass.html#a31d2b73819d0fb5a8e9fd0187220c83a">POCSClass::POCS_vec_i</a></div><div class="ttdeci">int POCS_vec_i</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00125">recons_misc.h:125</a></div></div>
<div class="ttc" id="classPOCSClass_html_a4df5a32e160f4bdf98cff5903cbe6e01"><div class="ttname"><a href="classPOCSClass.html#a4df5a32e160f4bdf98cff5903cbe6e01">POCSClass::Youtput_volume_size</a></div><div class="ttdeci">int Youtput_volume_size</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00129">recons_misc.h:129</a></div></div>
<div class="ttc" id="group__BasicART_html_ga496489504335f4d309dc5bc4d11c2334"><div class="ttname"><a href="group__BasicART.html#ga496489504335f4d309dc5bc4d11c2334">BasicARTParameters::POCS_freq</a></div><div class="ttdeci">int POCS_freq</div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00373">basic_art.h:373</a></div></div>
<div class="ttc" id="classPOCSClass_html_ac19e5506188442b77942f6b0831e6e5da58169edf9e0b88fcf44c510a3eee761a"><div class="ttname"><a href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da58169edf9e0b88fcf44c510a3eee761a">POCSClass::POCS_measuring</a></div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00113">recons_misc.h:113</a></div></div>
<div class="ttc" id="classPOCSClass_html_acce4fbabdaeee07a28e9ff0b9ca060e7"><div class="ttname"><a href="classPOCSClass.html#acce4fbabdaeee07a28e9ff0b9ca060e7">POCSClass::POCS_i</a></div><div class="ttdeci">int POCS_i</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00124">recons_misc.h:124</a></div></div>
<div class="ttc" id="group__BasicART_html_ga259f029f574034a2527cadf62aaccad4"><div class="ttname"><a href="group__BasicART.html#ga259f029f574034a2527cadf62aaccad4">BasicARTParameters::known_volume</a></div><div class="ttdeci">double known_volume</div><div class="ttdoc">Known volume. If -1, not applied. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00223">basic_art.h:223</a></div></div>
<div class="ttc" id="classPOCSClass_html_a457330b2e6f9628f650474fffb8b6581"><div class="ttname"><a href="classPOCSClass.html#a457330b2e6f9628f650474fffb8b6581">POCSClass::Xoutput_volume_size</a></div><div class="ttdeci">int Xoutput_volume_size</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00130">recons_misc.h:130</a></div></div>
<div class="ttc" id="classPOCSClass_html_ac19e5506188442b77942f6b0831e6e5dafc03fe9e94b77008426f4f3cfab94ae7"><div class="ttname"><a href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5dafc03fe9e94b77008426f4f3cfab94ae7">POCSClass::POCS_N_measure</a></div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00113">recons_misc.h:113</a></div></div>
<div class="ttc" id="classPOCSClass_html_abd6cb3a9f882dc7b0bd7265b9550100e"><div class="ttname"><a href="classPOCSClass.html#abd6cb3a9f882dc7b0bd7265b9550100e">POCSClass::POCS_N</a></div><div class="ttdeci">int POCS_N</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00127">recons_misc.h:127</a></div></div>
<div class="ttc" id="group__BasicART_html_ga04077e16909199aa5474dfaad844f51c"><div class="ttname"><a href="group__BasicART.html#ga04077e16909199aa5474dfaad844f51c">BasicARTParameters::force_sym</a></div><div class="ttdeci">int force_sym</div><div class="ttdoc">Force the reconstruction to be symmetric this number of times. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00193">basic_art.h:193</a></div></div>
<div class="ttc" id="group__BasicART_html_gac3d363bc6c8fd5a252578e819c4e2ad0"><div class="ttname"><a href="group__BasicART.html#gac3d363bc6c8fd5a252578e819c4e2ad0">BasicARTParameters::surface_mask</a></div><div class="ttdeci">Image&lt; double &gt; * surface_mask</div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00368">basic_art.h:368</a></div></div>
<div class="ttc" id="classPOCSClass_html_a62ffae5a53218868ab198499fb555cfd"><div class="ttname"><a href="classPOCSClass.html#a62ffae5a53218868ab198499fb555cfd">POCSClass::POCS_freq</a></div><div class="ttdeci">int POCS_freq</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00123">recons_misc.h:123</a></div></div>
<div class="ttc" id="classPOCSClass_html_aec07a4b6292c9feec0ddf1312c9b7e2a"><div class="ttname"><a href="classPOCSClass.html#aec07a4b6292c9feec0ddf1312c9b7e2a">POCSClass::POCS_used</a></div><div class="ttdeci">int POCS_used</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00126">recons_misc.h:126</a></div></div>
<div class="ttc" id="classPOCSClass_html_ac43cc91155b27dd7a794c1fe2ba58dc9"><div class="ttname"><a href="classPOCSClass.html#ac43cc91155b27dd7a794c1fe2ba58dc9">POCSClass::Zoutput_volume_size</a></div><div class="ttdeci">int Zoutput_volume_size</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00128">recons_misc.h:128</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="classPOCSClass_html_adbe3c38bb89ddc3324aa79c5cd7dae6a"><div class="ttname"><a href="classPOCSClass.html#adbe3c38bb89ddc3324aa79c5cd7dae6a">POCSClass::POCS_errors</a></div><div class="ttdeci">MultidimArray&lt; double &gt; POCS_errors</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00132">recons_misc.h:132</a></div></div>
<div class="ttc" id="classPOCSClass_html_ada1e8f6f527e85dc00749baef8d2163d"><div class="ttname"><a href="classPOCSClass.html#ada1e8f6f527e85dc00749baef8d2163d">POCSClass::POCS_state</a></div><div class="ttdeci">t_POCS_status POCS_state</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00115">recons_misc.h:115</a></div></div>
<div class="ttc" id="classPOCSClass_html_adc788a73b8842ccd221231025f438bff"><div class="ttname"><a href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">POCSClass::prm</a></div><div class="ttdeci">BasicARTParameters * prm</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00133">recons_misc.h:133</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a8fcb60318673b535f767b1d7f6519619"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void POCSClass::apply </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__Grids.html#gae3eeb15b316a9800a7c35372dfd57460">GridVolume</a> &amp;&#160;</td>
          <td class="paramname"><em>vol_basis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>it</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>images</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply. </p>

<p>Definition at line <a class="el" href="recons__misc_8cpp_source.html#l00723">723</a> of file <a class="el" href="recons__misc_8cpp_source.html">recons_misc.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;{</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <a class="code" href="classImage.html">Image&lt;double&gt;</a> vol_POCS, theo_POCS_vol, corr_POCS_vol, vol_voxels;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPOCSClass.html#a99eb852d1fb46367e9880c00e04c89bb">apply_POCS</a> &amp;&amp; <a class="code" href="classPOCSClass.html#acce4fbabdaeee07a28e9ff0b9ca060e7">POCS_i</a> % <a class="code" href="classPOCSClass.html#a62ffae5a53218868ab198499fb555cfd">POCS_freq</a> == 0)</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    {</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <a class="code" href="classImage.html">Image&lt;double&gt;</a> vol_aux;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <a class="code" href="classImage.html">Image&lt;double&gt;</a> *desired_volume = NULL;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="comment">// Compute the corresponding voxel volume</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#ga5d853339de3e6d1a968d65e7022d60e4">basis</a>.<a class="code" href="classBasis.html#adf8caa010257862124a7fb990839feda">changeToVoxels</a>(vol_basis, &amp;(vol_voxels()),</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                                  <a class="code" href="classPOCSClass.html#ac43cc91155b27dd7a794c1fe2ba58dc9">Zoutput_volume_size</a>, <a class="code" href="classPOCSClass.html#a4df5a32e160f4bdf98cff5903cbe6e01">Youtput_volume_size</a>, <a class="code" href="classPOCSClass.html#a457330b2e6f9628f650474fffb8b6581">Xoutput_volume_size</a>);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#ga5e7c18851b65433f4ff41649d4613d96">tell</a>&amp;<a class="code" href="group__BasicART.html#ga56143776ecd2be9cbaa43617b0ec5632">TELL_SAVE_AT_EACH_STEP</a>)</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        {</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            vol_voxels.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;PPPvolPOCS0.vol&quot;</span>);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Stats PPPvolPOCS0.vol: &quot;</span>;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            vol_voxels().printStats();</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        }</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="comment">// Apply surface restriction</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#gac3d363bc6c8fd5a252578e819c4e2ad0">surface_mask</a> != NULL)</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        {</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            vol_POCS() = (*(<a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#gac3d363bc6c8fd5a252578e819c4e2ad0">surface_mask</a>))();</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        }</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        {</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            vol_POCS().resize(vol_voxels());</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            vol_POCS().initZeros();</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        }</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#ga5e7c18851b65433f4ff41649d4613d96">tell</a>&amp;<a class="code" href="group__BasicART.html#ga56143776ecd2be9cbaa43617b0ec5632">TELL_SAVE_AT_EACH_STEP</a>)</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        {</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            vol_POCS.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;PPPvolPOCS1.vol&quot;</span>);</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Stats PPPvolPOCS1.vol: &quot;</span>;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            vol_POCS().printStats();</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        }</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="comment">// Force symmetry</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#ga04077e16909199aa5474dfaad844f51c">force_sym</a> != 0)</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        {</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            <a class="code" href="group__SymmetrizeProgram.html#ga9db99fee28f237e077effca19999ac5b">symmetrizeVolume</a>(<a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#gab760d15cf5d83905d5f5d93f9878a4b7">SL</a>, vol_voxels(), vol_aux());</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            desired_volume = &amp;vol_aux;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#ga5e7c18851b65433f4ff41649d4613d96">tell</a>&amp;<a class="code" href="group__BasicART.html#ga56143776ecd2be9cbaa43617b0ec5632">TELL_SAVE_AT_EACH_STEP</a>)</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            {</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                vol_aux.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;PPPvolPOCS2.vol&quot;</span>);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;Stats PPPvolPOCS2.vol: &quot;</span>;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                vol_aux().printStats();</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            }</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        }</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="comment">// Apply volume constraint</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#ga259f029f574034a2527cadf62aaccad4">known_volume</a> != -1)</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        {</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            <a class="code" href="classHistogram1D.html">Histogram1D</a> hist;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            <a class="code" href="classMultidimArray.html">MultidimArray&lt;int&gt;</a> aux_mask;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            aux_mask.<a class="code" href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">resize</a>(vol_POCS());</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(aux_mask)</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            aux_mask(<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) = 1 - (<span class="keywordtype">int</span>)vol_POCS(k, i, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <span class="keywordtype">long</span> mask_voxels = vol_POCS().countThreshold(&quot;below&quot;, 0.5, 0);</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <a class="code" href="group__Masks.html#gad522883b557df4c83ab2e7dddb6d8d85">compute_hist_within_binary_mask</a>(</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                aux_mask, vol_voxels(), hist, 300);</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            <span class="keywordtype">double</span> known_percentage;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            known_percentage = <a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(100, 100 * <a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;known_volume / mask_voxels);</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="lib__vwk_8cpp.html#a2834b5125eb5ac411feb578af1fac2ea">threshold</a>;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            threshold = hist.percentil(100 - known_percentage);</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(vol_voxels())</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (vol_voxels(k, i, j) &lt; threshold)</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                vol_POCS(k, i, j) = 1;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        }</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (<a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;tell&amp;<a class="code" href="group__BasicART.html#ga56143776ecd2be9cbaa43617b0ec5632">TELL_SAVE_AT_EACH_STEP</a>)</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        {</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            vol_POCS.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;PPPvolPOCS3.vol&quot;</span>);</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Stats PPPvolPOCS3.vol: &quot;</span>;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            vol_POCS().printStats();</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        }</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <span class="comment">// Do not allow positivity outside interest region</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="comment">// and do not allow negativity inside the interest region</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <span class="comment">// if positivity restrictions are to be applied</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <span class="comment">// int bg = (int) vol_POCS().sum();</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <span class="comment">// int fg = MULTIDIM_SIZE(vol_POCS()) - bg;</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <span class="keywordtype">int</span> relax = 0, posi = 0;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <span class="keyword">const</span> <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;mVolVoxels=vol_voxels();</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <span class="keyword">const</span> <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;mVolPOCS=vol_POCS();</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga46aa4ed12bd8706cfe1456ec6a8ab768">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D</a>(mVolVoxels)</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (<a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(mVolPOCS,k, i, j) == 1 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(mVolVoxels,k, i, j) &lt; 0)</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        {</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(mVolPOCS,k, i, j) = 0;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            relax++;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        }</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(mVolPOCS,k, i, j) == 0 &amp;&amp; <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(mVolVoxels,k, i, j) &lt; 0 &amp;&amp; <a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#ga606a18405bff343b07e63d030945bece">positivity</a>)</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        {</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(mVolPOCS,k, i, j) = 1;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            posi++;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        }</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        <span class="comment">// Debugging messages</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="comment">//std::cout &lt;&lt; &quot;Relaxation/Positivity &quot; &lt;&lt; (double)relax/(double)bg &lt;&lt; &quot; &quot;</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <span class="comment">//     &lt;&lt; (double)posi/(double)fg &lt;&lt; &quot; &quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="comment">// Solve volumetric equations</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#ga5d853339de3e6d1a968d65e7022d60e4">basis</a>.<a class="code" href="classBasis.html#a12a694f7cef08beaf6f7d51b2837432c">type</a>)</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        {</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="classBasis.html#aa73185836d4dd144f8591d827d8f952ca5e21d65cbd3255eed09cafb1d2ad0143">Basis::blobs</a>:</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            <span class="keywordflow">if</span> (desired_volume == NULL)</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                <a class="code" href="group__Blobs.html#ga94823f436a57fc7e534e04d1829f47a5">ART_voxels2blobs_single_step</a>(vol_basis, &amp;vol_basis,</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                                             <a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#ga5d853339de3e6d1a968d65e7022d60e4">basis</a>.<a class="code" href="classBasis.html#a59d5c3860b78156b14a40e309294fb6d">blob</a>, <a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#gaa1fde1bea5b229e5675d1958862248fc">D</a>, <a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="classBasicARTParameters.html#a325ea7b23e75df626fc27d8de22258b2">lambda</a>(it),</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                                             &amp;(theo_POCS_vol()), NULL,</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                                             &amp;(corr_POCS_vol()),</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                                             &amp;(vol_POCS()),</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                                             <a class="code" href="classPOCSClass.html#ac2db4f5e3ce6842a1b53e27a62974bbc">POCS_mean_error</a>, <a class="code" href="classPOCSClass.html#a5770149fd930324d690bf796a4c9cd95">POCS_max_error</a>, <a class="code" href="group__Blobs.html#gae1a62943287cc2f243753d3a9d0dcd9d">VARTK</a>);</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            {</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(vol_POCS())</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (vol_POCS(k, i, j) == 1)</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                    (*desired_volume)(k, i, j) = 0;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                <a class="code" href="numerical__recipes_8cpp.html#aca6408d1d58d2334ecf5b80c3a9a8881">for</a> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;force_sym; i++)</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                {</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                    <a class="code" href="group__Blobs.html#ga94823f436a57fc7e534e04d1829f47a5">ART_voxels2blobs_single_step</a>(vol_basis, &amp;vol_basis,</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                                                 <a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#ga5d853339de3e6d1a968d65e7022d60e4">basis</a>.<a class="code" href="classBasis.html#a59d5c3860b78156b14a40e309294fb6d">blob</a>, <a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#gaa1fde1bea5b229e5675d1958862248fc">D</a>, <a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="classBasicARTParameters.html#a325ea7b23e75df626fc27d8de22258b2">lambda</a>(it),</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                                                 &amp;(theo_POCS_vol()), &amp;((*desired_volume)()),</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                                                 &amp;(corr_POCS_vol()),</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                                                 NULL,</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                                                 <a class="code" href="classPOCSClass.html#ac2db4f5e3ce6842a1b53e27a62974bbc">POCS_mean_error</a>, <a class="code" href="classPOCSClass.html#a5770149fd930324d690bf796a4c9cd95">POCS_max_error</a>, <a class="code" href="group__Blobs.html#gae1a62943287cc2f243753d3a9d0dcd9d">VARTK</a>);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#ga5e7c18851b65433f4ff41649d4613d96">tell</a>&amp;TELL_SAVE_AT_EACH_STEP)</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;    POCS Iteration &quot;</span> &lt;&lt; i</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; POCS Error=&quot;</span> &lt;&lt;  <a class="code" href="classPOCSClass.html#ac2db4f5e3ce6842a1b53e27a62974bbc">POCS_mean_error</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                }</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            }</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="classBasis.html#aa73185836d4dd144f8591d827d8f952ca4ae0f2a6cf6249b5a25ec78352325160">Basis::voxels</a>:</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            <span class="keywordflow">if</span> (desired_volume == NULL)</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            {</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>(vol_POCS())</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (vol_POCS(k, i, j))</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                    vol_basis(0)(k, i, j) = 0;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            }</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            <a class="code" href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            {</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                vol_basis(0)().initZeros();</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a>((*desired_volume)())</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                vol_basis(0)(k, i, j) = (*desired_volume)(k, i, j);</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            }</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            <a class="code" href="classPOCSClass.html#ac2db4f5e3ce6842a1b53e27a62974bbc">POCS_mean_error</a> = -1;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            break;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        default:</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa99ae519fb00e32cc6e716cc01d21cadf">ERR_ARG_INCORRECT</a>,&quot;This function cannot work with this basis&quot;);</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        }</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <a class="code" href="classPOCSClass.html#acce4fbabdaeee07a28e9ff0b9ca060e7">POCS_i</a> = 1;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        <a class="code" href="classPOCSClass.html#adc19a7b6e04a784704f70056e523484d">POCS_global_mean_error</a> += <a class="code" href="classPOCSClass.html#ac2db4f5e3ce6842a1b53e27a62974bbc">POCS_mean_error</a>;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <a class="code" href="classPOCSClass.html#abd6cb3a9f882dc7b0bd7265b9550100e">POCS_N</a>++;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="comment">// Now some control logic</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a> (<a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;numIMG - images &lt; 100 || images % 100 == 0 ||</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            desired_volume != NULL)</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        {</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            <a class="code" href="classPOCSClass.html#a62ffae5a53218868ab198499fb555cfd">POCS_freq</a> = 1;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            <a class="code" href="classPOCSClass.html#ada1e8f6f527e85dc00749baef8d2163d">POCS_state</a> = <a class="code" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da58169edf9e0b88fcf44c510a3eee761a">POCS_measuring</a>;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            <a class="code" href="classPOCSClass.html#a31d2b73819d0fb5a8e9fd0187220c83a">POCS_vec_i</a> = 0;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        }</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        {</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a>;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            <span class="keywordflow">switch</span> (<a class="code" href="classPOCSClass.html#ada1e8f6f527e85dc00749baef8d2163d">POCS_state</a>)</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            {</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da58169edf9e0b88fcf44c510a3eee761a">POCS_measuring</a>:</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="preprocessor">#ifdef DEBUG_POCS</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;M:&quot;</span> &lt;&lt; <a class="code" href="classPOCSClass.html#a31d2b73819d0fb5a8e9fd0187220c83a">POCS_vec_i</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classPOCSClass.html#ac2db4f5e3ce6842a1b53e27a62974bbc">POCS_mean_error</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                <a class="code" href="classPOCSClass.html#adbe3c38bb89ddc3324aa79c5cd7dae6a">POCS_errors</a>(<a class="code" href="classPOCSClass.html#a31d2b73819d0fb5a8e9fd0187220c83a">POCS_vec_i</a>++) = <a class="code" href="classPOCSClass.html#ac2db4f5e3ce6842a1b53e27a62974bbc">POCS_mean_error</a>;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classPOCSClass.html#a31d2b73819d0fb5a8e9fd0187220c83a">POCS_vec_i</a> == <a class="code" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5dafc03fe9e94b77008426f4f3cfab94ae7">POCS_N_measure</a>)</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                {</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                    <a class="code" href="classPOCSClass.html#a31d2b73819d0fb5a8e9fd0187220c83a">POCS_vec_i</a> = 0;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                    <span class="comment">// Change to use state</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                    <a class="code" href="classPOCSClass.html#aec07a4b6292c9feec0ddf1312c9b7e2a">POCS_used</a> = 0;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                    <a class="code" href="classPOCSClass.html#a62ffae5a53218868ab198499fb555cfd">POCS_freq</a>++;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                    <a class="code" href="classPOCSClass.html#ada1e8f6f527e85dc00749baef8d2163d">POCS_state</a> = <a class="code" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da800f75faea201af058001dfa37f0812f">POCS_use</a>;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="preprocessor">#ifdef DEBUG_POCS</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;1: Changing to &quot;</span> &lt;&lt; <a class="code" href="classPOCSClass.html#a62ffae5a53218868ab198499fb555cfd">POCS_freq</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                }</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da800f75faea201af058001dfa37f0812f">POCS_use</a>:</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                <a class="code" href="classPOCSClass.html#aec07a4b6292c9feec0ddf1312c9b7e2a">POCS_used</a>++;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                <a class="code" href="classPOCSClass.html#adbe3c38bb89ddc3324aa79c5cd7dae6a">POCS_errors</a>.<a class="code" href="classMultidimArray.html#ab648c97e18d063ce966db9c61b68f066">computeStats</a>(<a class="code" href="classPOCSClass.html#a7a92a40c401df6ace27fc56b8cddd6a7">POCS_avg</a>,</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                                         <a class="code" href="classPOCSClass.html#a259ae302d14c1ae1bb47d5b15451a5ba">POCS_stddev</a>, dummy, <a class="code" href="classPOCSClass.html#abefd1229f22187fe0d15d5a9f599f80d">POCS_min</a>);</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="preprocessor">#ifdef DEBUG_POCS</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;Reference errors: &quot;</span> &lt;&lt; <a class="code" href="classPOCSClass.html#adbe3c38bb89ddc3324aa79c5cd7dae6a">POCS_errors</a>.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;Checking &quot;</span> &lt;&lt; <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(<a class="code" href="classPOCSClass.html#ac2db4f5e3ce6842a1b53e27a62974bbc">POCS_mean_error</a> - <a class="code" href="classPOCSClass.html#a7a92a40c401df6ace27fc56b8cddd6a7">POCS_avg</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 1.2*1.96*<a class="code" href="classPOCSClass.html#a259ae302d14c1ae1bb47d5b15451a5ba">POCS_stddev</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(<a class="code" href="classPOCSClass.html#ac2db4f5e3ce6842a1b53e27a62974bbc">POCS_mean_error</a> - <a class="code" href="classPOCSClass.html#a7a92a40c401df6ace27fc56b8cddd6a7">POCS_avg</a>) &lt; 1.2*1.96*<a class="code" href="classPOCSClass.html#a259ae302d14c1ae1bb47d5b15451a5ba">POCS_stddev</a>)</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                {</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classPOCSClass.html#ac2db4f5e3ce6842a1b53e27a62974bbc">POCS_mean_error</a> &lt; <a class="code" href="classPOCSClass.html#a7a92a40c401df6ace27fc56b8cddd6a7">POCS_avg</a>)</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                    {</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                        <span class="keywordtype">double</span> max_error = <a class="code" href="classPOCSClass.html#adbe3c38bb89ddc3324aa79c5cd7dae6a">POCS_errors</a>(0);</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                        <a class="code" href="classPOCSClass.html#a31d2b73819d0fb5a8e9fd0187220c83a">POCS_vec_i</a> = 0;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5dafc03fe9e94b77008426f4f3cfab94ae7">POCS_N_measure</a>; i++)</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="classPOCSClass.html#adbe3c38bb89ddc3324aa79c5cd7dae6a">POCS_errors</a>(i) &gt; max_error)</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                            {</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                                max_error = <a class="code" href="classPOCSClass.html#adbe3c38bb89ddc3324aa79c5cd7dae6a">POCS_errors</a>(i);</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                                <a class="code" href="classPOCSClass.html#a31d2b73819d0fb5a8e9fd0187220c83a">POCS_vec_i</a> = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                            }</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                        <a class="code" href="classPOCSClass.html#adbe3c38bb89ddc3324aa79c5cd7dae6a">POCS_errors</a>(<a class="code" href="classPOCSClass.html#a31d2b73819d0fb5a8e9fd0187220c83a">POCS_vec_i</a>) = <a class="code" href="classPOCSClass.html#ac2db4f5e3ce6842a1b53e27a62974bbc">POCS_mean_error</a>;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                    }</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classPOCSClass.html#aec07a4b6292c9feec0ddf1312c9b7e2a">POCS_used</a> &lt; <a class="code" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da5de1131db109b490ef756dc8b1926075">POCS_N_use</a>)</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                    { <span class="comment">// While not enough uses</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                    }</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classPOCSClass.html#a62ffae5a53218868ab198499fb555cfd">POCS_freq</a> &lt; 3)</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                    { <span class="comment">// increase frequency</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                        <a class="code" href="classPOCSClass.html#a62ffae5a53218868ab198499fb555cfd">POCS_freq</a>++;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="preprocessor">#ifdef DEBUG_POCS</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;2: Changing to &quot;</span> &lt;&lt; <a class="code" href="classPOCSClass.html#a62ffae5a53218868ab198499fb555cfd">POCS_freq</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                        <a class="code" href="classPOCSClass.html#aec07a4b6292c9feec0ddf1312c9b7e2a">POCS_used</a> = 0;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                    }</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                }</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                {</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                    <span class="comment">// It is behaving worse</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classPOCSClass.html#a62ffae5a53218868ab198499fb555cfd">POCS_freq</a> &gt; <a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#ga496489504335f4d309dc5bc4d11c2334">POCS_freq</a> + 1)</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                    {</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                        <a class="code" href="classPOCSClass.html#a62ffae5a53218868ab198499fb555cfd">POCS_freq</a> = <a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#ga496489504335f4d309dc5bc4d11c2334">POCS_freq</a> + 1;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                        <a class="code" href="classPOCSClass.html#aec07a4b6292c9feec0ddf1312c9b7e2a">POCS_used</a> = 0;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="preprocessor">#ifdef DEBUG_POCS</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;3: Changing to &quot;</span> &lt;&lt; <a class="code" href="classPOCSClass.html#a62ffae5a53218868ab198499fb555cfd">POCS_freq</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                    }</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classPOCSClass.html#aec07a4b6292c9feec0ddf1312c9b7e2a">POCS_used</a> &gt; 2)</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                    {</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                        <a class="code" href="classPOCSClass.html#a62ffae5a53218868ab198499fb555cfd">POCS_freq</a> = <a class="code" href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">prm</a>-&gt;<a class="code" href="group__BasicART.html#ga496489504335f4d309dc5bc4d11c2334">POCS_freq</a>;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                        <span class="comment">// Change status</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                        <a class="code" href="classPOCSClass.html#aec07a4b6292c9feec0ddf1312c9b7e2a">POCS_used</a> = 0;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                        <a class="code" href="classPOCSClass.html#ada1e8f6f527e85dc00749baef8d2163d">POCS_state</a> = <a class="code" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da6f79f6ab5ae216b1d7ed53d9156b0eb8">POCS_lowering</a>;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="preprocessor">#ifdef DEBUG_POCS</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;Lowering\n&quot;</span>;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                    }</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                }</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da6f79f6ab5ae216b1d7ed53d9156b0eb8">POCS_lowering</a>:</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                <span class="comment">// Lower the POCS error before measuring again</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                <a class="code" href="classPOCSClass.html#adbe3c38bb89ddc3324aa79c5cd7dae6a">POCS_errors</a>.<a class="code" href="classMultidimArray.html#ab648c97e18d063ce966db9c61b68f066">computeStats</a>(<a class="code" href="classPOCSClass.html#a7a92a40c401df6ace27fc56b8cddd6a7">POCS_avg</a>,</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                                         <a class="code" href="classPOCSClass.html#a259ae302d14c1ae1bb47d5b15451a5ba">POCS_stddev</a>, <a class="code" href="classPOCSClass.html#a2fb42b066a56507830b54f66a0e592e5">POCS_max</a>, dummy);</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                <a class="code" href="classPOCSClass.html#aec07a4b6292c9feec0ddf1312c9b7e2a">POCS_used</a>++;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                <span class="keywordflow">if</span> (POCS_mean_error &lt; POCS_max || POCS_used &gt; 2*POCS_N_measure)</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                    <span class="comment">// Change status</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                    <a class="code" href="classPOCSClass.html#a31d2b73819d0fb5a8e9fd0187220c83a">POCS_vec_i</a> = 0;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                    <a class="code" href="classPOCSClass.html#ada1e8f6f527e85dc00749baef8d2163d">POCS_state</a> = <a class="code" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da58169edf9e0b88fcf44c510a3eee761a">POCS_measuring</a>;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                }</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            <span class="keywordflow">default</span>:</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa99ae519fb00e32cc6e716cc01d21cadf">ERR_ARG_INCORRECT</a>,<span class="stringliteral">&quot;Unknown equation mode&quot;</span>);</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            }</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        }</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    }</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    {</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        <a class="code" href="classPOCSClass.html#acce4fbabdaeee07a28e9ff0b9ca060e7">POCS_i</a>++;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <a class="code" href="classPOCSClass.html#ac2db4f5e3ce6842a1b53e27a62974bbc">POCS_mean_error</a> = -1;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    }</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_a0544c3fe466e421738dae463968b70ba"><div class="ttname"><a href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="ttdeci">else</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02919">numerical_recipes.cpp:2919</a></div></div>
<div class="ttc" id="group__BasicART_html_ga606a18405bff343b07e63d030945bece"><div class="ttname"><a href="group__BasicART.html#ga606a18405bff343b07e63d030945bece">BasicARTParameters::positivity</a></div><div class="ttdeci">bool positivity</div><div class="ttdoc">Apply positivity constraint. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00243">basic_art.h:243</a></div></div>
<div class="ttc" id="classPOCSClass_html_a7a92a40c401df6ace27fc56b8cddd6a7"><div class="ttname"><a href="classPOCSClass.html#a7a92a40c401df6ace27fc56b8cddd6a7">POCSClass::POCS_avg</a></div><div class="ttdeci">double POCS_avg</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00116">recons_misc.h:116</a></div></div>
<div class="ttc" id="classMultidimArray_html_a048fe82e79de7fba796cd4e87869ef36"><div class="ttname"><a href="classMultidimArray.html#a048fe82e79de7fba796cd4e87869ef36">MultidimArray::resize</a></div><div class="ttdeci">void resize(size_t Ndim, size_t Zdim, size_t Ydim, size_t Xdim, bool copy=true)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01562">multidim_array.h:1562</a></div></div>
<div class="ttc" id="classPOCSClass_html_a99eb852d1fb46367e9880c00e04c89bb"><div class="ttname"><a href="classPOCSClass.html#a99eb852d1fb46367e9880c00e04c89bb">POCSClass::apply_POCS</a></div><div class="ttdeci">bool apply_POCS</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00131">recons_misc.h:131</a></div></div>
<div class="ttc" id="classPOCSClass_html_a5770149fd930324d690bf796a4c9cd95"><div class="ttname"><a href="classPOCSClass.html#a5770149fd930324d690bf796a4c9cd95">POCSClass::POCS_max_error</a></div><div class="ttdeci">double POCS_max_error</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00121">recons_misc.h:121</a></div></div>
<div class="ttc" id="group__BasicART_html_ga5d853339de3e6d1a968d65e7022d60e4"><div class="ttname"><a href="group__BasicART.html#ga5d853339de3e6d1a968d65e7022d60e4">BasicARTParameters::basis</a></div><div class="ttdeci">Basis basis</div><div class="ttdoc">Basis function. By default, blobs. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00094">basic_art.h:94</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; int &gt;</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga59e8ee30d3dbdb3b5c5460c86612e7a4"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga59e8ee30d3dbdb3b5c5460c86612e7a4">FOR_ALL_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00279">multidim_array.h:279</a></div></div>
<div class="ttc" id="classPOCSClass_html_ac19e5506188442b77942f6b0831e6e5da800f75faea201af058001dfa37f0812f"><div class="ttname"><a href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da800f75faea201af058001dfa37f0812f">POCSClass::POCS_use</a></div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00113">recons_misc.h:113</a></div></div>
<div class="ttc" id="classPOCSClass_html_abefd1229f22187fe0d15d5a9f599f80d"><div class="ttname"><a href="classPOCSClass.html#abefd1229f22187fe0d15d5a9f599f80d">POCSClass::POCS_min</a></div><div class="ttdeci">double POCS_min</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00118">recons_misc.h:118</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="classBasis_html_aa73185836d4dd144f8591d827d8f952ca5e21d65cbd3255eed09cafb1d2ad0143"><div class="ttname"><a href="classBasis.html#aa73185836d4dd144f8591d827d8f952ca5e21d65cbd3255eed09cafb1d2ad0143">Basis::blobs</a></div><div class="ttdef"><b>Definition:</b> <a href="basis_8h_source.html#l00049">basis.h:49</a></div></div>
<div class="ttc" id="classPOCSClass_html_adc19a7b6e04a784704f70056e523484d"><div class="ttname"><a href="classPOCSClass.html#adc19a7b6e04a784704f70056e523484d">POCSClass::POCS_global_mean_error</a></div><div class="ttdeci">double POCS_global_mean_error</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00122">recons_misc.h:122</a></div></div>
<div class="ttc" id="classPOCSClass_html_ac2db4f5e3ce6842a1b53e27a62974bbc"><div class="ttname"><a href="classPOCSClass.html#ac2db4f5e3ce6842a1b53e27a62974bbc">POCSClass::POCS_mean_error</a></div><div class="ttdeci">double POCS_mean_error</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00120">recons_misc.h:120</a></div></div>
<div class="ttc" id="group__BasicART_html_gaa1fde1bea5b229e5675d1958862248fc"><div class="ttname"><a href="group__BasicART.html#gaa1fde1bea5b229e5675d1958862248fc">BasicARTParameters::D</a></div><div class="ttdeci">Matrix2D&lt; double &gt; * D</div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00362">basic_art.h:362</a></div></div>
<div class="ttc" id="classPOCSClass_html_a31d2b73819d0fb5a8e9fd0187220c83a"><div class="ttname"><a href="classPOCSClass.html#a31d2b73819d0fb5a8e9fd0187220c83a">POCSClass::POCS_vec_i</a></div><div class="ttdeci">int POCS_vec_i</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00125">recons_misc.h:125</a></div></div>
<div class="ttc" id="group__Blobs_html_ga94823f436a57fc7e534e04d1829f47a5"><div class="ttname"><a href="group__Blobs.html#ga94823f436a57fc7e534e04d1829f47a5">ART_voxels2blobs_single_step</a></div><div class="ttdeci">void ART_voxels2blobs_single_step(GridVolume &amp;vol_in, GridVolume *vol_out, const struct blobtype &amp;blob, const Matrix2D&lt; double &gt; *D, double lambda, MultidimArray&lt; double &gt; *theo_vol, const MultidimArray&lt; double &gt; *read_vol, MultidimArray&lt; double &gt; *corr_vol, const MultidimArray&lt; double &gt; *mask_vol, double &amp;mean_error, double &amp;max_error, int eq_mode, int threads)</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8cpp_source.html#l01074">blobs.cpp:1074</a></div></div>
<div class="ttc" id="group__BasicART_html_ga5e7c18851b65433f4ff41649d4613d96"><div class="ttname"><a href="group__BasicART.html#ga5e7c18851b65433f4ff41649d4613d96">BasicARTParameters::tell</a></div><div class="ttdeci">int tell</div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00308">basic_art.h:308</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gacac7be97c37bd2e4f801976749de839c"><div class="ttname"><a href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a></div><div class="ttdeci">#define DIRECT_A3D_ELEM(v, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00249">multidim_array.h:249</a></div></div>
<div class="ttc" id="classPOCSClass_html_a4df5a32e160f4bdf98cff5903cbe6e01"><div class="ttname"><a href="classPOCSClass.html#a4df5a32e160f4bdf98cff5903cbe6e01">POCSClass::Youtput_volume_size</a></div><div class="ttdeci">int Youtput_volume_size</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00129">recons_misc.h:129</a></div></div>
<div class="ttc" id="classImageBase_html_ae81a8c11a832924c2bda0909882c3168"><div class="ttname"><a href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">ImageBase::write</a></div><div class="ttdeci">void write(const FileName &amp;name=&quot;&quot;, size_t select_img=ALL_IMAGES, bool isStack=false, int mode=WRITE_OVERWRITE, CastWriteMode castMode=CW_CAST, int _swapWrite=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00210">xmipp_image_base.cpp:210</a></div></div>
<div class="ttc" id="group__BasicART_html_ga496489504335f4d309dc5bc4d11c2334"><div class="ttname"><a href="group__BasicART.html#ga496489504335f4d309dc5bc4d11c2334">BasicARTParameters::POCS_freq</a></div><div class="ttdeci">int POCS_freq</div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00373">basic_art.h:373</a></div></div>
<div class="ttc" id="classPOCSClass_html_ac19e5506188442b77942f6b0831e6e5da6f79f6ab5ae216b1d7ed53d9156b0eb8"><div class="ttname"><a href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da6f79f6ab5ae216b1d7ed53d9156b0eb8">POCSClass::POCS_lowering</a></div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00113">recons_misc.h:113</a></div></div>
<div class="ttc" id="classHistogram1D_html"><div class="ttname"><a href="classHistogram1D.html">Histogram1D</a></div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00121">histogram.h:121</a></div></div>
<div class="ttc" id="classBasis_html_a59d5c3860b78156b14a40e309294fb6d"><div class="ttname"><a href="classBasis.html#a59d5c3860b78156b14a40e309294fb6d">Basis::blob</a></div><div class="ttdeci">struct blobtype blob</div><div class="ttdoc">Blob parameters. </div><div class="ttdef"><b>Definition:</b> <a href="basis_8h_source.html#l00061">basis.h:61</a></div></div>
<div class="ttc" id="classPOCSClass_html_ac19e5506188442b77942f6b0831e6e5da58169edf9e0b88fcf44c510a3eee761a"><div class="ttname"><a href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da58169edf9e0b88fcf44c510a3eee761a">POCSClass::POCS_measuring</a></div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00113">recons_misc.h:113</a></div></div>
<div class="ttc" id="classBasis_html_a12a694f7cef08beaf6f7d51b2837432c"><div class="ttname"><a href="classBasis.html#a12a694f7cef08beaf6f7d51b2837432c">Basis::type</a></div><div class="ttdeci">tBasisFunction type</div><div class="ttdoc">Basis function to use. </div><div class="ttdef"><b>Definition:</b> <a href="basis_8h_source.html#l00052">basis.h:52</a></div></div>
<div class="ttc" id="classPOCSClass_html_acce4fbabdaeee07a28e9ff0b9ca060e7"><div class="ttname"><a href="classPOCSClass.html#acce4fbabdaeee07a28e9ff0b9ca060e7">POCSClass::POCS_i</a></div><div class="ttdeci">int POCS_i</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00124">recons_misc.h:124</a></div></div>
<div class="ttc" id="classPOCSClass_html_ac19e5506188442b77942f6b0831e6e5da5de1131db109b490ef756dc8b1926075"><div class="ttname"><a href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5da5de1131db109b490ef756dc8b1926075">POCSClass::POCS_N_use</a></div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00114">recons_misc.h:114</a></div></div>
<div class="ttc" id="classMultidimArray_html_ab648c97e18d063ce966db9c61b68f066"><div class="ttname"><a href="classMultidimArray.html#ab648c97e18d063ce966db9c61b68f066">MultidimArray::computeStats</a></div><div class="ttdeci">void computeStats(double &amp;avg, double &amp;stddev, T &amp;minval, T &amp;maxval) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03377">multidim_array.h:3377</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Blobs_html_gae1a62943287cc2f243753d3a9d0dcd9d"><div class="ttname"><a href="group__Blobs.html#gae1a62943287cc2f243753d3a9d0dcd9d">VARTK</a></div><div class="ttdeci">#define VARTK</div><div class="ttdef"><b>Definition:</b> <a href="blobs_8h_source.html#l00379">blobs.h:379</a></div></div>
<div class="ttc" id="lib__vwk_8cpp_html_a2834b5125eb5ac411feb578af1fac2ea"><div class="ttname"><a href="lib__vwk_8cpp.html#a2834b5125eb5ac411feb578af1fac2ea">threshold</a></div><div class="ttdeci">void threshold(double *phi, unsigned long nvox, double limit)</div><div class="ttdef"><b>Definition:</b> <a href="lib__vwk_8cpp_source.html#l00524">lib_vwk.cpp:524</a></div></div>
<div class="ttc" id="group__BasicART_html_ga259f029f574034a2527cadf62aaccad4"><div class="ttname"><a href="group__BasicART.html#ga259f029f574034a2527cadf62aaccad4">BasicARTParameters::known_volume</a></div><div class="ttdeci">double known_volume</div><div class="ttdoc">Known volume. If -1, not applied. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00223">basic_art.h:223</a></div></div>
<div class="ttc" id="classBasis_html_adf8caa010257862124a7fb990839feda"><div class="ttname"><a href="classBasis.html#adf8caa010257862124a7fb990839feda">Basis::changeToVoxels</a></div><div class="ttdeci">void changeToVoxels(GridVolume &amp;vol_basis, MultidimArray&lt; double &gt; *vol_voxels, int Zdim, int Ydim, int Xdim, int threads=1) const </div><div class="ttdef"><b>Definition:</b> <a href="basis_8cpp_source.html#l00261">basis.cpp:261</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga46aa4ed12bd8706cfe1456ec6a8ab768"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga46aa4ed12bd8706cfe1456ec6a8ab768">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00332">multidim_array.h:332</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa99ae519fb00e32cc6e716cc01d21cadf"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa99ae519fb00e32cc6e716cc01d21cadf">ERR_ARG_INCORRECT</a></div><div class="ttdoc">Incorrect argument received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00118">xmipp_error.h:118</a></div></div>
<div class="ttc" id="classPOCSClass_html_a457330b2e6f9628f650474fffb8b6581"><div class="ttname"><a href="classPOCSClass.html#a457330b2e6f9628f650474fffb8b6581">POCSClass::Xoutput_volume_size</a></div><div class="ttdeci">int Xoutput_volume_size</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00130">recons_misc.h:130</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad03d014386c050f947b2903e44f3b383"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad03d014386c050f947b2903e44f3b383">dummy</a></div><div class="ttdeci">double dummy</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04652">numerical_recipes.cpp:4652</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca6408d1d58d2334ecf5b80c3a9a8881"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca6408d1d58d2334ecf5b80c3a9a8881">for</a></div><div class="ttdeci">for(j=1;j&lt;=i__1;++j)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02327">numerical_recipes.cpp:2327</a></div></div>
<div class="ttc" id="classPOCSClass_html_ac19e5506188442b77942f6b0831e6e5dafc03fe9e94b77008426f4f3cfab94ae7"><div class="ttname"><a href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5dafc03fe9e94b77008426f4f3cfab94ae7">POCSClass::POCS_N_measure</a></div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00113">recons_misc.h:113</a></div></div>
<div class="ttc" id="group__Macros_html_gac9ae6a207f10c821b06a8c0df153a7d5"><div class="ttname"><a href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a></div><div class="ttdeci">#define XMIPP_MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00181">xmipp_macros.h:181</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classPOCSClass_html_abd6cb3a9f882dc7b0bd7265b9550100e"><div class="ttname"><a href="classPOCSClass.html#abd6cb3a9f882dc7b0bd7265b9550100e">POCSClass::POCS_N</a></div><div class="ttdeci">int POCS_N</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00127">recons_misc.h:127</a></div></div>
<div class="ttc" id="group__BasicART_html_ga04077e16909199aa5474dfaad844f51c"><div class="ttname"><a href="group__BasicART.html#ga04077e16909199aa5474dfaad844f51c">BasicARTParameters::force_sym</a></div><div class="ttdeci">int force_sym</div><div class="ttdoc">Force the reconstruction to be symmetric this number of times. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00193">basic_art.h:193</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classPOCSClass_html_a2fb42b066a56507830b54f66a0e592e5"><div class="ttname"><a href="classPOCSClass.html#a2fb42b066a56507830b54f66a0e592e5">POCSClass::POCS_max</a></div><div class="ttdeci">double POCS_max</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00119">recons_misc.h:119</a></div></div>
<div class="ttc" id="group__BasicART_html_ga56143776ecd2be9cbaa43617b0ec5632"><div class="ttname"><a href="group__BasicART.html#ga56143776ecd2be9cbaa43617b0ec5632">TELL_SAVE_AT_EACH_STEP</a></div><div class="ttdeci">#define TELL_SAVE_AT_EACH_STEP</div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00271">basic_art.h:271</a></div></div>
<div class="ttc" id="group__BasicART_html_gac3d363bc6c8fd5a252578e819c4e2ad0"><div class="ttname"><a href="group__BasicART.html#gac3d363bc6c8fd5a252578e819c4e2ad0">BasicARTParameters::surface_mask</a></div><div class="ttdeci">Image&lt; double &gt; * surface_mask</div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00368">basic_art.h:368</a></div></div>
<div class="ttc" id="classPOCSClass_html_a259ae302d14c1ae1bb47d5b15451a5ba"><div class="ttname"><a href="classPOCSClass.html#a259ae302d14c1ae1bb47d5b15451a5ba">POCSClass::POCS_stddev</a></div><div class="ttdeci">double POCS_stddev</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00117">recons_misc.h:117</a></div></div>
<div class="ttc" id="classPOCSClass_html_a62ffae5a53218868ab198499fb555cfd"><div class="ttname"><a href="classPOCSClass.html#a62ffae5a53218868ab198499fb555cfd">POCSClass::POCS_freq</a></div><div class="ttdeci">int POCS_freq</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00123">recons_misc.h:123</a></div></div>
<div class="ttc" id="classPOCSClass_html_aec07a4b6292c9feec0ddf1312c9b7e2a"><div class="ttname"><a href="classPOCSClass.html#aec07a4b6292c9feec0ddf1312c9b7e2a">POCSClass::POCS_used</a></div><div class="ttdeci">int POCS_used</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00126">recons_misc.h:126</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="group__SymmetrizeProgram_html_ga9db99fee28f237e077effca19999ac5b"><div class="ttname"><a href="group__SymmetrizeProgram.html#ga9db99fee28f237e077effca19999ac5b">symmetrizeVolume</a></div><div class="ttdeci">void symmetrizeVolume(const SymList &amp;SL, const MultidimArray&lt; double &gt; &amp;V_in, MultidimArray&lt; double &gt; &amp;V_out, int spline, bool wrap, bool do_outside_avg, bool sum, bool helical, bool dihedral, bool helicalDihedral, double rotHelical, double rotPhaseHelical, double zHelical, double heightFraction, const MultidimArray&lt; double &gt; *mask)</div><div class="ttdef"><b>Definition:</b> <a href="symmetrize_8cpp_source.html#l00110">symmetrize.cpp:110</a></div></div>
<div class="ttc" id="classPOCSClass_html_ac43cc91155b27dd7a794c1fe2ba58dc9"><div class="ttname"><a href="classPOCSClass.html#ac43cc91155b27dd7a794c1fe2ba58dc9">POCSClass::Zoutput_volume_size</a></div><div class="ttdeci">int Zoutput_volume_size</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00128">recons_misc.h:128</a></div></div>
<div class="ttc" id="classBasicARTParameters_html_a325ea7b23e75df626fc27d8de22258b2"><div class="ttname"><a href="classBasicARTParameters.html#a325ea7b23e75df626fc27d8de22258b2">BasicARTParameters::lambda</a></div><div class="ttdeci">double lambda(int n)</div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00430">basic_art.h:430</a></div></div>
<div class="ttc" id="classPOCSClass_html_adbe3c38bb89ddc3324aa79c5cd7dae6a"><div class="ttname"><a href="classPOCSClass.html#adbe3c38bb89ddc3324aa79c5cd7dae6a">POCSClass::POCS_errors</a></div><div class="ttdeci">MultidimArray&lt; double &gt; POCS_errors</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00132">recons_misc.h:132</a></div></div>
<div class="ttc" id="group__Masks_html_gad522883b557df4c83ab2e7dddb6d8d85"><div class="ttname"><a href="group__Masks.html#gad522883b557df4c83ab2e7dddb6d8d85">compute_hist_within_binary_mask</a></div><div class="ttdeci">void compute_hist_within_binary_mask(const MultidimArray&lt; int &gt; &amp;mask, MultidimArray&lt; T &gt; &amp;v, Histogram1D &amp;hist, int no_steps)</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00911">mask.h:911</a></div></div>
<div class="ttc" id="classBasis_html_aa73185836d4dd144f8591d827d8f952ca4ae0f2a6cf6249b5a25ec78352325160"><div class="ttname"><a href="classBasis.html#aa73185836d4dd144f8591d827d8f952ca4ae0f2a6cf6249b5a25ec78352325160">Basis::voxels</a></div><div class="ttdef"><b>Definition:</b> <a href="basis_8h_source.html#l00049">basis.h:49</a></div></div>
<div class="ttc" id="classPOCSClass_html_ada1e8f6f527e85dc00749baef8d2163d"><div class="ttname"><a href="classPOCSClass.html#ada1e8f6f527e85dc00749baef8d2163d">POCSClass::POCS_state</a></div><div class="ttdeci">t_POCS_status POCS_state</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00115">recons_misc.h:115</a></div></div>
<div class="ttc" id="classPOCSClass_html_adc788a73b8842ccd221231025f438bff"><div class="ttname"><a href="classPOCSClass.html#adc788a73b8842ccd221231025f438bff">POCSClass::prm</a></div><div class="ttdeci">BasicARTParameters * prm</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00133">recons_misc.h:133</a></div></div>
<div class="ttc" id="group__BasicART_html_gab760d15cf5d83905d5f5d93f9878a4b7"><div class="ttname"><a href="group__BasicART.html#gab760d15cf5d83905d5f5d93f9878a4b7">BasicARTParameters::SL</a></div><div class="ttdeci">SymList SL</div><div class="ttdoc">A list with the symmetry matrices. </div><div class="ttdef"><b>Definition:</b> <a href="basic__art_8h_source.html#l00327">basic_art.h:327</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aba441ebef6931295ba1cb63e2cca89a8"><div class="ttname"><a href="numerical__recipes_8cpp.html#aba441ebef6931295ba1cb63e2cca89a8">if</a></div><div class="ttdeci">if(fabs(c[*nmax+*nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02296">numerical_recipes.cpp:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9a4445c7fd27fe251d6e87a8826b0b44"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void POCSClass::newIteration </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start New ART iteration. </p>

<p>Definition at line <a class="el" href="recons__misc_8cpp_source.html#l00712">712</a> of file <a class="el" href="recons__misc_8cpp_source.html">recons_misc.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;{</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <a class="code" href="classPOCSClass.html#adc19a7b6e04a784704f70056e523484d">POCS_global_mean_error</a> = 0;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;}</div><div class="ttc" id="classPOCSClass_html_adc19a7b6e04a784704f70056e523484d"><div class="ttname"><a href="classPOCSClass.html#adc19a7b6e04a784704f70056e523484d">POCSClass::POCS_global_mean_error</a></div><div class="ttdeci">double POCS_global_mean_error</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00122">recons_misc.h:122</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae047cd338c205cf1d00efb33b3f6bacb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void POCSClass::newProjection </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start new <a class="el" href="classProjection.html">Projection</a>. </p>

<p>Definition at line <a class="el" href="recons__misc_8cpp_source.html#l00717">717</a> of file <a class="el" href="recons__misc_8cpp_source.html">recons_misc.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;{</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <a class="code" href="classPOCSClass.html#abd6cb3a9f882dc7b0bd7265b9550100e">POCS_N</a> = 0;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;}</div><div class="ttc" id="classPOCSClass_html_abd6cb3a9f882dc7b0bd7265b9550100e"><div class="ttname"><a href="classPOCSClass.html#abd6cb3a9f882dc7b0bd7265b9550100e">POCSClass::POCS_N</a></div><div class="ttdeci">int POCS_N</div><div class="ttdef"><b>Definition:</b> <a href="recons__misc_8h_source.html#l00127">recons_misc.h:127</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a99eb852d1fb46367e9880c00e04c89bb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool POCSClass::apply_POCS</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="recons__misc_8h_source.html#l00131">131</a> of file <a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7a92a40c401df6ace27fc56b8cddd6a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double POCSClass::POCS_avg</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="recons__misc_8h_source.html#l00116">116</a> of file <a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>.</p>

</div>
</div>
<a class="anchor" id="adbe3c38bb89ddc3324aa79c5cd7dae6a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt;double&gt; POCSClass::POCS_errors</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="recons__misc_8h_source.html#l00132">132</a> of file <a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>.</p>

</div>
</div>
<a class="anchor" id="a62ffae5a53218868ab198499fb555cfd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int POCSClass::POCS_freq</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="recons__misc_8h_source.html#l00123">123</a> of file <a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>.</p>

</div>
</div>
<a class="anchor" id="adc19a7b6e04a784704f70056e523484d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double POCSClass::POCS_global_mean_error</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="recons__misc_8h_source.html#l00122">122</a> of file <a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>.</p>

</div>
</div>
<a class="anchor" id="acce4fbabdaeee07a28e9ff0b9ca060e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int POCSClass::POCS_i</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="recons__misc_8h_source.html#l00124">124</a> of file <a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2fb42b066a56507830b54f66a0e592e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double POCSClass::POCS_max</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="recons__misc_8h_source.html#l00119">119</a> of file <a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5770149fd930324d690bf796a4c9cd95"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double POCSClass::POCS_max_error</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="recons__misc_8h_source.html#l00121">121</a> of file <a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac2db4f5e3ce6842a1b53e27a62974bbc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double POCSClass::POCS_mean_error</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="recons__misc_8h_source.html#l00120">120</a> of file <a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>.</p>

</div>
</div>
<a class="anchor" id="abefd1229f22187fe0d15d5a9f599f80d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double POCSClass::POCS_min</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="recons__misc_8h_source.html#l00118">118</a> of file <a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>.</p>

</div>
</div>
<a class="anchor" id="abd6cb3a9f882dc7b0bd7265b9550100e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int POCSClass::POCS_N</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="recons__misc_8h_source.html#l00127">127</a> of file <a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>.</p>

</div>
</div>
<a class="anchor" id="ada1e8f6f527e85dc00749baef8d2163d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPOCSClass.html#ac19e5506188442b77942f6b0831e6e5d">t_POCS_status</a> POCSClass::POCS_state</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="recons__misc_8h_source.html#l00115">115</a> of file <a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>.</p>

</div>
</div>
<a class="anchor" id="a259ae302d14c1ae1bb47d5b15451a5ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double POCSClass::POCS_stddev</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="recons__misc_8h_source.html#l00117">117</a> of file <a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>.</p>

</div>
</div>
<a class="anchor" id="aec07a4b6292c9feec0ddf1312c9b7e2a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int POCSClass::POCS_used</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="recons__misc_8h_source.html#l00126">126</a> of file <a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>.</p>

</div>
</div>
<a class="anchor" id="a31d2b73819d0fb5a8e9fd0187220c83a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int POCSClass::POCS_vec_i</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="recons__misc_8h_source.html#l00125">125</a> of file <a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>.</p>

</div>
</div>
<a class="anchor" id="adc788a73b8842ccd221231025f438bff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classBasicARTParameters.html">BasicARTParameters</a>* POCSClass::prm</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="recons__misc_8h_source.html#l00133">133</a> of file <a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>.</p>

</div>
</div>
<a class="anchor" id="a457330b2e6f9628f650474fffb8b6581"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int POCSClass::Xoutput_volume_size</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="recons__misc_8h_source.html#l00130">130</a> of file <a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4df5a32e160f4bdf98cff5903cbe6e01"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int POCSClass::Youtput_volume_size</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="recons__misc_8h_source.html#l00129">129</a> of file <a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac43cc91155b27dd7a794c1fe2ba58dc9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int POCSClass::Zoutput_volume_size</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="recons__misc_8h_source.html#l00128">128</a> of file <a class="el" href="recons__misc_8h_source.html">recons_misc.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/yunior/Yunior/Projects/Scipion/COSS/xmipp-bundle/src/xmipp/libraries/reconstruction/<a class="el" href="recons__misc_8h_source.html">recons_misc.h</a></li>
<li>/home/yunior/Yunior/Projects/Scipion/COSS/xmipp-bundle/src/xmipp/libraries/reconstruction/<a class="el" href="recons__misc_8cpp_source.html">recons_misc.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
