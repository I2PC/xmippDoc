<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Xmipp: FFTW Fourier transforms</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">FFTW Fourier transforms</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFourierTransformer.html">FourierTransformer</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCorrelationAux.html">CorrelationAux</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga85ad6ecf98399ec56bab8f10f2cff590"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#ga85ad6ecf98399ec56bab8f10f2cff590">POWER_SPECTRUM</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:ga85ad6ecf98399ec56bab8f10f2cff590"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac87527e6df256110f2f9f8abee98434c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#gac87527e6df256110f2f9f8abee98434c">AMPLITUDE_SPECTRUM</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:gac87527e6df256110f2f9f8abee98434c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga1075fe73c87077296a879f44ded3a2c3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#ga1075fe73c87077296a879f44ded3a2c3">FFT_magnitude</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;v, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;mag)</td></tr>
<tr class="separator:ga1075fe73c87077296a879f44ded3a2c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf6a482858077274c31b02b996227adb0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#gaf6a482858077274c31b02b996227adb0">FFT_phase</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;v, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;phase)</td></tr>
<tr class="separator:gaf6a482858077274c31b02b996227adb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga056e51e524f058814b26d905dd0fcacd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#ga056e51e524f058814b26d905dd0fcacd">radial_magnitude</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;v, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;V, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;radialMagnitude)</td></tr>
<tr class="separator:ga056e51e524f058814b26d905dd0fcacd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7099260bb0dcac784b753dd7edadb76f"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga7099260bb0dcac784b753dd7edadb76f"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__FourierW.html#ga7099260bb0dcac784b753dd7edadb76f">auto_correlation_vector</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;Img, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;R)</td></tr>
<tr class="separator:ga7099260bb0dcac784b753dd7edadb76f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae836a954010ab5be422c8708e4649e9f"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:gae836a954010ab5be422c8708e4649e9f"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__FourierW.html#gae836a954010ab5be422c8708e4649e9f">correlation_vector</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;m1, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;m2, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;R)</td></tr>
<tr class="separator:gae836a954010ab5be422c8708e4649e9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga964ea4799c1b1a246dd3ad2c8e2026c5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#ga964ea4799c1b1a246dd3ad2c8e2026c5">fast_correlation_vector</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;FFT1, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;FFT2, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;R, <a class="el" href="classFourierTransformer.html">FourierTransformer</a> &amp;transformer)</td></tr>
<tr class="separator:ga964ea4799c1b1a246dd3ad2c8e2026c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabd6083f63db4b0b7cd73de1f8e8b3f3e"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:gabd6083f63db4b0b7cd73de1f8e8b3f3e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__FourierW.html#gabd6083f63db4b0b7cd73de1f8e8b3f3e">correlation_vector_no_Fourier</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;<a class="el" href="numerical__recipes_8cpp.html#a9f954d5f5402aa3e24d96406b24f27a7">v1</a>, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;v2, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;result)</td></tr>
<tr class="separator:gabd6083f63db4b0b7cd73de1f8e8b3f3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6e15438efefae23b564ff2106af3ae29"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#ga6e15438efefae23b564ff2106af3ae29">correlation_matrix</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;m1, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;m2, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;R, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux, bool center=true)</td></tr>
<tr class="separator:ga6e15438efefae23b564ff2106af3ae29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga09815c383f62b4533387508d6f10f71b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#ga09815c383f62b4533387508d6f10f71b">correlation_matrix</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;FFT1, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;m2, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;R, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux, bool center=true)</td></tr>
<tr class="separator:ga09815c383f62b4533387508d6f10f71b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabf190d4a3a114148a80f4353a919ca21"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#gabf190d4a3a114148a80f4353a919ca21">correlation_matrix</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;FFT1, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;FFT2, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;R, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux, bool center=true)</td></tr>
<tr class="separator:gabf190d4a3a114148a80f4353a919ca21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0d7a03758b7300ae73f9b8e116f9f60e"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga0d7a03758b7300ae73f9b8e116f9f60e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__FourierW.html#ga0d7a03758b7300ae73f9b8e116f9f60e">auto_correlation_matrix</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;Img, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;R)</td></tr>
<tr class="separator:ga0d7a03758b7300ae73f9b8e116f9f60e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7bf30521a5ca5debfad8389e9eab219c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#ga7bf30521a5ca5debfad8389e9eab219c">auto_correlation_matrix</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Img, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;R, <a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;aux)</td></tr>
<tr class="separator:ga7bf30521a5ca5debfad8389e9eab219c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga13f74715f4e4215247da75aaf5eee858"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#ga13f74715f4e4215247da75aaf5eee858">convolutionFFTStack</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;kernel, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;result)</td></tr>
<tr class="separator:ga13f74715f4e4215247da75aaf5eee858"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9fda0e9a0f035f5d7a3c704885d168f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#ga9fda0e9a0f035f5d7a3c704885d168f6">convolutionFFT</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;img, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;kernel, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;result)</td></tr>
<tr class="separator:ga9fda0e9a0f035f5d7a3c704885d168f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8c374ed577f5e03c4b248a3d9600aad1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#ga8c374ed577f5e03c4b248a3d9600aad1">frc_dpr</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;m1, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;m2, double sampling_rate, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;freq, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;frc, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;frc_noise, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;dpr, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;error_l2, bool skipdpr=false, bool doRfactor=false, double minFreq=-1, double maxFreq=0.5, double *rFactor=NULL)</td></tr>
<tr class="separator:ga8c374ed577f5e03c4b248a3d9600aad1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3f36d5bfdef3419f111767c58c79e237"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#ga3f36d5bfdef3419f111767c58c79e237">scaleToSizeFourier</a> (int Zdim, int Ydim, int Xdim, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;mdaIn, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;mdaOut, int nThreads=1)</td></tr>
<tr class="separator:ga3f36d5bfdef3419f111767c58c79e237"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9ddb42c0ed909ee75a2124d8d370f7da"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ga9ddb42c0ed909ee75a2124d8d370f7da"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__FourierW.html#ga9ddb42c0ed909ee75a2124d8d370f7da">scaleToSizeFourier</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;mdaIn, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;mdaOut, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; T &gt; &gt; &amp;inFourier, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; T &gt; &gt; &amp;outFourier)</td></tr>
<tr class="separator:ga9ddb42c0ed909ee75a2124d8d370f7da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4bc1a5f3ae70b0c7ba4afb7c7a16c643"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#ga4bc1a5f3ae70b0c7ba4afb7c7a16c643">selfScaleToSizeFourier</a> (int Zdim, int Ydim, int Xdim, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;mda, int nthreads=1)</td></tr>
<tr class="separator:ga4bc1a5f3ae70b0c7ba4afb7c7a16c643"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2a756f69fe269fd21fc0f19ac077fb19"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#ga2a756f69fe269fd21fc0f19ac077fb19">selfScaleToSizeFourier</a> (int Ydim, int Xdim, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;mda, int nthreads=1)</td></tr>
<tr class="separator:ga2a756f69fe269fd21fc0f19ac077fb19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadbd60dc61ca05a56d9366e76ecba0df2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#gadbd60dc61ca05a56d9366e76ecba0df2">selfScaleToSizeFourier</a> (int Zdim, int Ydim, int Xdim, <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;mda, int nthreads=1)</td></tr>
<tr class="separator:gadbd60dc61ca05a56d9366e76ecba0df2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeb3997610c0c69200880ecfb6e24e06a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#gaeb3997610c0c69200880ecfb6e24e06a">selfScaleToSizeFourier</a> (int Ydim, int Xdim, <a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;mda, int nthreads=1)</td></tr>
<tr class="separator:gaeb3997610c0c69200880ecfb6e24e06a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga413e8956e4db6633a403f42c7a87f5be"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#ga413e8956e4db6633a403f42c7a87f5be">getSpectrum</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Min, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;spectrum, int spectrum_type=<a class="el" href="group__FourierW.html#gac87527e6df256110f2f9f8abee98434c">AMPLITUDE_SPECTRUM</a>)</td></tr>
<tr class="separator:ga413e8956e4db6633a403f42c7a87f5be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1f55fcd5fa2ba859cc73dd34daa55694"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#ga1f55fcd5fa2ba859cc73dd34daa55694">divideBySpectrum</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Min, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;spectrum, bool leave_origin_intact=false)</td></tr>
<tr class="separator:ga1f55fcd5fa2ba859cc73dd34daa55694"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9ca5712c85f0ad65ed9341bd3d3ca588"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#ga9ca5712c85f0ad65ed9341bd3d3ca588">multiplyBySpectrum</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Min, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;spectrum, bool leave_origin_intact=false)</td></tr>
<tr class="separator:ga9ca5712c85f0ad65ed9341bd3d3ca588"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4f2da3c6806ff7438cac1ff751a64e76"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#ga4f2da3c6806ff7438cac1ff751a64e76">whitenSpectrum</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Min, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Mout, int spectrum_type=<a class="el" href="group__FourierW.html#gac87527e6df256110f2f9f8abee98434c">AMPLITUDE_SPECTRUM</a>, bool leave_origin_intact=false)</td></tr>
<tr class="separator:ga4f2da3c6806ff7438cac1ff751a64e76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9d76a10387e06837bea739a3e1994b81"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#ga9d76a10387e06837bea739a3e1994b81">adaptSpectrum</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Min, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Mout, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;spectrum_ref, int spectrum_type=<a class="el" href="group__FourierW.html#gac87527e6df256110f2f9f8abee98434c">AMPLITUDE_SPECTRUM</a>, bool leave_origin_intact=false)</td></tr>
<tr class="separator:ga9d76a10387e06837bea739a3e1994b81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabcacc0c11d22f96340b07177f2c0b9ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__FourierW.html#gabcacc0c11d22f96340b07177f2c0b9ea">randomizePhases</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;Min, double wRandom)</td></tr>
<tr class="separator:gabcacc0c11d22f96340b07177f2c0b9ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="gac87527e6df256110f2f9f8abee98434c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AMPLITUDE_SPECTRUM&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="xmipp__fftw_8h_source.html#l00669">669</a> of file <a class="el" href="xmipp__fftw_8h_source.html">xmipp_fftw.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga85ad6ecf98399ec56bab8f10f2cff590"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define POWER_SPECTRUM&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="xmipp__fftw_8h_source.html#l00668">668</a> of file <a class="el" href="xmipp__fftw_8h_source.html">xmipp_fftw.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga9d76a10387e06837bea739a3e1994b81"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adaptSpectrum </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Mout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>spectrum_ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>spectrum_type</em> = <code><a class="el" href="group__FourierW.html#gac87527e6df256110f2f9f8abee98434c">AMPLITUDE_SPECTRUM</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>leave_origin_intact</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adapts Min to have the same spectrum as spectrum_ref</p>
<p>If only_amplitudes==true, the amplitude rather than the power spectrum will be equalized </p>

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00849">849</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;{</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    Min.checkDimension(3);</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> spectrum;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <a class="code" href="group__FourierW.html#ga413e8956e4db6633a403f42c7a87f5be">getSpectrum</a>(Min,spectrum,spectrum_type);</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gaceb4070c83bd0e86e3adc96e07a32c31">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY1D</a>(spectrum)</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    {</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(spectrum, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = (<a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(spectrum, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &gt; 0.) ? <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(spectrum_ref,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)/ <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(spectrum, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) : 1.;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    }</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    Mout=Min;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <a class="code" href="group__FourierW.html#ga9ca5712c85f0ad65ed9341bd3d3ca588">multiplyBySpectrum</a>(Mout,spectrum,leave_origin_intact);</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__FourierW_html_ga413e8956e4db6633a403f42c7a87f5be"><div class="ttname"><a href="group__FourierW.html#ga413e8956e4db6633a403f42c7a87f5be">getSpectrum</a></div><div class="ttdeci">void getSpectrum(MultidimArray&lt; double &gt; &amp;Min, MultidimArray&lt; double &gt; &amp;spectrum, int spectrum_type)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00752">xmipp_fftw.cpp:752</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaceb4070c83bd0e86e3adc96e07a32c31"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaceb4070c83bd0e86e3adc96e07a32c31">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY1D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00603">multidim_array.h:603</a></div></div>
<div class="ttc" id="group__FourierW_html_ga9ca5712c85f0ad65ed9341bd3d3ca588"><div class="ttname"><a href="group__FourierW.html#ga9ca5712c85f0ad65ed9341bd3d3ca588">multiplyBySpectrum</a></div><div class="ttdeci">void multiplyBySpectrum(MultidimArray&lt; double &gt; &amp;Min, MultidimArray&lt; double &gt; &amp;spectrum, bool leave_origin_intact)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00806">xmipp_fftw.cpp:806</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga53e37122134100316031eae982abee03"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a></div><div class="ttdeci">#define dAi(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00540">multidim_array.h:540</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga0d7a03758b7300ae73f9b8e116f9f60e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void auto_correlation_matrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>Img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>R</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Autocorrelation function of an image</p>
<p>Fast calcuation of the autocorrelation matrix of a given one using Fast Fourier Transform. (Using the correlation theorem) </p>

<p>Definition at line <a class="el" href="xmipp__fftw_8h_source.html#l00594">594</a> of file <a class="el" href="xmipp__fftw_8h_source.html">xmipp_fftw.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;{</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">// Compute the Fourier Transform</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; std::complex&lt; double &gt;</a> &gt; FFT1;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <a class="code" href="classFourierTransformer.html">FourierTransformer</a> transformer1;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    R=Img;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    transformer1.<a class="code" href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransform</a>(R, FFT1, <span class="keyword">false</span>);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="comment">// Multiply FFT1 * FFT1&#39;</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordtype">double</span> dSize=<a class="code" href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(Img);</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(FFT1)</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    {</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordtype">double</span> *ptr=(<span class="keywordtype">double</span>*)&amp;<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(FFT1,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="keywordtype">double</span> &amp;realPart=*ptr;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordtype">double</span> &amp;imagPart=*(ptr+1);</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        realPart=dSize*(realPart*realPart+imagPart*imagPart);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        imagPart=0;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    }</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="comment">// Invert the product, in order to obtain the correlation image</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    transformer1.<a class="code" href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">inverseFourierTransform</a>();</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="comment">// Center the resulting image to obtain a centered autocorrelation</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <a class="code" href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a>(R, <span class="keyword">true</span>);</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a1c8297f634bb4f9d1235f6c4fa33d7e5"><div class="ttname"><a href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">FourierTransformer::inverseFourierTransform</a></div><div class="ttdeci">void inverseFourierTransform()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00329">xmipp_fftw.cpp:329</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga027a630a86c277b71cda769268764fd1"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a></div><div class="ttdeci">#define MULTIDIM_SIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00125">multidim_array.h:125</a></div></div>
<div class="ttc" id="classFourierTransformer_html"><div class="ttname"><a href="classFourierTransformer.html">FourierTransformer</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00060">xmipp_fftw.h:60</a></div></div>
<div class="ttc" id="group__Fourier_html_ga0447bcc3d329ad07e453b0d9b0872468"><div class="ttname"><a href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a></div><div class="ttdeci">void CenterFFT(MultidimArray&lt; T &gt; &amp;v, bool forward)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8h_source.html#l00291">xmipp_fft.h:291</a></div></div>
<div class="ttc" id="classFourierTransformer_html_abfdc5699d3c579a26bba39ec679b5adc"><div class="ttname"><a href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransformer::FourierTransform</a></div><div class="ttdeci">void FourierTransform(T &amp;v, T1 &amp;V, bool getCopy=true)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00166">xmipp_fftw.h:166</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga7bf30521a5ca5debfad8389e9eab219c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void auto_correlation_matrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fast autocorrelation matrix </p>

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00957">957</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;{</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="comment">// Compute the Fourier Transform</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    R=Img;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    aux.<a class="code" href="classCorrelationAux.html#ad6fc21194291fb961fd936ebe3a64a35">transformer1</a>.<a class="code" href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransform</a>(R, aux.<a class="code" href="classCorrelationAux.html#a502e4e706f06acdbeed51c02e18752f4">FFT1</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="comment">// Multiply FFT1 * FFT1&#39;</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keywordtype">double</span> dSize=<a class="code" href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(Img);</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(aux.<a class="code" href="classCorrelationAux.html#a502e4e706f06acdbeed51c02e18752f4">FFT1</a>)</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    {</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <span class="keywordtype">double</span> *ptr=(<span class="keywordtype">double</span>*)&amp;<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(aux.<a class="code" href="classCorrelationAux.html#a502e4e706f06acdbeed51c02e18752f4">FFT1</a>,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <span class="keywordtype">double</span> &amp;realPart=*ptr;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <span class="keywordtype">double</span> &amp;imagPart=*(ptr+1);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        realPart=dSize*(realPart*realPart+imagPart*imagPart);</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        imagPart=0;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    }</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="comment">// Invert the product, in order to obtain the correlation image</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    aux.<a class="code" href="classCorrelationAux.html#ad6fc21194291fb961fd936ebe3a64a35">transformer1</a>.<a class="code" href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">inverseFourierTransform</a>();</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="comment">// Center the resulting image to obtain a centered autocorrelation</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <a class="code" href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a>(R, <span class="keyword">true</span>);</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;}</div><div class="ttc" id="classCorrelationAux_html_ad6fc21194291fb961fd936ebe3a64a35"><div class="ttname"><a href="classCorrelationAux.html#ad6fc21194291fb961fd936ebe3a64a35">CorrelationAux::transformer1</a></div><div class="ttdeci">FourierTransformer transformer1</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00555">xmipp_fftw.h:555</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a1c8297f634bb4f9d1235f6c4fa33d7e5"><div class="ttname"><a href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">FourierTransformer::inverseFourierTransform</a></div><div class="ttdeci">void inverseFourierTransform()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00329">xmipp_fftw.cpp:329</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga027a630a86c277b71cda769268764fd1"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a></div><div class="ttdeci">#define MULTIDIM_SIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00125">multidim_array.h:125</a></div></div>
<div class="ttc" id="group__Fourier_html_ga0447bcc3d329ad07e453b0d9b0872468"><div class="ttname"><a href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a></div><div class="ttdeci">void CenterFFT(MultidimArray&lt; T &gt; &amp;v, bool forward)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8h_source.html#l00291">xmipp_fft.h:291</a></div></div>
<div class="ttc" id="classCorrelationAux_html_a502e4e706f06acdbeed51c02e18752f4"><div class="ttname"><a href="classCorrelationAux.html#a502e4e706f06acdbeed51c02e18752f4">CorrelationAux::FFT1</a></div><div class="ttdeci">MultidimArray&lt; std::complex&lt; double &gt; &gt; FFT1</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00554">xmipp_fftw.h:554</a></div></div>
<div class="ttc" id="classFourierTransformer_html_abfdc5699d3c579a26bba39ec679b5adc"><div class="ttname"><a href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransformer::FourierTransform</a></div><div class="ttdeci">void FourierTransform(T &amp;v, T1 &amp;V, bool getCopy=true)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00166">xmipp_fftw.h:166</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga7099260bb0dcac784b753dd7edadb76f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void auto_correlation_vector </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>Img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>R</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Autocorrelation function of a Xmipp vector</p>
<p>Fast calculation of the autocorrelation vector of a given one using Fast Fourier Transform. (Using the correlation theorem) </p>

<p>Definition at line <a class="el" href="xmipp__fftw_8h_source.html#l00452">452</a> of file <a class="el" href="xmipp__fftw_8h_source.html">xmipp_fftw.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;{</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    Img.checkDimension(1);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">// Compute the Fourier Transform</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; std::complex&lt; double &gt;</a> &gt; FFT1;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <a class="code" href="classFourierTransformer.html">FourierTransformer</a> transformer1;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    R=Img;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    transformer1.<a class="code" href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransform</a>(R, FFT1, <span class="keyword">false</span>);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="comment">// Multiply FFT1 * FFT1&#39;</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordtype">double</span> dSize=<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Img);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(FFT1)</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    {</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="keywordtype">double</span> *ptr=(<span class="keywordtype">double</span>*)&amp;<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(FFT1,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="keywordtype">double</span> &amp;realPart=*ptr;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keywordtype">double</span> &amp;imagPart=*(ptr+1);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        realPart=dSize*(realPart*realPart+imagPart*imagPart);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        imagPart=0;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    }</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">// Invert the product, in order to obtain the correlation image</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    transformer1.<a class="code" href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">inverseFourierTransform</a>();</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">// Center the resulting image to obtain a centered autocorrelation</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <a class="code" href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a>(R, <span class="keyword">true</span>);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a1c8297f634bb4f9d1235f6c4fa33d7e5"><div class="ttname"><a href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">FourierTransformer::inverseFourierTransform</a></div><div class="ttdeci">void inverseFourierTransform()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00329">xmipp_fftw.cpp:329</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="classFourierTransformer_html"><div class="ttname"><a href="classFourierTransformer.html">FourierTransformer</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00060">xmipp_fftw.h:60</a></div></div>
<div class="ttc" id="group__Fourier_html_ga0447bcc3d329ad07e453b0d9b0872468"><div class="ttname"><a href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a></div><div class="ttdeci">void CenterFFT(MultidimArray&lt; T &gt; &amp;v, bool forward)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8h_source.html#l00291">xmipp_fft.h:291</a></div></div>
<div class="ttc" id="classFourierTransformer_html_abfdc5699d3c579a26bba39ec679b5adc"><div class="ttname"><a href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransformer::FourierTransform</a></div><div class="ttdeci">void FourierTransform(T &amp;v, T1 &amp;V, bool getCopy=true)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00166">xmipp_fftw.h:166</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga9fda0e9a0f035f5d7a3c704885d168f6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void convolutionFFT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00457">457</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;{</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <a class="code" href="classFourierTransformer.html">FourierTransformer</a> transformer1, transformer2;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; std::complex&lt;double&gt;</a> &gt; FFT1, FFT2;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    transformer1.<a class="code" href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransform</a>(img, FFT1, <span class="keyword">false</span>);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    result=kernel;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    transformer2.<a class="code" href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransform</a>(result, FFT2, <span class="keyword">false</span>);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="comment">// Multiply FFT1 * FFT2&#39;</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordtype">double</span> dSize=<a class="code" href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(img);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>, <a class="code" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a>; <span class="comment">// a+bi, c+di</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordtype">double</span> *ptrFFT2=(<span class="keywordtype">double</span>*)<a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(FFT2);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordtype">double</span> *ptrFFT1=(<span class="keywordtype">double</span>*)<a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(FFT1);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(FFT1)</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    {</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        a=*ptrFFT1++;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        b=*ptrFFT1++;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        c=(*ptrFFT2)*dSize;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        d=(*(ptrFFT2+1))*dSize;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        *ptrFFT2++ = a*c-b*<a class="code" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a>;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        *ptrFFT2++ = b*c+a*<a class="code" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a>;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">// Invert the product, in order to obtain the correlation image</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    transformer2.<a class="code" href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">inverseFourierTransform</a>();</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="comment">// Center the resulting image to compensate for phase shift</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a>(result, <span class="keyword">false</span>);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a1c8297f634bb4f9d1235f6c4fa33d7e5"><div class="ttname"><a href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">FourierTransformer::inverseFourierTransform</a></div><div class="ttdeci">void inverseFourierTransform()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00329">xmipp_fftw.cpp:329</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gac87b223f03097d45f776b44b6aeea9f7"><div class="ttname"><a href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a></div><div class="ttdeci">#define MULTIDIM_ARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00136">multidim_array.h:136</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga027a630a86c277b71cda769268764fd1"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a></div><div class="ttdeci">#define MULTIDIM_SIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00125">multidim_array.h:125</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3939496af6ccffe20d083935ebd3225b"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a></div><div class="ttdeci">doublereal * d</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="classFourierTransformer_html"><div class="ttname"><a href="classFourierTransformer.html">FourierTransformer</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00060">xmipp_fftw.h:60</a></div></div>
<div class="ttc" id="group__Fourier_html_ga0447bcc3d329ad07e453b0d9b0872468"><div class="ttname"><a href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a></div><div class="ttdeci">void CenterFFT(MultidimArray&lt; T &gt; &amp;v, bool forward)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8h_source.html#l00291">xmipp_fft.h:291</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af090b2fbbd2916bfb2e493c5162969d6"><div class="ttname"><a href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a></div><div class="ttdeci">doublereal * b</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="classFourierTransformer_html_abfdc5699d3c579a26bba39ec679b5adc"><div class="ttname"><a href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransformer::FourierTransform</a></div><div class="ttdeci">void FourierTransform(T &amp;v, T1 &amp;V, bool getCopy=true)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00166">xmipp_fftw.h:166</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af2a333b1670df64a88d3a2f22210d155"><div class="ttname"><a href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a></div><div class="ttdeci">doublereal * a</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga13f74715f4e4215247da75aaf5eee858"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void convolutionFFTStack </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00429">429</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;{</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">if</span> (&amp;result != &amp;img)</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        result = img;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> imgTemp;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; std::complex&lt; double&gt;</a> &gt; FFTIm, FFTK;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="classFourierTransformer.html">FourierTransformer</a> transformer1(FFTW_BACKWARD), transformer2(FFTW_BACKWARD);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    transformer2.FourierTransform((<a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;)kernel, FFTK, <span class="keyword">false</span>);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = 0; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> &lt; <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(result); <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>++)</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    {</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        imgTemp.<a class="code" href="classMultidimArray.html#a206b120e09649b53d73cefe0d7550ca7">aliasSlice</a>(result, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        transformer1.FourierTransform(imgTemp, FFTIm, <span class="keyword">false</span>);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(FFTIm)</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(FFTIm,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>) *= <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(FFTK,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        transformer1.inverseFourierTransform();</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <a class="code" href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a>(imgTemp, false);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    }</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classMultidimArray_html_a206b120e09649b53d73cefe0d7550ca7"><div class="ttname"><a href="classMultidimArray.html#a206b120e09649b53d73cefe0d7550ca7">MultidimArray::aliasSlice</a></div><div class="ttdeci">void aliasSlice(const MultidimArray&lt; T &gt; &amp;m, size_t select_slice)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01503">multidim_array.h:1503</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="classFourierTransformer_html"><div class="ttname"><a href="classFourierTransformer.html">FourierTransformer</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00060">xmipp_fftw.h:60</a></div></div>
<div class="ttc" id="group__Fourier_html_ga0447bcc3d329ad07e453b0d9b0872468"><div class="ttname"><a href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a></div><div class="ttdeci">void CenterFFT(MultidimArray&lt; T &gt; &amp;v, bool forward)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8h_source.html#l00291">xmipp_fft.h:291</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga6e15438efefae23b564ff2106af3ae29"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void correlation_matrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>m1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>m2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>center</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Correlation of two nD images</p>
<p>Fast calcuation of the correlation matrix on two matrices using Fast Fourier Transform. (Using the correlation theorem). The output matrix must be already resized </p>

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00869">869</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;{</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    aux.<a class="code" href="classCorrelationAux.html#ad6fc21194291fb961fd936ebe3a64a35">transformer1</a>.<a class="code" href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransform</a>((<a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> &amp;)m1, aux.<a class="code" href="classCorrelationAux.html#a502e4e706f06acdbeed51c02e18752f4">FFT1</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <a class="code" href="group__FourierW.html#ga6e15438efefae23b564ff2106af3ae29">correlation_matrix</a>(aux.<a class="code" href="classCorrelationAux.html#a502e4e706f06acdbeed51c02e18752f4">FFT1</a>,m2,R,aux,center);</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;}</div><div class="ttc" id="classCorrelationAux_html_ad6fc21194291fb961fd936ebe3a64a35"><div class="ttname"><a href="classCorrelationAux.html#ad6fc21194291fb961fd936ebe3a64a35">CorrelationAux::transformer1</a></div><div class="ttdeci">FourierTransformer transformer1</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00555">xmipp_fftw.h:555</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__FourierW_html_ga6e15438efefae23b564ff2106af3ae29"><div class="ttname"><a href="group__FourierW.html#ga6e15438efefae23b564ff2106af3ae29">correlation_matrix</a></div><div class="ttdeci">void correlation_matrix(const MultidimArray&lt; double &gt; &amp;m1, const MultidimArray&lt; double &gt; &amp;m2, MultidimArray&lt; double &gt; &amp;R, CorrelationAux &amp;aux, bool center)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00869">xmipp_fftw.cpp:869</a></div></div>
<div class="ttc" id="classCorrelationAux_html_a502e4e706f06acdbeed51c02e18752f4"><div class="ttname"><a href="classCorrelationAux.html#a502e4e706f06acdbeed51c02e18752f4">CorrelationAux::FFT1</a></div><div class="ttdeci">MultidimArray&lt; std::complex&lt; double &gt; &gt; FFT1</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00554">xmipp_fftw.h:554</a></div></div>
<div class="ttc" id="classFourierTransformer_html_abfdc5699d3c579a26bba39ec679b5adc"><div class="ttname"><a href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransformer::FourierTransform</a></div><div class="ttdeci">void FourierTransform(T &amp;v, T1 &amp;V, bool getCopy=true)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00166">xmipp_fftw.h:166</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga09815c383f62b4533387508d6f10f71b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void correlation_matrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>FFT1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>m2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>center</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00898">898</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;{</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    R=m2;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    aux.<a class="code" href="classCorrelationAux.html#afb50e59e3b8ac5aa88765418f48c84b3">transformer2</a>.<a class="code" href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransform</a>(R, aux.<a class="code" href="classCorrelationAux.html#a2e62252043865223a35e0976f7b7aafa">FFT2</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <a class="code" href="xmipp__fftw_8cpp.html#ad16ab60cbc0c3f5feea8d7af26ac5c21">correlationInFourier</a>(FF1,aux.<a class="code" href="classCorrelationAux.html#a2e62252043865223a35e0976f7b7aafa">FFT2</a>,<a class="code" href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(R));</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    aux.<a class="code" href="classCorrelationAux.html#afb50e59e3b8ac5aa88765418f48c84b3">transformer2</a>.<a class="code" href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">inverseFourierTransform</a>();</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="keywordflow">if</span> (center)</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <a class="code" href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a>(R, <span class="keyword">true</span>);</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;}</div><div class="ttc" id="classFourierTransformer_html_a1c8297f634bb4f9d1235f6c4fa33d7e5"><div class="ttname"><a href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">FourierTransformer::inverseFourierTransform</a></div><div class="ttdeci">void inverseFourierTransform()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00329">xmipp_fftw.cpp:329</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga027a630a86c277b71cda769268764fd1"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a></div><div class="ttdeci">#define MULTIDIM_SIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00125">multidim_array.h:125</a></div></div>
<div class="ttc" id="xmipp__fftw_8cpp_html_ad16ab60cbc0c3f5feea8d7af26ac5c21"><div class="ttname"><a href="xmipp__fftw_8cpp.html#ad16ab60cbc0c3f5feea8d7af26ac5c21">correlationInFourier</a></div><div class="ttdeci">void correlationInFourier(const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;FF1, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;FF2, double dSize)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00879">xmipp_fftw.cpp:879</a></div></div>
<div class="ttc" id="group__Fourier_html_ga0447bcc3d329ad07e453b0d9b0872468"><div class="ttname"><a href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a></div><div class="ttdeci">void CenterFFT(MultidimArray&lt; T &gt; &amp;v, bool forward)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8h_source.html#l00291">xmipp_fft.h:291</a></div></div>
<div class="ttc" id="classFourierTransformer_html_abfdc5699d3c579a26bba39ec679b5adc"><div class="ttname"><a href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransformer::FourierTransform</a></div><div class="ttdeci">void FourierTransform(T &amp;v, T1 &amp;V, bool getCopy=true)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00166">xmipp_fftw.h:166</a></div></div>
<div class="ttc" id="classCorrelationAux_html_a2e62252043865223a35e0976f7b7aafa"><div class="ttname"><a href="classCorrelationAux.html#a2e62252043865223a35e0976f7b7aafa">CorrelationAux::FFT2</a></div><div class="ttdeci">MultidimArray&lt; std::complex&lt; double &gt; &gt; FFT2</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00554">xmipp_fftw.h:554</a></div></div>
<div class="ttc" id="classCorrelationAux_html_afb50e59e3b8ac5aa88765418f48c84b3"><div class="ttname"><a href="classCorrelationAux.html#afb50e59e3b8ac5aa88765418f48c84b3">CorrelationAux::transformer2</a></div><div class="ttdeci">FourierTransformer transformer2</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00555">xmipp_fftw.h:555</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gabf190d4a3a114148a80f4353a919ca21"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void correlation_matrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>FFT1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>FFT2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCorrelationAux.html">CorrelationAux</a> &amp;&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>center</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Correlation matrix. R must already be with the right size. </p>

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00912">912</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;{</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    aux.<a class="code" href="classCorrelationAux.html#afb50e59e3b8ac5aa88765418f48c84b3">transformer2</a>.<a class="code" href="classFourierTransformer.html#a18bc840c781555b742d0185fb20925bf">setReal</a>(R);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    aux.<a class="code" href="classCorrelationAux.html#afb50e59e3b8ac5aa88765418f48c84b3">transformer2</a>.<a class="code" href="classFourierTransformer.html#ad5e1b85f725814ca93f905c81e40b428">setFourier</a>(FFT2);</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <a class="code" href="xmipp__fftw_8cpp.html#ad16ab60cbc0c3f5feea8d7af26ac5c21">correlationInFourier</a>(FFT1,aux.<a class="code" href="classCorrelationAux.html#afb50e59e3b8ac5aa88765418f48c84b3">transformer2</a>.<a class="code" href="classFourierTransformer.html#a47ccb9e9db38d7db2fcee203f51e0af3">fFourier</a>,<a class="code" href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(R));</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    aux.<a class="code" href="classCorrelationAux.html#afb50e59e3b8ac5aa88765418f48c84b3">transformer2</a>.<a class="code" href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">inverseFourierTransform</a>();</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordflow">if</span> (center)</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <a class="code" href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a>(R, <span class="keyword">true</span>);</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;}</div><div class="ttc" id="classFourierTransformer_html_a1c8297f634bb4f9d1235f6c4fa33d7e5"><div class="ttname"><a href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">FourierTransformer::inverseFourierTransform</a></div><div class="ttdeci">void inverseFourierTransform()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00329">xmipp_fftw.cpp:329</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga027a630a86c277b71cda769268764fd1"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a></div><div class="ttdeci">#define MULTIDIM_SIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00125">multidim_array.h:125</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a47ccb9e9db38d7db2fcee203f51e0af3"><div class="ttname"><a href="classFourierTransformer.html#a47ccb9e9db38d7db2fcee203f51e0af3">FourierTransformer::fFourier</a></div><div class="ttdeci">MultidimArray&lt; std::complex&lt; double &gt; &gt; fFourier</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00070">xmipp_fftw.h:70</a></div></div>
<div class="ttc" id="xmipp__fftw_8cpp_html_ad16ab60cbc0c3f5feea8d7af26ac5c21"><div class="ttname"><a href="xmipp__fftw_8cpp.html#ad16ab60cbc0c3f5feea8d7af26ac5c21">correlationInFourier</a></div><div class="ttdeci">void correlationInFourier(const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;FF1, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;FF2, double dSize)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00879">xmipp_fftw.cpp:879</a></div></div>
<div class="ttc" id="group__Fourier_html_ga0447bcc3d329ad07e453b0d9b0872468"><div class="ttname"><a href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a></div><div class="ttdeci">void CenterFFT(MultidimArray&lt; T &gt; &amp;v, bool forward)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8h_source.html#l00291">xmipp_fft.h:291</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a18bc840c781555b742d0185fb20925bf"><div class="ttname"><a href="classFourierTransformer.html#a18bc840c781555b742d0185fb20925bf">FourierTransformer::setReal</a></div><div class="ttdeci">void setReal(MultidimArray&lt; double &gt; &amp;img)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00129">xmipp_fftw.cpp:129</a></div></div>
<div class="ttc" id="classFourierTransformer_html_ad5e1b85f725814ca93f905c81e40b428"><div class="ttname"><a href="classFourierTransformer.html#ad5e1b85f725814ca93f905c81e40b428">FourierTransformer::setFourier</a></div><div class="ttdeci">void setFourier(const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;imgFourier)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00249">xmipp_fftw.cpp:249</a></div></div>
<div class="ttc" id="classCorrelationAux_html_afb50e59e3b8ac5aa88765418f48c84b3"><div class="ttname"><a href="classCorrelationAux.html#afb50e59e3b8ac5aa88765418f48c84b3">CorrelationAux::transformer2</a></div><div class="ttdeci">FourierTransformer transformer2</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00555">xmipp_fftw.h:555</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gae836a954010ab5be422c8708e4649e9f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void correlation_vector </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>m1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>m2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>R</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Autocorrelation function of a Xmipp vector</p>
<p>Fast calcuation of the correlation matrix on two matrices using Fast Fourier Transform. (Using the correlation theorem). The output matrix must be already resized </p>

<p>Definition at line <a class="el" href="xmipp__fftw_8h_source.html#l00488">488</a> of file <a class="el" href="xmipp__fftw_8h_source.html">xmipp_fftw.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;{</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    m1.checkDimension(2);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    m2.checkDimension(2);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="comment">// Compute the Fourier Transforms</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; std::complex&lt; double &gt;</a> &gt; FFT1, FFT2;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <a class="code" href="classFourierTransformer.html">FourierTransformer</a> transformer1, transformer2;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    R=m1;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    transformer1.<a class="code" href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransform</a>(R, FFT1, <span class="keyword">false</span>);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    transformer2.<a class="code" href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransform</a>((<a class="code" href="classMultidimArray.html">MultidimArray&lt;T&gt;</a> &amp;)m2, FFT2, <span class="keyword">false</span>);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="comment">// Multiply FFT1 * FFT2&#39;</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordtype">double</span> dSize=<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(m1);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gaa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(FFT1)</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    FFT1(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) *= dSize * <a class="code" href="namespacealglib.html#a0fe83df1d04b0270f8cfaf97114082ff">conj</a>(FFT2(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">// Invert the product, in order to obtain the correlation image</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    transformer1.inverseFourierTransform();</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="comment">// Center the resulting image to obtain a centered autocorrelation</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <a class="code" href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a>(R, true);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;}</div><div class="ttc" id="namespacealglib_html_a0fe83df1d04b0270f8cfaf97114082ff"><div class="ttname"><a href="namespacealglib.html#a0fe83df1d04b0270f8cfaf97114082ff">alglib::conj</a></div><div class="ttdeci">alglib::complex conj(const alglib::complex &amp;z)</div><div class="ttdef"><b>Definition:</b> <a href="ap_8cpp_source.html#l04988">ap.cpp:4988</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaa924a84ae5fbf0ba6b4052eb9d92ef60"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00564">multidim_array.h:564</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classFourierTransformer_html"><div class="ttname"><a href="classFourierTransformer.html">FourierTransformer</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00060">xmipp_fftw.h:60</a></div></div>
<div class="ttc" id="group__Fourier_html_ga0447bcc3d329ad07e453b0d9b0872468"><div class="ttname"><a href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a></div><div class="ttdeci">void CenterFFT(MultidimArray&lt; T &gt; &amp;v, bool forward)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8h_source.html#l00291">xmipp_fft.h:291</a></div></div>
<div class="ttc" id="classFourierTransformer_html_abfdc5699d3c579a26bba39ec679b5adc"><div class="ttname"><a href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransformer::FourierTransform</a></div><div class="ttdeci">void FourierTransform(T &amp;v, T1 &amp;V, bool getCopy=true)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00166">xmipp_fftw.h:166</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gabd6083f63db4b0b7cd73de1f8e8b3f3e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void correlation_vector_no_Fourier </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>v2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the correlation vector without using Fourier.</p>
<p>The results are the same as the previous ones but this function is threadsafe while the previous one is not.</p>
<p>It is assumed that the two vectors v1, and v2 are of the same size. </p>

<p>Definition at line <a class="el" href="xmipp__fftw_8h_source.html#l00534">534</a> of file <a class="el" href="xmipp__fftw_8h_source.html">xmipp_fftw.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;{</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    v1.checkDimension(1);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    v2.checkDimension(1);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    result.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(v1);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    result.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordtype">int</span> N=<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(v1)-1;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gaa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(result)</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#aca6408d1d58d2334ecf5b80c3a9a8881">for</a> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>=0; k&lt;<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(v1); ++k)</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(result,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)+=<a class="code" href="group__MultidimensionalArrays.html#gaa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a>(v1,<a class="code" href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a>(k+<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,0,N))*</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                            <a class="code" href="group__MultidimensionalArrays.html#gaa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a>(v2,k);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a>(result)=0;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga97809f7244a28aaa1c26e29e6e3204ef"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a></div><div class="ttdeci">#define A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00549">multidim_array.h:549</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaa924a84ae5fbf0ba6b4052eb9d92ef60"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00564">multidim_array.h:564</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaa6b2513810dd91e11450be99106a2463"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaa6b2513810dd91e11450be99106a2463">DIRECT_A1D_ELEM</a></div><div class="ttdeci">#define DIRECT_A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00536">multidim_array.h:536</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_aca6408d1d58d2334ecf5b80c3a9a8881"><div class="ttname"><a href="numerical__recipes_8cpp.html#aca6408d1d58d2334ecf5b80c3a9a8881">for</a></div><div class="ttdeci">for(j=1;j&lt;=i__1;++j)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02327">numerical_recipes.cpp:2327</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00061">multidim_array.h:61</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="group__Macros_html_ga10de40044d2903ec0d4e7e57c31322aa"><div class="ttname"><a href="group__Macros.html#ga10de40044d2903ec0d4e7e57c31322aa">intWRAP</a></div><div class="ttdeci">#define intWRAP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00272">xmipp_macros.h:272</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga1f55fcd5fa2ba859cc73dd34daa55694"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void divideBySpectrum </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>spectrum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>leave_origin_intact</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Divide the input map in Fourier-space by the spectrum provided.</p>
<p>If leave_origin_intact==true, the origin pixel will remain untouched </p>

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00788">788</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;{</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    Min.checkDimension(3);</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> div_spec(spectrum);</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gaceb4070c83bd0e86e3adc96e07a32c31">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY1D</a>(spectrum)</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    {</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(<a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(spectrum,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)) &gt; 0.)</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(div_spec,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = 1./<a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(spectrum,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(div_spec,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = 1.;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    }</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <a class="code" href="group__FourierW.html#ga9ca5712c85f0ad65ed9341bd3d3ca588">multiplyBySpectrum</a>(Min,div_spec,leave_origin_intact);</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaceb4070c83bd0e86e3adc96e07a32c31"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaceb4070c83bd0e86e3adc96e07a32c31">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY1D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00603">multidim_array.h:603</a></div></div>
<div class="ttc" id="group__FourierW_html_ga9ca5712c85f0ad65ed9341bd3d3ca588"><div class="ttname"><a href="group__FourierW.html#ga9ca5712c85f0ad65ed9341bd3d3ca588">multiplyBySpectrum</a></div><div class="ttdeci">void multiplyBySpectrum(MultidimArray&lt; double &gt; &amp;Min, MultidimArray&lt; double &gt; &amp;spectrum, bool leave_origin_intact)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00806">xmipp_fftw.cpp:806</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga53e37122134100316031eae982abee03"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a></div><div class="ttdeci">#define dAi(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00540">multidim_array.h:540</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga964ea4799c1b1a246dd3ad2c8e2026c5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fast_correlation_vector </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>FFT1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>FFT2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFourierTransformer.html">FourierTransformer</a> &amp;&#160;</td>
          <td class="paramname"><em>transformer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Autocorrelation function of a Xmipp vector</p>
<p>Same as correlation_vector, but the Fourier transforms have already been computed and the transformer is reused. The transformer internal variables must have already been resized. </p>

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00926">926</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;{</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    transformer.<a class="code" href="classFourierTransformer.html#ad5e1b85f725814ca93f905c81e40b428">setFourier</a>(FFT1);</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="comment">// Multiply FFT1 * FFT2&#39;</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a>, <a class="code" href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a>, <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>, <a class="code" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a>; <span class="comment">// a+bi, c+di</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keywordtype">double</span> *ptrFFT2=(<span class="keywordtype">double</span>*)<a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(FFT2);</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="keywordtype">double</span> *ptrFFT1=(<span class="keywordtype">double</span>*)&amp;(<a class="code" href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(transformer.<a class="code" href="classFourierTransformer.html#a47ccb9e9db38d7db2fcee203f51e0af3">fFourier</a>,0));</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(FFT1)</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    {</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        a=*ptrFFT1;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        b=*(ptrFFT1+1);</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        c=(*ptrFFT2++);</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        d=(*ptrFFT2++)*(-1);</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        *ptrFFT1++ = a*c-b*<a class="code" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a>;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        *ptrFFT1++ = b*c+a*<a class="code" href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a>;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    }</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="comment">// Invert the product, in order to obtain the correlation image</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    transformer.<a class="code" href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">inverseFourierTransform</a>();</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="comment">// Center the resulting image to obtain a centered autocorrelation</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    R=*transformer.<a class="code" href="classFourierTransformer.html#a40f40ad81f20501e250dc4c1b6b926ca">fReal</a>;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <a class="code" href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a>(R, <span class="keyword">true</span>);</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    R.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga97809f7244a28aaa1c26e29e6e3204ef"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a></div><div class="ttdeci">#define A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00549">multidim_array.h:549</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a1c8297f634bb4f9d1235f6c4fa33d7e5"><div class="ttname"><a href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">FourierTransformer::inverseFourierTransform</a></div><div class="ttdeci">void inverseFourierTransform()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00329">xmipp_fftw.cpp:329</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gac87b223f03097d45f776b44b6aeea9f7"><div class="ttname"><a href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a></div><div class="ttdeci">#define MULTIDIM_ARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00136">multidim_array.h:136</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a47ccb9e9db38d7db2fcee203f51e0af3"><div class="ttname"><a href="classFourierTransformer.html#a47ccb9e9db38d7db2fcee203f51e0af3">FourierTransformer::fFourier</a></div><div class="ttdeci">MultidimArray&lt; std::complex&lt; double &gt; &gt; fFourier</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00070">xmipp_fftw.h:70</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3939496af6ccffe20d083935ebd3225b"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3939496af6ccffe20d083935ebd3225b">d</a></div><div class="ttdeci">doublereal * d</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a40f40ad81f20501e250dc4c1b6b926ca"><div class="ttname"><a href="classFourierTransformer.html#a40f40ad81f20501e250dc4c1b6b926ca">FourierTransformer::fReal</a></div><div class="ttdeci">MultidimArray&lt; double &gt; * fReal</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00064">xmipp_fftw.h:64</a></div></div>
<div class="ttc" id="group__Fourier_html_ga0447bcc3d329ad07e453b0d9b0872468"><div class="ttname"><a href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a></div><div class="ttdeci">void CenterFFT(MultidimArray&lt; T &gt; &amp;v, bool forward)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8h_source.html#l00291">xmipp_fft.h:291</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af090b2fbbd2916bfb2e493c5162969d6"><div class="ttname"><a href="numerical__recipes_8cpp.html#af090b2fbbd2916bfb2e493c5162969d6">b</a></div><div class="ttdeci">doublereal * b</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="classFourierTransformer_html_ad5e1b85f725814ca93f905c81e40b428"><div class="ttname"><a href="classFourierTransformer.html#ad5e1b85f725814ca93f905c81e40b428">FourierTransformer::setFourier</a></div><div class="ttdeci">void setFourier(const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;imgFourier)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00249">xmipp_fftw.cpp:249</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_af2a333b1670df64a88d3a2f22210d155"><div class="ttname"><a href="numerical__recipes_8cpp.html#af2a333b1670df64a88d3a2f22210d155">a</a></div><div class="ttdeci">doublereal * a</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga1075fe73c87077296a879f44ded3a2c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FFT_magnitude </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>mag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>FFT Magnitude 1D </p>

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00393">393</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;{</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    mag.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(v);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordtype">double</span> * ptrv=(<span class="keywordtype">double</span> *)<a class="code" href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a>(v);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(v)</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    {</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keywordtype">double</span> re=*ptrv;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordtype">double</span> im=*(ptrv+1);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(mag, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>) = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(re*re+im*im);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        ptrv+=2;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    }</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_gac87b223f03097d45f776b44b6aeea9f7"><div class="ttname"><a href="group__MultidimensionalArrays.html#gac87b223f03097d45f776b44b6aeea9f7">MULTIDIM_ARRAY</a></div><div class="ttdeci">#define MULTIDIM_ARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00136">multidim_array.h:136</a></div></div>
<div class="ttc" id="classMultidimArray_html_ac0efebfb32ab4e37cf33efca3349aa9b"><div class="ttname"><a href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">MultidimArray::resizeNoCopy</a></div><div class="ttdeci">void resizeNoCopy(const MultidimArray&lt; T1 &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01702">multidim_array.h:1702</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaf6a482858077274c31b02b996227adb0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FFT_phase </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>phase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>FFT Phase 1D </p>

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00408">408</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;{</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    phase.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(v);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(v)</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(phase, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>) = atan2(<a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(v,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>).imag(), <a class="code" href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(v, <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>).real());</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;}</div><div class="ttc" id="classMultidimArray_html_ac0efebfb32ab4e37cf33efca3349aa9b"><div class="ttname"><a href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">MultidimArray::resizeNoCopy</a></div><div class="ttdeci">void resizeNoCopy(const MultidimArray&lt; T1 &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01702">multidim_array.h:1702</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00171">multidim_array.h:171</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="group__MultidimensionalArrays.html#gad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00186">multidim_array.h:186</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02246">numerical_recipes.cpp:2246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga8c374ed577f5e03c4b248a3d9600aad1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void frc_dpr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>m1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>m2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sampling_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>freq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>frc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>frc_noise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>dpr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>error_l2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>skipdpr</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>doRfactor</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>minFreq</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxFreq</em> = <code>0.5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rFactor</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fourier-Ring-Correlation between two multidimArrays using FFT </p>

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00491">491</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;{</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordflow">if</span> (!m1.<a class="code" href="classMultidimArrayBase.html#a15e046b6c4b203b8a52a6acff9f1665b">sameShape</a>(m2))</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aaba89018a8188da52ee900de49a93ed78">ERR_MULTIDIM_SIZE</a>,<span class="stringliteral">&quot;MultidimArrays have different shapes!&quot;</span>);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordtype">int</span> m1sizeX = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(m1), m1sizeY = <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(m1), m1sizeZ = <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(m1);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; std::complex&lt; double &gt;</a> &gt; FT1;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <a class="code" href="classFourierTransformer.html">FourierTransformer</a> transformer1(FFTW_BACKWARD);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    transformer1.FourierTransform(m1, FT1, <span class="keyword">false</span>);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">//#define DEBUG</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;     std::cerr &lt;&lt; <span class="stringliteral">&quot;FT1&quot;</span> &lt;&lt; FT1 &lt;&lt; std::endl; </div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="preprocessor">#undef DEBUG</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    m1.<a class="code" href="classMultidimArray.html#ad198844075bf06ecf3bb66fd5c6b5695">clear</a>(); <span class="comment">// Free memory</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; std::complex&lt; double &gt;</a> &gt; FT2;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <a class="code" href="classFourierTransformer.html">FourierTransformer</a> transformer2(FFTW_BACKWARD);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    transformer2.FourierTransform(m2, FT2, <span class="keyword">false</span>);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    m2.<a class="code" href="classMultidimArray.html#ad198844075bf06ecf3bb66fd5c6b5695">clear</a>(); <span class="comment">// Free memory</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; int &gt;</a> radial_count(m1sizeX/2+1);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> num, den1, den2, den_dpr;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>(3);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">//to calculate r-factor</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordtype">double</span> rFactorNumerator=0;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keywordtype">double</span> rFactorDenominator=0;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    num.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(radial_count);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    den1.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(radial_count);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    den2.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(radial_count);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">//dpr calculation takes for ever in large volumes</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="comment">//since atan2 is called many times</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="comment">//until atan2 is changed by a table let us make dpr an option</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordflow">if</span> (dodpr)</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        dpr.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(radial_count);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        den_dpr.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(radial_count);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    }</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    freq.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(radial_count);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    frc.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(radial_count);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    frc_noise.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(radial_count);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    error_l2.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(radial_count);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="preprocessor">#ifdef SAVE_REAL_PART</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    std::vector&lt;double&gt; *realPart=</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="keyword">new</span> std::vector&lt;double&gt;[<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(radial_count)];</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordtype">int</span> sizeZ_2 = m1sizeZ/2;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">if</span> (sizeZ_2==0)</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        sizeZ_2=1;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordtype">double</span> isizeZ = 1.0/m1sizeZ;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordtype">int</span> sizeY_2 = m1sizeY/2;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordtype">double</span> iysize = 1.0/m1sizeY;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordtype">int</span> sizeX_2 = m1sizeX/2;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordtype">double</span> ixsize = 1.0/m1sizeX;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordtype">double</span> R;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordtype">int</span> ZdimFT1=(int)<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(FT1);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keywordtype">int</span> YdimFT1=(int)<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(FT1);</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordtype">int</span> XdimFT1=(int)<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(FT1);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordtype">double</span> maxFreq_2 =0.;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    maxFreq_2 = maxFreq * maxFreq;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>=0; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>&lt;ZdimFT1; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>++)</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    {</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <a class="code" href="group__Fourier.html#gaad2e5ba5b6e646b584e75bc982e233e8">FFT_IDX2DIGFREQ_FAST</a>(<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,m1sizeZ,sizeZ_2,isizeZ,<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>));</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="keywordtype">double</span> fz2=<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>)*<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;YdimFT1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            <a class="code" href="group__Fourier.html#gaad2e5ba5b6e646b584e75bc982e233e8">FFT_IDX2DIGFREQ_FAST</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(m1),sizeY_2, iysize, <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>));</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            <span class="keywordtype">double</span> fz2_fy2=fz2 + <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>)*<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;XdimFT1; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            {</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                <a class="code" href="group__Fourier.html#gaad2e5ba5b6e646b584e75bc982e233e8">FFT_IDX2DIGFREQ_FAST</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>,m1sizeX, sizeX_2, ixsize, <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>));</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                <span class="keywordtype">double</span> R2 =fz2_fy2 + <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>)*<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                <span class="keywordflow">if</span> (R2&gt;maxFreq_2)</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                R = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(R2);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                <span class="keywordtype">int</span> idx = (int)<a class="code" href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">round</a>(R * m1sizeX);</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                std::complex&lt;double&gt; &amp;z1 = <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(FT1, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                std::complex&lt;double&gt; &amp;z2 = <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(FT2, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                <span class="keywordtype">double</span> absz1 = <a class="code" href="image__operate_8cpp.html#ae1a7280fa539d74ebf884fe25fa8f5a8">abs</a>(z1);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                <span class="keywordtype">double</span> absz2 = <a class="code" href="image__operate_8cpp.html#ae1a7280fa539d74ebf884fe25fa8f5a8">abs</a>(z2);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(num,idx) += real(<a class="code" href="namespacealglib.html#a0fe83df1d04b0270f8cfaf97114082ff">conj</a>(z1) * z2);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(den1,idx) += absz1*absz1;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(den2,idx) += absz2*absz2;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(error_l2,idx) += <a class="code" href="image__operate_8cpp.html#ae1a7280fa539d74ebf884fe25fa8f5a8">abs</a>(z1-z2);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                <span class="comment">//for calculating r-factor</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                <span class="keywordflow">if</span> ( R &gt; minFreq &amp;&amp; R &lt; maxFreq)</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                {</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                    rFactorNumerator += fabs(absz1 - absz2);</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                    rFactorDenominator += absz1;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                }</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                <span class="keywordflow">if</span> (dodpr) <span class="comment">//this takes to long for a huge volume</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                {</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                    <span class="keywordtype">double</span> phaseDiff=atan2(z1.imag(),z1.real()) - atan2(z2.imag(),z2.real());</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                    phaseDiff = <a class="code" href="group__Macros.html#ga18b5ff2c19b69c072069398c7a5520cd">RAD2DEG</a>(phaseDiff);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                    phaseDiff = <a class="code" href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a>(phaseDiff,-180, 180);</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(dpr,idx) += ((absz1+absz2)*phaseDiff*phaseDiff);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                    <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(den_dpr,idx) += (absz1+absz2);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="preprocessor">#ifdef SAVE_REAL_PART</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                    realPart[idx].push_back(z1.real());</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                }</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(radial_count,idx)++;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            }</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        }</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    }</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="comment">//to calculate r-factor</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keywordflow">if</span> (doRfactor)</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    {</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="comment">//std::cout &lt;&lt; &quot;rFactorNumerator = &quot; &lt;&lt; rFactorNumerator &lt;&lt; std::endl;</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <span class="comment">//std::cout &lt;&lt; &quot;rFactorDenominator = &quot; &lt;&lt; rFactorDenominator &lt;&lt; std::endl;</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        *rFactor = rFactorNumerator / rFactorDenominator;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        </div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="comment">//std::cout &lt;&lt; &quot;R-factor = &quot; &lt;&lt; rFactorValue &lt;&lt; std::endl;</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="comment">//*rFactor = rFactorValue;</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="comment">//std::cout &lt;&lt; &quot;R-rFactor = &quot; &lt;&lt; *rFactor &lt;&lt; std::endl;</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    }</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#gaa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(freq)</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    {</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(freq,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = (double) <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> / (m1sizeX * sampling_rate);</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(frc,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(num,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)/<a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(<a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(den1,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)*<a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(den2,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(frc_noise,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = 2 / <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>((<span class="keywordtype">double</span>) <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(radial_count,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(error_l2,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) /= <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(radial_count,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="keywordflow">if</span> (dodpr)</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(dpr,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(<a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(dpr,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) / <a class="code" href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a>(den_dpr,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="preprocessor">#ifdef SAVE_REAL_PART</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        std::ofstream fhOut;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        fhOut.open(((<a class="code" href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">std::string</a>)<span class="stringliteral">&quot;PPP_RealPart_&quot;</span>+<a class="code" href="group__StringUtilities.html#ga01d0008bd87a0d41a3927e28b9f44b63">integerToString</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)+<span class="stringliteral">&quot;.txt&quot;</span>).</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                   c_str());</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;realPart[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            fhOut &lt;&lt; realPart[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>] &lt;&lt; std::endl;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        fhOut.close();</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    }</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;}</div><div class="ttc" id="namespacealglib_html_a0fe83df1d04b0270f8cfaf97114082ff"><div class="ttname"><a href="namespacealglib.html#a0fe83df1d04b0270f8cfaf97114082ff">alglib::conj</a></div><div class="ttdeci">alglib::complex conj(const alglib::complex &amp;z)</div><div class="ttdef"><b>Definition:</b> <a href="ap_8cpp_source.html#l04988">ap.cpp:4988</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00238">xmipp_error.h:238</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00207">image_operate.cpp:207</a></div></div>
<div class="ttc" id="namespacetesting_1_1internal_html_a8e8ff5b11e64078831112677156cb111"><div class="ttname"><a href="namespacetesting_1_1internal.html#a8e8ff5b11e64078831112677156cb111">testing::internal::string</a></div><div class="ttdeci">::std::string string</div><div class="ttdef"><b>Definition:</b> <a href="gtest_8h_source.html#l01818">gtest.h:1818</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_ae1a7280fa539d74ebf884fe25fa8f5a8"><div class="ttname"><a href="image__operate_8cpp.html#ae1a7280fa539d74ebf884fe25fa8f5a8">abs</a></div><div class="ttdeci">void abs(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00216">image_operate.cpp:216</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gafd91bd40ff4b515cade0323c37f21ac5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a></div><div class="ttdeci">#define dAkij(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00254">multidim_array.h:254</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aaba89018a8188da52ee900de49a93ed78"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aaba89018a8188da52ee900de49a93ed78">ERR_MULTIDIM_SIZE</a></div><div class="ttdoc">Incorrect MultidimArray size. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00179">xmipp_error.h:179</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaa924a84ae5fbf0ba6b4052eb9d92ef60"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00564">multidim_array.h:564</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="group__StringUtilities_html_ga01d0008bd87a0d41a3927e28b9f44b63"><div class="ttname"><a href="group__StringUtilities.html#ga01d0008bd87a0d41a3927e28b9f44b63">integerToString</a></div><div class="ttdeci">String integerToString(int I, int _width, char fill_with)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__strings_8cpp_source.html#l00261">xmipp_strings.cpp:261</a></div></div>
<div class="ttc" id="classFourierTransformer_html"><div class="ttname"><a href="classFourierTransformer.html">FourierTransformer</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00060">xmipp_fftw.h:60</a></div></div>
<div class="ttc" id="group__Fourier_html_gaad2e5ba5b6e646b584e75bc982e233e8"><div class="ttname"><a href="group__Fourier.html#gaad2e5ba5b6e646b584e75bc982e233e8">FFT_IDX2DIGFREQ_FAST</a></div><div class="ttdeci">#define FFT_IDX2DIGFREQ_FAST(idx, size, size_2, isize, freq)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8h_source.html#l00054">xmipp_fft.h:54</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a633de4b0c14ca52ea2432a3c8a5c4c31"><div class="ttname"><a href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a></div><div class="ttdeci">double * f</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04431">numerical_recipes.cpp:4431</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga53e37122134100316031eae982abee03"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga53e37122134100316031eae982abee03">dAi</a></div><div class="ttdeci">#define dAi(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00540">multidim_array.h:540</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="namespacealglib_html_a43452b10ffe26174e5d328a6ceb5fa9a"><div class="ttname"><a href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">alglib::round</a></div><div class="ttdeci">int round(double x)</div><div class="ttdef"><b>Definition:</b> <a href="ap_8cpp_source.html#l07245">ap.cpp:7245</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Macros_html_ga18b5ff2c19b69c072069398c7a5520cd"><div class="ttname"><a href="group__Macros.html#ga18b5ff2c19b69c072069398c7a5520cd">RAD2DEG</a></div><div class="ttdeci">#define RAD2DEG(r)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00320">xmipp_macros.h:320</a></div></div>
<div class="ttc" id="group__Macros_html_ga25935c2309abe02cff60809c4d7d9b9e"><div class="ttname"><a href="group__Macros.html#ga25935c2309abe02cff60809c4d7d9b9e">realWRAP</a></div><div class="ttdeci">#define realWRAP(x, x0, xF)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00304">xmipp_macros.h:304</a></div></div>
<div class="ttc" id="classMultidimArray_html_ad198844075bf06ecf3bb66fd5c6b5695"><div class="ttname"><a href="classMultidimArray.html#ad198844075bf06ecf3bb66fd5c6b5695">MultidimArray::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01302">multidim_array.h:1302</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a15e046b6c4b203b8a52a6acff9f1665b"><div class="ttname"><a href="classMultidimArrayBase.html#a15e046b6c4b203b8a52a6acff9f1665b">MultidimArrayBase::sameShape</a></div><div class="ttdeci">bool sameShape(const MultidimArrayBase &amp;op) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00945">multidim_array.h:945</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga413e8956e4db6633a403f42c7a87f5be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getSpectrum </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>spectrum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>spectrum_type</em> = <code><a class="el" href="group__FourierW.html#gac87527e6df256110f2f9f8abee98434c">AMPLITUDE_SPECTRUM</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the amplitude or power spectrum of the map in Fourier space.</p>
<p>i.e. the radial average of the (squared) amplitudes of all Fourier components </p>

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00752">752</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;{</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;std::complex&lt;double&gt;</a> &gt; Faux;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="keywordtype">int</span> xsize = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Min);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>(3);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> count(xsize);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <a class="code" href="classFourierTransformer.html">FourierTransformer</a> transformer;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    spectrum.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(xsize);</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    count.initZeros();</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    transformer.<a class="code" href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransform</a>(Min, Faux, <span class="keyword">false</span>);</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(Faux)==1)</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>)=0;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga46aa4ed12bd8706cfe1456ec6a8ab768">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D</a>(Faux)</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    {</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>,xsize,<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>));</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(Faux),<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>));</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(Faux)&gt;1)</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a>(<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(Faux),<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>));</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="keywordtype">double</span> R=<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>.module();</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <span class="comment">//if (R&gt;0.5) continue;</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        <span class="keywordtype">int</span> idx = <a class="code" href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">round</a>(R*xsize);</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        <span class="keywordtype">double</span> F=<a class="code" href="image__operate_8cpp.html#ae1a7280fa539d74ebf884fe25fa8f5a8">abs</a>(<a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(Faux, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <span class="keywordflow">if</span> (spectrum_type == <a class="code" href="group__FourierW.html#gac87527e6df256110f2f9f8abee98434c">AMPLITUDE_SPECTRUM</a>)</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(spectrum,idx) += F;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(spectrum,idx) += F*F;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(count,idx) += 1.;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    }</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; xsize; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(count,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &gt; 0.)</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(spectrum,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) /= <a class="code" href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a>(count,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;}</div><div class="ttc" id="group__MultidimensionalArrays_html_ga97809f7244a28aaa1c26e29e6e3204ef"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga97809f7244a28aaa1c26e29e6e3204ef">A1D_ELEM</a></div><div class="ttdeci">#define A1D_ELEM(v, i)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00549">multidim_array.h:549</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_ae1a7280fa539d74ebf884fe25fa8f5a8"><div class="ttname"><a href="image__operate_8cpp.html#ae1a7280fa539d74ebf884fe25fa8f5a8">abs</a></div><div class="ttdeci">void abs(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00216">image_operate.cpp:216</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gafd91bd40ff4b515cade0323c37f21ac5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a></div><div class="ttdeci">#define dAkij(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00254">multidim_array.h:254</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="classFourierTransformer_html"><div class="ttname"><a href="classFourierTransformer.html">FourierTransformer</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00060">xmipp_fftw.h:60</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a633de4b0c14ca52ea2432a3c8a5c4c31"><div class="ttname"><a href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a></div><div class="ttdeci">double * f</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04431">numerical_recipes.cpp:4431</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga46aa4ed12bd8706cfe1456ec6a8ab768"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga46aa4ed12bd8706cfe1456ec6a8ab768">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00332">multidim_array.h:332</a></div></div>
<div class="ttc" id="classFourierTransformer_html_abfdc5699d3c579a26bba39ec679b5adc"><div class="ttname"><a href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransformer::FourierTransform</a></div><div class="ttdeci">void FourierTransform(T &amp;v, T1 &amp;V, bool getCopy=true)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00166">xmipp_fftw.h:166</a></div></div>
<div class="ttc" id="cuda__gpu__reconstruct__fourier_8cpp_html_ac914a5e7c4e25d78f31f6ec3b1a93c5c"><div class="ttname"><a href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a></div><div class="ttdeci">__device__ float FFT_IDX2DIGFREQ(int idx, int size)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gpu__reconstruct__fourier_8cpp_source.html#l00382">cuda_gpu_reconstruct_fourier.cpp:382</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="namespacealglib_html_a43452b10ffe26174e5d328a6ceb5fa9a"><div class="ttname"><a href="namespacealglib.html#a43452b10ffe26174e5d328a6ceb5fa9a">alglib::round</a></div><div class="ttdeci">int round(double x)</div><div class="ttdef"><b>Definition:</b> <a href="ap_8cpp_source.html#l07245">ap.cpp:7245</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__FourierW_html_gac87527e6df256110f2f9f8abee98434c"><div class="ttname"><a href="group__FourierW.html#gac87527e6df256110f2f9f8abee98434c">AMPLITUDE_SPECTRUM</a></div><div class="ttdeci">#define AMPLITUDE_SPECTRUM</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00669">xmipp_fftw.h:669</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga9ca5712c85f0ad65ed9341bd3d3ca588"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multiplyBySpectrum </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>spectrum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>leave_origin_intact</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Multiply the input map in Fourier-space by the spectrum provided.</p>
<p>If leave_origin_intact==true, the origin pixel will remain untouched </p>

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00806">806</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;{</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    Min.checkDimension(3);</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;std::complex&lt;double&gt;</a> &gt; Faux;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>(3);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> lspectrum;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <a class="code" href="classFourierTransformer.html">FourierTransformer</a> transformer;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordtype">double</span> dim3 = <a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Min)*<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(Min)*<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(Min);</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    transformer.<a class="code" href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransform</a>(Min, Faux, <span class="keyword">false</span>);</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    lspectrum=spectrum;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keywordflow">if</span> (leave_origin_intact)</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        lspectrum(0)=1.;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga46aa4ed12bd8706cfe1456ec6a8ab768">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D</a>(Faux)</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    {</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>,<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Min), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>));</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(Faux),<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>));</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a>(<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(Faux),<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>));</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <span class="keywordtype">double</span> R=<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>.module();</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <span class="comment">//if (R &gt; 0.5) continue;</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <span class="keywordtype">int</span> idx=<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(R*<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Min));</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(Faux, <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>) *=  lspectrum(idx) * dim3;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    }</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    transformer.<a class="code" href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">inverseFourierTransform</a>();</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a1c8297f634bb4f9d1235f6c4fa33d7e5"><div class="ttname"><a href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">FourierTransformer::inverseFourierTransform</a></div><div class="ttdeci">void inverseFourierTransform()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00329">xmipp_fftw.cpp:329</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gafd91bd40ff4b515cade0323c37f21ac5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a></div><div class="ttdeci">#define dAkij(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00254">multidim_array.h:254</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="classFourierTransformer_html"><div class="ttname"><a href="classFourierTransformer.html">FourierTransformer</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00060">xmipp_fftw.h:60</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a633de4b0c14ca52ea2432a3c8a5c4c31"><div class="ttname"><a href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a></div><div class="ttdeci">double * f</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04431">numerical_recipes.cpp:4431</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga46aa4ed12bd8706cfe1456ec6a8ab768"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga46aa4ed12bd8706cfe1456ec6a8ab768">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00332">multidim_array.h:332</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="classFourierTransformer_html_abfdc5699d3c579a26bba39ec679b5adc"><div class="ttname"><a href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransformer::FourierTransform</a></div><div class="ttdeci">void FourierTransform(T &amp;v, T1 &amp;V, bool getCopy=true)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00166">xmipp_fftw.h:166</a></div></div>
<div class="ttc" id="cuda__gpu__reconstruct__fourier_8cpp_html_ac914a5e7c4e25d78f31f6ec3b1a93c5c"><div class="ttname"><a href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a></div><div class="ttdeci">__device__ float FFT_IDX2DIGFREQ(int idx, int size)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gpu__reconstruct__fourier_8cpp_source.html#l00382">cuda_gpu_reconstruct_fourier.cpp:382</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga056e51e524f058814b26d905dd0fcacd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void radial_magnitude </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>radialMagnitude</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>FFT Radial average. This function computes the Fourier transform (in a relatively inefficient way), the amplitude and radial average of the input image. This is primarily meant for debugging. It also returns the Fourier transform just in case it might be useful outside. </p>

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00416">416</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;{</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="group__Fourier.html#ga5fddf4cf6da360abdc8fd7d2f21fcbb9">FourierTransform</a>(v,V);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Vmag;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <a class="code" href="group__FourierW.html#ga1075fe73c87077296a879f44ded3a2c3">FFT_magnitude</a>(V,Vmag);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a>(Vmag,<span class="keyword">true</span>);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    Vmag.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;int&gt;</a> radialCount;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;int&gt;</a> center(3);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="group__GeometricalTransformations.html#ga82c19639b510d33894fe268664130410">radialAverage</a>(Vmag,center,radialMagnitude,radialCount);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00197">multidim_array.cpp:197</a></div></div>
<div class="ttc" id="group__Fourier_html_ga0447bcc3d329ad07e453b0d9b0872468"><div class="ttname"><a href="group__Fourier.html#ga0447bcc3d329ad07e453b0d9b0872468">CenterFFT</a></div><div class="ttdeci">void CenterFFT(MultidimArray&lt; T &gt; &amp;v, bool forward)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8h_source.html#l00291">xmipp_fft.h:291</a></div></div>
<div class="ttc" id="group__Fourier_html_ga5fddf4cf6da360abdc8fd7d2f21fcbb9"><div class="ttname"><a href="group__Fourier.html#ga5fddf4cf6da360abdc8fd7d2f21fcbb9">FourierTransform</a></div><div class="ttdeci">void FourierTransform(const MultidimArray&lt; double &gt; &amp;in, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fft_8cpp_source.html#l00124">xmipp_fft.cpp:124</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga82c19639b510d33894fe268664130410"><div class="ttname"><a href="group__GeometricalTransformations.html#ga82c19639b510d33894fe268664130410">radialAverage</a></div><div class="ttdeci">void radialAverage(const MultidimArray&lt; T &gt; &amp;m, Matrix1D&lt; int &gt; &amp;center_of_rot, MultidimArray&lt; T &gt; &amp;radial_mean, MultidimArray&lt; int &gt; &amp;radial_count, const bool &amp;rounding=false)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01575">transformations.h:1575</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; int &gt;</a></div></div>
<div class="ttc" id="group__FourierW_html_ga1075fe73c87077296a879f44ded3a2c3"><div class="ttname"><a href="group__FourierW.html#ga1075fe73c87077296a879f44ded3a2c3">FFT_magnitude</a></div><div class="ttdeci">void FFT_magnitude(const MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;v, MultidimArray&lt; double &gt; &amp;mag)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00393">xmipp_fftw.cpp:393</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gabcacc0c11d22f96340b07177f2c0b9ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void randomizePhases </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wRandom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Randomize phases beyond a certain frequency </p>

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00981">981</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;{</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <a class="code" href="classFourierTransformer.html">FourierTransformer</a> transformer;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt; std::complex&lt;double&gt;</a> &gt; F;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    transformer.<a class="code" href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransform</a>(Min,F,<span class="keyword">false</span>);</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>(3);</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <a class="code" href="group__MultidimensionalArrays.html#ga46aa4ed12bd8706cfe1456ec6a8ab768">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D</a>(F)</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    {</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>,<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Min), <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>));</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(F),<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>));</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        <a class="code" href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a>(<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(F),<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>));</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a>=<a class="code" href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a>.module();</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        <span class="keywordflow">if</span> (w &gt; wRandom)</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        {</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            <span class="keywordtype">double</span> alpha=<a class="code" href="group__GeneralFunctions.html#ga882088c3e41f9fdd7c357e868c001ed5">rnd_unif</a>(0,2*<a class="code" href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>);</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>,s;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#ga343bb99185c21cb45ddf83ffa06f9198">sincos</a>(alpha,&amp;s,&amp;c);</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;            <a class="code" href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a>(F,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)*=std::complex&lt;double&gt;(s,<a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>);</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        }</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    }</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    transformer.<a class="code" href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">inverseFourierTransform</a>();</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a1c8297f634bb4f9d1235f6c4fa33d7e5"><div class="ttname"><a href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">FourierTransformer::inverseFourierTransform</a></div><div class="ttdeci">void inverseFourierTransform()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00329">xmipp_fftw.cpp:329</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gacac7be97c37bd2e4f801976749de839c"><div class="ttname"><a href="group__MultidimensionalArrays.html#gacac7be97c37bd2e4f801976749de839c">DIRECT_A3D_ELEM</a></div><div class="ttdeci">#define DIRECT_A3D_ELEM(v, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00249">multidim_array.h:249</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a2b83edee7677c7a2b0a4e5ac99baa586"><div class="ttname"><a href="numerical__recipes_8cpp.html#a2b83edee7677c7a2b0a4e5ac99baa586">w</a></div><div class="ttdeci">doublereal * w</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02494">numerical_recipes.cpp:2494</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="classFourierTransformer_html"><div class="ttname"><a href="classFourierTransformer.html">FourierTransformer</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00060">xmipp_fftw.h:60</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga882088c3e41f9fdd7c357e868c001ed5"><div class="ttname"><a href="group__GeneralFunctions.html#ga882088c3e41f9fdd7c357e868c001ed5">rnd_unif</a></div><div class="ttdeci">double rnd_unif()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00431">xmipp_funcs.cpp:431</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00088">matrix1d.h:88</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a633de4b0c14ca52ea2432a3c8a5c4c31"><div class="ttname"><a href="numerical__recipes_8cpp.html#a633de4b0c14ca52ea2432a3c8a5c4c31">f</a></div><div class="ttdeci">double * f</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04431">numerical_recipes.cpp:4431</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga46aa4ed12bd8706cfe1456ec6a8ab768"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga46aa4ed12bd8706cfe1456ec6a8ab768">FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_ARRAY3D(V)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00332">multidim_array.h:332</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga343bb99185c21cb45ddf83ffa06f9198"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga343bb99185c21cb45ddf83ffa06f9198">sincos</a></div><div class="ttdeci">void sincos(const MultidimArray&lt; double &gt; &amp;x, MultidimArray&lt; double &gt; &amp;s, MultidimArray&lt; double &gt; &amp;c)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8cpp_source.html#l00593">multidim_array.cpp:593</a></div></div>
<div class="ttc" id="classFourierTransformer_html_abfdc5699d3c579a26bba39ec679b5adc"><div class="ttname"><a href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransformer::FourierTransform</a></div><div class="ttdeci">void FourierTransform(T &amp;v, T1 &amp;V, bool getCopy=true)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00166">xmipp_fftw.h:166</a></div></div>
<div class="ttc" id="cuda__gpu__reconstruct__fourier_8cpp_html_ac914a5e7c4e25d78f31f6ec3b1a93c5c"><div class="ttname"><a href="cuda__gpu__reconstruct__fourier_8cpp.html#ac914a5e7c4e25d78f31f6ec3b1a93c5c">FFT_IDX2DIGFREQ</a></div><div class="ttdeci">__device__ float FFT_IDX2DIGFREQ(int idx, int size)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__gpu__reconstruct__fourier_8cpp_source.html#l00382">cuda_gpu_reconstruct_fourier.cpp:382</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00096">matrix1d.h:96</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="tools_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="tools_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="tools_8h_source.html#l00043">tools.h:43</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00104">matrix1d.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga3f36d5bfdef3419f111767c58c79e237"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void scaleToSizeFourier </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Zdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>mdaIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>mdaOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nThreads</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Scale matrix using Fourier transform</p>
<p>Ydim and Xdim define the output size, mda is the <a class="el" href="classMultidimArray.html">MultidimArray</a> to scale </p>

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00658">658</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;{</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="comment">//Mmem = *this</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="comment">//memory for fourier transform output</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;std::complex&lt;double&gt;</a> &gt; MmemFourier;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="comment">// Perform the Fourier transform</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="classFourierTransformer.html">FourierTransformer</a> transformerM;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    transformerM.<a class="code" href="classFourierTransformer.html#ac2b33024c8231d5f0324037ac347e15c">setThreadsNumber</a>(nThreads);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    transformerM.<a class="code" href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransform</a>(mdaIn, MmemFourier, <span class="keyword">false</span>);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="comment">// Create space for the downsampled image and its Fourier transform</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    mdaOut.<a class="code" href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">resizeNoCopy</a>(Zdim, Ydim, Xdim);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;std::complex&lt;double&gt;</a> &gt; MpmemFourier;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <a class="code" href="classFourierTransformer.html">FourierTransformer</a> transformerMp;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    transformerMp.<a class="code" href="classFourierTransformer.html#a18bc840c781555b742d0185fb20925bf">setReal</a>(mdaOut);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    transformerMp.<a class="code" href="classFourierTransformer.html#a6335c9c01f240a8edf3b363cef43248b">getFourierAlias</a>(MpmemFourier);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <a class="code" href="group__FourierW.html#ga3f36d5bfdef3419f111767c58c79e237">scaleToSizeFourier</a>(mdaIn, mdaOut, MmemFourier, MpmemFourier);</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="comment">// Transform data</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    transformerMp.<a class="code" href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">inverseFourierTransform</a>();</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray</a></div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00623">multidim_array.h:623</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a1c8297f634bb4f9d1235f6c4fa33d7e5"><div class="ttname"><a href="classFourierTransformer.html#a1c8297f634bb4f9d1235f6c4fa33d7e5">FourierTransformer::inverseFourierTransform</a></div><div class="ttdeci">void inverseFourierTransform()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00329">xmipp_fftw.cpp:329</a></div></div>
<div class="ttc" id="classFourierTransformer_html_ac2b33024c8231d5f0324037ac347e15c"><div class="ttname"><a href="classFourierTransformer.html#ac2b33024c8231d5f0324037ac347e15c">FourierTransformer::setThreadsNumber</a></div><div class="ttdeci">void setThreadsNumber(int tNumber)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00119">xmipp_fftw.h:119</a></div></div>
<div class="ttc" id="classMultidimArray_html_ac0efebfb32ab4e37cf33efca3349aa9b"><div class="ttname"><a href="classMultidimArray.html#ac0efebfb32ab4e37cf33efca3349aa9b">MultidimArray::resizeNoCopy</a></div><div class="ttdeci">void resizeNoCopy(const MultidimArray&lt; T1 &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01702">multidim_array.h:1702</a></div></div>
<div class="ttc" id="classFourierTransformer_html"><div class="ttname"><a href="classFourierTransformer.html">FourierTransformer</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00060">xmipp_fftw.h:60</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a18bc840c781555b742d0185fb20925bf"><div class="ttname"><a href="classFourierTransformer.html#a18bc840c781555b742d0185fb20925bf">FourierTransformer::setReal</a></div><div class="ttdeci">void setReal(MultidimArray&lt; double &gt; &amp;img)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00129">xmipp_fftw.cpp:129</a></div></div>
<div class="ttc" id="group__FourierW_html_ga3f36d5bfdef3419f111767c58c79e237"><div class="ttname"><a href="group__FourierW.html#ga3f36d5bfdef3419f111767c58c79e237">scaleToSizeFourier</a></div><div class="ttdeci">void scaleToSizeFourier(int Zdim, int Ydim, int Xdim, MultidimArray&lt; double &gt; &amp;mdaIn, MultidimArray&lt; double &gt; &amp;mdaOut, int nThreads)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00658">xmipp_fftw.cpp:658</a></div></div>
<div class="ttc" id="classFourierTransformer_html_abfdc5699d3c579a26bba39ec679b5adc"><div class="ttname"><a href="classFourierTransformer.html#abfdc5699d3c579a26bba39ec679b5adc">FourierTransformer::FourierTransform</a></div><div class="ttdeci">void FourierTransform(T &amp;v, T1 &amp;V, bool getCopy=true)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00166">xmipp_fftw.h:166</a></div></div>
<div class="ttc" id="classFourierTransformer_html_a6335c9c01f240a8edf3b363cef43248b"><div class="ttname"><a href="classFourierTransformer.html#a6335c9c01f240a8edf3b363cef43248b">FourierTransformer::getFourierAlias</a></div><div class="ttdeci">void getFourierAlias(T &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00207">xmipp_fftw.h:207</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga9ddb42c0ed909ee75a2124d8d370f7da"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void scaleToSizeFourier </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>mdaIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>mdaOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; T &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>inFourier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; std::complex&lt; T &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>outFourier</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Scale Fourier transform mdaIn and mdaOut define the sizes of the respective image, inFourier is transform to be scaled </p>

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00685">685</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                                                                                             {</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordtype">size_t</span> xsize = <a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(inFourier),<a class="code" href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(outFourier))*<span class="keyword">sizeof</span>(std::complex&lt;T&gt;);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordtype">size_t</span> yhalf = <a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(<a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(mdaIn)/2,<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(mdaOut)/2),<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(mdaIn)-1);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordtype">size_t</span> zhalf = <a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(<a class="code" href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">std::min</a>(<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(mdaIn)/2,<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(mdaOut)/2),<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(mdaIn)-1);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keywordtype">size_t</span> kp0=0;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keywordtype">size_t</span> kpF=zhalf;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordtype">size_t</span> ip0=0;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordtype">size_t</span> ipF=yhalf;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordtype">size_t</span> km0=<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(inFourier)&gt;=<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(outFourier)?(kpF+1):(<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(outFourier)-(<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(inFourier)-(zhalf+1)));</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordtype">size_t</span> kmF=<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(outFourier)-1;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="keywordtype">size_t</span> im0=<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(inFourier)&gt;=<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(outFourier)?(ipF+1):(<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(outFourier)-(<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(inFourier)-(yhalf+1)));</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordtype">size_t</span> imF=<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(outFourier)-1;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="comment">//Init with zero</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    outFourier.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>();</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> = kp0; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>&lt;=kpF; ++<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>)</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    {</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=ip0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;=ipF; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            memcpy(&amp;<a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(outFourier,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,0),&amp;<a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(inFourier,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,0),xsize);</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=im0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;=imF; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            <span class="keywordtype">size_t</span> ip = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(inFourier)-<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(outFourier) ;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            memcpy(&amp;<a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(outFourier,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,0),&amp;<a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(inFourier,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,ip,0),xsize);</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        }</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    }</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> = km0; <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>&lt;=kmF; ++<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>) {</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="keywordtype">size_t</span> kp = <a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a> + <a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(inFourier)-<a class="code" href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a>(outFourier) ;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=ip0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;=ipF; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            memcpy(&amp;<a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(outFourier,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,0),&amp;<a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(inFourier,kp,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,0),xsize);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=im0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;=imF; ++<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            <span class="keywordtype">size_t</span> ip = <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + <a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(inFourier)-<a class="code" href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(outFourier) ;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            memcpy(&amp;<a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(outFourier,<a class="code" href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,0),&amp;<a class="code" href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a>(inFourier,kp,ip,0),xsize);</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        }</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    }</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;}</div><div class="ttc" id="image__operate_8cpp_html_afbbd36781c10524238c70745c6f6f35d"><div class="ttname"><a href="image__operate_8cpp.html#afbbd36781c10524238c70745c6f6f35d">min</a></div><div class="ttdeci">void min(Image&lt; double &gt; &amp;op1, const Image&lt; double &gt; &amp;op2)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00115">image_operate.cpp:115</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gafd91bd40ff4b515cade0323c37f21ac5"><div class="ttname"><a href="group__MultidimensionalArrays.html#gafd91bd40ff4b515cade0323c37f21ac5">dAkij</a></div><div class="ttdeci">#define dAkij(V, k, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00254">multidim_array.h:254</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00101">multidim_array.h:101</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02510">numerical_recipes.cpp:2510</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_gaddfd06191afb42c978fdfaca85bb029e"><div class="ttname"><a href="group__MultidimensionalArrays.html#gaddfd06191afb42c978fdfaca85bb029e">ZSIZE</a></div><div class="ttdeci">#define ZSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00109">multidim_array.h:109</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l00105">multidim_array.h:105</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a3cea5ad1d3a8a229f9483e49cc2c6656"><div class="ttname"><a href="numerical__recipes_8cpp.html#a3cea5ad1d3a8a229f9483e49cc2c6656">k</a></div><div class="ttdeci">ql0001_ &amp; k(htemp+1),(cvec+1),(atemp+1),(bj+1),(bl+1),(bu+1),(x+1),(clamda+1),&amp;iout, infoqp,&amp;zero,(w+1),&amp;lenw,(iw+1),&amp;leniw,&amp;glob_grd.epsmac</div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l04327">multidim_array.h:4327</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga4bc1a5f3ae70b0c7ba4afb7c7a16c643"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void selfScaleToSizeFourier </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Zdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>mda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nthreads</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00723">723</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;{</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> aux;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <a class="code" href="group__FourierW.html#ga3f36d5bfdef3419f111767c58c79e237">scaleToSizeFourier</a>(Zdim, Ydim, Xdim, mda, aux, nThreads);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  mda=aux;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__FourierW_html_ga3f36d5bfdef3419f111767c58c79e237"><div class="ttname"><a href="group__FourierW.html#ga3f36d5bfdef3419f111767c58c79e237">scaleToSizeFourier</a></div><div class="ttdeci">void scaleToSizeFourier(int Zdim, int Ydim, int Xdim, MultidimArray&lt; double &gt; &amp;mdaIn, MultidimArray&lt; double &gt; &amp;mdaOut, int nThreads)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00658">xmipp_fftw.cpp:658</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga2a756f69fe269fd21fc0f19ac077fb19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void selfScaleToSizeFourier </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>mda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nthreads</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00731">731</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;{</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <a class="code" href="group__FourierW.html#ga4bc1a5f3ae70b0c7ba4afb7c7a16c643">selfScaleToSizeFourier</a>(1, Ydim, Xdim, Mpmem, nThreads);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;}</div><div class="ttc" id="group__FourierW_html_ga4bc1a5f3ae70b0c7ba4afb7c7a16c643"><div class="ttname"><a href="group__FourierW.html#ga4bc1a5f3ae70b0c7ba4afb7c7a16c643">selfScaleToSizeFourier</a></div><div class="ttdeci">void selfScaleToSizeFourier(int Zdim, int Ydim, int Xdim, MultidimArray&lt; double &gt; &amp;mda, int nThreads)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00723">xmipp_fftw.cpp:723</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gadbd60dc61ca05a56d9366e76ecba0df2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void selfScaleToSizeFourier </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Zdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;&#160;</td>
          <td class="paramname"><em>mda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nthreads</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> version </p>

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00736">736</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;{</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> aux;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    Mpmem.<a class="code" href="classMultidimArray.html#a9c2df6500d4a7e832632051d529d6798">getImage</a>(aux);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <a class="code" href="group__FourierW.html#ga4bc1a5f3ae70b0c7ba4afb7c7a16c643">selfScaleToSizeFourier</a>(Zdim, Ydim, Xdim, aux, nThreads);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    Mpmem.setImage(aux);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classMultidimArray_html_a9c2df6500d4a7e832632051d529d6798"><div class="ttname"><a href="classMultidimArray.html#a9c2df6500d4a7e832632051d529d6798">MultidimArray::getImage</a></div><div class="ttdeci">void getImage(size_t n, MultidimArray&lt; T &gt; &amp;M, size_t n2=0) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02075">multidim_array.h:2075</a></div></div>
<div class="ttc" id="group__FourierW_html_ga4bc1a5f3ae70b0c7ba4afb7c7a16c643"><div class="ttname"><a href="group__FourierW.html#ga4bc1a5f3ae70b0c7ba4afb7c7a16c643">selfScaleToSizeFourier</a></div><div class="ttdeci">void selfScaleToSizeFourier(int Zdim, int Ydim, int Xdim, MultidimArray&lt; double &gt; &amp;mda, int nThreads)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00723">xmipp_fftw.cpp:723</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaeb3997610c0c69200880ecfb6e24e06a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void selfScaleToSizeFourier </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Ydim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Xdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArrayGeneric.html">MultidimArrayGeneric</a> &amp;&#160;</td>
          <td class="paramname"><em>mda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nthreads</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00744">744</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;{</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> aux;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    Mpmem.<a class="code" href="classMultidimArray.html#a9c2df6500d4a7e832632051d529d6798">getImage</a>(aux);</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <a class="code" href="group__FourierW.html#ga4bc1a5f3ae70b0c7ba4afb7c7a16c643">selfScaleToSizeFourier</a>(1, Ydim, Xdim, aux, nThreads);</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    Mpmem.setImage(aux);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classMultidimArray_html_a9c2df6500d4a7e832632051d529d6798"><div class="ttname"><a href="classMultidimArray.html#a9c2df6500d4a7e832632051d529d6798">MultidimArray::getImage</a></div><div class="ttdeci">void getImage(size_t n, MultidimArray&lt; T &gt; &amp;M, size_t n2=0) const </div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02075">multidim_array.h:2075</a></div></div>
<div class="ttc" id="group__FourierW_html_ga4bc1a5f3ae70b0c7ba4afb7c7a16c643"><div class="ttname"><a href="group__FourierW.html#ga4bc1a5f3ae70b0c7ba4afb7c7a16c643">selfScaleToSizeFourier</a></div><div class="ttdeci">void selfScaleToSizeFourier(int Zdim, int Ydim, int Xdim, MultidimArray&lt; double &gt; &amp;mda, int nThreads)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00723">xmipp_fftw.cpp:723</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga4f2da3c6806ff7438cac1ff751a64e76"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void whitenSpectrum </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Mout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>spectrum_type</em> = <code><a class="el" href="group__FourierW.html#gac87527e6df256110f2f9f8abee98434c">AMPLITUDE_SPECTRUM</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>leave_origin_intact</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Perform a whitening of the amplitude/power spectrum of a 3D map</p>
<p>If leave_origin_intact==true, the origin pixel will remain untouched </p>

<p>Definition at line <a class="el" href="xmipp__fftw_8cpp_source.html#l00835">835</a> of file <a class="el" href="xmipp__fftw_8cpp_source.html">xmipp_fftw.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;{</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    Min.checkDimension(3);</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> spectrum;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <a class="code" href="group__FourierW.html#ga413e8956e4db6633a403f42c7a87f5be">getSpectrum</a>(Min,spectrum,spectrum_type);</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    Mout=Min;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <a class="code" href="group__FourierW.html#ga1f55fcd5fa2ba859cc73dd34daa55694">divideBySpectrum</a>(Mout,spectrum,leave_origin_intact);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__FourierW_html_ga413e8956e4db6633a403f42c7a87f5be"><div class="ttname"><a href="group__FourierW.html#ga413e8956e4db6633a403f42c7a87f5be">getSpectrum</a></div><div class="ttdeci">void getSpectrum(MultidimArray&lt; double &gt; &amp;Min, MultidimArray&lt; double &gt; &amp;spectrum, int spectrum_type)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00752">xmipp_fftw.cpp:752</a></div></div>
<div class="ttc" id="group__FourierW_html_ga1f55fcd5fa2ba859cc73dd34daa55694"><div class="ttname"><a href="group__FourierW.html#ga1f55fcd5fa2ba859cc73dd34daa55694">divideBySpectrum</a></div><div class="ttdeci">void divideBySpectrum(MultidimArray&lt; double &gt; &amp;Min, MultidimArray&lt; double &gt; &amp;spectrum, bool leave_origin_intact)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8cpp_source.html#l00788">xmipp_fftw.cpp:788</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
