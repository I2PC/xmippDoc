<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Xmipp: ProgTomographAlignment Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classProgTomographAlignment-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ProgTomographAlignment Class Reference<div class="ingroups"><a class="el" href="group__Libraries.html">Libraries</a> &raquo; <a class="el" href="group__ReconsLibrary.html">Reconstruction library</a> &raquo; <a class="el" href="group__AngularAssignTiltSeries.html">angular_assign_for_tilt_series</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for ProgTomographAlignment:</div>
<div class="dyncontent">
<div class="center"><img src="classProgTomographAlignment__inherit__graph.png" border="0" usemap="#ProgTomographAlignment_inherit__map" alt="Inheritance graph"/></div>
<map name="ProgTomographAlignment_inherit__map" id="ProgTomographAlignment_inherit__map">
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for ProgTomographAlignment:</div>
<div class="dyncontent">
<div class="center"><img src="classProgTomographAlignment__coll__graph.png" border="0" usemap="#ProgTomographAlignment_coll__map" alt="Collaboration graph"/></div>
<map name="ProgTomographAlignment_coll__map" id="ProgTomographAlignment_coll__map">
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad8fea94a4e12305a28cd5db61c8aa9da"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#ad8fea94a4e12305a28cd5db61c8aa9da">~ProgTomographAlignment</a> ()</td></tr>
<tr class="memdesc:ad8fea94a4e12305a28cd5db61c8aa9da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#ad8fea94a4e12305a28cd5db61c8aa9da">More...</a><br /></td></tr>
<tr class="separator:ad8fea94a4e12305a28cd5db61c8aa9da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57760862c9717e14229406d7ce5a1d5b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a57760862c9717e14229406d7ce5a1d5b">defineParams</a> ()</td></tr>
<tr class="memdesc:a57760862c9717e14229406d7ce5a1d5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Usage.  <a href="#a57760862c9717e14229406d7ce5a1d5b">More...</a><br /></td></tr>
<tr class="separator:a57760862c9717e14229406d7ce5a1d5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9064764db12c587c6d3020a669b84f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#af9064764db12c587c6d3020a669b84f8">readParams</a> ()</td></tr>
<tr class="memdesc:af9064764db12c587c6d3020a669b84f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read parameters from argument line.  <a href="#af9064764db12c587c6d3020a669b84f8">More...</a><br /></td></tr>
<tr class="separator:af9064764db12c587c6d3020a669b84f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0877ab8be30e3bb26a7c1457b3f988b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a0877ab8be30e3bb26a7c1457b3f988b6">show</a> ()</td></tr>
<tr class="memdesc:a0877ab8be30e3bb26a7c1457b3f988b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Show parameters.  <a href="#a0877ab8be30e3bb26a7c1457b3f988b6">More...</a><br /></td></tr>
<tr class="separator:a0877ab8be30e3bb26a7c1457b3f988b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd582a8a73ef7bbc7855de16a2ebc549"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#afd582a8a73ef7bbc7855de16a2ebc549">produceSideInfo</a> ()</td></tr>
<tr class="memdesc:afd582a8a73ef7bbc7855de16a2ebc549"><td class="mdescLeft">&#160;</td><td class="mdescRight">Produce side info.  <a href="#afd582a8a73ef7bbc7855de16a2ebc549">More...</a><br /></td></tr>
<tr class="separator:afd582a8a73ef7bbc7855de16a2ebc549"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa83c07ba49b99652c116cf2a1e8d6649"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#aa83c07ba49b99652c116cf2a1e8d6649">computeAffineTransformations</a> (bool globalAffineToUse)</td></tr>
<tr class="memdesc:aa83c07ba49b99652c116cf2a1e8d6649"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute affine transformations.  <a href="#aa83c07ba49b99652c116cf2a1e8d6649">More...</a><br /></td></tr>
<tr class="separator:aa83c07ba49b99652c116cf2a1e8d6649"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd76d988df1c69f11fafd277735bc7ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#afd76d988df1c69f11fafd277735bc7ea">identifyOutliers</a> (bool mark)</td></tr>
<tr class="memdesc:afd76d988df1c69f11fafd277735bc7ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Identify outliers.  <a href="#afd76d988df1c69f11fafd277735bc7ea">More...</a><br /></td></tr>
<tr class="separator:afd76d988df1c69f11fafd277735bc7ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e5ae6536e56d2cde3f18ca346f4fb12"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a6e5ae6536e56d2cde3f18ca346f4fb12">produceInformationFromLandmarks</a> ()</td></tr>
<tr class="memdesc:a6e5ae6536e56d2cde3f18ca346f4fb12"><td class="mdescLeft">&#160;</td><td class="mdescRight">Produce information from landmarks.  <a href="#a6e5ae6536e56d2cde3f18ca346f4fb12">More...</a><br /></td></tr>
<tr class="separator:a6e5ae6536e56d2cde3f18ca346f4fb12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5fecb6b28507271d09ffaa4e1992002"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#ad5fecb6b28507271d09ffaa4e1992002">refineLandmark</a> (int ii, int jj, const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;rii, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;rjj, double &amp;maxCorr, bool tryFourier) const</td></tr>
<tr class="separator:ad5fecb6b28507271d09ffaa4e1992002"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a387b25aadbee74d9e836e6ceeb77d4f6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a387b25aadbee74d9e836e6ceeb77d4f6">refineLandmark</a> (const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;pieceii, int jj, <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;rjj, double actualCorrThreshold, bool reversed, double &amp;maxCorr) const</td></tr>
<tr class="separator:a387b25aadbee74d9e836e6ceeb77d4f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a968c833c064d84da0631ae87c338276f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a968c833c064d84da0631ae87c338276f">refineChain</a> (<a class="el" href="group__AngularAssignTiltSeries.html#ga2227270b50623022cd6d9079e54299fb">LandmarkChain</a> &amp;chain, double &amp;corrChain)</td></tr>
<tr class="separator:a968c833c064d84da0631ae87c338276f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a871a94ad24fb5bc94113b3f14eafb0d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a871a94ad24fb5bc94113b3f14eafb0d1">generateLandmarkSet</a> ()</td></tr>
<tr class="memdesc:a871a94ad24fb5bc94113b3f14eafb0d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate landmark set using a grid.  <a href="#a871a94ad24fb5bc94113b3f14eafb0d1">More...</a><br /></td></tr>
<tr class="separator:a871a94ad24fb5bc94113b3f14eafb0d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76ef40d145be5f5402a03db800afcf8c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a76ef40d145be5f5402a03db800afcf8c">writeLandmarkSet</a> (const <a class="el" href="classFileName.html">FileName</a> &amp;fnLandmark) const</td></tr>
<tr class="memdesc:a76ef40d145be5f5402a03db800afcf8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write landmark set.  <a href="#a76ef40d145be5f5402a03db800afcf8c">More...</a><br /></td></tr>
<tr class="separator:a76ef40d145be5f5402a03db800afcf8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c7337a8112cc8f29c52cf6ff51d3efd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a0c7337a8112cc8f29c52cf6ff51d3efd">writeTransformations</a> (const <a class="el" href="classFileName.html">FileName</a> &amp;fnTransformations) const</td></tr>
<tr class="memdesc:a0c7337a8112cc8f29c52cf6ff51d3efd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write affine transformations.  <a href="#a0c7337a8112cc8f29c52cf6ff51d3efd">More...</a><br /></td></tr>
<tr class="separator:a0c7337a8112cc8f29c52cf6ff51d3efd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d145dc60698a6cc03446b620c307a2b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a1d145dc60698a6cc03446b620c307a2b">readLandmarkSet</a> (const <a class="el" href="classFileName.html">FileName</a> &amp;fnLandmark)</td></tr>
<tr class="memdesc:a1d145dc60698a6cc03446b620c307a2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read landmark set.  <a href="#a1d145dc60698a6cc03446b620c307a2b">More...</a><br /></td></tr>
<tr class="separator:a1d145dc60698a6cc03446b620c307a2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b723a0c1186f78b966c571b72461f5d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a8b723a0c1186f78b966c571b72461f5d">removeOutlierLandmarks</a> (const <a class="el" href="classAlignment.html">Alignment</a> &amp;alignment)</td></tr>
<tr class="memdesc:a8b723a0c1186f78b966c571b72461f5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove Outliers.  <a href="#a8b723a0c1186f78b966c571b72461f5d">More...</a><br /></td></tr>
<tr class="separator:a8b723a0c1186f78b966c571b72461f5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fae052aa646288c9956211bf02540c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a5fae052aa646288c9956211bf02540c4">alignImages</a> (const <a class="el" href="classAlignment.html">Alignment</a> &amp;alignment)</td></tr>
<tr class="memdesc:a5fae052aa646288c9956211bf02540c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Align images.  <a href="#a5fae052aa646288c9956211bf02540c4">More...</a><br /></td></tr>
<tr class="separator:a5fae052aa646288c9956211bf02540c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb8aac8bd97ca8f399606f9d81b53ce6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#acb8aac8bd97ca8f399606f9d81b53ce6">run</a> ()</td></tr>
<tr class="memdesc:acb8aac8bd97ca8f399606f9d81b53ce6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run: do the real work.  <a href="#acb8aac8bd97ca8f399606f9d81b53ce6">More...</a><br /></td></tr>
<tr class="separator:acb8aac8bd97ca8f399606f9d81b53ce6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classXmippProgram"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classXmippProgram')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classXmippProgram.html">XmippProgram</a></td></tr>
<tr class="memitem:a5d9e1f008822effa47814c59e9a3c797 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a5d9e1f008822effa47814c59e9a3c797">getParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, int arg=0)</td></tr>
<tr class="separator:a5d9e1f008822effa47814c59e9a3c797 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8e51e73a487e0d53408dc84ebbe6655 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#af8e51e73a487e0d53408dc84ebbe6655">getParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, const char *subparam, int arg=0)</td></tr>
<tr class="separator:af8e51e73a487e0d53408dc84ebbe6655 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b7ddf0836dc1079ea2622e2a420c39c inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, int arg=0)</td></tr>
<tr class="separator:a7b7ddf0836dc1079ea2622e2a420c39c inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1da1a25db76959a3e747d0ebd34512a4 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a1da1a25db76959a3e747d0ebd34512a4">getIntParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, const char *subparam, int arg=0)</td></tr>
<tr class="separator:a1da1a25db76959a3e747d0ebd34512a4 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a552e1ea4a84576d9149b965d9edb6277 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, int arg=0)</td></tr>
<tr class="separator:a552e1ea4a84576d9149b965d9edb6277 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4becd069f9a9fefe06cbdd60e238db5 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aa4becd069f9a9fefe06cbdd60e238db5">getDoubleParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, const char *subparam, int arg=0)</td></tr>
<tr class="separator:aa4becd069f9a9fefe06cbdd60e238db5 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a6a41fe4825fef94e4f6c7f43410eba inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a8a6a41fe4825fef94e4f6c7f43410eba">getFloatParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, int arg=0)</td></tr>
<tr class="separator:a8a6a41fe4825fef94e4f6c7f43410eba inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30f2ab8cd0c2af3673dc208094f2efd7 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a30f2ab8cd0c2af3673dc208094f2efd7">getFloatParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, const char *subparam, int arg=0)</td></tr>
<tr class="separator:a30f2ab8cd0c2af3673dc208094f2efd7 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f7511fbf474a4752f9a472138b64089 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a6f7511fbf474a4752f9a472138b64089">getListParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, <a class="el" href="xmipp__strings_8h.html#ab7db7f89faba290ac54cc52f052795e7">StringVector</a> &amp;list)</td></tr>
<tr class="separator:a6f7511fbf474a4752f9a472138b64089 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9deab8bd129383d08e390ff15c185c62 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a9deab8bd129383d08e390ff15c185c62">getCountParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>)</td></tr>
<tr class="separator:a9deab8bd129383d08e390ff15c185c62 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a27c450de95c55d122be23e3fe89ac1 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>)</td></tr>
<tr class="separator:a1a27c450de95c55d122be23e3fe89ac1 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a9e74a9350dd6211fa0d287c347585a inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a8a9e74a9350dd6211fa0d287c347585a">existsParam</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>)</td></tr>
<tr class="separator:a8a9e74a9350dd6211fa0d287c347585a inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaeb37f0bac83f5d2a605aaa0e5c4b6ef inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a> (const <a class="el" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a> &amp;line)</td></tr>
<tr class="separator:aaeb37f0bac83f5d2a605aaa0e5c4b6ef inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ce43fdc0dd88cfbd4010a0f77b57d5e inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a8ce43fdc0dd88cfbd4010a0f77b57d5e">addParamsLine</a> (const char *line)</td></tr>
<tr class="separator:a8ce43fdc0dd88cfbd4010a0f77b57d5e inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc09601893a94f240bf0423d213ddff1 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classParamDef.html">ParamDef</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#acc09601893a94f240bf0423d213ddff1">getParamDef</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>) const</td></tr>
<tr class="separator:acc09601893a94f240bf0423d213ddff1 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9055836d319be4c6479697463285d025 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a9055836d319be4c6479697463285d025">quit</a> (int exit_code=0) const</td></tr>
<tr class="separator:a9055836d319be4c6479697463285d025 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d0f9381e3828497ca4ee651bba15d9b inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a3d0f9381e3828497ca4ee651bba15d9b">tryRun</a> ()</td></tr>
<tr class="separator:a3d0f9381e3828497ca4ee651bba15d9b inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea0549c1e40215ee12b1abc36648b39a inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aea0549c1e40215ee12b1abc36648b39a">initProgress</a> (size_t total, size_t stepBin=60)</td></tr>
<tr class="separator:aea0549c1e40215ee12b1abc36648b39a inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a074c10cbbaa660749bbc2778592a54c4 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a074c10cbbaa660749bbc2778592a54c4">setProgress</a> (size_t value=0)</td></tr>
<tr class="separator:a074c10cbbaa660749bbc2778592a54c4 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef9f1a6f495c898cb12eac9a7922a84c inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aef9f1a6f495c898cb12eac9a7922a84c">endProgress</a> ()</td></tr>
<tr class="separator:aef9f1a6f495c898cb12eac9a7922a84c inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a0f62b1fe4af78a41e2f9ffe7725962 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a7a0f62b1fe4af78a41e2f9ffe7725962">processDefaultComment</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, const char *left)</td></tr>
<tr class="separator:a7a0f62b1fe4af78a41e2f9ffe7725962 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a439ac2830d63f9e58578203fafaacc10 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a439ac2830d63f9e58578203fafaacc10">setDefaultComment</a> (const char *<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, const char *comment)</td></tr>
<tr class="separator:a439ac2830d63f9e58578203fafaacc10 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e88782ecb59e921f041389b71b1183f inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a3e88782ecb59e921f041389b71b1183f">initComments</a> ()</td></tr>
<tr class="separator:a3e88782ecb59e921f041389b71b1183f inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e98654ef7fc47806d345b619b7779d9 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a3e98654ef7fc47806d345b619b7779d9">setProgramName</a> (const char *<a class="el" href="classXmippProgram.html#a306f750a00609f514bb7b4f15179c372">name</a>)</td></tr>
<tr class="separator:a3e98654ef7fc47806d345b619b7779d9 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f396af57519ec443b4656176eb962bf inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a4f396af57519ec443b4656176eb962bf">addUsageLine</a> (const char *line, bool verbatim=false)</td></tr>
<tr class="separator:a4f396af57519ec443b4656176eb962bf inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9df4b765a93997c2505c42f457040a2b inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a9df4b765a93997c2505c42f457040a2b">clearUsage</a> ()</td></tr>
<tr class="separator:a9df4b765a93997c2505c42f457040a2b inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b8f0a6e1bd09e4dbf56a412101e905e inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a4b8f0a6e1bd09e4dbf56a412101e905e">addExampleLine</a> (const char *example, bool verbatim=true)</td></tr>
<tr class="separator:a4b8f0a6e1bd09e4dbf56a412101e905e inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78cb844dedc5e8f4de8320c9a7c8d0a2 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a78cb844dedc5e8f4de8320c9a7c8d0a2">addSeeAlsoLine</a> (const char *seeAlso)</td></tr>
<tr class="separator:a78cb844dedc5e8f4de8320c9a7c8d0a2 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd4adc575f113cb61b3e4bb7bc5106b3 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#afd4adc575f113cb61b3e4bb7bc5106b3">addKeywords</a> (const char *keywords)</td></tr>
<tr class="separator:afd4adc575f113cb61b3e4bb7bc5106b3 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a306f750a00609f514bb7b4f15179c372 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a306f750a00609f514bb7b4f15179c372">name</a> () const</td></tr>
<tr class="separator:a306f750a00609f514bb7b4f15179c372 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3eecc327b12ee3893b15ba8efdbe014e inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a3eecc327b12ee3893b15ba8efdbe014e">usage</a> (int verb=0) const</td></tr>
<tr class="separator:a3eecc327b12ee3893b15ba8efdbe014e inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53b6cbca94fdb35a012e9a57083a697e inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a53b6cbca94fdb35a012e9a57083a697e">usage</a> (const <a class="el" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a> &amp;<a class="el" href="numerical__recipes_8cpp.html#afc24e6f7aed2394269af01a57e8a6284">param</a>, int verb=2)</td></tr>
<tr class="separator:a53b6cbca94fdb35a012e9a57083a697e inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41f3fdc19e19dafa861c7b7140d1673d inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a41f3fdc19e19dafa861c7b7140d1673d">version</a> () const</td></tr>
<tr class="separator:a41f3fdc19e19dafa861c7b7140d1673d inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8ba470ffe0f86f3b648f39442535cc1 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aa8ba470ffe0f86f3b648f39442535cc1">show</a> () const</td></tr>
<tr class="separator:aa8ba470ffe0f86f3b648f39442535cc1 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4eff3704eab2b7a94a89185e22f89512 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a4eff3704eab2b7a94a89185e22f89512">read</a> (int <a class="el" href="classXmippProgram.html#a8659f9e603143c1788360f0eeb01e589">argc</a>, const char **<a class="el" href="classXmippProgram.html#af2f60708934c302e1289c5405109dd45">argv</a>, bool reportErrors=true)</td></tr>
<tr class="separator:a4eff3704eab2b7a94a89185e22f89512 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a78239155c382a83b6bc4bbbccbe16c inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a8a78239155c382a83b6bc4bbbccbe16c">read</a> (int <a class="el" href="classXmippProgram.html#a8659f9e603143c1788360f0eeb01e589">argc</a>, char **<a class="el" href="classXmippProgram.html#af2f60708934c302e1289c5405109dd45">argv</a>, bool reportErrors=true)</td></tr>
<tr class="separator:a8a78239155c382a83b6bc4bbbccbe16c inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2afcfd93fe372b575850fc7f526b4f1 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#ae2afcfd93fe372b575850fc7f526b4f1">read</a> (const <a class="el" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a> &amp;argumentsLine)</td></tr>
<tr class="separator:ae2afcfd93fe372b575850fc7f526b4f1 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd42916af00d9ef6222399828349b581 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#abd42916af00d9ef6222399828349b581">XmippProgram</a> ()</td></tr>
<tr class="separator:abd42916af00d9ef6222399828349b581 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f90137c4d1bf8be6bae657e2a880a38 inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a8f90137c4d1bf8be6bae657e2a880a38">XmippProgram</a> (int <a class="el" href="classXmippProgram.html#a8659f9e603143c1788360f0eeb01e589">argc</a>, const char **<a class="el" href="classXmippProgram.html#af2f60708934c302e1289c5405109dd45">argv</a>)</td></tr>
<tr class="separator:a8f90137c4d1bf8be6bae657e2a880a38 inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b3035afffe42adb8c76518d4d53225b inherit pub_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a3b3035afffe42adb8c76518d4d53225b">~XmippProgram</a> ()</td></tr>
<tr class="separator:a3b3035afffe42adb8c76518d4d53225b inherit pub_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a5eded8363249e66bb494068a35883aa6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFileName.html">FileName</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a5eded8363249e66bb494068a35883aa6">fnSel</a></td></tr>
<tr class="memdesc:a5eded8363249e66bb494068a35883aa6"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classMetaData.html">MetaData</a> File with all images.  <a href="#a5eded8363249e66bb494068a35883aa6">More...</a><br /></td></tr>
<tr class="separator:a5eded8363249e66bb494068a35883aa6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ea6fcf828dc13a2adf15713ad8a97ec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFileName.html">FileName</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a6ea6fcf828dc13a2adf15713ad8a97ec">fnSelOrig</a></td></tr>
<tr class="memdesc:a6ea6fcf828dc13a2adf15713ad8a97ec"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classMetaData.html">MetaData</a> File with all images at the original scale.  <a href="#a6ea6fcf828dc13a2adf15713ad8a97ec">More...</a><br /></td></tr>
<tr class="separator:a6ea6fcf828dc13a2adf15713ad8a97ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a238e1f42e2d7aeb892518355058ac6b1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFileName.html">FileName</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">fnRoot</a></td></tr>
<tr class="memdesc:a238e1f42e2d7aeb892518355058ac6b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output root.  <a href="#a238e1f42e2d7aeb892518355058ac6b1">More...</a><br /></td></tr>
<tr class="separator:a238e1f42e2d7aeb892518355058ac6b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae50cf00b4c254719af15a62f39f7816d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#ae50cf00b4c254719af15a62f39f7816d">numThreads</a></td></tr>
<tr class="memdesc:ae50cf00b4c254719af15a62f39f7816d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of threads to use for parallel computing.  <a href="#ae50cf00b4c254719af15a62f39f7816d">More...</a><br /></td></tr>
<tr class="separator:ae50cf00b4c254719af15a62f39f7816d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9042cbb5b5fad3b5cbe697af4dca2d67"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a9042cbb5b5fad3b5cbe697af4dca2d67">globalAffine</a></td></tr>
<tr class="memdesc:a9042cbb5b5fad3b5cbe697af4dca2d67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Look for local affine transformation.  <a href="#a9042cbb5b5fad3b5cbe697af4dca2d67">More...</a><br /></td></tr>
<tr class="separator:a9042cbb5b5fad3b5cbe697af4dca2d67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a249db0f7eb2c90811b6bdf98ffddb01a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a249db0f7eb2c90811b6bdf98ffddb01a">useCriticalPoints</a></td></tr>
<tr class="memdesc:a249db0f7eb2c90811b6bdf98ffddb01a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use critical points.  <a href="#a249db0f7eb2c90811b6bdf98ffddb01a">More...</a><br /></td></tr>
<tr class="separator:a249db0f7eb2c90811b6bdf98ffddb01a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b020a7a943ef31422f663a72b51fe38"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a8b020a7a943ef31422f663a72b51fe38">Ncritical</a></td></tr>
<tr class="memdesc:a8b020a7a943ef31422f663a72b51fe38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of critical points.  <a href="#a8b020a7a943ef31422f663a72b51fe38">More...</a><br /></td></tr>
<tr class="separator:a8b020a7a943ef31422f663a72b51fe38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af96123b461a6fad645f8ab5d94beca33"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#af96123b461a6fad645f8ab5d94beca33">seqLength</a></td></tr>
<tr class="memdesc:af96123b461a6fad645f8ab5d94beca33"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sequence Length.  <a href="#af96123b461a6fad645f8ab5d94beca33">More...</a><br /></td></tr>
<tr class="separator:af96123b461a6fad645f8ab5d94beca33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ac192f1c46aeaea16bfba08b077d32d"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a2ac192f1c46aeaea16bfba08b077d32d">blindSeqLength</a></td></tr>
<tr class="separator:a2ac192f1c46aeaea16bfba08b077d32d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92bc30971016ac4aff7557c8ac3ed495"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a92bc30971016ac4aff7557c8ac3ed495">gridSamples</a></td></tr>
<tr class="memdesc:a92bc30971016ac4aff7557c8ac3ed495"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classGrid.html">Grid</a> samples.  <a href="#a92bc30971016ac4aff7557c8ac3ed495">More...</a><br /></td></tr>
<tr class="separator:a92bc30971016ac4aff7557c8ac3ed495"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a2e598c712e94b90d9a99e413d7e120"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a6a2e598c712e94b90d9a99e413d7e120">maxShiftPercentage</a></td></tr>
<tr class="memdesc:a6a2e598c712e94b90d9a99e413d7e120"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maxshift percentage.  <a href="#a6a2e598c712e94b90d9a99e413d7e120">More...</a><br /></td></tr>
<tr class="separator:a6a2e598c712e94b90d9a99e413d7e120"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd71803ad9478f7b779e58472ec415ad"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#abd71803ad9478f7b779e58472ec415ad">maxIterDE</a></td></tr>
<tr class="memdesc:abd71803ad9478f7b779e58472ec415ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of iterations in Differential Evolution.  <a href="#abd71803ad9478f7b779e58472ec415ad">More...</a><br /></td></tr>
<tr class="separator:abd71803ad9478f7b779e58472ec415ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7ced1919ef7005cf9631ac7892761f6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#ae7ced1919ef7005cf9631ac7892761f6">psiMax</a></td></tr>
<tr class="memdesc:ae7ced1919ef7005cf9631ac7892761f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum rotation.  <a href="#ae7ced1919ef7005cf9631ac7892761f6">More...</a><br /></td></tr>
<tr class="separator:ae7ced1919ef7005cf9631ac7892761f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad379fbdd7b6f963a3aea0b4ce20ae4ff"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#ad379fbdd7b6f963a3aea0b4ce20ae4ff">maxStep</a></td></tr>
<tr class="memdesc:ad379fbdd7b6f963a3aea0b4ce20ae4ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum Step for chain refinement.  <a href="#ad379fbdd7b6f963a3aea0b4ce20ae4ff">More...</a><br /></td></tr>
<tr class="separator:ad379fbdd7b6f963a3aea0b4ce20ae4ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab363adf03b92571baa6876e558fbc6ea"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#ab363adf03b92571baa6876e558fbc6ea">deltaRot</a></td></tr>
<tr class="memdesc:ab363adf03b92571baa6876e558fbc6ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delta rot.  <a href="#ab363adf03b92571baa6876e558fbc6ea">More...</a><br /></td></tr>
<tr class="separator:ab363adf03b92571baa6876e558fbc6ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9de431b2d85fc5d700dc4f90bb98ec3f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a9de431b2d85fc5d700dc4f90bb98ec3f">localSize</a></td></tr>
<tr class="memdesc:a9de431b2d85fc5d700dc4f90bb98ec3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local refinement size.  <a href="#a9de431b2d85fc5d700dc4f90bb98ec3f">More...</a><br /></td></tr>
<tr class="separator:a9de431b2d85fc5d700dc4f90bb98ec3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cf474c5f20f85f60b769760cb8178d2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a8cf474c5f20f85f60b769760cb8178d2">optimizeTiltAngle</a></td></tr>
<tr class="memdesc:a8cf474c5f20f85f60b769760cb8178d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Optimize tilt angle of tilt axis.  <a href="#a8cf474c5f20f85f60b769760cb8178d2">More...</a><br /></td></tr>
<tr class="separator:a8cf474c5f20f85f60b769760cb8178d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4905373a0acc63d50b75f609ea8bce57"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a4905373a0acc63d50b75f609ea8bce57">isCapillar</a></td></tr>
<tr class="memdesc:a4905373a0acc63d50b75f609ea8bce57"><td class="mdescLeft">&#160;</td><td class="mdescRight">This tilt series comes from a capillar.  <a href="#a4905373a0acc63d50b75f609ea8bce57">More...</a><br /></td></tr>
<tr class="separator:a4905373a0acc63d50b75f609ea8bce57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73502d61548fbce44458b99d8d978990"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a73502d61548fbce44458b99d8d978990">dontNormalize</a></td></tr>
<tr class="memdesc:a73502d61548fbce44458b99d8d978990"><td class="mdescLeft">&#160;</td><td class="mdescRight">Don't normalize the corrected images.  <a href="#a73502d61548fbce44458b99d8d978990">More...</a><br /></td></tr>
<tr class="separator:a73502d61548fbce44458b99d8d978990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa610621f5be969da18b79e8ca9aaa5bf"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#aa610621f5be969da18b79e8ca9aaa5bf">difficult</a></td></tr>
<tr class="memdesc:aa610621f5be969da18b79e8ca9aaa5bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Difficult.  <a href="#aa610621f5be969da18b79e8ca9aaa5bf">More...</a><br /></td></tr>
<tr class="separator:aa610621f5be969da18b79e8ca9aaa5bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2799e370b08d2c12c862e644af6a4748"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a2799e370b08d2c12c862e644af6a4748">corrThreshold</a></td></tr>
<tr class="memdesc:a2799e370b08d2c12c862e644af6a4748"><td class="mdescLeft">&#160;</td><td class="mdescRight">Correlation threshold for a good landmark.  <a href="#a2799e370b08d2c12c862e644af6a4748">More...</a><br /></td></tr>
<tr class="separator:a2799e370b08d2c12c862e644af6a4748"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0df630253ea3e7accf03dd2c0acb0a7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#ae0df630253ea3e7accf03dd2c0acb0a7">showAffine</a></td></tr>
<tr class="memdesc:ae0df630253ea3e7accf03dd2c0acb0a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Show affine transformations.  <a href="#ae0df630253ea3e7accf03dd2c0acb0a7">More...</a><br /></td></tr>
<tr class="separator:ae0df630253ea3e7accf03dd2c0acb0a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f45ff4b5de10a2ee5ed0b54b1700fd5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a8f45ff4b5de10a2ee5ed0b54b1700fd5">thresholdAffine</a></td></tr>
<tr class="memdesc:a8f45ff4b5de10a2ee5ed0b54b1700fd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Threshold affine.  <a href="#a8f45ff4b5de10a2ee5ed0b54b1700fd5">More...</a><br /></td></tr>
<tr class="separator:a8f45ff4b5de10a2ee5ed0b54b1700fd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a549ad45a1e9e26f2b983a209de5db173"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a549ad45a1e9e26f2b983a209de5db173">identifyOutliersZ</a></td></tr>
<tr class="memdesc:a549ad45a1e9e26f2b983a209de5db173"><td class="mdescLeft">&#160;</td><td class="mdescRight">Identify outlier micrographs.  <a href="#a549ad45a1e9e26f2b983a209de5db173">More...</a><br /></td></tr>
<tr class="separator:a549ad45a1e9e26f2b983a209de5db173"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18dab8ec016cdb49c491d42d2d6b9998"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a18dab8ec016cdb49c491d42d2d6b9998">doNotIdentifyOutliers</a></td></tr>
<tr class="memdesc:a18dab8ec016cdb49c491d42d2d6b9998"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do not identify outlier micrographs.  <a href="#a18dab8ec016cdb49c491d42d2d6b9998">More...</a><br /></td></tr>
<tr class="separator:a18dab8ec016cdb49c491d42d2d6b9998"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2a716317a1ae6cce2b05f4cf402cdc3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#ad2a716317a1ae6cce2b05f4cf402cdc3">pyramidLevel</a></td></tr>
<tr class="memdesc:ad2a716317a1ae6cce2b05f4cf402cdc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pyramid.  <a href="#ad2a716317a1ae6cce2b05f4cf402cdc3">More...</a><br /></td></tr>
<tr class="separator:ad2a716317a1ae6cce2b05f4cf402cdc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a483ebbe46f0bce2a09681223aef10739"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a483ebbe46f0bce2a09681223aef10739">lastStep</a></td></tr>
<tr class="memdesc:a483ebbe46f0bce2a09681223aef10739"><td class="mdescLeft">&#160;</td><td class="mdescRight">Last step to run (-1=run them all)  <a href="#a483ebbe46f0bce2a09681223aef10739">More...</a><br /></td></tr>
<tr class="separator:a483ebbe46f0bce2a09681223aef10739"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63aae8f8140c218f00063ba9f3b7ac1e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a63aae8f8140c218f00063ba9f3b7ac1e">iteration</a></td></tr>
<tr class="separator:a63aae8f8140c218f00063ba9f3b7ac1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ed9e03ce422388ba0725d3d58f1febd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMetaDataVec.html">MetaDataVec</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a9ed9e03ce422388ba0725d3d58f1febd">SF</a></td></tr>
<tr class="separator:a9ed9e03ce422388ba0725d3d58f1febd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa46841d31bcc5d5eafa7fa36a0675f57"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMetaDataVec.html">MetaDataVec</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#aa46841d31bcc5d5eafa7fa36a0675f57">SForig</a></td></tr>
<tr class="separator:aa46841d31bcc5d5eafa7fa36a0675f57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c3a49bb5d046f0ee574b9f43c19420a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; unsigned char &gt; * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a></td></tr>
<tr class="separator:a5c3a49bb5d046f0ee574b9f43c19420a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9232ef65b1b4e153d7a20e0328cab8c"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; unsigned char &gt; * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#af9232ef65b1b4e153d7a20e0328cab8c">maskImg</a></td></tr>
<tr class="separator:af9232ef65b1b4e153d7a20e0328cab8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c538b90574f9b5dd18aa5752499d5d0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a0c538b90574f9b5dd18aa5752499d5d0">iMinTilt</a></td></tr>
<tr class="separator:a0c538b90574f9b5dd18aa5752499d5d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98fedcd4fef7c8e1504eb3b1d4cc86d0"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">tiltList</a></td></tr>
<tr class="separator:a98fedcd4fef7c8e1504eb3b1d4cc86d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5718970fd91bc623ada85a3ca635ee3b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a5718970fd91bc623ada85a3ca635ee3b">name_list</a></td></tr>
<tr class="separator:a5718970fd91bc623ada85a3ca635ee3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2db3efcc5622e698680ea350a4d7393a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a2db3efcc5622e698680ea350a4d7393a">avgForwardPatchCorr</a></td></tr>
<tr class="separator:a2db3efcc5622e698680ea350a4d7393a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade84fe045db3ff2f59bb680e2ad7c852"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#ade84fe045db3ff2f59bb680e2ad7c852">avgBackwardPatchCorr</a></td></tr>
<tr class="separator:ade84fe045db3ff2f59bb680e2ad7c852"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cab83f651abdfaa2777d777bd094ec1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a5cab83f651abdfaa2777d777bd094ec1">isOutlier</a></td></tr>
<tr class="separator:a5cab83f651abdfaa2777d777bd094ec1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fa403d828d133eab75d26778795f1db"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a></td></tr>
<tr class="separator:a3fa403d828d133eab75d26778795f1db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18e8e8a40a20208e980fb46a85f8dc3d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a18e8e8a40a20208e980fb46a85f8dc3d">affineTransformations</a></td></tr>
<tr class="separator:a18e8e8a40a20208e980fb46a85f8dc3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27a3b5258d86502df1c4e24388c25314"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a27a3b5258d86502df1c4e24388c25314">correlationList</a></td></tr>
<tr class="separator:a27a3b5258d86502df1c4e24388c25314"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2127199afbebe9268549e5348b29b95f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a></td></tr>
<tr class="separator:a2127199afbebe9268549e5348b29b95f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dcbb879ecd56dd2db6839b9b53fae9f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a8dcbb879ecd56dd2db6839b9b53fae9f">allLandmarksY</a></td></tr>
<tr class="separator:a8dcbb879ecd56dd2db6839b9b53fae9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e77688a46fde1f0d00da6cf69b33e83"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a9e77688a46fde1f0d00da6cf69b33e83">Vseti</a></td></tr>
<tr class="separator:a9e77688a46fde1f0d00da6cf69b33e83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18a79b2c97411b080436beadb5bfb6d4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a18a79b2c97411b080436beadb5bfb6d4">Vsetj</a></td></tr>
<tr class="separator:a18a79b2c97411b080436beadb5bfb6d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab74e4c20e5076a2e5b2e0ed80e76a89e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#ab74e4c20e5076a2e5b2e0ed80e76a89e">barpi</a></td></tr>
<tr class="separator:ab74e4c20e5076a2e5b2e0ed80e76a89e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7266e57c1152899236bc313bd0466ca4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a7266e57c1152899236bc313bd0466ca4">ni</a></td></tr>
<tr class="separator:a7266e57c1152899236bc313bd0466ca4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a174552865b1ce2cafcdc2f6303eb8704"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classAlignment.html">Alignment</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a174552865b1ce2cafcdc2f6303eb8704">bestPreviousAlignment</a></td></tr>
<tr class="separator:a174552865b1ce2cafcdc2f6303eb8704"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0adc16d7de22929fc86de9f3ee726d00"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgTomographAlignment.html#a0adc16d7de22929fc86de9f3ee726d00">showRefinement</a></td></tr>
<tr class="separator:a0adc16d7de22929fc86de9f3ee726d00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_attribs_classXmippProgram"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_classXmippProgram')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="classXmippProgram.html">XmippProgram</a></td></tr>
<tr class="memitem:ae829d20125d500b80d008ea4b9a0e0bd inherit pub_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#ae829d20125d500b80d008ea4b9a0e0bd">doRun</a></td></tr>
<tr class="separator:ae829d20125d500b80d008ea4b9a0e0bd inherit pub_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41ca5bb0bd76fd8319d3b44459da4bf9 inherit pub_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a41ca5bb0bd76fd8319d3b44459da4bf9">runWithoutArgs</a></td></tr>
<tr class="separator:a41ca5bb0bd76fd8319d3b44459da4bf9 inherit pub_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed62cfe3c074e69076bf348fc101a717 inherit pub_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">verbose</a></td></tr>
<tr class="memdesc:aed62cfe3c074e69076bf348fc101a717 inherit pub_attribs_classXmippProgram"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verbosity level.  <a href="classXmippProgram.html#aed62cfe3c074e69076bf348fc101a717">More...</a><br /></td></tr>
<tr class="separator:aed62cfe3c074e69076bf348fc101a717 inherit pub_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0130b89f1f5431b03ef161d7e231bd48 inherit pub_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a0130b89f1f5431b03ef161d7e231bd48">debug</a></td></tr>
<tr class="separator:a0130b89f1f5431b03ef161d7e231bd48 inherit pub_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classXmippProgram"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classXmippProgram')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classXmippProgram.html">XmippProgram</a></td></tr>
<tr class="memitem:a95f826fa543dafe9afee959919537f9b inherit pro_methods_classXmippProgram"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a95f826fa543dafe9afee959919537f9b">defineCommons</a> ()</td></tr>
<tr class="separator:a95f826fa543dafe9afee959919537f9b inherit pro_methods_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classXmippProgram"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classXmippProgram')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classXmippProgram.html">XmippProgram</a></td></tr>
<tr class="memitem:aa8d070e9454a1282137facadd3e45a35 inherit pro_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aa8d070e9454a1282137facadd3e45a35">errorCode</a></td></tr>
<tr class="separator:aa8d070e9454a1282137facadd3e45a35 inherit pro_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba95ed5693ab33d77ae4c184a36e8f61 inherit pro_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classProgramDef.html">ProgramDef</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#aba95ed5693ab33d77ae4c184a36e8f61">progDef</a></td></tr>
<tr class="memdesc:aba95ed5693ab33d77ae4c184a36e8f61 inherit pro_attribs_classXmippProgram"><td class="mdescLeft">&#160;</td><td class="mdescRight">Program definition and arguments parser.  <a href="classXmippProgram.html#aba95ed5693ab33d77ae4c184a36e8f61">More...</a><br /></td></tr>
<tr class="separator:aba95ed5693ab33d77ae4c184a36e8f61 inherit pro_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e187353c6a6f9e06d44bbeaa6e872ac inherit pro_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a>, <a class="el" href="classCommentList.html">CommentList</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a5e187353c6a6f9e06d44bbeaa6e872ac">defaultComments</a></td></tr>
<tr class="separator:a5e187353c6a6f9e06d44bbeaa6e872ac inherit pro_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8659f9e603143c1788360f0eeb01e589 inherit pro_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#a8659f9e603143c1788360f0eeb01e589">argc</a></td></tr>
<tr class="memdesc:a8659f9e603143c1788360f0eeb01e589 inherit pro_attribs_classXmippProgram"><td class="mdescLeft">&#160;</td><td class="mdescRight">Original command line arguments.  <a href="classXmippProgram.html#a8659f9e603143c1788360f0eeb01e589">More...</a><br /></td></tr>
<tr class="separator:a8659f9e603143c1788360f0eeb01e589 inherit pro_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2f60708934c302e1289c5405109dd45 inherit pro_attribs_classXmippProgram"><td class="memItemLeft" align="right" valign="top">const char **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXmippProgram.html#af2f60708934c302e1289c5405109dd45">argv</a></td></tr>
<tr class="separator:af2f60708934c302e1289c5405109dd45 inherit pro_attribs_classXmippProgram"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This is the main class </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00076">76</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ad8fea94a4e12305a28cd5db61c8aa9da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8fea94a4e12305a28cd5db61c8aa9da">&#9670;&nbsp;</a></span>~ProgTomographAlignment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ProgTomographAlignment::~ProgTomographAlignment </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8cpp_source.html#l01621">1621</a> of file <a class="el" href="tomo__align__tilt__series_8cpp_source.html">tomo_align_tilt_series.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;{</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <span class="comment">// Clear the list of images if not empty</span></div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>.empty())</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    {</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;            <span class="keyword">delete</span> <a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>.clear();</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    }</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classProgTomographAlignment.html#af9232ef65b1b4e153d7a20e0328cab8c">maskImg</a>.empty())</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    {</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="classProgTomographAlignment.html#af9232ef65b1b4e153d7a20e0328cab8c">maskImg</a>.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;            <span class="keyword">delete</span> <a class="code" href="classProgTomographAlignment.html#af9232ef65b1b4e153d7a20e0328cab8c">maskImg</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;        <a class="code" href="classProgTomographAlignment.html#af9232ef65b1b4e153d7a20e0328cab8c">maskImg</a>.clear();</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    }</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;}</div><div class="ttc" id="classProgTomographAlignment_html_af9232ef65b1b4e153d7a20e0328cab8c"><div class="ttname"><a href="classProgTomographAlignment.html#af9232ef65b1b4e153d7a20e0328cab8c">ProgTomographAlignment::maskImg</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; unsigned char &gt; * &gt; maskImg</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00240">tomo_align_tilt_series.h:240</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a5c3a49bb5d046f0ee574b9f43c19420a"><div class="ttname"><a href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">ProgTomographAlignment::img</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; unsigned char &gt; * &gt; img</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00237">tomo_align_tilt_series.h:237</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a5fae052aa646288c9956211bf02540c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fae052aa646288c9956211bf02540c4">&#9670;&nbsp;</a></span>alignImages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgTomographAlignment::alignImages </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classAlignment.html">Alignment</a> &amp;&#160;</td>
          <td class="paramname"><em>alignment</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Align images. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8cpp_source.html#l02245">2245</a> of file <a class="el" href="tomo__align__tilt__series_8cpp_source.html">tomo_align_tilt_series.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;{</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    <span class="comment">// Correct all landmarks</span></div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> r(2);</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a>(<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    {</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;        <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> R;</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga93598c1cf08f43c7a58a096003b2d718">rotation2DMatrix</a>(90-alignment.<a class="code" href="classAlignment.html#add65434d2987bdde3581c85a26b142c4">rot</a>+alignment.<a class="code" href="classAlignment.html#a38d937990804d9c9ec1dfa4945d3ec4a">psi</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>),R,<span class="keyword">false</span>);</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;<a class="code" href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a>(<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)!=<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0]))</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;            {</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                <a class="code" href="group__Vectors.html#gaf35071e3863333ef9ff847bb85615bb4">VECTOR_R2</a>(r,<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>),<a class="code" href="classProgTomographAlignment.html#a8dcbb879ecd56dd2db6839b9b53fae9f">allLandmarksY</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;                r=R*(r-alignment.<a class="code" href="classAlignment.html#a48b2d63bd4964288aec74077f801a3ab">di</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]+alignment.<a class="code" href="classAlignment.html#ad8d803aa6644980d13446883bea69909">diaxis</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;                <a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)=<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(r);</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                <a class="code" href="classProgTomographAlignment.html#a8dcbb879ecd56dd2db6839b9b53fae9f">allLandmarksY</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)=<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(r);</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;            }</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;    }</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;    <span class="comment">// Compute the average height of the 3D landmarks seen at 0 degrees</span></div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="image__operate_8cpp.html#aae5e6d8d8a0b1792b5fc6fde13bc4a8c">axis</a>;</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;    <a class="code" href="group__Geometry.html#gac0a39b9536b704ecb1c9e44436796b2b">Euler_direction</a>(alignment.<a class="code" href="classAlignment.html#add65434d2987bdde3581c85a26b142c4">rot</a>, alignment.<a class="code" href="classAlignment.html#ae9cf6d3d33a4fb0f983d093f9b443998">tilt</a>, 0, axis);</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a>=0, z0N=0;</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;<a class="code" href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a>(<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>,<a class="code" href="classProgTomographAlignment.html#a0c538b90574f9b5dd18aa5752499d5d0">iMinTilt</a>)!=<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0]))</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;        {</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;            <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> Raxismin, Rmin, RtiltYmin;</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a>(<a class="code" href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">tiltList</a>[<a class="code" href="classProgTomographAlignment.html#a0c538b90574f9b5dd18aa5752499d5d0">iMinTilt</a>],axis,Raxismin,<span class="keyword">false</span>);</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#ga93598c1cf08f43c7a58a096003b2d718">rotation2DMatrix</a>(90-alignment.<a class="code" href="classAlignment.html#add65434d2987bdde3581c85a26b142c4">rot</a>+alignment.<a class="code" href="classAlignment.html#a38d937990804d9c9ec1dfa4945d3ec4a">psi</a>(<a class="code" href="classProgTomographAlignment.html#a0c538b90574f9b5dd18aa5752499d5d0">iMinTilt</a>),Rmin);</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a>(-<a class="code" href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">tiltList</a>[<a class="code" href="classProgTomographAlignment.html#a0c538b90574f9b5dd18aa5752499d5d0">iMinTilt</a>],<span class="charliteral">&#39;Y&#39;</span>,RtiltYmin,<span class="keyword">false</span>);</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;            <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> rjp=RtiltYmin*Rmin*Raxismin*alignment.<a class="code" href="classAlignment.html#ae1792c004e2c5c9fe80ea74c8e5b4a9c">rj</a>[<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>];</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;            z0+=<a class="code" href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a>(rjp);</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;            z0N++;</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;        }</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    <span class="keywordflow">if</span> (z0N==0)</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a>,<span class="stringliteral">&quot;There is no landmark at 0 degrees&quot;</span>);</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    z0/=z0N;</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Average height of the landmarks at 0 degrees=&quot;</span> &lt;&lt; z0 &lt;&lt; std::endl;</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    <a class="code" href="classMetaDataVec.html">MetaDataVec</a> DF;</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;    std::unique_ptr&lt;MetaDataVec::id_iterator&gt; idIter;</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classProgTomographAlignment.html#a6ea6fcf828dc13a2adf15713ad8a97ec">fnSelOrig</a>.empty())</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;    {</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;        idIter = memoryUtils::make_unique&lt;MetaDataVec::id_iterator&gt;(<a class="code" href="classProgTomographAlignment.html#aa46841d31bcc5d5eafa7fa36a0675f57">SForig</a>.<a class="code" href="classMetaData.html#aef20bffda56f171ad4e8817004451a95">ids</a>().begin());</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;    }</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    DF.<a class="code" href="classMetaData.html#a4a477fd5f8528810cecc6257ec4e7280">setComment</a>(<span class="stringliteral">&quot;First shift by -(shiftX,shiftY), then rotate by psi&quot;</span>);</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> mask;</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;int&gt;</a> iMask;</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;    <a class="code" href="classImage.html">Image&lt;double&gt;</a> I;</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> M, <a class="code" href="numerical__recipes_8cpp.html#ac597abe7cf610f262f7aaec53ed1d413">M1</a>, <a class="code" href="numerical__recipes_8cpp.html#a2a187ef3afced0eb4c4cb99515e5429c">M2</a>, <a class="code" href="numerical__recipes_8cpp.html#ad801d72bd01ef1ac9b86dbf4de0d355d">M3</a>;</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;    <a class="code" href="classFileName.html">FileName</a> fn_corrected;</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>=0;<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>&lt;<a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>++)</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    {</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;        <span class="comment">// Align the normal image</span></div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;        I.<a class="code" href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">read</a>(<a class="code" href="classProgTomographAlignment.html#a5718970fd91bc623ada85a3ca635ee3b">name_list</a>[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>]);</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;        mask.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(I());</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(I())</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#a83598b308cacef6d6b356c3455bf5a7c">if</a> (I(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)!=0)</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;            mask(i,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)=1;</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;        <a class="code" href="transformations_8cpp.html#acb37bb57c5d8447bdc70d6be9c640678">translation2DMatrix</a>(<a class="code" href="group__Vectors.html#ga97ccb86b4c568b2271da21552034d504">vectorR2</a>(-z0*sin(<a class="code" href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a>(<a class="code" href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">tiltList</a>[n])),0),M1);</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga93598c1cf08f43c7a58a096003b2d718">rotation2DMatrix</a>(90-alignment.rot+alignment.<a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>(n),M2);</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;        <a class="code" href="transformations_8cpp.html#acb37bb57c5d8447bdc70d6be9c640678">translation2DMatrix</a>(-(alignment.<a class="code" href="numerical__recipes_8cpp.html#ab96fca79aa45e2e22226e5938e235299">di</a>[n]+alignment.diaxis[n]),M3);</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;        M=M1*M2*M3;</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga22035972f95a4f2bf79416b5ebf9d44e">selfApplyGeometry</a>(<a class="code" href="namespacexmipp__transformation.html">xmipp_transformation</a>::<a class="code" href="namespacexmipp__transformation.html#ac5f2bd2937d73c34ed4f6c6c5ff2492aac8f522643bcb55d76296b48480a99c44">BSPLINE3</a>,I(),M,<a class="code" href="namespacexmipp__transformation.html">xmipp_transformation</a>::IS_NOT_INV,<a class="code" href="namespacexmipp__transformation.html">xmipp_transformation</a>::DONT_WRAP);</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;        <a class="code" href="group__GeometricalTransformations.html#ga22035972f95a4f2bf79416b5ebf9d44e">selfApplyGeometry</a>(<a class="code" href="namespacexmipp__transformation.html">xmipp_transformation</a>::<a class="code" href="namespacelibsvm.html#ae4d786843096da1513c3a014c1852b99a16800123b31768c1530d3ab5485ba626">LINEAR</a>,mask,M,<a class="code" href="namespacexmipp__transformation.html">xmipp_transformation</a>::IS_NOT_INV,<a class="code" href="namespacexmipp__transformation.html">xmipp_transformation</a>::DONT_WRAP);</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;        mask.binarize(0.5);</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;        <a class="code" href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a>(mask,iMask);</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;        <span class="keywordtype">double</span> minval, maxval, avg, stddev;</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;        <a class="code" href="group__Masks.html#ga5bd552c32d3d6b6abd6ddf18677cf647">computeStats_within_binary_mask</a>(iMask,I(),minval, maxval, avg, stddev);</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(iMask)</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#a83598b308cacef6d6b356c3455bf5a7c">if</a> (iMask(i,j)==0)</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;            I(i,j)=0;</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a> <a class="code" href="numerical__recipes_8cpp.html#a83598b308cacef6d6b356c3455bf5a7c">if</a> (!<a class="code" href="classProgTomographAlignment.html#a73502d61548fbce44458b99d8d978990">dontNormalize</a>)</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;            I(i,j)-=avg;</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;        <span class="keywordtype">double</span> rot=0;</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;        <span class="keywordtype">double</span> tilt=<a class="code" href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">tiltList</a>[n];</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="namespacealglib.html#a0759579762ef75075769325153538c5b">psi</a>=0;</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;        I.setEulerAngles(rot, tilt, psi);</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;        fn_corrected.compose(n+1, <a class="code" href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">fnRoot</a>+&quot;_corrected_&quot;, &quot;stk&quot;);</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;        I.write(fn_corrected);</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;        <span class="comment">// Align the original image</span></div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#a83598b308cacef6d6b356c3455bf5a7c">if</a> (<a class="code" href="classProgTomographAlignment.html#a6ea6fcf828dc13a2adf15713ad8a97ec">fnSelOrig</a>!=&quot;&quot;)</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;        {</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;            <a class="code" href="classFileName.html">FileName</a> auxFn;</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;            <a class="code" href="classProgTomographAlignment.html#aa46841d31bcc5d5eafa7fa36a0675f57">SForig</a>.<a class="code" href="classMetaDataVec.html#a71728ad7664da6eba90ec1dbc787d434">getValue</a>( <a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a>, auxFn, **idIter);</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;            <a class="code" href="classImage.html">Image&lt;double&gt;</a> Iorig;</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;            Iorig.<a class="code" href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">read</a>( auxFn );</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;            <span class="comment">//SForig.nextObject();</span></div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;            ++(*idIter);</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;            mask.initZeros(Iorig());</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(Iorig())</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;            <a class="code" href="numerical__recipes_8cpp.html#a83598b308cacef6d6b356c3455bf5a7c">if</a> (Iorig(i,j)!=0)</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;                mask(i,j)=1;</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;            <a class="code" href="transformations_8cpp.html#acb37bb57c5d8447bdc70d6be9c640678">translation2DMatrix</a>(<a class="code" href="group__Vectors.html#ga97ccb86b4c568b2271da21552034d504">vectorR2</a>(-z0*sin(<a class="code" href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a>(<a class="code" href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">tiltList</a>[n]))*</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;                                         (((<span class="keywordtype">double</span>)<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Iorig()))/<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I())),0),M1);</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#ga93598c1cf08f43c7a58a096003b2d718">rotation2DMatrix</a>(90-alignment.rot+alignment.psi(n),M2);</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;            <a class="code" href="transformations_8cpp.html#acb37bb57c5d8447bdc70d6be9c640678">translation2DMatrix</a>(-(alignment.<a class="code" href="numerical__recipes_8cpp.html#ab96fca79aa45e2e22226e5938e235299">di</a>[n]+alignment.diaxis[n])*</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;                                (((<span class="keywordtype">double</span>)<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Iorig()))/<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(I())),M3);</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;            M=M1*M2*M3;</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#ga22035972f95a4f2bf79416b5ebf9d44e">selfApplyGeometry</a>(<a class="code" href="namespacexmipp__transformation.html">xmipp_transformation</a>::BSPLINE3,Iorig(),M,<a class="code" href="namespacexmipp__transformation.html">xmipp_transformation</a>::IS_NOT_INV,<a class="code" href="namespacexmipp__transformation.html">xmipp_transformation</a>::DONT_WRAP);</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#ga22035972f95a4f2bf79416b5ebf9d44e">selfApplyGeometry</a>(<a class="code" href="namespacexmipp__transformation.html">xmipp_transformation</a>::LINEAR,mask,M,<a class="code" href="namespacexmipp__transformation.html">xmipp_transformation</a>::IS_NOT_INV,<a class="code" href="namespacexmipp__transformation.html">xmipp_transformation</a>::DONT_WRAP);</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;            mask.binarize(0.5);</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;            <a class="code" href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a>(mask,iMask);</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;            <a class="code" href="group__Masks.html#ga5bd552c32d3d6b6abd6ddf18677cf647">computeStats_within_binary_mask</a>(iMask,Iorig(),minval, maxval,</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;                                            avg, stddev);</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(iMask)</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;            <a class="code" href="numerical__recipes_8cpp.html#a83598b308cacef6d6b356c3455bf5a7c">if</a> (iMask(i,j)==0)</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;                Iorig(i,j)=0;</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;            <a class="code" href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a> <a class="code" href="numerical__recipes_8cpp.html#a83598b308cacef6d6b356c3455bf5a7c">if</a> (!<a class="code" href="classProgTomographAlignment.html#a73502d61548fbce44458b99d8d978990">dontNormalize</a>)</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;                Iorig(i,j)-=avg;</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;            Iorig.setEulerAngles(rot, tilt, psi);</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;            fn_corrected.compose(n+1, <a class="code" href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">fnRoot</a>+&quot;_corrected_originalsize_&quot;, &quot;stk&quot;);</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;            Iorig.write(fn_corrected);</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;        }</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;        <span class="comment">// Prepare data for the docfile</span></div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;        <span class="keywordtype">size_t</span> <span class="keywordtype">id</span> = DF.addObject();</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;        DF.setValue(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a>, fn_corrected, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;        DF.setValue(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a114e3414dd216e4308946a016b5cc46f">MDL_ANGLE_PSI</a>, 90.-alignment.rot+alignment.psi(n), <span class="keywordtype">id</span>);</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;        DF.setValue(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acb3aa7acca32f4524608635e2e09650e">MDL_SHIFT_X</a>, <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(alignment.<a class="code" href="numerical__recipes_8cpp.html#ab96fca79aa45e2e22226e5938e235299">di</a>[n]+alignment.diaxis[n]), <span class="keywordtype">id</span>);</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;        DF.setValue(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab00882fc483e9a1a7e6af5829a6afb8e">MDL_SHIFT_Y</a>, <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(alignment.<a class="code" href="numerical__recipes_8cpp.html#ab96fca79aa45e2e22226e5938e235299">di</a>[n]+alignment.diaxis[n]), <span class="keywordtype">id</span>);</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    }</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    DF.write(<a class="code" href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">fnRoot</a>+&quot;_correction_parameters.txt&quot;);</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    <a class="code" href="classImage.html">Image&lt;double&gt;</a> save;</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;    save().initZeros(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0]);</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;    save().setXmippOrigin();</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;<a class="code" href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>); j++)</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>(j,<a class="code" href="classProgTomographAlignment.html#a0c538b90574f9b5dd18aa5752499d5d0">iMinTilt</a>)!=<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0]))</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;        {</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;            <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> Raxismin=<a class="code" href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a>(<a class="code" href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">tiltList</a>[<a class="code" href="classProgTomographAlignment.html#a0c538b90574f9b5dd18aa5752499d5d0">iMinTilt</a>],axis);</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;            Raxismin.<a class="code" href="classMatrix2D.html#aeedb221b3c316a93de2826d56302bf98">resize</a>(3,3);</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;            <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> Rmin=<a class="code" href="group__GeometricalTransformations.html#ga93598c1cf08f43c7a58a096003b2d718">rotation2DMatrix</a>(90-alignment.<a class="code" href="classAlignment.html#add65434d2987bdde3581c85a26b142c4">rot</a>+alignment.<a class="code" href="classAlignment.html#a38d937990804d9c9ec1dfa4945d3ec4a">psi</a>(<a class="code" href="classProgTomographAlignment.html#a0c538b90574f9b5dd18aa5752499d5d0">iMinTilt</a>));</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;            <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> RtiltYmin=<a class="code" href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a>(-<a class="code" href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">tiltList</a>[<a class="code" href="classProgTomographAlignment.html#a0c538b90574f9b5dd18aa5752499d5d0">iMinTilt</a>],<span class="charliteral">&#39;Y&#39;</span>);</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;            RtiltYmin.resize(3,3);</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;            <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> rjp=RtiltYmin*Rmin*Raxismin*alignment.<a class="code" href="classAlignment.html#ae1792c004e2c5c9fe80ea74c8e5b4a9c">rj</a>[<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>];</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;            std::cout &lt;&lt; rjp.<a class="code" href="classMatrix1D.html#a028505ebdeaf6f62d884c31dcd5127a8">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>); i++)</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>(j,i)!=<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0]))</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;                {</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;                    save(<a class="code" href="classProgTomographAlignment.html#a8dcbb879ecd56dd2db6839b9b53fae9f">allLandmarksY</a>(j,i),<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>(j,i))=<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(i-<a class="code" href="classProgTomographAlignment.html#a0c538b90574f9b5dd18aa5752499d5d0">iMinTilt</a>);</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;                    <span class="comment">/*</span></div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;<span class="comment">                    Matrix2D&lt;double&gt; Raxis=rotation3DMatrix(tiltList[i],axis);</span></div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;<span class="comment">                    Raxis.resize(3,3);</span></div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;<span class="comment">                    Matrix2D&lt;double&gt; R=rotation2DMatrix(90-alignment.rot+alignment.psi(i));</span></div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;<span class="comment">                    Matrix1D&lt;double&gt; p=R*Raxis*alignment.rj[j];</span></div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;<span class="comment">                    if (YY(p)&gt;=STARTINGY(save()) &amp;&amp; YY(p)&lt;=FINISHINGY(save()) &amp;&amp;</span></div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;<span class="comment">                        XX(p)&gt;=STARTINGX(save()) &amp;&amp; XX(p)&lt;=FINISHINGX(save()))</span></div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;<span class="comment">                       save(YY(p),XX(p))=-ABS(i-iMinTilt);</span></div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;<span class="comment">                    */</span></div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;                    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> RtiltY=<a class="code" href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a>(-<a class="code" href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">tiltList</a>[i],<span class="charliteral">&#39;Y&#39;</span>);</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;                    RtiltY.<a class="code" href="classMatrix2D.html#aeedb221b3c316a93de2826d56302bf98">resize</a>(3,3);</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;                    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> p=RtiltY*rjp;</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p)&gt;=<a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(save()) &amp;&amp; <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p)&lt;=<a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(save()) &amp;&amp;</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;                        <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p)&gt;=<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(save()) &amp;&amp; <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p)&lt;=<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(save()))</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;                        save(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(p),<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(p))=-<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(i-<a class="code" href="classProgTomographAlignment.html#a0c538b90574f9b5dd18aa5752499d5d0">iMinTilt</a>);</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;                }</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;        }</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    save.write(<span class="stringliteral">&quot;PPPmovementsLandmarks0.xmp&quot;</span>);</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;}</div><div class="ttc" id="numerical__recipes_8cpp_html_a0544c3fe466e421738dae463968b70ba"><div class="ttname"><a href="numerical__recipes_8cpp.html#a0544c3fe466e421738dae463968b70ba">else</a></div><div class="ttdeci">else</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02920">numerical_recipes.cpp:2920</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga22035972f95a4f2bf79416b5ebf9d44e"><div class="ttname"><a href="group__GeometricalTransformations.html#ga22035972f95a4f2bf79416b5ebf9d44e">selfApplyGeometry</a></div><div class="ttdeci">void selfApplyGeometry(int Splinedegree, MultidimArray&lt; std::complex&lt; double &gt; &gt; &amp;V1, const Matrix2D&lt; double &gt; &amp;A, bool inv, bool wrap, std::complex&lt; double &gt; outside)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00704">transformations.cpp:704</a></div></div>
<div class="ttc" id="group__Vectors_html_gaf35071e3863333ef9ff847bb85615bb4"><div class="ttname"><a href="group__Vectors.html#gaf35071e3863333ef9ff847bb85615bb4">VECTOR_R2</a></div><div class="ttdeci">#define VECTOR_R2(v, x, y)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00112">matrix1d.h:112</a></div></div>
<div class="ttc" id="group__Matrices_html_ga43e28f6079b3652588d5b76ff199ff1e"><div class="ttname"><a href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a></div><div class="ttdeci">#define MAT_YSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00124">matrix2d.h:124</a></div></div>
<div class="ttc" id="classAlignment_html_a48b2d63bd4964288aec74077f801a3ab"><div class="ttname"><a href="classAlignment.html#a48b2d63bd4964288aec74077f801a3ab">Alignment::di</a></div><div class="ttdeci">std::vector&lt; Matrix1D&lt; double &gt; &gt; di</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00299">tomo_align_tilt_series.h:299</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00095">multidim_array_base.h:95</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a0c538b90574f9b5dd18aa5752499d5d0"><div class="ttname"><a href="classProgTomographAlignment.html#a0c538b90574f9b5dd18aa5752499d5d0">ProgTomographAlignment::iMinTilt</a></div><div class="ttdeci">int iMinTilt</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00243">tomo_align_tilt_series.h:243</a></div></div>
<div class="ttc" id="transformations_8cpp_html_acb37bb57c5d8447bdc70d6be9c640678"><div class="ttname"><a href="transformations_8cpp.html#acb37bb57c5d8447bdc70d6be9c640678">translation2DMatrix</a></div><div class="ttdeci">template void translation2DMatrix(const Matrix1D&lt; float &gt; &amp;, Matrix2D&lt; float &gt; &amp;, bool inverse)</div></div>
<div class="ttc" id="classAlignment_html_ae1792c004e2c5c9fe80ea74c8e5b4a9c"><div class="ttname"><a href="classAlignment.html#ae1792c004e2c5c9fe80ea74c8e5b4a9c">Alignment::rj</a></div><div class="ttdeci">std::vector&lt; Matrix1D&lt; double &gt; &gt; rj</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00300">tomo_align_tilt_series.h:300</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a8dcbb879ecd56dd2db6839b9b53fae9f"><div class="ttname"><a href="classProgTomographAlignment.html#a8dcbb879ecd56dd2db6839b9b53fae9f">ProgTomographAlignment::allLandmarksY</a></div><div class="ttdeci">Matrix2D&lt; double &gt; allLandmarksY</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00274">tomo_align_tilt_series.h:274</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a98fedcd4fef7c8e1504eb3b1d4cc86d0"><div class="ttname"><a href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">ProgTomographAlignment::tiltList</a></div><div class="ttdeci">std::vector&lt; double &gt; tiltList</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00246">tomo_align_tilt_series.h:246</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00211">xmipp_error.h:211</a></div></div>
<div class="ttc" id="group__Geometry_html_gac0a39b9536b704ecb1c9e44436796b2b"><div class="ttname"><a href="group__Geometry.html#gac0a39b9536b704ecb1c9e44436796b2b">Euler_direction</a></div><div class="ttdeci">void Euler_direction(double alpha, double beta, double gamma, Matrix1D&lt; double &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="geometry_8cpp_source.html#l00721">geometry.cpp:721</a></div></div>
<div class="ttc" id="group__Macros_html_gadec1e6bbd34c5cf8765a457da4876c91"><div class="ttname"><a href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a></div><div class="ttdeci">#define DEG2RAD(d)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00312">xmipp_macros.h:312</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78acb3aa7acca32f4524608635e2e09650e"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78acb3aa7acca32f4524608635e2e09650e">MDL_SHIFT_X</a></div><div class="ttdoc">Shift for the image in the X axis (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00430">metadata_label.h:430</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78a114e3414dd216e4308946a016b5cc46f"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78a114e3414dd216e4308946a016b5cc46f">MDL_ANGLE_PSI</a></div><div class="ttdoc">Special label to be used when gathering MDs in MpiMetadataPrograms. </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00051">metadata_label.h:51</a></div></div>
<div class="ttc" id="blobs_8cpp_html_a3f5c4dfb0dff56801752771f78265fbe"><div class="ttname"><a href="blobs_8cpp.html#a3f5c4dfb0dff56801752771f78265fbe">z0</a></div><div class="ttdeci">#define z0</div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad801d72bd01ef1ac9b86dbf4de0d355d"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad801d72bd01ef1ac9b86dbf4de0d355d">M3</a></div><div class="ttdeci">#define M3</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l00052">numerical_recipes.cpp:52</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a2127199afbebe9268549e5348b29b95f"><div class="ttname"><a href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">ProgTomographAlignment::allLandmarksX</a></div><div class="ttdeci">Matrix2D&lt; double &gt; allLandmarksX</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00271">tomo_align_tilt_series.h:271</a></div></div>
<div class="ttc" id="classMetaData_html_aef20bffda56f171ad4e8817004451a95"><div class="ttname"><a href="classMetaData.html#aef20bffda56f171ad4e8817004451a95">MetaData::ids</a></div><div class="ttdeci">virtual IdIteratorProxy&lt; false &gt; ids()</div><div class="ttdef"><b>Definition:</b> <a href="metadata__base_8h_source.html#l00762">metadata_base.h:762</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a238e1f42e2d7aeb892518355058ac6b1"><div class="ttname"><a href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">ProgTomographAlignment::fnRoot</a></div><div class="ttdeci">FileName fnRoot</div><div class="ttdoc">Output root. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00086">tomo_align_tilt_series.h:86</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a3fa403d828d133eab75d26778795f1db"><div class="ttname"><a href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">ProgTomographAlignment::Nimg</a></div><div class="ttdeci">int Nimg</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00261">tomo_align_tilt_series.h:261</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab96fca79aa45e2e22226e5938e235299"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab96fca79aa45e2e22226e5938e235299">di</a></div><div class="ttdeci">double * di</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05186">numerical_recipes.cpp:5186</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00065">xmipp_filename.h:65</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="namespacexmipp__transformation_html"><div class="ttname"><a href="namespacexmipp__transformation.html">xmipp_transformation</a></div><div class="ttdef"><b>Definition:</b> <a href="transformations__defines_8h_source.html#l00030">transformations_defines.h:30</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="classMetaData_html_a4a477fd5f8528810cecc6257ec4e7280"><div class="ttname"><a href="classMetaData.html#a4a477fd5f8528810cecc6257ec4e7280">MetaData::setComment</a></div><div class="ttdeci">virtual void setComment(const String &amp;newComment=&quot;No comment&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="metadata__base_8h_source.html#l00315">metadata_base.h:315</a></div></div>
<div class="ttc" id="group__Masks_html_ga5bd552c32d3d6b6abd6ddf18677cf647"><div class="ttname"><a href="group__Masks.html#ga5bd552c32d3d6b6abd6ddf18677cf647">computeStats_within_binary_mask</a></div><div class="ttdeci">void computeStats_within_binary_mask(const MultidimArray&lt; T1 &gt; &amp;mask, const MultidimArray&lt; T &gt; &amp;m, double &amp;min_val, double &amp;max_val, double &amp;avg, double &amp;stddev)</div><div class="ttdef"><b>Definition:</b> <a href="mask_8h_source.html#l00799">mask.h:799</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="multidim__array__base_8h.html#a7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00390">multidim_array_base.h:390</a></div></div>
<div class="ttc" id="classMatrix1D_html_a028505ebdeaf6f62d884c31dcd5127a8"><div class="ttname"><a href="classMatrix1D.html#a028505ebdeaf6f62d884c31dcd5127a8">Matrix1D::transpose</a></div><div class="ttdeci">Matrix1D&lt; T &gt; transpose() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8cpp_source.html#l00631">matrix1d.cpp:631</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a5718970fd91bc623ada85a3ca635ee3b"><div class="ttname"><a href="classProgTomographAlignment.html#a5718970fd91bc623ada85a3ca635ee3b">ProgTomographAlignment::name_list</a></div><div class="ttdeci">std::vector&lt; std::string &gt; name_list</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00249">tomo_align_tilt_series.h:249</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_gade7a7cd894f08efccc7d6b6410bbf891"><div class="ttname"><a href="group__GeometricalTransformations.html#gade7a7cd894f08efccc7d6b6410bbf891">rotation3DMatrix</a></div><div class="ttdeci">void rotation3DMatrix(double ang, char axis, Matrix2D&lt; double &gt; &amp;result, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00426">transformations.cpp:426</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00059">multidim_array_base.h:59</a></div></div>
<div class="ttc" id="classMetaDataVec_html"><div class="ttname"><a href="classMetaDataVec.html">MetaDataVec</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata__vec_8h_source.html#l00046">metadata_vec.h:46</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="namespacelibsvm_html_ae4d786843096da1513c3a014c1852b99a16800123b31768c1530d3ab5485ba626"><div class="ttname"><a href="namespacelibsvm.html#ae4d786843096da1513c3a014c1852b99a16800123b31768c1530d3ab5485ba626">libsvm::LINEAR</a></div><div class="ttdef"><b>Definition:</b> <a href="svm_8h_source.html#l00031">svm.h:31</a></div></div>
<div class="ttc" id="classAlignment_html_ae9cf6d3d33a4fb0f983d093f9b443998"><div class="ttname"><a href="classAlignment.html#ae9cf6d3d33a4fb0f983d093f9b443998">Alignment::tilt</a></div><div class="ttdeci">double tilt</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00303">tomo_align_tilt_series.h:303</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a2a187ef3afced0eb4c4cb99515e5429c"><div class="ttname"><a href="numerical__recipes_8cpp.html#a2a187ef3afced0eb4c4cb99515e5429c">M2</a></div><div class="ttdeci">#define M2</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l00048">numerical_recipes.cpp:48</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ac597abe7cf610f262f7aaec53ed1d413"><div class="ttname"><a href="numerical__recipes_8cpp.html#ac597abe7cf610f262f7aaec53ed1d413">M1</a></div><div class="ttdeci">#define M1</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l00044">numerical_recipes.cpp:44</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aae5e6d8d8a0b1792b5fc6fde13bc4a8c"><div class="ttname"><a href="image__operate_8cpp.html#aae5e6d8d8a0b1792b5fc6fde13bc4a8c">axis</a></div><div class="ttdeci">char axis</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00257">image_operate.cpp:257</a></div></div>
<div class="ttc" id="classAlignment_html_ad8d803aa6644980d13446883bea69909"><div class="ttname"><a href="classAlignment.html#ad8d803aa6644980d13446883bea69909">Alignment::diaxis</a></div><div class="ttdeci">std::vector&lt; Matrix1D&lt; double &gt; &gt; diaxis</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00433">tomo_align_tilt_series.h:433</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00085">matrix1d.h:85</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a83598b308cacef6d6b356c3455bf5a7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#a83598b308cacef6d6b356c3455bf5a7c">if</a></div><div class="ttdeci">if(fabs(c[*nmax+ *nmax *c_dim1])==0.e0)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02297">numerical_recipes.cpp:2297</a></div></div>
<div class="ttc" id="classAlignment_html_a38d937990804d9c9ec1dfa4945d3ec4a"><div class="ttname"><a href="classAlignment.html#a38d937990804d9c9ec1dfa4945d3ec4a">Alignment::psi</a></div><div class="ttdeci">Matrix1D&lt; double &gt; psi</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00301">tomo_align_tilt_series.h:301</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00091">multidim_array_base.h:91</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a6ea6fcf828dc13a2adf15713ad8a97ec"><div class="ttname"><a href="classProgTomographAlignment.html#a6ea6fcf828dc13a2adf15713ad8a97ec">ProgTomographAlignment::fnSelOrig</a></div><div class="ttdeci">FileName fnSelOrig</div><div class="ttdoc">MetaData File with all images at the original scale. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00083">tomo_align_tilt_series.h:83</a></div></div>
<div class="ttc" id="group__Vectors_html_ga97ccb86b4c568b2271da21552034d504"><div class="ttname"><a href="group__Vectors.html#ga97ccb86b4c568b2271da21552034d504">vectorR2</a></div><div class="ttdeci">Matrix1D&lt; double &gt; vectorR2(double x, double y)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8cpp_source.html#l00865">matrix1d.cpp:865</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_aa46841d31bcc5d5eafa7fa36a0675f57"><div class="ttname"><a href="classProgTomographAlignment.html#aa46841d31bcc5d5eafa7fa36a0675f57">ProgTomographAlignment::SForig</a></div><div class="ttdeci">MetaDataVec SForig</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00234">tomo_align_tilt_series.h:234</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a5c3a49bb5d046f0ee574b9f43c19420a"><div class="ttname"><a href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">ProgTomographAlignment::img</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; unsigned char &gt; * &gt; img</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00237">tomo_align_tilt_series.h:237</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga93598c1cf08f43c7a58a096003b2d718"><div class="ttname"><a href="group__GeometricalTransformations.html#ga93598c1cf08f43c7a58a096003b2d718">rotation2DMatrix</a></div><div class="ttdeci">void rotation2DMatrix(T ang, Matrix2D&lt; T &gt; &amp;result, bool homogeneous)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8cpp_source.html#l00361">transformations.cpp:361</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00093">matrix1d.h:93</a></div></div>
<div class="ttc" id="classMetaDataVec_html_a71728ad7664da6eba90ec1dbc787d434"><div class="ttname"><a href="classMetaDataVec.html#a71728ad7664da6eba90ec1dbc787d434">MetaDataVec::getValue</a></div><div class="ttdeci">bool getValue(MDObject &amp;mdValueOut, size_t id) const override</div><div class="ttdef"><b>Definition:</b> <a href="metadata__vec_8cpp_source.html#l00293">metadata_vec.cpp:293</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00063">multidim_array_base.h:63</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_gaf36b657319bb585c75cfa14744dab275"><div class="ttname"><a href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a></div><div class="ttdeci">void typeCast(const Matrix1D&lt; T1 &gt; &amp;v1, Matrix1D&lt; T2 &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01227">matrix1d.h:1227</a></div></div>
<div class="ttc" id="group__Matrices_html_gacd5c6ac63f21fdbbd4343a9caf1ee9c6"><div class="ttname"><a href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a></div><div class="ttdeci">#define MAT_XSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00120">matrix2d.h:120</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="namespacealglib_html_a0759579762ef75075769325153538c5b"><div class="ttname"><a href="namespacealglib.html#a0759579762ef75075769325153538c5b">alglib::psi</a></div><div class="ttdeci">double psi(const double x)</div><div class="ttdef"><b>Definition:</b> <a href="specialfunctions_8cpp_source.html#l02492">specialfunctions.cpp:2492</a></div></div>
<div class="ttc" id="classImageBase_html_a88636b7a7bd4e0e454877e691ee2da84"><div class="ttname"><a href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">ImageBase::read</a></div><div class="ttdeci">int read(const FileName &amp;name, DataMode datamode=DATA, size_t select_img=ALL_IMAGES, bool mapData=false, int mode=WRITE_READONLY)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00119">xmipp_image_base.cpp:119</a></div></div>
<div class="ttc" id="classAlignment_html_add65434d2987bdde3581c85a26b142c4"><div class="ttname"><a href="classAlignment.html#add65434d2987bdde3581c85a26b142c4">Alignment::rot</a></div><div class="ttdeci">double rot</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00302">tomo_align_tilt_series.h:302</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab00882fc483e9a1a7e6af5829a6afb8e"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ab00882fc483e9a1a7e6af5829a6afb8e">MDL_SHIFT_Y</a></div><div class="ttdoc">Shift for the image in the Y axis (double) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00434">metadata_label.h:434</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02723">multidim_array.h:2723</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a73502d61548fbce44458b99d8d978990"><div class="ttname"><a href="classProgTomographAlignment.html#a73502d61548fbce44458b99d8d978990">ProgTomographAlignment::dontNormalize</a></div><div class="ttdeci">bool dontNormalize</div><div class="ttdoc">Don&amp;#39;t normalize the corrected images. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00135">tomo_align_tilt_series.h:135</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a></div><div class="ttdoc">Incorrect value received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00195">xmipp_error.h:195</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a></div><div class="ttdoc">Name of an image (std::string) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00246">metadata_label.h:246</a></div></div>
<div class="ttc" id="classMatrix2D_html_aeedb221b3c316a93de2826d56302bf98"><div class="ttname"><a href="classMatrix2D.html#aeedb221b3c316a93de2826d56302bf98">Matrix2D::resize</a></div><div class="ttdeci">void resize(size_t Ydim, size_t Xdim, bool noCopy=false)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l01022">matrix2d.cpp:1022</a></div></div>
<div class="ttc" id="group__Vectors_html_gab88d1e959fb58c03aa1f04f1e4a7d452"><div class="ttname"><a href="group__Vectors.html#gab88d1e959fb58c03aa1f04f1e4a7d452">ZZ</a></div><div class="ttdeci">#define ZZ(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00101">matrix1d.h:101</a></div></div>
<div class="ttc" id="namespacexmipp__transformation_html_ac5f2bd2937d73c34ed4f6c6c5ff2492aac8f522643bcb55d76296b48480a99c44"><div class="ttname"><a href="namespacexmipp__transformation.html#ac5f2bd2937d73c34ed4f6c6c5ff2492aac8f522643bcb55d76296b48480a99c44">xmipp_transformation::BSPLINE3</a></div><div class="ttdef"><b>Definition:</b> <a href="transformations__defines_8h_source.html#l00032">transformations_defines.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa83c07ba49b99652c116cf2a1e8d6649"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa83c07ba49b99652c116cf2a1e8d6649">&#9670;&nbsp;</a></span>computeAffineTransformations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgTomographAlignment::computeAffineTransformations </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>globalAffineToUse</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute affine transformations. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8cpp_source.html#l00674">674</a> of file <a class="el" href="tomo__align__tilt__series_8cpp_source.html">tomo_align_tilt_series.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;{</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordtype">bool</span> oldglobalAffine=<a class="code" href="classProgTomographAlignment.html#a9042cbb5b5fad3b5cbe697af4dca2d67">globalAffine</a>;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a9042cbb5b5fad3b5cbe697af4dca2d67">globalAffine</a>=globalAffineToUse;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keyword">auto</span> * th_ids = <span class="keyword">new</span> pthread_t[<a class="code" href="classProgTomographAlignment.html#ae50cf00b4c254719af15a62f39f7816d">numThreads</a>];</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keyword">auto</span> * th_args = <span class="keyword">new</span> <a class="code" href="structThreadComputeTransformParams.html">ThreadComputeTransformParams</a>[<a class="code" href="classProgTomographAlignment.html#ae50cf00b4c254719af15a62f39f7816d">numThreads</a>];</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> nt = 0 ; nt &lt; <a class="code" href="classProgTomographAlignment.html#ae50cf00b4c254719af15a62f39f7816d">numThreads</a> ; nt ++ )</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    {</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <span class="comment">// Passing parameters to each thread</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        th_args[nt].<a class="code" href="structThreadComputeTransformParams.html#a452675b27157b733fd36b75ca96a799b">parent</a> = <span class="keyword">this</span>;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        th_args[nt].myThreadID = nt;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        pthread_create( (th_ids+nt) , <span class="keyword">nullptr</span>, <a class="code" href="tomo__align__tilt__series_8cpp.html#a7131de293cd30a33c6cfb7cc8d7de271">threadComputeTransform</a>, (<span class="keywordtype">void</span> *)(th_args+nt) );</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    }</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="comment">// Waiting for threads to finish</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> nt = 0 ; nt &lt; <a class="code" href="classProgTomographAlignment.html#ae50cf00b4c254719af15a62f39f7816d">numThreads</a> ; nt ++ )</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        pthread_join(*(th_ids+nt), <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="comment">// Threads structures are not needed any more</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keyword">delete</span>[] th_ids;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="keyword">delete</span>[] th_args;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a9042cbb5b5fad3b5cbe697af4dca2d67">globalAffine</a>=oldglobalAffine;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;}</div><div class="ttc" id="classProgTomographAlignment_html_a9042cbb5b5fad3b5cbe697af4dca2d67"><div class="ttname"><a href="classProgTomographAlignment.html#a9042cbb5b5fad3b5cbe697af4dca2d67">ProgTomographAlignment::globalAffine</a></div><div class="ttdeci">bool globalAffine</div><div class="ttdoc">Look for local affine transformation. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00092">tomo_align_tilt_series.h:92</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ae50cf00b4c254719af15a62f39f7816d"><div class="ttname"><a href="classProgTomographAlignment.html#ae50cf00b4c254719af15a62f39f7816d">ProgTomographAlignment::numThreads</a></div><div class="ttdeci">int numThreads</div><div class="ttdoc">Number of threads to use for parallel computing. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00089">tomo_align_tilt_series.h:89</a></div></div>
<div class="ttc" id="tomo__align__tilt__series_8cpp_html_a7131de293cd30a33c6cfb7cc8d7de271"><div class="ttname"><a href="tomo__align__tilt__series_8cpp.html#a7131de293cd30a33c6cfb7cc8d7de271">threadComputeTransform</a></div><div class="ttdeci">void * threadComputeTransform(void *args)</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l00584">tomo_align_tilt_series.cpp:584</a></div></div>
<div class="ttc" id="structThreadComputeTransformParams_html"><div class="ttname"><a href="structThreadComputeTransformParams.html">ThreadComputeTransformParams</a></div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l00578">tomo_align_tilt_series.cpp:578</a></div></div>
<div class="ttc" id="structThreadComputeTransformParams_html_a452675b27157b733fd36b75ca96a799b"><div class="ttname"><a href="structThreadComputeTransformParams.html#a452675b27157b733fd36b75ca96a799b">ThreadComputeTransformParams::parent</a></div><div class="ttdeci">ProgTomographAlignment * parent</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l00581">tomo_align_tilt_series.cpp:581</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a57760862c9717e14229406d7ce5a1d5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57760862c9717e14229406d7ce5a1d5b">&#9670;&nbsp;</a></span>defineParams()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProgTomographAlignment::defineParams </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Usage. </p>

<p>Reimplemented from <a class="el" href="classXmippProgram.html#a75ba820f6afd62c89524b497ae9b560d">XmippProgram</a>.</p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8cpp_source.html#l00522">522</a> of file <a class="el" href="tomo__align__tilt__series_8cpp_source.html">tomo_align_tilt_series.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;{</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <a class="code" href="classXmippProgram.html#a4f396af57519ec443b4656176eb962bf">addUsageLine</a>(<span class="stringliteral">&quot;Align a single-axis tilt series without any marker.&quot;</span>);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <a class="code" href="classXmippProgram.html#a78cb844dedc5e8f4de8320c9a7c8d0a2">addSeeAlsoLine</a>(<span class="stringliteral">&quot;tomo_align_dual_tilt_series&quot;</span>);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot; == General Options == &quot;</span>);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;   -i &lt;metadatafile&gt;              : Input images&quot;</span>);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;                                  : The selfile must contain the list of micrographs&quot;</span>);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;                                  : and its tilt angles&quot;</span>);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--iorig &lt;metadatafile=\&quot;\&quot;&gt;]   : Metadata with images at original scale&quot;</span>);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--oroot &lt;fn_out=\&quot;\&quot;&gt;]         : Output alignment&quot;</span>);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;                                  : If not given, the input selfile without extension&quot;</span>);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--thr &lt;num=1&gt;]                 : Parallel processing using \&quot;num\&quot; threads&quot;</span>);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--lastStep+ &lt;step=-1&gt;]         : Last step to perform&quot;</span>);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;                                  : Step -1 -&gt; Perform all steps&quot;</span>);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;                                  : Step  0 -&gt; Determination of affine transformations&quot;</span>);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;                                  : Step  1 -&gt; Determination of landmark chains&quot;</span>);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;                                  : Step  2 -&gt; Determination of alignment parameters&quot;</span>);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;                                  : Step  3 -&gt; Writing aligned images&quot;</span>);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot; == Step 0 (Affine alignment) Options == &quot;</span>);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--maxShiftPercentage &lt;p=0.2&gt;]   : Maximum shift as percentage of image size&quot;</span>);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--thresholdAffine &lt;th=0.85&gt;]    : Threshold affine&quot;</span>);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--globalAffine]                 : Look globally for affine transformations&quot;</span>);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--difficult+]                   : Apply some filters before affine alignment&quot;</span>);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--maxIterDE+ &lt;n=30&gt;]            : Maximum number of iteration in Differential Evolution&quot;</span>);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--showAffine+]                  : Show affine transformations as PPP*&quot;</span>);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--identifyOutliers+ &lt;z=5&gt;]      : Z-score to be an outlier&quot;</span>);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--noOutliers+]                  : Do not identify outliers&quot;</span>);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--pyramid+ &lt;level=1&gt;]           : Multiresolution for affine transformations&quot;</span>);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot; == Step 1 (Landmark chain) Options == &quot;</span>);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--seqLength &lt;n=5&gt;]              : Sequence length&quot;</span>);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--localSize &lt;size=0.04&gt;]        : In percentage&quot;</span>);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--useCriticalPoints &lt;n=0&gt;]      : Use critical points instead of a grid&quot;</span>);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;                                   : n is the number of critical points to choose&quot;</span>);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;                                   : in each image&quot;</span>);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--threshold+ &lt;th=-1&gt;]           : Correlation threshold&quot;</span>);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--blindSeqLength+ &lt;n=-1&gt;]       : Blind sequence length, -1=No blind landmarks&quot;</span>);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--maxStep+ &lt;step=4&gt;]            : Maximum step for chain refinement&quot;</span>);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--gridSamples+ &lt;n=40&gt;]           : Total number of samples=n*n&quot;</span>);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--isCapillar+]                  : Set this flag if the tilt series is of a capillar&quot;</span>);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot; == Step 2 (Determination of alignment parameters) Options == &quot;</span>);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--psiMax+ &lt;psi=-1&gt;]             : Maximum psi in absolute value (degrees)&quot;</span>);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;                                  : -1 -&gt; do not optimize for psi&quot;</span>);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--deltaRot+ &lt;rot=5&gt;]            : In degrees. For the first optimization stage&quot;</span>);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--optimizeTiltAngle+]           : Optimize tilt angle&quot;</span>);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot; == Step 3 (Produce aligned images) Options == &quot;</span>);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <a class="code" href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">addParamsLine</a>(<span class="stringliteral">&quot;  [--dontNormalize+]               : Don&#39;t normalize the output images&quot;</span>);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <a class="code" href="classXmippProgram.html#a4b8f0a6e1bd09e4dbf56a412101e905e">addExampleLine</a>(<span class="stringliteral">&quot;Typical run&quot;</span>,<span class="keyword">false</span>);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <a class="code" href="classXmippProgram.html#a4b8f0a6e1bd09e4dbf56a412101e905e">addExampleLine</a>(<span class="stringliteral">&quot;xmipp_tomo_align_tilt_series -i tiltseries.sel --thr 8&quot;</span>);</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <a class="code" href="classXmippProgram.html#a4b8f0a6e1bd09e4dbf56a412101e905e">addExampleLine</a>(<span class="stringliteral">&quot;If there are image with large shifts&quot;</span>,<span class="keyword">false</span>);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <a class="code" href="classXmippProgram.html#a4b8f0a6e1bd09e4dbf56a412101e905e">addExampleLine</a>(<span class="stringliteral">&quot;xmipp_tomo_align_tilt_series -i tiltseries.sel --thr 8 --globalAffine&quot;</span>);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <a class="code" href="classXmippProgram.html#a4b8f0a6e1bd09e4dbf56a412101e905e">addExampleLine</a>(<span class="stringliteral">&quot;If there are clear landmarks that can be tracked&quot;</span>,<span class="keyword">false</span>);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <a class="code" href="classXmippProgram.html#a4b8f0a6e1bd09e4dbf56a412101e905e">addExampleLine</a>(<span class="stringliteral">&quot;xmipp_tomo_align_tilt_series -i tiltseries.sel --thr 8 --criticalPoints&quot;</span>);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;}</div><div class="ttc" id="classXmippProgram_html_a78cb844dedc5e8f4de8320c9a7c8d0a2"><div class="ttname"><a href="classXmippProgram.html#a78cb844dedc5e8f4de8320c9a7c8d0a2">XmippProgram::addSeeAlsoLine</a></div><div class="ttdeci">void addSeeAlsoLine(const char *seeAlso)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00290">xmipp_program.cpp:290</a></div></div>
<div class="ttc" id="classXmippProgram_html_a4b8f0a6e1bd09e4dbf56a412101e905e"><div class="ttname"><a href="classXmippProgram.html#a4b8f0a6e1bd09e4dbf56a412101e905e">XmippProgram::addExampleLine</a></div><div class="ttdeci">void addExampleLine(const char *example, bool verbatim=true)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00286">xmipp_program.cpp:286</a></div></div>
<div class="ttc" id="classXmippProgram_html_a4f396af57519ec443b4656176eb962bf"><div class="ttname"><a href="classXmippProgram.html#a4f396af57519ec443b4656176eb962bf">XmippProgram::addUsageLine</a></div><div class="ttdeci">void addUsageLine(const char *line, bool verbatim=false)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00282">xmipp_program.cpp:282</a></div></div>
<div class="ttc" id="classXmippProgram_html_aaeb37f0bac83f5d2a605aaa0e5c4b6ef"><div class="ttname"><a href="classXmippProgram.html#aaeb37f0bac83f5d2a605aaa0e5c4b6ef">XmippProgram::addParamsLine</a></div><div class="ttdeci">void addParamsLine(const String &amp;line)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00305">xmipp_program.cpp:305</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a871a94ad24fb5bc94113b3f14eafb0d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a871a94ad24fb5bc94113b3f14eafb0d1">&#9670;&nbsp;</a></span>generateLandmarkSet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgTomographAlignment::generateLandmarkSet </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate landmark set using a grid. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8cpp_source.html#l01639">1639</a> of file <a class="el" href="tomo__align__tilt__series_8cpp_source.html">tomo_align_tilt_series.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;{</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    <a class="code" href="classFileName.html">FileName</a> fn_tmp = <a class="code" href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">fnRoot</a>+<span class="stringliteral">&quot;_landmarks.txt&quot;</span>;</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    <span class="keywordflow">if</span> (!fn_tmp.<a class="code" href="classFileName.html#ae42eca3e976e48f40f3e0c3ece19427b">exists</a>())</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    {</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;        <span class="keyword">auto</span> * th_ids = <span class="keyword">new</span> pthread_t[<a class="code" href="classProgTomographAlignment.html#ae50cf00b4c254719af15a62f39f7816d">numThreads</a>];</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        <span class="keyword">auto</span> * th_args=</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;            <span class="keyword">new</span> <a class="code" href="structThreadGenerateLandmarkSetParams.html">ThreadGenerateLandmarkSetParams</a>[<a class="code" href="classProgTomographAlignment.html#ae50cf00b4c254719af15a62f39f7816d">numThreads</a>];</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> nt = 0 ; nt &lt; <a class="code" href="classProgTomographAlignment.html#ae50cf00b4c254719af15a62f39f7816d">numThreads</a> ; nt ++ )</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;        {</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;            th_args[nt].<a class="code" href="structThreadGenerateLandmarkSetParams.html#a9fc8229cef66b568660af513988d51b8">parent</a> = <span class="keyword">this</span>;</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;            th_args[nt].myThreadID = nt;</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a249db0f7eb2c90811b6bdf98ffddb01a">useCriticalPoints</a>)</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                pthread_create( (th_ids+nt) , <span class="keyword">nullptr</span>, <a class="code" href="tomo__align__tilt__series_8cpp.html#aaa57a57290d443eb00c0d8b796aa27b9">threadgenerateLandmarkSetCriticalPoints</a>, (<span class="keywordtype">void</span> *)(th_args+nt) );</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                pthread_create( (th_ids+nt) , <span class="keyword">nullptr</span>, <a class="code" href="tomo__align__tilt__series_8cpp.html#a2cadcbb93ddaf573684b1d0303062f49">threadgenerateLandmarkSetGrid</a>, (<span class="keywordtype">void</span> *)(th_args+nt) );</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        }</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        std::vector&lt;LandmarkChain&gt; chainList;</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;        <span class="keywordtype">int</span> includedPoints=0;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> nt = 0 ; nt &lt; <a class="code" href="classProgTomographAlignment.html#ae50cf00b4c254719af15a62f39f7816d">numThreads</a> ; nt ++ )</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;        {</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;            pthread_join(*(th_ids+nt), <span class="keyword">nullptr</span>);</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;            <span class="keywordtype">int</span> imax=th_args[nt].chainList-&gt;size();</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;imax; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;            {</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                chainList.push_back((*th_args[nt].chainList)[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                includedPoints+=(*th_args[nt].chainList)[i].size();</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;            }</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;            <span class="keyword">delete</span> th_args[nt].chainList;</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        }</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        <span class="keyword">delete</span>[] th_ids;</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        <span class="keyword">delete</span>[] th_args;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        <span class="comment">// Add blind landmarks</span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a2ac192f1c46aeaea16bfba08b077d32d">blindSeqLength</a>&gt;0)</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;        {</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;            th_ids  = <span class="keyword">new</span> pthread_t[<a class="code" href="classProgTomographAlignment.html#ae50cf00b4c254719af15a62f39f7816d">numThreads</a>];</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;            th_args = <span class="keyword">new</span> <a class="code" href="structThreadGenerateLandmarkSetParams.html">ThreadGenerateLandmarkSetParams</a>[<a class="code" href="classProgTomographAlignment.html#ae50cf00b4c254719af15a62f39f7816d">numThreads</a>];</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;            <span class="keywordflow">for</span>( <span class="keywordtype">int</span> nt = 0 ; nt &lt; <a class="code" href="classProgTomographAlignment.html#ae50cf00b4c254719af15a62f39f7816d">numThreads</a> ; nt ++ )</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;            {</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                th_args[nt].<a class="code" href="structThreadGenerateLandmarkSetParams.html#a9fc8229cef66b568660af513988d51b8">parent</a> = <span class="keyword">this</span>;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                th_args[nt].myThreadID = nt;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                pthread_create( (th_ids+nt) , <span class="keyword">nullptr</span>, <a class="code" href="tomo__align__tilt__series_8cpp.html#a6a670bd90a4f92554c68b5a270ba5240">threadgenerateLandmarkSetBlind</a>, (<span class="keywordtype">void</span> *)(th_args+nt) );</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;            }</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;            <span class="keywordflow">for</span>( <span class="keywordtype">int</span> nt = 0 ; nt &lt; <a class="code" href="classProgTomographAlignment.html#ae50cf00b4c254719af15a62f39f7816d">numThreads</a> ; nt ++ )</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;            {</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                pthread_join(*(th_ids+nt), <span class="keyword">nullptr</span>);</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                <span class="keywordtype">int</span> imax=th_args[nt].chainList-&gt;size();</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;imax; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                {</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                    chainList.push_back((*th_args[nt].chainList)[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;                    includedPoints+=(*th_args[nt].chainList)[i].size();</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;                }</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;                <span class="keyword">delete</span> th_args[nt].chainList;</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;            }</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;            <span class="keyword">delete</span>[] th_ids;</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;            <span class="keyword">delete</span>[] th_args;</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        }</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        <span class="comment">// Generate the landmark &quot;matrix&quot;</span></div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>.<a class="code" href="classMatrix2D.html#aeedb221b3c316a93de2826d56302bf98">resize</a>(chainList.size(),<a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>);</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a8dcbb879ecd56dd2db6839b9b53fae9f">allLandmarksY</a>.<a class="code" href="classMatrix2D.html#aeedb221b3c316a93de2826d56302bf98">resize</a>(chainList.size(),<a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>);</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>.<a class="code" href="classMatrix2D.html#af0ca60bcef90508025e5164abb39c4b6">initConstant</a>(<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0]));</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a8dcbb879ecd56dd2db6839b9b53fae9f">allLandmarksY</a>.<a class="code" href="classMatrix2D.html#af0ca60bcef90508025e5164abb39c4b6">initConstant</a>(<a class="code" href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0]));</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;chainList.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        {</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;chainList[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;            {</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                <span class="keywordtype">int</span> idx=chainList[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>].imgIdx;</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                <a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,idx)=chainList[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>].x;</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                <a class="code" href="classProgTomographAlignment.html#a8dcbb879ecd56dd2db6839b9b53fae9f">allLandmarksY</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,idx)=chainList[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>].y;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;            }</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        }</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        <span class="comment">// Write landmarks</span></div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        <span class="keywordflow">if</span> (includedPoints&gt;0)</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        {</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;            <a class="code" href="classProgTomographAlignment.html#a76ef40d145be5f5402a03db800afcf8c">writeLandmarkSet</a>(<a class="code" href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">fnRoot</a>+<span class="stringliteral">&quot;_landmarks.txt&quot;</span>);</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot; Number of points=&quot;</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;            &lt;&lt; includedPoints</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; Number of chains=&quot;</span> &lt;&lt; chainList.size()</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; ( &quot;</span> &lt;&lt; ((double) includedPoints)/chainList.size() &lt;&lt; <span class="stringliteral">&quot; )\n&quot;</span>;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        }</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;            <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a>,<span class="stringliteral">&quot;There are no landmarks meeting this threshold. Try to lower it&quot;</span>);</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    }</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    {</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a1d145dc60698a6cc03446b620c307a2b">readLandmarkSet</a>(<a class="code" href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">fnRoot</a>+<span class="stringliteral">&quot;_landmarks.txt&quot;</span>);</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    }</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;}</div><div class="ttc" id="multidim__array__base_8h_html_a93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00095">multidim_array_base.h:95</a></div></div>
<div class="ttc" id="tomo__align__tilt__series_8cpp_html_a2cadcbb93ddaf573684b1d0303062f49"><div class="ttname"><a href="tomo__align__tilt__series_8cpp.html#a2cadcbb93ddaf573684b1d0303062f49">threadgenerateLandmarkSetGrid</a></div><div class="ttdeci">void * threadgenerateLandmarkSetGrid(void *args)</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l01047">tomo_align_tilt_series.cpp:1047</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a8dcbb879ecd56dd2db6839b9b53fae9f"><div class="ttname"><a href="classProgTomographAlignment.html#a8dcbb879ecd56dd2db6839b9b53fae9f">ProgTomographAlignment::allLandmarksY</a></div><div class="ttdeci">Matrix2D&lt; double &gt; allLandmarksY</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00274">tomo_align_tilt_series.h:274</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00211">xmipp_error.h:211</a></div></div>
<div class="ttc" id="classMatrix2D_html_af0ca60bcef90508025e5164abb39c4b6"><div class="ttname"><a href="classMatrix2D.html#af0ca60bcef90508025e5164abb39c4b6">Matrix2D::initConstant</a></div><div class="ttdeci">void initConstant(T val)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00602">matrix2d.h:602</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a2127199afbebe9268549e5348b29b95f"><div class="ttname"><a href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">ProgTomographAlignment::allLandmarksX</a></div><div class="ttdeci">Matrix2D&lt; double &gt; allLandmarksX</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00271">tomo_align_tilt_series.h:271</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a238e1f42e2d7aeb892518355058ac6b1"><div class="ttname"><a href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">ProgTomographAlignment::fnRoot</a></div><div class="ttdeci">FileName fnRoot</div><div class="ttdoc">Output root. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00086">tomo_align_tilt_series.h:86</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a3fa403d828d133eab75d26778795f1db"><div class="ttname"><a href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">ProgTomographAlignment::Nimg</a></div><div class="ttdeci">int Nimg</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00261">tomo_align_tilt_series.h:261</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00065">xmipp_filename.h:65</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="tomo__align__tilt__series_8cpp_html_aaa57a57290d443eb00c0d8b796aa27b9"><div class="ttname"><a href="tomo__align__tilt__series_8cpp.html#aaa57a57290d443eb00c0d8b796aa27b9">threadgenerateLandmarkSetCriticalPoints</a></div><div class="ttdeci">void * threadgenerateLandmarkSetCriticalPoints(void *args)</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l01371">tomo_align_tilt_series.cpp:1371</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ae50cf00b4c254719af15a62f39f7816d"><div class="ttname"><a href="classProgTomographAlignment.html#ae50cf00b4c254719af15a62f39f7816d">ProgTomographAlignment::numThreads</a></div><div class="ttdeci">int numThreads</div><div class="ttdoc">Number of threads to use for parallel computing. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00089">tomo_align_tilt_series.h:89</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00091">multidim_array_base.h:91</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a1d145dc60698a6cc03446b620c307a2b"><div class="ttname"><a href="classProgTomographAlignment.html#a1d145dc60698a6cc03446b620c307a2b">ProgTomographAlignment::readLandmarkSet</a></div><div class="ttdeci">void readLandmarkSet(const FileName &amp;fnLandmark)</div><div class="ttdoc">Read landmark set. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l02170">tomo_align_tilt_series.cpp:2170</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a2ac192f1c46aeaea16bfba08b077d32d"><div class="ttname"><a href="classProgTomographAlignment.html#a2ac192f1c46aeaea16bfba08b077d32d">ProgTomographAlignment::blindSeqLength</a></div><div class="ttdeci">size_t blindSeqLength</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00105">tomo_align_tilt_series.h:105</a></div></div>
<div class="ttc" id="classFileName_html_ae42eca3e976e48f40f3e0c3ece19427b"><div class="ttname"><a href="classFileName.html#ae42eca3e976e48f40f3e0c3ece19427b">FileName::exists</a></div><div class="ttdeci">bool exists() const</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8cpp_source.html#l00660">xmipp_filename.cpp:660</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a5c3a49bb5d046f0ee574b9f43c19420a"><div class="ttname"><a href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">ProgTomographAlignment::img</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; unsigned char &gt; * &gt; img</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00237">tomo_align_tilt_series.h:237</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a249db0f7eb2c90811b6bdf98ffddb01a"><div class="ttname"><a href="classProgTomographAlignment.html#a249db0f7eb2c90811b6bdf98ffddb01a">ProgTomographAlignment::useCriticalPoints</a></div><div class="ttdeci">bool useCriticalPoints</div><div class="ttdoc">Use critical points. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00095">tomo_align_tilt_series.h:95</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="structThreadGenerateLandmarkSetParams_html_a9fc8229cef66b568660af513988d51b8"><div class="ttname"><a href="structThreadGenerateLandmarkSetParams.html#a9fc8229cef66b568660af513988d51b8">ThreadGenerateLandmarkSetParams::parent</a></div><div class="ttdeci">ProgTomographAlignment * parent</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l01042">tomo_align_tilt_series.cpp:1042</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a76ef40d145be5f5402a03db800afcf8c"><div class="ttname"><a href="classProgTomographAlignment.html#a76ef40d145be5f5402a03db800afcf8c">ProgTomographAlignment::writeLandmarkSet</a></div><div class="ttdeci">void writeLandmarkSet(const FileName &amp;fnLandmark) const</div><div class="ttdoc">Write landmark set. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l02146">tomo_align_tilt_series.cpp:2146</a></div></div>
<div class="ttc" id="tomo__align__tilt__series_8cpp_html_a6a670bd90a4f92554c68b5a270ba5240"><div class="ttname"><a href="tomo__align__tilt__series_8cpp.html#a6a670bd90a4f92554c68b5a270ba5240">threadgenerateLandmarkSetBlind</a></div><div class="ttdeci">void * threadgenerateLandmarkSetBlind(void *args)</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l01216">tomo_align_tilt_series.cpp:1216</a></div></div>
<div class="ttc" id="structThreadGenerateLandmarkSetParams_html"><div class="ttname"><a href="structThreadGenerateLandmarkSetParams.html">ThreadGenerateLandmarkSetParams</a></div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l01039">tomo_align_tilt_series.cpp:1039</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a></div><div class="ttdoc">Incorrect value received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00195">xmipp_error.h:195</a></div></div>
<div class="ttc" id="classMatrix2D_html_aeedb221b3c316a93de2826d56302bf98"><div class="ttname"><a href="classMatrix2D.html#aeedb221b3c316a93de2826d56302bf98">Matrix2D::resize</a></div><div class="ttdeci">void resize(size_t Ydim, size_t Xdim, bool noCopy=false)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l01022">matrix2d.cpp:1022</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afd76d988df1c69f11fafd277735bc7ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd76d988df1c69f11fafd277735bc7ea">&#9670;&nbsp;</a></span>identifyOutliers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgTomographAlignment::identifyOutliers </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>mark</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Identify outliers. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8cpp_source.html#l00701">701</a> of file <a class="el" href="tomo__align__tilt__series_8cpp_source.html">tomo_align_tilt_series.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;{</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a5cab83f651abdfaa2777d777bd094ec1">isOutlier</a>.<a class="code" href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">initZeros</a>(<a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> correlationListAux(<a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>);</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        correlationListAux(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)=<a class="code" href="classProgTomographAlignment.html#a27a3b5258d86502df1c4e24388c25314">correlationList</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> diff;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordtype">double</span> medianCorr=correlationListAux.<a class="code" href="classMultidimArray.html#a758751c52bbc190798b7941ced1cb8c4">computeMedian</a>();</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    diff=correlationListAux-medianCorr;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    diff.<a class="code" href="classMultidimArray.html#a3aa0e8d03bc68f58860621085efc2fdd">selfABS</a>();</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordtype">double</span> madCorr=diff.<a class="code" href="classMultidimArray.html#a758751c52bbc190798b7941ced1cb8c4">computeMedian</a>();</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Cost distribution= &quot;</span> &lt;&lt; 1-medianCorr &lt;&lt; <span class="stringliteral">&quot; +- &quot;</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    &lt;&lt; madCorr &lt;&lt; std::endl;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordtype">double</span> thresholdCorr=medianCorr-<a class="code" href="classProgTomographAlignment.html#a549ad45a1e9e26f2b983a209de5db173">identifyOutliersZ</a>*madCorr;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="group__Vectors.html#gad6524c4e36da91aae3fb6f8564112364">VEC_XSIZE</a>(<a class="code" href="classProgTomographAlignment.html#a5cab83f651abdfaa2777d777bd094ec1">isOutlier</a>); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    {</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="keywordtype">bool</span> potentialOutlier=(correlationListAux(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)&lt;thresholdCorr);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordflow">if</span> (potentialOutlier)</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        {</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            <a class="code" href="classProgTomographAlignment.html#a18e8e8a40a20208e980fb46a85f8dc3d">affineTransformations</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-1][<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].clear();</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            <span class="keywordflow">if</span> (mark)</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            {</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                <a class="code" href="classProgTomographAlignment.html#a5cab83f651abdfaa2777d777bd094ec1">isOutlier</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)=<span class="keyword">true</span>;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                std::cout &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a5718970fd91bc623ada85a3ca635ee3b">name_list</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-1] &lt;&lt; <span class="stringliteral">&quot; [&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;] is considered as an outlier. &quot;</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;Its cost is &quot;</span> &lt;&lt; 1-correlationListAux(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                &lt;&lt; std::endl;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            }</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                std::cout &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a5718970fd91bc623ada85a3ca635ee3b">name_list</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-1] &lt;&lt; <span class="stringliteral">&quot; [&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;] might be an outlier. &quot;</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;Its cost is &quot;</span> &lt;&lt; 1-correlationListAux(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                &lt;&lt; std::endl;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        }</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a63aae8f8140c218f00063ba9f3b7ac1e">iteration</a>++;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    }</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;}</div><div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Vectors_html_gad6524c4e36da91aae3fb6f8564112364"><div class="ttname"><a href="group__Vectors.html#gad6524c4e36da91aae3fb6f8564112364">VEC_XSIZE</a></div><div class="ttdeci">#define VEC_XSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00077">matrix1d.h:77</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a63aae8f8140c218f00063ba9f3b7ac1e"><div class="ttname"><a href="classProgTomographAlignment.html#a63aae8f8140c218f00063ba9f3b7ac1e">ProgTomographAlignment::iteration</a></div><div class="ttdeci">int iteration</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00162">tomo_align_tilt_series.h:162</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a5cab83f651abdfaa2777d777bd094ec1"><div class="ttname"><a href="classProgTomographAlignment.html#a5cab83f651abdfaa2777d777bd094ec1">ProgTomographAlignment::isOutlier</a></div><div class="ttdeci">Matrix1D&lt; int &gt; isOutlier</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00258">tomo_align_tilt_series.h:258</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a3fa403d828d133eab75d26778795f1db"><div class="ttname"><a href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">ProgTomographAlignment::Nimg</a></div><div class="ttdeci">int Nimg</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00261">tomo_align_tilt_series.h:261</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a5718970fd91bc623ada85a3ca635ee3b"><div class="ttname"><a href="classProgTomographAlignment.html#a5718970fd91bc623ada85a3ca635ee3b">ProgTomographAlignment::name_list</a></div><div class="ttdeci">std::vector&lt; std::string &gt; name_list</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00249">tomo_align_tilt_series.h:249</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a549ad45a1e9e26f2b983a209de5db173"><div class="ttname"><a href="classProgTomographAlignment.html#a549ad45a1e9e26f2b983a209de5db173">ProgTomographAlignment::identifyOutliersZ</a></div><div class="ttdeci">double identifyOutliersZ</div><div class="ttdoc">Identify outlier micrographs. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00150">tomo_align_tilt_series.h:150</a></div></div>
<div class="ttc" id="classMultidimArray_html_a758751c52bbc190798b7941ced1cb8c4"><div class="ttname"><a href="classMultidimArray.html#a758751c52bbc190798b7941ced1cb8c4">MultidimArray::computeMedian</a></div><div class="ttdeci">double computeMedian() const</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01951">multidim_array.h:1951</a></div></div>
<div class="ttc" id="classMatrix1D_html_a203e2128d65fd2d51dc764f5e7c52a63"><div class="ttname"><a href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">Matrix1D::initZeros</a></div><div class="ttdeci">void initZeros()</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00592">matrix1d.h:592</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a18e8e8a40a20208e980fb46a85f8dc3d"><div class="ttname"><a href="classProgTomographAlignment.html#a18e8e8a40a20208e980fb46a85f8dc3d">ProgTomographAlignment::affineTransformations</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Matrix2D&lt; double &gt; &gt; &gt; affineTransformations</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00265">tomo_align_tilt_series.h:265</a></div></div>
<div class="ttc" id="classMultidimArray_html_a3aa0e8d03bc68f58860621085efc2fdd"><div class="ttname"><a href="classMultidimArray.html#a3aa0e8d03bc68f58860621085efc2fdd">MultidimArray::selfABS</a></div><div class="ttdeci">void selfABS()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03330">multidim_array.h:3330</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a27a3b5258d86502df1c4e24388c25314"><div class="ttname"><a href="classProgTomographAlignment.html#a27a3b5258d86502df1c4e24388c25314">ProgTomographAlignment::correlationList</a></div><div class="ttdeci">std::vector&lt; double &gt; correlationList</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00268">tomo_align_tilt_series.h:268</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6e5ae6536e56d2cde3f18ca346f4fb12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e5ae6536e56d2cde3f18ca346f4fb12">&#9670;&nbsp;</a></span>produceInformationFromLandmarks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgTomographAlignment::produceInformationFromLandmarks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Produce information from landmarks. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8cpp_source.html#l02414">2414</a> of file <a class="el" href="tomo__align__tilt__series_8cpp_source.html">tomo_align_tilt_series.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;{</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    <span class="comment">// Produce V sets</span></div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    std::vector&lt;int&gt; emptyVector;</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a9e77688a46fde1f0d00da6cf69b33e83">Vseti</a>.clear();</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a>(<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a9e77688a46fde1f0d00da6cf69b33e83">Vseti</a>.push_back(emptyVector);</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a18a79b2c97411b080436beadb5bfb6d4">Vsetj</a>.clear();</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;<a class="code" href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a>(<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a18a79b2c97411b080436beadb5bfb6d4">Vsetj</a>.push_back(emptyVector);</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;<a class="code" href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a>(<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a>(<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)!=<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0]))</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;            {</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;                <a class="code" href="classProgTomographAlignment.html#a9e77688a46fde1f0d00da6cf69b33e83">Vseti</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].push_back(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;                <a class="code" href="classProgTomographAlignment.html#a18a79b2c97411b080436beadb5bfb6d4">Vsetj</a>[<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>].push_back(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;            }</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    <span class="comment">// Count the number of landmarks per image and average projection</span></div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    <span class="comment">// of all landmarks in a given image</span></div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a7266e57c1152899236bc313bd0466ca4">ni</a>.<a class="code" href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">initZeros</a>(<a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>);</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    <a class="code" href="classProgTomographAlignment.html#ab74e4c20e5076a2e5b2e0ed80e76a89e">barpi</a>.clear();</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    {</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a7266e57c1152899236bc313bd0466ca4">ni</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)=<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classProgTomographAlignment.html#a9e77688a46fde1f0d00da6cf69b33e83">Vseti</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].size());</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> <a class="code" href="spherical__harmonics_8h.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>(2);</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj=0; jj&lt;<a class="code" href="classProgTomographAlignment.html#a7266e57c1152899236bc313bd0466ca4">ni</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>); jj++)</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;        {</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=<a class="code" href="classProgTomographAlignment.html#a9e77688a46fde1f0d00da6cf69b33e83">Vseti</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][jj];</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;            <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(<a class="code" href="spherical__harmonics_8h.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>)+=<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>(j,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;            <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(<a class="code" href="spherical__harmonics_8h.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>)+=<a class="code" href="classProgTomographAlignment.html#a8dcbb879ecd56dd2db6839b9b53fae9f">allLandmarksY</a>(j,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;        }</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;        <a class="code" href="spherical__harmonics_8h.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>/=<a class="code" href="classProgTomographAlignment.html#a7266e57c1152899236bc313bd0466ca4">ni</a>(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;        <a class="code" href="classProgTomographAlignment.html#ab74e4c20e5076a2e5b2e0ed80e76a89e">barpi</a>.push_back(<a class="code" href="spherical__harmonics_8h.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>);</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;    }</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;}</div><div class="ttc" id="group__Matrices_html_ga43e28f6079b3652588d5b76ff199ff1e"><div class="ttname"><a href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a></div><div class="ttdeci">#define MAT_YSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00124">matrix2d.h:124</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a8dcbb879ecd56dd2db6839b9b53fae9f"><div class="ttname"><a href="classProgTomographAlignment.html#a8dcbb879ecd56dd2db6839b9b53fae9f">ProgTomographAlignment::allLandmarksY</a></div><div class="ttdeci">Matrix2D&lt; double &gt; allLandmarksY</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00274">tomo_align_tilt_series.h:274</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ab74e4c20e5076a2e5b2e0ed80e76a89e"><div class="ttname"><a href="classProgTomographAlignment.html#ab74e4c20e5076a2e5b2e0ed80e76a89e">ProgTomographAlignment::barpi</a></div><div class="ttdeci">std::vector&lt; Matrix1D&lt; double &gt; &gt; barpi</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00283">tomo_align_tilt_series.h:283</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a7266e57c1152899236bc313bd0466ca4"><div class="ttname"><a href="classProgTomographAlignment.html#a7266e57c1152899236bc313bd0466ca4">ProgTomographAlignment::ni</a></div><div class="ttdeci">Matrix1D&lt; int &gt; ni</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00286">tomo_align_tilt_series.h:286</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a2127199afbebe9268549e5348b29b95f"><div class="ttname"><a href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">ProgTomographAlignment::allLandmarksX</a></div><div class="ttdeci">Matrix2D&lt; double &gt; allLandmarksX</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00271">tomo_align_tilt_series.h:271</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a3fa403d828d133eab75d26778795f1db"><div class="ttname"><a href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">ProgTomographAlignment::Nimg</a></div><div class="ttdeci">int Nimg</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00261">tomo_align_tilt_series.h:261</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00085">matrix1d.h:85</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a9e77688a46fde1f0d00da6cf69b33e83"><div class="ttname"><a href="classProgTomographAlignment.html#a9e77688a46fde1f0d00da6cf69b33e83">ProgTomographAlignment::Vseti</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; Vseti</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00277">tomo_align_tilt_series.h:277</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00091">multidim_array_base.h:91</a></div></div>
<div class="ttc" id="classMatrix1D_html_a203e2128d65fd2d51dc764f5e7c52a63"><div class="ttname"><a href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">Matrix1D::initZeros</a></div><div class="ttdeci">void initZeros()</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00592">matrix1d.h:592</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a5c3a49bb5d046f0ee574b9f43c19420a"><div class="ttname"><a href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">ProgTomographAlignment::img</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; unsigned char &gt; * &gt; img</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00237">tomo_align_tilt_series.h:237</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00093">matrix1d.h:93</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a18a79b2c97411b080436beadb5bfb6d4"><div class="ttname"><a href="classProgTomographAlignment.html#a18a79b2c97411b080436beadb5bfb6d4">ProgTomographAlignment::Vsetj</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; Vsetj</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00280">tomo_align_tilt_series.h:280</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Matrices_html_gacd5c6ac63f21fdbbd4343a9caf1ee9c6"><div class="ttname"><a href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a></div><div class="ttdeci">#define MAT_XSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00120">matrix2d.h:120</a></div></div>
<div class="ttc" id="spherical__harmonics_8h_html_a1daf785e3f68d293c7caa1c756d5cb74"><div class="ttname"><a href="spherical__harmonics_8h.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a></div><div class="ttdeci">#define pi</div><div class="ttdef"><b>Definition:</b> <a href="spherical__harmonics_8h_source.html#l00035">spherical_harmonics.h:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afd582a8a73ef7bbc7855de16a2ebc549"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd582a8a73ef7bbc7855de16a2ebc549">&#9670;&nbsp;</a></span>produceSideInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgTomographAlignment::produceSideInfo </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Produce side info. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8cpp_source.html#l00742">742</a> of file <a class="el" href="tomo__align__tilt__series_8cpp_source.html">tomo_align_tilt_series.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;{</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="comment">// Difficult images?</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#aa610621f5be969da18b79e8ca9aaa5bf">difficult</a>)</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    {</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#ad2a716317a1ae6cce2b05f4cf402cdc3">pyramidLevel</a>==0)</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <a class="code" href="classProgTomographAlignment.html#ad2a716317a1ae6cce2b05f4cf402cdc3">pyramidLevel</a>=2;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a9de431b2d85fc5d700dc4f90bb98ec3f">localSize</a>&lt;0.05)</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            <a class="code" href="classProgTomographAlignment.html#a9de431b2d85fc5d700dc4f90bb98ec3f">localSize</a>=0.08;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#af96123b461a6fad645f8ab5d94beca33">seqLength</a>==5)</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            <a class="code" href="classProgTomographAlignment.html#af96123b461a6fad645f8ab5d94beca33">seqLength</a>=11;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    }</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a174552865b1ce2cafcdc2f6303eb8704">bestPreviousAlignment</a>=<span class="keyword">new</span> <a class="code" href="namespaceAlignment.html">Alignment</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="comment">// Read input data</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a9ed9e03ce422388ba0725d3d58f1febd">SF</a>.<a class="code" href="classMetaDataVec.html#a7cd6d7a24dc4f84b05b9087732e69792">read</a>(<a class="code" href="classProgTomographAlignment.html#a5eded8363249e66bb494068a35883aa6">fnSel</a>,<span class="keyword">nullptr</span>);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a9ed9e03ce422388ba0725d3d58f1febd">SF</a>.<a class="code" href="classMetaDataVec.html#a8aaa63269cf2564662ae806609493315">containsLabel</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78adc4c6714fd11379df071ebe8a442c30d">MDL_ENABLED</a>))</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a9ed9e03ce422388ba0725d3d58f1febd">SF</a>.<a class="code" href="classMetaDataVec.html#a67b4c734b4d662531262915bd93db436">removeObjects</a>(<a class="code" href="classMDValueEQ.html">MDValueEQ</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78adc4c6714fd11379df071ebe8a442c30d">MDL_ENABLED</a>, -1));</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>=<a class="code" href="classProgTomographAlignment.html#a9ed9e03ce422388ba0725d3d58f1febd">SF</a>.<a class="code" href="classMetaDataVec.html#a6dadeeb468ea65886b16518818b84111">size</a>();</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>!=0)</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    {</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="comment">// Clear the list of images if not empty</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>.empty())</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        {</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                <span class="keyword">delete</span> <a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            <a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>.clear();</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        }</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="comment">// Clear the list of masks if not empty</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classProgTomographAlignment.html#af9232ef65b1b4e153d7a20e0328cab8c">maskImg</a>.empty())</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        {</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="classProgTomographAlignment.html#af9232ef65b1b4e153d7a20e0328cab8c">maskImg</a>.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                <span class="keyword">delete</span> <a class="code" href="classProgTomographAlignment.html#af9232ef65b1b4e153d7a20e0328cab8c">maskImg</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            <a class="code" href="classProgTomographAlignment.html#af9232ef65b1b4e153d7a20e0328cab8c">maskImg</a>.clear();</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        }</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;Reading input data\n&quot;</span>;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <a class="code" href="group__GeneralFunctions.html#ga8c220fe710ecdb4f9b1696dd53e20ff3">init_progress_bar</a>(<a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>);</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a63aae8f8140c218f00063ba9f3b7ac1e">iteration</a>=0;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>=0;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a0c538b90574f9b5dd18aa5752499d5d0">iMinTilt</a>=-1;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="keywordtype">double</span> minTilt=1000;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <span class="keywordtype">bool</span> nonZeroTilt=<span class="keyword">false</span>;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <a class="code" href="classImage.html">Image&lt;double&gt;</a> imgaux;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <a class="code" href="classFileName.html">FileName</a> fn;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> objId : <a class="code" href="classProgTomographAlignment.html#a9ed9e03ce422388ba0725d3d58f1febd">SF</a>.<a class="code" href="classMetaData.html#aef20bffda56f171ad4e8817004451a95">ids</a>())</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        {</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            <a class="code" href="classProgTomographAlignment.html#a9ed9e03ce422388ba0725d3d58f1febd">SF</a>.<a class="code" href="classMetaDataVec.html#a71728ad7664da6eba90ec1dbc787d434">getValue</a>( <a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a>, fn, objId);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            imgaux.<a class="code" href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">read</a>(fn);</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#aa610621f5be969da18b79e8ca9aaa5bf">difficult</a>)</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            {</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                <span class="comment">//ImageXmipp save;</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                <span class="comment">//save()=imgaux(); save.write(&quot;PPPoriginal.xmp&quot;);</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> Ifiltered;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                Ifiltered=imgaux();</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                Ifiltered.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                <span class="comment">// Reject outliers</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                <a class="code" href="group__Histograms.html#ga4faab22da6fb9a8b2cb2c9ca3156696e">reject_outliers</a>(Ifiltered,0.5);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                <span class="comment">// Subtract background plane</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                <a class="code" href="group__Filters.html#ga11b22ba5fdb8431cb8c534ae4a91d554">substractBackgroundPlane</a>(Ifiltered);</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                <span class="comment">// Subtract the background (rolling ball)</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                <a class="code" href="group__Filters.html#gaa6c14e5ee97aee4c8c4a0db657d610e0">substractBackgroundRollingBall</a>(Ifiltered,</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                                               <a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Ifiltered)/10);</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                <span class="comment">// Bandpass the image</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                <a class="code" href="classFourierFilter.html">FourierFilter</a> FilterBP;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                FilterBP.<a class="code" href="classFourierFilter.html#a7e847d4cdbf21e78ef474a42bd2da833">FilterBand</a>=<a class="code" href="fourier__filter_8h.html#a3ebfa4d7e384f53e6a37ff0d0d98627d">BANDPASS</a>;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                FilterBP.<a class="code" href="classFourierFilter.html#a6b96657901248fdd1b4c7af47dc9c88d">w1</a>=1.0/<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Ifiltered);</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                FilterBP.<a class="code" href="classFourierFilter.html#a2359798f756bb467638c4e17a808cc15">w2</a>=100.0/<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Ifiltered);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                FilterBP.<a class="code" href="classFourierFilter.html#aea0ec5fde630cbab5f98736c34e7e938">raised_w</a>=1.0/<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(Ifiltered);</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                FilterBP.<a class="code" href="classFourierFilter.html#ac7a39b3eafb64b11aa089c4f03bd5714">generateMask</a>(Ifiltered);</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                FilterBP.<a class="code" href="classFourierFilter.html#a628762260d6099753fa4b55adc4cfbb0">applyMaskSpace</a>(Ifiltered);</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                <span class="comment">// Equalize histogram</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                <span class="comment">//histogram_equalization(Ifiltered,8);</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                imgaux()=Ifiltered;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                <span class="comment">//save()=Ifiltered; save.write(&quot;PPPpreprocessed.xmp&quot;);</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                <span class="comment">//std::cout &lt;&lt; &quot;Press\n&quot;;</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                <span class="comment">//char c; std::cin &gt;&gt; c;</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            }</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classProgTomographAlignment.html#a249db0f7eb2c90811b6bdf98ffddb01a">useCriticalPoints</a>)</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            {</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                <span class="keyword">auto</span>* mask_i=<span class="keyword">new</span> <a class="code" href="classMultidimArray.html">MultidimArray&lt;unsigned char&gt;</a>;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                <a class="code" href="tomo__align__tilt__series_8cpp.html#a7db8c8fbe21c95428f46cd3052c30af4">generateMask</a>(imgaux(),*mask_i,</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                             <a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="classProgTomographAlignment.html#a9de431b2d85fc5d700dc4f90bb98ec3f">localSize</a>*<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(imgaux()))/2,5));</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                <a class="code" href="classProgTomographAlignment.html#af9232ef65b1b4e153d7a20e0328cab8c">maskImg</a>.push_back(mask_i);</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            }</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            <span class="keyword">auto</span>* img_i=<span class="keyword">new</span> <a class="code" href="classMultidimArray.html">MultidimArray&lt;unsigned char&gt;</a>;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            imgaux().rangeAdjust(0,255);</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <a class="code" href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a>(imgaux(),*img_i);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            img_i-&gt;setXmippOrigin();</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            <a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>.push_back(img_i);</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            <span class="keywordtype">double</span> tiltAngle;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a9ed9e03ce422388ba0725d3d58f1febd">SF</a>.<a class="code" href="classMetaDataVec.html#a8aaa63269cf2564662ae806609493315">containsLabel</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac15f836e18a2035d2923ecf76c6e8c7f">MDL_ANGLE_TILT</a>))</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                <a class="code" href="classProgTomographAlignment.html#a9ed9e03ce422388ba0725d3d58f1febd">SF</a>.<a class="code" href="classMetaDataVec.html#a71728ad7664da6eba90ec1dbc787d434">getValue</a>(<a class="code" href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac15f836e18a2035d2923ecf76c6e8c7f">MDL_ANGLE_TILT</a>,tiltAngle, objId);</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                tiltAngle=imgaux.<a class="code" href="classImageBase.html#a14098c8a502f3b324ffccef3fcde0de9">tilt</a>();</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            <a class="code" href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">tiltList</a>.push_back(tiltAngle);</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            <span class="keywordflow">if</span> (tiltAngle!=0)</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                nonZeroTilt=<span class="keyword">true</span>;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(tiltAngle)&lt;minTilt)</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            {</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                <a class="code" href="classProgTomographAlignment.html#a0c538b90574f9b5dd18aa5752499d5d0">iMinTilt</a>=<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                minTilt=<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(tiltAngle);</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            }</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            <a class="code" href="classProgTomographAlignment.html#a5718970fd91bc623ada85a3ca635ee3b">name_list</a>.push_back(imgaux.<a class="code" href="classImageBase.html#ab979a860ba0e8709310ca70814bdd143">name</a>());</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            <a class="code" href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a>(n++);</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            <a class="code" href="classProgTomographAlignment.html#a63aae8f8140c218f00063ba9f3b7ac1e">iteration</a>++;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        }</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <a class="code" href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a>(<a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>);</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        <span class="keywordflow">if</span> (!nonZeroTilt)</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa767e074578dbe92f13cff86630eb4774">ERR_VALUE_NOTSET</a>,<span class="stringliteral">&quot;Tilt angles have not been assigned to the input selfile&quot;</span>);</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    }</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="comment">// Read images at original scale</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classProgTomographAlignment.html#a6ea6fcf828dc13a2adf15713ad8a97ec">fnSelOrig</a>.empty())</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    {</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <a class="code" href="classProgTomographAlignment.html#aa46841d31bcc5d5eafa7fa36a0675f57">SForig</a>.<a class="code" href="classMetaDataVec.html#a7cd6d7a24dc4f84b05b9087732e69792">read</a>(<a class="code" href="classProgTomographAlignment.html#a6ea6fcf828dc13a2adf15713ad8a97ec">fnSelOrig</a>,<span class="keyword">nullptr</span>);</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <a class="code" href="classProgTomographAlignment.html#aa46841d31bcc5d5eafa7fa36a0675f57">SForig</a>.<a class="code" href="classMetaData.html#a55651d0806335c55622838d62b8068b5">removeDisabled</a>();</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#aa46841d31bcc5d5eafa7fa36a0675f57">SForig</a>.<a class="code" href="classMetaDataVec.html#a6dadeeb468ea65886b16518818b84111">size</a>()!=<a class="code" href="classProgTomographAlignment.html#a9ed9e03ce422388ba0725d3d58f1febd">SF</a>.<a class="code" href="classMetaDataVec.html#a6dadeeb468ea65886b16518818b84111">size</a>())</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aaa388385302a356a804e513dba1d8169f">ERR_MD_OBJECTNUMBER</a>,<span class="stringliteral">&quot;The number of images in both selfiles (-i and -iorig) is different&quot;</span>);</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    }</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="comment">// Fill the affine transformations with empty matrices</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    std::vector&lt; Matrix2D&lt;double&gt; &gt; emptyRow;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    {</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> A;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        emptyRow.push_back(A);</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    }</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    {</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a18e8e8a40a20208e980fb46a85f8dc3d">affineTransformations</a>.push_back(emptyRow);</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a27a3b5258d86502df1c4e24388c25314">correlationList</a>.push_back(-1);</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    }</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="comment">// Check if there are transformations already calculated</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <a class="code" href="classFileName.html">FileName</a> fn_tmp = <a class="code" href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">fnRoot</a>+<span class="stringliteral">&quot;_transformations.txt&quot;</span>;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordflow">if</span> (fn_tmp.<a class="code" href="classFileName.html#ae42eca3e976e48f40f3e0c3ece19427b">exists</a>())</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    {</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        std::ifstream fhIn;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        fhIn.open(fn_tmp.c_str());</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="keywordflow">if</span> (!fhIn)</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aae2056cec6ccd16ef57befd5caa6d5fa7">ERR_IO_NOTEXIST</a>,(<a class="code" href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a>)<span class="stringliteral">&quot;Cannot open &quot;</span>+ fn_tmp);</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="keywordtype">size_t</span> linesRead=0;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="keywordflow">while</span> (!fhIn.eof())</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        {</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            std::string line;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            getline(fhIn, line);</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            <span class="keywordflow">if</span> (linesRead&lt;<a class="code" href="classProgTomographAlignment.html#a18e8e8a40a20208e980fb46a85f8dc3d">affineTransformations</a>.size()-1 &amp;&amp; line!=<span class="stringliteral">&quot;&quot;</span>)</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            {</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                std::vector&lt; double &gt; data;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                <a class="code" href="group__Arguments.html#ga83b5ccb8348982c6232c6d48ca29b9a1">readFloatList</a>(line.c_str(), 8, data);</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                <span class="keywordtype">double</span> tilt=data[0];</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                <span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                <span class="keywordtype">double</span> bestDistance=<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(tilt-<a class="code" href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">tiltList</a>[0]);</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;<a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                {</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                    <span class="keywordtype">double</span> <a class="code" href="point_8cpp.html#adb0abda300c610b969c8be89ed30a4f6">distance</a>=<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(tilt-<a class="code" href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">tiltList</a>[<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>]);</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                    <span class="keywordflow">if</span> (bestDistance&gt;distance)</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                    {</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                        bestDistance=<a class="code" href="point_8cpp.html#adb0abda300c610b969c8be89ed30a4f6">distance</a>;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                        i=<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                    }</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                }</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                <a class="code" href="classProgTomographAlignment.html#a18e8e8a40a20208e980fb46a85f8dc3d">affineTransformations</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][i+1].resize(3,3);</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                <a class="code" href="classProgTomographAlignment.html#a18e8e8a40a20208e980fb46a85f8dc3d">affineTransformations</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][i+1].initIdentity(3);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                <a class="code" href="classProgTomographAlignment.html#a18e8e8a40a20208e980fb46a85f8dc3d">affineTransformations</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][i+1](0,0)=data[2];</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                <a class="code" href="classProgTomographAlignment.html#a18e8e8a40a20208e980fb46a85f8dc3d">affineTransformations</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][i+1](1,0)=data[3];</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                affineTransformations[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][i+1](0,1)=data[4];</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                affineTransformations[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][i+1](1,1)=data[5];</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                affineTransformations[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][i+1](0,2)=data[6];</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                affineTransformations[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][i+1](1,2)=data[7];</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                affineTransformations[i+1][<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]=</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                    affineTransformations[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][i+1].inv();</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#ae0df630253ea3e7accf03dd2c0acb0a7">showAffine</a>)</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                {</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                    <a class="code" href="classMultidimArray.html">MultidimArray&lt;unsigned char&gt;</a>&amp; img_i=*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                    <a class="code" href="classMultidimArray.html">MultidimArray&lt;unsigned char&gt;</a>&amp; img_j=*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[i+1];</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                    <span class="keywordtype">int</span> maxShift=<a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>(<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0])*<a class="code" href="classProgTomographAlignment.html#a6a2e598c712e94b90d9a99e413d7e120">maxShiftPercentage</a>);</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> Aij, Aji;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                    Aij=affineTransformations[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][i+1];</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                    Aji=affineTransformations[i+1][<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                    <span class="keywordtype">bool</span> isMirror=<span class="keyword">false</span>;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;Transformation between &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; (&quot;</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                    &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">tiltList</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; <span class="stringliteral">&quot;) and &quot;</span> &lt;&lt; i+1 &lt;&lt; <span class="stringliteral">&quot; (&quot;</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                    &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">tiltList</a>[i+1] &lt;&lt; std::endl;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                    <span class="keywordtype">double</span> cost = <a class="code" href="tomo__align__tilt__series_8cpp.html#a92cfb187633eecdc210ef9c5e9c72ba5">computeAffineTransformation</a>(img_i, img_j,</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                                  maxShift, <a class="code" href="classProgTomographAlignment.html#abd71803ad9478f7b779e58472ec415ad">maxIterDE</a>, Aij, Aji,</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                                  <a class="code" href="classProgTomographAlignment.html#ae0df630253ea3e7accf03dd2c0acb0a7">showAffine</a>, <a class="code" href="classProgTomographAlignment.html#a8f45ff4b5de10a2ee5ed0b54b1700fd5">thresholdAffine</a>, <a class="code" href="classProgTomographAlignment.html#a9042cbb5b5fad3b5cbe697af4dca2d67">globalAffine</a>,</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                                  isMirror,<span class="keyword">true</span>, <a class="code" href="classProgTomographAlignment.html#ad2a716317a1ae6cce2b05f4cf402cdc3">pyramidLevel</a>);</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                    <span class="keywordflow">if</span> (cost&lt;0)</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                    {</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                        affineTransformations[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][i+1].clear();</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                        affineTransformations[i+1][<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].clear();</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                        <a class="code" href="classProgTomographAlignment.html#a0c7337a8112cc8f29c52cf6ff51d3efd">writeTransformations</a>(fn_tmp);</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                    }</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                }</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            }</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;            linesRead++;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        }</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        fhIn.close();</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    }</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="comment">// Compute the rest of transformations</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <a class="code" href="classProgTomographAlignment.html#aa83c07ba49b99652c116cf2a1e8d6649">computeAffineTransformations</a>(<a class="code" href="classProgTomographAlignment.html#a9042cbb5b5fad3b5cbe697af4dca2d67">globalAffine</a>);</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="comment">// Do not show refinement</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a0adc16d7de22929fc86de9f3ee726d00">showRefinement</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="comment">// Check which is the distribution of correlation</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classProgTomographAlignment.html#a249db0f7eb2c90811b6bdf98ffddb01a">useCriticalPoints</a>)</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    {</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <span class="keyword">auto</span> X0=(int)(<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(*(<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0]))+2*<a class="code" href="classProgTomographAlignment.html#a9de431b2d85fc5d700dc4f90bb98ec3f">localSize</a>*<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(*(<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0])));</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <span class="keyword">auto</span> XF=(int)(<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(*(<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0]))-2*<a class="code" href="classProgTomographAlignment.html#a9de431b2d85fc5d700dc4f90bb98ec3f">localSize</a>*<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(*(<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0])));</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <span class="keyword">auto</span> Y0=(int)(<a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(*(<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0]))+2*<a class="code" href="classProgTomographAlignment.html#a9de431b2d85fc5d700dc4f90bb98ec3f">localSize</a>*<a class="code" href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(*(<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0])));</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <span class="keyword">auto</span> YF=(int)(<a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(*(<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0]))-2*<a class="code" href="classProgTomographAlignment.html#a9de431b2d85fc5d700dc4f90bb98ec3f">localSize</a>*<a class="code" href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a>(*(<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0])));</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a2db3efcc5622e698680ea350a4d7393a">avgForwardPatchCorr</a>.<a class="code" href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">initZeros</a>(Nimg);</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <a class="code" href="classProgTomographAlignment.html#ade84fe045db3ff2f59bb680e2ad7c852">avgBackwardPatchCorr</a>.<a class="code" href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">initZeros</a>(Nimg);</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a2db3efcc5622e698680ea350a4d7393a">avgForwardPatchCorr</a>.<a class="code" href="classMatrix1D.html#a64e7d0a8fd1ed74d99b9607e832587b5">initConstant</a>(1);</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <a class="code" href="classProgTomographAlignment.html#ade84fe045db3ff2f59bb680e2ad7c852">avgBackwardPatchCorr</a>.<a class="code" href="classMatrix1D.html#a64e7d0a8fd1ed74d99b9607e832587b5">initConstant</a>(1);</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=0; ii&lt;<a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>; ++ii)</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        {</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            <span class="comment">// Compute average forward patch corr</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> corrList;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            <span class="keywordflow">if</span> (ii&lt;=Nimg-2)</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            {</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                corrList.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(200);</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                <a class="code" href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(corrList)</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                {</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> rii(3), rjj(3);</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                    <span class="keywordflow">do</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                    {</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                        <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rii)=<a class="code" href="group__GeneralFunctions.html#ga882088c3e41f9fdd7c357e868c001ed5">rnd_unif</a>(X0,XF);</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rii)=<a class="code" href="group__GeneralFunctions.html#ga882088c3e41f9fdd7c357e868c001ed5">rnd_unif</a>(Y0,YF);</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                        rjj=affineTransformations[ii][ii+1]*rii;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                        <a class="code" href="classProgTomographAlignment.html#ad5fecb6b28507271d09ffaa4e1992002">refineLandmark</a>(ii,ii+1,rii,rjj,corrList(i),<span class="keyword">false</span>);</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                    }</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                    <span class="keywordflow">while</span> (corrList(i)&lt;-0.99);</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                }</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                <a class="code" href="classProgTomographAlignment.html#a2db3efcc5622e698680ea350a4d7393a">avgForwardPatchCorr</a>(ii)=corrList.<a class="code" href="classMultidimArray.html#a773447c28d69eec234eee58a51c30e07">computeAvg</a>();</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            }</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            <span class="comment">// Compute average backward patch corr</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;            <span class="keywordflow">if</span> (ii&gt;0)</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            {</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                corrList.<a class="code" href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">initZeros</a>(200);</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                <a class="code" href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a>(corrList)</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                {</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> rii(3), rjj(3);</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                    <span class="keywordflow">do</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                    {</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                        <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rii)=<a class="code" href="group__GeneralFunctions.html#ga882088c3e41f9fdd7c357e868c001ed5">rnd_unif</a>(X0,XF);</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rii)=<a class="code" href="group__GeneralFunctions.html#ga882088c3e41f9fdd7c357e868c001ed5">rnd_unif</a>(Y0,YF);</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                        rjj=affineTransformations[ii][ii-1]*rii;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                        <a class="code" href="classProgTomographAlignment.html#ad5fecb6b28507271d09ffaa4e1992002">refineLandmark</a>(ii,ii-1,rii,rjj,corrList(i),<span class="keyword">false</span>);</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                    }</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                    <span class="keywordflow">while</span> (corrList(i)&lt;-0.99);</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                }</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                <a class="code" href="classProgTomographAlignment.html#ade84fe045db3ff2f59bb680e2ad7c852">avgBackwardPatchCorr</a>(ii)=corrList.<a class="code" href="classMultidimArray.html#a773447c28d69eec234eee58a51c30e07">computeAvg</a>();</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;            }</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Image &quot;</span> &lt;&lt; ii &lt;&lt; <span class="stringliteral">&quot; Average correlation forward=&quot;</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a2db3efcc5622e698680ea350a4d7393a">avgForwardPatchCorr</a>(ii)</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; backward=&quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#ade84fe045db3ff2f59bb680e2ad7c852">avgBackwardPatchCorr</a>(ii) &lt;&lt; std::endl;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            <a class="code" href="classProgTomographAlignment.html#a63aae8f8140c218f00063ba9f3b7ac1e">iteration</a>++;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        }</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    }</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="comment">// Identify outliers</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classProgTomographAlignment.html#a18dab8ec016cdb49c491d42d2d6b9998">doNotIdentifyOutliers</a>)</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    {</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        <a class="code" href="classProgTomographAlignment.html#afd76d988df1c69f11fafd277735bc7ea">identifyOutliers</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        <a class="code" href="classProgTomographAlignment.html#aa83c07ba49b99652c116cf2a1e8d6649">computeAffineTransformations</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        <a class="code" href="classProgTomographAlignment.html#afd76d988df1c69f11fafd277735bc7ea">identifyOutliers</a>(<span class="keyword">true</span>);</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    }</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a5cab83f651abdfaa2777d777bd094ec1">isOutlier</a>.<a class="code" href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">initZeros</a>(Nimg);</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a483ebbe46f0bce2a09681223aef10739">lastStep</a>==0)</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        exit(0);</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;}</div><div class="ttc" id="classProgTomographAlignment_html_a9042cbb5b5fad3b5cbe697af4dca2d67"><div class="ttname"><a href="classProgTomographAlignment.html#a9042cbb5b5fad3b5cbe697af4dca2d67">ProgTomographAlignment::globalAffine</a></div><div class="ttdeci">bool globalAffine</div><div class="ttdoc">Look for local affine transformation. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00092">tomo_align_tilt_series.h:92</a></div></div>
<div class="ttc" id="classMetaDataVec_html_a67b4c734b4d662531262915bd93db436"><div class="ttname"><a href="classMetaDataVec.html#a67b4c734b4d662531262915bd93db436">MetaDataVec::removeObjects</a></div><div class="ttdeci">void removeObjects(const std::vector&lt; size_t &gt; &amp;toRemove) override</div><div class="ttdef"><b>Definition:</b> <a href="metadata__vec_8cpp_source.html#l00489">metadata_vec.cpp:489</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga8c220fe710ecdb4f9b1696dd53e20ff3"><div class="ttname"><a href="group__GeneralFunctions.html#ga8c220fe710ecdb4f9b1696dd53e20ff3">init_progress_bar</a></div><div class="ttdeci">void init_progress_bar(long total)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00782">xmipp_funcs.cpp:782</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ad5fecb6b28507271d09ffaa4e1992002"><div class="ttname"><a href="classProgTomographAlignment.html#ad5fecb6b28507271d09ffaa4e1992002">ProgTomographAlignment::refineLandmark</a></div><div class="ttdeci">bool refineLandmark(int ii, int jj, const Matrix1D&lt; double &gt; &amp;rii, Matrix1D&lt; double &gt; &amp;rjj, double &amp;maxCorr, bool tryFourier) const</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l01735">tomo_align_tilt_series.cpp:1735</a></div></div>
<div class="ttc" id="classFourierFilter_html_a6b96657901248fdd1b4c7af47dc9c88d"><div class="ttname"><a href="classFourierFilter.html#a6b96657901248fdd1b4c7af47dc9c88d">FourierFilter::w1</a></div><div class="ttdeci">double w1</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00109">fourier_filter.h:109</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a93a0591d7e0c8b4ab932b3a45b359650"><div class="ttname"><a href="multidim__array__base_8h.html#a93a0591d7e0c8b4ab932b3a45b359650">YSIZE</a></div><div class="ttdeci">#define YSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00095">multidim_array_base.h:95</a></div></div>
<div class="ttc" id="group__Macros_html_gae0a4180e923e3ffca3989e20e441aa3c"><div class="ttname"><a href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a></div><div class="ttdeci">#define XMIPP_MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00193">xmipp_macros.h:193</a></div></div>
<div class="ttc" id="point_8cpp_html_adb0abda300c610b969c8be89ed30a4f6"><div class="ttname"><a href="point_8cpp.html#adb0abda300c610b969c8be89ed30a4f6">distance</a></div><div class="ttdeci">TYPE distance(struct Point_T *p, struct Point_T *q)</div><div class="ttdef"><b>Definition:</b> <a href="point_8cpp_source.html#l00028">point.cpp:28</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a0c538b90574f9b5dd18aa5752499d5d0"><div class="ttname"><a href="classProgTomographAlignment.html#a0c538b90574f9b5dd18aa5752499d5d0">ProgTomographAlignment::iMinTilt</a></div><div class="ttdeci">int iMinTilt</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00243">tomo_align_tilt_series.h:243</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a6a2e598c712e94b90d9a99e413d7e120"><div class="ttname"><a href="classProgTomographAlignment.html#a6a2e598c712e94b90d9a99e413d7e120">ProgTomographAlignment::maxShiftPercentage</a></div><div class="ttdeci">double maxShiftPercentage</div><div class="ttdoc">Maxshift percentage. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00111">tomo_align_tilt_series.h:111</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classMetaDataVec_html_a7cd6d7a24dc4f84b05b9087732e69792"><div class="ttname"><a href="classMetaDataVec.html#a7cd6d7a24dc4f84b05b9087732e69792">MetaDataVec::read</a></div><div class="ttdeci">void read(const FileName &amp;inFile, const std::vector&lt; MDLabel &gt; *desiredLabels=nullptr, bool decomposeStack=true) override</div><div class="ttdef"><b>Definition:</b> <a href="metadata__vec_8cpp_source.html#l00120">metadata_vec.cpp:120</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a98fedcd4fef7c8e1504eb3b1d4cc86d0"><div class="ttname"><a href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">ProgTomographAlignment::tiltList</a></div><div class="ttdeci">std::vector&lt; double &gt; tiltList</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00246">tomo_align_tilt_series.h:246</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00211">xmipp_error.h:211</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_af96123b461a6fad645f8ab5d94beca33"><div class="ttname"><a href="classProgTomographAlignment.html#af96123b461a6fad645f8ab5d94beca33">ProgTomographAlignment::seqLength</a></div><div class="ttdeci">size_t seqLength</div><div class="ttdoc">Sequence Length. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00101">tomo_align_tilt_series.h:101</a></div></div>
<div class="ttc" id="tomo__align__tilt__series_8cpp_html_a7db8c8fbe21c95428f46cd3052c30af4"><div class="ttname"><a href="tomo__align__tilt__series_8cpp.html#a7db8c8fbe21c95428f46cd3052c30af4">generateMask</a></div><div class="ttdeci">void generateMask(const MultidimArray&lt; double &gt; &amp;I, MultidimArray&lt; unsigned char &gt; &amp;mask, int patchSize)</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l00040">tomo_align_tilt_series.cpp:40</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a63aae8f8140c218f00063ba9f3b7ac1e"><div class="ttname"><a href="classProgTomographAlignment.html#a63aae8f8140c218f00063ba9f3b7ac1e">ProgTomographAlignment::iteration</a></div><div class="ttdeci">int iteration</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00162">tomo_align_tilt_series.h:162</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a5cab83f651abdfaa2777d777bd094ec1"><div class="ttname"><a href="classProgTomographAlignment.html#a5cab83f651abdfaa2777d777bd094ec1">ProgTomographAlignment::isOutlier</a></div><div class="ttdeci">Matrix1D&lt; int &gt; isOutlier</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00258">tomo_align_tilt_series.h:258</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_af9232ef65b1b4e153d7a20e0328cab8c"><div class="ttname"><a href="classProgTomographAlignment.html#af9232ef65b1b4e153d7a20e0328cab8c">ProgTomographAlignment::maskImg</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; unsigned char &gt; * &gt; maskImg</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00240">tomo_align_tilt_series.h:240</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac15f836e18a2035d2923ecf76c6e8c7f"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78ac15f836e18a2035d2923ecf76c6e8c7f">MDL_ANGLE_TILT</a></div><div class="ttdoc">Tilting angle of an image (double,degrees) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00059">metadata_label.h:59</a></div></div>
<div class="ttc" id="fourier__filter_8h_html_a3ebfa4d7e384f53e6a37ff0d0d98627d"><div class="ttname"><a href="fourier__filter_8h.html#a3ebfa4d7e384f53e6a37ff0d0d98627d">BANDPASS</a></div><div class="ttdeci">#define BANDPASS</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00079">fourier_filter.h:79</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a9ed9e03ce422388ba0725d3d58f1febd"><div class="ttname"><a href="classProgTomographAlignment.html#a9ed9e03ce422388ba0725d3d58f1febd">ProgTomographAlignment::SF</a></div><div class="ttdeci">MetaDataVec SF</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00231">tomo_align_tilt_series.h:231</a></div></div>
<div class="ttc" id="group__Arguments_html_ga83b5ccb8348982c6232c6d48ca29b9a1"><div class="ttname"><a href="group__Arguments.html#ga83b5ccb8348982c6232c6d48ca29b9a1">readFloatList</a></div><div class="ttdeci">void readFloatList(const char *str, int N, std::vector&lt; T &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="args_8h_source.html#l00104">args.h:104</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a5eded8363249e66bb494068a35883aa6"><div class="ttname"><a href="classProgTomographAlignment.html#a5eded8363249e66bb494068a35883aa6">ProgTomographAlignment::fnSel</a></div><div class="ttdeci">FileName fnSel</div><div class="ttdoc">MetaData File with all images. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00080">tomo_align_tilt_series.h:80</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_abd71803ad9478f7b779e58472ec415ad"><div class="ttname"><a href="classProgTomographAlignment.html#abd71803ad9478f7b779e58472ec415ad">ProgTomographAlignment::maxIterDE</a></div><div class="ttdeci">int maxIterDE</div><div class="ttdoc">Maximum number of iterations in Differential Evolution. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00114">tomo_align_tilt_series.h:114</a></div></div>
<div class="ttc" id="classImageBase_html_ab979a860ba0e8709310ca70814bdd143"><div class="ttname"><a href="classImageBase.html#ab979a860ba0e8709310ca70814bdd143">ImageBase::name</a></div><div class="ttdeci">const FileName &amp; name() const</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8h_source.html#l00496">xmipp_image_base.h:496</a></div></div>
<div class="ttc" id="classMDValueEQ_html"><div class="ttname"><a href="classMDValueEQ.html">MDValueEQ</a></div><div class="ttdef"><b>Definition:</b> <a href="metadata__query_8h_source.html#l00170">metadata_query.h:170</a></div></div>
<div class="ttc" id="classFourierFilter_html_a7e847d4cdbf21e78ef474a42bd2da833"><div class="ttname"><a href="classFourierFilter.html#a7e847d4cdbf21e78ef474a42bd2da833">FourierFilter::FilterBand</a></div><div class="ttdeci">int FilterBand</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00105">fourier_filter.h:105</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_aa610621f5be969da18b79e8ca9aaa5bf"><div class="ttname"><a href="classProgTomographAlignment.html#aa610621f5be969da18b79e8ca9aaa5bf">ProgTomographAlignment::difficult</a></div><div class="ttdeci">bool difficult</div><div class="ttdoc">Difficult. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00138">tomo_align_tilt_series.h:138</a></div></div>
<div class="ttc" id="classMetaData_html_aef20bffda56f171ad4e8817004451a95"><div class="ttname"><a href="classMetaData.html#aef20bffda56f171ad4e8817004451a95">MetaData::ids</a></div><div class="ttdeci">virtual IdIteratorProxy&lt; false &gt; ids()</div><div class="ttdef"><b>Definition:</b> <a href="metadata__base_8h_source.html#l00762">metadata_base.h:762</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a238e1f42e2d7aeb892518355058ac6b1"><div class="ttname"><a href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">ProgTomographAlignment::fnRoot</a></div><div class="ttdeci">FileName fnRoot</div><div class="ttdoc">Output root. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00086">tomo_align_tilt_series.h:86</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a3fa403d828d133eab75d26778795f1db"><div class="ttname"><a href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">ProgTomographAlignment::Nimg</a></div><div class="ttdeci">int Nimg</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00261">tomo_align_tilt_series.h:261</a></div></div>
<div class="ttc" id="classFileName_html"><div class="ttname"><a href="classFileName.html">FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8h_source.html#l00065">xmipp_filename.h:65</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="classMetaDataVec_html_a6dadeeb468ea65886b16518818b84111"><div class="ttname"><a href="classMetaDataVec.html#a6dadeeb468ea65886b16518818b84111">MetaDataVec::size</a></div><div class="ttdeci">size_t size() const override</div><div class="ttdef"><b>Definition:</b> <a href="metadata__vec_8cpp_source.html#l00393">metadata_vec.cpp:393</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78adc4c6714fd11379df071ebe8a442c30d"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78adc4c6714fd11379df071ebe8a442c30d">MDL_ENABLED</a></div><div class="ttdoc">Is this image enabled? (int [-1 or 1]) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00231">metadata_label.h:231</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_aa83c07ba49b99652c116cf2a1e8d6649"><div class="ttname"><a href="classProgTomographAlignment.html#aa83c07ba49b99652c116cf2a1e8d6649">ProgTomographAlignment::computeAffineTransformations</a></div><div class="ttdeci">void computeAffineTransformations(bool globalAffineToUse)</div><div class="ttdoc">Compute affine transformations. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l00674">tomo_align_tilt_series.cpp:674</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aaa388385302a356a804e513dba1d8169f"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aaa388385302a356a804e513dba1d8169f">ERR_MD_OBJECTNUMBER</a></div><div class="ttdoc">Incorrect number of objects in Metadata. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00160">xmipp_error.h:160</a></div></div>
<div class="ttc" id="classFourierFilter_html_a2359798f756bb467638c4e17a808cc15"><div class="ttname"><a href="classFourierFilter.html#a2359798f756bb467638c4e17a808cc15">FourierFilter::w2</a></div><div class="ttdeci">double w2</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00112">fourier_filter.h:112</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8cpp_source.html#l00200">multidim_array_base.cpp:200</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a5718970fd91bc623ada85a3ca635ee3b"><div class="ttname"><a href="classProgTomographAlignment.html#a5718970fd91bc623ada85a3ca635ee3b">ProgTomographAlignment::name_list</a></div><div class="ttdeci">std::vector&lt; std::string &gt; name_list</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00249">tomo_align_tilt_series.h:249</a></div></div>
<div class="ttc" id="classImageBase_html_a14098c8a502f3b324ffccef3fcde0de9"><div class="ttname"><a href="classImageBase.html#a14098c8a502f3b324ffccef3fcde0de9">ImageBase::tilt</a></div><div class="ttdeci">double tilt(const size_t n=0) const</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00378">xmipp_image_base.cpp:378</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00059">multidim_array_base.h:59</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga882088c3e41f9fdd7c357e868c001ed5"><div class="ttname"><a href="group__GeneralFunctions.html#ga882088c3e41f9fdd7c357e868c001ed5">rnd_unif</a></div><div class="ttdeci">double rnd_unif()</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00440">xmipp_funcs.cpp:440</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a2db3efcc5622e698680ea350a4d7393a"><div class="ttname"><a href="classProgTomographAlignment.html#a2db3efcc5622e698680ea350a4d7393a">ProgTomographAlignment::avgForwardPatchCorr</a></div><div class="ttdeci">Matrix1D&lt; double &gt; avgForwardPatchCorr</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00252">tomo_align_tilt_series.h:252</a></div></div>
<div class="ttc" id="group__Macros_html_ga2f0eecb0f7856721f56faff8f27b0dc1"><div class="ttname"><a href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a></div><div class="ttdeci">#define FLOOR(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00240">xmipp_macros.h:240</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00085">matrix1d.h:85</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a483ebbe46f0bce2a09681223aef10739"><div class="ttname"><a href="classProgTomographAlignment.html#a483ebbe46f0bce2a09681223aef10739">ProgTomographAlignment::lastStep</a></div><div class="ttdeci">int lastStep</div><div class="ttdoc">Last step to run (-1=run them all) </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00159">tomo_align_tilt_series.h:159</a></div></div>
<div class="ttc" id="group__Histograms_html_ga4faab22da6fb9a8b2cb2c9ca3156696e"><div class="ttname"><a href="group__Histograms.html#ga4faab22da6fb9a8b2cb2c9ca3156696e">reject_outliers</a></div><div class="ttdeci">void reject_outliers(T &amp;v, double percentil_out=0.25)</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00605">histogram.h:605</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ade84fe045db3ff2f59bb680e2ad7c852"><div class="ttname"><a href="classProgTomographAlignment.html#ade84fe045db3ff2f59bb680e2ad7c852">ProgTomographAlignment::avgBackwardPatchCorr</a></div><div class="ttdeci">Matrix1D&lt; double &gt; avgBackwardPatchCorr</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00255">tomo_align_tilt_series.h:255</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00091">multidim_array_base.h:91</a></div></div>
<div class="ttc" id="group__GeneralFunctions_html_ga3bdba82f045e73fb216c6be539e6b129"><div class="ttname"><a href="group__GeneralFunctions.html#ga3bdba82f045e73fb216c6be539e6b129">progress_bar</a></div><div class="ttdeci">void progress_bar(long rlen)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__funcs_8cpp_source.html#l00791">xmipp_funcs.cpp:791</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a8f45ff4b5de10a2ee5ed0b54b1700fd5"><div class="ttname"><a href="classProgTomographAlignment.html#a8f45ff4b5de10a2ee5ed0b54b1700fd5">ProgTomographAlignment::thresholdAffine</a></div><div class="ttdeci">double thresholdAffine</div><div class="ttdoc">Threshold affine. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00147">tomo_align_tilt_series.h:147</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aae2056cec6ccd16ef57befd5caa6d5fa7"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aae2056cec6ccd16ef57befd5caa6d5fa7">ERR_IO_NOTEXIST</a></div><div class="ttdoc">File or directory does not exist. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00136">xmipp_error.h:136</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a6ea6fcf828dc13a2adf15713ad8a97ec"><div class="ttname"><a href="classProgTomographAlignment.html#a6ea6fcf828dc13a2adf15713ad8a97ec">ProgTomographAlignment::fnSelOrig</a></div><div class="ttdeci">FileName fnSelOrig</div><div class="ttdoc">MetaData File with all images at the original scale. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00083">tomo_align_tilt_series.h:83</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a18dab8ec016cdb49c491d42d2d6b9998"><div class="ttname"><a href="classProgTomographAlignment.html#a18dab8ec016cdb49c491d42d2d6b9998">ProgTomographAlignment::doNotIdentifyOutliers</a></div><div class="ttdeci">bool doNotIdentifyOutliers</div><div class="ttdoc">Do not identify outlier micrographs. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00153">tomo_align_tilt_series.h:153</a></div></div>
<div class="ttc" id="tomo__align__tilt__series_8cpp_html_a92cfb187633eecdc210ef9c5e9c72ba5"><div class="ttname"><a href="tomo__align__tilt__series_8cpp.html#a92cfb187633eecdc210ef9c5e9c72ba5">computeAffineTransformation</a></div><div class="ttdeci">double computeAffineTransformation(const MultidimArray&lt; unsigned char &gt; &amp;I1, const MultidimArray&lt; unsigned char &gt; &amp;I2, int maxShift, int maxIterDE, Matrix2D&lt; double &gt; &amp;A12, Matrix2D&lt; double &gt; &amp;A21, bool show, double thresholdAffine, bool globalAffine, bool isMirror, bool checkRotation, int pyramidLevel)</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l00345">tomo_align_tilt_series.cpp:345</a></div></div>
<div class="ttc" id="classFourierFilter_html_aea0ec5fde630cbab5f98736c34e7e938"><div class="ttname"><a href="classFourierFilter.html#aea0ec5fde630cbab5f98736c34e7e938">FourierFilter::raised_w</a></div><div class="ttdeci">double raised_w</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00131">fourier_filter.h:131</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_aa46841d31bcc5d5eafa7fa36a0675f57"><div class="ttname"><a href="classProgTomographAlignment.html#aa46841d31bcc5d5eafa7fa36a0675f57">ProgTomographAlignment::SForig</a></div><div class="ttdeci">MetaDataVec SForig</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00234">tomo_align_tilt_series.h:234</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a174552865b1ce2cafcdc2f6303eb8704"><div class="ttname"><a href="classProgTomographAlignment.html#a174552865b1ce2cafcdc2f6303eb8704">ProgTomographAlignment::bestPreviousAlignment</a></div><div class="ttdeci">Alignment * bestPreviousAlignment</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00289">tomo_align_tilt_series.h:289</a></div></div>
<div class="ttc" id="classFileName_html_ae42eca3e976e48f40f3e0c3ece19427b"><div class="ttname"><a href="classFileName.html#ae42eca3e976e48f40f3e0c3ece19427b">FileName::exists</a></div><div class="ttdeci">bool exists() const</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8cpp_source.html#l00660">xmipp_filename.cpp:660</a></div></div>
<div class="ttc" id="classMatrix1D_html_a203e2128d65fd2d51dc764f5e7c52a63"><div class="ttname"><a href="classMatrix1D.html#a203e2128d65fd2d51dc764f5e7c52a63">Matrix1D::initZeros</a></div><div class="ttdeci">void initZeros()</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00592">matrix1d.h:592</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a5c3a49bb5d046f0ee574b9f43c19420a"><div class="ttname"><a href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">ProgTomographAlignment::img</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; unsigned char &gt; * &gt; img</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00237">tomo_align_tilt_series.h:237</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a249db0f7eb2c90811b6bdf98ffddb01a"><div class="ttname"><a href="classProgTomographAlignment.html#a249db0f7eb2c90811b6bdf98ffddb01a">ProgTomographAlignment::useCriticalPoints</a></div><div class="ttdeci">bool useCriticalPoints</div><div class="ttdoc">Use critical points. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00095">tomo_align_tilt_series.h:95</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00093">matrix1d.h:93</a></div></div>
<div class="ttc" id="classMetaDataVec_html_a71728ad7664da6eba90ec1dbc787d434"><div class="ttname"><a href="classMetaDataVec.html#a71728ad7664da6eba90ec1dbc787d434">MetaDataVec::getValue</a></div><div class="ttdeci">bool getValue(MDObject &amp;mdValueOut, size_t id) const override</div><div class="ttdef"><b>Definition:</b> <a href="metadata__vec_8cpp_source.html#l00293">metadata_vec.cpp:293</a></div></div>
<div class="ttc" id="namespaceAlignment_html"><div class="ttname"><a href="namespaceAlignment.html">Alignment</a></div><div class="ttdef"><b>Definition:</b> <a href="alignment__estimation_8h_source.html#l00034">alignment_estimation.h:34</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a18e8e8a40a20208e980fb46a85f8dc3d"><div class="ttname"><a href="classProgTomographAlignment.html#a18e8e8a40a20208e980fb46a85f8dc3d">ProgTomographAlignment::affineTransformations</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Matrix2D&lt; double &gt; &gt; &gt; affineTransformations</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00265">tomo_align_tilt_series.h:265</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a9de431b2d85fc5d700dc4f90bb98ec3f"><div class="ttname"><a href="classProgTomographAlignment.html#a9de431b2d85fc5d700dc4f90bb98ec3f">ProgTomographAlignment::localSize</a></div><div class="ttdeci">double localSize</div><div class="ttdoc">Local refinement size. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00126">tomo_align_tilt_series.h:126</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a0adc16d7de22929fc86de9f3ee726d00"><div class="ttname"><a href="classProgTomographAlignment.html#a0adc16d7de22929fc86de9f3ee726d00">ProgTomographAlignment::showRefinement</a></div><div class="ttdeci">bool showRefinement</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00292">tomo_align_tilt_series.h:292</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00063">multidim_array_base.h:63</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_aa924a84ae5fbf0ba6b4052eb9d92ef60"><div class="ttname"><a href="multidim__array__base_8h.html#aa924a84ae5fbf0ba6b4052eb9d92ef60">FOR_ALL_ELEMENTS_IN_ARRAY1D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY1D(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00554">multidim_array_base.h:554</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aa767e074578dbe92f13cff86630eb4774"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aa767e074578dbe92f13cff86630eb4774">ERR_VALUE_NOTSET</a></div><div class="ttdoc">Value has not been set. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00196">xmipp_error.h:196</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classMetaData_html_a55651d0806335c55622838d62b8068b5"><div class="ttname"><a href="classMetaData.html#a55651d0806335c55622838d62b8068b5">MetaData::removeDisabled</a></div><div class="ttdeci">virtual void removeDisabled()</div><div class="ttdef"><b>Definition:</b> <a href="metadata__base_8cpp_source.html#l00123">metadata_base.cpp:123</a></div></div>
<div class="ttc" id="group__Vectors_html_gaf36b657319bb585c75cfa14744dab275"><div class="ttname"><a href="group__Vectors.html#gaf36b657319bb585c75cfa14744dab275">typeCast</a></div><div class="ttdeci">void typeCast(const Matrix1D&lt; T1 &gt; &amp;v1, Matrix1D&lt; T2 &gt; &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l01227">matrix1d.h:1227</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="xmipp__strings_8h_html_afbeda3fd1bdc8c37d01bdf9f5c8274ff"><div class="ttname"><a href="xmipp__strings_8h.html#afbeda3fd1bdc8c37d01bdf9f5c8274ff">String</a></div><div class="ttdeci">std::string String</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__strings_8h_source.html#l00034">xmipp_strings.h:34</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ad2a716317a1ae6cce2b05f4cf402cdc3"><div class="ttname"><a href="classProgTomographAlignment.html#ad2a716317a1ae6cce2b05f4cf402cdc3">ProgTomographAlignment::pyramidLevel</a></div><div class="ttdeci">int pyramidLevel</div><div class="ttdoc">Pyramid. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00156">tomo_align_tilt_series.h:156</a></div></div>
<div class="ttc" id="classFourierFilter_html"><div class="ttname"><a href="classFourierFilter.html">FourierFilter</a></div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8h_source.html#l00069">fourier_filter.h:69</a></div></div>
<div class="ttc" id="group__Filters_html_gaa6c14e5ee97aee4c8c4a0db657d610e0"><div class="ttname"><a href="group__Filters.html#gaa6c14e5ee97aee4c8c4a0db657d610e0">substractBackgroundRollingBall</a></div><div class="ttdeci">void substractBackgroundRollingBall(MultidimArray&lt; double &gt; &amp;I, int radius)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00075">filters.cpp:75</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_afd76d988df1c69f11fafd277735bc7ea"><div class="ttname"><a href="classProgTomographAlignment.html#afd76d988df1c69f11fafd277735bc7ea">ProgTomographAlignment::identifyOutliers</a></div><div class="ttdeci">void identifyOutliers(bool mark)</div><div class="ttdoc">Identify outliers. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l00701">tomo_align_tilt_series.cpp:701</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a0c7337a8112cc8f29c52cf6ff51d3efd"><div class="ttname"><a href="classProgTomographAlignment.html#a0c7337a8112cc8f29c52cf6ff51d3efd">ProgTomographAlignment::writeTransformations</a></div><div class="ttdeci">void writeTransformations(const FileName &amp;fnTransformations) const</div><div class="ttdoc">Write affine transformations. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l02210">tomo_align_tilt_series.cpp:2210</a></div></div>
<div class="ttc" id="classImageBase_html_a88636b7a7bd4e0e454877e691ee2da84"><div class="ttname"><a href="classImageBase.html#a88636b7a7bd4e0e454877e691ee2da84">ImageBase::read</a></div><div class="ttdeci">int read(const FileName &amp;name, DataMode datamode=DATA, size_t select_img=ALL_IMAGES, bool mapData=false, int mode=WRITE_READONLY)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00119">xmipp_image_base.cpp:119</a></div></div>
<div class="ttc" id="classMultidimArray_html_a738eab72b6bd48a98d78745bc24f36bd"><div class="ttname"><a href="classMultidimArray.html#a738eab72b6bd48a98d78745bc24f36bd">MultidimArray::initZeros</a></div><div class="ttdeci">void initZeros(const MultidimArray&lt; T1 &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l02723">multidim_array.h:2723</a></div></div>
<div class="ttc" id="classMultidimArray_html_a773447c28d69eec234eee58a51c30e07"><div class="ttname"><a href="classMultidimArray.html#a773447c28d69eec234eee58a51c30e07">MultidimArray::computeAvg</a></div><div class="ttdeci">double computeAvg() const</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l01739">multidim_array.h:1739</a></div></div>
<div class="ttc" id="classMetaDataVec_html_a8aaa63269cf2564662ae806609493315"><div class="ttname"><a href="classMetaDataVec.html#a8aaa63269cf2564662ae806609493315">MetaDataVec::containsLabel</a></div><div class="ttdeci">bool containsLabel(const MDLabel label) const override</div><div class="ttdef"><b>Definition:</b> <a href="metadata__vec_8cpp_source.html#l00397">metadata_vec.cpp:397</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ae0df630253ea3e7accf03dd2c0acb0a7"><div class="ttname"><a href="classProgTomographAlignment.html#ae0df630253ea3e7accf03dd2c0acb0a7">ProgTomographAlignment::showAffine</a></div><div class="ttdeci">bool showAffine</div><div class="ttdoc">Show affine transformations. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00144">tomo_align_tilt_series.h:144</a></div></div>
<div class="ttc" id="classFourierFilter_html_ac7a39b3eafb64b11aa089c4f03bd5714"><div class="ttname"><a href="classFourierFilter.html#ac7a39b3eafb64b11aa089c4f03bd5714">FourierFilter::generateMask</a></div><div class="ttdeci">void generateMask(MultidimArray&lt; double &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8cpp_source.html#l00605">fourier_filter.cpp:605</a></div></div>
<div class="ttc" id="classMatrix1D_html_a64e7d0a8fd1ed74d99b9607e832587b5"><div class="ttname"><a href="classMatrix1D.html#a64e7d0a8fd1ed74d99b9607e832587b5">Matrix1D::initConstant</a></div><div class="ttdeci">void initConstant(T val)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8cpp_source.html#l00083">matrix1d.cpp:83</a></div></div>
<div class="ttc" id="group__Filters_html_ga11b22ba5fdb8431cb8c534ae4a91d554"><div class="ttname"><a href="group__Filters.html#ga11b22ba5fdb8431cb8c534ae4a91d554">substractBackgroundPlane</a></div><div class="ttdeci">void substractBackgroundPlane(MultidimArray&lt; double &gt; &amp;I)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00040">filters.cpp:40</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
<div class="ttc" id="group__MetaData_html_gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70"><div class="ttname"><a href="group__MetaData.html#gga7a6f95c8cfb46e6dfb2689b5cabd3f78af4298cfa617e6143f021d0d7956a7f70">MDL_IMAGE</a></div><div class="ttdoc">Name of an image (std::string) </div><div class="ttdef"><b>Definition:</b> <a href="metadata__label_8h_source.html#l00246">metadata_label.h:246</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a27a3b5258d86502df1c4e24388c25314"><div class="ttname"><a href="classProgTomographAlignment.html#a27a3b5258d86502df1c4e24388c25314">ProgTomographAlignment::correlationList</a></div><div class="ttdeci">std::vector&lt; double &gt; correlationList</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00268">tomo_align_tilt_series.h:268</a></div></div>
<div class="ttc" id="classFourierFilter_html_a628762260d6099753fa4b55adc4cfbb0"><div class="ttname"><a href="classFourierFilter.html#a628762260d6099753fa4b55adc4cfbb0">FourierFilter::applyMaskSpace</a></div><div class="ttdeci">void applyMaskSpace(MultidimArray&lt; double &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="fourier__filter_8cpp_source.html#l00710">fourier_filter.cpp:710</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1d145dc60698a6cc03446b620c307a2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d145dc60698a6cc03446b620c307a2b">&#9670;&nbsp;</a></span>readLandmarkSet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgTomographAlignment::readLandmarkSet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFileName.html">FileName</a> &amp;&#160;</td>
          <td class="paramname"><em>fnLandmark</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read landmark set. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8cpp_source.html#l02170">2170</a> of file <a class="el" href="tomo__align__tilt__series_8cpp_source.html">tomo_align_tilt_series.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;{</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    std::ifstream fhIn;</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    fhIn.open(fnLandmark.c_str());</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    <span class="keywordflow">if</span> (!fhIn)</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aae2056cec6ccd16ef57befd5caa6d5fa7">ERR_IO_NOTEXIST</a>,(std::string)<span class="stringliteral">&quot;Cannot open &quot;</span>+fnLandmark+<span class="stringliteral">&quot; for input&quot;</span>);</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    std::string dummyStr;</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    <span class="keywordtype">int</span> Nlandmark;</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    fhIn &gt;&gt; dummyStr &gt;&gt; dummyStr &gt;&gt; dummyStr &gt;&gt; dummyStr &gt;&gt; dummyStr</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    &gt;&gt; Nlandmark &gt;&gt; <a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>;</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    <span class="keywordflow">if</span> (Nlandmark&lt;=0)</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a>,(std::string)<span class="stringliteral">&quot;No landmarks are found in &quot;</span>+fnLandmark);</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>.<a class="code" href="classMatrix2D.html#aeedb221b3c316a93de2826d56302bf98">resize</a>(Nlandmark,Nimg);</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a8dcbb879ecd56dd2db6839b9b53fae9f">allLandmarksY</a>.<a class="code" href="classMatrix2D.html#aeedb221b3c316a93de2826d56302bf98">resize</a>(Nlandmark,Nimg);</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>.<a class="code" href="classMatrix2D.html#af0ca60bcef90508025e5164abb39c4b6">initConstant</a>(<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0]));</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a8dcbb879ecd56dd2db6839b9b53fae9f">allLandmarksY</a>.<a class="code" href="classMatrix2D.html#af0ca60bcef90508025e5164abb39c4b6">initConstant</a>(<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0]));</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    fhIn.exceptions ( std::ifstream::eofbit |</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;                      std::ifstream::failbit |</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;                      std::ifstream::badbit );</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    <span class="keywordflow">while</span> (!fhIn.eof())</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    {</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;        <span class="keywordflow">try</span></div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;        {</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;            <span class="keywordtype">int</span> dummyInt, <a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>, <a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>, <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;            fhIn &gt;&gt; dummyInt &gt;&gt; x &gt;&gt; y &gt;&gt; i &gt;&gt; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>;</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;            i=i-1;</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;            <a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>(j,i)=x+<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0]);</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;            <a class="code" href="classProgTomographAlignment.html#a8dcbb879ecd56dd2db6839b9b53fae9f">allLandmarksY</a>(j,i)=y+<a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0]);</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;        }</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;        <span class="keywordflow">catch</span> (std::ifstream::failure e)</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;        {</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;            <span class="comment">// Do nothing with this line</span></div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;        }</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    }</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    fhIn.close();</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;The file &quot;</span> &lt;&lt; fnLandmark &lt;&lt; <span class="stringliteral">&quot; has been read for the landmarks\n&quot;</span></div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    &lt;&lt; Nlandmark &lt;&lt; <span class="stringliteral">&quot; landmarks are read\n&quot;</span>;</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;}</div><div class="ttc" id="classProgTomographAlignment_html_a8dcbb879ecd56dd2db6839b9b53fae9f"><div class="ttname"><a href="classProgTomographAlignment.html#a8dcbb879ecd56dd2db6839b9b53fae9f">ProgTomographAlignment::allLandmarksY</a></div><div class="ttdeci">Matrix2D&lt; double &gt; allLandmarksY</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00274">tomo_align_tilt_series.h:274</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00211">xmipp_error.h:211</a></div></div>
<div class="ttc" id="classMatrix2D_html_af0ca60bcef90508025e5164abb39c4b6"><div class="ttname"><a href="classMatrix2D.html#af0ca60bcef90508025e5164abb39c4b6">Matrix2D::initConstant</a></div><div class="ttdeci">void initConstant(T val)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00602">matrix2d.h:602</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad919bbce6f061400a0bc5231a9cd1621"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a></div><div class="ttdeci">static double * y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08507">numerical_recipes.cpp:8507</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a2127199afbebe9268549e5348b29b95f"><div class="ttname"><a href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">ProgTomographAlignment::allLandmarksX</a></div><div class="ttdeci">Matrix2D&lt; double &gt; allLandmarksX</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00271">tomo_align_tilt_series.h:271</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a3fa403d828d133eab75d26778795f1db"><div class="ttname"><a href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">ProgTomographAlignment::Nimg</a></div><div class="ttdeci">int Nimg</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00261">tomo_align_tilt_series.h:261</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02248">numerical_recipes.cpp:2248</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00059">multidim_array_base.h:59</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00091">multidim_array_base.h:91</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aae2056cec6ccd16ef57befd5caa6d5fa7"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aae2056cec6ccd16ef57befd5caa6d5fa7">ERR_IO_NOTEXIST</a></div><div class="ttdoc">File or directory does not exist. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00136">xmipp_error.h:136</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a5c3a49bb5d046f0ee574b9f43c19420a"><div class="ttname"><a href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">ProgTomographAlignment::img</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; unsigned char &gt; * &gt; img</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00237">tomo_align_tilt_series.h:237</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aad02217f52cd3ac70b89edec020dd25c0">ERR_VALUE_INCORRECT</a></div><div class="ttdoc">Incorrect value received. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00195">xmipp_error.h:195</a></div></div>
<div class="ttc" id="classMatrix2D_html_aeedb221b3c316a93de2826d56302bf98"><div class="ttname"><a href="classMatrix2D.html#aeedb221b3c316a93de2826d56302bf98">Matrix2D::resize</a></div><div class="ttdeci">void resize(size_t Ydim, size_t Xdim, bool noCopy=false)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8cpp_source.html#l01022">matrix2d.cpp:1022</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af9064764db12c587c6d3020a669b84f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9064764db12c587c6d3020a669b84f8">&#9670;&nbsp;</a></span>readParams()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProgTomographAlignment::readParams </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read parameters from argument line. </p>

<p>Reimplemented from <a class="el" href="classXmippProgram.html#a4f3c0b1ec483442cf6a2cba6666baa18">XmippProgram</a>.</p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8cpp_source.html#l00452">452</a> of file <a class="el" href="tomo__align__tilt__series_8cpp_source.html">tomo_align_tilt_series.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;{</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a5eded8363249e66bb494068a35883aa6">fnSel</a>=<a class="code" href="classXmippProgram.html#a5d9e1f008822effa47814c59e9a3c797">getParam</a>(<span class="stringliteral">&quot;-i&quot;</span>);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a6ea6fcf828dc13a2adf15713ad8a97ec">fnSelOrig</a>=<a class="code" href="classXmippProgram.html#a5d9e1f008822effa47814c59e9a3c797">getParam</a>(<span class="stringliteral">&quot;--iorig&quot;</span>);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">fnRoot</a>=<a class="code" href="classXmippProgram.html#a5d9e1f008822effa47814c59e9a3c797">getParam</a>(<span class="stringliteral">&quot;--oroot&quot;</span>);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">fnRoot</a>==<span class="stringliteral">&quot;&quot;</span>)</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">fnRoot</a>=<a class="code" href="classProgTomographAlignment.html#a5eded8363249e66bb494068a35883aa6">fnSel</a>.<a class="code" href="classFileName.html#afcb22703889d34110e9bb3e05f54821f">withoutExtension</a>();</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a9042cbb5b5fad3b5cbe697af4dca2d67">globalAffine</a>=<a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--globalAffine&quot;</span>);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a249db0f7eb2c90811b6bdf98ffddb01a">useCriticalPoints</a>=<a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--useCriticalPoints&quot;</span>);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a249db0f7eb2c90811b6bdf98ffddb01a">useCriticalPoints</a>)</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a8b020a7a943ef31422f663a72b51fe38">Ncritical</a>=<a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--useCriticalPoints&quot;</span>);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a8b020a7a943ef31422f663a72b51fe38">Ncritical</a>=0;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <a class="code" href="classProgTomographAlignment.html#af96123b461a6fad645f8ab5d94beca33">seqLength</a>=<a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--seqLength&quot;</span>);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a2ac192f1c46aeaea16bfba08b077d32d">blindSeqLength</a>=<a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--blindSeqLength&quot;</span>);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="classProgTomographAlignment.html#ad379fbdd7b6f963a3aea0b4ce20ae4ff">maxStep</a>=<a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--maxStep&quot;</span>);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a92bc30971016ac4aff7557c8ac3ed495">gridSamples</a>=<a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--gridSamples&quot;</span>);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <a class="code" href="classProgTomographAlignment.html#ae7ced1919ef7005cf9631ac7892761f6">psiMax</a>=<a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--psiMax&quot;</span>);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <a class="code" href="classProgTomographAlignment.html#ab363adf03b92571baa6876e558fbc6ea">deltaRot</a>=<a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--deltaRot&quot;</span>);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a9de431b2d85fc5d700dc4f90bb98ec3f">localSize</a>=<a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--localSize&quot;</span>);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a8cf474c5f20f85f60b769760cb8178d2">optimizeTiltAngle</a>=<a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--optimizeTiltAngle&quot;</span>);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a4905373a0acc63d50b75f609ea8bce57">isCapillar</a>=<a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--isCapillar&quot;</span>);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a73502d61548fbce44458b99d8d978990">dontNormalize</a>=<a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--dontNormalize&quot;</span>);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <a class="code" href="classProgTomographAlignment.html#aa610621f5be969da18b79e8ca9aaa5bf">difficult</a>=<a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--difficult&quot;</span>);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a2799e370b08d2c12c862e644af6a4748">corrThreshold</a>=<a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--threshold&quot;</span>);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a6a2e598c712e94b90d9a99e413d7e120">maxShiftPercentage</a>=<a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--maxShiftPercentage&quot;</span>);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <a class="code" href="classProgTomographAlignment.html#abd71803ad9478f7b779e58472ec415ad">maxIterDE</a>=<a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--maxIterDE&quot;</span>);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <a class="code" href="classProgTomographAlignment.html#ae0df630253ea3e7accf03dd2c0acb0a7">showAffine</a>=<a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--showAffine&quot;</span>);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a8f45ff4b5de10a2ee5ed0b54b1700fd5">thresholdAffine</a>=<a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--thresholdAffine&quot;</span>);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a549ad45a1e9e26f2b983a209de5db173">identifyOutliersZ</a> = <a class="code" href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">getDoubleParam</a>(<span class="stringliteral">&quot;--identifyOutliers&quot;</span>);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a18dab8ec016cdb49c491d42d2d6b9998">doNotIdentifyOutliers</a> = <a class="code" href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">checkParam</a>(<span class="stringliteral">&quot;--noOutliers&quot;</span>);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="classProgTomographAlignment.html#ad2a716317a1ae6cce2b05f4cf402cdc3">pyramidLevel</a> = <a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--pyramid&quot;</span>);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="classProgTomographAlignment.html#ae50cf00b4c254719af15a62f39f7816d">numThreads</a> = <a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--thr&quot;</span>);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#ae50cf00b4c254719af15a62f39f7816d">numThreads</a>&lt;1)</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <a class="code" href="classProgTomographAlignment.html#ae50cf00b4c254719af15a62f39f7816d">numThreads</a> = 1;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a483ebbe46f0bce2a09681223aef10739">lastStep</a>=<a class="code" href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">getIntParam</a>(<span class="stringliteral">&quot;--lastStep&quot;</span>);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;}</div><div class="ttc" id="classProgTomographAlignment_html_a9042cbb5b5fad3b5cbe697af4dca2d67"><div class="ttname"><a href="classProgTomographAlignment.html#a9042cbb5b5fad3b5cbe697af4dca2d67">ProgTomographAlignment::globalAffine</a></div><div class="ttdeci">bool globalAffine</div><div class="ttdoc">Look for local affine transformation. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00092">tomo_align_tilt_series.h:92</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a6a2e598c712e94b90d9a99e413d7e120"><div class="ttname"><a href="classProgTomographAlignment.html#a6a2e598c712e94b90d9a99e413d7e120">ProgTomographAlignment::maxShiftPercentage</a></div><div class="ttdeci">double maxShiftPercentage</div><div class="ttdoc">Maxshift percentage. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00111">tomo_align_tilt_series.h:111</a></div></div>
<div class="ttc" id="classXmippProgram_html_a552e1ea4a84576d9149b965d9edb6277"><div class="ttname"><a href="classXmippProgram.html#a552e1ea4a84576d9149b965d9edb6277">XmippProgram::getDoubleParam</a></div><div class="ttdeci">double getDoubleParam(const char *param, int arg=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00341">xmipp_program.cpp:341</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ab363adf03b92571baa6876e558fbc6ea"><div class="ttname"><a href="classProgTomographAlignment.html#ab363adf03b92571baa6876e558fbc6ea">ProgTomographAlignment::deltaRot</a></div><div class="ttdeci">double deltaRot</div><div class="ttdoc">Delta rot. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00123">tomo_align_tilt_series.h:123</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_af96123b461a6fad645f8ab5d94beca33"><div class="ttname"><a href="classProgTomographAlignment.html#af96123b461a6fad645f8ab5d94beca33">ProgTomographAlignment::seqLength</a></div><div class="ttdeci">size_t seqLength</div><div class="ttdoc">Sequence Length. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00101">tomo_align_tilt_series.h:101</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a2799e370b08d2c12c862e644af6a4748"><div class="ttname"><a href="classProgTomographAlignment.html#a2799e370b08d2c12c862e644af6a4748">ProgTomographAlignment::corrThreshold</a></div><div class="ttdeci">double corrThreshold</div><div class="ttdoc">Correlation threshold for a good landmark. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00141">tomo_align_tilt_series.h:141</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a5eded8363249e66bb494068a35883aa6"><div class="ttname"><a href="classProgTomographAlignment.html#a5eded8363249e66bb494068a35883aa6">ProgTomographAlignment::fnSel</a></div><div class="ttdeci">FileName fnSel</div><div class="ttdoc">MetaData File with all images. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00080">tomo_align_tilt_series.h:80</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_abd71803ad9478f7b779e58472ec415ad"><div class="ttname"><a href="classProgTomographAlignment.html#abd71803ad9478f7b779e58472ec415ad">ProgTomographAlignment::maxIterDE</a></div><div class="ttdeci">int maxIterDE</div><div class="ttdoc">Maximum number of iterations in Differential Evolution. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00114">tomo_align_tilt_series.h:114</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_aa610621f5be969da18b79e8ca9aaa5bf"><div class="ttname"><a href="classProgTomographAlignment.html#aa610621f5be969da18b79e8ca9aaa5bf">ProgTomographAlignment::difficult</a></div><div class="ttdeci">bool difficult</div><div class="ttdoc">Difficult. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00138">tomo_align_tilt_series.h:138</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ad379fbdd7b6f963a3aea0b4ce20ae4ff"><div class="ttname"><a href="classProgTomographAlignment.html#ad379fbdd7b6f963a3aea0b4ce20ae4ff">ProgTomographAlignment::maxStep</a></div><div class="ttdeci">int maxStep</div><div class="ttdoc">Maximum Step for chain refinement. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00120">tomo_align_tilt_series.h:120</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a238e1f42e2d7aeb892518355058ac6b1"><div class="ttname"><a href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">ProgTomographAlignment::fnRoot</a></div><div class="ttdeci">FileName fnRoot</div><div class="ttdoc">Output root. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00086">tomo_align_tilt_series.h:86</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a8b020a7a943ef31422f663a72b51fe38"><div class="ttname"><a href="classProgTomographAlignment.html#a8b020a7a943ef31422f663a72b51fe38">ProgTomographAlignment::Ncritical</a></div><div class="ttdeci">size_t Ncritical</div><div class="ttdoc">Number of critical points. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00098">tomo_align_tilt_series.h:98</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a92bc30971016ac4aff7557c8ac3ed495"><div class="ttname"><a href="classProgTomographAlignment.html#a92bc30971016ac4aff7557c8ac3ed495">ProgTomographAlignment::gridSamples</a></div><div class="ttdeci">int gridSamples</div><div class="ttdoc">Grid samples. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00108">tomo_align_tilt_series.h:108</a></div></div>
<div class="ttc" id="classXmippProgram_html_a5d9e1f008822effa47814c59e9a3c797"><div class="ttname"><a href="classXmippProgram.html#a5d9e1f008822effa47814c59e9a3c797">XmippProgram::getParam</a></div><div class="ttdeci">const char * getParam(const char *param, int arg=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00321">xmipp_program.cpp:321</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a483ebbe46f0bce2a09681223aef10739"><div class="ttname"><a href="classProgTomographAlignment.html#a483ebbe46f0bce2a09681223aef10739">ProgTomographAlignment::lastStep</a></div><div class="ttdeci">int lastStep</div><div class="ttdoc">Last step to run (-1=run them all) </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00159">tomo_align_tilt_series.h:159</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ae50cf00b4c254719af15a62f39f7816d"><div class="ttname"><a href="classProgTomographAlignment.html#ae50cf00b4c254719af15a62f39f7816d">ProgTomographAlignment::numThreads</a></div><div class="ttdeci">int numThreads</div><div class="ttdoc">Number of threads to use for parallel computing. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00089">tomo_align_tilt_series.h:89</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a8f45ff4b5de10a2ee5ed0b54b1700fd5"><div class="ttname"><a href="classProgTomographAlignment.html#a8f45ff4b5de10a2ee5ed0b54b1700fd5">ProgTomographAlignment::thresholdAffine</a></div><div class="ttdeci">double thresholdAffine</div><div class="ttdoc">Threshold affine. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00147">tomo_align_tilt_series.h:147</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a6ea6fcf828dc13a2adf15713ad8a97ec"><div class="ttname"><a href="classProgTomographAlignment.html#a6ea6fcf828dc13a2adf15713ad8a97ec">ProgTomographAlignment::fnSelOrig</a></div><div class="ttdeci">FileName fnSelOrig</div><div class="ttdoc">MetaData File with all images at the original scale. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00083">tomo_align_tilt_series.h:83</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a18dab8ec016cdb49c491d42d2d6b9998"><div class="ttname"><a href="classProgTomographAlignment.html#a18dab8ec016cdb49c491d42d2d6b9998">ProgTomographAlignment::doNotIdentifyOutliers</a></div><div class="ttdeci">bool doNotIdentifyOutliers</div><div class="ttdoc">Do not identify outlier micrographs. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00153">tomo_align_tilt_series.h:153</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a2ac192f1c46aeaea16bfba08b077d32d"><div class="ttname"><a href="classProgTomographAlignment.html#a2ac192f1c46aeaea16bfba08b077d32d">ProgTomographAlignment::blindSeqLength</a></div><div class="ttdeci">size_t blindSeqLength</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00105">tomo_align_tilt_series.h:105</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a549ad45a1e9e26f2b983a209de5db173"><div class="ttname"><a href="classProgTomographAlignment.html#a549ad45a1e9e26f2b983a209de5db173">ProgTomographAlignment::identifyOutliersZ</a></div><div class="ttdeci">double identifyOutliersZ</div><div class="ttdoc">Identify outlier micrographs. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00150">tomo_align_tilt_series.h:150</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a249db0f7eb2c90811b6bdf98ffddb01a"><div class="ttname"><a href="classProgTomographAlignment.html#a249db0f7eb2c90811b6bdf98ffddb01a">ProgTomographAlignment::useCriticalPoints</a></div><div class="ttdeci">bool useCriticalPoints</div><div class="ttdoc">Use critical points. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00095">tomo_align_tilt_series.h:95</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a9de431b2d85fc5d700dc4f90bb98ec3f"><div class="ttname"><a href="classProgTomographAlignment.html#a9de431b2d85fc5d700dc4f90bb98ec3f">ProgTomographAlignment::localSize</a></div><div class="ttdeci">double localSize</div><div class="ttdoc">Local refinement size. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00126">tomo_align_tilt_series.h:126</a></div></div>
<div class="ttc" id="classFileName_html_afcb22703889d34110e9bb3e05f54821f"><div class="ttname"><a href="classFileName.html#afcb22703889d34110e9bb3e05f54821f">FileName::withoutExtension</a></div><div class="ttdeci">FileName withoutExtension() const</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__filename_8cpp_source.html#l00345">xmipp_filename.cpp:345</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ad2a716317a1ae6cce2b05f4cf402cdc3"><div class="ttname"><a href="classProgTomographAlignment.html#ad2a716317a1ae6cce2b05f4cf402cdc3">ProgTomographAlignment::pyramidLevel</a></div><div class="ttdeci">int pyramidLevel</div><div class="ttdoc">Pyramid. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00156">tomo_align_tilt_series.h:156</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a4905373a0acc63d50b75f609ea8bce57"><div class="ttname"><a href="classProgTomographAlignment.html#a4905373a0acc63d50b75f609ea8bce57">ProgTomographAlignment::isCapillar</a></div><div class="ttdeci">bool isCapillar</div><div class="ttdoc">This tilt series comes from a capillar. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00132">tomo_align_tilt_series.h:132</a></div></div>
<div class="ttc" id="classXmippProgram_html_a1a27c450de95c55d122be23e3fe89ac1"><div class="ttname"><a href="classXmippProgram.html#a1a27c450de95c55d122be23e3fe89ac1">XmippProgram::checkParam</a></div><div class="ttdeci">bool checkParam(const char *param)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00379">xmipp_program.cpp:379</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ae7ced1919ef7005cf9631ac7892761f6"><div class="ttname"><a href="classProgTomographAlignment.html#ae7ced1919ef7005cf9631ac7892761f6">ProgTomographAlignment::psiMax</a></div><div class="ttdeci">double psiMax</div><div class="ttdoc">Maximum rotation. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00117">tomo_align_tilt_series.h:117</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a8cf474c5f20f85f60b769760cb8178d2"><div class="ttname"><a href="classProgTomographAlignment.html#a8cf474c5f20f85f60b769760cb8178d2">ProgTomographAlignment::optimizeTiltAngle</a></div><div class="ttdeci">bool optimizeTiltAngle</div><div class="ttdoc">Optimize tilt angle of tilt axis. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00129">tomo_align_tilt_series.h:129</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ae0df630253ea3e7accf03dd2c0acb0a7"><div class="ttname"><a href="classProgTomographAlignment.html#ae0df630253ea3e7accf03dd2c0acb0a7">ProgTomographAlignment::showAffine</a></div><div class="ttdeci">bool showAffine</div><div class="ttdoc">Show affine transformations. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00144">tomo_align_tilt_series.h:144</a></div></div>
<div class="ttc" id="classXmippProgram_html_a7b7ddf0836dc1079ea2622e2a420c39c"><div class="ttname"><a href="classXmippProgram.html#a7b7ddf0836dc1079ea2622e2a420c39c">XmippProgram::getIntParam</a></div><div class="ttdeci">int getIntParam(const char *param, int arg=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__program_8cpp_source.html#l00331">xmipp_program.cpp:331</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a73502d61548fbce44458b99d8d978990"><div class="ttname"><a href="classProgTomographAlignment.html#a73502d61548fbce44458b99d8d978990">ProgTomographAlignment::dontNormalize</a></div><div class="ttdeci">bool dontNormalize</div><div class="ttdoc">Don&amp;#39;t normalize the corrected images. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00135">tomo_align_tilt_series.h:135</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a968c833c064d84da0631ae87c338276f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a968c833c064d84da0631ae87c338276f">&#9670;&nbsp;</a></span>refineChain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgTomographAlignment::refineChain </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__AngularAssignTiltSeries.html#ga2227270b50623022cd6d9079e54299fb">LandmarkChain</a> &amp;&#160;</td>
          <td class="paramname"><em>chain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>corrChain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Refine chain. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8cpp_source.html#l01997">1997</a> of file <a class="el" href="tomo__align__tilt__series_8cpp_source.html">tomo_align_tilt_series.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;{</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Chain for refinement: &quot;</span>;</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;chain.size(); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;        std::cout &lt;&lt; chain[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].imgIdx &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="libraries_2data_2integration_8cpp.html#a77a9b787be0b9b24ab6b55aade3eeeaf">K</a>=0; <a class="code" href="libraries_2data_2integration_8cpp.html#a77a9b787be0b9b24ab6b55aade3eeeaf">K</a>&lt;2 &amp;&amp; (chain.size()&gt;<a class="code" href="classProgTomographAlignment.html#af96123b461a6fad645f8ab5d94beca33">seqLength</a> || <a class="code" href="classProgTomographAlignment.html#a249db0f7eb2c90811b6bdf98ffddb01a">useCriticalPoints</a>); <a class="code" href="libraries_2data_2integration_8cpp.html#a77a9b787be0b9b24ab6b55aade3eeeaf">K</a>++)</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    {</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;        <a class="code" href="sorting_8cpp.html#acffaa2cf1dee75a78d918a708a5fb87a">sort</a>(chain.begin(), chain.end());</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> rii(2), rjj(2), newrjj(2);</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a249db0f7eb2c90811b6bdf98ffddb01a">useCriticalPoints</a>)</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;        {</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;            <span class="comment">// compute average piece</span></div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;            <span class="keywordtype">int</span> halfSize=<a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="classProgTomographAlignment.html#a9de431b2d85fc5d700dc4f90bb98ec3f">localSize</a>*<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0]))/2,5);</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;            <span class="keywordtype">int</span> chainLength=chain.size();</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;            <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> avgPiece(2*halfSize+1,2*halfSize+1), pieceAux;</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;            avgPiece.<a class="code" href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">setXmippOrigin</a>();</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;            pieceAux=avgPiece;</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>=0; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>&lt;chainLength; <a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>++)</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;            {</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;                <span class="keywordtype">int</span> ii=chain[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>].imgIdx;</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;                <a class="code" href="group__Vectors.html#gaf35071e3863333ef9ff847bb85615bb4">VECTOR_R2</a>(rii,chain[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>].<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>,chain[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>].<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>);</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rii)-halfSize&lt;<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[ii])  ||</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;                    <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rii)+halfSize&gt;<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[ii]) ||</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;                    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rii)-halfSize&lt;<a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[ii])  ||</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;                    <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rii)+halfSize&gt;<a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[ii]))</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;                {</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;                    corrChain=0;</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;                }</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;                <a class="code" href="multidim__array__base_8h.html#a7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(avgPiece)</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;                pieceAux(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)=(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[ii])((<span class="keywordtype">int</span>)(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rii)+<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>),(<span class="keywordtype">int</span>)(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rii)+<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a4905373a0acc63d50b75f609ea8bce57">isCapillar</a> &amp;&amp; <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(chain[<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>].imgIdx-chain[0].imgIdx)&gt;<a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>/2)</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;                    pieceAux.<a class="code" href="classMultidimArray.html#adf722e075c6fa2aa1d0429b1ee16e326">selfReverseY</a>();</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;                avgPiece+=pieceAux;</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;            }</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;            avgPiece/=chainLength;</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;            <a class="code" href="classImage.html">Image&lt;double&gt;</a> save;</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;            save()=avgPiece;</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;            save.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;PPPavg.xmp&quot;</span>);</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Average &quot;</span> &lt;&lt; <a class="code" href="libraries_2data_2integration_8cpp.html#a77a9b787be0b9b24ab6b55aade3eeeaf">K</a> &lt;&lt; <span class="stringliteral">&quot; -------------------  \n&quot;</span>;</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;            <a class="code" href="classProgTomographAlignment.html#a0adc16d7de22929fc86de9f3ee726d00">showRefinement</a>=<span class="keyword">true</span>;</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;            <span class="comment">// Align all images with respect to this average</span></div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;            corrChain=2;</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;chainLength; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;            {</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;                <span class="keywordtype">int</span> jj=chain[<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>].imgIdx;</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                <a class="code" href="group__Vectors.html#gaf35071e3863333ef9ff847bb85615bb4">VECTOR_R2</a>(rjj,chain[<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>].<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>,chain[<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>].<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>);</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;                <span class="keywordtype">double</span> corr;</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;                <span class="keywordtype">bool</span> accepted=<a class="code" href="classProgTomographAlignment.html#ad5fecb6b28507271d09ffaa4e1992002">refineLandmark</a>(avgPiece,jj,rjj,0,<span class="keyword">false</span>,corr);</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;                <span class="keywordflow">if</span> (accepted)</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;                {</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;                    chain[<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>].x=<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rjj);</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;                    chain[<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>].y=<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rjj);</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;                    corrChain=<a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(corrChain,corr);</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                }</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;            }</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;            <a class="code" href="classProgTomographAlignment.html#a0adc16d7de22929fc86de9f3ee726d00">showRefinement</a>=<span class="keyword">false</span>;</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;        }</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;        {</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;            <span class="comment">// Refine every step</span></div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> step=2; step&lt;=<a class="code" href="classProgTomographAlignment.html#ad379fbdd7b6f963a3aea0b4ce20ae4ff">maxStep</a>; step++)</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;            {</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;                <span class="keywordtype">int</span> chainLength=chain.size();</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;                <span class="comment">// Refine forwards every step</span></div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;                <span class="keywordtype">int</span> ileft=-1;</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;chainLength-step; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                {</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                    <span class="keywordtype">int</span> ii=chain[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].imgIdx;</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;                    <a class="code" href="group__Vectors.html#gaf35071e3863333ef9ff847bb85615bb4">VECTOR_R2</a>(rii,chain[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>,chain[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>);</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;                    <span class="keywordtype">int</span> jj=chain[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+step].imgIdx;</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;                    <a class="code" href="group__Vectors.html#gaf35071e3863333ef9ff847bb85615bb4">VECTOR_R2</a>(rjj,chain[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+step].<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>,chain[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+step].<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>);</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;                    newrjj=rjj;</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;                    <span class="keywordtype">double</span> corr;</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;                    <span class="keywordtype">bool</span> accepted=<a class="code" href="classProgTomographAlignment.html#ad5fecb6b28507271d09ffaa4e1992002">refineLandmark</a>(ii,jj,rii,newrjj,corr,<span class="keyword">false</span>);</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;                    <span class="keywordflow">if</span> (((newrjj-rjj).module()&lt;4 &amp;&amp; accepted) || <a class="code" href="classProgTomographAlignment.html#a249db0f7eb2c90811b6bdf98ffddb01a">useCriticalPoints</a>)</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;                    {</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;                        chain[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+step].x=<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(newrjj);</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;                        chain[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+step].y=<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(newrjj);</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                    }</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;                        ileft=<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                }</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                <span class="comment">// COSS showRefinement=(step==maxStep);</span></div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                <span class="comment">// Refine backwards all images</span></div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                <span class="keywordtype">int</span> iright=chainLength;</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                corrChain=2;</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=chainLength-1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&gt;=1; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>--)</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;                {</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;                    <span class="keywordtype">int</span> ii=chain[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].imgIdx;</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                    <a class="code" href="group__Vectors.html#gaf35071e3863333ef9ff847bb85615bb4">VECTOR_R2</a>(rii,chain[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>,chain[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>);</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                    <span class="keywordtype">int</span> jj=chain[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-1].imgIdx;</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;                    <a class="code" href="group__Vectors.html#gaf35071e3863333ef9ff847bb85615bb4">VECTOR_R2</a>(rjj,chain[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-1].<a class="code" href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a>,chain[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-1].<a class="code" href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a>);</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;                    newrjj=rjj;</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;                    <span class="keywordtype">double</span> corr;</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                    <span class="keywordtype">bool</span> accepted=<a class="code" href="classProgTomographAlignment.html#ad5fecb6b28507271d09ffaa4e1992002">refineLandmark</a>(ii,jj,rii,newrjj,corr,<span class="keyword">false</span>);</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;                    corrChain=<a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(corrChain,corr);</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;                    <span class="keywordflow">if</span> (((newrjj-rjj).module()&lt;4 &amp;&amp; accepted) || <a class="code" href="classProgTomographAlignment.html#a249db0f7eb2c90811b6bdf98ffddb01a">useCriticalPoints</a>)</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;                    {</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;                        chain[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-1].x=<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(newrjj);</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;                        chain[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-1].y=<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(newrjj);</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;                    }</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;                        iright=<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;                }</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;                <span class="comment">// COSS: showRefinement=false;</span></div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;                <a class="code" href="group__AngularAssignTiltSeries.html#ga2227270b50623022cd6d9079e54299fb">LandmarkChain</a> refinedChain;</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll=ileft+1; ll&lt;=iright-1; ll++)</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;                    refinedChain.push_back(chain[ll]);</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;                chain=refinedChain;</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;                <span class="keywordtype">double</span> tilt0=<a class="code" href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">tiltList</a>[chain[0].imgIdx];</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;                <span class="keywordtype">double</span> tiltF=<a class="code" href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">tiltList</a>[chain[chain.size()-1].imgIdx];</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;                <span class="keywordtype">double</span> lengthThreshold=<a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(3.,<a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>(<a class="code" href="classProgTomographAlignment.html#af96123b461a6fad645f8ab5d94beca33">seqLength</a>*cos(<a class="code" href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a>(0.5*(tilt0+tiltF)))));</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;                <span class="keywordflow">if</span> (chain.size()&lt;lengthThreshold &amp;&amp; !<a class="code" href="classProgTomographAlignment.html#a249db0f7eb2c90811b6bdf98ffddb01a">useCriticalPoints</a>)</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;            }</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;        }</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    }</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    <span class="comment">// Check that the chain is of the desired length</span></div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    <span class="keywordtype">double</span> tilt0=<a class="code" href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">tiltList</a>[chain[0].imgIdx];</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    <span class="keywordtype">double</span> tiltF=<a class="code" href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">tiltList</a>[chain[chain.size()-1].imgIdx];</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    <span class="keywordtype">double</span> lengthThreshold=<a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(3,<a class="code" href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a>(<a class="code" href="classProgTomographAlignment.html#af96123b461a6fad645f8ab5d94beca33">seqLength</a>*cos(<a class="code" href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a>(0.5*(tilt0+tiltF)))));</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    <span class="keywordflow">return</span> chain.size()&gt;lengthThreshold;</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;}</div><div class="ttc" id="group__Vectors_html_gaf35071e3863333ef9ff847bb85615bb4"><div class="ttname"><a href="group__Vectors.html#gaf35071e3863333ef9ff847bb85615bb4">VECTOR_R2</a></div><div class="ttdeci">#define VECTOR_R2(v, x, y)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00112">matrix1d.h:112</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ad5fecb6b28507271d09ffaa4e1992002"><div class="ttname"><a href="classProgTomographAlignment.html#ad5fecb6b28507271d09ffaa4e1992002">ProgTomographAlignment::refineLandmark</a></div><div class="ttdeci">bool refineLandmark(int ii, int jj, const Matrix1D&lt; double &gt; &amp;rii, Matrix1D&lt; double &gt; &amp;rjj, double &amp;maxCorr, bool tryFourier) const</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l01735">tomo_align_tilt_series.cpp:1735</a></div></div>
<div class="ttc" id="group__Macros_html_gae0a4180e923e3ffca3989e20e441aa3c"><div class="ttname"><a href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a></div><div class="ttdeci">#define XMIPP_MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00193">xmipp_macros.h:193</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a98fedcd4fef7c8e1504eb3b1d4cc86d0"><div class="ttname"><a href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">ProgTomographAlignment::tiltList</a></div><div class="ttdeci">std::vector&lt; double &gt; tiltList</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00246">tomo_align_tilt_series.h:246</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_af96123b461a6fad645f8ab5d94beca33"><div class="ttname"><a href="classProgTomographAlignment.html#af96123b461a6fad645f8ab5d94beca33">ProgTomographAlignment::seqLength</a></div><div class="ttdeci">size_t seqLength</div><div class="ttdoc">Sequence Length. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00101">tomo_align_tilt_series.h:101</a></div></div>
<div class="ttc" id="group__Macros_html_gadec1e6bbd34c5cf8765a457da4876c91"><div class="ttname"><a href="group__Macros.html#gadec1e6bbd34c5cf8765a457da4876c91">DEG2RAD</a></div><div class="ttdeci">#define DEG2RAD(d)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00312">xmipp_macros.h:312</a></div></div>
<div class="ttc" id="classMultidimArray_html_adf722e075c6fa2aa1d0429b1ee16e326"><div class="ttname"><a href="classMultidimArray.html#adf722e075c6fa2aa1d0429b1ee16e326">MultidimArray::selfReverseY</a></div><div class="ttdeci">void selfReverseY()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03531">multidim_array.h:3531</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ad919bbce6f061400a0bc5231a9cd1621"><div class="ttname"><a href="numerical__recipes_8cpp.html#ad919bbce6f061400a0bc5231a9cd1621">y</a></div><div class="ttdeci">static double * y</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l08507">numerical_recipes.cpp:8507</a></div></div>
<div class="ttc" id="classImageBase_html_ae81a8c11a832924c2bda0909882c3168"><div class="ttname"><a href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">ImageBase::write</a></div><div class="ttdeci">void write(const FileName &amp;name=&quot;&quot;, size_t select_img=ALL_IMAGES, bool isStack=false, int mode=WRITE_OVERWRITE, CastWriteMode castMode=CW_CAST, int _swapWrite=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00292">xmipp_image_base.cpp:292</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ad379fbdd7b6f963a3aea0b4ce20ae4ff"><div class="ttname"><a href="classProgTomographAlignment.html#ad379fbdd7b6f963a3aea0b4ce20ae4ff">ProgTomographAlignment::maxStep</a></div><div class="ttdeci">int maxStep</div><div class="ttdoc">Maximum Step for chain refinement. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00120">tomo_align_tilt_series.h:120</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a3fa403d828d133eab75d26778795f1db"><div class="ttname"><a href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">ProgTomographAlignment::Nimg</a></div><div class="ttdeci">int Nimg</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00261">tomo_align_tilt_series.h:261</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ab81d9253b246f09be9999505d515d517"><div class="ttname"><a href="numerical__recipes_8cpp.html#ab81d9253b246f09be9999505d515d517">x</a></div><div class="ttdeci">doublereal * x</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02248">numerical_recipes.cpp:2248</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="multidim__array__base_8h.html#a7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00390">multidim_array_base.h:390</a></div></div>
<div class="ttc" id="classMultidimArrayBase_html_a0d4d898ee3a033a6f050cbdc3806b8fb"><div class="ttname"><a href="classMultidimArrayBase.html#a0d4d898ee3a033a6f050cbdc3806b8fb">MultidimArrayBase::setXmippOrigin</a></div><div class="ttdeci">void setXmippOrigin()</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8cpp_source.html#l00200">multidim_array_base.cpp:200</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00059">multidim_array_base.h:59</a></div></div>
<div class="ttc" id="group__Macros_html_ga2f0eecb0f7856721f56faff8f27b0dc1"><div class="ttname"><a href="group__Macros.html#ga2f0eecb0f7856721f56faff8f27b0dc1">FLOOR</a></div><div class="ttdeci">#define FLOOR(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00240">xmipp_macros.h:240</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00085">matrix1d.h:85</a></div></div>
<div class="ttc" id="group__AngularAssignTiltSeries_html_ga2227270b50623022cd6d9079e54299fb"><div class="ttname"><a href="group__AngularAssignTiltSeries.html#ga2227270b50623022cd6d9079e54299fb">LandmarkChain</a></div><div class="ttdeci">std::vector&lt; Landmark &gt; LandmarkChain</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00070">tomo_align_tilt_series.h:70</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00091">multidim_array_base.h:91</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="sorting_8cpp_html_acffaa2cf1dee75a78d918a708a5fb87a"><div class="ttname"><a href="sorting_8cpp.html#acffaa2cf1dee75a78d918a708a5fb87a">sort</a></div><div class="ttdeci">void sort(struct DCEL_T *dcel)</div><div class="ttdef"><b>Definition:</b> <a href="sorting_8cpp_source.html#l00018">sorting.cpp:18</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a5c3a49bb5d046f0ee574b9f43c19420a"><div class="ttname"><a href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">ProgTomographAlignment::img</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; unsigned char &gt; * &gt; img</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00237">tomo_align_tilt_series.h:237</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a249db0f7eb2c90811b6bdf98ffddb01a"><div class="ttname"><a href="classProgTomographAlignment.html#a249db0f7eb2c90811b6bdf98ffddb01a">ProgTomographAlignment::useCriticalPoints</a></div><div class="ttdeci">bool useCriticalPoints</div><div class="ttdoc">Use critical points. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00095">tomo_align_tilt_series.h:95</a></div></div>
<div class="ttc" id="group__Macros_html_gac9ae6a207f10c821b06a8c0df153a7d5"><div class="ttname"><a href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a></div><div class="ttdeci">#define XMIPP_MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00181">xmipp_macros.h:181</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00093">matrix1d.h:93</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a9de431b2d85fc5d700dc4f90bb98ec3f"><div class="ttname"><a href="classProgTomographAlignment.html#a9de431b2d85fc5d700dc4f90bb98ec3f">ProgTomographAlignment::localSize</a></div><div class="ttdeci">double localSize</div><div class="ttdoc">Local refinement size. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00126">tomo_align_tilt_series.h:126</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a0adc16d7de22929fc86de9f3ee726d00"><div class="ttname"><a href="classProgTomographAlignment.html#a0adc16d7de22929fc86de9f3ee726d00">ProgTomographAlignment::showRefinement</a></div><div class="ttdeci">bool showRefinement</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00292">tomo_align_tilt_series.h:292</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00063">multidim_array_base.h:63</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a4905373a0acc63d50b75f609ea8bce57"><div class="ttname"><a href="classProgTomographAlignment.html#a4905373a0acc63d50b75f609ea8bce57">ProgTomographAlignment::isCapillar</a></div><div class="ttdeci">bool isCapillar</div><div class="ttdoc">This tilt series comes from a capillar. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00132">tomo_align_tilt_series.h:132</a></div></div>
<div class="ttc" id="libraries_2data_2integration_8cpp_html_a77a9b787be0b9b24ab6b55aade3eeeaf"><div class="ttname"><a href="libraries_2data_2integration_8cpp.html#a77a9b787be0b9b24ab6b55aade3eeeaf">K</a></div><div class="ttdeci">constexpr int K</div><div class="ttdef"><b>Definition:</b> <a href="libraries_2data_2integration_8cpp_source.html#l00123">integration.cpp:123</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad5fecb6b28507271d09ffaa4e1992002"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5fecb6b28507271d09ffaa4e1992002">&#9670;&nbsp;</a></span>refineLandmark() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgTomographAlignment::refineLandmark </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ii</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>jj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>rii</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>rjj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>maxCorr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>tryFourier</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Refine landmark. ii is the index of the original image, jj is the index in the image at which the landmark is being refined. rii and rjj are the corresponding landmark positions in both images.</p>
<p>The function returns whether the landmark is accepted or not. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8cpp_source.html#l01735">1735</a> of file <a class="el" href="tomo__align__tilt__series_8cpp_source.html">tomo_align_tilt_series.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;{</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    maxCorr=-1;</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <span class="keywordtype">int</span> halfSize=<a class="code" href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a>(<a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="classProgTomographAlignment.html#a9de431b2d85fc5d700dc4f90bb98ec3f">localSize</a>*<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[ii]))/2,5);</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rii)-halfSize&lt;<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[ii])  ||</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rii)+halfSize&gt;<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[ii]) ||</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rii)-halfSize&lt;<a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[ii])  ||</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rii)+halfSize&gt;<a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[ii]) ||</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rjj)-halfSize&lt;<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[jj])  ||</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rjj)+halfSize&gt;<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[jj]) ||</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rjj)-halfSize&lt;<a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[jj])  ||</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rjj)+halfSize&gt;<a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[jj]))</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <span class="comment">// Check if the two pieces are reversed</span></div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="keywordtype">bool</span> reversed=<a class="code" href="classProgTomographAlignment.html#a4905373a0acc63d50b75f609ea8bce57">isCapillar</a> &amp;&amp; <a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(ii-jj)&gt;<a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>/2;</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <span class="comment">// Select piece in image ii, compute its statistics and normalize</span></div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> pieceii(2*halfSize+1,2*halfSize+1);</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    pieceii.setXmippOrigin();</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    <span class="keyword">const</span> <a class="code" href="classMultidimArray.html">MultidimArray&lt;unsigned char&gt;</a> &amp;Iii=(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[ii]);</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(pieceii)</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(pieceii,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)=<a class="code" href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Iii,</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                                   (<span class="keywordtype">int</span>)(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rii)+<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>),(<span class="keywordtype">int</span>)(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rii)+<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a0adc16d7de22929fc86de9f3ee726d00">showRefinement</a>)</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    {</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;        <a class="code" href="classImage.html">Image&lt;double&gt;</a> save;</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;        save()=pieceii;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;        save.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;PPPpieceii.xmp&quot;</span>);</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;ii=&quot;</span> &lt;&lt; ii &lt;&lt; <span class="stringliteral">&quot; jj=&quot;</span> &lt;&lt; jj &lt;&lt; std::endl;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;rii=&quot;</span> &lt;&lt; rii.<a class="code" href="classMatrix1D.html#a028505ebdeaf6f62d884c31dcd5127a8">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    }</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="comment">// Choose threshold</span></div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    <span class="keywordtype">double</span> actualCorrThreshold=<a class="code" href="classProgTomographAlignment.html#a2799e370b08d2c12c862e644af6a4748">corrThreshold</a>;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    <span class="keywordflow">if</span> (actualCorrThreshold&lt;0 &amp;&amp; <a class="code" href="group__Vectors.html#gad6524c4e36da91aae3fb6f8564112364">VEC_XSIZE</a>(<a class="code" href="classProgTomographAlignment.html#a2db3efcc5622e698680ea350a4d7393a">avgForwardPatchCorr</a>)&gt;0)</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    {</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;        <span class="keywordflow">if</span> (ii&lt;jj)</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;            actualCorrThreshold=<a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(<a class="code" href="classProgTomographAlignment.html#a2db3efcc5622e698680ea350a4d7393a">avgForwardPatchCorr</a>(ii),</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                                          <a class="code" href="classProgTomographAlignment.html#ade84fe045db3ff2f59bb680e2ad7c852">avgBackwardPatchCorr</a>(jj));</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;            actualCorrThreshold=<a class="code" href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a>(<a class="code" href="classProgTomographAlignment.html#ade84fe045db3ff2f59bb680e2ad7c852">avgBackwardPatchCorr</a>(ii),</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                                          <a class="code" href="classProgTomographAlignment.html#a2db3efcc5622e698680ea350a4d7393a">avgForwardPatchCorr</a>(jj));</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    }</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a0adc16d7de22929fc86de9f3ee726d00">showRefinement</a>)</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;actualCorrThreshold=&quot;</span> &lt;&lt; actualCorrThreshold &lt;&lt; std::endl;</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <span class="comment">// Try Fourier</span></div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    <span class="keywordflow">if</span> (tryFourier)</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    {</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;        <span class="keyword">const</span> <a class="code" href="classMultidimArray.html">MultidimArray&lt;unsigned char&gt;</a> &amp;Ijj=(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[jj]);</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rjj)-halfSize&gt;=<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(Ijj) &amp;&amp;</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;            <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rjj)+halfSize&lt;=<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(Ijj) &amp;&amp;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;            <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rjj)-halfSize&gt;=<a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(Ijj) &amp;&amp;</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;            <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rjj)+halfSize&lt;=<a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(Ijj))</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;        {</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;            <span class="comment">// Take the piece at jj</span></div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;            <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> piecejj(2*halfSize+1,2*halfSize+1);</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;            piecejj.setXmippOrigin();</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(piecejj)</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(piecejj,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)=<a class="code" href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Ijj,</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                                           (<span class="keywordtype">int</span>)(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rjj)+<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>),(<span class="keywordtype">int</span>)(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rjj)+<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;            <span class="comment">// Compute its correlation with pieceii</span></div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;            <span class="keywordtype">double</span> corrOriginal=<a class="code" href="group__MultidimensionalArrays.html#ga63cca7e01116967ff451df8b1f8b5a4e">correlationIndex</a>(pieceii,piecejj);</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a0adc16d7de22929fc86de9f3ee726d00">showRefinement</a>)</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;            {</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                <a class="code" href="classImage.html">Image&lt;double&gt;</a> save;</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;                save()=piecejj;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                save.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;PPPpiecejjOriginal.xmp&quot;</span>);</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;Corr original=&quot;</span> &lt;&lt; corrOriginal &lt;&lt; std::endl;</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;            }</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;            <span class="comment">// Now try with the best shift</span></div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;            <span class="keywordtype">double</span> shiftX,shiftY;</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;            <a class="code" href="classCorrelationAux.html">CorrelationAux</a> aux;</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;            <a class="code" href="group__Filters.html#ga5aae1ce90626f1f1401defcb6f5d6411">bestNonwrappingShift</a>(pieceii,piecejj,shiftX,shiftY,aux);</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;            <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> fftShift(2);</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;            <a class="code" href="group__Vectors.html#gaf35071e3863333ef9ff847bb85615bb4">VECTOR_R2</a>(fftShift,shiftX,shiftY);</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;            <a class="code" href="group__GeometricalTransformations.html#ga5751842c11a31f5d7ce95a1f8ccbe67d">selfTranslate</a>(<a class="code" href="namespacexmipp__transformation.html#ac5f2bd2937d73c34ed4f6c6c5ff2492aaffcd115cf9fbf6a51a8b2862062acc74">xmipp_transformation::LINEAR</a>,piecejj,fftShift,xmipp_transformation::WRAP);</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;            <span class="keywordtype">double</span> corrFFT=<a class="code" href="group__MultidimensionalArrays.html#ga63cca7e01116967ff451df8b1f8b5a4e">correlationIndex</a>(pieceii,piecejj);</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;            <span class="keywordflow">if</span> (corrFFT&gt;corrOriginal)</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;            {</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;                <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rjj)-=shiftX;</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rjj)-=shiftY;</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;            }</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a0adc16d7de22929fc86de9f3ee726d00">showRefinement</a>)</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;            {</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;                <a class="code" href="classImage.html">Image&lt;double&gt;</a> save;</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                save()=piecejj;</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                save.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;PPPpiecejjFFT.xmp&quot;</span>);</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;FFT shift=&quot;</span> &lt;&lt; fftShift.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;Corr FFT=&quot;</span> &lt;&lt; corrFFT &lt;&lt; std::endl;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                <span class="keywordflow">if</span> (corrFFT&gt;corrOriginal)</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                {</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rjj)-halfSize&gt;=<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(Ijj) &amp;&amp;</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;                        <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rjj)+halfSize&lt;=<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(Ijj) &amp;&amp;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rjj)-halfSize&gt;=<a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(Ijj) &amp;&amp;</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                        <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rjj)+halfSize&lt;=<a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(Ijj))</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                    {</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                        <a class="code" href="multidim__array__base_8h.html#a7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(piecejj)</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                        <a class="code" href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(piecejj,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)=<a class="code" href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Ijj,</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                                                       (<span class="keywordtype">int</span>)(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rjj)+<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>),(<span class="keywordtype">int</span>)(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rjj)+<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                        save()=piecejj;</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                        save.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;PPPpiecejjNew.xmp&quot;</span>);</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                    }</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                }</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;            }</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;        }</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    }</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="keywordtype">bool</span> retval=<a class="code" href="classProgTomographAlignment.html#ad5fecb6b28507271d09ffaa4e1992002">refineLandmark</a>(pieceii,jj,rjj,actualCorrThreshold,</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;                               reversed,maxCorr);</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="keywordflow">return</span> retval;</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;}</div><div class="ttc" id="group__Vectors_html_gaf35071e3863333ef9ff847bb85615bb4"><div class="ttname"><a href="group__Vectors.html#gaf35071e3863333ef9ff847bb85615bb4">VECTOR_R2</a></div><div class="ttdeci">#define VECTOR_R2(v, x, y)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00112">matrix1d.h:112</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ad5fecb6b28507271d09ffaa4e1992002"><div class="ttname"><a href="classProgTomographAlignment.html#ad5fecb6b28507271d09ffaa4e1992002">ProgTomographAlignment::refineLandmark</a></div><div class="ttdeci">bool refineLandmark(int ii, int jj, const Matrix1D&lt; double &gt; &amp;rii, Matrix1D&lt; double &gt; &amp;rjj, double &amp;maxCorr, bool tryFourier) const</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l01735">tomo_align_tilt_series.cpp:1735</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00354">multidim_array_base.h:354</a></div></div>
<div class="ttc" id="group__Macros_html_gae0a4180e923e3ffca3989e20e441aa3c"><div class="ttname"><a href="group__Macros.html#gae0a4180e923e3ffca3989e20e441aa3c">XMIPP_MAX</a></div><div class="ttdeci">#define XMIPP_MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00193">xmipp_macros.h:193</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="group__Vectors_html_gad6524c4e36da91aae3fb6f8564112364"><div class="ttname"><a href="group__Vectors.html#gad6524c4e36da91aae3fb6f8564112364">VEC_XSIZE</a></div><div class="ttdeci">#define VEC_XSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00077">matrix1d.h:77</a></div></div>
<div class="ttc" id="namespacexmipp__transformation_html_ac5f2bd2937d73c34ed4f6c6c5ff2492aaffcd115cf9fbf6a51a8b2862062acc74"><div class="ttname"><a href="namespacexmipp__transformation.html#ac5f2bd2937d73c34ed4f6c6c5ff2492aaffcd115cf9fbf6a51a8b2862062acc74">xmipp_transformation::LINEAR</a></div><div class="ttdef"><b>Definition:</b> <a href="transformations__defines_8h_source.html#l00032">transformations_defines.h:32</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a2799e370b08d2c12c862e644af6a4748"><div class="ttname"><a href="classProgTomographAlignment.html#a2799e370b08d2c12c862e644af6a4748">ProgTomographAlignment::corrThreshold</a></div><div class="ttdeci">double corrThreshold</div><div class="ttdoc">Correlation threshold for a good landmark. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00141">tomo_align_tilt_series.h:141</a></div></div>
<div class="ttc" id="classImageBase_html_ae81a8c11a832924c2bda0909882c3168"><div class="ttname"><a href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">ImageBase::write</a></div><div class="ttdeci">void write(const FileName &amp;name=&quot;&quot;, size_t select_img=ALL_IMAGES, bool isStack=false, int mode=WRITE_OVERWRITE, CastWriteMode castMode=CW_CAST, int _swapWrite=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00292">xmipp_image_base.cpp:292</a></div></div>
<div class="ttc" id="group__MultidimensionalArrays_html_ga63cca7e01116967ff451df8b1f8b5a4e"><div class="ttname"><a href="group__MultidimensionalArrays.html#ga63cca7e01116967ff451df8b1f8b5a4e">correlationIndex</a></div><div class="ttdeci">double correlationIndex(const MultidimArray&lt; T &gt; &amp;x, const MultidimArray&lt; T &gt; &amp;y, const MultidimArray&lt; int &gt; *mask=NULL, MultidimArray&lt; double &gt; *Contributions=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array_8h_source.html#l03974">multidim_array.h:3974</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a3fa403d828d133eab75d26778795f1db"><div class="ttname"><a href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">ProgTomographAlignment::Nimg</a></div><div class="ttdeci">int Nimg</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00261">tomo_align_tilt_series.h:261</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="group__Filters_html_ga5aae1ce90626f1f1401defcb6f5d6411"><div class="ttname"><a href="group__Filters.html#ga5aae1ce90626f1f1401defcb6f5d6411">bestNonwrappingShift</a></div><div class="ttdeci">void bestNonwrappingShift(const MultidimArray&lt; double &gt; &amp;I1, const MultidimArray&lt; double &gt; &amp;I2, double &amp;shiftX, double &amp;shiftY, CorrelationAux &amp;aux)</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l01895">filters.cpp:1895</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="multidim__array__base_8h.html#a7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00390">multidim_array_base.h:390</a></div></div>
<div class="ttc" id="classMatrix1D_html_a028505ebdeaf6f62d884c31dcd5127a8"><div class="ttname"><a href="classMatrix1D.html#a028505ebdeaf6f62d884c31dcd5127a8">Matrix1D::transpose</a></div><div class="ttdeci">Matrix1D&lt; T &gt; transpose() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8cpp_source.html#l00631">matrix1d.cpp:631</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00059">multidim_array_base.h:59</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a2db3efcc5622e698680ea350a4d7393a"><div class="ttname"><a href="classProgTomographAlignment.html#a2db3efcc5622e698680ea350a4d7393a">ProgTomographAlignment::avgForwardPatchCorr</a></div><div class="ttdeci">Matrix1D&lt; double &gt; avgForwardPatchCorr</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00252">tomo_align_tilt_series.h:252</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00085">matrix1d.h:85</a></div></div>
<div class="ttc" id="group__GeometricalTransformations_html_ga5751842c11a31f5d7ce95a1f8ccbe67d"><div class="ttname"><a href="group__GeometricalTransformations.html#ga5751842c11a31f5d7ce95a1f8ccbe67d">selfTranslate</a></div><div class="ttdeci">void selfTranslate(int SplineDegree, MultidimArray&lt; T &gt; &amp;V1, const Matrix1D&lt; double &gt; &amp;v, bool wrap=xmipp_transformation::WRAP, T outside=0)</div><div class="ttdef"><b>Definition:</b> <a href="transformations_8h_source.html#l01394">transformations.h:1394</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ade84fe045db3ff2f59bb680e2ad7c852"><div class="ttname"><a href="classProgTomographAlignment.html#ade84fe045db3ff2f59bb680e2ad7c852">ProgTomographAlignment::avgBackwardPatchCorr</a></div><div class="ttdeci">Matrix1D&lt; double &gt; avgBackwardPatchCorr</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00255">tomo_align_tilt_series.h:255</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00091">multidim_array_base.h:91</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="classCorrelationAux_html"><div class="ttname"><a href="classCorrelationAux.html">CorrelationAux</a></div><div class="ttdef"><b>Definition:</b> <a href="xmipp__fftw_8h_source.html#l00551">xmipp_fftw.h:551</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a5c3a49bb5d046f0ee574b9f43c19420a"><div class="ttname"><a href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">ProgTomographAlignment::img</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; unsigned char &gt; * &gt; img</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00237">tomo_align_tilt_series.h:237</a></div></div>
<div class="ttc" id="group__Macros_html_gac9ae6a207f10c821b06a8c0df153a7d5"><div class="ttname"><a href="group__Macros.html#gac9ae6a207f10c821b06a8c0df153a7d5">XMIPP_MIN</a></div><div class="ttdeci">#define XMIPP_MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00181">xmipp_macros.h:181</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00093">matrix1d.h:93</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a9de431b2d85fc5d700dc4f90bb98ec3f"><div class="ttname"><a href="classProgTomographAlignment.html#a9de431b2d85fc5d700dc4f90bb98ec3f">ProgTomographAlignment::localSize</a></div><div class="ttdeci">double localSize</div><div class="ttdoc">Local refinement size. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00126">tomo_align_tilt_series.h:126</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a0adc16d7de22929fc86de9f3ee726d00"><div class="ttname"><a href="classProgTomographAlignment.html#a0adc16d7de22929fc86de9f3ee726d00">ProgTomographAlignment::showRefinement</a></div><div class="ttdeci">bool showRefinement</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00292">tomo_align_tilt_series.h:292</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00063">multidim_array_base.h:63</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a4905373a0acc63d50b75f609ea8bce57"><div class="ttname"><a href="classProgTomographAlignment.html#a4905373a0acc63d50b75f609ea8bce57">ProgTomographAlignment::isCapillar</a></div><div class="ttdeci">bool isCapillar</div><div class="ttdoc">This tilt series comes from a capillar. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00132">tomo_align_tilt_series.h:132</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a387b25aadbee74d9e836e6ceeb77d4f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a387b25aadbee74d9e836e6ceeb77d4f6">&#9670;&nbsp;</a></span>refineLandmark() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgTomographAlignment::refineLandmark </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>pieceii</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>jj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>rjj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>actualCorrThreshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>reversed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>maxCorr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Refine landmark. The same as the previous function but an image is provided as pattern (ii) instead of an index and a position. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8cpp_source.html#l01854">1854</a> of file <a class="el" href="tomo__align__tilt__series_8cpp_source.html">tomo_align_tilt_series.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;{</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="keywordtype">int</span> halfSize=<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(pieceii)/2;</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    <span class="keywordtype">double</span> mean_ii=0, stddev_ii=0;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <a class="code" href="multidim__array__base_8h.html#a7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(pieceii)</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    {</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        mean_ii+=<a class="code" href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(pieceii,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        stddev_ii+=<a class="code" href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(pieceii,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)*<a class="code" href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(pieceii,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>);</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    }</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    mean_ii/=<a class="code" href="multidim__array__base_8h.html#a027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(pieceii);</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    stddev_ii = stddev_ii / <a class="code" href="multidim__array__base_8h.html#a027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(pieceii) - mean_ii * mean_ii;</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    stddev_ii *= <a class="code" href="multidim__array__base_8h.html#a027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(pieceii) / (<a class="code" href="multidim__array__base_8h.html#a027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(pieceii) - 1);</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    stddev_ii = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(static_cast&lt;double&gt;((<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(stddev_ii))));</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    <span class="keywordflow">if</span> (stddev_ii&gt;<a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>)</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;        <a class="code" href="multidim__array__base_8h.html#ad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(pieceii)</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;        <a class="code" href="multidim__array__base_8h.html#a4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(pieceii,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)=</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;            (<a class="code" href="multidim__array__base_8h.html#a4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(pieceii,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)-mean_ii)/stddev_ii;</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    <span class="comment">// Try all possible shifts</span></div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> corr((<span class="keywordtype">int</span>)(1.5*(2*halfSize+1)),(<span class="keywordtype">int</span>)(1.5*(2*halfSize+1)));</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    corr.setXmippOrigin();</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    corr.initConstant(-1.1);</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    <span class="keywordtype">bool</span> accept=<span class="keyword">false</span>;</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    <span class="keywordtype">double</span> maxval=-1;</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    <a class="code" href="classMultidimArray.html">MultidimArray&lt;double&gt;</a> piecejj(2*halfSize+1,2*halfSize+1);</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    piecejj.setXmippOrigin();</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    <span class="keywordflow">if</span> (stddev_ii&gt;<a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>)</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    {</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;        <span class="keywordtype">int</span> imax=0, jmax=0;</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        std::queue&lt; Matrix1D&lt;double&gt; &gt; Q;</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        Q.push(<a class="code" href="group__Vectors.html#ga97ccb86b4c568b2271da21552034d504">vectorR2</a>(0,0));</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;        <span class="keywordflow">while</span> (!Q.empty())</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;        {</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;            <span class="comment">// Get the first position to evaluate</span></div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;            <span class="keyword">auto</span> shifty=(int)<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(Q.front());</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;            <span class="keyword">auto</span> shiftx=(int)<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(Q.front());</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;            Q.pop();</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;            <span class="keywordflow">if</span> (!corr(shifty,shiftx)&lt;-1)</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;            <span class="comment">// Select piece in image jj, compute its statistics and normalize</span></div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;            <span class="keywordtype">double</span> mean_jj=0, stddev_jj=0;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;            <span class="keyword">const</span> <a class="code" href="classMultidimArray.html">MultidimArray&lt;unsigned char&gt;</a> &amp;Ijj=(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[jj]);</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rjj)+shiftx+<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(piecejj)&lt;<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(Ijj) ||</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;                <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rjj)+shifty+<a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(piecejj)&lt;<a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(Ijj) ||</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;                <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rjj)+shiftx+<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(piecejj)&gt;<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(Ijj) ||</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;                <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rjj)+shifty+<a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(piecejj)&gt;<a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(Ijj))</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(piecejj)</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;            {</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;                <span class="keywordtype">double</span> pixval=<a class="code" href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(Ijj,</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;                                       (<span class="keywordtype">int</span>)(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rjj)+shifty+<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>),</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;                                       (<span class="keywordtype">int</span>)(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rjj)+shiftx+<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;                <a class="code" href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a>(piecejj,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)=pixval;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;                mean_jj+=pixval;</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;                stddev_jj+=pixval*pixval;</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;            }</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;            mean_jj/=<a class="code" href="multidim__array__base_8h.html#a027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(piecejj);</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;            stddev_jj = stddev_jj / <a class="code" href="multidim__array__base_8h.html#a027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(piecejj) - mean_jj * mean_jj;</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;            stddev_jj *= <a class="code" href="multidim__array__base_8h.html#a027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(piecejj) / (<a class="code" href="multidim__array__base_8h.html#a027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(piecejj) - 1);</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;            stddev_jj = <a class="code" href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a>(static_cast&lt;double&gt;((<a class="code" href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(stddev_jj))));</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;            <span class="keywordflow">if</span> (reversed)</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;                piecejj.selfReverseY();</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;            <span class="comment">// Compute the correlation</span></div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;            corr(shifty,shiftx)=0;</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;            <span class="keywordtype">double</span> &amp;corrRef=corr(shifty,shiftx);</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;            <span class="keywordflow">if</span> (stddev_jj&gt;<a class="code" href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a>)</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;            {</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;                <span class="keywordtype">double</span> istddev_jj=1.0/stddev_jj;</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                <a class="code" href="multidim__array__base_8h.html#ad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a>(piecejj)</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;                corrRef+=</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;                    <a class="code" href="multidim__array__base_8h.html#a4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(pieceii,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)*</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;                    (<a class="code" href="multidim__array__base_8h.html#a4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a>(piecejj,<a class="code" href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)-mean_jj)*istddev_jj;</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;                corrRef/=<a class="code" href="multidim__array__base_8h.html#a027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a>(piecejj);</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;            }</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;            <span class="keywordflow">if</span> (corrRef&gt;maxval)</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;            {</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;                maxval=corrRef;</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                imax=shifty;</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;                jmax=shiftx;</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> step=1; step&lt;=5; step+=2)</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> stepy=-1; stepy&lt;=1; stepy++)</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> stepx=-1; stepx&lt;=1; stepx++)</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;                        {</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;                            <span class="keywordtype">int</span> newshifty=shifty+stepy*step;</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;                            <span class="keywordtype">int</span> newshiftx=shiftx+stepx*step;</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;                            <span class="keywordflow">if</span> (newshifty&gt;=<a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(corr) &amp;&amp;</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;                                newshifty&lt;=<a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(corr) &amp;&amp;</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;                                newshiftx&gt;=<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(corr) &amp;&amp;</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                                newshiftx&lt;=<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(corr) &amp;&amp;</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;                                (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rjj)+newshiftx-halfSize)&gt;=<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(Ijj) &amp;&amp;</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;                                (<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rjj)+newshiftx+halfSize)&lt;=<a class="code" href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a>(Ijj) &amp;&amp;</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;                                (<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rjj)+newshifty-halfSize)&gt;=<a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(Ijj) &amp;&amp;</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;                                (<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rjj)+newshifty+halfSize)&lt;=<a class="code" href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a>(Ijj))</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;                                <span class="keywordflow">if</span> (corr(newshifty,newshiftx)&lt;-1)</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;                                    Q.push(<a class="code" href="group__Vectors.html#ga97ccb86b4c568b2271da21552034d504">vectorR2</a>(newshiftx,newshifty));</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;                        }</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;            }</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;        }</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;        <span class="keywordflow">if</span> (maxval&gt;actualCorrThreshold)</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;        {</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;            <a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rjj)+=jmax;</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;            <span class="keywordflow">if</span> (reversed)</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;                <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rjj)-=imax;</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;                <a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rjj)+=imax;</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;            accept=<span class="keyword">true</span>;</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;        }</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a0adc16d7de22929fc86de9f3ee726d00">showRefinement</a>)</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        {</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;            <a class="code" href="classImage.html">Image&lt;double&gt;</a> save;</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;            <a class="code" href="multidim__array__base_8h.html#a7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a>(piecejj)</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;            piecejj(<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)=(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[jj])((<span class="keywordtype">int</span>)(<a class="code" href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a>(rjj)+<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>),(<span class="keywordtype">int</span>)(<a class="code" href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a>(rjj)+<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>));</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;            <span class="keywordflow">if</span> (reversed)</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;                piecejj.selfReverseY();</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;            save()=piecejj;</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;            save.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;PPPpiecejj.xmp&quot;</span>);</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;            save()=corr;</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;            save.<a class="code" href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">write</a>(<span class="stringliteral">&quot;PPPcorr.xmp&quot;</span>);</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;jj=&quot;</span> &lt;&lt; jj &lt;&lt; <span class="stringliteral">&quot; rjj=&quot;</span> &lt;&lt; rjj.<a class="code" href="classMatrix1D.html#a028505ebdeaf6f62d884c31dcd5127a8">transpose</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;imax=&quot;</span> &lt;&lt; imax &lt;&lt; <span class="stringliteral">&quot; jmax=&quot;</span> &lt;&lt; jmax &lt;&lt; std::endl;</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;maxval=&quot;</span> &lt;&lt; maxval &lt;&lt; std::endl;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        }</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    }</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a0adc16d7de22929fc86de9f3ee726d00">showRefinement</a>)</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    {</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Accepted=&quot;</span> &lt;&lt; accept &lt;&lt; std::endl;</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Press any key\n&quot;</span>;</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;        <span class="keywordtype">char</span> <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        std::cin &gt;&gt; <a class="code" href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    }</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    maxCorr=maxval;</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    <span class="keywordflow">return</span> accept;</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;}</div><div class="ttc" id="multidim__array__base_8h_html_a9cf9c3a95f2270982504fd5e40133864"><div class="ttname"><a href="multidim__array__base_8h.html#a9cf9c3a95f2270982504fd5e40133864">A2D_ELEM</a></div><div class="ttdeci">#define A2D_ELEM(v, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00354">multidim_array_base.h:354</a></div></div>
<div class="ttc" id="classMultidimArray_html"><div class="ttname"><a href="classMultidimArray.html">MultidimArray&lt; double &gt;</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a494f0325c3fd49f368cad0e45e6a386a"><div class="ttname"><a href="multidim__array__base_8h.html#a494f0325c3fd49f368cad0e45e6a386a">FINISHINGX</a></div><div class="ttdeci">#define FINISHINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00055">multidim_array_base.h:55</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="numerical__recipes_8cpp.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">doublereal * c</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02248">numerical_recipes.cpp:2248</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a027a630a86c277b71cda769268764fd1"><div class="ttname"><a href="multidim__array__base_8h.html#a027a630a86c277b71cda769268764fd1">MULTIDIM_SIZE</a></div><div class="ttdeci">#define MULTIDIM_SIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00115">multidim_array_base.h:115</a></div></div>
<div class="ttc" id="image__operate_8cpp_html_aba02a4405b44e10470c7af98477800a9"><div class="ttname"><a href="image__operate_8cpp.html#aba02a4405b44e10470c7af98477800a9">sqrt</a></div><div class="ttdeci">void sqrt(Image&lt; double &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="image__operate_8cpp_source.html#l00210">image_operate.cpp:210</a></div></div>
<div class="ttc" id="classImageBase_html_ae81a8c11a832924c2bda0909882c3168"><div class="ttname"><a href="classImageBase.html#ae81a8c11a832924c2bda0909882c3168">ImageBase::write</a></div><div class="ttdeci">void write(const FileName &amp;name=&quot;&quot;, size_t select_img=ALL_IMAGES, bool isStack=false, int mode=WRITE_OVERWRITE, CastWriteMode castMode=CW_CAST, int _swapWrite=0)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__image__base_8cpp_source.html#l00292">xmipp_image_base.cpp:292</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a7fa7d580ab43d192c7933abd008bc756"><div class="ttname"><a href="multidim__array__base_8h.html#a7fa7d580ab43d192c7933abd008bc756">FOR_ALL_ELEMENTS_IN_ARRAY2D</a></div><div class="ttdeci">#define FOR_ALL_ELEMENTS_IN_ARRAY2D(m)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00390">multidim_array_base.h:390</a></div></div>
<div class="ttc" id="classMatrix1D_html_a028505ebdeaf6f62d884c31dcd5127a8"><div class="ttname"><a href="classMatrix1D.html#a028505ebdeaf6f62d884c31dcd5127a8">Matrix1D::transpose</a></div><div class="ttdeci">Matrix1D&lt; T &gt; transpose() const</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8cpp_source.html#l00631">matrix1d.cpp:631</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00059">multidim_array_base.h:59</a></div></div>
<div class="ttc" id="group__Vectors_html_ga7dce99001bf2a5ec705503346b6fec85"><div class="ttname"><a href="group__Vectors.html#ga7dce99001bf2a5ec705503346b6fec85">XX</a></div><div class="ttdeci">#define XX(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00085">matrix1d.h:85</a></div></div>
<div class="ttc" id="group__Macros_html_gad584f97e936242b173add43261376ba5"><div class="ttname"><a href="group__Macros.html#gad584f97e936242b173add43261376ba5">XMIPP_EQUAL_ACCURACY</a></div><div class="ttdeci">#define XMIPP_EQUAL_ACCURACY</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00119">xmipp_macros.h:119</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00091">multidim_array_base.h:91</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad60a440a5ba86f9f7f40cf4a23682500"><div class="ttname"><a href="multidim__array__base_8h.html#ad60a440a5ba86f9f7f40cf4a23682500">FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY</a></div><div class="ttdeci">#define FOR_ALL_DIRECT_ELEMENTS_IN_MULTIDIMARRAY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00176">multidim_array_base.h:176</a></div></div>
<div class="ttc" id="group__Macros_html_ga996f7be338ccb40d1a2a5abc1ad61759"><div class="ttname"><a href="group__Macros.html#ga996f7be338ccb40d1a2a5abc1ad61759">ABS</a></div><div class="ttdeci">#define ABS(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00142">xmipp_macros.h:142</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4ac4645adc643c1865419c09033c9f1d"><div class="ttname"><a href="multidim__array__base_8h.html#a4ac4645adc643c1865419c09033c9f1d">DIRECT_MULTIDIM_ELEM</a></div><div class="ttdeci">#define DIRECT_MULTIDIM_ELEM(v, n)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00161">multidim_array_base.h:161</a></div></div>
<div class="ttc" id="group__Vectors_html_ga97ccb86b4c568b2271da21552034d504"><div class="ttname"><a href="group__Vectors.html#ga97ccb86b4c568b2271da21552034d504">vectorR2</a></div><div class="ttdeci">Matrix1D&lt; double &gt; vectorR2(double x, double y)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8cpp_source.html#l00865">matrix1d.cpp:865</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a5c3a49bb5d046f0ee574b9f43c19420a"><div class="ttname"><a href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">ProgTomographAlignment::img</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; unsigned char &gt; * &gt; img</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00237">tomo_align_tilt_series.h:237</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="group__Vectors_html_ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f"><div class="ttname"><a href="group__Vectors.html#ga8b0ce0c5282ce1bae56cc1f9ed4b6a5f">YY</a></div><div class="ttdeci">#define YY(v)</div><div class="ttdef"><b>Definition:</b> <a href="matrix1d_8h_source.html#l00093">matrix1d.h:93</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a0adc16d7de22929fc86de9f3ee726d00"><div class="ttname"><a href="classProgTomographAlignment.html#a0adc16d7de22929fc86de9f3ee726d00">ProgTomographAlignment::showRefinement</a></div><div class="ttdeci">bool showRefinement</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00292">tomo_align_tilt_series.h:292</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ab21d2b58d5f934e687856c15fb59acf5"><div class="ttname"><a href="multidim__array__base_8h.html#ab21d2b58d5f934e687856c15fb59acf5">FINISHINGY</a></div><div class="ttdeci">#define FINISHINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00063">multidim_array_base.h:63</a></div></div>
<div class="ttc" id="classImage_html"><div class="ttname"><a href="classImage.html">Image&lt; double &gt;</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="numerical__recipes_8cpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int * n</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02247">numerical_recipes.cpp:2247</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8b723a0c1186f78b966c571b72461f5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b723a0c1186f78b966c571b72461f5d">&#9670;&nbsp;</a></span>removeOutlierLandmarks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgTomographAlignment::removeOutlierLandmarks </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classAlignment.html">Alignment</a> &amp;&#160;</td>
          <td class="paramname"><em>alignment</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove Outliers. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8cpp_source.html#l02455">2455</a> of file <a class="el" href="tomo__align__tilt__series_8cpp_source.html">tomo_align_tilt_series.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;{</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Removing outliers ...\n&quot;</span>;</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;    <span class="comment">// Compute threshold for outliers</span></div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    <a class="code" href="classHistogram1D.html">Histogram1D</a> hist;</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    <a class="code" href="group__Histograms.html#gaaa3501212e9e03d46c6e7aba56dd6c21">compute_hist</a>(alignment.<a class="code" href="classAlignment.html#a2c68950be38f3114380daa74d31e8bc8">errorLandmark</a>, hist, 100);</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    <span class="comment">// double threshold0=hist.percentil(10);</span></div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;    <span class="keywordtype">double</span> thresholdF=hist.<a class="code" href="classHistogram1D.html#a2ffd1bbd9aa8bd3807d09c7b352a1ee3">percentil</a>(90);</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    <span class="comment">// Identify outliers</span></div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    std::vector&lt;bool&gt; validLandmark;</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    <span class="keywordtype">int</span> invalidCounter=0;</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    <span class="keywordtype">int</span> Nlandmark=<a class="code" href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a>(<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>);</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;Nlandmark; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;        <span class="keywordflow">if</span> (<span class="comment">//COSS alignment.errorLandmark(j)&lt;threshold0 ||</span></div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;            alignment.<a class="code" href="classAlignment.html#a2c68950be38f3114380daa74d31e8bc8">errorLandmark</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>)&gt;thresholdF)</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;        {</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;            validLandmark.push_back(<span class="keyword">false</span>);</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;            invalidCounter++;</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;        }</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;            validLandmark.push_back(<span class="keyword">true</span>);</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    <span class="comment">// Remove outliers</span></div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> newAllLandmarksX(Nlandmark-invalidCounter,<a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>);</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    <a class="code" href="classMatrix2D.html">Matrix2D&lt;double&gt;</a> newAllLandmarksY(Nlandmark-invalidCounter,<a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>);</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    <span class="keywordtype">int</span> jj=0;</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;Nlandmark; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;    {</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;        <span class="keywordflow">if</span> (!validLandmark[<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>])</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">Nimg</a>; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;        {</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;            newAllLandmarksX(jj,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)=<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>(j,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;            newAllLandmarksY(jj,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)=<a class="code" href="classProgTomographAlignment.html#a8dcbb879ecd56dd2db6839b9b53fae9f">allLandmarksY</a>(j,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;        }</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;        jj++;</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    }</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>=newAllLandmarksX;</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a8dcbb879ecd56dd2db6839b9b53fae9f">allLandmarksY</a>=newAllLandmarksY;</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;    std::cout &lt;&lt; invalidCounter &lt;&lt; <span class="stringliteral">&quot; out of &quot;</span> &lt;&lt; Nlandmark</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; landmarks have been removed\n&quot;</span>;</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;}</div><div class="ttc" id="group__Matrices_html_ga43e28f6079b3652588d5b76ff199ff1e"><div class="ttname"><a href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a></div><div class="ttdeci">#define MAT_YSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00124">matrix2d.h:124</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a8dcbb879ecd56dd2db6839b9b53fae9f"><div class="ttname"><a href="classProgTomographAlignment.html#a8dcbb879ecd56dd2db6839b9b53fae9f">ProgTomographAlignment::allLandmarksY</a></div><div class="ttdeci">Matrix2D&lt; double &gt; allLandmarksY</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00274">tomo_align_tilt_series.h:274</a></div></div>
<div class="ttc" id="classAlignment_html_a2c68950be38f3114380daa74d31e8bc8"><div class="ttname"><a href="classAlignment.html#a2c68950be38f3114380daa74d31e8bc8">Alignment::errorLandmark</a></div><div class="ttdeci">MultidimArray&lt; double &gt; errorLandmark</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00451">tomo_align_tilt_series.h:451</a></div></div>
<div class="ttc" id="classHistogram1D_html"><div class="ttname"><a href="classHistogram1D.html">Histogram1D</a></div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00121">histogram.h:121</a></div></div>
<div class="ttc" id="classHistogram1D_html_a2ffd1bbd9aa8bd3807d09c7b352a1ee3"><div class="ttname"><a href="classHistogram1D.html#a2ffd1bbd9aa8bd3807d09c7b352a1ee3">Histogram1D::percentil</a></div><div class="ttdeci">double percentil(double percent_mass)</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00160">histogram.cpp:160</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a2127199afbebe9268549e5348b29b95f"><div class="ttname"><a href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">ProgTomographAlignment::allLandmarksX</a></div><div class="ttdeci">Matrix2D&lt; double &gt; allLandmarksX</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00271">tomo_align_tilt_series.h:271</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a3fa403d828d133eab75d26778795f1db"><div class="ttname"><a href="classProgTomographAlignment.html#a3fa403d828d133eab75d26778795f1db">ProgTomographAlignment::Nimg</a></div><div class="ttdeci">int Nimg</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00261">tomo_align_tilt_series.h:261</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="classMatrix2D_html"><div class="ttname"><a href="classMatrix2D.html">Matrix2D&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Histograms_html_gaaa3501212e9e03d46c6e7aba56dd6c21"><div class="ttname"><a href="group__Histograms.html#gaaa3501212e9e03d46c6e7aba56dd6c21">compute_hist</a></div><div class="ttdeci">void compute_hist(const MultidimArrayGeneric &amp;array, Histogram1D &amp;hist, int no_steps)</div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00572">histogram.cpp:572</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acb8aac8bd97ca8f399606f9d81b53ce6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb8aac8bd97ca8f399606f9d81b53ce6">&#9670;&nbsp;</a></span>run()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProgTomographAlignment::run </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Run: do the real work. </p>

<p>Reimplemented from <a class="el" href="classXmippProgram.html#a1d64156309778b3416ba0a153db21447">XmippProgram</a>.</p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8cpp_source.html#l02518">2518</a> of file <a class="el" href="tomo__align__tilt__series_8cpp_source.html">tomo_align_tilt_series.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;{</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    <a class="code" href="classProgTomographAlignment.html#afd582a8a73ef7bbc7855de16a2ebc549">produceSideInfo</a>();</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;generateLandmarkSet&quot;</span>&lt;&lt; std::endl;</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a871a94ad24fb5bc94113b3f14eafb0d1">generateLandmarkSet</a>();</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;produceInformationFromLandmarks&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a6e5ae6536e56d2cde3f18ca346f4fb12">produceInformationFromLandmarks</a>();</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;alignment&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;    <span class="keyword">auto</span> *alignment=<span class="keyword">new</span> <a class="code" href="namespaceAlignment.html">Alignment</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;    <span class="comment">// Exhaustive search for rot</span></div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;    <span class="keywordtype">double</span> bestError=0, bestRot=-1;</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">double</span> rot=0; rot&lt;=180-<a class="code" href="classProgTomographAlignment.html#ab363adf03b92571baa6876e558fbc6ea">deltaRot</a>; rot+=<a class="code" href="classProgTomographAlignment.html#ab363adf03b92571baa6876e558fbc6ea">deltaRot</a>)</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;    {</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;        alignment-&gt;clear();</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;        alignment-&gt;rot=rot;</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="tools_8cpp.html#a42c6b1edc1bd763019f0eb5edce18793">error</a>=alignment-&gt;optimizeGivenAxisDirection();</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;rot= &quot;</span> &lt;&lt; rot</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; error= &quot;</span> &lt;&lt; error &lt;&lt; std::endl;</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        <span class="keywordflow">if</span> (bestRot&lt;0 || bestError&gt;error)</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;        {</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;            bestRot=rot;</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;            bestError=<a class="code" href="tools_8cpp.html#a42c6b1edc1bd763019f0eb5edce18793">error</a>;</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;            *<a class="code" href="classProgTomographAlignment.html#a174552865b1ce2cafcdc2f6303eb8704">bestPreviousAlignment</a>=*alignment;</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;        }</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    }</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;    <span class="keyword">delete</span> alignment;</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Best rot=&quot;</span> &lt;&lt; bestRot</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; Best error=&quot;</span> &lt;&lt; bestError &lt;&lt; std::endl;</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;    <span class="comment">// Continuous optimization for the axis direction</span></div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    <a class="code" href="classMatrix1D.html">Matrix1D&lt;double&gt;</a> axisAngles(2), <a class="code" href="numerical__recipes_8cpp.html#a2de5b01a4efcb9b1582bb2947efc6bad">steps</a>(2);</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;    axisAngles(0)=bestRot;</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    axisAngles(1)=90;</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    <a class="code" href="numerical__recipes_8cpp.html#a2de5b01a4efcb9b1582bb2947efc6bad">steps</a>.initConstant(1);</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classProgTomographAlignment.html#a8cf474c5f20f85f60b769760cb8178d2">optimizeTiltAngle</a>)</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;        <a class="code" href="numerical__recipes_8cpp.html#a2de5b01a4efcb9b1582bb2947efc6bad">steps</a>(1)=0;</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="volume__align__prog_8cpp.html#a8b50613ae00d92ad08f3d5481b2fe213">fitness</a>;</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="numerical__recipes_8cpp.html#a4155d511de81aa816513aa52de01d931">iter</a>;</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    <a class="code" href="namespaceTomographAlignment.html#a5f60e98c44c2f60808caf1db2d367ead">TomographAlignment::global_prm</a>=<span class="keyword">this</span>;</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    <a class="code" href="numerical__tools_8cpp.html#aa75684a0e8adbe5ee59bfd1540907ab3">powellOptimizer</a>(axisAngles,1,2,&amp;<a class="code" href="tomo__align__tilt__series_8cpp.html#a1abd1d5b1c4acf603d5c1e9c0330ffb1">wrapperError</a>, <span class="keyword">nullptr</span>,</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;                    0.01,fitness,iter,<a class="code" href="numerical__recipes_8cpp.html#a2de5b01a4efcb9b1582bb2947efc6bad">steps</a>,<span class="keyword">true</span>);</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    <span class="comment">// Outlier removal</span></div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;3; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;    {</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;        <span class="comment">// Compute the best alignment</span></div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a174552865b1ce2cafcdc2f6303eb8704">bestPreviousAlignment</a>-&gt;<a class="code" href="classAlignment.html#add65434d2987bdde3581c85a26b142c4">rot</a>=axisAngles(0);</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a174552865b1ce2cafcdc2f6303eb8704">bestPreviousAlignment</a>-&gt;<a class="code" href="classAlignment.html#ae9cf6d3d33a4fb0f983d093f9b443998">tilt</a>=axisAngles(1);</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;        fitness=<a class="code" href="classProgTomographAlignment.html#a174552865b1ce2cafcdc2f6303eb8704">bestPreviousAlignment</a>-&gt;<a class="code" href="classAlignment.html#a1bc5d16732d769a7f7443cb10ea964c5">optimizeGivenAxisDirection</a>();</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a174552865b1ce2cafcdc2f6303eb8704">bestPreviousAlignment</a>-&gt;<a class="code" href="classAlignment.html#a7bdf51582e1b9437698188c93b7ac12f">computeErrorForLandmarks</a>();</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;        <span class="comment">// Remove landmarks that are outliers in the current model</span></div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a8b723a0c1186f78b966c571b72461f5d">removeOutlierLandmarks</a>(*<a class="code" href="classProgTomographAlignment.html#a174552865b1ce2cafcdc2f6303eb8704">bestPreviousAlignment</a>);</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a6e5ae6536e56d2cde3f18ca346f4fb12">produceInformationFromLandmarks</a>();</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;        <span class="keyword">delete</span> <a class="code" href="classProgTomographAlignment.html#a174552865b1ce2cafcdc2f6303eb8704">bestPreviousAlignment</a>;</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a174552865b1ce2cafcdc2f6303eb8704">bestPreviousAlignment</a>=<span class="keyword">new</span> <a class="code" href="namespaceAlignment.html">Alignment</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a174552865b1ce2cafcdc2f6303eb8704">bestPreviousAlignment</a>-&gt;<a class="code" href="classAlignment.html#add65434d2987bdde3581c85a26b142c4">rot</a>=axisAngles(0);</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;        <a class="code" href="classProgTomographAlignment.html#a174552865b1ce2cafcdc2f6303eb8704">bestPreviousAlignment</a>-&gt;<a class="code" href="classAlignment.html#ae9cf6d3d33a4fb0f983d093f9b443998">tilt</a>=axisAngles(1);</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;        fitness=<a class="code" href="classProgTomographAlignment.html#a174552865b1ce2cafcdc2f6303eb8704">bestPreviousAlignment</a>-&gt;<a class="code" href="classAlignment.html#a1bc5d16732d769a7f7443cb10ea964c5">optimizeGivenAxisDirection</a>();</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;        <span class="comment">// Optimize again</span></div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;        <a class="code" href="numerical__tools_8cpp.html#aa75684a0e8adbe5ee59bfd1540907ab3">powellOptimizer</a>(axisAngles,1,2,&amp;<a class="code" href="tomo__align__tilt__series_8cpp.html#a1abd1d5b1c4acf603d5c1e9c0330ffb1">wrapperError</a>,<span class="keyword">nullptr</span>,</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;                        0.01,fitness,iter,<a class="code" href="numerical__recipes_8cpp.html#a2de5b01a4efcb9b1582bb2947efc6bad">steps</a>,<span class="keyword">true</span>);</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;    }</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a174552865b1ce2cafcdc2f6303eb8704">bestPreviousAlignment</a>-&gt;<a class="code" href="classAlignment.html#add65434d2987bdde3581c85a26b142c4">rot</a>=axisAngles(0);</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a174552865b1ce2cafcdc2f6303eb8704">bestPreviousAlignment</a>-&gt;<a class="code" href="classAlignment.html#ae9cf6d3d33a4fb0f983d093f9b443998">tilt</a>=axisAngles(1);</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;    fitness=<a class="code" href="classProgTomographAlignment.html#a174552865b1ce2cafcdc2f6303eb8704">bestPreviousAlignment</a>-&gt;<a class="code" href="classAlignment.html#a1bc5d16732d769a7f7443cb10ea964c5">optimizeGivenAxisDirection</a>();</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;    <span class="comment">// Save the alignment</span></div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a76ef40d145be5f5402a03db800afcf8c">writeLandmarkSet</a>(<a class="code" href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">fnRoot</a>+<span class="stringliteral">&quot;_good_landmarks.txt&quot;</span>);</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;    std::ofstream fh_out;</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;    fh_out.open((<a class="code" href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">fnRoot</a>+<span class="stringliteral">&quot;_alignment.txt&quot;</span>).c_str());</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    <span class="keywordflow">if</span> (!fh_out)</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aade13cf952393233aecd094ded7043d4a">ERR_IO_NOWRITE</a>,</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;                     (std::string)<span class="stringliteral">&quot;Cannot open &quot;</span>+<a class="code" href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">fnRoot</a>+<span class="stringliteral">&quot;_alignment.txt for output&quot;</span>);</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;    fh_out &lt;&lt; *<a class="code" href="classProgTomographAlignment.html#a174552865b1ce2cafcdc2f6303eb8704">bestPreviousAlignment</a>;</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;    fh_out.close();</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;    <span class="comment">// Correct the input images</span></div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a5fae052aa646288c9956211bf02540c4">alignImages</a>(*bestPreviousAlignment);</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;    <a class="code" href="classProgTomographAlignment.html#a76ef40d145be5f5402a03db800afcf8c">writeLandmarkSet</a>(<a class="code" href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">fnRoot</a>+<span class="stringliteral">&quot;_good_landmarks_corrected.txt&quot;</span>);</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classProgTomographAlignment.html#a174552865b1ce2cafcdc2f6303eb8704">bestPreviousAlignment</a>;</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;}</div><div class="ttc" id="classProgTomographAlignment_html_ab363adf03b92571baa6876e558fbc6ea"><div class="ttname"><a href="classProgTomographAlignment.html#ab363adf03b92571baa6876e558fbc6ea">ProgTomographAlignment::deltaRot</a></div><div class="ttdeci">double deltaRot</div><div class="ttdoc">Delta rot. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00123">tomo_align_tilt_series.h:123</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00211">xmipp_error.h:211</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aade13cf952393233aecd094ded7043d4a"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aade13cf952393233aecd094ded7043d4a">ERR_IO_NOWRITE</a></div><div class="ttdoc">Couldn&amp;#39;t write to file. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00140">xmipp_error.h:140</a></div></div>
<div class="ttc" id="numerical__tools_8cpp_html_aa75684a0e8adbe5ee59bfd1540907ab3"><div class="ttname"><a href="numerical__tools_8cpp.html#aa75684a0e8adbe5ee59bfd1540907ab3">powellOptimizer</a></div><div class="ttdeci">void powellOptimizer(Matrix1D&lt; double &gt; &amp;p, int i0, int n, double(*f)(double *x, void *), void *prm, double ftol, double &amp;fret, int &amp;iter, const Matrix1D&lt; double &gt; &amp;steps, bool show)</div><div class="ttdef"><b>Definition:</b> <a href="numerical__tools_8cpp_source.html#l00043">numerical_tools.cpp:43</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a4155d511de81aa816513aa52de01d931"><div class="ttname"><a href="numerical__recipes_8cpp.html#a4155d511de81aa816513aa52de01d931">iter</a></div><div class="ttdeci">glob_prnt iter</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l04716">numerical_recipes.cpp:4716</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a238e1f42e2d7aeb892518355058ac6b1"><div class="ttname"><a href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">ProgTomographAlignment::fnRoot</a></div><div class="ttdeci">FileName fnRoot</div><div class="ttdoc">Output root. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00086">tomo_align_tilt_series.h:86</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a8b723a0c1186f78b966c571b72461f5d"><div class="ttname"><a href="classProgTomographAlignment.html#a8b723a0c1186f78b966c571b72461f5d">ProgTomographAlignment::removeOutlierLandmarks</a></div><div class="ttdeci">void removeOutlierLandmarks(const Alignment &amp;alignment)</div><div class="ttdoc">Remove Outliers. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l02455">tomo_align_tilt_series.cpp:2455</a></div></div>
<div class="ttc" id="classAlignment_html_ae9cf6d3d33a4fb0f983d093f9b443998"><div class="ttname"><a href="classAlignment.html#ae9cf6d3d33a4fb0f983d093f9b443998">Alignment::tilt</a></div><div class="ttdeci">double tilt</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00303">tomo_align_tilt_series.h:303</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a871a94ad24fb5bc94113b3f14eafb0d1"><div class="ttname"><a href="classProgTomographAlignment.html#a871a94ad24fb5bc94113b3f14eafb0d1">ProgTomographAlignment::generateLandmarkSet</a></div><div class="ttdeci">void generateLandmarkSet()</div><div class="ttdoc">Generate landmark set using a grid. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l01639">tomo_align_tilt_series.cpp:1639</a></div></div>
<div class="ttc" id="classAlignment_html_a7bdf51582e1b9437698188c93b7ac12f"><div class="ttname"><a href="classAlignment.html#a7bdf51582e1b9437698188c93b7ac12f">Alignment::computeErrorForLandmarks</a></div><div class="ttdeci">void computeErrorForLandmarks()</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l02735">tomo_align_tilt_series.cpp:2735</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a5fae052aa646288c9956211bf02540c4"><div class="ttname"><a href="classProgTomographAlignment.html#a5fae052aa646288c9956211bf02540c4">ProgTomographAlignment::alignImages</a></div><div class="ttdeci">void alignImages(const Alignment &amp;alignment)</div><div class="ttdoc">Align images. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l02245">tomo_align_tilt_series.cpp:2245</a></div></div>
<div class="ttc" id="tomo__align__tilt__series_8cpp_html_a1abd1d5b1c4acf603d5c1e9c0330ffb1"><div class="ttname"><a href="tomo__align__tilt__series_8cpp.html#a1abd1d5b1c4acf603d5c1e9c0330ffb1">wrapperError</a></div><div class="ttdeci">double wrapperError(double *p, void *prm)</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l02508">tomo_align_tilt_series.cpp:2508</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_afd582a8a73ef7bbc7855de16a2ebc549"><div class="ttname"><a href="classProgTomographAlignment.html#afd582a8a73ef7bbc7855de16a2ebc549">ProgTomographAlignment::produceSideInfo</a></div><div class="ttdeci">void produceSideInfo()</div><div class="ttdoc">Produce side info. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l00742">tomo_align_tilt_series.cpp:742</a></div></div>
<div class="ttc" id="namespaceTomographAlignment_html_a5f60e98c44c2f60808caf1db2d367ead"><div class="ttname"><a href="namespaceTomographAlignment.html#a5f60e98c44c2f60808caf1db2d367ead">TomographAlignment::global_prm</a></div><div class="ttdeci">const ProgTomographAlignment * global_prm</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l02505">tomo_align_tilt_series.cpp:2505</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a174552865b1ce2cafcdc2f6303eb8704"><div class="ttname"><a href="classProgTomographAlignment.html#a174552865b1ce2cafcdc2f6303eb8704">ProgTomographAlignment::bestPreviousAlignment</a></div><div class="ttdeci">Alignment * bestPreviousAlignment</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00289">tomo_align_tilt_series.h:289</a></div></div>
<div class="ttc" id="numerical__recipes_8cpp_html_a2de5b01a4efcb9b1582bb2947efc6bad"><div class="ttname"><a href="numerical__recipes_8cpp.html#a2de5b01a4efcb9b1582bb2947efc6bad">steps</a></div><div class="ttdeci">double steps</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l05184">numerical_recipes.cpp:5184</a></div></div>
<div class="ttc" id="namespaceAlignment_html"><div class="ttname"><a href="namespaceAlignment.html">Alignment</a></div><div class="ttdef"><b>Definition:</b> <a href="alignment__estimation_8h_source.html#l00034">alignment_estimation.h:34</a></div></div>
<div class="ttc" id="classAlignment_html_a1bc5d16732d769a7f7443cb10ea964c5"><div class="ttname"><a href="classAlignment.html#a1bc5d16732d769a7f7443cb10ea964c5">Alignment::optimizeGivenAxisDirection</a></div><div class="ttdeci">double optimizeGivenAxisDirection()</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l02610">tomo_align_tilt_series.cpp:2610</a></div></div>
<div class="ttc" id="tools_8cpp_html_a42c6b1edc1bd763019f0eb5edce18793"><div class="ttname"><a href="tools_8cpp.html#a42c6b1edc1bd763019f0eb5edce18793">error</a></div><div class="ttdeci">void error(char *s)</div><div class="ttdef"><b>Definition:</b> <a href="tools_8cpp_source.html#l00107">tools.cpp:107</a></div></div>
<div class="ttc" id="classMatrix1D_html"><div class="ttname"><a href="classMatrix1D.html">Matrix1D&lt; double &gt;</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a6e5ae6536e56d2cde3f18ca346f4fb12"><div class="ttname"><a href="classProgTomographAlignment.html#a6e5ae6536e56d2cde3f18ca346f4fb12">ProgTomographAlignment::produceInformationFromLandmarks</a></div><div class="ttdeci">void produceInformationFromLandmarks()</div><div class="ttdoc">Produce information from landmarks. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l02414">tomo_align_tilt_series.cpp:2414</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a76ef40d145be5f5402a03db800afcf8c"><div class="ttname"><a href="classProgTomographAlignment.html#a76ef40d145be5f5402a03db800afcf8c">ProgTomographAlignment::writeLandmarkSet</a></div><div class="ttdeci">void writeLandmarkSet(const FileName &amp;fnLandmark) const</div><div class="ttdoc">Write landmark set. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8cpp_source.html#l02146">tomo_align_tilt_series.cpp:2146</a></div></div>
<div class="ttc" id="classAlignment_html_add65434d2987bdde3581c85a26b142c4"><div class="ttname"><a href="classAlignment.html#add65434d2987bdde3581c85a26b142c4">Alignment::rot</a></div><div class="ttdeci">double rot</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00302">tomo_align_tilt_series.h:302</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a8cf474c5f20f85f60b769760cb8178d2"><div class="ttname"><a href="classProgTomographAlignment.html#a8cf474c5f20f85f60b769760cb8178d2">ProgTomographAlignment::optimizeTiltAngle</a></div><div class="ttdeci">bool optimizeTiltAngle</div><div class="ttdoc">Optimize tilt angle of tilt axis. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00129">tomo_align_tilt_series.h:129</a></div></div>
<div class="ttc" id="volume__align__prog_8cpp_html_a8b50613ae00d92ad08f3d5481b2fe213"><div class="ttname"><a href="volume__align__prog_8cpp.html#a8b50613ae00d92ad08f3d5481b2fe213">fitness</a></div><div class="ttdeci">double fitness(double *p)</div><div class="ttdef"><b>Definition:</b> <a href="volume__align__prog_8cpp_source.html#l00088">volume_align_prog.cpp:88</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0877ab8be30e3bb26a7c1457b3f988b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0877ab8be30e3bb26a7c1457b3f988b6">&#9670;&nbsp;</a></span>show()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgTomographAlignment::show </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Show parameters. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8cpp_source.html#l00490">490</a> of file <a class="el" href="tomo__align__tilt__series_8cpp_source.html">tomo_align_tilt_series.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;{</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Input images:       &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a5eded8363249e66bb494068a35883aa6">fnSel</a>              &lt;&lt; std::endl</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Original images:    &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a6ea6fcf828dc13a2adf15713ad8a97ec">fnSelOrig</a>          &lt;&lt; std::endl</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Output rootname:    &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">fnRoot</a>             &lt;&lt; std::endl</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Global affine:      &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a9042cbb5b5fad3b5cbe697af4dca2d67">globalAffine</a>       &lt;&lt; std::endl</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Use critical points:&quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a249db0f7eb2c90811b6bdf98ffddb01a">useCriticalPoints</a>  &lt;&lt; std::endl</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Num critical points:&quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a8b020a7a943ef31422f663a72b51fe38">Ncritical</a>          &lt;&lt; std::endl</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;SeqLength:          &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#af96123b461a6fad645f8ab5d94beca33">seqLength</a>          &lt;&lt; std::endl</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;BlindSeqLength:     &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a2ac192f1c46aeaea16bfba08b077d32d">blindSeqLength</a>     &lt;&lt; std::endl</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;MaxStep:            &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#ad379fbdd7b6f963a3aea0b4ce20ae4ff">maxStep</a>            &lt;&lt; std::endl</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Grid samples:       &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a92bc30971016ac4aff7557c8ac3ed495">gridSamples</a>        &lt;&lt; std::endl</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Maximum psi:        &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#ae7ced1919ef7005cf9631ac7892761f6">psiMax</a>             &lt;&lt; std::endl</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Delta rot:          &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#ab363adf03b92571baa6876e558fbc6ea">deltaRot</a>           &lt;&lt; std::endl</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Local size:         &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a9de431b2d85fc5d700dc4f90bb98ec3f">localSize</a>          &lt;&lt; std::endl</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Optimize tilt angle:&quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a8cf474c5f20f85f60b769760cb8178d2">optimizeTiltAngle</a>  &lt;&lt; std::endl</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;isCapillar:         &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a4905373a0acc63d50b75f609ea8bce57">isCapillar</a>         &lt;&lt; std::endl</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;DontNormalize:      &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a73502d61548fbce44458b99d8d978990">dontNormalize</a>      &lt;&lt; std::endl</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Difficult:          &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#aa610621f5be969da18b79e8ca9aaa5bf">difficult</a>          &lt;&lt; std::endl</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Threshold:          &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a2799e370b08d2c12c862e644af6a4748">corrThreshold</a>      &lt;&lt; std::endl</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;MaxShift Percentage:&quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a6a2e598c712e94b90d9a99e413d7e120">maxShiftPercentage</a> &lt;&lt; std::endl</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;MaxIterDE:          &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#abd71803ad9478f7b779e58472ec415ad">maxIterDE</a>          &lt;&lt; std::endl</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Show Affine:        &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#ae0df630253ea3e7accf03dd2c0acb0a7">showAffine</a>         &lt;&lt; std::endl</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Threshold Affine:   &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a8f45ff4b5de10a2ee5ed0b54b1700fd5">thresholdAffine</a>    &lt;&lt; std::endl</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Identify outliers Z:&quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a549ad45a1e9e26f2b983a209de5db173">identifyOutliersZ</a>     &lt;&lt; std::endl</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;No outliers:        &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a18dab8ec016cdb49c491d42d2d6b9998">doNotIdentifyOutliers</a> &lt;&lt; std::endl</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Pyramid level:      &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#ad2a716317a1ae6cce2b05f4cf402cdc3">pyramidLevel</a>       &lt;&lt; std::endl</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Threads to use:     &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#ae50cf00b4c254719af15a62f39f7816d">numThreads</a>         &lt;&lt; std::endl</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Last step:          &quot;</span> &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a483ebbe46f0bce2a09681223aef10739">lastStep</a>           &lt;&lt; std::endl</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    ;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;}</div><div class="ttc" id="classProgTomographAlignment_html_a9042cbb5b5fad3b5cbe697af4dca2d67"><div class="ttname"><a href="classProgTomographAlignment.html#a9042cbb5b5fad3b5cbe697af4dca2d67">ProgTomographAlignment::globalAffine</a></div><div class="ttdeci">bool globalAffine</div><div class="ttdoc">Look for local affine transformation. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00092">tomo_align_tilt_series.h:92</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a6a2e598c712e94b90d9a99e413d7e120"><div class="ttname"><a href="classProgTomographAlignment.html#a6a2e598c712e94b90d9a99e413d7e120">ProgTomographAlignment::maxShiftPercentage</a></div><div class="ttdeci">double maxShiftPercentage</div><div class="ttdoc">Maxshift percentage. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00111">tomo_align_tilt_series.h:111</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ab363adf03b92571baa6876e558fbc6ea"><div class="ttname"><a href="classProgTomographAlignment.html#ab363adf03b92571baa6876e558fbc6ea">ProgTomographAlignment::deltaRot</a></div><div class="ttdeci">double deltaRot</div><div class="ttdoc">Delta rot. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00123">tomo_align_tilt_series.h:123</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_af96123b461a6fad645f8ab5d94beca33"><div class="ttname"><a href="classProgTomographAlignment.html#af96123b461a6fad645f8ab5d94beca33">ProgTomographAlignment::seqLength</a></div><div class="ttdeci">size_t seqLength</div><div class="ttdoc">Sequence Length. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00101">tomo_align_tilt_series.h:101</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a2799e370b08d2c12c862e644af6a4748"><div class="ttname"><a href="classProgTomographAlignment.html#a2799e370b08d2c12c862e644af6a4748">ProgTomographAlignment::corrThreshold</a></div><div class="ttdeci">double corrThreshold</div><div class="ttdoc">Correlation threshold for a good landmark. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00141">tomo_align_tilt_series.h:141</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a5eded8363249e66bb494068a35883aa6"><div class="ttname"><a href="classProgTomographAlignment.html#a5eded8363249e66bb494068a35883aa6">ProgTomographAlignment::fnSel</a></div><div class="ttdeci">FileName fnSel</div><div class="ttdoc">MetaData File with all images. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00080">tomo_align_tilt_series.h:80</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_abd71803ad9478f7b779e58472ec415ad"><div class="ttname"><a href="classProgTomographAlignment.html#abd71803ad9478f7b779e58472ec415ad">ProgTomographAlignment::maxIterDE</a></div><div class="ttdeci">int maxIterDE</div><div class="ttdoc">Maximum number of iterations in Differential Evolution. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00114">tomo_align_tilt_series.h:114</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_aa610621f5be969da18b79e8ca9aaa5bf"><div class="ttname"><a href="classProgTomographAlignment.html#aa610621f5be969da18b79e8ca9aaa5bf">ProgTomographAlignment::difficult</a></div><div class="ttdeci">bool difficult</div><div class="ttdoc">Difficult. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00138">tomo_align_tilt_series.h:138</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ad379fbdd7b6f963a3aea0b4ce20ae4ff"><div class="ttname"><a href="classProgTomographAlignment.html#ad379fbdd7b6f963a3aea0b4ce20ae4ff">ProgTomographAlignment::maxStep</a></div><div class="ttdeci">int maxStep</div><div class="ttdoc">Maximum Step for chain refinement. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00120">tomo_align_tilt_series.h:120</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a238e1f42e2d7aeb892518355058ac6b1"><div class="ttname"><a href="classProgTomographAlignment.html#a238e1f42e2d7aeb892518355058ac6b1">ProgTomographAlignment::fnRoot</a></div><div class="ttdeci">FileName fnRoot</div><div class="ttdoc">Output root. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00086">tomo_align_tilt_series.h:86</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a8b020a7a943ef31422f663a72b51fe38"><div class="ttname"><a href="classProgTomographAlignment.html#a8b020a7a943ef31422f663a72b51fe38">ProgTomographAlignment::Ncritical</a></div><div class="ttdeci">size_t Ncritical</div><div class="ttdoc">Number of critical points. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00098">tomo_align_tilt_series.h:98</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a92bc30971016ac4aff7557c8ac3ed495"><div class="ttname"><a href="classProgTomographAlignment.html#a92bc30971016ac4aff7557c8ac3ed495">ProgTomographAlignment::gridSamples</a></div><div class="ttdeci">int gridSamples</div><div class="ttdoc">Grid samples. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00108">tomo_align_tilt_series.h:108</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a483ebbe46f0bce2a09681223aef10739"><div class="ttname"><a href="classProgTomographAlignment.html#a483ebbe46f0bce2a09681223aef10739">ProgTomographAlignment::lastStep</a></div><div class="ttdeci">int lastStep</div><div class="ttdoc">Last step to run (-1=run them all) </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00159">tomo_align_tilt_series.h:159</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ae50cf00b4c254719af15a62f39f7816d"><div class="ttname"><a href="classProgTomographAlignment.html#ae50cf00b4c254719af15a62f39f7816d">ProgTomographAlignment::numThreads</a></div><div class="ttdeci">int numThreads</div><div class="ttdoc">Number of threads to use for parallel computing. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00089">tomo_align_tilt_series.h:89</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a8f45ff4b5de10a2ee5ed0b54b1700fd5"><div class="ttname"><a href="classProgTomographAlignment.html#a8f45ff4b5de10a2ee5ed0b54b1700fd5">ProgTomographAlignment::thresholdAffine</a></div><div class="ttdeci">double thresholdAffine</div><div class="ttdoc">Threshold affine. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00147">tomo_align_tilt_series.h:147</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a6ea6fcf828dc13a2adf15713ad8a97ec"><div class="ttname"><a href="classProgTomographAlignment.html#a6ea6fcf828dc13a2adf15713ad8a97ec">ProgTomographAlignment::fnSelOrig</a></div><div class="ttdeci">FileName fnSelOrig</div><div class="ttdoc">MetaData File with all images at the original scale. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00083">tomo_align_tilt_series.h:83</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a18dab8ec016cdb49c491d42d2d6b9998"><div class="ttname"><a href="classProgTomographAlignment.html#a18dab8ec016cdb49c491d42d2d6b9998">ProgTomographAlignment::doNotIdentifyOutliers</a></div><div class="ttdeci">bool doNotIdentifyOutliers</div><div class="ttdoc">Do not identify outlier micrographs. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00153">tomo_align_tilt_series.h:153</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a2ac192f1c46aeaea16bfba08b077d32d"><div class="ttname"><a href="classProgTomographAlignment.html#a2ac192f1c46aeaea16bfba08b077d32d">ProgTomographAlignment::blindSeqLength</a></div><div class="ttdeci">size_t blindSeqLength</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00105">tomo_align_tilt_series.h:105</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a549ad45a1e9e26f2b983a209de5db173"><div class="ttname"><a href="classProgTomographAlignment.html#a549ad45a1e9e26f2b983a209de5db173">ProgTomographAlignment::identifyOutliersZ</a></div><div class="ttdeci">double identifyOutliersZ</div><div class="ttdoc">Identify outlier micrographs. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00150">tomo_align_tilt_series.h:150</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a249db0f7eb2c90811b6bdf98ffddb01a"><div class="ttname"><a href="classProgTomographAlignment.html#a249db0f7eb2c90811b6bdf98ffddb01a">ProgTomographAlignment::useCriticalPoints</a></div><div class="ttdeci">bool useCriticalPoints</div><div class="ttdoc">Use critical points. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00095">tomo_align_tilt_series.h:95</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a9de431b2d85fc5d700dc4f90bb98ec3f"><div class="ttname"><a href="classProgTomographAlignment.html#a9de431b2d85fc5d700dc4f90bb98ec3f">ProgTomographAlignment::localSize</a></div><div class="ttdeci">double localSize</div><div class="ttdoc">Local refinement size. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00126">tomo_align_tilt_series.h:126</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ad2a716317a1ae6cce2b05f4cf402cdc3"><div class="ttname"><a href="classProgTomographAlignment.html#ad2a716317a1ae6cce2b05f4cf402cdc3">ProgTomographAlignment::pyramidLevel</a></div><div class="ttdeci">int pyramidLevel</div><div class="ttdoc">Pyramid. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00156">tomo_align_tilt_series.h:156</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a4905373a0acc63d50b75f609ea8bce57"><div class="ttname"><a href="classProgTomographAlignment.html#a4905373a0acc63d50b75f609ea8bce57">ProgTomographAlignment::isCapillar</a></div><div class="ttdeci">bool isCapillar</div><div class="ttdoc">This tilt series comes from a capillar. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00132">tomo_align_tilt_series.h:132</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ae7ced1919ef7005cf9631ac7892761f6"><div class="ttname"><a href="classProgTomographAlignment.html#ae7ced1919ef7005cf9631ac7892761f6">ProgTomographAlignment::psiMax</a></div><div class="ttdeci">double psiMax</div><div class="ttdoc">Maximum rotation. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00117">tomo_align_tilt_series.h:117</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a8cf474c5f20f85f60b769760cb8178d2"><div class="ttname"><a href="classProgTomographAlignment.html#a8cf474c5f20f85f60b769760cb8178d2">ProgTomographAlignment::optimizeTiltAngle</a></div><div class="ttdeci">bool optimizeTiltAngle</div><div class="ttdoc">Optimize tilt angle of tilt axis. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00129">tomo_align_tilt_series.h:129</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_ae0df630253ea3e7accf03dd2c0acb0a7"><div class="ttname"><a href="classProgTomographAlignment.html#ae0df630253ea3e7accf03dd2c0acb0a7">ProgTomographAlignment::showAffine</a></div><div class="ttdeci">bool showAffine</div><div class="ttdoc">Show affine transformations. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00144">tomo_align_tilt_series.h:144</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a73502d61548fbce44458b99d8d978990"><div class="ttname"><a href="classProgTomographAlignment.html#a73502d61548fbce44458b99d8d978990">ProgTomographAlignment::dontNormalize</a></div><div class="ttdeci">bool dontNormalize</div><div class="ttdoc">Don&amp;#39;t normalize the corrected images. </div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00135">tomo_align_tilt_series.h:135</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a76ef40d145be5f5402a03db800afcf8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76ef40d145be5f5402a03db800afcf8c">&#9670;&nbsp;</a></span>writeLandmarkSet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgTomographAlignment::writeLandmarkSet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFileName.html">FileName</a> &amp;&#160;</td>
          <td class="paramname"><em>fnLandmark</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write landmark set. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8cpp_source.html#l02146">2146</a> of file <a class="el" href="tomo__align__tilt__series_8cpp_source.html">tomo_align_tilt_series.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;{</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    std::ofstream fhOut;</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    fhOut.open(fnLandmark.c_str());</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    <span class="keywordflow">if</span> (!fhOut)</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aade13cf952393233aecd094ded7043d4a">ERR_IO_NOWRITE</a>,(std::string)<span class="stringliteral">&quot;Cannot open &quot;</span>+fnLandmark+<span class="stringliteral">&quot; for output&quot;</span>);</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    fhOut &lt;&lt; <span class="stringliteral">&quot;Point     x       y       slice   color &quot;</span></div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    &lt;&lt; <a class="code" href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a>(<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a>(<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>) &lt;&lt; std::endl;</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a>(<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>); <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    {</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;        <span class="keywordtype">int</span> counter=0;</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=0; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;<a class="code" href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a>(<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>); <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)!=<a class="code" href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0]))</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;            {</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                fhOut &lt;&lt; counter &lt;&lt; <span class="stringliteral">&quot; \t&quot;</span></div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                &lt;&lt; <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">allLandmarksX</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-<a class="code" href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0])) &lt;&lt; <span class="stringliteral">&quot; \t&quot;</span></div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;                &lt;&lt; <a class="code" href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a>(<a class="code" href="classProgTomographAlignment.html#a8dcbb879ecd56dd2db6839b9b53fae9f">allLandmarksY</a>(<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>,<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-<a class="code" href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a>(*<a class="code" href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">img</a>[0])) &lt;&lt; <span class="stringliteral">&quot; \t&quot;</span></div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;                &lt;&lt; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+1 &lt;&lt; <span class="stringliteral">&quot; \t&quot;</span> &lt;&lt; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a> &lt;&lt; std::endl;</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;                counter++;</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;            }</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    }</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    fhOut.close();</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;}</div><div class="ttc" id="group__Matrices_html_ga43e28f6079b3652588d5b76ff199ff1e"><div class="ttname"><a href="group__Matrices.html#ga43e28f6079b3652588d5b76ff199ff1e">MAT_YSIZE</a></div><div class="ttdeci">#define MAT_YSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00124">matrix2d.h:124</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a8dcbb879ecd56dd2db6839b9b53fae9f"><div class="ttname"><a href="classProgTomographAlignment.html#a8dcbb879ecd56dd2db6839b9b53fae9f">ProgTomographAlignment::allLandmarksY</a></div><div class="ttdeci">Matrix2D&lt; double &gt; allLandmarksY</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00274">tomo_align_tilt_series.h:274</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00211">xmipp_error.h:211</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aade13cf952393233aecd094ded7043d4a"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aade13cf952393233aecd094ded7043d4a">ERR_IO_NOWRITE</a></div><div class="ttdoc">Couldn&amp;#39;t write to file. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00140">xmipp_error.h:140</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a2127199afbebe9268549e5348b29b95f"><div class="ttname"><a href="classProgTomographAlignment.html#a2127199afbebe9268549e5348b29b95f">ProgTomographAlignment::allLandmarksX</a></div><div class="ttdeci">Matrix2D&lt; double &gt; allLandmarksX</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00271">tomo_align_tilt_series.h:271</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_ad48b8b757cdd227ab33a016449982592"><div class="ttname"><a href="multidim__array__base_8h.html#ad48b8b757cdd227ab33a016449982592">STARTINGX</a></div><div class="ttdeci">#define STARTINGX(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00051">multidim_array_base.h:51</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a6557f9334712651f0c240ec8bf03a8d8"><div class="ttname"><a href="multidim__array__base_8h.html#a6557f9334712651f0c240ec8bf03a8d8">STARTINGY</a></div><div class="ttdeci">#define STARTINGY(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00059">multidim_array_base.h:59</a></div></div>
<div class="ttc" id="multidim__array__base_8h_html_a4b3f38e76847a3fbe3e579610b23ad29"><div class="ttname"><a href="multidim__array__base_8h.html#a4b3f38e76847a3fbe3e579610b23ad29">XSIZE</a></div><div class="ttdeci">#define XSIZE(v)</div><div class="ttdef"><b>Definition:</b> <a href="multidim__array__base_8h_source.html#l00091">multidim_array_base.h:91</a></div></div>
<div class="ttc" id="group__Macros_html_gacd66e8cacf954c3bc3bba81d09425a12"><div class="ttname"><a href="group__Macros.html#gacd66e8cacf954c3bc3bba81d09425a12">ROUND</a></div><div class="ttdeci">#define ROUND(x)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__macros_8h_source.html#l00210">xmipp_macros.h:210</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a5c3a49bb5d046f0ee574b9f43c19420a"><div class="ttname"><a href="classProgTomographAlignment.html#a5c3a49bb5d046f0ee574b9f43c19420a">ProgTomographAlignment::img</a></div><div class="ttdeci">std::vector&lt; MultidimArray&lt; unsigned char &gt; * &gt; img</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00237">tomo_align_tilt_series.h:237</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="group__Matrices_html_gacd5c6ac63f21fdbbd4343a9caf1ee9c6"><div class="ttname"><a href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a></div><div class="ttdeci">#define MAT_XSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00120">matrix2d.h:120</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0c7337a8112cc8f29c52cf6ff51d3efd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c7337a8112cc8f29c52cf6ff51d3efd">&#9670;&nbsp;</a></span>writeTransformations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProgTomographAlignment::writeTransformations </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFileName.html">FileName</a> &amp;&#160;</td>
          <td class="paramname"><em>fnTransformations</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write affine transformations. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8cpp_source.html#l02210">2210</a> of file <a class="el" href="tomo__align__tilt__series_8cpp_source.html">tomo_align_tilt_series.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;{</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;    std::ofstream fhOut;</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;    fhOut.open(fnTransformations.c_str());</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;    <span class="keywordflow">if</span> (!fhOut)</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;        <a class="code" href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a>(<a class="code" href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aade13cf952393233aecd094ded7043d4a">ERR_IO_NOWRITE</a>,(std::string)<span class="stringliteral">&quot;Cannot open &quot;</span>+fnTransformations+<span class="stringliteral">&quot; for output&quot;</span>);</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;    <span class="keywordtype">int</span> imax=<a class="code" href="classProgTomographAlignment.html#a18e8e8a40a20208e980fb46a85f8dc3d">affineTransformations</a>.size();</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    <span class="keywordtype">int</span> counter=0;</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;imax; <a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    {</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;        <span class="keywordtype">int</span> jmax=<a class="code" href="classProgTomographAlignment.html#a18e8e8a40a20208e980fb46a85f8dc3d">affineTransformations</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].size();</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>=<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>+1; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>&lt;jmax; <a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>++)</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a>(<a class="code" href="classProgTomographAlignment.html#a18e8e8a40a20208e980fb46a85f8dc3d">affineTransformations</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>])!=0)</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;            {</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;                fhOut &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">tiltList</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; <span class="stringliteral">&quot;\t0.0\t&quot;</span></div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;                &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a18e8e8a40a20208e980fb46a85f8dc3d">affineTransformations</a>[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>](0,0) &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span></div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;                &lt;&lt; affineTransformations[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][j](1,0) &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span></div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;                &lt;&lt; affineTransformations[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>](0,1) &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span></div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                &lt;&lt; affineTransformations[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][j](1,1) &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span></div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;                &lt;&lt; affineTransformations[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a>](0,2) &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span></div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;                &lt;&lt; affineTransformations[<a class="code" href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][j](1,2) &lt;&lt; std::endl;</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;                counter++;</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;            }</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    }</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    <span class="keywordflow">if</span> (counter==imax-1)</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    {</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;        fhOut &lt;&lt; <a class="code" href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">tiltList</a>[<a class="code" href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">tiltList</a>.size()-1] &lt;&lt; <span class="stringliteral">&quot;\t0.0\t1.0\t0.0\t0.0\t1.0\t0.0\t0.0\n&quot;</span>;</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;        fhOut &lt;&lt; <span class="stringliteral">&quot;1 0 0 1 0 0\n&quot;</span>;</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;    }</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;    fhOut.close();</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;}</div><div class="ttc" id="classProgTomographAlignment_html_a98fedcd4fef7c8e1504eb3b1d4cc86d0"><div class="ttname"><a href="classProgTomographAlignment.html#a98fedcd4fef7c8e1504eb3b1d4cc86d0">ProgTomographAlignment::tiltList</a></div><div class="ttdeci">std::vector&lt; double &gt; tiltList</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00246">tomo_align_tilt_series.h:246</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ga4ab7f9b2fd1ec4b9efcfba0c9b33052c"><div class="ttname"><a href="group__ErrorHandling.html#ga4ab7f9b2fd1ec4b9efcfba0c9b33052c">REPORT_ERROR</a></div><div class="ttdeci">#define REPORT_ERROR(nerr, ErrormMsg)</div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00211">xmipp_error.h:211</a></div></div>
<div class="ttc" id="group__ErrorHandling_html_ggab0df38968e4f03a3f1f6d6df0f31f45aade13cf952393233aecd094ded7043d4a"><div class="ttname"><a href="group__ErrorHandling.html#ggab0df38968e4f03a3f1f6d6df0f31f45aade13cf952393233aecd094ded7043d4a">ERR_IO_NOWRITE</a></div><div class="ttdoc">Couldn&amp;#39;t write to file. </div><div class="ttdef"><b>Definition:</b> <a href="xmipp__error_8h_source.html#l00140">xmipp_error.h:140</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="project__crystal_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="project__crystal_8cpp_html_aae82a1338cf72eb9a1cc7043f569537e"><div class="ttname"><a href="project__crystal_8cpp.html#aae82a1338cf72eb9a1cc7043f569537e">j</a></div><div class="ttdeci">#define j</div><div class="ttdef"><b>Definition:</b> <a href="numerical__recipes_8cpp_source.html#l02511">numerical_recipes.cpp:2511</a></div></div>
<div class="ttc" id="classProgTomographAlignment_html_a18e8e8a40a20208e980fb46a85f8dc3d"><div class="ttname"><a href="classProgTomographAlignment.html#a18e8e8a40a20208e980fb46a85f8dc3d">ProgTomographAlignment::affineTransformations</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Matrix2D&lt; double &gt; &gt; &gt; affineTransformations</div><div class="ttdef"><b>Definition:</b> <a href="tomo__align__tilt__series_8h_source.html#l00265">tomo_align_tilt_series.h:265</a></div></div>
<div class="ttc" id="group__Matrices_html_gacd5c6ac63f21fdbbd4343a9caf1ee9c6"><div class="ttname"><a href="group__Matrices.html#gacd5c6ac63f21fdbbd4343a9caf1ee9c6">MAT_XSIZE</a></div><div class="ttdeci">#define MAT_XSIZE(m)</div><div class="ttdef"><b>Definition:</b> <a href="matrix2d_8h_source.html#l00120">matrix2d.h:120</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a18e8e8a40a20208e980fb46a85f8dc3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18e8e8a40a20208e980fb46a85f8dc3d">&#9670;&nbsp;</a></span>affineTransformations</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt; <a class="el" href="classMatrix2D.html">Matrix2D</a>&lt;double&gt; &gt; &gt; ProgTomographAlignment::affineTransformations</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00265">265</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a2127199afbebe9268549e5348b29b95f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2127199afbebe9268549e5348b29b95f">&#9670;&nbsp;</a></span>allLandmarksX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt;double&gt; ProgTomographAlignment::allLandmarksX</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00271">271</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a8dcbb879ecd56dd2db6839b9b53fae9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dcbb879ecd56dd2db6839b9b53fae9f">&#9670;&nbsp;</a></span>allLandmarksY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrix2D.html">Matrix2D</a>&lt;double&gt; ProgTomographAlignment::allLandmarksY</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00274">274</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="ade84fe045db3ff2f59bb680e2ad7c852"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade84fe045db3ff2f59bb680e2ad7c852">&#9670;&nbsp;</a></span>avgBackwardPatchCorr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt;double&gt; ProgTomographAlignment::avgBackwardPatchCorr</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00255">255</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a2db3efcc5622e698680ea350a4d7393a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2db3efcc5622e698680ea350a4d7393a">&#9670;&nbsp;</a></span>avgForwardPatchCorr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt;double&gt; ProgTomographAlignment::avgForwardPatchCorr</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00252">252</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="ab74e4c20e5076a2e5b2e0ed80e76a89e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab74e4c20e5076a2e5b2e0ed80e76a89e">&#9670;&nbsp;</a></span>barpi</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classMatrix1D.html">Matrix1D</a>&lt;double&gt; &gt; ProgTomographAlignment::barpi</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00283">283</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a174552865b1ce2cafcdc2f6303eb8704"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a174552865b1ce2cafcdc2f6303eb8704">&#9670;&nbsp;</a></span>bestPreviousAlignment</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAlignment.html">Alignment</a>* ProgTomographAlignment::bestPreviousAlignment</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00289">289</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a2ac192f1c46aeaea16bfba08b077d32d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ac192f1c46aeaea16bfba08b077d32d">&#9670;&nbsp;</a></span>blindSeqLength</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t ProgTomographAlignment::blindSeqLength</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add blind landmarks. Set to -1 for no blind landmarks </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00105">105</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a27a3b5258d86502df1c4e24388c25314"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27a3b5258d86502df1c4e24388c25314">&#9670;&nbsp;</a></span>correlationList</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; ProgTomographAlignment::correlationList</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00268">268</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a2799e370b08d2c12c862e644af6a4748"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2799e370b08d2c12c862e644af6a4748">&#9670;&nbsp;</a></span>corrThreshold</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgTomographAlignment::corrThreshold</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Correlation threshold for a good landmark. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00141">141</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="ab363adf03b92571baa6876e558fbc6ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab363adf03b92571baa6876e558fbc6ea">&#9670;&nbsp;</a></span>deltaRot</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgTomographAlignment::deltaRot</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delta rot. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00123">123</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="aa610621f5be969da18b79e8ca9aaa5bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa610621f5be969da18b79e8ca9aaa5bf">&#9670;&nbsp;</a></span>difficult</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgTomographAlignment::difficult</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Difficult. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00138">138</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a18dab8ec016cdb49c491d42d2d6b9998"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18dab8ec016cdb49c491d42d2d6b9998">&#9670;&nbsp;</a></span>doNotIdentifyOutliers</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgTomographAlignment::doNotIdentifyOutliers</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Do not identify outlier micrographs. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00153">153</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a73502d61548fbce44458b99d8d978990"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73502d61548fbce44458b99d8d978990">&#9670;&nbsp;</a></span>dontNormalize</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgTomographAlignment::dontNormalize</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Don't normalize the corrected images. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00135">135</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a238e1f42e2d7aeb892518355058ac6b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a238e1f42e2d7aeb892518355058ac6b1">&#9670;&nbsp;</a></span>fnRoot</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classFileName.html">FileName</a> ProgTomographAlignment::fnRoot</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output root. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00086">86</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a5eded8363249e66bb494068a35883aa6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5eded8363249e66bb494068a35883aa6">&#9670;&nbsp;</a></span>fnSel</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classFileName.html">FileName</a> ProgTomographAlignment::fnSel</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="classMetaData.html">MetaData</a> File with all images. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00080">80</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a6ea6fcf828dc13a2adf15713ad8a97ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ea6fcf828dc13a2adf15713ad8a97ec">&#9670;&nbsp;</a></span>fnSelOrig</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classFileName.html">FileName</a> ProgTomographAlignment::fnSelOrig</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="classMetaData.html">MetaData</a> File with all images at the original scale. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00083">83</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a9042cbb5b5fad3b5cbe697af4dca2d67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9042cbb5b5fad3b5cbe697af4dca2d67">&#9670;&nbsp;</a></span>globalAffine</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgTomographAlignment::globalAffine</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Look for local affine transformation. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00092">92</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a92bc30971016ac4aff7557c8ac3ed495"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92bc30971016ac4aff7557c8ac3ed495">&#9670;&nbsp;</a></span>gridSamples</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgTomographAlignment::gridSamples</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="classGrid.html">Grid</a> samples. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00108">108</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a549ad45a1e9e26f2b983a209de5db173"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a549ad45a1e9e26f2b983a209de5db173">&#9670;&nbsp;</a></span>identifyOutliersZ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgTomographAlignment::identifyOutliersZ</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Identify outlier micrographs. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00150">150</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a5c3a49bb5d046f0ee574b9f43c19420a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c3a49bb5d046f0ee574b9f43c19420a">&#9670;&nbsp;</a></span>img</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt;unsigned char&gt; *&gt; ProgTomographAlignment::img</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00237">237</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a0c538b90574f9b5dd18aa5752499d5d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c538b90574f9b5dd18aa5752499d5d0">&#9670;&nbsp;</a></span>iMinTilt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgTomographAlignment::iMinTilt</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00243">243</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a4905373a0acc63d50b75f609ea8bce57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4905373a0acc63d50b75f609ea8bce57">&#9670;&nbsp;</a></span>isCapillar</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgTomographAlignment::isCapillar</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This tilt series comes from a capillar. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00132">132</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a5cab83f651abdfaa2777d777bd094ec1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cab83f651abdfaa2777d777bd094ec1">&#9670;&nbsp;</a></span>isOutlier</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt;int&gt; ProgTomographAlignment::isOutlier</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00258">258</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a63aae8f8140c218f00063ba9f3b7ac1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63aae8f8140c218f00063ba9f3b7ac1e">&#9670;&nbsp;</a></span>iteration</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgTomographAlignment::iteration</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00162">162</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a483ebbe46f0bce2a09681223aef10739"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a483ebbe46f0bce2a09681223aef10739">&#9670;&nbsp;</a></span>lastStep</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgTomographAlignment::lastStep</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Last step to run (-1=run them all) </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00159">159</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a9de431b2d85fc5d700dc4f90bb98ec3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9de431b2d85fc5d700dc4f90bb98ec3f">&#9670;&nbsp;</a></span>localSize</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgTomographAlignment::localSize</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Local refinement size. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00126">126</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="af9232ef65b1b4e153d7a20e0328cab8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9232ef65b1b4e153d7a20e0328cab8c">&#9670;&nbsp;</a></span>maskImg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt;unsigned char&gt; *&gt; ProgTomographAlignment::maskImg</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00240">240</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="abd71803ad9478f7b779e58472ec415ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd71803ad9478f7b779e58472ec415ad">&#9670;&nbsp;</a></span>maxIterDE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgTomographAlignment::maxIterDE</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of iterations in Differential Evolution. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00114">114</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a6a2e598c712e94b90d9a99e413d7e120"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a2e598c712e94b90d9a99e413d7e120">&#9670;&nbsp;</a></span>maxShiftPercentage</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgTomographAlignment::maxShiftPercentage</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maxshift percentage. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00111">111</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="ad379fbdd7b6f963a3aea0b4ce20ae4ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad379fbdd7b6f963a3aea0b4ce20ae4ff">&#9670;&nbsp;</a></span>maxStep</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgTomographAlignment::maxStep</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum Step for chain refinement. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00120">120</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a5718970fd91bc623ada85a3ca635ee3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5718970fd91bc623ada85a3ca635ee3b">&#9670;&nbsp;</a></span>name_list</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::string &gt; ProgTomographAlignment::name_list</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00249">249</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a8b020a7a943ef31422f663a72b51fe38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b020a7a943ef31422f663a72b51fe38">&#9670;&nbsp;</a></span>Ncritical</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t ProgTomographAlignment::Ncritical</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of critical points. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00098">98</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a7266e57c1152899236bc313bd0466ca4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7266e57c1152899236bc313bd0466ca4">&#9670;&nbsp;</a></span>ni</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrix1D.html">Matrix1D</a>&lt;int&gt; ProgTomographAlignment::ni</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00286">286</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a3fa403d828d133eab75d26778795f1db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fa403d828d133eab75d26778795f1db">&#9670;&nbsp;</a></span>Nimg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgTomographAlignment::Nimg</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00261">261</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="ae50cf00b4c254719af15a62f39f7816d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae50cf00b4c254719af15a62f39f7816d">&#9670;&nbsp;</a></span>numThreads</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgTomographAlignment::numThreads</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of threads to use for parallel computing. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00089">89</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a8cf474c5f20f85f60b769760cb8178d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cf474c5f20f85f60b769760cb8178d2">&#9670;&nbsp;</a></span>optimizeTiltAngle</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgTomographAlignment::optimizeTiltAngle</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Optimize tilt angle of tilt axis. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00129">129</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="ae7ced1919ef7005cf9631ac7892761f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7ced1919ef7005cf9631ac7892761f6">&#9670;&nbsp;</a></span>psiMax</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgTomographAlignment::psiMax</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum rotation. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00117">117</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="ad2a716317a1ae6cce2b05f4cf402cdc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2a716317a1ae6cce2b05f4cf402cdc3">&#9670;&nbsp;</a></span>pyramidLevel</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ProgTomographAlignment::pyramidLevel</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pyramid. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00156">156</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="af96123b461a6fad645f8ab5d94beca33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af96123b461a6fad645f8ab5d94beca33">&#9670;&nbsp;</a></span>seqLength</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t ProgTomographAlignment::seqLength</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sequence Length. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00101">101</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a9ed9e03ce422388ba0725d3d58f1febd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ed9e03ce422388ba0725d3d58f1febd">&#9670;&nbsp;</a></span>SF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMetaDataVec.html">MetaDataVec</a> ProgTomographAlignment::SF</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00231">231</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="aa46841d31bcc5d5eafa7fa36a0675f57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa46841d31bcc5d5eafa7fa36a0675f57">&#9670;&nbsp;</a></span>SForig</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMetaDataVec.html">MetaDataVec</a> ProgTomographAlignment::SForig</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00234">234</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="ae0df630253ea3e7accf03dd2c0acb0a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0df630253ea3e7accf03dd2c0acb0a7">&#9670;&nbsp;</a></span>showAffine</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgTomographAlignment::showAffine</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Show affine transformations. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00144">144</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a0adc16d7de22929fc86de9f3ee726d00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0adc16d7de22929fc86de9f3ee726d00">&#9670;&nbsp;</a></span>showRefinement</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgTomographAlignment::showRefinement</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00292">292</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a8f45ff4b5de10a2ee5ed0b54b1700fd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f45ff4b5de10a2ee5ed0b54b1700fd5">&#9670;&nbsp;</a></span>thresholdAffine</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ProgTomographAlignment::thresholdAffine</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Threshold affine. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00147">147</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a98fedcd4fef7c8e1504eb3b1d4cc86d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98fedcd4fef7c8e1504eb3b1d4cc86d0">&#9670;&nbsp;</a></span>tiltList</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; ProgTomographAlignment::tiltList</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00246">246</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a249db0f7eb2c90811b6bdf98ffddb01a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a249db0f7eb2c90811b6bdf98ffddb01a">&#9670;&nbsp;</a></span>useCriticalPoints</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProgTomographAlignment::useCriticalPoints</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use critical points. </p>

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00095">95</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a9e77688a46fde1f0d00da6cf69b33e83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e77688a46fde1f0d00da6cf69b33e83">&#9670;&nbsp;</a></span>Vseti</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt;int&gt; &gt; ProgTomographAlignment::Vseti</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00277">277</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<a id="a18a79b2c97411b080436beadb5bfb6d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18a79b2c97411b080436beadb5bfb6d4">&#9670;&nbsp;</a></span>Vsetj</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt;int&gt; &gt; ProgTomographAlignment::Vsetj</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tomo__align__tilt__series_8h_source.html#l00280">280</a> of file <a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>xmipp/legacy/libraries/reconstruction/<a class="el" href="tomo__align__tilt__series_8h_source.html">tomo_align_tilt_series.h</a></li>
<li>xmipp/legacy/libraries/reconstruction/<a class="el" href="tomo__align__tilt__series_8cpp_source.html">tomo_align_tilt_series.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
